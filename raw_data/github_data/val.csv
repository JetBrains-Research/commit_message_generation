"core \ tests \ coretests \ src \ android \ widget \ AbsSeekBarTest . java \n - mBar . setThumb ( newThumb ( dpToPx ( 20 ) ) ) ; \n + mBar . setThumb ( newThumb ( dpToPxSize ( 20 ) ) ) ; \n - measureAndLayout ( dpToPx ( 200 ) , dpToPx ( 100 ) ) ; \n + measureAndLayout ( dpToPxSize ( 200 ) , dpToPxSize ( 100 ) ) ; \n - assertEquals ( "" exclusion should be 48dp high "" , dpToPx ( 48 ) , exclusions . get ( 0 ) . height ( ) ) ; \n - assertEquals ( "" exclusion should be 48dp wide "" , dpToPx ( 48 ) , exclusions . get ( 0 ) . width ( ) ) ; \n + assertEquals ( "" exclusion should be 48dp high "" , dpToPxSize ( 48 ) , exclusions . get ( 0 ) . height ( ) ) ; \n + assertEquals ( "" exclusion should be 48dp wide "" , dpToPxSize ( 48 ) , exclusions . get ( 0 ) . width ( ) ) ; \n - mBar . setThumb ( newThumb ( dpToPx ( 20 ) ) ) ; \n + mBar . setThumb ( newThumb ( dpToPxSize ( 20 ) ) ) ; \n - measureAndLayout ( dpToPx ( 200 ) , dpToPx ( 32 ) ) ; \n + measureAndLayout ( dpToPxSize ( 200 ) , dpToPxSize ( 32 ) ) ; \n - assertEquals ( "" exclusion should be 32dp high "" , dpToPx ( 32 ) , exclusions . get ( 0 ) . height ( ) ) ; \n - assertEquals ( "" exclusion should be 32dp wide "" , dpToPx ( 32 ) , exclusions . get ( 0 ) . width ( ) ) ; \n + assertEquals ( "" exclusion should be 32dp high "" , dpToPxSize ( 32 ) , exclusions . get ( 0 ) . height ( ) ) ; \n + assertEquals ( "" exclusion should be 32dp wide "" , dpToPxSize ( 32 ) , exclusions . get ( 0 ) . width ( ) ) ; \n - mBar . setThumb ( newThumb ( dpToPx ( 20 ) ) ) ; \n + mBar . setThumb ( newThumb ( dpToPxSize ( 20 ) ) ) ; \n - measureAndLayout ( dpToPx ( 200 ) , dpToPx ( 32 ) ) ; \n + measureAndLayout ( dpToPxSize ( 200 ) , dpToPxSize ( 32 ) ) ; \n - private int dpToPx ( int dp ) { \n - return ( int ) ( mContext . getResources ( ) . getDisplayMetrics ( ) . density * dp ) ; \n + private int dpToPxSize ( int dp ) { \n + return ( int ) ( mContext . getResources ( ) . getDisplayMetrics ( ) . density * dp + 0 . 5f ) ; \n",AbsSeekBarTest : Fix dpToPixel computation \n Sizes should be rounded up . Follow the implementation \n of TypedValue . complexToDimensionPixelSize to get \n the same results as AbsSeekBar . \n Change - Id : Iaffe02328f737975b044053321836620cf12a686 \n Fixes : 173872859 \n Test : atest AbsSeekBarTest,3
OWNERS \n + # API changes are already covered by API - Review + 1 ( http : / / mdb / android - api - council ) \n + # via https : / / android . git . corp . google . com / All - Projects / + / refs / meta / config / rules . pl . \n + per - file * / api / * current . txt = * \n + \n,OWNERS : exempt current . txt files \n API current . txt files are already covered by the API - Review label through \n https : / / android . git . corp . google . com / All - Projects / + / refs / meta / config / rules . pl # 226 . \n Test : n / a \n Change - Id : Ib0f8272cc4dfe58b41804ef8c0951b7026cd0a59,3
core \ java \ android \ service \ textservice \ OWNERS \n - ogunwale @ google . com \n - roosa @ google . com \n - yukawa @ google . com \n + include . . / . . / inputmethodservice / OWNERS \n core \ java \ android \ view \ OWNERS \n + roosa @ google . com \n core \ java \ android \ view \ textservice \ OWNERS \n - ogunwale @ google . com \n - roosa @ google . com \n - yukawa @ google . com \n + include . . / inputmethod / OWNERS \n core \ java \ android \ widget \ OWNERS \n + \n + per - file SpellChecker . java = file : . . / view / inputmethod / OWNERS \n new file \n core \ java \ com \ android \ internal \ view \ OWNERS \n + # Bug component : 25700 \n + \n + file : / core / java / android / view / OWNERS \n + \n + per - file * Input * = file : / services / core / java / com / android / server / inputmethod / OWNERS \n,Add missing IMF OWNERS \n Test : n / a \n Change - Id : Ib1ec672f872a3b1faf65c3583e300f473bac8f0c,3
core \ java \ android \ view \ OWNERS \n + per - file View . java = file : / core / java / android / view / inputmethod / OWNERS \n + per - file ViewRootImpl . java = file : / core / java / android / view / inputmethod / OWNERS \n,IME : Add IME owners to View ( RootImpl ) \n Change - Id : Iedffc821be5eea3159a5c13014d0d30803a46c7d,3
core \ api \ current . txt \n - method @ Nullable public java . util . List < android . os . ParcelUuid > getServiceSolicitationUuids ( ) ; \n + method @ NonNull public java . util . List < android . os . ParcelUuid > getServiceSolicitationUuids ( ) ; \n core \ java \ android \ bluetooth \ le \ AdvertiseData . java \n - @ Nullable \n + @ NonNull \n - @ Nullable \n + @ NonNull \n - @ Nullable \n + @ NonNull \n,AdvertiseData : fix nullable collection \n Bug : 152525509 \n Test : make checkapi \n Change - Id : Ia400cb2bda55b26594bc3a253612583134294edb,3
"core \ java \ android \ window \ TaskOrganizer . java \n + import android . annotation . SuppressLint ; \n + @ SuppressLint ( "" NullableCollection "" ) \n + @ SuppressLint ( "" NullableCollection "" ) \n",API : Suppress existing NullableCollections lints ( TaskOrganizer ) \n Bug : 152525509 \n Test : make checkapi \n Change - Id : I5ce70d3e622fcdd13d63d47bf483507378a60e16 \n Merged - In : I5ce70d3e622fcdd13d63d47bf483507378a60e16,3
"core \ java \ android \ content \ AutofillOptions . java \n + import android . annotation . SuppressLint ; \n + @ SuppressLint ( "" NullableCollection "" ) \n + @ SuppressLint ( "" NullableCollection "" ) \n core \ java \ android \ content \ ContentCaptureOptions . java \n + import android . annotation . SuppressLint ; \n + @ SuppressLint ( "" NullableCollection "" ) \n + @ SuppressLint ( "" NullableCollection "" ) \n core \ java \ android \ content \ pm \ PackageManager . java \n - @ SuppressWarnings ( "" HiddenAbstractMethod "" ) \n + @ SuppressWarnings ( { "" HiddenAbstractMethod "" , "" NullableCollection "" } ) \n core \ java \ android \ view \ inputmethod \ InlineSuggestionInfo . java \n + @ SuppressLint ( "" NullableCollection "" ) \n location \ java \ android \ location \ LocationManager . java \n + @ SuppressWarnings ( "" NullableCollection "" ) \n packages \ Connectivity \ framework \ src \ android \ net \ NetworkAgent . java \n + import android . annotation . SuppressLint ; \n - public final void setUnderlyingNetworks ( @ Nullable List < Network > underlyingNetworks ) { \n + public final void setUnderlyingNetworks ( \n + @ SuppressLint ( "" NullableCollection "" ) @ Nullable List < Network > underlyingNetworks ) { \n telecomm \ java \ android \ telecom \ ConnectionRequest . java \n + import android . annotation . SuppressLint ; \n - public @ NonNull Builder setParticipants ( @ Nullable List < Uri > participants ) { \n + public @ NonNull Builder setParticipants ( \n + @ SuppressLint ( "" NullableCollection "" ) @ Nullable List < Uri > participants ) { \n telephony \ java \ android \ telephony \ ims \ DelegateStateCallback . java \n + import android . annotation . SuppressLint ; \n - void onCreated ( @ NonNull SipDelegate delegate , @ Nullable Set < FeatureTagState > deniedTags ) ; \n + void onCreated ( @ NonNull SipDelegate delegate , \n + @ SuppressLint ( "" NullableCollection "" ) / / TODO ( b / 154763999 ) : Mark deniedTags @ Nonnull \n + @ Nullable Set < FeatureTagState > deniedTags ) ; \n",API : Suppress existing NullableCollections lints \n Bug : 152525509 \n Bug : 154763999 \n Test : make checkapi \n Change - Id : Iecd0927e6be5496b2fbd1a49396db5439257ffe4,3
new file \n core \ tests \ coretests \ src \ android \ view \ inputmethod \ OWNERS \n + # Bug component : 34867 \n + \n + include / core / java / android / view / inputmethod / OWNERS \n,Add inputmethod coretests OWNERS \n Test : n / a \n Change - Id : If240716ddb0aa99111f8e343fca36a5bd97ed0dc,3
"plugins \ noarg \ noarg - cli \ src \ org \ jetbrains \ kotlin \ noarg \ diagnostic \ CliNoArgDeclarationChecker . kt \n - internal abstract class AbstractNoArgDeclarationChecker ( private val useIr : Boolean ) : DeclarationChecker , AnnotationBasedExtension { \n + abstract class AbstractNoArgDeclarationChecker ( private val useIr : Boolean ) : DeclarationChecker , AnnotationBasedExtension { \n plugins \ noarg \ noarg - ide \ src \ IdeNoArgDeclarationChecker . kt \n - class IdeNoArgDeclarationChecker ( project : Project ) : AbstractNoArgDeclarationChecker ( ) { \n + class IdeNoArgDeclarationChecker ( project : Project ) : AbstractNoArgDeclarationChecker ( false ) { \n - } \n + } \n",Fix compilation error in : noarg - ide - plugin \n Was overlooked in a06bffc4b975527833b61d8b316ea62fb7bbbe53 .,21
"compiler \ tests - common \ tests \ org \ jetbrains \ kotlin \ checkers \ AbstractJspecifyAnnotationsTest . kt \n - import org . jetbrains . kotlin . resolve . jvm . diagnostics . ErrorsJvm . NULLABILITY _ MISMATCH _ BASED _ ON _ JAVA _ ANNOTATIONS \n + import org . jetbrains . kotlin . resolve . jvm . diagnostics . ErrorsJvm \n - for ( ( diagnostic , jspecifyMark ) in diagnosticsToJspecifyMarksMap ) { \n + for ( ( diagnosticName , jspecifyMark ) in diagnosticsToJspecifyMarksMap ) { \n - diagnostic . name in diagnostics . getDiagnostics ( ) . map { it . name } \n + diagnosticName in diagnostics . getDiagnostics ( ) . map { it . name } \n - val errorMessage = "" Diagnostic ' $ diagnostic ' not found for jspecify mark ' $ jspecifyMark ' at $ { lineIndex + 1 } line "" \n + val errorMessage = "" Diagnostic ' $ diagnosticName ' not found for jspecify mark ' $ jspecifyMark ' at $ { lineIndex + 1 } line "" \n - NULLABILITY _ MISMATCH _ BASED _ ON _ JAVA _ ANNOTATIONS to "" jspecify _ nullness _ mismatch "" \n + ErrorsJvm : : NULLABILITY _ MISMATCH _ BASED _ ON _ JAVA _ ANNOTATIONS . name to JSPECIFY _ NULLNESS _ MISMATCH _ MARK \n",Fix incorrect code in AbstractJspecifyAnnotationsTest \n There was a warning on line 78 \n ( ` diagnosticsToJspecifyMarksMap [ diagnostic . name ] ` ) which unconvered that \n the map wasn ' t used in the same way in both call sites .,21
"idea \ src \ org \ jetbrains \ kotlin \ idea \ util \ ProgressIndicatorUtils . kt \n + @ Suppress ( "" ObjectLiteralToLambda "" ) / / Workaround for KT - 43812 . \n - ) : T = com . intellij . openapi . actionSystem . ex . ActionUtil . underModalProgress ( project , progressTitle , computable ) \n + ) : T = com . intellij . openapi . actionSystem . ex . ActionUtil . underModalProgress ( project , progressTitle , object : Computable < T > { \n + override fun compute ( ) : T = computable ( ) \n + } ) \n","Minor , add workaround for KT - 43812",21
compiler \ cli \ cli - common \ src \ org \ jetbrains \ kotlin \ cli \ common \ arguments \ K2JVMCompilerArguments . kt \n - result [ AnalysisFlags . reportErrorsOnIrDependencies ] = ! useIR & & ! useFir & & ! allowJvmIrDependencies \n + result [ AnalysisFlags . allowUnstableDependencies ] = allowJvmIrDependencies | | useIR | | useFir \n compiler \ config \ src \ org \ jetbrains \ kotlin \ config \ AnalysisFlags . kt \n - val reportErrorsOnIrDependencies by AnalysisFlag . Delegates . Boolean \n + val allowUnstableDependencies by AnalysisFlag . Delegates . Boolean \n compiler \ frontend \ src \ org \ jetbrains \ kotlin \ resolve \ CompilerDeserializationConfiguration . kt \n - override val reportErrorsOnIrDependencies = languageVersionSettings . getFlag ( AnalysisFlags . reportErrorsOnIrDependencies ) \n + override val allowUnstableDependencies = languageVersionSettings . getFlag ( AnalysisFlags . allowUnstableDependencies ) \n core \ descriptors . jvm \ src \ org \ jetbrains \ kotlin \ load \ kotlin \ DeserializedDescriptorResolver . kt \n - get ( ) = components . configuration . reportErrorsOnIrDependencies & & classHeader . isUnstableJvmIrBinary \n + get ( ) = ! components . configuration . allowUnstableDependencies & & classHeader . isUnstableJvmIrBinary \n core \ deserialization \ src \ org \ jetbrains \ kotlin \ serialization \ deserialization \ DeserializationConfiguration . kt \n - val reportErrorsOnIrDependencies : Boolean \n + val allowUnstableDependencies : Boolean \n,"Minor , invert analysis flag that allows unstable dependencies",21
gradle . properties \n - # kotlin . build . useIR = true \n + kotlin . build . useIR = true \n,Enable JVM IR for bootstrap in the project,21
"compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ jvm \ compiler \ KotlinToJVMBytecodeCompiler . kt \n - val isIR = ( configuration . getBoolean ( JVMConfigurationKeys . IR ) | | \n - configuration . getBoolean ( CommonConfigurationKeys . USE _ FIR ) ) \n - if ( isIR ) JvmIrCodegenFactory ( \n + if ( configuration . getBoolean ( JVMConfigurationKeys . IR ) ) JvmIrCodegenFactory ( \n - . isIrBackend ( isIR ) \n compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ jvm \ jvmArguments . kt \n - put ( JVMConfigurationKeys . IR , arguments . useIR & & ! arguments . noUseIR ) \n + put ( JVMConfigurationKeys . IR , ( arguments . useIR & & ! arguments . noUseIR ) | | arguments . useFir ) \n plugins \ scripting \ scripting - compiler \ src \ org \ jetbrains \ kotlin \ scripting \ compiler \ plugin \ impl \ ScriptJvmCompilerImpls . kt \n - import org . jetbrains . kotlin . config . CommonConfigurationKeys \n - if ( kotlinCompilerConfiguration . getBoolean ( JVMConfigurationKeys . IR ) | | kotlinCompilerConfiguration . getBoolean ( CommonConfigurationKeys . USE _ FIR ) ) \n + if ( kotlinCompilerConfiguration . getBoolean ( JVMConfigurationKeys . IR ) ) \n","JVM IR , FIR : set IR configuration key to true if FIR is enabled",21
"compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ jvm \ jvmArguments . kt \n + import org . jetbrains . kotlin . cli . common . messages . MessageCollector \n - \n - val messageCollector = getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n - \n - \n - val messageCollector = getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n - \n - val jdkHome = File ( arguments . jdkHome ) \n + val jdkHome = File ( arguments . jdkHome ! ! ) \n - val messageCollector = getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n - getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) . report ( \n + messageCollector . report ( \n - getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) . report ( \n + messageCollector . report ( \n - val constructorCallNormalizationMode = \n - JVMConstructorCallNormalizationMode . fromStringOrNull ( arguments . constructorCallNormalizationMode ) \n + val constructorCallNormalizationMode = JVMConstructorCallNormalizationMode . fromStringOrNull ( arguments . constructorCallNormalizationMode ) \n - put ( \n - JVMConfigurationKeys . CONSTRUCTOR _ CALL _ NORMALIZATION _ MODE , \n - constructorCallNormalizationMode \n - ) \n + put ( JVMConfigurationKeys . CONSTRUCTOR _ CALL _ NORMALIZATION _ MODE , constructorCallNormalizationMode ) \n - getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) . report ( \n + messageCollector . report ( \n - "" Unknown assertions mode : $ { arguments . assertionsMode } , "" + \n - "" supported modes : $ { JVMAssertionsMode . values ( ) . map { it . description } } "" \n + "" Unknown assertions mode : $ { arguments . assertionsMode } , supported modes : $ { JVMAssertionsMode . values ( ) . map { it . description } } "" \n - put ( \n - JVMConfigurationKeys . ASSERTIONS _ MODE , \n - assertionsMode ? : JVMAssertionsMode . DEFAULT \n - ) \n + put ( JVMConfigurationKeys . ASSERTIONS _ MODE , assertionsMode ? : JVMAssertionsMode . DEFAULT ) \n - getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n - . report ( INFO , "" Using the old java class files reading implementation "" ) \n + messageCollector . report ( INFO , "" Using the old java class files reading implementation "" ) \n - getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n - . report ( INFO , "" Using preview Java language features "" ) \n + messageCollector . report ( INFO , "" Using preview Java language features "" ) \n + \n + private val CompilerConfiguration . messageCollector : MessageCollector \n + get ( ) = getNotNull ( CLIConfigurationKeys . MESSAGE _ COLLECTOR _ KEY ) \n","Minor , extract CompilerConfiguration . messageCollector to extension property",21
compiler \ light - classes \ src \ org \ jetbrains \ kotlin \ asJava \ classes \ ultraLightField . kt \n + \n + / / Workaround for KT - 42137 until we update the bootstrap compiler . \n + override val kotlinOrigin : KtNamedDeclaration get ( ) = super . kotlinOrigin \n - } \n + } \n,"Minor , add workaround for KT - 42137",21
"kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ optimizations \ Devirtualization . kt \n - val bucketIdx = ( ( value . toULong ( ) * 11400714819323198393UL ) % bagOfEdges . size . toUInt ( ) ) . toInt ( ) \n + val bucketIdx = ( ( value . toULong ( ) * 11400714819323198393UL ) % bagOfEdges . size . toULong ( ) ) . toInt ( ) \n kotlin - native \ build . gradle \n + if ( findProperty ( "" kotlin . build . useIR "" ) = = "" true "" ) { \n + tasks . withType ( org . jetbrains . kotlin . gradle . tasks . KotlinCompile ) . configureEach { \n + kotlinOptions { \n + useIR = true \n + freeCompilerArgs + = [ "" - Xir - binary - with - stable - abi "" ] \n + } \n + } \n + } \n + \n kotlin - native \ gradle . properties \n + # Uncomment to compile Kotlin / Native backend modules with JVM IR backend . \n + # kotlin . build . useIR = true \n + \n",Add kotlin . build . useIR property to compile project with JVM IR \n The change in Devirtualization . kt is needed to workaround JVM IR issue \n reported at KT - 43286 . \n ( cherry picked from commit 4a945686bae98c147a641c0b41d3e8474f133ca2 ),21
"compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ JvmCachedDeclarations . kt \n - ! forCompatibilityMode & & ! interfaceFun . isFakeOverride - > \n - when { \n - interfaceFun . origin = = IrDeclarationOrigin . FUNCTION _ FOR _ DEFAULT _ PARAMETER - > \n - interfaceFun . origin \n - interfaceFun . origin . isSynthetic - > \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS _ SYNTHETIC \n - else - > \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS \n - } \n - interfaceFun . resolveFakeOverride ( ) ! ! . origin . isSynthetic - > \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE _ TO _ SYNTHETIC \n - else - > \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE \n + ! forCompatibilityMode & & ! interfaceFun . isFakeOverride - > interfaceFun . origin \n + interfaceFun . resolveFakeOverride ( ) ! ! . origin . isSynthetic - > JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE _ TO _ SYNTHETIC \n + else - > JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE \n compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ JvmLoweredDeclarationOrigin . kt \n - object DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS : IrDeclarationOriginImpl ( "" STATIC _ WITH _ MOVED _ RECEIVERS "" ) \n - object DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS _ SYNTHETIC : \n - IrDeclarationOriginImpl ( "" STATIC _ WITH _ MOVED _ RECEIVERS _ SYNTHETIC "" , isSynthetic = true ) \n compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ lower \ AddContinuationLowering . kt \n - ! isDefaultImplsFunction \n + parentAsClass . origin ! = JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS \n - private val defaultImplsOrigins = setOf ( \n - IrDeclarationOrigin . FUNCTION _ FOR _ DEFAULT _ PARAMETER , \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS , \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS _ SYNTHETIC , \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE , \n - JvmLoweredDeclarationOrigin . DEFAULT _ IMPLS _ BRIDGE _ TO _ SYNTHETIC , \n - ) \n - \n - private val IrSimpleFunction . isDefaultImplsFunction : Boolean \n - get ( ) = origin in defaultImplsOrigins \n - \n","JVM IR : do not use origin DEFAULT _ IMPLS _ WITH _ MOVED _ RECEIVERS ( _ SYNTHETIC ) \n Instead , check that origin of the parent class is DEFAULT _ IMPLS .",21
"plugins \ kotlin - serialization \ kotlin - serialization - compiler \ src \ org \ jetbrains \ kotlinx \ serialization \ compiler \ backend \ ir \ GeneratorHelpers . kt \n - args = valueArguments . toTypedArray ( ) , \n + * valueArguments . toTypedArray ( ) , \n - val ( prop , ir ) = enclosingGenerator . localSerializersFieldsDescriptors [ it ] \n + val ( _ , ir ) = enclosingGenerator . localSerializersFieldsDescriptors [ it ] \n plugins \ kotlin - serialization \ kotlin - serialization - compiler \ src \ org \ jetbrains \ kotlinx \ serialization \ compiler \ backend \ ir \ SerializerForInlineClassGenerator . kt \n - val value = coerceToBox ( actualCall , inlinedType , loadFunc . returnType ) \n + val value = coerceToBox ( actualCall , loadFunc . returnType ) \n + irReturn ( value ) \n - private fun IrBlockBodyBuilder . coerceToBox ( expression : IrExpression , propertyType : IrType , inlineClassBoxType : IrType ) : IrExpression = \n + private fun IrBlockBodyBuilder . coerceToBox ( expression : IrExpression , inlineClassBoxType : IrType ) : IrExpression = \n plugins \ kotlin - serialization \ kotlin - serialization - compiler \ src \ org \ jetbrains \ kotlinx \ serialization \ compiler \ backend \ ir \ SerializerIrGenerator . kt \n - localSerializersFieldsDescriptors = findLocalSerializersFieldDescriptors ( ) . map { it - > \n - it to generateSimplePropertyWithBackingField ( it , irClass ) \n + localSerializersFieldsDescriptors = findLocalSerializersFieldDescriptors ( ) . map { descriptor - > \n + descriptor to generateSimplePropertyWithBackingField ( descriptor , irClass ) \n","Minor , fix compiler warnings in kotlin - serialization - compiler",21
"compiler \ ir \ ir . tree \ src \ org \ jetbrains \ kotlin \ ir \ util \ SymbolTable . kt \n - "" $ it $ { it . signature ? . toString ( ) ? : "" NON - PUBLIC API $ it "" } "" \n + "" $ it $ { it . signature ? . toString ( ) ? : "" ( NON - PUBLIC API ) "" } "" \n","IR : minor , deduplicate unbound symbol in error message",21
"build . gradle . kts \n - val profileMessage = "" $ profile build profile is active ( $ proguardMessage , $ jarCompressionMessage ) . "" + \n - "" Use - Pteamcity = < true | false > to reproduce CI / local build "" \n - logger . warn ( "" \ n \ n $ profileMessage "" ) \n + logger . warn ( \n + "" $ profile build profile is active ( $ proguardMessage , $ jarCompressionMessage ) . "" + \n + "" Use - Pteamcity = < true | false > to reproduce CI / local build "" \n + ) \n","Build : minor , remove extra newlines in log",21
libraries \ scripting \ jvm - host - test \ test \ kotlin \ script \ experimental \ jvmhost \ test \ ImplicitsFromScriptResultTest . kt \n - getScriptingClass ( GetScriptClassForImplicits ( : : getImplicitsClasses ) ) \n + getScriptingClass ( GetScriptClassForImplicits { getImplicitsClasses ( ) } ) \n,"Minor , add workaround for KT - 43666",21
"build . gradle . kts \n - freeCompilerArgs + = "" - Xir - binary - with - stable - abi "" \n libraries \ commonConfiguration . gradle \n - if ( project . kotlinBuildProperties . useIRForLibraries ) { \n - useIR = true \n - freeCompilerArgs + = [ "" - Xir - binary - with - stable - abi "" ] \n - } else { \n - useIR = false \n - } \n + useIR = project . kotlinBuildProperties . useIRForLibraries \n",Build : remove obsolete - Xir - binary - with - stable - abi \n It ' s no longer needed after eef06cded39 and 3e3ffee2a04 .,21
"compiler \ ir \ ir . tree \ src \ org \ jetbrains \ kotlin \ ir \ descriptors \ IrBasedDescriptors . kt \n - override fun getContainingDeclaration ( ) = getContainingDeclaration ( owner ) \n + override fun getContainingDeclaration ( ) : DeclarationDescriptor = \n + getContainingDeclaration ( owner ) \n - override fun equals ( other : Any ? ) : Boolean { \n - if ( other ! is IrBasedDeclarationDescriptor < * > ) return false \n - return owner = = other . owner \n - } \n + override fun equals ( other : Any ? ) : Boolean = \n + other is IrBasedDeclarationDescriptor < * > & & owner = = other . owner \n - override fun hashCode ( ) : Int { \n - return owner . hashCode ( ) \n - } \n + override fun hashCode ( ) : Int = owner . hashCode ( ) \n + \n + override fun toString ( ) : String = javaClass . simpleName + "" : "" + owner . render ( ) \n",IR : add toString for IrBased descriptors \n To help in diagnosing issues like KT - 44160 .,21
compiler \ testData \ codegen \ box \ reflection \ annotations \ onTypes \ classLiteralWithExpectedType . kt \n + / / JVM _ TARGET : 1 . 6 \n + \n - } \n + } \n,"Fix codegen test classLiteralWithExpectedType . kt on Android \n Similar to changes in d022bb0248a , this test started to fail because \n ` AnnotationTarget . TYPE ` is mapped to ` ElementType . TYPE _ USE ` if JVM \n target is > = 1 . 8 . In codegen tests on Android , we ' re running the \n emulator of version 19 which is less than 26 , where ` TYPE _ USE ` has first \n appeared .",21
"compiler \ fir \ tree \ build . gradle . kts \n - \n - kotlin { \n - sourceSets . all { \n - languageSettings . enableLanguageFeature ( "" InlineClasses "" ) \n - } \n - } \n","Remove unneeded language feature configuration from fir : tree \n It causes a verbose warning to be displayed on each build . Inline \n classes are enabled by default since Kotlin 1 . 5 , so this configuration \n is no longer needed .",21
compiler \ backend \ src \ org \ jetbrains \ kotlin \ codegen \ ClassFileFactory . java \n - private void registerSourceFiles ( Collection < KtFile > files ) { \n + public void registerSourceFiles ( @ NotNull Collection < KtFile > files ) { \n compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ JvmIrCodegenFactory . kt \n + context . state . factory . registerSourceFiles ( irModuleFragment . files . map ( context . psiSourceManager : : getKtFile ) ) \n + \n,"JVM IR : report all sources as outputs for . kotlin _ module file \n This fixes some tests for LV = 1 . 5 in KotlinJpsBuildTest , \n KotlinJpsBuildTestIncremental , IncrementalJvmJpsTestGenerated , \n IncrementalCacheVersionChangedTestGenerated . \n # KT - 42069 Fixed",21
"new file \n compiler \ testData \ cli \ jvm \ abiStabilityUnstableWithOldBackend . args \n + $ TESTDATA _ DIR $ / simple . kt \n + - d \n + $ TEMP _ DIR $ \n + - Xabi - stability = unstable \n + - Xuse - old - backend \n new file \n compiler \ testData \ cli \ jvm \ abiStabilityUnstableWithOldBackend . out \n + error : - Xabi - stability = unstable is not supported in the old JVM backend \n + COMPILATION _ ERROR \n compiler \ tests - gen \ org \ jetbrains \ kotlin \ cli \ CliTestGenerated . java \n + @ TestMetadata ( "" abiStabilityUnstableWithOldBackend . args "" ) \n + public void testAbiStabilityUnstableWithOldBackend ( ) throws Exception { \n + runTest ( "" compiler / testData / cli / jvm / abiStabilityUnstableWithOldBackend . args "" ) ; \n + } \n + \n","Minor , restore abiStabilityUnstableWithOldBackend CLI test \n Add - Xuse - old - backend to make it pass with LV = 1 . 5 where JVM IR is \n enabled by default .",21
"libraries \ stdlib \ jvm \ src \ kotlin \ collections \ MutableCollectionsJVM . kt \n - @ Suppress ( "" UNUSED _ PARAMETER "" ) \n + @ Suppress ( "" UNUSED _ PARAMETER "" , "" EXTENSION _ SHADOWED _ BY _ MEMBER "" ) \n libraries \ stdlib \ jvm \ src \ kotlin \ reflect \ TypesJVM . kt \n - @ Suppress ( "" VIRTUAL _ MEMBER _ HIDDEN "" ) / / This is needed for cases when environment variable JDK _ 16 points to JDK 8 + . \n + @ Suppress ( \n + "" VIRTUAL _ MEMBER _ HIDDEN "" , "" NON _ JVM _ DEFAULT _ OVERRIDES _ JAVA _ DEFAULT "" \n + ) / / This is needed for cases when environment variable JDK _ 16 points to JDK 8 + . \n libraries \ stdlib \ src \ kotlin \ comparisons \ Comparisons . kt \n + @ Suppress ( "" EXTENSION _ SHADOWED _ BY _ MEMBER "" ) \n",Fix compilation in the case of JDK _ 16 pointing to JDK 1 . 8,21
"compiler \ daemon \ daemon - client \ src \ org \ jetbrains \ kotlin \ daemon \ client \ KotlinCompilerClient . kt \n + val javaVersion = System . getProperty ( "" java . specification . version "" ) ? . toIntOrNull ( ) \n + val javaIllegalAccessWorkaround = \n + if ( javaVersion ! = null & & javaVersion > = 17 ) \n + listOf ( "" - - illegal - access = permit "" ) \n + else emptyList ( ) \n + javaIllegalAccessWorkaround + \n","Workaround illegal access problem in daemon for JDK 17 - ea \n Otherwise Kotlin cannot be used in Gradle since \n https : / / github . com / openjdk / jdk / commit / ed4c4ee7 where JDK internals \n started to be encapsulated by default . \n For some reason , using \n listOf ( "" - - add - opens "" , "" java . base / java . util = ALL - UNNAMED "" ) \n doesn ' t help , so use the more general ` - - illegal - access = permit ` . \n # KT - 43704",21
"compiler \ testData \ integration \ ant \ jvm \ doNotIncludeRuntimeByDefault \ test . kt \n - var specifiedBeTrue = args [ 1 ] . toBoolean ( ) \n - for ( entry in JarFile ( jar ) . entries ( ) ) { \n - if ( ! specifiedBeTrue & & entry . name . startsWith ( "" kotlin / "" ) ) { \n - println ( "" Error : Kotlin runtime is expected to be excluded if the attribute \ "" includeRuntime \ "" is not specified to be true "" ) \n - break ; \n - } \n + var shouldIncludeRuntime = args [ 1 ] . toBoolean ( ) \n + val hasKotlinPackage = JarFile ( jar ) . entries ( ) . toList ( ) . any { it . name . startsWith ( "" kotlin / "" ) } \n + if ( shouldIncludeRuntime ! = hasKotlinPackage ) { \n + println ( \n + "" Error : Kotlin runtime is expected to be included only if the attribute \ "" includeRuntime \ "" is specified to be true \ n "" + \n + "" includeRuntime = $ { shouldIncludeRuntime } ; hasKotlinPackage = $ hasKotlinPackage "" \n + ) \n","Minor , improve Ant test on includeRuntime \n Also check that we _ do _ include runtime if includeRuntime is true .",21
"compiler \ backend \ src \ org \ jetbrains \ kotlin \ codegen \ writeAnnotationUtil . kt \n - import org . jetbrains . kotlin . metadata . jvm . deserialization . JvmBytecodeBinaryVersion \n - av . visit ( JvmAnnotationNames . BYTECODE _ VERSION _ FIELD _ NAME , JvmBytecodeBinaryVersion . INSTANCE . toArray ( ) ) \n",Do not write bytecode version to class file \n # KT - 41758,21
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ AbstractKotlinAndroidGradleTests . kt \n - val kotlinJvmTarget18Regex = Regex ( "" Kotlin compiler args : . * - jvm - target 1 . 8 "" ) \n + val kotlinJvmTarget16Regex = Regex ( "" Kotlin compiler args : . * - jvm - target 1 . 6 "" ) \n - sourceCompatibility JavaVersion . VERSION _ 1 _ 6 \n - targetCompatibility JavaVersion . VERSION _ 1 _ 6 \n + sourceCompatibility JavaVersion . VERSION _ 1 _ 8 \n + targetCompatibility JavaVersion . VERSION _ 1 _ 8 \n - assertNotContains ( kotlinJvmTarget18Regex ) \n + assertNotContains ( kotlinJvmTarget16Regex ) \n - sourceCompatibility JavaVersion . VERSION _ 1 _ 8 \n - targetCompatibility JavaVersion . VERSION _ 1 _ 8 \n + sourceCompatibility JavaVersion . VERSION _ 1 _ 6 \n + targetCompatibility JavaVersion . VERSION _ 1 _ 6 \n - assertNotContains ( kotlinJvmTarget18Regex ) \n + assertNotContains ( kotlinJvmTarget16Regex ) \n - assertContainsRegex ( kotlinJvmTarget18Regex ) \n + assertContainsRegex ( kotlinJvmTarget16Regex ) \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ plugin \ KotlinPlugin . kt \n - listOf ( baseExtension . compileOptions . sourceCompatibility , baseExtension . compileOptions . targetCompatibility ) . min ( ) ! ! \n - if ( javaVersion > = JavaVersion . VERSION _ 1 _ 8 ) \n - kotlinOptions . jvmTarget = "" 1 . 8 "" \n + minOf ( baseExtension . compileOptions . sourceCompatibility , baseExtension . compileOptions . targetCompatibility ) \n + if ( javaVersion = = JavaVersion . VERSION _ 1 _ 6 ) \n + kotlinOptions . jvmTarget = "" 1 . 6 "" \n","Change logic of applying JVM target from AGP options \n Now that the default JVM target is 1 . 8 , we have to add the JVM target \n 1 . 6 explicitly if the Android project is configured with source / target \n 1 . 6 , and not do anything if it ' s configured with 1 . 8 . \n # KT - 31027",21
"libraries \ commonConfiguration . gradle \n - useIR = project . kotlinBuildProperties . useIRForLibraries \n - freeCompilerArgs + = "" - Xuse - old - backend "" \n + if ( ! project . kotlinBuildProperties . useIRForLibraries ) { \n + useIR = false \n + freeCompilerArgs + = "" - Xuse - old - backend "" \n + } \n",Build : fix inaccurate change to the logic of useIRForLibraries,21
"compiler \ cli \ cli - common \ src \ org \ jetbrains \ kotlin \ cli \ common \ arguments \ CommonCompilerArguments . kt \n + @ Argument ( \n + value = "" - Xsuppress - version - warnings "" , \n + description = "" Suppress warnings about outdated , inconsistent or experimental language or API versions "" \n + ) \n + var suppressVersionWarnings : Boolean by FreezableVar ( false ) \n + \n - checkLanguageVersionIsStable ( languageVersion , collector ) \n - checkOutdatedVersions ( languageVersion , apiVersion , collector ) \n - checkProgressiveMode ( languageVersion , collector ) \n - checkIrSupport ( languageVersionSettings , collector ) \n + if ( ! suppressVersionWarnings ) { \n + checkLanguageVersionIsStable ( languageVersion , collector ) \n + checkOutdatedVersions ( languageVersion , apiVersion , collector ) \n + checkProgressiveMode ( languageVersion , collector ) \n + \n + checkIrSupport ( languageVersionSettings , collector ) \n + } \n compiler \ testData \ cli \ js \ jsExtraHelp . out \n - Xreport - perf Report detailed performance statistics \n - Xskip - metadata - version - check Allow to load classes with bad metadata version and pre - release classes \n - Xskip - prerelease - check Allow to load pre - release classes \n + - Xsuppress - version - warnings Suppress warnings about outdated , inconsistent or experimental language or API versions \n - Xuse - experimental = < fq . name > Enable , but don ' t propagate usages of experimental API for marker annotation with the given fully qualified name \n - Xuse - fir Compile using Front - end IR . Warning : this feature is far from being production - ready \n - Xuse - fir - extended - checkers Use extended analysis mode based on Front - end IR . Warning : this feature is far from being production - ready \n compiler \ testData \ cli \ jvm \ extraHelp . out \n - Xreport - perf Report detailed performance statistics \n - Xskip - metadata - version - check Allow to load classes with bad metadata version and pre - release classes \n - Xskip - prerelease - check Allow to load pre - release classes \n + - Xsuppress - version - warnings Suppress warnings about outdated , inconsistent or experimental language or API versions \n - Xuse - experimental = < fq . name > Enable , but don ' t propagate usages of experimental API for marker annotation with the given fully qualified name \n - Xuse - fir Compile using Front - end IR . Warning : this feature is far from being production - ready \n - Xuse - fir - extended - checkers Use extended analysis mode based on Front - end IR . Warning : this feature is far from being production - ready \n","Support - Xsuppress - version - warnings to suppress API / language version warnings \n To be used in the project after bootstrap to get rid of warnings like \n "" Language version 1 . 3 is deprecated , . . . "" which prevent us from enabling \n ` - Werror ` in ` : compiler : cli ` and other modules .",21
"build . gradle . kts \n - if ( ! kotlinBuildProperties . isInJpsBuildIdeaSync & & ! kotlinBuildProperties . useFir ) { \n + if ( ! kotlinBuildProperties . isInJpsBuildIdeaSync & & ! kotlinBuildProperties . useFir & & ! kotlinBuildProperties . disableWerror ) { \n buildSrc \ src \ main \ kotlin \ BuildPropertiesExt . kt \n + \n + val KotlinBuildProperties . disableWerror : Boolean get ( ) = getBoolean ( "" kotlin . build . disable . werror "" , isTeamcityBuild ) \n compiler \ build . gradle . kts \n - } else if ( ! kotlinBuildProperties . useFir ) { \n + } else if ( ! kotlinBuildProperties . useFir & & ! kotlinBuildProperties . disableWerror ) { \n libraries \ commonConfiguration . gradle \n - project . tasks . withType ( org . jetbrains . kotlin . gradle . dsl . KotlinCompile . class ) { task - > \n - if ( ! tasksWithWarnings . contains ( task . path ) ) { \n - task . kotlinOptions { \n - allWarningsAsErrors = true \n + if ( ! BuildPropertiesExtKt . getDisableWerror ( project . kotlinBuildProperties ) ) { \n + project . tasks . withType ( org . jetbrains . kotlin . gradle . dsl . KotlinCompile . class ) { task - > \n + if ( ! tasksWithWarnings . contains ( task . path ) ) { \n + task . kotlinOptions { \n + allWarningsAsErrors = true \n + } \n","Add kotlin . build . disable . werror to disable - Werror locally \n This can be placed , for example , in ` local . properties ` to temporarily \n disable ` - Werror ` in compiler / stdlib / plugin / test modules during \n development .",21
"libraries \ stdlib \ jvm \ runtime \ kotlin \ Metadata . kt \n + @ Deprecated ( \n + "" Bytecode version had no significant use in Kotlin metadata and it will be removed in a future version . "" , \n + level = DeprecationLevel . WARNING , \n + ) \n - val bytecodeVersion : IntArray = [ ] , \n + val bytecodeVersion : IntArray = [ 1 , 0 , 3 ] , \n",Deprecate kotlin . Metadata . bytecodeVersion \n # KT - 41758 Fixed,21
"new file \n plugins \ scripting \ scripting - compiler \ testData \ compiler \ metadata _ flag . kts \n + class RandomClass \n + \n + println ( ) \n plugins \ scripting \ scripting - compiler \ tests \ org \ jetbrains \ kotlin \ scripting \ compiler \ test \ ScriptTest . kt \n + import org . jetbrains . kotlin . load . java . JvmAnnotationNames \n + fun testMetadataFlag ( ) { \n + / / Test that we ' re writing the flag to [ Metadata . extraInt ] that distinguishes scripts from other classes . \n + \n + fun Class < * > . isFlagSet ( ) : Boolean { \n + val metadata = annotations . single { it . annotationClass . java . name = = Metadata : : class . java . name } \n + val extraInt = metadata . javaClass . methods . single { it . name = = JvmAnnotationNames . METADATA _ EXTRA _ INT _ FIELD _ NAME } \n + return ( extraInt ( metadata ) as Int ) and JvmAnnotationNames . METADATA _ SCRIPT _ FLAG ! = 0 \n + } \n + \n + val scriptClass = compileScript ( "" metadata _ flag . kts "" , StandardScriptDefinition ) ! ! \n + assertTrue ( "" Script class SHOULD have the metadata flag set "" , scriptClass . isFlagSet ( ) ) \n + assertFalse ( \n + "" Non - script class in a script should NOT have the metadata flag set "" , \n + scriptClass . classLoader . loadClass ( "" Metadata _ flag \ $ RandomClass "" ) . isFlagSet ( ) \n + ) \n + } \n + \n","Add test for script flag in kotlin . Metadata \n It passes at the moment because the test uses old backend , but the \n required behavior is not yet supported in JVM IR , and it ' ll need to be \n fixed .",21
core \ descriptors \ src \ org \ jetbrains \ kotlin \ types \ AbstractTypeConstructor . kt \n - if ( other . hashCode ( ) ! = hashCode ( ) ) return false \n + / / Cast to Any is needed as a workaround for KT - 45008 . \n + if ( ( other as Any ) . hashCode ( ) ! = hashCode ( ) ) return false \n,"Minor , add workaround for KT - 45008",21
"build . gradle . kts \n - "" : compiler : cli : compileKotlin "" , \n - "" : kotlin - scripting - compiler : compileKotlin "" , \n - "" : plugins : uast - kotlin : compileTestKotlin "" , \n - "" : plugins : uast - kotlin - idea : compileKotlin "" \n + "" : plugins : uast - kotlin : compileTestKotlin "" \n compiler \ cli \ build . gradle . kts \n - freeCompilerArgs = freeCompilerArgs - "" - progressive "" + "" - Xskip - prerelease - check "" \n + freeCompilerArgs = freeCompilerArgs - "" - progressive "" + listOf ( \n + "" - Xskip - prerelease - check "" , "" - Xsuppress - version - warnings "" \n + ) \n plugins \ uast - kotlin - idea \ src \ org \ jetbrains \ uast \ kotlin \ generate \ KotlinUastCodeGenerationPlugin . kt \n + @ Suppress ( "" UNUSED _ PARAMETER "" ) \n + @ Suppress ( "" UNUSED _ PARAMETER "" ) \n",Build : enable - Werror for several modules,21
"libraries \ stdlib \ wasm \ build . gradle . kts \n + / / TODO : fix all warnings , enable explicit API mode and - Werror \n + kotlinOptions . suppressWarnings = true \n + \n - "" - Xopt - in = kotlin . ExperimentalStdlibApi "" , \n - "" - Xexplicit - api = warning "" \n + "" - Xopt - in = kotlin . ExperimentalStdlibApi "" \n",Build : suppress warnings for kotlin - stdlib - wasm,21
"compiler \ fir \ fir2ir \ tests - gen \ org \ jetbrains \ kotlin \ test \ runners \ codegen \ FirBytecodeTextTestGenerated . java \n + \n + @ Test \n + @ TestMetadata ( "" interfaceHashCodeWithSmartCast . kt "" ) \n + public void testInterfaceHashCodeWithSmartCast ( ) throws Exception { \n + runTest ( "" compiler / testData / codegen / bytecodeText / hashCode / interfaceHashCodeWithSmartCast . kt "" ) ; \n + } \n compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ lower \ InheritedDefaultMethodsOnClassesLowering . kt \n - if ( ! callee . hasInterfaceParent ( ) ) \n + if ( ! callee . hasInterfaceParent ( ) & & expression . dispatchReceiver ? . run { type . erasedUpperBound . isJvmInterface } ! = true ) \n new file \n compiler \ testData \ codegen \ bytecodeText \ hashCode \ interfaceHashCodeWithSmartCast . kt \n + interface I \n + \n + class A : I { \n + fun f1 ( other : Any ? ) : Int = \n + if ( other is I ) other . hashCode ( ) else 0 \n + \n + inline fun < reified T : I > f2 ( other : Any ) : Int = \n + if ( other is T ) other . hashCode ( ) else 0 \n + \n + fun f3 ( ) { \n + f2 < A > ( A ( ) ) \n + } \n + } \n + \n + / / 3 INVOKEVIRTUAL java / lang / Object . hashCode \ ( \ ) I \n + / / 0 INVOKEINTERFACE \n compiler \ tests - common - new \ tests - gen \ org \ jetbrains \ kotlin \ test \ runners \ codegen \ BytecodeTextTestGenerated . java \n + \n + @ Test \n + @ TestMetadata ( "" interfaceHashCodeWithSmartCast . kt "" ) \n + public void testInterfaceHashCodeWithSmartCast ( ) throws Exception { \n + runTest ( "" compiler / testData / codegen / bytecodeText / hashCode / interfaceHashCodeWithSmartCast . kt "" ) ; \n + } \n compiler \ tests - common - new \ tests - gen \ org \ jetbrains \ kotlin \ test \ runners \ codegen \ IrBytecodeTextTestGenerated . java \n + \n + @ Test \n + @ TestMetadata ( "" interfaceHashCodeWithSmartCast . kt "" ) \n + public void testInterfaceHashCodeWithSmartCast ( ) throws Exception { \n + runTest ( "" compiler / testData / codegen / bytecodeText / hashCode / interfaceHashCodeWithSmartCast . kt "" ) ; \n + } \n",JVM IR : do not generate invokeinterface hashCode if smart cast is present \n # KT - 45008 Fixed,21
"rename from compiler \ ir \ ir . tree \ src \ org \ jetbrains \ kotlin \ ir \ util \ ExpectDeclarationRemover . kt \n rename to compiler \ ir \ backend . common \ src \ org \ jetbrains \ kotlin \ backend \ common \ lower \ ExpectDeclarationRemover . kt \n - * Copyright 2010 - 2019 JetBrains s . r . o . and Kotlin Programming Language contributors . \n + * Copyright 2010 - 2021 JetBrains s . r . o . and Kotlin Programming Language contributors . \n - package org . jetbrains . kotlin . ir . util \n + package org . jetbrains . kotlin . backend . common . lower \n - import org . jetbrains . kotlin . descriptors . ClassDescriptor \n + import org . jetbrains . kotlin . ir . util . * \n compiler \ ir \ backend . common \ src \ org \ jetbrains \ kotlin \ backend \ common \ lower \ ExpectDeclarationsRemoveLowering . kt \n - import org . jetbrains . kotlin . ir . util . ExpectDeclarationRemover \n compiler \ ir \ serialization . js \ build . gradle . kts \n + implementation ( project ( "" : compiler : ir . backend . common "" ) ) \n compiler \ ir \ serialization . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ klib . kt \n + import org . jetbrains . kotlin . backend . common . lower . ExpectDeclarationRemover \n",IR : move ExpectDeclarationRemover to ir . backend . common,21
compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ common \ CLICompiler . kt \n - import org . jetbrains . kotlin . analyzer . AnalysisResult \n + import org . jetbrains . kotlin . analyzer . CompilationErrorException \n - import java . util . * \n - } catch ( e : AnalysisResult . CompilationErrorException ) { \n + } catch ( e : CompilationErrorException ) { \n new file \n compiler \ frontend . common \ src \ org \ jetbrains \ kotlin \ analyzer \ CompilationErrorException . kt \n + / * \n + * Copyright 2010 - 2021 JetBrains s . r . o . and Kotlin Programming Language contributors . \n + * Use of this source code is governed by the Apache 2 . 0 license that can be found in the license / LICENSE . txt file . \n + * / \n + \n + package org . jetbrains . kotlin . analyzer \n + \n + class CompilationErrorException : RuntimeException ( ) \n compiler \ frontend \ src \ org \ jetbrains \ kotlin \ analyzer \ AnalysisResult . kt \n - class CompilationErrorException : RuntimeException ( ) \n - \n compiler \ ir \ ir . tree \ src \ org \ jetbrains \ kotlin \ ir \ util \ ExternalDependenciesGenerator . kt \n - import org . jetbrains . kotlin . analyzer . AnalysisResult \n + import org . jetbrains . kotlin . analyzer . CompilationErrorException \n - throw AnalysisResult . CompilationErrorException ( ) \n + throw CompilationErrorException ( ) \n compiler \ ir \ serialization . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ klib . kt \n + import org . jetbrains . kotlin . analyzer . CompilationErrorException \n - throw AnalysisResult . CompilationErrorException ( ) \n + throw CompilationErrorException ( ) \n,IR : move CompilationErrorException to frontend . common,21
"compiler \ ir \ backend . jvm \ src \ org \ jetbrains \ kotlin \ backend \ jvm \ JvmIrCodegenFactory . kt \n - import org . jetbrains . kotlin . resolve . BindingContext \n - override val bindingContext : BindingContext \n - get ( ) = psi2irContext . bindingContext \n compiler \ ir \ ir . tree \ src \ org \ jetbrains \ kotlin \ ir \ builders \ TranslationPluginContext . kt \n - import org . jetbrains . kotlin . resolve . BindingContext \n - \n - val bindingContext : BindingContext \n - } \n + } \n compiler \ ir \ serialization . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ klib . kt \n - JsIrLinker . JsFePluginContext ( moduleDescriptor , bindingContext , symbolTable , typeTranslator , irBuiltIns ) \n + JsIrLinker . JsFePluginContext ( moduleDescriptor , symbolTable , typeTranslator , irBuiltIns ) \n - JsIrLinker . JsFePluginContext ( moduleDescriptor , bindingContext , symbolTable , typeTranslator , irBuiltIns ) \n + JsIrLinker . JsFePluginContext ( moduleDescriptor , symbolTable , typeTranslator , irBuiltIns ) \n compiler \ ir \ serialization . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ lower \ serialization \ ir \ JsIrLinker . kt \n - import org . jetbrains . kotlin . resolve . BindingContext \n - override val bindingContext : BindingContext , \n","IR : remove TranslationPluginContext . bindingContext \n This removes another dependency of ' ir . tree ' on ' frontend ' , and among \n other things , makes it possible to implement TranslationPluginContext \n for FIR in the future .",21
"compiler \ ir \ ir . tree \ build . gradle . kts \n - \n - compile ( project ( "" : compiler : util "" ) ) \n - compile ( project ( "" : compiler : frontend "" ) ) \n + api ( project ( "" : core : descriptors "" ) ) \n + api ( project ( "" : core : deserialization "" ) ) \n + api ( project ( "" : compiler : frontend . common "" ) ) \n + implementation ( project ( "" : compiler : util "" ) ) \n + implementation ( project ( "" : compiler : config "" ) ) \n + \n - } \n + } \n",IR : remove dependency of ' ir . tree ' on ' frontend ',21
compiler \ testData \ codegen \ box \ fakeOverride \ privateFakeOverrides0 . kt \n - / / FILE : lib . kt \n + / / FILE : lib . kt \n compiler \ testData \ codegen \ box \ fakeOverride \ privateFakeOverrides1 . kt \n - / / FILE : lib . kt \n + / / FILE : lib . kt \n,"Revert "" Change order of WITH _ RUNTIME and FILE . Wrong order brakes module pattern . "" \n This reverts commit 073a50037049a4e0869085bf4acf7c29e56210e3 . \n ( cherry picked from commit eec98314c84cfb4ca6a8c57a3b0d33a41c146f20 )",21
compiler \ testData \ codegen \ box \ fakeOverride \ privateFakeOverrides0 . kt \n - / / FILE : lib . kt \n + / / FILE : lib . kt \n compiler \ testData \ codegen \ box \ fakeOverride \ privateFakeOverrides1 . kt \n - / / FILE : lib . kt \n + / / FILE : lib . kt \n,"Revert "" Change order of WITH _ RUNTIME and FILE . Wrong order brakes module pattern . "" \n This reverts commit 073a50037049a4e0869085bf4acf7c29e56210e3 .",21
"compiler \ frontend \ src \ org \ jetbrains \ kotlin \ analyzer \ AnalyzerFacade . kt \n - import org . jetbrains . kotlin . resolve . CliSealedClassInheritorsProvider \n - import java . util . * \n - sealedInheritorsProvider : SealedClassInheritorsProvider = CliSealedClassInheritorsProvider \n + sealedInheritorsProvider : SealedClassInheritorsProvider , \n compiler \ frontend \ src \ org \ jetbrains \ kotlin \ analyzer \ ResolverForSingleModuleProject . kt \n + import org . jetbrains . kotlin . resolve . CliSealedClassInheritorsProvider \n - languageVersionSettings \n + languageVersionSettings , \n + CliSealedClassInheritorsProvider , \n - } \n + } \n compiler \ frontend \ src \ org \ jetbrains \ kotlin \ frontend \ di \ injection . kt \n - sealedProvider : SealedClassInheritorsProvider = CliSealedClassInheritorsProvider \n + sealedProvider : SealedClassInheritorsProvider , \n - sealedProvider : SealedClassInheritorsProvider = CliSealedClassInheritorsProvider \n + sealedProvider : SealedClassInheritorsProvider , \n compiler \ tests \ org \ jetbrains \ kotlin \ jvm \ compiler \ MultiModuleJavaAnalysisCustomTest . kt \n - import org . jetbrains . kotlin . resolve . PlatformDependentAnalyzerServices \n + import org . jetbrains . kotlin . resolve . CliSealedClassInheritorsProvider \n + import org . jetbrains . kotlin . resolve . PlatformDependentAnalyzerServices \n - import java . util . * \n - LanguageVersionSettingsImpl . DEFAULT \n + LanguageVersionSettingsImpl . DEFAULT , \n + CliSealedClassInheritorsProvider , \n idea \ idea - analysis \ src \ org \ jetbrains \ kotlin \ idea \ caches \ resolve \ IdeaResolverForProject . kt \n - sealedInheritorsProvider = IdeSealedClassInheritorsProvider \n + IdeSealedClassInheritorsProvider , \n","Minor , pass CliSealedClassInheritorsProvider explicitly in some places \n Do not use default parameter value for functions with only 1 or 2 call \n sites , since it doesn ' t add much value but provides a dangerous \n possibility to forget to pass the real implementation .",21
"kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ PsiToIr . kt \n - import org . jetbrains . kotlin . backend . konan . ir . konanLibrary \n + import org . jetbrains . kotlin . backend . konan . ir . konanLibrary \n - import org . jetbrains . kotlin . backend . konan . serialization . KonanIrLinker \n - override val bindingContext : BindingContext \n - get ( ) = generatorContext . bindingContext \n kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ serialization \ KonanIrlinker . kt \n - import org . jetbrains . kotlin . resolve . BindingContext \n - override val bindingContext : BindingContext , \n - } \n + } \n","IR : remove TranslationPluginContext . bindingContext \n This removes another dependency of ' ir . tree ' on ' frontend ' , and among \n other things , makes it possible to implement TranslationPluginContext \n for FIR in the future .",21
kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ PsiToIr . kt \n + import org . jetbrains . kotlin . psi2ir . generators . DeclarationStubGeneratorImpl \n - val stubGenerator = DeclarationStubGenerator ( \n + val stubGenerator = DeclarationStubGeneratorImpl ( \n,IR : move frontend - dependent code into implementations in psi2ir,21
"compiler \ tests - common - new \ tests \ org \ jetbrains \ kotlin \ test \ backend \ handlers \ BinaryArtifactHandlers . kt \n - doNotRunIfThereWerePreviousFailures : Boolean = false \n - doNotRunIfThereWerePreviousFailures \n + doNotRunIfThereWerePreviousFailures = true , \n compiler \ tests - common - new \ tests \ org \ jetbrains \ kotlin \ test \ backend \ handlers \ DxCheckerHandler . kt \n - class DxCheckerHandler ( testServices : TestServices ) : JvmBinaryArtifactHandler ( testServices , doNotRunIfThereWerePreviousFailures = true ) { \n + class DxCheckerHandler ( testServices : TestServices ) : JvmBinaryArtifactHandler ( testServices ) { \n compiler \ tests - common - new \ tests \ org \ jetbrains \ kotlin \ test \ backend \ handlers \ JvmBoxRunner . kt \n - class JvmBoxRunner ( testServices : TestServices ) : JvmBinaryArtifactHandler ( testServices , doNotRunIfThereWerePreviousFailures = true ) { \n + class JvmBoxRunner ( testServices : TestServices ) : JvmBinaryArtifactHandler ( testServices ) { \n","Do not ever run JVM test handlers after previous errors \n If there ' s a frontend error in a test , or bytecode generation crashed \n with an exception , it makes no sense to run JVM test handlers such as \n lambda inlining checker or D8 checker .",21
"idea \ idea - frontend - fir \ idea - fir - low - level - api \ build . gradle . kts \n + implementation ( project ( "" : compiler : ir . psi2ir "" ) ) \n",Fix compilation of idea - fir - low - level - api,21
"libraries \ stdlib \ src \ kotlin \ time \ DurationUnit . kt \n + @ Suppress ( "" REDUNDANT _ ELSE _ IN _ WHEN "" ) \n","Minor , fix compilation warning in DurationUnit . kt",21
"compiler \ util - io \ src \ org \ jetbrains \ kotlin \ util \ Util . kt \n + import org . jetbrains . kotlin . konan . file . File \n - import org . jetbrains . kotlin . konan . file . * \n - import java . lang . StringBuilder \n - fun < T > printMillisec ( message : String , body : ( ) - > T ) : T { \n - var msec = 0L \n - try { \n - msec = measureTimeMillis { \n - return body ( ) \n - } \n - } finally { \n - println ( "" $ message : $ msec msec "" ) \n - } \n - error ( "" shouldn ' t happens "" ) \n + private fun printMilliseconds ( message : String , body : ( ) - > Unit ) { \n + val time = measureTimeMillis ( body ) \n + println ( "" $ message : $ time ms "" ) \n - fun profileIf ( condition : Boolean , message : String , body : ( ) - > Unit ) = \n - if ( condition ) printMillisec ( message , body ) else body ( ) \n + private fun profileIf ( condition : Boolean , message : String , body : ( ) - > Unit ) = \n + if ( condition ) printMilliseconds ( message , body ) else body ( ) \n","Fix warnings in Util . kt \n There were unreachable code warnings in printMillisec , and indeed the \n variable assignment was never executed , so the function would always \n print "" 0 msec "" .",21
compiler \ tests - compiler - utils \ tests \ org \ jetbrains \ kotlin \ test \ AnalysisFlagExtractor . kt \n - JvmSamConversions . Companion : : fromString \n + JvmClosureGenerationScheme . Companion : : fromString \n,Fix compilation in tests - compiler - utils,21
"buildSrc \ src \ main \ kotlin \ BuildPropertiesExt . kt \n - val KotlinBuildProperties . disableWerror : Boolean get ( ) = getBoolean ( "" kotlin . build . disable . werror "" , isTeamcityBuild ) \n + val KotlinBuildProperties . disableWerror : Boolean get ( ) = getBoolean ( "" kotlin . build . disable . werror "" , false ) \n",Build : fix default value for kotlin . build . disable . werror,21
"core \ descriptors . runtime \ src \ org \ jetbrains \ kotlin \ descriptors \ runtime \ structure \ reflectClassUtil . kt \n - get ( ) { \n - if ( this = = Void . TYPE ) return "" V "" \n - / / This is a clever exploitation of a format returned by Class . getName ( ) : for arrays , it ' s almost an internal name , \n - / / but with ' . ' instead of ' / ' \n - return createArrayType ( ) . name . substring ( 1 ) . replace ( ' . ' , ' / ' ) \n + get ( ) = when { \n + isPrimitive - > when ( name ) { \n + "" boolean "" - > "" Z "" \n + "" char "" - > "" C "" \n + "" byte "" - > "" B "" \n + "" short "" - > "" S "" \n + "" int "" - > "" I "" \n + "" float "" - > "" F "" \n + "" long "" - > "" J "" \n + "" double "" - > "" D "" \n + "" void "" - > "" V "" \n + else - > throw IllegalArgumentException ( "" Unsupported primitive type : $ this "" ) \n + } \n + isArray - > name . replace ( ' . ' , ' / ' ) \n + else - > "" L $ { name . replace ( ' . ' , ' / ' ) } ; "" \n - fun Class < * > . createArrayType ( ) : Class < * > = \n - Array . newInstance ( this , 0 ) : : class . java \n - \n core \ reflection . jvm \ src \ kotlin \ reflect \ jvm \ internal \ KDeclarationContainerImpl . kt \n - import org . jetbrains . kotlin . descriptors . runtime . structure . createArrayType \n core \ reflection . jvm \ src \ kotlin \ reflect \ jvm \ internal \ KTypeImpl . kt \n - import org . jetbrains . kotlin . descriptors . runtime . structure . createArrayType \n core \ reflection . jvm \ src \ kotlin \ reflect \ jvm \ internal \ util . kt \n + internal fun Class < * > . createArrayType ( ) : Class < * > = \n + java . lang . reflect . Array . newInstance ( this , 0 ) : : class . java \n + \n","Do not create Array instance in kotlin - reflect where not necessary \n Although the previous code of computing JVM internal name from a Class \n instance was shorter , it led to unnecessary creation of array types , \n which is less performant and makes configuration of kotlin - reflect for \n GraalVM native - image more verbose . \n Unfortunately I didn ' t succeed in writing a test for this , since \n ` Array . newInstance ` calls a native method which doesn ' t record any trace \n of it being called in the class loader : the resulting array type never \n goes through findClass / loadClass , and is not visible via \n findLoadedClass . \n # KT - 44594 Fixed",21
ChangeLog . md \n - # # # [ ChangeLog - 1 . 3 . X ] ( ChangeLog - 1 . 3 . X . md ) \n - # # # [ ChangeLog - 1 . 2 . X ] ( ChangeLog - 1 . 2 . X . md ) \n - # # # [ ChangeLog - 1 . 1 . X ] ( ChangeLog - 1 . 1 . X . md ) \n - # # # [ ChangeLog - 1 . 0 . X ] ( ChangeLog - 1 . 0 . X . md ) \n + # # # [ ChangeLog - 1 . 3 . X ] ( docs / changelogs / ChangeLog - 1 . 3 . X . md ) \n + # # # [ ChangeLog - 1 . 2 . X ] ( docs / changelogs / ChangeLog - 1 . 2 . X . md ) \n + # # # [ ChangeLog - 1 . 1 . X ] ( docs / changelogs / ChangeLog - 1 . 1 . X . md ) \n + # # # [ ChangeLog - 1 . 0 . X ] ( docs / changelogs / ChangeLog - 1 . 0 . X . md ) \n rename from ChangeLog - 1 . 0 . X . md \n rename to docs \ changelogs \ ChangeLog - 1 . 0 . X . md \n rename from ChangeLog - 1 . 1 . X . md \n rename to docs \ changelogs \ ChangeLog - 1 . 1 . X . md \n rename from ChangeLog - 1 . 2 . X . md \n rename to docs \ changelogs \ ChangeLog - 1 . 2 . X . md \n rename from ChangeLog - 1 . 3 . X . md \n rename to docs \ changelogs \ ChangeLog - 1 . 3 . X . md \n,Move old changelogs to docs / changelogs /,21
"compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ jvm \ compiler \ CompileEnvironmentUtil . java \n - import java . util . * ; \n + import java . util . Calendar ; \n + import java . util . GregorianCalendar ; \n - if ( ( ! FileUtilRt . extensionEquals ( e . getName ( ) , "" class "" ) & & \n - ! FileUtilRt . extensionEquals ( e . getName ( ) , BuiltInSerializerProtocol . BUILTINS _ FILE _ EXTENSION ) ) | | \n - StringsKt . substringAfterLast ( e . getName ( ) , "" / "" , e . getName ( ) ) . equals ( "" module - info . class "" ) ) { \n + String name = e . getName ( ) ; \n + if ( ! FileUtilRt . extensionEquals ( name , "" class "" ) & & \n + ! FileUtilRt . extensionEquals ( name , BuiltInSerializerProtocol . BUILTINS _ FILE _ EXTENSION ) & & \n + ! name . startsWith ( "" META - INF / services / "" ) ) { \n + if ( StringsKt . substringAfterLast ( name , "" / "" , name ) . equals ( "" module - info . class "" ) ) continue ; \n compiler \ testData \ integration \ smoke \ reflect \ reflect . kt \n + import kotlin . reflect . jvm . kotlinFunction \n + \n - } \n + KotlinVersion : : class . java . methods . first ( ) . kotlinFunction \n + } \n","CLI : include META - INF / services / from kotlin - reflect with - include - runtime \n This is an addition to bd205317aae15816783df332eae851483167f3cd where we \n started to add the contents of kotlin - reflect into the resulting jar if \n - include - runtime is specified . Apparently kotlin - reflect doesn ' t work \n without some services in META - INF / services / , which didn ' t satisfy the \n condition for inclusion . The existing test didn ' t catch that because \n loading class annotations does not always lead to those services being \n loaded .",21
"compiler \ test - infrastructure \ tests \ org \ jetbrains \ kotlin \ test \ model \ Modules . kt \n + override fun equals ( other : Any ? ) : Boolean = \n + other is TestModule & & name = = other . name \n + \n + override fun hashCode ( ) : Int = name . hashCode ( ) \n + \n compiler \ tests - common - new \ tests \ org \ jetbrains \ kotlin \ test \ backend \ handlers \ JvmBoxRunner . kt \n - import org . jetbrains . kotlin . cli . jvm . config . jvmClasspathRoots \n + import org . jetbrains . kotlin . test . model . DependencyKind \n + import org . jetbrains . kotlin . test . services . dependencyProvider \n + import org . jetbrains . kotlin . utils . addIfNotNull \n - val ktFiles = info . classFileFactory . inputFiles \n + val ktFiles = info . classFileFactory . inputFiles . ifEmpty { return } \n - @ OptIn ( ExperimentalStdlibApi : : class ) \n - val urls = buildList { \n - addAll ( configuration . jvmClasspathRoots ) \n - testServices . compiledClassesManager . getCompiledJavaDirForModule ( module ) ? . let { \n - add ( it ) \n - } \n - } . map { it . toURI ( ) . toURL ( ) } \n - return GeneratedClassLoader ( classFileFactory , parentClassLoader , * urls . toTypedArray ( ) ) \n + val classpath = computeRuntimeClasspath ( module ) \n + return GeneratedClassLoader ( classFileFactory , parentClassLoader , * classpath . map { it . toURI ( ) . toURL ( ) } . toTypedArray ( ) ) \n + } \n + \n + private fun computeRuntimeClasspath ( rootModule : TestModule ) : List < File > { \n + val visited = mutableSetOf < TestModule > ( ) \n + val result = mutableListOf < File > ( ) \n + \n + fun computeClasspath ( module : TestModule , isRoot : Boolean ) { \n + if ( ! visited . add ( module ) ) return \n + \n + if ( ! isRoot ) { \n + result . add ( testServices . compiledClassesManager . getCompiledKotlinDirForModule ( module ) ) \n + } \n + result . addIfNotNull ( testServices . compiledClassesManager . getCompiledJavaDirForModule ( module ) ) \n + \n + for ( dependency in module . dependencies + module . friends ) { \n + if ( dependency . kind = = DependencyKind . Binary ) { \n + computeClasspath ( testServices . dependencyProvider . getTestModule ( dependency . moduleName ) , false ) \n + } \n + } \n + } \n + \n + computeClasspath ( rootModule , true ) \n + return result \n","Tests : compute runtime classpath for JVM box tests manually \n Taking just the ` jvmClasspathRoots ` is not correct because it also \n contains stuff needed for resolve to work correctly , such as JDK ( full \n or mock ) , stdlib ( full or mock ) , reflect . JDK is obviously not needed in \n the classpath , and stdlib / reflect are available via the parent class \n loader , which is specifically reused across all tests to make them run \n faster . \n Also , don ' t try to create class loader for Java - only modules in \n ` JvmBoxRunner . processModule ` . This happens , for example , for all tests \n which were moved from ` boxAgainstJava ` .",21
"compiler \ tests \ org \ jetbrains \ kotlin \ code \ CodeConformanceTest . kt \n + "" libraries / stdlib / wasm / build "" , \n","Exclude libraries / stdlib / wasm / build in CodeConformanceTest \n Similarly to libraries / stdlib / js - ir / build , there are some copyrights \n produced during the build , which should not be checked in this test .",21
compiler \ testData \ javaModules \ jdkModulesFromNamed \ main \ module - info . java \n - requires oracle . desktop ; \n compiler \ testData \ javaModules \ jdkModulesFromNamed \ main \ test . kt \n - fun main ( args : Array < String > ) { \n + fun main ( ) { \n - \n - / / Module oracle . desktop \n - val a : com . oracle . awt . AWTUtils ? = null \n - println ( a ) \n compiler \ testData \ javaModules \ jdkModulesFromUnnamed \ main \ test . kt \n - fun main ( args : Array < String > ) { \n + fun main ( ) { \n - \n - / / Module oracle . desktop \n - val a : com . oracle . awt . AWTUtils ? = null \n - println ( a ) \n,"Fix Java 9 module tests for many JDKs \n Module ' oracle . desktop ' is not guaranteed to be present in JDK . Also , \n its usage in these tests doesn ' t check anything new that isn ' t already \n checked by usages of jdk . net and jdk . httpserver .",21
"compiler \ cli \ src \ org \ jetbrains \ kotlin \ cli \ jvm \ jvmArguments . kt \n + \n + if ( arguments . useIR & & arguments . useOldBackend ) { \n + messageCollector . report ( \n + STRONG _ WARNING , \n + "" Both - Xuse - ir and - Xuse - old - backend are passed . This is an inconsistent configuration . "" + \n + "" The compiler will use the $ { if ( useIR ) "" JVM IR "" else "" old JVM "" } backend "" \n + ) \n + } \n + messageCollector . report ( LOGGING , "" Using $ { if ( useIR ) "" JVM IR "" else "" old JVM "" } backend "" ) \n + \n new file \n compiler \ testData \ cli \ jvm \ bothJvmIrAndOldBackend . args \n + $ TESTDATA _ DIR $ / simple . kt \n + - d \n + $ TEMP _ DIR $ \n + - Xuse - ir \n + - Xuse - old - backend \n new file \n compiler \ testData \ cli \ jvm \ bothJvmIrAndOldBackend . out \n + warning : both - Xuse - ir and - Xuse - old - backend are passed . This is an inconsistent configuration . The compiler will use the old JVM backend \n + OK \n compiler \ testData \ integration \ ant \ jvm \ verbose \ build . log . expected \n + [ kotlinc ] logging : using old JVM backend \n compiler \ tests - gen \ org \ jetbrains \ kotlin \ cli \ CliTestGenerated . java \n + @ TestMetadata ( "" bothJvmIrAndOldBackend . args "" ) \n + public void testBothJvmIrAndOldBackend ( ) throws Exception { \n + runTest ( "" compiler / testData / cli / jvm / bothJvmIrAndOldBackend . args "" ) ; \n + } \n + \n",Add warning if both - Xuse - ir and - Xuse - old - backend are passed,21
"compiler \ fir \ tree \ tree - generator \ src \ org \ jetbrains \ kotlin \ fir \ tree \ generator \ printer \ SmartPrinter . kt \n - GeneratorsFileUtil . writeFileIfContentChanged ( this , newText ) \n - } \n + GeneratorsFileUtil . writeFileIfContentChanged ( this , newText , logNotChanged = false ) \n + } \n","Minor , do not output "" Not changed "" for generated FIR checkers on each build",21
compiler \ daemon \ daemon - client \ src \ org \ jetbrains \ kotlin \ daemon \ client \ KotlinCompilerClient . kt \n - if ( javaVersion ! = null & & javaVersion > = 17 ) \n + if ( javaVersion ! = null & & javaVersion > = 16 ) \n,"Apply illegal - access = permit workaround for JDK 16 + \n Apparently , the openjdk commit that enabled JEP 396 ( encapsulated JDK \n defaults ) is effective since jdk - 16 + 28 : \n https : / / github . com / openjdk / jdk / commit / ed4c4ee7",21
"libraries \ tools \ kotlin - allopen \ build . gradle \n - kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" ] \n + kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" , "" - Xskip - runtime - version - check "" ] \n libraries \ tools \ kotlin - noarg \ build . gradle \n - kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" ] \n + kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" , "" - Xskip - runtime - version - check "" ] \n libraries \ tools \ kotlin - sam - with - receiver \ build . gradle \n - kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" ] \n + kotlinOptions . freeCompilerArgs + = [ "" - Xskip - prerelease - check "" , "" - Xskip - runtime - version - check "" ] \n libraries \ tools \ kotlin - serialization \ build . gradle \n + tasks . withType ( project . compileKotlin . class ) { \n + kotlinOptions . freeCompilerArgs + = [ "" - Xskip - runtime - version - check "" ] \n + } \n + \n plugins \ pill \ pill - importer \ build . gradle . kts \n - } \n + } \n + \n + tasks . withType < org . jetbrains . kotlin . gradle . dsl . KotlinCompile < * > > { \n + kotlinOptions { \n + freeCompilerArgs = freeCompilerArgs + "" - Xskip - runtime - version - check "" \n + } \n + } \n","Suppress "" runtime JAR files version mismatch "" warnings in some plugins",21
"compiler \ testData \ codegen \ box \ typeMapping \ genericTypeWithNothing . kt \n - if ( ( it . type = = it . genericType ) = = expectedIsRaw ) return "" failed on field ' $ { clazz . simpleName } : : $ { it . name } ' "" \n + if ( ( it . type = = it . genericType ) ! = expectedIsRaw ) return "" failed on field ' $ { clazz . simpleName } : : $ { it . name } ' "" \n - if ( ( m . parameterTypes [ i ] = = m . genericParameterTypes [ i ] ) = = expectedIsRaw ) return "" failed on type of param # $ i of method ' $ { clazz . simpleName } : : $ { m . name } ' "" \n + if ( ( m . parameterTypes [ i ] = = m . genericParameterTypes [ i ] ) ! = expectedIsRaw ) return "" failed on type of param # $ i of method ' $ { clazz . simpleName } : : $ { m . name } ' "" \n - if ( m . returnType ! = Void . TYPE & & ( m . returnType = = m . genericReturnType ) = = expectedIsRaw ) return "" failed on return type of method ' $ { clazz . simpleName } : : $ { m . name } ' "" \n + if ( m . returnType ! = Void . TYPE & & ( m . returnType = = m . genericReturnType ) ! = expectedIsRaw ) return "" failed on return type of method ' $ { clazz . simpleName } : : $ { m . name } ' "" \n - testAllDeclaredMembers ( TestRaw : : class , expectedIsRaw = true ) ? : \n + testAllDeclaredMembers ( TestRaw : : class , expectedIsRaw = true ) ? . let { return it } \n - testAllDeclaredMembers ( C1 : : class , expectedIsRaw = true ) ? : \n + testAllDeclaredMembers ( C1 : : class , expectedIsRaw = true ) ? . let { return it } \n",Fix codegen test data for genericTypeWithNothing . kt \n # KT - 18367 Fixed \n Co - authored - by : Zalim Bashorov < zalim . bashorov @ jetbrains . com >,21
"compiler \ fir \ fir2ir \ tests - gen \ org \ jetbrains \ kotlin \ codegen \ ir \ FirBytecodeTextTestGenerated . java \n - @ TestMetadata ( "" kt15806 . kt "" ) \n - public void testKt15806 ( ) throws Exception { \n - runTest ( "" compiler / testData / codegen / bytecodeText / whenEnumOptimization / kt15806 . kt "" ) ; \n - } \n - \n deleted file \n compiler \ testData \ codegen \ bytecodeText \ whenEnumOptimization \ kt15806 . kt \n - / / IGNORE _ BACKEND : JVM _ IR \n - / / TODO KT - 36845 Generate enum - based TABLESWITCH / LOOKUPSWITCH on a value with smart cast to enum in JVM _ IR \n - \n - private fun Any ? . doTheThing ( ) : String { \n - when ( this ) { \n - is String - > return this \n - is Level - > { \n - when ( this ) { \n - Level . O - > return Level . O . name \n - Level . K - > return Level . K . name \n - } \n - } \n - \n - else - > return "" fail "" \n - } \n - } \n - \n - \n - enum class Level { \n - O , \n - K \n - } \n - \n - \n - fun box ( ) : String { \n - return "" O "" . doTheThing ( ) + Level . K . doTheThing ( ) \n - } \n - \n - / / 1 TABLESWITCH \n compiler \ tests - gen \ org \ jetbrains \ kotlin \ codegen \ BytecodeTextTestGenerated . java \n - @ TestMetadata ( "" kt15806 . kt "" ) \n - public void testKt15806 ( ) throws Exception { \n - runTest ( "" compiler / testData / codegen / bytecodeText / whenEnumOptimization / kt15806 . kt "" ) ; \n - } \n - \n compiler \ tests - gen \ org \ jetbrains \ kotlin \ codegen \ ir \ IrBytecodeTextTestGenerated . java \n - @ TestMetadata ( "" kt15806 . kt "" ) \n - public void testKt15806 ( ) throws Exception { \n - runTest ( "" compiler / testData / codegen / bytecodeText / whenEnumOptimization / kt15806 . kt "" ) ; \n - } \n - \n","Remove bytecode text test kt15806 . kt \n It ' s not correct to expect that the backend generates the ` when ` in this \n test as tableswitch because there are only two branches . JVM IR has a \n cutoff in the when optimization and generates ` when ` s with fewer than 3 \n branches as if - else chains , which is probably better . Note that there ' s \n also a corresponding box test in when / enumOptimization / , so the backend \n behavior is still tested .",21
"gradle \ report . gradle . kts \n - log . warn ( "" Build time for tasks : "" ) \n + log . info ( "" Build time for tasks : "" ) \n - log . warn ( "" $ { category . description ( ) } : $ { timeSec . asShortString ( ) } s ( $ { percent . asShortString ( ) } % of total time ) "" ) \n + log . info ( "" $ { category . description ( ) } : $ { timeSec . asShortString ( ) } s ( $ { percent . asShortString ( ) } % of total time ) "" ) \n - } \n + } \n","Build : output build time for tasks with - - info \n To minimize the amount of output during project build , to make it more \n comfortable to work with the project in the terminal .",21
"compiler \ tests - for - compiler - generator \ tests \ org \ jetbrains \ kotlin \ test \ generators \ GenerateJUnit3CompilerTests . kt \n - model ( "" integration / ant / jvm "" , extension = null , recursive = false , excludeParentDirs = true ) \n + model ( "" integration / ant / jvm "" , extension = null , recursive = false ) \n compiler \ tests - gen \ org \ jetbrains \ kotlin \ integration \ AntTaskTestGenerated . java \n + @ TestMetadata ( "" fork "" ) \n + public void testFork ( ) throws Exception { \n + runTest ( "" compiler / testData / integration / ant / jvm / fork / "" ) ; \n + } \n + \n + @ TestMetadata ( "" forkOnError "" ) \n + public void testForkOnError ( ) throws Exception { \n + runTest ( "" compiler / testData / integration / ant / jvm / forkOnError / "" ) ; \n + } \n + \n + @ TestMetadata ( "" manySourceRoots "" ) \n + public void testManySourceRoots ( ) throws Exception { \n + runTest ( "" compiler / testData / integration / ant / jvm / manySourceRoots / "" ) ; \n + } \n + \n","Fix incorrect generation of Ant task tests , restore tests",21
presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ JoinStatsRule . java \n + if ( joinComplementRowCount = = 0 ) { \n + return innerJoinStats ; \n + } \n + \n,Add additional division by zero checks to JoinStatsRule,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ FilterStatsCalculator . java \n - return differenceInStats ( input , process ( node . getValue ( ) ) ) ; \n + PlanNodeStatsEstimate sourceStats = process ( node . getValue ( ) ) ; \n + if ( sourceStats . isOutputRowCountUnknown ( ) ) { \n + return PlanNodeStatsEstimate . unknown ( ) ; \n + } \n + return differenceInStats ( input , sourceStats ) ; \n",Add extra checks for unknown stats in FilterStatsCalculator,34
"presto - orc \ src \ main \ java \ com \ facebook \ presto \ orc \ metadata \ statistics \ StringStatisticsBuilder . java \n - if ( partialStatistics = = null ) { \n + if ( partialStatistics = = null | | ( partialStatistics . getMin ( ) = = null & & partialStatistics . getMax ( ) = = null ) ) { \n presto - orc \ src \ test \ java \ com \ facebook \ presto \ orc \ metadata \ statistics \ TestStringStatisticsBuilder . java \n + @ Test \n + public void testMergeWithNullMinMaxValues ( ) \n + { \n + List < ColumnStatistics > statisticsList = new ArrayList < > ( ) ; \n + statisticsList . add ( stringColumnStatistics ( MEDIUM _ BOTTOM _ VALUE , MEDIUM _ BOTTOM _ VALUE ) ) ; \n + assertMinMax ( mergeColumnStatistics ( statisticsList ) . getStringStatistics ( ) , MEDIUM _ BOTTOM _ VALUE , MEDIUM _ BOTTOM _ VALUE ) ; \n + statisticsList . add ( stringColumnStatistics ( null , null ) ) ; \n + assertMinMax ( mergeColumnStatistics ( statisticsList ) . getStringStatistics ( ) , null , null ) ; \n + } \n + \n",Allow StringStatistics with both min and max set to null \n The ColumnStatistics # mergeColumnStatistics method is now used also for \n merging stats from the ORC files written by other systems . Thus we \n cannot enforce that there will be no StringStatistics with both min \n and max set to null .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ ScalarStatsCalculator . java \n + import static java . lang . Double . NaN ; \n - if ( node . getOperator ( ) = = ArithmeticBinaryExpression . Operator . DIVIDE & & rightLow < 0 & & rightHigh > 0 ) { \n + if ( isNaN ( leftLow ) | | isNaN ( leftHigh ) | | isNaN ( rightLow ) | | isNaN ( rightHigh ) ) { \n + result . setLowValue ( NaN ) \n + . setHighValue ( NaN ) ; \n + } \n + else if ( node . getOperator ( ) = = ArithmeticBinaryExpression . Operator . DIVIDE & & rightLow < 0 & & rightHigh > 0 ) { \n presto - main \ src \ test \ java \ com \ facebook \ presto \ cost \ TestScalarStatsCalculator . java \n + @ Test \n + public void testArithmeticBinaryWithAllNullsSymbol ( ) \n + { \n + SymbolStatsEstimate allNullStats = SymbolStatsEstimate . zero ( ) ; \n + PlanNodeStatsEstimate relationStats = PlanNodeStatsEstimate . builder ( ) \n + . addSymbolStatistics ( new Symbol ( "" x "" ) , SymbolStatsEstimate . builder ( ) \n + . setLowValue ( - 1 ) \n + . setHighValue ( 10 ) \n + . setDistinctValuesCount ( 4 ) \n + . setNullsFraction ( 0 . 1 ) \n + . setAverageRowSize ( 0 ) \n + . build ( ) ) \n + . addSymbolStatistics ( new Symbol ( "" all _ null "" ) , allNullStats ) \n + . setOutputRowCount ( 10 ) \n + . build ( ) ; \n + \n + assertCalculate ( expression ( "" x + all _ null "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" x - all _ null "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" all _ null - x "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" all _ null * x "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" x % all _ null "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" all _ null % x "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" x / all _ null "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + assertCalculate ( expression ( "" all _ null / x "" ) , relationStats ) \n + . isEqualTo ( allNullStats ) ; \n + } \n + \n",Add additional NaN check in ScalarStatsCalculator # visitArithmeticBinary,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ StatisticRange . java \n - if ( this . equals ( other ) ) { \n - return 1 . 0 ; \n + if ( this . isEmpty ( ) | | other . isEmpty ( ) | | this . distinctValues = = 0 | | other . distinctValues = = 0 ) { \n + return 0 . 0 ; / / zero is better than NaN as it will behave properly for calculating row count \n - if ( this . isEmpty ( ) | | other . isEmpty ( ) ) { \n - return 0 . 0 ; / / zero is better than NaN as it will behave properly for calculating row count \n + if ( this . equals ( other ) ) { \n + return 1 . 0 ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ cost \ TestStatisticRange . java \n + \n + assertOverlap ( unboundedRange ( 0 . 1 ) , unboundedRange ( 1 ) , 1 ) ; \n + assertOverlap ( unboundedRange ( 0 . 0 ) , unboundedRange ( 1 ) , 0 ) ; \n + assertOverlap ( unboundedRange ( 0 . 0 ) , unboundedRange ( 0 ) , 0 ) ; \n",Add additional checks to StatisticRange \n Nothing doesn ' t overlap with anything .,34
pom . xml \n - < dep . drift . version > 1 . 15 < / dep . drift . version > \n + < dep . drift . version > 1 . 17 < / dep . drift . version > \n,Update Drift to 1 . 17 \n This version includes multiple important bug fixes : \n - Fail only single request on too large frame \n https : / / github . com / airlift / drift / pull / 102 \n - Add delay before retrying same address \n https : / / github . com / airlift / drift / pull / 101 \n - Check if pooled connection is still open \n https : / / github . com / airlift / drift / pull / 95,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ QueryStateMachine . java \n + / / When the state enters FINISHING , the only thing remaining is to commit \n + / / the transaction . It should only be failed if the transaction commit fails . \n + QueryState currentState = queryState . get ( ) ; \n + if ( ! predicate . test ( currentState ) ) { \n + QUERY _ STATE _ LOG . debug ( throwable , "" Failure is ignored as the query % s is the % s state , "" , queryId , currentState ) ; \n + return false ; \n + } \n + \n presto - main \ src \ test \ java \ com \ facebook \ presto \ execution \ TestQueryStateMachine . java \n - / / assertEquals ( stateMachine . getFailureInfo ( ) . get ( ) . getMessage ( ) , "" transaction failed "" ) ; \n + assertEquals ( stateMachine . getFailureInfo ( ) . get ( ) . getMessage ( ) , "" transaction failed "" ) ; \n",Do not update query failureCause when query is FINISHING,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveErrorCode . java \n + HIVE _ TRANSACTION _ NOT _ FOUND ( 41 , INTERNAL _ ERROR ) , \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveSplitManager . java \n + import static com . facebook . presto . hive . HiveErrorCode . HIVE _ TRANSACTION _ NOT _ FOUND ; \n + if ( metadata = = null ) { \n + throw new PrestoException ( HIVE _ TRANSACTION _ NOT _ FOUND , format ( "" Transaction not found : % s "" , transaction ) ) ; \n + } \n",Improve error message when transaction is gone \n It can happen if the query finishes before the scan operator is \n done ( e . g . : . . . LIMIT N ) . \n Although the errors after query completion generally should be ignored \n it is still makes sense to have a reasonable error message and \n and explicit null check then simply rely on a null dereferencing inside .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ SystemSessionProperties . java \n - queryManagerConfig . getInitialHashPartitions ( ) , \n + queryManagerConfig . getHashPartitionCount ( ) , \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ QueryManagerConfig . java \n - private int initialHashPartitions = 100 ; \n + private int hashPartitionCount = 100 ; \n - public int getInitialHashPartitions ( ) \n + public int getHashPartitionCount ( ) \n - return initialHashPartitions ; \n + return hashPartitionCount ; \n - @ Config ( "" query . initial - hash - partitions "" ) \n - public QueryManagerConfig setInitialHashPartitions ( int initialHashPartitions ) \n + @ LegacyConfig ( "" query . initial - hash - partitions "" ) \n + @ Config ( "" query . hash - partition - count "" ) \n + public QueryManagerConfig setHashPartitionCount ( int hashPartitionCount ) \n - this . initialHashPartitions = initialHashPartitions ; \n + this . hashPartitionCount = hashPartitionCount ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ execution \ TestQueryManagerConfig . java \n - . setInitialHashPartitions ( 100 ) \n + . setHashPartitionCount ( 100 ) \n - . put ( "" query . initial - hash - partitions "" , "" 16 "" ) \n + . put ( "" query . hash - partition - count "" , "" 16 "" ) \n - . setInitialHashPartitions ( 16 ) \n + . setHashPartitionCount ( 16 ) \n",Rename query . initial - hash - partitions property \n Rename the query . initial - hash - partitions to query . hash - partition - count to match \n the session property name,34
"presto - docs \ src \ main \ sphinx \ language \ reserved . rst \n - ` ` CURRENT _ ROLE ` ` reserved reserved \n presto - parser \ src \ main \ antlr4 \ com \ facebook \ presto \ sql \ parser \ SqlBase . g4 \n - : principal # specifiedPrincipal \n - | CURRENT _ USER # currentUserGrantor \n + : CURRENT _ USER # currentUserGrantor \n + | principal # specifiedPrincipal \n - : identifier # unspecifiedPrincipal \n - | USER identifier # userPrincipal \n + : USER identifier # userPrincipal \n + | identifier # unspecifiedPrincipal \n - | CALL | CASCADE | CATALOGS | COLUMN | COLUMNS | COMMENT | COMMIT | COMMITTED | CURRENT \n + | CALL | CASCADE | CATALOGS | COLUMN | COLUMNS | COMMENT | COMMIT | COMMITTED | CURRENT | CURRENT _ ROLE \n presto - parser \ src \ test \ java \ com \ facebook \ presto \ sql \ parser \ TestSqlParser . java \n + assertStatement ( "" SELECT CURRENT _ ROLE , t . current _ role FROM t "" , \n + simpleQuery ( \n + selectList ( \n + new Identifier ( "" CURRENT _ ROLE "" ) , \n + new DereferenceExpression ( new Identifier ( "" t "" ) , new Identifier ( "" current _ role "" ) ) ) , \n + table ( QualifiedName . of ( "" t "" ) ) ) ) ; \n + assertExpression ( "" current _ role "" , new Identifier ( "" current _ role "" ) ) ; \n","Remove CURRENT _ ROLE from the reserved keywords \n The SQL standard allows queries like : \n ` ` ` \n postgres = # SELECT CURRENT _ ROLE ; \n current _ role \n - - - - - - - - - - - - - - \n postgres \n ( 1 row ) \n ` ` ` \n That ' s why the ` CURRENT _ ROLE ` is a reserved keyword in the SQL standard . \n Currently Presto supports the ` CURRENT _ ROLE ` keyword only in \n ` CREATE ROLE ` , ` GRANT ` and ` REVOKE ` statements . So it is possible to \n parse the ` CURRENT _ ROLE ` token as a keyword in those statements , while \n parsing the same token as an identifier in any other queries . \n However this is only a temporary solution , as at some point the scope \n of the ` CURRENT _ ROLE ` might be extended to the SELECT queries as well .",34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ metastore \ MetastoreUtil . java \n - schema . setProperty ( BUCKET _ FIELD _ NAME , sd . getBucketProperty ( ) . get ( ) . getBucketedBy ( ) . get ( 0 ) ) ; \n + List < String > bucketedBy = sd . getBucketProperty ( ) . get ( ) . getBucketedBy ( ) ; \n + if ( ! bucketedBy . isEmpty ( ) ) { \n + schema . setProperty ( BUCKET _ FIELD _ NAME , bucketedBy . get ( 0 ) ) ; \n + } \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ AbstractTestHiveClient . java \n + \n + / / bucketed on zero columns \n + testCreateTemporaryTable ( TEMPORARY _ TABLE _ COLUMNS , TEMPORARY _ TABLE _ BUCKET _ COUNT , ImmutableList . of ( ) , TEMPORARY _ TABLE _ DATA ) ; \n",Fix Hive schema for a table bucketed on 0 columns \n Such a schema is allowed in Hive : https : / / goo . gl / hnxy73 \n Temporary tables can potentially be bucketed on 0 columns . That \n will effectively turn such a table into a single bucket table . \n However there is not fundamental reason why shouldn ' t we support that .,34
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveIntegrationSmokeTest . java \n - "" CREATE TABLE test _ mismatch _ bucketing8 \ n "" + \n + "" CREATE TABLE test _ mismatch _ bucketing _ with _ predicate _ 8 \ n "" + \n - "" CREATE TABLE test _ mismatch _ bucketing32 \ n "" + \n + "" CREATE TABLE test _ mismatch _ bucketing _ with _ predicate _ 32 \ n "" + \n - "" FROM test _ mismatch _ bucketing32 \ n "" + \n + "" FROM test _ mismatch _ bucketing _ with _ predicate _ 32 \ n "" + \n - "" JOIN test _ mismatch _ bucketing8 b \ n "" + \n + "" JOIN test _ mismatch _ bucketing _ with _ predicate _ 8 b \ n "" + \n - assertUpdate ( "" DROP TABLE IF EXISTS test _ mismatch _ bucketing8 "" ) ; \n - assertUpdate ( "" DROP TABLE IF EXISTS test _ mismatch _ bucketing32 "" ) ; \n + assertUpdate ( "" DROP TABLE IF EXISTS test _ mismatch _ bucketing _ with _ predicate _ 8 "" ) ; \n + assertUpdate ( "" DROP TABLE IF EXISTS test _ mismatch _ bucketing _ with _ predicate _ 32 "" ) ; \n",Fix sporadic test failures in presto - hive modules \n Tests from TestHiveIntegrationSmokeTest are run simultaneously in \n multiple threads . Thus the table names used in tests must be unique .,34
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ AbstractTestHiveClient . java \n + import static java . lang . Thread . sleep ; \n + import static java . util . concurrent . TimeUnit . SECONDS ; \n + { \n + testStorePartitionWithStatistics ( columns , statsForAllColumns1 , statsForAllColumns2 , statsForSubsetOfColumns , emptyStatistics , new Duration ( 0 , SECONDS ) ) ; \n + } \n + \n + protected void testStorePartitionWithStatistics ( \n + List < ColumnMetadata > columns , \n + PartitionStatistics statsForAllColumns1 , \n + PartitionStatistics statsForAllColumns2 , \n + PartitionStatistics statsForSubsetOfColumns , \n + PartitionStatistics emptyStatistics , \n + Duration delayBetweenAlters ) \n + throws Exception \n + sleep ( delayBetweenAlters . toMillis ( ) ) ; \n + \n + sleep ( delayBetweenAlters . toMillis ( ) ) ; \n + \n + sleep ( delayBetweenAlters . toMillis ( ) ) ; \n + \n",Tiny refactor to AbstractTestHiveClient \n Allow sub - classes to introduce delay between calling alterTable \n in the testStorePartitionWithStatistics test to throttle the \n number of alter operations for certain metastore implementations .,34
presto - hive \ pom . xml \n + < build > \n + < plugins > \n + < plugin > \n + < groupId > org . basepom . maven < / groupId > \n + < artifactId > duplicate - finder - maven - plugin < / artifactId > \n + < configuration > \n + < ignoredResourcePatterns > \n + < ignoredResourcePattern > parquet . thrift < / ignoredResourcePattern > \n + < ignoredResourcePattern > about . html < / ignoredResourcePattern > \n + < / ignoredResourcePatterns > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + \n - < plugin > \n - < groupId > org . basepom . maven < / groupId > \n - < artifactId > duplicate - finder - maven - plugin < / artifactId > \n - < configuration > \n - < ignoredResourcePatterns > \n - < ignoredResourcePattern > parquet . thrift < / ignoredResourcePattern > \n - < ignoredResourcePattern > about . html < / ignoredResourcePattern > \n - < / ignoredResourcePatterns > \n - < / configuration > \n - < / plugin > \n - < plugin > \n - < groupId > org . basepom . maven < / groupId > \n - < artifactId > duplicate - finder - maven - plugin < / artifactId > \n - < configuration > \n - < ignoredResourcePatterns > \n - < ignoredResourcePattern > parquet . thrift < / ignoredResourcePattern > \n - < ignoredResourcePattern > about . html < / ignoredResourcePattern > \n - < / ignoredResourcePatterns > \n - < / configuration > \n - < / plugin > \n,Refactor presto - hive pom \n Unify duplicate - finder - maven - plugin overrides,34
". travis . yml \n - TEST _ SPECIFIC _ MODULES = presto - accumulo \n - TEST _ SPECIFIC _ MODULES = presto - cassandra \n - TEST _ SPECIFIC _ MODULES = presto - hive \n + - TEST _ SPECIFIC _ MODULES = presto - hive TEST _ FLAGS = "" - P test - hive - materialized "" \n - TEST _ SPECIFIC _ MODULES = presto - main \n - TEST _ SPECIFIC _ MODULES = presto - mongodb \n - TEST _ OTHER _ MODULES = ! presto - tests , ! presto - raptor , ! presto - accumulo , ! presto - cassandra , ! presto - hive , ! presto - kudu , ! presto - docs , ! presto - server , ! presto - server - rpm , ! presto - main , ! presto - mongodb \n presto - hive \ pom . xml \n + < exclude > * * / TestHiveDistributedAggregationsWithExchangeMaterialization . java < / exclude > \n + < exclude > * * / TestHiveDistributedQueriesWithExchangeMaterialization . java < / exclude > \n + < profile > \n + < id > test - hive - materialized < / id > \n + < build > \n + < plugins > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - surefire - plugin < / artifactId > \n + < configuration > \n + < includes > \n + < include > * * / TestHiveDistributedAggregationsWithExchangeMaterialization . java < / include > \n + < include > * * / TestHiveDistributedQueriesWithExchangeMaterialization . java < / include > \n + < / includes > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + < / profile > \n",Run exchange materialization tests in a separate build,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveClientConfig . java \n - private HiveCompressionCodec hiveCompressionCodec = HiveCompressionCodec . GZIP ; \n + private HiveCompressionCodec compressionCodec = HiveCompressionCodec . GZIP ; \n - public HiveCompressionCodec getHiveCompressionCodec ( ) \n + public HiveCompressionCodec getCompressionCodec ( ) \n - return hiveCompressionCodec ; \n + return compressionCodec ; \n - public HiveClientConfig setHiveCompressionCodec ( HiveCompressionCodec hiveCompressionCodec ) \n + public HiveClientConfig setCompressionCodec ( HiveCompressionCodec compressionCodec ) \n - this . hiveCompressionCodec = hiveCompressionCodec ; \n + this . compressionCodec = compressionCodec ; \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveSessionProperties . java \n - hiveClientConfig . getHiveCompressionCodec ( ) , \n + hiveClientConfig . getCompressionCodec ( ) , \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveClientConfig . java \n - . setHiveCompressionCodec ( HiveCompressionCodec . GZIP ) \n + . setCompressionCodec ( HiveCompressionCodec . GZIP ) \n - . setHiveCompressionCodec ( HiveCompressionCodec . NONE ) \n + . setCompressionCodec ( HiveCompressionCodec . NONE ) \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHivePageSink . java \n - config . setHiveCompressionCodec ( NONE ) ; \n + config . setCompressionCodec ( NONE ) ; \n - config . setHiveCompressionCodec ( codec ) ; \n + config . setCompressionCodec ( codec ) ; \n - return tempDir . getAbsolutePath ( ) + "" / "" + config . getHiveStorageFormat ( ) . name ( ) + "" . "" + config . getHiveCompressionCodec ( ) . name ( ) ; \n + return tempDir . getAbsolutePath ( ) + "" / "" + config . getHiveStorageFormat ( ) . name ( ) + "" . "" + config . getCompressionCodec ( ) . name ( ) ; \n - config . getHiveCompressionCodec ( ) , \n + config . getCompressionCodec ( ) , \n",Refactor HiveClientConfig \n Rename hiveCompressionCodec to simply compressionCodec,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveClientConfig . java \n + private HiveCompressionCodec temporaryTableCompressionCodec = HiveCompressionCodec . SNAPPY ; \n + @ NotNull \n + public HiveCompressionCodec getTemporaryTableCompressionCodec ( ) \n + { \n + return temporaryTableCompressionCodec ; \n + } \n + \n + @ Config ( "" hive . temporary - table - compression - codec "" ) \n + public HiveClientConfig setTemporaryTableCompressionCodec ( HiveCompressionCodec temporaryTableCompressionCodec ) \n + { \n + this . temporaryTableCompressionCodec = temporaryTableCompressionCodec ; \n + return this ; \n + } \n + \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveMetadata . java \n + import static com . facebook . presto . hive . HiveSessionProperties . getTemporaryTableCompressionCodec ; \n - if ( table . get ( ) . getTableType ( ) . equals ( TEMPORARY _ TABLE ) ) { \n + boolean isTemporaryTable = table . get ( ) . getTableType ( ) . equals ( TEMPORARY _ TABLE ) ; \n + if ( isTemporaryTable ) { \n - getCompressionCodec ( session ) ) ; \n + isTemporaryTable ? getTemporaryTableCompressionCodec ( session ) : getCompressionCodec ( session ) ) ; \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveSessionProperties . java \n + private static final String TEMPORARY _ TABLE _ COMPRESSION _ CODEC = "" temporary _ table _ compression _ codec "" ; \n + new PropertyMetadata < > ( \n + TEMPORARY _ TABLE _ COMPRESSION _ CODEC , \n + "" Compression codec used to store data in temporary tables "" , \n + VARCHAR , \n + HiveCompressionCodec . class , \n + hiveClientConfig . getTemporaryTableCompressionCodec ( ) , \n + false , \n + value - > HiveCompressionCodec . valueOf ( ( ( String ) value ) . toUpperCase ( ) ) , \n + HiveCompressionCodec : : name ) , \n + public static HiveCompressionCodec getTemporaryTableCompressionCodec ( ConnectorSession session ) \n + { \n + return session . getProperty ( TEMPORARY _ TABLE _ COMPRESSION _ CODEC , HiveCompressionCodec . class ) ; \n + } \n + \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveClientConfig . java \n + import static com . facebook . presto . hive . HiveCompressionCodec . NONE ; \n + import static com . facebook . presto . hive . HiveCompressionCodec . SNAPPY ; \n + . setTemporaryTableCompressionCodec ( SNAPPY ) \n + . put ( "" hive . temporary - table - compression - codec "" , "" NONE "" ) \n + . setTemporaryTableCompressionCodec ( NONE ) \n",Add temporary _ table _ compression _ codec session property \n And hive . temporary - table - compression - codec configuration property,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ QueryStateMachine . java \n - boolean completeInfo = getAllStages ( rootStage ) . stream ( ) . allMatch ( StageInfo : : isCompleteInfo ) ; \n + boolean completeInfo = getAllStages ( rootStage ) . stream ( ) . allMatch ( StageInfo : : isFinalStageInfo ) ; \n - completeInfo = completeInfo & & stageInfo . isCompleteInfo ( ) ; \n + completeInfo = completeInfo & & stageInfo . isFinalStageInfo ( ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ StageInfo . java \n - \n - public boolean isCompleteInfo ( ) \n - { \n - return state . isDone ( ) & & tasks . stream ( ) . allMatch ( taskInfo - > taskInfo . getTaskStatus ( ) . getState ( ) . isDone ( ) ) ; \n - } \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ StageStateMachine . java \n - checkArgument ( stageInfo . isCompleteInfo ( ) , "" finalTaskInfos are not all done "" ) ; \n + checkArgument ( stageInfo . isFinalStageInfo ( ) , "" finalTaskInfos are not all done "" ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ execution \ TestSqlStageExecution . java \n - assertTrue ( stageInfo . isCompleteInfo ( ) ) ; \n + assertTrue ( stageInfo . isFinalStageInfo ( ) ) ; \n",Remove StageInfo # isCompleteInfo \n In favor of StageInfo # isFinalStageInfo that has exactly the same \n implementation .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ StageInfo . java \n + import static com . google . common . graph . Traverser . forTree ; \n - public static List < StageInfo > getAllStages ( Optional < StageInfo > stageInfo ) \n + public List < StageInfo > getAllStages ( ) \n - ImmutableList . Builder < StageInfo > collector = ImmutableList . builder ( ) ; \n - addAllStages ( stageInfo , collector ) ; \n - return collector . build ( ) ; \n + return ImmutableList . copyOf ( forTree ( StageInfo : : getSubStages ) . depthFirstPreOrder ( this ) ) ; \n - private static void addAllStages ( Optional < StageInfo > stageInfo , ImmutableList . Builder < StageInfo > collector ) \n + public static List < StageInfo > getAllStages ( Optional < StageInfo > stageInfo ) \n - stageInfo . ifPresent ( stage - > { \n - collector . add ( stage ) ; \n - stage . getSubStages ( ) . stream ( ) \n - . forEach ( subStage - > addAllStages ( Optional . ofNullable ( subStage ) , collector ) ) ; \n - } ) ; \n + return stageInfo . map ( StageInfo : : getAllStages ) . orElse ( ImmutableList . of ( ) ) ; \n",Simplify StageInfo # getAllStages \n Use guava for Tree traversal,34
presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ SqlQueryExecution . java \n - stageInfo = Optional . ofNullable ( scheduler . getStageInfo ( ) ) ; \n + stageInfo = Optional . of ( scheduler . getStageInfo ( ) ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ scheduler \ SqlQueryScheduler . java \n - queryStateMachine . updateQueryInfo ( Optional . ofNullable ( getStageInfo ( ) ) ) ; \n + queryStateMachine . updateQueryInfo ( Optional . of ( getStageInfo ( ) ) ) ; \n - stage . addFinalStageInfoListener ( status - > queryStateMachine . updateQueryInfo ( Optional . ofNullable ( getStageInfo ( ) ) ) ) ; \n + stage . addFinalStageInfoListener ( status - > queryStateMachine . updateQueryInfo ( Optional . of ( getStageInfo ( ) ) ) ) ; \n,Small refactor to SqlQueryExecution \n SqlQueryScheduler # getStageInfo is guaranteed to be not null,34
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveIntegrationSmokeTest . java \n - "" Catalog \ "" tpch \ "" does not support custom partitioning and cannot be used as a partitioning provider "" ) ; \n + "" Catalog \ "" tpch \ "" cannot be used as a partitioning provider : This connector does not support custom partitioning "" ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ PlanFragmenter . java \n - format ( "" Catalog \ "" % s \ "" does not support temporary tables . The exchange cannot be materialized . "" , connectorId . getCatalogName ( ) ) , \n + format ( "" Temporary table cannot be created in catalog \ "" % s \ "" : % s "" , connectorId . getCatalogName ( ) , e . getMessage ( ) ) , \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ AddExchanges . java \n - format ( "" Catalog \ "" % s \ "" does not support custom partitioning and cannot be used as a partitioning provider "" , partitioningProviderCatalog ) , \n + format ( \n + "" Catalog \ "" % s \ "" cannot be used as a partitioning provider : % s "" , \n + partitioningProviderCatalog , \n + e . getMessage ( ) ) , \n",Improve unsupported materialized exchanges error messages \n Include reason into the top level error message,34
presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ scheduler \ SqlQueryScheduler . java \n + scheduling . set ( false ) ; \n - scheduling . set ( false ) ; \n,"Fix race condition in the SqlQueryScheduler \n The ` scheduling ` is supposed to ensure that only a single \n scheduling happens at any moment of a time . \n If the finally block is executed after the next streaming section \n has already started scheduling , the "" scheduling "" flag will be set \n to "" false "" despite the scheduling of the second streaming section \n is still in process .",34
presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ QueryStateMachine . java \n - writtenOutputPhysicalDataSize + = stageStats . getPhysicalWrittenDataSize ( ) . toBytes ( ) ; \n + writtenIntermediatePhysicalDataSize + = stageStats . getPhysicalWrittenDataSize ( ) . toBytes ( ) ; \n,Fix bug in intermidiated data writes stats collection,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ QueryManagerConfig . java \n + private int querySubmissionMaxThreads = Runtime . getRuntime ( ) . availableProcessors ( ) * 2 ; \n + \n + @ Min ( 1 ) \n + public int getQuerySubmissionMaxThreads ( ) \n + { \n + return querySubmissionMaxThreads ; \n + } \n + \n + @ Config ( "" query - manager . query - submission - max - threads "" ) \n + public QueryManagerConfig setQuerySubmissionMaxThreads ( int querySubmissionMaxThreads ) \n + { \n + this . querySubmissionMaxThreads = querySubmissionMaxThreads ; \n + return this ; \n + } \n + \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ SqlQueryManager . java \n + import io . airlift . concurrent . BoundedExecutor ; \n + import java . util . concurrent . Executor ; \n - private final ExecutorService queryExecutor ; \n + private final ExecutorService unboundedExecutorService ; \n + private final Executor boundedExecutor ; \n - this . queryExecutor = newCachedThreadPool ( threadsNamed ( "" query - scheduler - % s "" ) ) ; \n - this . queryExecutorMBean = new ThreadPoolExecutorMBean ( ( ThreadPoolExecutor ) queryExecutor ) ; \n + this . unboundedExecutorService = newCachedThreadPool ( threadsNamed ( "" query - scheduler - % s "" ) ) ; \n + this . boundedExecutor = new BoundedExecutor ( unboundedExecutorService , queryManagerConfig . getQuerySubmissionMaxThreads ( ) ) ; \n + this . queryExecutorMBean = new ThreadPoolExecutorMBean ( ( ThreadPoolExecutor ) unboundedExecutorService ) ; \n - queryExecutor . shutdownNow ( ) ; \n + unboundedExecutorService . shutdownNow ( ) ; \n - queryExecutor . submit ( embedVersion . embedVersion ( ( ) - > { \n + boundedExecutor . execute ( embedVersion . embedVersion ( ( ) - > { \n - queryExecutor , \n + unboundedExecutorService , \n - resourceGroupManager . submit ( preparedQuery . getStatement ( ) , queryExecution , selectionContext , queryExecutor ) ; \n + resourceGroupManager . submit ( preparedQuery . getStatement ( ) , queryExecution , selectionContext , unboundedExecutorService ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ execution \ TestQueryManagerConfig . java \n - . setRequiredWorkersMaxWait ( new Duration ( 5 , TimeUnit . MINUTES ) ) ) ; \n + . setRequiredWorkersMaxWait ( new Duration ( 5 , TimeUnit . MINUTES ) ) \n + . setQuerySubmissionMaxThreads ( Runtime . getRuntime ( ) . availableProcessors ( ) * 2 ) ) ; \n + . put ( "" query - manager . query - submission - max - threads "" , "" 5 "" ) \n - . setRequiredWorkersMaxWait ( new Duration ( 33 , TimeUnit . MINUTES ) ) ; \n + . setRequiredWorkersMaxWait ( new Duration ( 33 , TimeUnit . MINUTES ) ) \n + . setQuerySubmissionMaxThreads ( 5 ) ; \n",Limit query submission threads \n Analysis is the part of the submission and when analysing Presto communicates \n with the metastore using the blocking IO . Thus the maximum number of threads \n that handle submission remains high ( twice the number of CPUs ) . \n Callbacks of the FailedQueryExecution and the ResourceGroupManager are supposed \n to be lightweight and low latency . That why the unbounded executor remains to be \n used to handle those .,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HivePartitionManager . java \n + private final int domainCompactionThreshold ; \n - hiveClientConfig . getMaxPartitionsPerScan ( ) ) ; \n + hiveClientConfig . getMaxPartitionsPerScan ( ) , \n + hiveClientConfig . getDomainCompactionThreshold ( ) ) ; \n - int maxPartitionsPerScan ) \n + int maxPartitionsPerScan , \n + int domainCompactionThreshold ) \n + checkArgument ( domainCompactionThreshold > = 1 , "" domainCompactionThreshold must be at least 1 "" ) ; \n + this . domainCompactionThreshold = domainCompactionThreshold ; \n + TupleDomain < ColumnHandle > compactEffectivePredicate = effectivePredicate . compact ( domainCompactionThreshold ) ; \n + \n - effectivePredicate , \n + compactEffectivePredicate , \n",Compact effective predicate early \n TupleDomain compaction reduces a long list of well specified values to a \n range if the number of values threshold is crossed . \n The compaction has been moved as part of the 76ea27ef commit . \n effectivePredicate is carried to a worker with a HiveSplit . HiveSplit \n must be serialized into JSON on the coordinator . Without a compaction \n the serialization of large tupple domains ( 100 + values ) results in \n excessive CPU usage on coordinator .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ analyzer \ QueryExplainer . java \n - public String getPlan ( Session session , Statement statement , Type planType , List < Expression > parameters , WarningCollector warningCollector ) \n + public String getPlan ( Session session , Statement statement , Type planType , List < Expression > parameters , boolean verbose , WarningCollector warningCollector ) \n - return PlanPrinter . textLogicalPlan ( plan . getRoot ( ) , plan . getTypes ( ) , metadata . getFunctionManager ( ) , plan . getStatsAndCosts ( ) , session , 0 , false ) ; \n + return PlanPrinter . textLogicalPlan ( plan . getRoot ( ) , plan . getTypes ( ) , metadata . getFunctionManager ( ) , plan . getStatsAndCosts ( ) , session , 0 , verbose ) ; \n - return PlanPrinter . textDistributedPlan ( subPlan , metadata . getFunctionManager ( ) , session , false ) ; \n + return PlanPrinter . textDistributedPlan ( subPlan , metadata . getFunctionManager ( ) , session , verbose ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ rewrite \ ExplainRewrite . java \n - plan = queryExplainer . get ( ) . getPlan ( session , preparedQuery . getStatement ( ) , planType , preparedQuery . getParameters ( ) , warningCollector ) ; \n + plan = queryExplainer . get ( ) . getPlan ( session , preparedQuery . getStatement ( ) , planType , preparedQuery . getParameters ( ) , node . isVerbose ( ) , warningCollector ) ; \n presto - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ AbstractTestQueryFramework . java \n - return explainer . getPlan ( session , sqlParser . createStatement ( query , createParsingOptions ( session ) ) , planType , emptyList ( ) , WarningCollector . NOOP ) ; \n + return explainer . getPlan ( session , sqlParser . createStatement ( query , createParsingOptions ( session ) ) , planType , emptyList ( ) , false , WarningCollector . NOOP ) ; \n",Pass verbose flag when generating plan output for normal explain,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ plan \ StatisticAggregations . java \n - import static com . facebook . presto . sql . relational . OriginalExpressionUtils . asSymbolReference ; \n - import static com . facebook . presto . sql . relational . OriginalExpressionUtils . castToRowExpression ; \n - ImmutableList . of ( castToRowExpression ( asSymbolReference ( partialVariable ) ) ) ) , \n + ImmutableList . of ( partialVariable ) ) , \n",Remove unnecessary row expression to symbol expression translation,34
"presto - orc \ src \ main \ java \ com \ facebook \ presto \ orc \ reader \ ReaderUtils . java \n - result [ i ] = values [ position ] ; \n + result [ i ] = values [ position ] ; \n - result [ i ] = values [ position ] ; \n + result [ i ] = values [ position ] ; \n - result [ i ] = values [ position ] ; \n + result [ i ] = values [ position ] ; \n - result [ i ] = values [ position ] ; \n + result [ i ] = values [ position ] ; \n presto - orc \ src \ test \ java \ com \ facebook \ presto \ orc \ OrcTester . java \n + import static org . testng . Assert . assertFalse ; \n - \n + checkNullValues ( type , block ) ; \n + checkNullValues ( type , block ) ; \n + private static void checkNullValues ( Type type , Block block ) \n + { \n + if ( ! block . mayHaveNull ( ) ) { \n + return ; \n + } \n + for ( int position = 0 ; position < block . getPositionCount ( ) ; position + + ) { \n + if ( block . isNull ( position ) ) { \n + if ( type . equals ( TINYINT ) | | type . equals ( SMALLINT ) | | type . equals ( INTEGER ) | | type . equals ( BIGINT ) | | type . equals ( REAL ) | | type . equals ( DATE ) | | type . equals ( TIMESTAMP ) ) { \n + assertEquals ( type . getLong ( block , position ) , 0 ) ; \n + } \n + if ( type . equals ( BOOLEAN ) ) { \n + assertFalse ( type . getBoolean ( block , position ) ) ; \n + } \n + if ( type . equals ( DOUBLE ) ) { \n + assertEquals ( type . getDouble ( block , position ) , 0 . 0 ) ; \n + } \n + if ( type instanceof VarcharType | | type instanceof CharType | | type . equals ( VARBINARY ) ) { \n + assertEquals ( type . getSlice ( block , position ) . length ( ) , 0 ) ; \n + } \n + } \n + } \n + } \n + \n",Set boolean value to 0 if the position is null \n Setting the actual value to a random 0 or 1 is rather not \n intuitive and error prone . We may expect the boolean ( or integer ) value \n to be set to 0 if the position is null in some places across the code \n Benchmarks \n Before : \n Benchmark ( typeSignature ) ( withNulls ) Mode Cnt Score Error Units \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni boolean PARTIAL avgt 20 0 . 022 ± 0 . 002 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni tinyint PARTIAL avgt 20 0 . 022 ± 0 . 003 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni smallint PARTIAL avgt 20 0 . 075 ± 0 . 006 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni integer PARTIAL avgt 20 0 . 107 ± 0 . 010 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni bigint PARTIAL avgt 20 0 . 167 ± 0 . 010 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni boolean PARTIAL avgt 20 0 . 023 ± 0 . 003 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni tinyint PARTIAL avgt 20 0 . 022 ± 0 . 004 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni smallint PARTIAL avgt 20 0 . 091 ± 0 . 006 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni integer PARTIAL avgt 20 0 . 122 ± 0 . 008 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni bigint PARTIAL avgt 20 0 . 199 ± 0 . 011 s / op \n After : \n Benchmark ( typeSignature ) ( withNulls ) Mode Cnt Score Error Units \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni boolean PARTIAL avgt 20 0 . 022 ± 0 . 004 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni tinyint PARTIAL avgt 20 0 . 021 ± 0 . 004 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni smallint PARTIAL avgt 20 0 . 073 ± 0 . 006 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni integer PARTIAL avgt 20 0 . 103 ± 0 . 011 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithJni bigint PARTIAL avgt 20 0 . 172 ± 0 . 010 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni boolean PARTIAL avgt 20 0 . 022 ± 0 . 003 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni tinyint PARTIAL avgt 20 0 . 021 ± 0 . 004 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni smallint PARTIAL avgt 20 0 . 093 ± 0 . 010 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni integer PARTIAL avgt 20 0 . 123 ± 0 . 011 s / op \n BenchmarkBatchStreamReadersWithZstd . readBlocksWithoutJni bigint PARTIAL avgt 20 0 . 196 ± 0 . 011 s / op,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ HashBuilderOperator . java \n - / / Why not index . getEstimatedSize . toBytes ( ) ? Because we are adding a calculation for the expected size of the PagesHash we will build soon \n - int numPositions = index . getPositionCount ( ) ; \n - long estimatedSizeAfterBuild = index . getEstimatedSize ( ) . toBytes ( ) + PagesHash . getEstimatedAdditionalSize ( numPositions ) ; \n - \n - localRevocableMemoryContext . setBytes ( estimatedSizeAfterBuild ) ; \n + localRevocableMemoryContext . setBytes ( index . getEstimatedSize ( ) . toBytes ( ) ) ; \n - if ( ! localUserMemoryContext . trySetBytes ( estimatedSizeAfterBuild ) ) { \n + if ( ! localUserMemoryContext . trySetBytes ( index . getEstimatedSize ( ) . toBytes ( ) ) ) { \n - localUserMemoryContext . setBytes ( index . getEstimatedSize ( ) . toBytes ( ) + PagesHash . getEstimatedAdditionalSize ( numPositions ) ) ; \n + localUserMemoryContext . setBytes ( index . getEstimatedSize ( ) . toBytes ( ) ) ; \n + / / reserve memory for the lookup source \n + long estimatedSizeAfterBuild = index . getEstimatedSize ( ) . toBytes ( ) + PagesHash . getEstimatedAdditionalSize ( index . getPositionCount ( ) ) ; \n + if ( spillEnabled ) { \n + localRevocableMemoryContext . setBytes ( estimatedSizeAfterBuild ) ; \n + } \n + else { \n + localUserMemoryContext . setBytes ( estimatedSizeAfterBuild ) ; \n + } \n + \n + / / reserve memory for the lookup source \n + long estimatedSizeAfterBuild = index . getEstimatedSize ( ) . toBytes ( ) + PagesHash . getEstimatedAdditionalSize ( index . getPositionCount ( ) ) ; \n + localUserMemoryContext . setBytes ( estimatedSizeAfterBuild ) ; \n + \n presto - main \ src \ test \ java \ com \ facebook \ presto \ operator \ TestHashBuilderOperator . java \n - assertEquals ( estimatedFootprintBefore , 59656384 ) ; \n + assertEquals ( estimatedFootprintBefore , 46147728 ) ; \n - assertEquals ( estimatedFootprintBefore , 51396272 ) ; \n + assertEquals ( estimatedFootprintBefore , 37887616 ) ; \n","Do not overcommit memory in HashBuilderOperator \n For the joins where the build side consumes the input from a stateful \n operator ( Aggregation , WindowFunction , etc . . . ) overcomitting memory \n results in overall peak memory increase leading to query failures \n due to exceeding the overall distributed memory limit .",34
presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ PlanFragmenter . java \n - * - Current sub plan ' s root is TableWriterMergeNode \n + * - Current sub plan ' s root is TableWriterMergeNode or TableWriterNode \n - fragment . getRoot ( ) instanceof TableWriterMergeNode & & \n + ( fragment . getRoot ( ) instanceof TableWriterMergeNode | | fragment . getRoot ( ) instanceof TableWriterNode ) & & \n,Fix recoverable grouped execution for task _ writer _ count = 1 \n When task _ writer _ count = 1 the TableWriterMergeOperator is not added,34
presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ SqlStageExecution . java \n - private synchronized void updateTaskStatus ( TaskStatus taskStatus ) \n + private void updateTaskStatus ( TaskStatus taskStatus ) \n + / / no matter if it is possible to recover - the task is failed \n + failedTasks . add ( taskStatus . getTaskId ( ) ) ; \n + \n - failedTasks . add ( taskStatus . getTaskId ( ) ) ; \n + / / The finishedTasks . add ( taskStatus . getTaskId ( ) ) must happen before the getState ( ) ( see schedulingComplete ) \n + stageExecutionState = getState ( ) ; \n - failedTasks . size ( ) + 1 < allTasks . size ( ) * maxFailedTaskPercentage ; \n + failedTasks . size ( ) < allTasks . size ( ) * maxFailedTaskPercentage ; \n,"Make updateTaskStatus not synchronized within SqlStageExecution \n This synchronization is a contention point and introduces a \n dead lock for recoverable execution . \n The ` updateTaskStatus ` method only alters the ` failedTasks ` and \n ` finishedTasks ` variables . \n The ` failedTasks ` list is only used to check whether there are too \n many tasks failed , and whether the next recovery is possible . It \n is always updated and checked within the same method . Thus , \n synchronization is not needed , as long as the ` failedTasks ` set is \n concurrent ( allows concurrent modifications ) . \n The ` finishedTasks ` is used to check whether the stage execution is \n done . It is updated only withing the ` updateTaskStatus ` , and it is \n checked in 2 different places . The ` updateTaskStatus ` and the \n ` schedulingComplete ` . As long as the ` finishedTasks ` allows concurrent \n modifications itself the overall lock is not needed . As : \n - In the ` schedulingComplete ` : \n ` transitionToScheduled ` always happens before the \n ` finishedTasks . size ( ) = = allTasks . size ( ) ` \n - In the ` updateTaskStatus ` : \n ` finishedTasks . add ( taskStatus . getTaskId ( ) ) ` always happens before \n the ` stageExecutionState = = StageExecutionState . SCHEDULED ` \n and the ` finishedTasks . size ( ) = = allTasks . size ( ) `",34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ scheduler \ NodeScheduler . java \n - import java . util . ArrayList ; \n - List < InternalNode > selected = new ArrayList < > ( min ( limit , candidates . size ( ) ) ) ; \n - while ( selected . size ( ) < limit & & candidates . hasNext ( ) ) { \n - selected . add ( candidates . next ( ) ) ; \n + ImmutableList . Builder < InternalNode > selectedNodes = ImmutableList . builderWithExpectedSize ( min ( limit , candidates . size ( ) ) ) ; \n + int selectedCount = 0 ; \n + while ( selectedCount < limit & & candidates . hasNext ( ) ) { \n + selectedNodes . add ( candidates . next ( ) ) ; \n + selectedCount + + ; \n - return selected ; \n + return selectedNodes . build ( ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ scheduler \ SimpleNodeSelector . java \n + import java . util . Objects ; \n + import static com . google . common . base . Verify . verify ; \n + / / nodes may sporadically disappear from the nodeMap if the announcement is delayed \n + . filter ( Objects : : nonNull ) \n - int alreadySelectedNodeCount = existingTasks . size ( ) ; \n + int alreadySelectedNodeCount = existingNodes . size ( ) ; \n + verify ( existingNodes . stream ( ) . allMatch ( Objects : : nonNull ) , "" existingNodes list must not contain any nulls "" ) ; \n","Fix NPE in SimpleNodeSelector \n When node disappears ( for example due to a slow heartbeat or due to the \n failure ) the NPE can happen in SimpleNodeSelector , as the node mapping \n for the existing task won ' t be found in the node map . \n Example stacktrace : \n Caused by : java . lang . NullPointerException \n at java . base / java . util . concurrent . ConcurrentHashMap . get ( ConcurrentHashMap . java : 946 ) \n at com . facebook . presto . execution . NodeTaskMap . createOrGetNodeTasks ( NodeTaskMap . java : 62 ) \n at com . facebook . presto . execution . NodeTaskMap . getPartitionedSplitsOnNode ( NodeTaskMap . java : 52 ) \n at java . base / java . util . HashMap . computeIfAbsent ( HashMap . java : 1138 ) \n at com . facebook . presto . execution . scheduler . NodeAssignmentStats . getTotalSplitCount ( NodeAssignmentStats . java : 50 ) \n at com . facebook . presto . execution . scheduler . SimpleNodeSelector . computeAssignments ( SimpleNodeSelector . java : 134 ) \n at com . facebook . presto . execution . scheduler . DynamicSplitPlacementPolicy . computeAssignments ( DynamicSplitPlacementPolicy . java : 41 ) \n at com . facebook . presto . execution . scheduler . SourcePartitionedScheduler . schedule ( SourcePartitionedScheduler . java : 271 ) \n at com . facebook . presto . execution . scheduler . SourcePartitionedScheduler $ 1 . schedule ( SourcePartitionedScheduler . java : 146 ) \n at com . facebook . presto . execution . scheduler . SqlQueryScheduler . schedule ( SqlQueryScheduler . java : 747 ) \n at java . base / java . util . concurrent . Executors $ RunnableAdapter . call ( Executors . java : 514 ) \n at java . base / java . util . concurrent . FutureTask . run ( FutureTask . java : 264 ) \n at java . base / java . util . concurrent . ThreadPoolExecutor . runWorker ( ThreadPoolExecutor . java : 1135 ) \n at java . base / java . util . concurrent . ThreadPoolExecutor $ Worker . run ( ThreadPoolExecutor . java : 635 ) \n at java . base / java . lang . Thread . run ( Thread . java : 844 )",34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ AddExchanges . java \n - / / first , classify children into partitioned and unpartitioned \n + / / first , classify children into single node and distributed \n",Update comment in AddExchanges \n Addresses comments for the previous commit,34
"presto - main \ src \ test \ java \ com \ facebook \ presto \ type \ TestDecimalOperators . java \n + assertDecimalFunction ( "" CAST ( ' 1000 ' AS DECIMAL ( 38 , 8 ) ) / CAST ( ' 25 ' AS DECIMAL ( 38 , 8 ) ) "" , decimal ( "" 000000000000000000000000000040 . 00000000 "" ) ) ; \n presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ type \ UnscaledDecimal128Arithmetic . java \n - long quotient = remainder / divisorUnsigned ; \n + long quotient = divideUnsignedLong ( remainder , divisor ) ; \n presto - spi \ src \ test \ java \ com \ facebook \ presto \ spi \ type \ TestUnscaledDecimal128Arithmetic . java \n + assertDivideAllSigns ( new int [ ] { - 1981284352 , - 1966660860 , 0 , 0 } , new int [ ] { - 1794967296 , 0 , 0 , 0 } ) ; \n","Fix decimal division \n Remainder may overflow , thus the unsigned division must be done .",34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ BackgroundHiveSplitLoader . java \n + / / S3 Select pushdown works at the granularity of individual S3 objects , \n + / / therefore we must not split files when it is enabled . \n + boolean splittable = getHeaderCount ( schema ) = = 0 & & getFooterCount ( schema ) = = 0 & & ! s3SelectPushdownEnabled ; \n + \n - return hiveSplitSource . addToQueue ( getBucketedSplits ( path , fs , splitFactory , tableBucketInfo . get ( ) , bucketConversion , partitionName ) ) ; \n + return hiveSplitSource . addToQueue ( getBucketedSplits ( path , fs , splitFactory , tableBucketInfo . get ( ) , bucketConversion , partitionName , splittable ) ) ; \n - / / S3 Select pushdown works at the granularity of individual S3 objects , \n - / / therefore we must not split files when it is enabled . \n - boolean splittable = getHeaderCount ( schema ) = = 0 & & getFooterCount ( schema ) = = 0 & & ! s3SelectPushdownEnabled ; \n - String partitionName ) \n + String partitionName , \n + boolean splittable ) \n - . map ( tableBucketNumber - > splitFactory . createInternalHiveSplit ( file , readBucketNumber , tableBucketNumber ) ) \n + . map ( tableBucketNumber - > splitFactory . createInternalHiveSplit ( file , readBucketNumber , tableBucketNumber , splittable ) ) \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ util \ InternalHiveSplitFactory . java \n - public Optional < InternalHiveSplit > createInternalHiveSplit ( LocatedFileStatus status , int readBucketNumber , int tableBucketNumber ) \n + public Optional < InternalHiveSplit > createInternalHiveSplit ( LocatedFileStatus status , int readBucketNumber , int tableBucketNumber , boolean splittable ) \n - return createInternalHiveSplit ( status , OptionalInt . of ( readBucketNumber ) , OptionalInt . of ( tableBucketNumber ) , false ) ; \n + return createInternalHiveSplit ( status , OptionalInt . of ( readBucketNumber ) , OptionalInt . of ( tableBucketNumber ) , splittable ) ; \n",Produce Hive splittable bucketed splits \n This is the fix for the regression allegedly introduced by the 67ce2ed,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveErrorCode . java \n + HIVE _ TABLE _ BUCKETING _ IS _ IGNORED ( 40 , USER _ ERROR ) , \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveUtil . java \n + import static com . facebook . presto . hive . HiveErrorCode . HIVE _ TABLE _ BUCKETING _ IS _ IGNORED ; \n + if ( ! bucketNumber . isPresent ( ) ) { \n + throw new PrestoException ( HIVE _ TABLE _ BUCKETING _ IS _ IGNORED , "" Table bucketing is ignored . The virtual \ "" $ bucket \ "" column cannot be referenced . "" ) ; \n + } \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveIntegrationSmokeTest . java \n + import static com . facebook . presto . hive . HiveQueryRunner . HIVE _ BUCKETED _ CATALOG ; \n + @ Test \n + public void testIgnoreTableBucketing ( ) \n + { \n + String query = "" SELECT count ( * ) FROM orders WHERE \ "" $ bucket \ "" = 1 "" ; \n + assertQuery ( bucketedSession , query , "" SELECT 1350 "" ) ; \n + Session ignoreBucketingSession = Session . builder ( bucketedSession ) \n + . setCatalogSessionProperty ( HIVE _ BUCKETED _ CATALOG , "" ignore _ table _ bucketing "" , "" true "" ) \n + . build ( ) ; \n + assertQueryFails ( ignoreBucketingSession , query , "" Table bucketing is ignored \ \ . The virtual \ "" \ \ $ bucket \ "" column cannot be referenced \ \ . "" ) ; \n + } \n + \n",Improve error message when $ bucket column is not available,34
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveMetadata . java \n - if ( isBucketExecutionEnabled ( session ) & & hiveLayoutHandle . getBucketHandle ( ) . isPresent ( ) ) { \n + SchemaTableName tableName = hiveLayoutHandle . getSchemaTableName ( ) ; \n + Table table = metastore . getTable ( tableName . getSchemaName ( ) , tableName . getTableName ( ) ) \n + . orElseThrow ( ( ) - > new TableNotFoundException ( tableName ) ) ; \n + / / never ignore table bucketing for temporary tables as those are created such explicitly by the engine request \n + boolean bucketExecutionEnabled = table . getTableType ( ) . equals ( TEMPORARY _ TABLE ) | | isBucketExecutionEnabled ( session ) ; \n + if ( bucketExecutionEnabled & & hiveLayoutHandle . getBucketHandle ( ) . isPresent ( ) ) { \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HivePartitionManager . java \n + import static com . facebook . presto . hive . metastore . PrestoTableType . TEMPORARY _ TABLE ; \n - Optional < HiveBucketHandle > hiveBucketHandle = shouldIgnoreTableBucketing ( session ) ? Optional . empty ( ) : getHiveBucketHandle ( table ) ; \n + \n + / / never ignore table bucketing for temporary tables as those are created such explicitly by the engine request \n + boolean shouldIgnoreTableBucketing = ! table . getTableType ( ) . equals ( TEMPORARY _ TABLE ) & & shouldIgnoreTableBucketing ( session ) ; \n + \n + Optional < HiveBucketHandle > hiveBucketHandle = shouldIgnoreTableBucketing ? Optional . empty ( ) : getHiveBucketHandle ( table ) ; \n - Optional < HiveBucketFilter > bucketFilter = shouldIgnoreTableBucketing ( session ) ? Optional . empty ( ) : getHiveBucketFilter ( table , effectivePredicate ) ; \n + Optional < HiveBucketFilter > bucketFilter = shouldIgnoreTableBucketing ? Optional . empty ( ) : getHiveBucketFilter ( table , effectivePredicate ) ; \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestHiveIntegrationSmokeTest . java \n + \n + / / make sure that bucketing is not ignored for temporary tables \n + Session bucketingIgnored = Session . builder ( materializeExchangesSession ) \n + . setCatalogSessionProperty ( catalog , "" ignore _ table _ bucketing "" , "" true "" ) \n + . build ( ) ; \n + assertQuery ( bucketingIgnored , "" SELECT orderkey , COUNT ( * ) lines FROM lineitem GROUP BY orderkey "" , assertRemoteMaterializedExchangesCount ( 1 ) ) ; \n + \n + Session bucketingExecutionDisabled = Session . builder ( materializeExchangesSession ) \n + . setCatalogSessionProperty ( catalog , "" bucket _ execution _ enabled "" , "" false "" ) \n + . build ( ) ; \n + assertQuery ( bucketingExecutionDisabled , "" SELECT orderkey , COUNT ( * ) lines FROM lineitem GROUP BY orderkey "" , assertRemoteMaterializedExchangesCount ( 1 ) ) ; \n","Always keep bucketed execution on for temporary tables \n Make session property ignore _ table _ bucketing only applicable for \n source tables but not intermediate tables . \n Temporary tables are created bucketed explicitly by the engine request . \n There virtually no use case when temporary table bucketing should be ignored , \n as ignoring bucketing for the temporary table breaks the materialized execution . \n It might be useful to be able to ignore bucketing of the input table without \n implicitly breaking the materializing execution .",34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ plan \ PlanFragmentId . java \n + import static java . util . Objects . requireNonNull ; \n + \n - @ JsonCreator \n - @ JsonValue \n + @ JsonValue \n + @ JsonCreator \n + public static PlanFragmentId valueOf ( String value ) \n + { \n + return new PlanFragmentId ( Integer . valueOf ( requireNonNull ( value , "" value is null "" ) ) ) ; \n + } \n + \n","Encode PlanFragmentId as string in JSON \n The "" Create stage id based on the plan fragment id "" commit changed the \n way the PlanFragmentId is encoded in JSON : \n https : / / github . com / prestodb / presto / commit / 326f80539e42847dd9292d7847da4df8a331a55e \n Before this patch the value had been encoded as a String , and after \n this patch the PlanFragmentId started to be encoded as a number . \n This breaks the "" Live Plan "" UI , as the "" Live Plan "" controller doesn ' t \n match the remote source ids that are still encoded as strings \n ( see JsonRenderedNode ) : \n https : / / github . com / prestodb / presto / blob / master / presto - main / src / main / java / com / facebook / presto / sql / planner / planPrinter / JsonRenderer . java # L53 \n https : / / github . com / prestodb / presto / blob / master / presto - main / src / main / java / com / facebook / presto / sql / planner / planPrinter / JsonRenderer . java # L64 \n https : / / github . com / prestodb / presto / blob / master / presto - main / src / main / resources / webapp / src / components / LivePlan . jsx # L238 \n An alternative solution is to encode JsonRenderedNode # remoteSources \n as a number as well . However , since all other ids ( PlanNodeId , StageId ) \n are encoded as a string , it seems to be more convenient to also have \n the PlanFragmentId encoded as a string .",34
"presto - hive - metastore \ src \ main \ java \ com \ facebook \ presto \ hive \ HdfsEnvironment . java \n - HadoopNative . requireHadoopNative ( ) ; \n + if ( config . isRequireHadoopNative ( ) ) { \n + HadoopNative . requireHadoopNative ( ) ; \n + } \n presto - hive - metastore \ src \ main \ java \ com \ facebook \ presto \ hive \ MetastoreClientConfig . java \n + private boolean requireHadoopNative = true ; \n + \n + public boolean isRequireHadoopNative ( ) \n + { \n + return requireHadoopNative ; \n + } \n + \n + @ Config ( "" hive . dfs . require - hadoop - native "" ) \n + public MetastoreClientConfig setRequireHadoopNative ( boolean requireHadoopNative ) \n + { \n + this . requireHadoopNative = requireHadoopNative ; \n + return this ; \n + } \n presto - hive - metastore \ src \ test \ java \ com \ facebook \ presto \ hive \ metastore \ TestMetastoreClientConfig . java \n + . setRequireHadoopNative ( true ) \n + . put ( "" hive . dfs . require - hadoop - native "" , "" false "" ) \n + . setRequireHadoopNative ( false ) \n",Make require Hadoop native configurable \n On some operation systems ( e . g . : Alpine Linux ) native Hadoop libraries \n cannot be loaded,34
presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ PrestoSystemRequirements . java \n - final class PrestoSystemRequirements \n + public final class PrestoSystemRequirements \n,Increase visibility of the PrestoSystemRequirements \n So it can be used in other places then the PrestoServer ( for example \n on Spark worker ),34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ failureDetector \ FailureDetectorConfig . java \n + import javax . validation . constraints . Min ; \n + private int exponentialDecaySeconds = 60 ; \n + \n + @ Min ( 1 ) \n + public int getExponentialDecaySeconds ( ) \n + { \n + return exponentialDecaySeconds ; \n + } \n + \n + @ Config ( "" failure - detector . exponential - decay - seconds "" ) \n + public FailureDetectorConfig setExponentialDecaySeconds ( int exponentialDecaySeconds ) \n + { \n + this . exponentialDecaySeconds = exponentialDecaySeconds ; \n + return this ; \n + } \n presto - main \ src \ main \ java \ com \ facebook \ presto \ failureDetector \ HeartbeatFailureDetector . java \n + private final int exponentialDecaySeconds ; \n + this . exponentialDecaySeconds = failureDetectorConfig . getExponentialDecaySeconds ( ) ; \n - this . stats = new Stats ( uri ) ; \n + this . stats = new Stats ( uri , exponentialDecaySeconds ) ; \n - private final DecayCounter recentRequests = new DecayCounter ( ExponentialDecay . oneMinute ( ) ) ; \n - private final DecayCounter recentFailures = new DecayCounter ( ExponentialDecay . oneMinute ( ) ) ; \n - private final DecayCounter recentSuccesses = new DecayCounter ( ExponentialDecay . oneMinute ( ) ) ; \n + private final DecayCounter recentRequests ; \n + private final DecayCounter recentFailures ; \n + private final DecayCounter recentSuccesses ; \n - public Stats ( URI uri ) \n + public Stats ( URI uri , int exponentialDecaySeconds ) \n + this . recentRequests = new DecayCounter ( ExponentialDecay . seconds ( exponentialDecaySeconds ) ) ; \n + this . recentFailures = new DecayCounter ( ExponentialDecay . seconds ( exponentialDecaySeconds ) ) ; \n + this . recentSuccesses = new DecayCounter ( ExponentialDecay . seconds ( exponentialDecaySeconds ) ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ failureDetector \ TestHeartbeatFailureDetector . java \n - Stats stats = new Stats ( new URI ( "" http : / / example . com "" ) ) ; \n + Stats stats = new Stats ( new URI ( "" http : / / example . com "" ) , 60 ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ server \ TestFailureDetectorConfig . java \n - . setEnabled ( true ) ) ; \n + . setEnabled ( true ) \n + . setExponentialDecaySeconds ( 60 ) ) ; \n + . put ( "" failure - detector . exponential - decay - seconds "" , "" 1 "" ) \n - . setEnabled ( false ) ; \n + . setEnabled ( false ) \n + . setExponentialDecaySeconds ( 1 ) ; \n","Add exponential decay config to failure detector \n Make the exponential decay for failure detector , so we can configure it \n to make the recoverable exocution tests more stable",34
"presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryExecutionFactory . java \n + import static com . facebook . presto . ExceededMemoryLimitException . exceededLocalBroadcastMemoryLimit ; \n + import static com . facebook . presto . SystemSessionProperties . getQueryMaxBroadcastMemory ; \n + import static java . lang . String . format ; \n + \n + / / TODO : The driver might still OOM on a very large broadcast , think of how to prevent that from happening \n + \n + int compressedBroadcastSizeInBytes = broadcastPages . stream ( ) \n + . mapToInt ( page - > page . getBytes ( ) . length ) \n + . sum ( ) ; \n + int uncompressedBroadcastSizeInBytes = broadcastPages . stream ( ) \n + . mapToInt ( PrestoSparkSerializedPage : : getUncompressedSizeInBytes ) \n + . sum ( ) ; \n + DataSize maxBroadcastSize = getQueryMaxBroadcastMemory ( session ) ; \n + long maxBroadcastSizeInBytes = maxBroadcastSize . toBytes ( ) ; \n + \n + if ( compressedBroadcastSizeInBytes > maxBroadcastSizeInBytes ) { \n + throw exceededLocalBroadcastMemoryLimit ( maxBroadcastSize , format ( "" Compressed broadcast size : % s "" , succinctBytes ( compressedBroadcastSizeInBytes ) ) ) ; \n + } \n + \n + if ( uncompressedBroadcastSizeInBytes > maxBroadcastSizeInBytes ) { \n + throw exceededLocalBroadcastMemoryLimit ( maxBroadcastSize , format ( "" Uncompressed broadcast size : % s "" , succinctBytes ( compressedBroadcastSizeInBytes ) ) ) ; \n + } \n + \n",Enforce broadcast memory limits in Presto on Spark,34
"presto - spark - testing \ pom . xml \n - \n - < ! - - Workaround for "" Corrupted STDOUT by directly writing to native stream in forked JVM 1 "" - - > \n - < ! - - https : / / stackoverflow . com / questions / 55632614 / maven - surefire - plugin - crahsing - jvm - on - java - 11 - corrupted - stdout - by - directly - writ - - > \n - < plugin > \n - < groupId > org . apache . maven . plugins < / groupId > \n - < artifactId > maven - surefire - plugin < / artifactId > \n - < configuration > \n - < forkCount > 0 < / forkCount > \n - < / configuration > \n - < / plugin > \n",Run presto spark tests in forked VM \n The tests no longer use stream redirects thus the workaround is \n no longer needed .,34
". travis . yml \n - | \n - . / mvnw test $ MAVEN _ SKIP _ CHECKS _ AND _ DOCS - B - pl presto - spark - launcher , presto - spark - package , presto - spark - testing $ TEST _ FLAGS \n + . / mvnw test $ MAVEN _ SKIP _ CHECKS _ AND _ DOCS - B - pl presto - spark - launcher , presto - spark - package , presto - spark - testing - P test - presto - spark - integration - smoke - test \n presto - spark - testing \ pom . xml \n + \n + < profiles > \n + < profile > \n + < id > default < / id > \n + < activation > \n + < activeByDefault > true < / activeByDefault > \n + < / activation > \n + < build > \n + < plugins > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - surefire - plugin < / artifactId > \n + < configuration > \n + < excludes > \n + < exclude > * * / TestPrestoSparkLauncherIntegrationSmokeTest . java < / exclude > \n + < / excludes > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + < / profile > \n + < profile > \n + < id > test - presto - spark - integration - smoke - test < / id > \n + < build > \n + < plugins > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - surefire - plugin < / artifactId > \n + < configuration > \n + < includes > \n + < include > * * / TestPrestoSparkLauncherIntegrationSmokeTest . java < / include > \n + < / includes > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + < / profile > \n + < / profiles > \n",Do not run docker based spark integration tests by default,34
pom . xml \n - < air . test . jvmsize > 2g < / air . test . jvmsize > \n + < air . test . jvmsize > 4g < / air . test . jvmsize > \n,"Increase test runner heap size \n Lately we ' ve been observing high GC pressure when running unit and \n integration tests . Increasing heap size is supposed to mitigate this issue . \n Travis machines are equipped with 7 . 5GB of memory , thus the increase \n from 2GB to 4GB should be fine .",34
"presto - main \ src \ test \ java \ com \ facebook \ presto \ block \ BlockAssertions . java \n - return new RunLengthEncodedBlock ( type . createBlockBuilder ( null , 1 ) . appendNull ( ) . build ( ) , positionCount ) ; \n + BlockBuilder blockBuilder = type . createBlockBuilder ( null , 1 ) ; \n + for ( int i = 0 ; i < positionCount ; i + + ) { \n + blockBuilder . appendNull ( ) ; \n + } \n + return blockBuilder . build ( ) ; \n",Create normal block with all null positions in createAllNullsBlock \n It is somehow not intuitive that the createAllNullsBlock creates an \n RLE block . If the RLE block of a null value is needed - it feels like \n there should be an explicit method that does that .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ HttpRemoteSourceFactory . java \n - public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId ) \n + public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId , List < Type > types ) \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ LocalExecutionPlanner . java \n - node . getId ( ) ) ; \n + node . getId ( ) , \n + getSourceOperatorTypes ( node ) ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ RemoteSourceFactory . java \n - OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId ) ; \n + OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId , List < Type > types ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ testing \ LocalQueryRunner . java \n - public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId ) \n + public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId , List < Type > types ) \n presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkRemoteSourceFactory . java \n - public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId ) \n + public OperatorFactory createRemoteSource ( Session session , int operatorId , PlanNodeId planNodeId , List < Type > types ) \n",Refactor RemoteSourceFactory \n Pass list of types as a parameter,34
"presto - spark - launcher \ src \ main \ java \ com \ facebook \ presto \ spark \ launcher \ PrestoSparkLauncherCommand . java \n - import com . google . common . cache . Cache ; \n - import com . google . common . cache . CacheBuilder ; \n - import com . google . common . util . concurrent . UncheckedExecutionException ; \n - import java . util . concurrent . ExecutionException ; \n + import static com . google . common . base . Preconditions . checkState ; \n - private static final Cache < String , IPrestoSparkService > services = CacheBuilder . newBuilder ( ) . build ( ) ; \n + private static IPrestoSparkService service ; \n + private static String fingerprint ; \n - try { \n - return services . get ( distribution . getFingerprint ( ) , ( ) - > { \n + synchronized ( CachingServiceFactory . class ) { \n + if ( service = = null ) { \n - return serviceFactory . createService ( createConfiguration ( distribution ) ) ; \n - } ) ; \n - } \n - catch ( ExecutionException e ) { \n - throw new UncheckedExecutionException ( e ) ; \n + service = serviceFactory . createService ( createConfiguration ( distribution ) ) ; \n + fingerprint = distribution . getFingerprint ( ) ; \n + } \n + checkState ( fingerprint . equals ( distribution . getFingerprint ( ) ) , "" invalid distribution fingerprint : % s ! = % s "" , fingerprint , distribution . getFingerprint ( ) ) ; \n + return service ; \n","Make sure spark service is created only once \n If VM is recycled it is possible to reuse Presto service . \n Generally it is not expected for a VM to be reused between different queries . \n If ( for some strange reason ) VM is reused between queries , and the Presto \n package or configuration is different for these queries - we prefer to fail \n instead of keep creating Presto services . Immediate failure is preferred to \n avoid hidden liveness issues ( such as memory leaks , etc . )",34
"presto - spark - launcher \ pom . xml \n - < shadedArtifactAttached > true < / shadedArtifactAttached > \n - < shadedClassifierName > shaded < / shadedClassifierName > \n + < createSourcesJar > true < / createSourcesJar > \n + < shadeSourcesContent > true < / shadeSourcesContent > \n + < dependencyReducedPomLocation > $ { project . build . directory } / pom . xml < / dependencyReducedPomLocation > \n presto - spark - testing \ pom . xml \n - < classifier > shaded < / classifier > \n presto - spark - testing \ src \ test \ java \ com \ facebook \ presto \ spark \ testing \ TestPrestoSparkLauncherIntegrationSmokeTest . java \n - prestoLauncher = resolveFile ( new File ( projectRoot , "" presto - spark - launcher / target "" ) , Pattern . compile ( "" presto - spark - launcher - . + - shaded \ \ . jar "" ) ) ; \n + prestoLauncher = resolveFile ( new File ( projectRoot , "" presto - spark - launcher / target "" ) , Pattern . compile ( "" presto - spark - launcher - [ \ \ d \ \ . ] + ( - SNAPSHOT ) ? \ \ . jar "" ) ) ; \n","Remove dependencies from the shaded presto - launcher pom \n Shaded artifacts includes a copy of the dependency libraries classes . \n The dependency declarations have to be removed from the generated \n artifact pom . Otherwise when dependencies are included - classes \n are going to be double - included in the project that uses a shaded \n jar as a dependency . \n Unfortunately there is no way of generating a separate , reduced dependency \n pom file for only a "" shaded "" classified artifact , thus the main artifact \n has to be replaced with a shaded one .",34
presto - spark - base \ pom . xml \n + < scope > provided < / scope > \n,Reduce presto - spark - classloader - interface scope in presto - spark - base \n The presto - spark - classloader - interface classes are expected to be provided \n by the launcher classloader .,34
presto - spark - base \ pom . xml \n - < plugin > \n - < groupId > org . apache . maven . plugins < / groupId > \n - < artifactId > maven - shade - plugin < / artifactId > \n - < executions > \n - < execution > \n - < phase > package < / phase > \n - < goals > \n - < goal > shade < / goal > \n - < / goals > \n - < configuration > \n - < shadedArtifactAttached > true < / shadedArtifactAttached > \n - < shadedClassifierName > shaded < / shadedClassifierName > \n - < / configuration > \n - < / execution > \n - < / executions > \n - < / plugin > \n,Remove unnecessary maven - shade - plugin run from presto - spark - base,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ remotetask \ HttpRemoteTask . java \n - / / With recoverable grouped execution , failed task does not necessarily fail the whole query . \n - / / Not updating task info makes query unable to finish in tests because failed task is stuck in RUNNING state . \n - / / TODO : Investigate why this only happens in TestHiveRecoverableGroupedExecution when worker is closed , but not in production test via cli . \n - taskInfoFetcher . updateTaskInfo ( getTaskInfo ( ) . withTaskStatus ( status ) ) ; \n - abort ( failWith ( getTaskStatus ( ) , FAILED , ImmutableList . of ( toFailure ( cause ) ) ) ) ; \n + TaskStatus failedTaskStatus = failWith ( getTaskStatus ( ) , FAILED , ImmutableList . of ( toFailure ( cause ) ) ) ; \n + / / Transition task to failed state without waiting for the final task info returned by the abort request . \n + / / The abort request is very likely not to succeed , leaving the task and the stage in the limbo state for \n + / / the entire duration of abort retries . If the task is failed , it is not that important to actually \n + / / record the final statistics and the final information about a failed task . \n + taskInfoFetcher . updateTaskInfo ( getTaskInfo ( ) . withTaskStatus ( failedTaskStatus ) ) ; \n + \n + / / Initiate abort request \n + abort ( failedTaskStatus ) ; \n",Wait for final task info on abort \n Wait for final task info on abort to avoid missing task statistics in \n case when query finishes before the final task info is received by the \n TaskInfoFetcher .,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ CoordinatorModule . java \n - config . setIdleTimeout ( new Duration ( 30 , SECONDS ) ) ; \n - config . setIdleTimeout ( new Duration ( 30 , SECONDS ) ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ ServerMainModule . java \n - config . setIdleTimeout ( new Duration ( 30 , SECONDS ) ) ; \n - config . setIdleTimeout ( new Duration ( 30 , SECONDS ) ) ; \n","Remove overrides for idle connection timeout \n The override was added when the idle timeout was low in the HttpClient \n configuration . Now the default is 1m , thus it is even higher than the \n specified 30s timeout .",34
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ PageBufferClient . java \n - future . cancel ( true ) ; \n + / / do not terminate if the request is already running to avoid closing pooled connections \n + future . cancel ( false ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ remotetask \ ContinuousTaskStatusFetcher . java \n - future . cancel ( true ) ; \n + / / do not terminate if the request is already running to avoid closing pooled connections \n + future . cancel ( false ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ remotetask \ HttpRemoteTask . java \n - currentRequest . cancel ( true ) ; \n + / / do not terminate if the request is already running to avoid closing pooled connections \n + currentRequest . cancel ( false ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ remotetask \ TaskInfoFetcher . java \n - future . cancel ( true ) ; \n + / / do not terminate if the request is already running to avoid closing pooled connections \n + future . cancel ( false ) ; \n,Do not cancel running HTTP requests \n Canceling a running HTTP request when using HTTP / 1 closes underlying \n connection decreasing the pooling efficiency . It is also possible to \n run out of ports ff the connections are closed and reopened too \n frequently .,34
pom . xml \n - < version > 2 . 0 . 2 - 4 < / version > \n + < version > 2 . 0 . 2 - 6 < / version > \n,Update spark - core to 2 . 0 . 2 - 6 \n The new version contains non relocated kryo classes,34
presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkRowBuffer . java \n + memoryManager . updateMemoryUsage ( row . getRetainedSize ( ) ) ; \n - memoryManager . updateMemoryUsage ( row . getRetainedSize ( ) ) ; \n - } \n - if ( row ! = null ) { \n - memoryManager . updateMemoryUsage ( - row . getRetainedSize ( ) ) ; \n + if ( row ! = null ) { \n + memoryManager . updateMemoryUsage ( - row . getRetainedSize ( ) ) ; \n + } \n,Fix PrestoSparkRowBuffer synchronization \n Otherwise newly added row can be pulled out of buffer \n even before the memory context is updated resulting in assertion \n failures in memory context as overall memory utilization can become \n negative,34
"presto - spark - testing \ src \ test \ java \ com \ facebook \ presto \ spark \ testing \ TestPrestoSparkLauncherIntegrationSmokeTest . java \n - "" - e "" , "" SPARK _ APPLICATION _ JAR _ LOCATION = / presto / launcher . jar "" , \n - "" - e "" , "" SPARK _ APPLICATION _ MAIN _ CLASS = com . facebook . presto . spark . launcher . PrestoSparkLauncher "" , \n - "" - e "" , "" SPARK _ SUBMIT _ ARGS = - - deploy - mode client "" , \n - "" - e "" , "" SPARK _ APPLICATION _ ARGS = "" + \n - "" - - catalog hive "" + \n - "" - - schema default "" + \n - "" - f / presto / query . sql "" + \n - "" - - package / presto / package . tar . gz "" + \n - "" - - config / presto / etc / config . properties "" + \n - "" - - catalogs / presto / etc / catalogs "" , \n - "" / bin / bash "" , "" / spark - submit . sh "" ) ; \n + "" / spark / bin / spark - submit "" , \n + "" - - master "" , "" spark : / / spark - master : 7077 "" , \n + "" - - class "" , "" com . facebook . presto . spark . launcher . PrestoSparkLauncher "" , \n + "" / presto / launcher . jar "" , \n + "" - - package "" , "" / presto / package . tar . gz "" , \n + "" - - config "" , "" / presto / etc / config . properties "" , \n + "" - - catalogs "" , "" / presto / etc / catalogs "" , \n + "" - - catalog "" , "" hive "" , \n + "" - - schema "" , "" default "" , \n + "" - - file "" , "" / presto / query . sql "" ) ; \n",Invoke spark - submit directly \n This is more flexible,34
"presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ PrestoSparkSettingsRequirements . java \n + import static com . facebook . presto . SystemSessionProperties . isForceSingleNodeOutput ; \n + verify ( ! isForceSingleNodeOutput ( session ) , "" force single node output is expected to be disabled "" ) ; \n + config . setPreferDistributedUnion ( false ) ; \n + config . setForceSingleNodeOutput ( false ) ; \n","Disable force single node output for Presto on Spark \n There ' s no need for another round of collect , as the results are always collected \n on the driver",34
"presto - spark - testing \ src \ test \ java \ com \ facebook \ presto \ spark \ testing \ TestPrestoSparkLauncherIntegrationSmokeTest . java \n - "" spark - worker "" , 3 , \n + "" spark - worker "" , 2 , \n + "" - - executor - memory "" , "" 512m "" , \n presto - spark - testing \ src \ test \ resources \ docker - compose . yml \n - "" TZ = America / Bahia _ Banderas "" \n - SPARK _ MASTER = spark : / / spark - master : 7077 \n - - SPARK _ DRIVER _ MEMORY = 1G \n + - SPARK _ DRIVER _ MEMORY = 512m \n - SPARK _ WORKER _ CORES = 1 \n - - SPARK _ WORKER _ MEMORY = 2G \n - - SPARK _ EXECUTOR _ MEMORY = 2G \n + - SPARK _ WORKER _ MEMORY = 1G \n",Reduce spark integration tests memory footprint \n To prevent Travis from failing intermittently,34
"presto - hive - hadoop2 \ bin \ run _ hive _ tests . sh \n - # restart HMS to pickup memory settings \n - exec _ in _ hadoop _ master _ container cp / etc / hadoop / conf / hive - env . sh / etc / hive / conf / hive - env . sh \n - exec _ in _ hadoop _ master _ container supervisorctl restart hive - metastore \n - retry check _ hadoop \n - \n presto - hive - hadoop2 \ conf \ docker - compose . yml \n - . . / . . / presto - hive / src / test / sql : / files / sql : ro \n - . / files / words : / usr / share / dict / words : ro \n - . / files / core - site . xml . s3 - template : / etc / hadoop / conf / core - site . xml . s3 - template : ro \n - - . / files / hive - env . sh : / etc / hadoop / conf / hive - env . sh : ro \n - . / files / test1 . csv : / tmp / test1 . csv : ro \n - . / files / test1 . csv . gz : / tmp / test1 . csv . gz : ro \n - . / files / test1 . csv . lz4 : / tmp / test1 . csv . lz4 : ro \n deleted file \n presto - hive - hadoop2 \ conf \ files \ hive - env . sh \n - export HADOOP _ OPTS = "" $ HADOOP _ OPTS - Xmx1024m "" \n","Revert "" Update HMS memory settings "" \n This reverts commit 358f72724121a32bfce58d902e3359c54de87bda .",34
"presto - hive - metastore \ src \ main \ java \ com \ facebook \ presto \ hive \ metastore \ thrift \ StaticHiveCluster . java \n - private final boolean isMultiHMSEnabled ; \n - this ( config . getMetastoreUris ( ) , config . isMultiHMSEnabled ( ) , config . getMetastoreUsername ( ) , clientFactory ) ; \n + this ( config . getMetastoreUris ( ) , config . getMetastoreUsername ( ) , clientFactory ) ; \n - public StaticHiveCluster ( List < URI > metastoreUris , boolean isMultiHMSEnabled , String metastoreUsername , HiveMetastoreClientFactory clientFactory ) \n + public StaticHiveCluster ( List < URI > metastoreUris , String metastoreUsername , HiveMetastoreClientFactory clientFactory ) \n - this . isMultiHMSEnabled = isMultiHMSEnabled ; \n - if ( isMultiHMSEnabled ) { \n - Collections . shuffle ( metastores ) ; \n - } \n - else { \n - Collections . shuffle ( metastores . subList ( 1 , metastores . size ( ) ) ) ; \n - } \n + Collections . shuffle ( metastores . subList ( 1 , metastores . size ( ) ) ) ; \n presto - hive - metastore \ src \ main \ java \ com \ facebook \ presto \ hive \ metastore \ thrift \ StaticMetastoreConfig . java \n - private boolean isMultiHMSEnabled ; \n - public boolean isMultiHMSEnabled ( ) \n - { \n - return isMultiHMSEnabled ; \n - } \n - \n - @ Config ( "" hive . metastore . multi - instance . enabled "" ) \n - @ ConfigDescription ( "" Whether enable the load balancing between all configured HMS instance "" ) \n - public StaticMetastoreConfig setMultiHMSEnabled ( boolean enabled ) \n - { \n - this . isMultiHMSEnabled = enabled ; \n - return this ; \n - } \n - \n presto - hive - metastore \ src \ test \ java \ com \ facebook \ presto \ hive \ metastore \ thrift \ TestStaticMetastoreConfig . java \n - . setMetastoreUsername ( null ) \n - . setMultiHMSEnabled ( false ) ) ; \n + . setMetastoreUsername ( null ) ) ; \n - . put ( "" hive . metastore . multi - instance . enabled "" , "" true "" ) \n - . setMetastoreUsername ( "" presto "" ) \n - . setMultiHMSEnabled ( true ) ; \n + . setMetastoreUsername ( "" presto "" ) ; \n - . put ( "" hive . metastore . multi - instance . enabled "" , "" true "" ) \n - . setMetastoreUsername ( "" presto "" ) \n - . setMultiHMSEnabled ( true ) ; \n + . setMetastoreUsername ( "" presto "" ) ; \n","Revert "" add Config for multiple hms instances "" \n This reverts commit ff9ae918ecf9f0bec7aa9f9f401d70160e231bea .",34
"presto - main \ src \ test \ java \ com \ facebook \ presto \ spiller \ TestFileSingleStreamSpiller . java \n + import java . util . UUID ; \n - private final File spillPath = Files . createTempDir ( ) ; \n + private final File tempDirectory = Files . createTempDir ( ) ; \n - deleteRecursively ( spillPath . toPath ( ) , ALLOW _ INSECURE ) ; \n + deleteRecursively ( tempDirectory . toPath ( ) , ALLOW _ INSECURE ) ; \n + File spillPath = new File ( tempDirectory , UUID . randomUUID ( ) . toString ( ) ) ; \n","Fix flaky TestFileSingleStreamSpiller \n The test was sporadically failing at \n > assertEquals ( listFiles ( spillPath . toPath ( ) ) . size ( ) , 0 ) ; \n The assertion verifies that the spiller does the cleanup on close . \n Since the test is not single threaded , test methods are allowed to \n run in parallel . Thus it is not correct to write to a single shared \n folder . Instead each test method has to write to it ' s own folder to \n guarantee that the folder will be empty after the cleanup .",34
"presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkOutputOperator . java \n + byte [ ] rowBytes = output . size ( ) = = 0 ? new byte [ 0 ] : output . getUnderlyingSlice ( ) . byteArray ( ) ; \n - rowBuffer . enqueue ( new PrestoSparkRow ( i , output . size ( ) , output . getUnderlyingSlice ( ) . byteArray ( ) ) ) ; \n + rowBuffer . enqueue ( new PrestoSparkRow ( i , output . size ( ) , rowBytes ) ) ; \n - rowBuffer . enqueue ( new PrestoSparkRow ( partition , output . size ( ) , output . getUnderlyingSlice ( ) . byteArray ( ) ) ) ; \n + rowBuffer . enqueue ( new PrestoSparkRow ( partition , output . size ( ) , rowBytes ) ) ; \n",Fix PrestoSparkOutputOperator \n In case of 0 columns row the output can be empty . Empty output \n does not contain byte array .,34
". travis . yml \n - TEST _ SPECIFIC _ MODULES = presto - elasticsearch \n - TEST _ SPECIFIC _ MODULES = presto - orc \n - TEST _ SPECIFIC _ MODULES = presto - thrift - connector \n - - TEST _ OTHER _ MODULES = ! presto - tests , ! presto - raptor , ! presto - accumulo , ! presto - cassandra , ! presto - hive , ! presto - kudu , ! presto - docs , ! presto - server , ! presto - server - rpm , ! presto - main , ! presto - mongodb , ! presto - spark - package , ! presto - spark - launcher , ! presto - spark - testing , ! presto - redis , ! presto - elasticsearch , ! presto - orc , ! presto - thrift - connector \n + - TEST _ SPECIFIC _ MODULES = presto - spark - base \n + - TEST _ OTHER _ MODULES = ! presto - tests , ! presto - raptor , ! presto - accumulo , ! presto - cassandra , ! presto - hive , ! presto - kudu , ! presto - docs , ! presto - server , ! presto - server - rpm , ! presto - main , ! presto - mongodb , ! presto - spark - package , ! presto - spark - launcher , ! presto - spark - testing , ! presto - spark - base , ! presto - redis , ! presto - elasticsearch , ! presto - orc , ! presto - thrift - connector \n - PRODUCT _ TESTS _ BASIC _ ENVIRONMENT = true \n - PRODUCT _ TESTS _ SPECIFIC _ ENVIRONMENT = true \n - PRODUCT _ TESTS _ SPECIFIC _ ENVIRONMENT _ 2 = true \n",Run presto - spark - base tests in a separate travis job,34
"presto - spark - base \ src \ test \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryRunner . java \n - . setAppName ( "" presto "" ) ; \n + . setAppName ( "" presto "" ) \n + . set ( "" spark . driver . host "" , "" localhost "" ) ; \n","Fix hostname related assertion failure in PrestoSparkQueryRunner \n If the local hostname is not set in the system , the PrestoSparkQueryRunner \n fails with the "" java . lang . AssertionError : assertion failed : Expected hostname "" . \n Following the workaround described in the issue : \n https : / / issues . apache . org / jira / browse / SPARK - 19394 ? focusedCommentId = 15846109",34
"presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryExecutionFactory . java \n - settingsRequirements . verify ( sparkContext , session ) ; \n + settingsRequirements . verify ( sparkContext , session ) ; \n + \n",Check requirements under try - catch \n To make sure that query events are generated,34
presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryExecutionFactory . java \n + import com . facebook . presto . spark . classloader _ interface . PrestoSparkExecutionException ; \n - import com . facebook . presto . spark . execution . PrestoSparkExecutionException ; \n presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkExecutionExceptionFactory . java \n + import com . facebook . presto . spark . classloader _ interface . PrestoSparkExecutionException ; \n + import com . facebook . presto . spark . classloader _ interface . PrestoSparkNonRetryableExecutionException ; \n + import com . facebook . presto . spark . classloader _ interface . PrestoSparkRetryableExecutionException ; \n presto - spark - base \ src \ test \ java \ com \ facebook \ presto \ spark \ execution \ TestPrestoSparkExecutionExceptionFactory . java \n + import com . facebook . presto . spark . classloader _ interface . PrestoSparkExecutionException ; \n rename from presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkExecutionException . java \n rename to presto - spark - classloader - interface \ src \ main \ java \ com \ facebook \ presto \ spark \ classloader _ interface \ PrestoSparkExecutionException . java \n - package com . facebook . presto . spark . execution ; \n + package com . facebook . presto . spark . classloader _ interface ; \n rename from presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkNonRetryableExecutionException . java \n rename to presto - spark - classloader - interface \ src \ main \ java \ com \ facebook \ presto \ spark \ classloader _ interface \ PrestoSparkNonRetryableExecutionException . java \n - package com . facebook . presto . spark . execution ; \n + package com . facebook . presto . spark . classloader _ interface ; \n rename from presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ execution \ PrestoSparkRetryableExecutionException . java \n rename to presto - spark - classloader - interface \ src \ main \ java \ com \ facebook \ presto \ spark \ classloader _ interface \ PrestoSparkRetryableExecutionException . java \n - package com . facebook . presto . spark . execution ; \n + package com . facebook . presto . spark . classloader _ interface ; \n,Move Presto Spark execution exceptions to presto - spark - classloader - interface \n As they have to be serializable,34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ AddLocalExchanges . java \n - PlanWithProperties source = originalTableWriterNode . getSource ( ) . accept ( this , fixedParallelism ( ) ) ; \n + PlanWithProperties source = originalTableWriterNode . getSource ( ) . accept ( this , defaultParallelism ( session ) ) ; \n",Prefer default parallelism to avoid adding extra local exchange \n For partitioned writes the shuffle is added unconditionally . There ' s \n no reason to additionally prefer the fixed streams .,34
presto - spark - base \ src \ main \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryExecutionFactory . java \n + import static java . util . Collections . unmodifiableList ; \n - ImmutableList . Builder < Object > columns = ImmutableList . builder ( ) ; \n + List < Object > columns = new ArrayList < > ( ) ; \n - result . add ( columns . build ( ) ) ; \n + result . add ( unmodifiableList ( columns ) ) ; \n,Support nulls in results for Presto on Spark,34
"presto - spark - base \ src \ test \ java \ com \ facebook \ presto \ spark \ PrestoSparkQueryRunner . java \n + import static com . google . common . base . Preconditions . checkState ; \n - sparkContext . cancelAllJobs ( ) ; \n - sparkContext . stop ( ) ; \n + sparkContextHolder . release ( sparkContext ) ; \n + private static int referenceCount ; \n + referenceCount + + ; \n + \n + public void release ( SparkContext sparkContext ) \n + { \n + synchronized ( SparkContextHolder . class ) { \n + checkState ( SparkContextHolder . sparkContext = = sparkContext , "" unexpected spark context "" ) ; \n + referenceCount - - ; \n + if ( referenceCount = = 0 ) { \n + sparkContext . cancelAllJobs ( ) ; \n + sparkContext . stop ( ) ; \n + SparkContextHolder . sparkContext = null ; \n + } \n + } \n + } \n","Do not close testing SparkContext that is still in use \n Multiple SparkContext per JVM is not supported , thus we have to \n maintain a single SparkContext . This commit prevents the context \n from being closed while it is still in use by a SparkQueryRunner \n instance .",34
"presto - main \ src \ main \ java \ com \ facebook \ presto \ spiller \ LocalTempStorage . java \n + initialize ( ) ; \n - @ Override \n - public void initialize ( ) \n - throws IOException \n + private void initialize ( ) \n presto - main \ src \ main \ java \ com \ facebook \ presto \ spiller \ TempStorageSingleStreamSpillerFactory . java \n - import com . facebook . presto . spi . PrestoException ; \n - import com . facebook . presto . spi . storage . TempStorage ; \n - import java . io . IOException ; \n - import static com . facebook . presto . spi . StandardErrorCode . GENERIC _ INTERNAL _ ERROR ; \n - private volatile TempStorage tempStorage ; \n - \n - if ( tempStorage = = null ) { \n - initialize ( ) ; \n - } \n - \n - tempStorage , \n + tempStorageManager . getTempStorage ( tempStorageName ) , \n - \n - private synchronized void initialize ( ) \n - { \n - if ( this . tempStorage ! = null ) { \n - return ; \n - } \n - \n - TempStorage tempStorage = tempStorageManager . getTempStorage ( tempStorageName ) ; \n - try { \n - tempStorage . initialize ( ) ; \n - } \n - catch ( IOException e ) { \n - throw new PrestoException ( GENERIC _ INTERNAL _ ERROR , "" Failed to initialize temp storage "" , e ) ; \n - } \n - \n - this . tempStorage = tempStorage ; \n - } \n presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ storage \ TempStorage . java \n - void initialize ( ) \n - throws IOException ; \n - \n","Refactor TempStorage interface \n Remove the "" initialize "" method from the user visible interface . \n Initialization is an internal detail of a TempStorage implementation . \n The TempStorageFactory # create method should perform the initialization \n internally and return an already initialized instance . \n Clients of a TempStorage implementation shouldn ' t be responsible of \n initialization .",34
src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - throw new IllegalArgumentException ( \n + throw new IOException ( \n - public File newFolder ( String folder ) { \n + public File newFolder ( String folder ) throws IOException { \n - public File newFolder ( String . . . folderNames ) { \n + public File newFolder ( String . . . folderNames ) throws IOException { \n - throw new IllegalArgumentException ( \n + throw new IOException ( \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ TempFolderRuleTest . java \n - public void testNewFolder ( ) { \n + public void testNewFolder ( ) throws IOException { \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ TemporaryFolderUsageTest . java \n - thrown . expect ( IllegalArgumentException . class ) ; \n + thrown . expect ( IOException . class ) ; \n - public void newFolderWithGivenPathThrowsIllegalStateExceptionIfCreateWasNotInvoked ( ) { \n + public void newFolderWithGivenPathThrowsIllegalStateExceptionIfCreateWasNotInvoked ( ) throws IOException { \n - thrown . expect ( IllegalArgumentException . class ) ; \n + thrown . expect ( IOException . class ) ; \n - thrown . expect ( IllegalArgumentException . class ) ; \n + thrown . expect ( IOException . class ) ; \n,Replaced IllegalArgumentException for IOException \n It ' s more consistent to throw an IOException instead of an \n IllegalArgumentException,42
"build . xml \n + < property name = "" hamcrestlibsources "" location = "" lib / hamcrest - core - 1 . 3 - sources . jar "" / > \n - < unjar src = "" $ { hamcrestlib } "" dest = "" $ { hamcrestsrc } "" / > \n + < unjar src = "" $ { hamcrestlibsources } "" dest = "" $ { hamcrestsrc } "" / > \n",Fix for issue # 487 \n The wrong Harmcrest jar was used in the build . xml for generating the \n javadoc .,42
src \ main \ java \ org \ junit \ experimental \ theories \ internal \ AllMembersSupplier . java \n - fMethod = dataPointMethod ; \n + fMethod = dataPointMethod ; \n - fClass = type ; \n + fClass = type ; \n - List < PotentialAssignment > list = new ArrayList < PotentialAssignment > ( ) ; \n + List < PotentialAssignment > list = new ArrayList < PotentialAssignment > ( ) ; \n - Class < ? > type = field . getType ( ) ; \n + Class < ? > type = field . getType ( ) ; \n - for ( int i = 0 ; i < Array . getLength ( array ) ; i + + ) \n + for ( int i = 0 ; i < Array . getLength ( array ) ; i + + ) \n - for ( int i = 0 ; i < Array . getLength ( array ) ; i + + ) { \n + for ( int i = 0 ; i < Array . getLength ( array ) ; i + + ) { \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ TypeMatchingBetweenMultiDataPointsMethod . java \n - public static String [ ] [ ] wrongfullyTyped ( ) { \n + public static String [ ] [ ] anotherCorrectlyTyped ( ) { \n,Changed variable name and removed the space before the equal sign,42
CODING _ STYLE \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - * Align parameter descriptions \n - Invalid tags \n - * Keep empty @ param tags \n - * Keep empty @ return tags \n - * Keep empty @ throws tags \n - \n - * Use @ throws rather then @ exception \n + * Use @ throws rather than @ exception \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n,"Issue # 426 Added suggestions by dsaff \n - Do not align JavaDoc parameter description \n - Removed "" Keep empty . . JavaDoc tag "" \n - corrected typp",42
"src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - file . mkdir ( ) ; \n + if ( ! file . mkdir ( ) ) \n + throw new IllegalStateException ( \n + "" a folder with the name \ ' "" + folderName + "" \ ' already exists "" ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ TemporaryFolderUsageTest . java \n - new TemporaryFolder ( ) . newFolder ( "" level1 "" , "" leve2 "" , "" leve3 "" ) ; \n + new TemporaryFolder ( ) . newFolder ( "" level1 "" , "" level2 "" , "" level3 "" ) ; \n + } \n + \n + @ Test ( expected = IllegalStateException . class ) \n + public void newFolderWithGivenPathThrowsIllegalStateExceptionIfPathExists ( ) throws IOException { \n + tempFolder . create ( ) ; \n + tempFolder . newFolder ( "" level1 "" , "" level2 "" , "" level3 "" ) ; \n + tempFolder . newFolder ( "" level1 "" , "" level2 "" , "" level3 "" ) ; \n",Issue 478 : Throw an IllegalStateException when the folder already exists \n Changed the code so it behaves like it is described in the \n documentation .,42
"src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - private final File parentFolder ; \n + private final File parentFolder ; \n - public TemporaryFolder ( ) { \n - this ( null ) ; \n - } \n + public TemporaryFolder ( ) { \n + this ( null ) ; \n + } \n - public TemporaryFolder ( File parentFolder ) { \n - this . parentFolder = parentFolder ; \n - } \n + public TemporaryFolder ( File parentFolder ) { \n + this . parentFolder = parentFolder ; \n + } \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ TemporaryFolderUsageTest . java \n - @ Test \n - public void canSetTheBaseFileForATemporaryFolder ( ) throws IOException { \n - File tempDir = createTemporaryFolder ( ) ; \n + @ Test \n + public void canSetTheBaseFileForATemporaryFolder ( ) throws IOException { \n + File tempDir = createTemporaryFolder ( ) ; \n - TemporaryFolder folder = new TemporaryFolder ( tempDir ) ; \n - folder . create ( ) ; \n + TemporaryFolder folder = new TemporaryFolder ( tempDir ) ; \n + folder . create ( ) ; \n - assertThat ( tempDir , is ( folder . getRoot ( ) . getParentFile ( ) ) ) ; \n - } \n + assertThat ( tempDir , is ( folder . getRoot ( ) . getParentFile ( ) ) ) ; \n + } \n - private File createTemporaryFolder ( ) throws IOException { \n - File tempDir = File . createTempFile ( "" junit "" , "" tempFolder "" ) ; \n - assertTrue ( "" Unable to delete temporary file "" , tempDir . delete ( ) ) ; \n - assertTrue ( "" Unable to create temp directory "" , tempDir . mkdir ( ) ) ; \n - return tempDir ; \n - } \n + private File createTemporaryFolder ( ) throws IOException { \n + File tempDir = File . createTempFile ( "" junit "" , "" tempFolder "" ) ; \n + assertTrue ( "" Unable to delete temporary file "" , tempDir . delete ( ) ) ; \n + assertTrue ( "" Unable to create temp directory "" , tempDir . mkdir ( ) ) ; \n + return tempDir ; \n + } \n - private void assertFileDoesNotExist ( File file ) { \n + private void assertFileDoesNotExist ( File file ) { \n",Fixed indenting on several lines \n After solving # 479 also fixed the indenting,42
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ LruBitmapPool . java \n - public synchronized Bitmap get ( int size ) { \n - Bitmap cached = mStrategy . get ( size ) ; \n + public synchronized Bitmap get ( final int size ) { \n + if ( mCurrentSize > mMaxSize ) { \n + trimTo ( mMaxSize ) ; \n + } \n + final Bitmap cached = mStrategy . get ( size ) ; \n - public synchronized void release ( Bitmap value ) { \n + public synchronized void release ( final Bitmap value ) { \n - if ( mCurrentSize > mMaxSize ) { \n - trimTo ( mMaxSize ) ; \n - } \n,Move trim code from release to get \n Reviewed By : erikandre \n Differential Revision : D10123740 \n fbshipit - source - id : f9c56c3969896ada35d499a836a778d8741eb0de,47
gradle . properties \n - VERSION _ NAME = 1 . 9 . 0 \n + VERSION _ NAME = 1 . 10 . 0 \n,Release Fresco 1 . 10 . 0 \n Reviewed By : erikandre \n Differential Revision : D8454933 \n fbshipit - source - id : 3d2ab1a9d82adb00bbeb988b5a8303f272e2d91d,47
animated - gif \ src \ main \ jni \ Application . mk \n - APP _ ABI : = all \n + APP _ ABI : = armeabi - v7a arm64 - v8a x86 x86 _ 64 \n imagepipeline \ src \ main \ jni \ Application . mk \n - APP _ ABI : = all \n + APP _ ABI : = armeabi - v7a arm64 - v8a x86 x86 _ 64 \n static - webp \ src \ main \ jni \ Application . mk \n - APP _ ABI : = all \n + APP _ ABI : = armeabi - v7a arm64 - v8a x86 x86 _ 64 \n,Fix NDK setting for ndk ver < 17 \n Summary : Changes in github 1b86b49f60861b56d7bd89550e16f7f8e5b69383 introduced the following error for ndk < 17 : ` fresco / static - webp / src / main / jni / static - webp / . . / . . / . . / . . / nativedeps / merge / libwebp - 0 . 6 . 1 / src / dsp / yuv . c : 104 : undefined reference to ' WebPInitSamplersMIPS32 ' ` \n Reviewed By : oprisnik \n Differential Revision : D8723530 \n fbshipit - source - id : e9167b7e5221493ddb09546a0482f79e3b75c2dc,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfData . java \n + @ Nullable private final String mComponentTag ; \n + \n - long invisibilityEventTime ) { \n + long invisibilityEventTime , \n + @ Nullable String componentTag ) { \n + mComponentTag = componentTag ; \n + @ Nullable \n + public String getComponentTag ( ) { \n + return mComponentTag ; \n + } \n + \n + . add ( "" component tag "" , mComponentTag ) \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n + private @ Nullable String mComponentTag ; \n + \n + \n + mComponentTag = null ; \n + public void setComponentTag ( @ Nullable String componentTag ) { \n + mComponentTag = componentTag ; \n + } \n + \n - mInvisibilityEventTimeMs ) ; \n + mInvisibilityEventTimeMs , \n + mComponentTag ) ; \n",Add ' component tag ' field to Image Perf data \n Reviewed By : oprisnik \n Differential Revision : D12918238 \n fbshipit - source - id : 8a43b9299d83e3ad38f98e1eae53e0a217b0385b,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ LruBitmapPool . java \n - public synchronized void release ( final Bitmap value ) { \n + public void release ( final Bitmap value ) { \n - mCurrentSize + = size ; \n + synchronized ( this ) { \n + mCurrentSize + = size ; \n + } \n,Remove synchronization from bitmap size calculation \n Reviewed By : oprisnik \n Differential Revision : D12919014 \n fbshipit - source - id : 4c2b2f4510b62f5f10eca312d37533f58febe410,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BasePool . java \n + \n + import javax . annotation . Nullable ; \n + @ Nullable \n + protected synchronized V getValue ( Bucket < V > bucket ) { \n + / / noinspection deprecation \n + return bucket . get ( ) ; \n + } \n + \n - V value = bucket . get ( ) ; \n + V value = getValue ( bucket ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ Bucket . java \n + * @ deprecated use { @ link BasePool # getValue ( Bucket ) } \n + @ Deprecated \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BucketsBitmapPool . java \n + \n + import javax . annotation . Nullable ; \n + @ Nullable \n - public Bitmap get ( int size ) { \n - Bitmap result = super . get ( size ) ; \n + protected Bitmap getValue ( Bucket < Bitmap > bucket ) { \n + Bitmap result = super . getValue ( bucket ) ; \n,Move eraseColor in bitmap pool to more appropriate place \n Reviewed By : oprisnik \n Differential Revision : D9654763 \n fbshipit - source - id : 5188251451c700a433aeb3a28272d19d3b9a77d5,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapPoolType . java \n + String LEGACY _ DEFAULT _ PARAMS = "" legacy _ default _ params "" ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n + case BitmapPoolType . LEGACY _ DEFAULT _ PARAMS : \n + mBitmapPool = \n + new BucketsBitmapPool ( \n + mConfig . getMemoryTrimmableRegistry ( ) , \n + DefaultBitmapPoolParams . get ( ) , \n + mConfig . getBitmapPoolStatsTracker ( ) ) ; \n + break ; \n",Tweak bitmap pool experiment to make sure default params are used \n Reviewed By : erikandre \n Differential Revision : D10146230 \n fbshipit - source - id : 947bf32df42aa972da0a63b0f1b0f67943d6202d,47
"animated - base \ src \ main \ java \ com \ facebook \ imagepipeline \ animated \ impl \ AnimatedDrawableBackendImpl . java \n - float xScale = ( float ) mRenderedBounds . width ( ) / ( float ) mAnimatedImage . getWidth ( ) ; \n - float yScale = ( float ) mRenderedBounds . height ( ) / ( float ) mAnimatedImage . getHeight ( ) ; \n - canvas . scale ( xScale , yScale ) ; \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ imageformat \ gif \ ImageFormatGifFragment . java \n + final SwitchCompat switchAspect = ( SwitchCompat ) view . findViewById ( R . id . switch _ aspect _ ratio ) ; \n + switchAspect . setOnCheckedChangeListener ( new CompoundButton . OnCheckedChangeListener ( ) { \n + @ Override \n + public void onCheckedChanged ( CompoundButton buttonView , boolean isChecked ) { \n + ViewGroup . LayoutParams layoutParams = mSimpleDraweeView . getLayoutParams ( ) ; \n + layoutParams . height = layoutParams . width * ( isChecked ? 2 : 1 ) ; \n + mSimpleDraweeView . setLayoutParams ( layoutParams ) ; \n + } \n + } ) ; \n + \n samples \ showcase \ src \ main \ res \ layout \ fragment _ format _ gif . xml \n + xmlns : app = "" http : / / schemas . android . com / apk / res - auto "" \n + app : actualImageScaleType = "" fitXY "" \n + < android . support . v7 . widget . SwitchCompat \n + android : id = "" @ + id / switch _ aspect _ ratio "" \n + android : layout _ width = "" wrap _ content "" \n + android : layout _ height = "" wrap _ content "" \n + android : layout _ marginTop = "" @ dimen / margin _ medium "" \n + android : text = "" @ string / format _ switch _ aspect _ ratio "" \n + / > \n + \n samples \ showcase \ src \ main \ res \ values \ strings . xml \n + < string name = "" format _ switch _ aspect _ ratio "" > Portrait aspect ratio < / string > \n",GIF images with FIT _ XY scale type \n Reviewed By : oprisnik \n Differential Revision : D8117163 \n fbshipit - source - id : 780b3e3db93c53e56437e7c8b0d33bde56aef620,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ Fresco . java \n + FrescoSystrace . beginSection ( "" Fresco . initialize - > SoLoader . init "" ) ; \n + FrescoSystrace . endSection ( ) ; \n + FrescoSystrace . beginSection ( "" Fresco . initializeDrawee "" ) ; \n + FrescoSystrace . endSection ( ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineConfig . java \n + import com . facebook . imagepipeline . systrace . FrescoSystrace ; \n + FrescoSystrace . beginSection ( "" ImagePipelineConfig ( ) "" ) ; \n + FrescoSystrace . beginSection ( "" ImagePipelineConfig - > mNetworkFetcher "" ) ; \n + FrescoSystrace . endSection ( ) ; \n + FrescoSystrace . endSection ( ) ; \n - return DiskCacheConfig . newBuilder ( context ) . build ( ) ; \n + try { \n + FrescoSystrace . beginSection ( "" DiskCacheConfig . getDefaultMainDiskCacheConfig "" ) ; \n + return DiskCacheConfig . newBuilder ( context ) . build ( ) ; \n + } finally { \n + FrescoSystrace . endSection ( ) ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n + import com . facebook . imagepipeline . systrace . FrescoSystrace ; \n + \n + FrescoSystrace . beginSection ( "" ImagePipelineFactory # initialize "" ) ; \n + FrescoSystrace . endSection ( ) ; \n + FrescoSystrace . beginSection ( "" ImagePipelineConfig ( ) "" ) ; \n + FrescoSystrace . endSection ( ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ datasource \ AbstractProducerToDataSourceAdapter . java \n + import com . facebook . imagepipeline . systrace . FrescoSystrace ; \n + \n + FrescoSystrace . beginSection ( "" AbstractProducerToDataSourceAdapter ( ) "" ) ; \n + FrescoSystrace . beginSection ( "" AbstractProducerToDataSourceAdapter ( ) - > onRequestStart "" ) ; \n + FrescoSystrace . endSection ( ) ; \n + FrescoSystrace . beginSection ( "" AbstractProducerToDataSourceAdapter ( ) - > produceResult "" ) ; \n + FrescoSystrace . endSection ( ) ; \n + FrescoSystrace . endSection ( ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolConfig . java \n + import com . facebook . imagepipeline . systrace . FrescoSystrace ; \n + \n + FrescoSystrace . beginSection ( "" PoolConfig ( ) "" ) ; \n + FrescoSystrace . endSection ( ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ NetworkFetchProducer . java \n + import com . facebook . imagepipeline . systrace . FrescoSystrace ; \n + FrescoSystrace . beginSection ( "" NetworkFetcher - > onResponse "" ) ; \n + FrescoSystrace . endSection ( ) ; \n",Add more systrace markers to drawee and pipeline \n Reviewed By : oprisnik \n Differential Revision : D9677662 \n fbshipit - source - id : 18e9cd020f247e0385783e3200c7669d7bdcd9f4,47
"circle . yml \n - save - cache : * save - cache - gradle \n - run : \n - name : Run Instrmentation Tests \n + name : Run Instrumentation Tests \n - . / gradlew : samples : showcase : connectedInternalDebugAndroidTest - PdisablePreDex \n + . / gradlew : samples : showcase : connectedInternalInstrumentationAndroidTest - PdisablePreDex \n - run : \n samples \ showcase \ build . gradle \n + debug { \n + minifyEnabled false \n + } \n + instrumentation { \n + initWith debug \n + minifyEnabled true \n + proguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) , ' proguard - showcase . pro ' \n + testProguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) , ' proguard - showcase . pro ' , ' proguard - test . pro ' \n + matchingFallbacks = [ ' debug ' ] \n + } \n + testBuildType "" instrumentation "" \n + \n + \n - \n - buildTypes { \n - debug { \n - minifyEnabled true \n - proguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) , ' proguard - showcase . pro ' \n - testProguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) , ' proguard - showcase . pro ' , ' proguard - test . pro ' \n - } \n - } \n",Make debug builds debuggable \n Reviewed By : oprisnik \n Differential Revision : D8394927 \n fbshipit - source - id : 46e5340667c1ac33150842acba9fd1a53a79f458,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfDataListener . java \n - void onImagePerfDataUpdated ( ImagePerfData imagePerfData , @ ImageLoadStatus int imageLoadStatus ) ; \n + void onImageLoadStatusUpdated ( ImagePerfData imagePerfData , @ ImageLoadStatus int imageLoadStatus ) ; \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfMonitor . java \n - listener . onImagePerfDataUpdated ( data , imageLoadStatus ) ; \n + listener . onImageLoadStatusUpdated ( data , imageLoadStatus ) ; \n drawee - backends \ drawee - pipeline \ src \ test \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfMonitorTest . java \n - verify ( listener ) . onImagePerfDataUpdated ( any ( ImagePerfData . class ) , eq ( ImageLoadStatus . SUCCESS ) ) ; \n + verify ( listener ) . onImageLoadStatusUpdated ( any ( ImagePerfData . class ) , eq ( ImageLoadStatus . SUCCESS ) ) ; \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ misc \ LogcatImagePerfDataListener . java \n - public void onImagePerfDataUpdated ( ImagePerfData imagePerfData , int imageLoadStatus ) { \n + public void onImageLoadStatusUpdated ( ImagePerfData imagePerfData , \n + @ ImageLoadStatus int imageLoadStatus ) { \n",Rename method in ImagePerfDataListener interface \n Summary : Rename onImagePerfDataUpdated to onImageLoadStatusUpdated to make intent more clear and to prepare for adding onImageVisibilityUpdated APIs \n Reviewed By : oprisnik \n Differential Revision : D9179623 \n fbshipit - source - id : f3e86441aa29d7e75ae2a07d28ba44b299944ce4,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ systrace \ DefaultFrescoSystrace . java \n - Trace . beginSection ( mStringBuilder . toString ( ) ) ; \n + if ( Build . VERSION . SDK _ INT > = Build . VERSION _ CODES . JELLY _ BEAN _ MR2 ) { \n + Trace . beginSection ( mStringBuilder . toString ( ) ) ; \n + } \n samples \ comparison \ build . gradle \n - proguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) \n + proguardFiles getDefaultProguardFile ( ' proguard - android - optimize . txt ' ) , ' proguard . pro ' \n new file \n samples \ comparison \ proguard . pro \n + - dontwarn com . squareup . picasso . * * \n",Fix . / gradlew build \n Reviewed By : erikandre \n Differential Revision : D8858886 \n fbshipit - source - id : 44e8536369a43ea3271380c84f9541b41a4e9549,47
README . md \n - implementation ' com . facebook . fresco : fresco : 1 . 9 . 0 ' \n + implementation ' com . facebook . fresco : fresco : 1 . 10 . 0 ' \n docs \ _ config . yml \n - current _ version : 1 . 9 . 0 \n + current _ version : 1 . 10 . 0 \n,"Bump version number to 1 . 10 . 0 in readme and docs \n Reviewed By : erikandre , oprisnik \n Differential Revision : D8713737 \n fbshipit - source - id : cf274fcace3d808cfa6f45d6f597601562d9718a",47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineConfig . java \n + private final boolean mDiskCacheEnabled ; \n + mDiskCacheEnabled = builder . mDiskCacheEnabled ; \n + public boolean isDiskCacheEnabled ( ) { \n + return mDiskCacheEnabled ; \n + } \n + \n + private boolean mDiskCacheEnabled = true ; \n + public boolean isDiskCacheEnabled ( ) { \n + return mDiskCacheEnabled ; \n + } \n + \n + public Builder setDiskCacheEnabled ( boolean diskCacheEnabled ) { \n + mDiskCacheEnabled = diskCacheEnabled ; \n + return this ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n - mConfig . getExperiments ( ) . isPartialImageCachingEnabled ( ) ) ; \n + mConfig . getExperiments ( ) . isPartialImageCachingEnabled ( ) , \n + mConfig . isDiskCacheEnabled ( ) ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactory . java \n + private final boolean mDiskCacheEnabled ; \n - boolean partialImageCachingEnabled ) { \n + boolean partialImageCachingEnabled , \n + boolean diskCacheEnabled ) { \n + mDiskCacheEnabled = diskCacheEnabled ; \n - inputProducer = newDiskCacheSequence ( inputProducer ) ; \n + if ( mDiskCacheEnabled ) { \n + inputProducer = newDiskCacheSequence ( inputProducer ) ; \n + } \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactoryTest . java \n - false ) ; \n + false , \n + true ) ; \n - false ) ; \n + false , \n + true ) ; \n",Add option to disable disk cache \n Reviewed By : oprisnik \n Differential Revision : D8331433 \n fbshipit - source - id : c5d6b0af7b4e45e9aba88aa21f377cca921002b8,47
"samples \ kotlin \ src \ main \ kotlin \ com \ facebook \ samples \ kotlin \ ImageAdapter . kt \n + import com . facebook . drawee . backends . pipeline . info . ImagePerfDataListener \n + val logImagePerf = object : ImagePerfDataListener { \n + override fun onImageLoadStatusUpdated ( imagePerfData : ImagePerfData ? , imageLoadStatus : Int ) { \n + Log . d ( "" ImagePerf "" , \n + "" state = $ { ImagePerfUtils . toString ( imageLoadStatus ) } , data = $ { imagePerfData ? . createDebugString ( ) } "" ) \n + } \n + \n + override fun onImageVisibilityUpdated ( imagePerfData : ImagePerfData ? , visibilityState : Int ) { \n + / / ignore \n + } \n + } \n + \n - . setPerfDataListener ( : : logImagePerf ) \n + . setPerfDataListener ( logImagePerf ) \n - \n - private fun logImagePerf ( imagePerfData : ImagePerfData , @ ImageLoadStatus state : Int ) { \n - Log . d ( "" ImagePerf "" , \n - "" state = $ { ImagePerfUtils . toString ( state ) } , data = $ { imagePerfData . createDebugString ( ) } "" ) \n - } \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ misc \ LogcatImagePerfDataListener . java \n + import com . facebook . drawee . backends . pipeline . info . ImageLoadStatus ; \n + import com . facebook . drawee . backends . pipeline . info . VisibilityState ; \n - ImagePerfUtils . toString ( imagePerfData . getImageLoadStatus ( ) ) , \n + ImagePerfUtils . toString ( imageLoadStatus ) , \n - public void onImagePerfDataVisibilityChanges ( ImagePerfData imagePerfData ) { \n + public void onImageVisibilityUpdated ( \n + ImagePerfData imagePerfData , @ VisibilityState int visibility ) { \n","Unbreak CircleCI \n Reviewed By : erikandre , oprisnik \n Differential Revision : D9211107 \n fbshipit - source - id : a87d178554a003aefad100ea3265b2e222767058",47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n - private long mVisibilityEventTimeMs ; \n - private long mInvisibilityEventTimeMs ; \n + private long mVisibilityEventTimeMs = UNSET ; \n + private long mInvisibilityEventTimeMs = UNSET ; \n + \n + mVisibilityState = VisibilityState . UNKNOWN ; \n + mVisibilityEventTimeMs = UNSET ; \n + mInvisibilityEventTimeMs = UNSET ; \n,Fix ImagePerfState . reset ( ) \n Reviewed By : oprisnik \n Differential Revision : D9217372 \n fbshipit - source - id : cbb8c1da6faaf509510ac1e51c383aa8ebc7157b,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListener . java \n - \n - reportViewInvisible ( now ) ; \n + final long now = mClock . now ( ) ; \n + \n - mImagePerfState . setControllerCancelTimeMs ( mClock . now ( ) ) ; \n + mImagePerfState . setControllerCancelTimeMs ( now ) ; \n + \n + reportViewInvisible ( now ) ; \n drawee - backends \ drawee - pipeline \ src \ test \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListenerTest . java \n + int expectedNumOfTimestamps = 0 ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n - verify ( mMonotonicClock , times ( 2 ) ) . now ( ) ; \n + verify ( mMonotonicClock , times ( expectedNumOfTimestamps ) ) . now ( ) ; \n + int expectedNumOfTimestamps = 0 ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n - verify ( mMonotonicClock , times ( 2 ) ) . now ( ) ; \n + verify ( mMonotonicClock , times ( expectedNumOfTimestamps ) ) . now ( ) ; \n + int expectedNumOfTimestamps = 0 ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n - verify ( mMonotonicClock , times ( 2 ) ) . now ( ) ; \n + verify ( mMonotonicClock , times ( expectedNumOfTimestamps ) ) . now ( ) ; \n + int expectedNumOfTimestamps = 0 ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n + expectedNumOfTimestamps + + ; \n - verify ( mMonotonicClock , times ( 3 ) ) . now ( ) ; \n + verify ( mMonotonicClock , times ( expectedNumOfTimestamps ) ) . now ( ) ; \n",Fix invisibility reporting \n Reviewed By : oprisnik \n Differential Revision : D9338862 \n fbshipit - source - id : 3d1f0972db4c25f3c94d26ba01c4c31a7a08aebc,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BucketsBitmapPool . java \n + import android . graphics . Color ; \n + \n + @ Override \n + public Bitmap get ( int size ) { \n + Bitmap result = super . get ( size ) ; \n + if ( result ! = null ) { \n + result . eraseColor ( Color . TRANSPARENT ) ; \n + } \n + return result ; \n + } \n,Fix not reseting bitmaps when releasing to pool \n Reviewed By : oprisnik \n Differential Revision : D9496573 \n fbshipit - source - id : 415de9357803f43dec3a77529a0b1cef3e24b794,47
"new file \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapPoolType . java \n + / * \n + * Copyright ( c ) 2017 - present , Facebook , Inc . \n + * All rights reserved . \n + * \n + * This source code is licensed under the BSD - style license found in the \n + * LICENSE file in the root directory of this source tree . An additional grant \n + * of patent rights can be found in the PATENTS file in the same directory . \n + * / \n + package com . facebook . imagepipeline . memory ; \n + \n + public @ interface BitmapPoolType { \n + String LEGACY = "" legacy "" ; \n + String DUMMY = "" dummy "" ; \n + String EXPERIMENTAL = "" experimental "" ; \n + \n + String DEFAULT = LEGACY ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolConfig . java \n - public static final String DEFAULT _ BITMAP _ POOL _ TYPE = "" legacy "" ; \n - \n + private final int mBitmapPoolMaxSize ; \n - mBitmapPoolType = builder . mBitmapPoolType = = null ? DEFAULT _ BITMAP _ POOL _ TYPE : builder . mBitmapPoolType ; \n + mBitmapPoolType = \n + builder . mBitmapPoolType = = null ? BitmapPoolType . DEFAULT : builder . mBitmapPoolType ; \n + mBitmapPoolMaxSize = builder . mBitmapPoolMaxSize ; \n + public int getBitmapPoolMaxSize ( ) { \n + return mBitmapPoolMaxSize ; \n + } \n + \n + private int mBitmapPoolMaxSize ; \n - public void setBitmapPoolType ( String bitmapPoolType ) { \n + public Builder setBitmapPoolType ( String bitmapPoolType ) { \n + return this ; \n + } \n + \n + public Builder setBitmapPoolMaxSize ( int bitmapPoolMaxSize ) { \n + mBitmapPoolMaxSize = bitmapPoolMaxSize ; \n + return this ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n - case "" dummy "" : \n + case BitmapPoolType . DUMMY : \n - case "" legacy "" : \n + break ; \n + case BitmapPoolType . EXPERIMENTAL : \n + mBitmapPool = \n + new LruBitmapPool ( \n + mConfig . getBitmapPoolMaxSize ( ) , mConfig . getBitmapPoolStatsTracker ( ) ) ; \n + break ; \n + case BitmapPoolType . LEGACY : \n",Set up a bitmap experiment \n Reviewed By : oprisnik \n Differential Revision : D9481989 \n fbshipit - source - id : ae5ee809735b85becde8c17add362dd0bdea670d,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n - new LruBitmapPool ( \n - mConfig . getBitmapPoolMaxSize ( ) , mConfig . getBitmapPoolStatsTracker ( ) ) ; \n + new LruBitmapPool ( mConfig . getBitmapPoolMaxSize ( ) , NoOpPoolStatsTracker . getInstance ( ) ) ; \n",Set pool stats tracker to NoOp for experimental bitmap pool \n Reviewed By : oprisnik \n Differential Revision : D9540953 \n fbshipit - source - id : dde86d9c513aad7a03e0558f71b4cda8a1219f19,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapPoolBackend . java \n + import com . facebook . common . logging . FLog ; \n + \n + private static final String TAG = "" BitmapPoolBackend "" ; \n + \n + @ Override \n + public void put ( Bitmap bitmap ) { \n + if ( isReusable ( bitmap ) ) { \n + super . put ( bitmap ) ; \n + } \n + } \n + \n - if ( bitmap ! = null ) { \n + if ( bitmap ! = null & & isReusable ( bitmap ) ) { \n + return bitmap ; \n - return bitmap ; \n + return null ; \n + \n + protected boolean isReusable ( @ Nullable Bitmap bitmap ) { \n + if ( bitmap = = null ) { \n + return false ; \n + } \n + if ( bitmap . isRecycled ( ) ) { \n + FLog . wtf ( TAG , "" Cannot reuse a recycled bitmap : % s "" , bitmap ) ; \n + return false ; \n + } \n + if ( ! bitmap . isMutable ( ) ) { \n + FLog . wtf ( TAG , "" Cannot reuse an immutable bitmap : % s "" , bitmap ) ; \n + return false ; \n + } \n + return true ; \n + } \n",Check bitmap reusability \n Summary : \n Context : Some components recycle bitmaps manually before closing the reference . \n Fix : Check that bitmap is not recycled and is mutable when putting / getting to / from the pool ; report soft error otherwise . \n Reviewed By : oprisnik \n Differential Revision : D9608432 \n fbshipit - source - id : 9a709de6e4364eb9c7886707a7d9b3c156210383,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n - \n + / * * \n + * @ return { @ link CacheKey } for doing bitmap cache lookups in the pipeline . \n + * / \n + @ Nullable \n + public CacheKey getCacheKey ( ImageRequest imageRequest , Object callerContext ) { \n + final CacheKeyFactory cacheKeyFactory = mCacheKeyFactory ; \n + CacheKey cacheKey = null ; \n + if ( cacheKeyFactory ! = null & & imageRequest ! = null ) { \n + if ( imageRequest . getPostprocessor ( ) ! = null ) { \n + cacheKey = cacheKeyFactory . getPostprocessedBitmapCacheKey ( imageRequest , callerContext ) ; \n + } else { \n + cacheKey = cacheKeyFactory . getBitmapCacheKey ( imageRequest , callerContext ) ; \n + } \n + } \n + return cacheKey ; \n + } \n + \n + / * * \n + * Returns a reference to the cached image \n + * \n + * @ param cacheKey \n + * @ return a closeable reference or null if image was not present in cache \n + * / \n + @ Nullable \n + public CloseableReference < CloseableImage > getCachedImage ( @ Nullable CacheKey cacheKey ) { \n + MemoryCache < CacheKey , CloseableImage > memoryCache = mBitmapMemoryCache ; \n + if ( memoryCache = = null | | cacheKey = = null ) { \n + return null ; \n + } \n + CloseableReference < CloseableImage > closeableImage = memoryCache . get ( cacheKey ) ; \n + if ( closeableImage ! = null & & ! closeableImage . get ( ) . getQualityInfo ( ) . isOfFullQuality ( ) ) { \n + closeableImage . close ( ) ; \n + return null ; \n + } \n + return closeableImage ; \n + } \n",Move cache methods from FrescoContext to ImagePipeline \n Reviewed By : oprisnik \n Differential Revision : D9906720 \n fbshipit - source - id : 356d09f91516e82869e67e21b1da843337f85382,47
new file \n CODE _ OF _ CONDUCT . md \n + # Code of Conduct \n + \n + Facebook has adopted a Code of Conduct that we expect project participants to adhere to . Please [ read the full text ] ( https : / / code . fb . com / codeofconduct / ) so that you can understand what actions will and will not be tolerated . \n,Add code of conduct \n Reviewed By : oprisnik \n Differential Revision : D10482072 \n fbshipit - source - id : 8b087c0c970febf2994bd61eeeb2af74be297626,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ LruBitmapPool . java \n + import android . support . annotation . Nullable ; \n + import com . facebook . common . memory . MemoryTrimmableRegistry ; \n - public LruBitmapPool ( int maxPoolSize , int maxBitmapSize , PoolStatsTracker poolStatsTracker ) { \n + public LruBitmapPool ( \n + int maxPoolSize , \n + int maxBitmapSize , \n + PoolStatsTracker poolStatsTracker , \n + @ Nullable MemoryTrimmableRegistry memoryTrimmableRegistry ) { \n + if ( memoryTrimmableRegistry ! = null ) { \n + memoryTrimmableRegistry . registerMemoryTrimmable ( this ) ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolConfig . java \n + private final boolean mRegisterLruBitmapPoolAsMemoryTrimmable ; \n + mRegisterLruBitmapPoolAsMemoryTrimmable = builder . mRegisterLruBitmapPoolAsMemoryTrimmable ; \n + public boolean isRegisterLruBitmapPoolAsMemoryTrimmable ( ) { \n + return mRegisterLruBitmapPoolAsMemoryTrimmable ; \n + } \n + \n + private boolean mRegisterLruBitmapPoolAsMemoryTrimmable ; \n + \n + public void setRegisterLruBitmapPoolAsMemoryTrimmable ( \n + boolean registerLruBitmapPoolAsMemoryTrimmable ) { \n + mRegisterLruBitmapPoolAsMemoryTrimmable = registerLruBitmapPoolAsMemoryTrimmable ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n - NoOpPoolStatsTracker . getInstance ( ) ) ; \n + NoOpPoolStatsTracker . getInstance ( ) , \n + mConfig . isRegisterLruBitmapPoolAsMemoryTrimmable ( ) \n + ? mConfig . getMemoryTrimmableRegistry ( ) \n + : null ) ; \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ memory \ LruBitmapPoolTest . java \n - spy ( new LruBitmapPool ( 10 * 1024 * 1024 , 1024 * 1024 , NoOpPoolStatsTracker . getInstance ( ) ) ) ; \n + spy ( \n + new LruBitmapPool ( \n + 10 * 1024 * 1024 , 1024 * 1024 , NoOpPoolStatsTracker . getInstance ( ) , null ) ) ; \n",Register LruBitmapPool as memory trimmable \n Summary : Register new LruBitmapPool with MemoryTrimmable similarly to BucketsBitmapPool . That allows to trim pool when app goes into BG and other cases . \n Reviewed By : oprisnik \n Differential Revision : D13036271 \n fbshipit - source - id : 69f9b1fc0a061a1da4234e857fdff1c7dc3c007e,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n + if ( FrescoSystrace . isTracing ( ) ) { \n + FrescoSystrace . beginSection ( "" ImagePipeline # getCacheKey "" ) ; \n + } \n + if ( FrescoSystrace . isTracing ( ) ) { \n + FrescoSystrace . endSection ( ) ; \n + } \n",Add systrace section to ImagePipeline # getCacheKey \n Reviewed By : erikandre \n Differential Revision : D13120864 \n fbshipit - source - id : 009a793b77599464e75049321f81b489ede89145,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ ScaleTypeDrawable . java \n + import android . support . annotation . Nullable ; \n - @ VisibleForTesting PointF mFocusPoint = null ; \n + @ VisibleForTesting @ Nullable PointF mFocusPoint = null ; \n + / * * \n + * Creates a new ScaleType drawable with given underlying drawable , scale type , and focus point . \n + * \n + * @ param drawable underlying drawable to apply scale type on \n + * @ param scaleType scale type to be applied \n + * @ param focusPoint focus point of the image \n + * / \n + public ScaleTypeDrawable ( Drawable drawable , ScaleType scaleType , @ Nullable PointF focusPoint ) { \n + super ( Preconditions . checkNotNull ( drawable ) ) ; \n + mScaleType = scaleType ; \n + mFocusPoint = focusPoint ; \n + } \n + \n + * \n + @ Nullable \n",Add secondary constructor to ScaleTypeDrawable with focusPoint \n Reviewed By : oprisnik \n Differential Revision : D13194098 \n fbshipit - source - id : 3cc54a5d96c494e7e9bd5b580da80b9454f230f9,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImageOrigin . java \n + import static com . facebook . drawee . backends . pipeline . info . ImageOrigin . LOCAL ; \n + LOCAL , \n - int UNKNOWN = - 1 ; \n - int NETWORK = 0 ; \n - int DISK = 1 ; \n - int MEMORY _ ENCODED = 2 ; \n - int MEMORY _ BITMAP = 3 ; \n + int UNKNOWN = 1 ; \n + int NETWORK = 2 ; \n + int DISK = 3 ; \n + int MEMORY _ ENCODED = 4 ; \n + int MEMORY _ BITMAP = 5 ; \n + int LOCAL = 6 ; \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImageOriginUtils . java \n + import com . facebook . imagepipeline . producers . DataFetchProducer ; \n + import com . facebook . imagepipeline . producers . LocalAssetFetchProducer ; \n + import com . facebook . imagepipeline . producers . LocalContentUriFetchProducer ; \n + import com . facebook . imagepipeline . producers . LocalContentUriThumbnailFetchProducer ; \n + import com . facebook . imagepipeline . producers . LocalFileFetchProducer ; \n + import com . facebook . imagepipeline . producers . LocalResourceFetchProducer ; \n + case ImageOrigin . LOCAL : \n + return "" local "" ; \n + case ImageOrigin . UNKNOWN : \n + / / fall through \n + \n + \n + case DataFetchProducer . PRODUCER _ NAME : \n + case LocalFileFetchProducer . PRODUCER _ NAME : \n + case LocalResourceFetchProducer . PRODUCER _ NAME : \n + case LocalAssetFetchProducer . PRODUCER _ NAME : \n + case LocalContentUriFetchProducer . PRODUCER _ NAME : \n + case LocalContentUriThumbnailFetchProducer . PRODUCER _ NAME : \n + return ImageOrigin . LOCAL ; \n + \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n - private @ ImageOrigin int mImageOrigin = ImageOrigin . UNKNOWN ; \n + private @ ImageOrigin int mImageOrigin = UNSET ; \n",Fix imageOrigin being reported as ' unknown ' in some cases \n Reviewed By : oprisnik \n Differential Revision : D9772633 \n fbshipit - source - id : 68a66a13bffa13c58e5737e29e4509c287644f5e,47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImageOriginUtils . java \n - case LocalFileFetchProducer . PRODUCER _ NAME : \n - case LocalResourceFetchProducer . PRODUCER _ NAME : \n + case LocalFileFetchProducer . PRODUCER _ NAME : \n + case LocalResourceFetchProducer . PRODUCER _ NAME : \n,Sort producer names in origin mapping \n Reviewed By : oprisnik \n Differential Revision : D14706250 \n fbshipit - source - id : 65325bfb41248240df6c692cb8c3c6de3dd1e207,47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImageOriginUtils . java \n + import com . facebook . imagepipeline . producers . LocalVideoThumbnailProducer ; \n + import com . facebook . imagepipeline . producers . PartialDiskCacheProducer ; \n + import com . facebook . imagepipeline . producers . PostprocessedBitmapMemoryCacheProducer ; \n + import com . facebook . imagepipeline . producers . QualifiedResourceFetchProducer ; \n + case PostprocessedBitmapMemoryCacheProducer . PRODUCER _ NAME : \n + \n + \n + case PartialDiskCacheProducer . PRODUCER _ NAME : \n + \n + case LocalVideoThumbnailProducer . PRODUCER _ NAME : \n + case QualifiedResourceFetchProducer . PRODUCER _ NAME : \n,Add more producer names to origin mapping \n Reviewed By : oprisnik \n Differential Revision : D14706222 \n fbshipit - source - id : a11320aebabbe27d393c6814d9984022387f89d9,47
"samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ ShowcaseApplication . kt \n - val requestListeners = HashSet < RequestListener > ( ) \n - requestListeners . add ( forwardingRequestListener ) \n - requestListeners . add ( RequestLoggingListener ( ) ) \n + val requestListeners = HashSet < RequestListener > ( ) . apply { \n + add ( forwardingRequestListener ) \n + add ( RequestLoggingListener ( ) ) \n + } \n - val client = AndroidFlipperClient . getInstance ( this ) \n - client . addPlugin ( InspectorFlipperPlugin ( this , DescriptorMapping . withDefaults ( ) ) ) \n - client . addPlugin ( frescoFlipperPlugin ) \n - client . start ( ) \n + AndroidFlipperClient . getInstance ( context ) . apply { \n + addPlugin ( InspectorFlipperPlugin ( context , DescriptorMapping . withDefaults ( ) ) ) \n + addPlugin ( frescoFlipperPlugin ) \n + start ( ) \n + } \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ misc \ ImageUriProvider . kt \n - set ( uri ) = if ( uri = = null | | uri . isEmpty ( ) ) { \n + set ( uri ) = if ( uri . isNullOrEmpty ( ) ) { \n - val sampleGifUris = SAMPLE _ URIS _ GIFS . asSequence ( ) . map { Uri . parse ( it ) } . toList ( ) \n + val sampleGifUris = SAMPLE _ URIS _ GIFS . map ( Uri : : parse ) \n - val data = ArrayList < Uri > ( numImages ) \n - \n - for ( i in 0 until numImages ) { \n + val data = List < Uri > ( numImages ) { \n - data . add ( Uri . parse ( String . format ( uriFormat , imageId ) ) ) \n + Uri . parse ( String . format ( uriFormat , imageId ) ) \n",Clean up Kotlin in Showcase App \n Reviewed By : oprisnik \n Differential Revision : D15150054 \n fbshipit - source - id : 3c8a122ab58c9952dca26e740874f607a8aef31a,47
fbcore \ src \ main \ java \ com \ facebook \ common \ references \ CloseableReference . java \n - private static final LeakHandler < Closeable > DEFAULT _ LEAK _ HANDLER = \n - new LeakHandler < Closeable > ( ) { \n + private static final LeakHandler < Object > DEFAULT _ LEAK _ HANDLER = \n + new LeakHandler < Object > ( ) { \n - public void reportLeak ( SharedReference < Closeable > reference ) { \n + public void reportLeak ( SharedReference < Object > reference ) { \n,Fix LeakHandler unchecked cast \n Reviewed By : passy \n Differential Revision : D15592769 \n fbshipit - source - id : 64805e4f1b868030a9504e9ccdd0d2911501b287,47
"ui - common \ src \ main \ java \ com \ facebook \ fresco \ ui \ common \ DimensionsInfo . java \n - private int mViewportWidth ; \n - private int mViewportHeight ; \n + private final int mViewportWidth ; \n + private final int mViewportHeight ; \n - public DimensionsInfo ( int viewportWidth , int viewportHeight ) { \n + private final int mEncodedImageWidth ; \n + private final int mEncodedImageHeight ; \n + \n + private final int mDecodedImageWidth ; \n + private final int mDecodedImageHeight ; \n + \n + public DimensionsInfo ( \n + int viewportWidth , int viewportHeight , \n + int encodedImageWidth , int encodedImageHeight , \n + int decodedImageWidth , int decodedImageHeight ) { \n + mEncodedImageWidth = encodedImageWidth ; \n + mEncodedImageHeight = encodedImageHeight ; \n + mDecodedImageWidth = decodedImageWidth ; \n + mDecodedImageHeight = decodedImageHeight ; \n + public int getEncodedImageWidth ( ) { \n + return mEncodedImageWidth ; \n + } \n + \n + public int getEncodedImageHeight ( ) { \n + return mEncodedImageHeight ; \n + } \n + \n + public int getDecodedImageWidth ( ) { \n + return mDecodedImageWidth ; \n + } \n + \n + public int getDecodedImageHeight ( ) { \n + return mDecodedImageHeight ; \n + } \n + \n - return "" DimensionsInfo { "" \n - + "" mViewportWidth = "" \n - + mViewportWidth \n - + "" , mViewportHeight = "" \n - + mViewportHeight \n - + ' } ' ; \n + return "" DimensionsInfo { "" + \n + "" mViewportWidth = "" + mViewportWidth + \n + "" , mViewportHeight = "" + mViewportHeight + \n + "" , mEncodedImageWidth = "" + mEncodedImageWidth + \n + "" , mEncodedImageHeight = "" + mEncodedImageHeight + \n + "" , mDecodedImageWidth = "" + mDecodedImageWidth + \n + "" , mDecodedImageHeight = "" + mDecodedImageHeight + \n + ' } ' ; \n",Add encoded and decoded image dimensions \n Reviewed By : oprisnik \n Differential Revision : D18244312 \n fbshipit - source - id : ee618aa0ef1a638e81922c33e0e0da27eea62f67,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n - Producer < Void > producerSequence = mSuppressBitmapPrefetchingSupplier . get ( ) \n - ? mProducerSequenceFactory . getEncodedImagePrefetchProducerSequence ( imageRequest ) \n - : mProducerSequenceFactory . getDecodedImagePrefetchProducerSequence ( imageRequest ) ; \n + final Boolean shouldDecodePrefetches = imageRequest . shouldDecodePrefetches ( ) ; \n + final boolean skipBitmapCache = \n + shouldDecodePrefetches ! = null \n + ? ! shouldDecodePrefetches / / use imagerequest param if specified \n + : mSuppressBitmapPrefetchingSupplier \n + . get ( ) ; / / otherwise fall back to pipeline ' s default \n + Producer < Void > producerSequence = \n + skipBitmapCache \n + ? mProducerSequenceFactory . getEncodedImagePrefetchProducerSequence ( imageRequest ) \n + : mProducerSequenceFactory . getDecodedImagePrefetchProducerSequence ( imageRequest ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ ImageRequest . java \n + / * * \n + * Whether to decode prefetched images . \n + * true - > Cache both encoded image and bitmap . \n + * false - > Cache only encoded image and do not decode until image is needed to be shown . \n + * null - > Use pipeline ' s default \n + * / \n + private final @ Nullable Boolean mDecodePrefetches ; \n + \n + mDecodePrefetches = builder . shouldDecodePrefetches ( ) ; \n + public @ Nullable Boolean shouldDecodePrefetches ( ) { \n + return mDecodePrefetches ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ ImageRequestBuilder . java \n + private @ Nullable Boolean mDecodePrefetches = null ; \n - . setRotationOptions ( imageRequest . getRotationOptions ( ) ) ; \n + . setRotationOptions ( imageRequest . getRotationOptions ( ) ) \n + . setShouldDecodePrefetches ( imageRequest . shouldDecodePrefetches ( ) ) ; \n + public @ Nullable Boolean shouldDecodePrefetches ( ) { \n + return mDecodePrefetches ; \n + } \n + \n + public ImageRequestBuilder setShouldDecodePrefetches ( @ Nullable Boolean shouldDecodePrefetches ) { \n + mDecodePrefetches = shouldDecodePrefetches ; \n + return this ; \n + } \n + \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineTest . java \n + when ( mImageRequest . shouldDecodePrefetches ( ) ) \n + . thenReturn ( null ) ; \n,Add option to control prefetching to bitmap cache per request \n Summary : Add option to control prefetching to bitmap cache per request \n Reviewed By : oprisnik \n Differential Revision : D13654180 \n fbshipit - source - id : c0872aeed44cd6b4212505f9153c4e5daf7b9d12,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ResizeAndRotateProducer . java \n - mIsResizingEnabled = isResizingEnabled ; \n + \n + final Boolean resizingAllowedOverride = \n + mProducerContext . getImageRequest ( ) . getResizingAllowedOverride ( ) ; \n + mIsResizingEnabled = \n + resizingAllowedOverride ! = null \n + ? resizingAllowedOverride / / use request settings if available \n + : isResizingEnabled ; / / fallback to default option supplied \n + \n - \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ ImageRequest . java \n + / * * \n + * Controls whether resizing is allowed for this request . \n + * true - > allow for this request . \n + * false - > disallow for this request . \n + * null - > use default pipeline ' s setting . \n + * / \n + private final @ Nullable Boolean mResizingAllowedOverride ; \n + \n + \n + mResizingAllowedOverride = builder . getResizingAllowedOverride ( ) ; \n + public @ Nullable Boolean getResizingAllowedOverride ( ) { \n + return mResizingAllowedOverride ; \n + } \n + \n - postprocessorCacheKey ) ; \n + postprocessorCacheKey , \n + mResizingAllowedOverride ) ; \n + . add ( "" resizingAllowedOverride "" , mResizingAllowedOverride ) \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ ImageRequestBuilder . java \n + private @ Nullable Boolean mResizingAllowedOverride = null ; \n + public ImageRequestBuilder setResizingAllowedOverride ( @ Nullable Boolean resizingAllowedOverride ) { \n + mResizingAllowedOverride = resizingAllowedOverride ; \n + return this ; \n + } \n + \n + public @ Nullable Boolean getResizingAllowedOverride ( ) { \n + return mResizingAllowedOverride ; \n + } \n + \n",Add image request option to override default network images resizing \n Summary : Add image request option to override default network images resizing \n Reviewed By : oprisnik \n Differential Revision : D13731787 \n fbshipit - source - id : fc13a4a5f595c14c5c3c96f61c5cf0483e991bb6,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n - private @ Nullable ControllerListener < INFO > mControllerListener ; \n + protected @ Nullable ControllerListener < INFO > mControllerListener ; \n,Make controller listener protected in AbstractDraweeController \n Reviewed By : oprisnik \n Differential Revision : D13844937 \n fbshipit - source - id : 4630ca7f74af8e203c000982f0920e19e19d366f,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ DummyBitmapPool . java \n + import com . facebook . common . internal . Preconditions ; \n + Preconditions . checkNotNull ( value ) ; \n,Add Preconditions NPE check to pool release method \n Reviewed By : oprisnik \n Differential Revision : D14706933 \n fbshipit - source - id : 5ef5a1dbee73ce1ec11533efeb61845fa15a61a5,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapPoolType . java \n + String DUMMY _ WITH _ TRACKING = "" dummy _ with _ tracking "" ; \n new file \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ DummyTrackingInUseBitmapPool . java \n + / * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * / \n + package com . facebook . imagepipeline . memory ; \n + \n + import android . graphics . Bitmap ; \n + import com . facebook . common . internal . Preconditions ; \n + import com . facebook . common . internal . Sets ; \n + import com . facebook . common . memory . MemoryTrimType ; \n + import com . facebook . imageutils . BitmapUtil ; \n + import java . util . Set ; \n + \n + public class DummyTrackingInUseBitmapPool implements BitmapPool { \n + \n + / * * An Identity hash - set to keep track of values by reference equality * / \n + private final Set < Bitmap > mInUseValues ; \n + \n + public DummyTrackingInUseBitmapPool ( ) { \n + mInUseValues = Sets . newIdentityHashSet ( ) ; \n + } \n + \n + @ Override \n + public void trim ( MemoryTrimType trimType ) { \n + / / nop \n + } \n + \n + @ Override \n + public Bitmap get ( int size ) { \n + final Bitmap result = \n + Bitmap . createBitmap ( \n + 1 , \n + ( int ) Math . ceil ( size / ( double ) BitmapUtil . RGB _ 565 _ BYTES _ PER _ PIXEL ) , \n + Bitmap . Config . RGB _ 565 ) ; \n + mInUseValues . add ( result ) ; \n + return result ; \n + } \n + \n + @ Override \n + public void release ( Bitmap value ) { \n + Preconditions . checkNotNull ( value ) ; \n + mInUseValues . remove ( value ) ; \n + value . recycle ( ) ; \n + } \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n + case BitmapPoolType . DUMMY _ WITH _ TRACKING : \n + mBitmapPool = new DummyTrackingInUseBitmapPool ( ) ; \n + break ; \n",Add experimental dummy bitmap pool \n Reviewed By : oprisnik \n Differential Revision : D14105846 \n fbshipit - source - id : ae8707c55b777859b83a933360816d66b635b81b,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoExperiments . java \n + \n + public boolean useBindCallbacks ( ) { \n + return false ; \n + } \n,Add options to use bind / unbind callbacks as opposed to mount / unmount \n Reviewed By : oprisnik \n Differential Revision : D15122179 \n fbshipit - source - id : 28b734a0fb0899b4a28e9cdacb31658480149ca2,47
"vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n - ObjectsCompat . equals ( uri , frescoState . getUri ( ) ) \n + frescoState ! = null \n + & & ObjectsCompat . equals ( uri , frescoState . getUri ( ) ) \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoDrawable . java \n + private @ Nullable FrescoState mFrescoState ; \n + \n + \n + @ Nullable \n + public FrescoState getFrescoState ( ) { \n + return mFrescoState ; \n + } \n + \n + public void setFrescoState ( @ Nullable FrescoState frescoState ) { \n + mFrescoState = frescoState ; \n + } \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoExperiments . java \n + \n + public boolean useMountContentOverState ( ) { \n + return false ; \n + } \n","Avoid using @ State / @ FromPrepare for storing FrescoState , use MountContent instead \n Reviewed By : oprisnik \n Differential Revision : D15198270 \n fbshipit - source - id : 535c5ab183bcf7ab82b10272522b583e11948e89",47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private boolean mEncodedCacheEnabled ; \n + mEncodedCacheEnabled = builder . mEncodedCacheEnabled ; \n + } \n + \n + public boolean isEncodedCacheEnabled ( ) { \n + return mEncodedCacheEnabled ; \n + public boolean mEncodedCacheEnabled ; \n + public ImagePipelineConfig . Builder setEncodedCacheEnabled ( boolean encodedCacheEnabled ) { \n + mEncodedCacheEnabled = encodedCacheEnabled ; \n + return mConfigBuilder ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ EncodedMemoryCacheProducer . java \n - new EncodedMemoryCacheConsumer ( consumer , mMemoryCache , cacheKey , isMemoryCacheEnabled ) ; \n + new EncodedMemoryCacheConsumer ( \n + consumer , \n + mMemoryCache , \n + cacheKey , \n + isMemoryCacheEnabled , \n + producerContext . getImagePipelineConfig ( ) . getExperiments ( ) . isEncodedCacheEnabled ( ) ) ; \n + private final boolean mEncodedCacheEnabled ; \n - boolean isMemoryCacheEnabled ) { \n + boolean isMemoryCacheEnabled , \n + boolean encodedCacheEnabled ) { \n + mEncodedCacheEnabled = encodedCacheEnabled ; \n - if ( mIsMemoryCacheEnabled ) { \n + if ( mEncodedCacheEnabled & & mIsMemoryCacheEnabled ) { \n",add option to disable encoded cache \n Reviewed By : oprisnik \n Differential Revision : D18781306 \n fbshipit - source - id : 3b7f62d0e1a9a2cdee2b88fbdc21dff1efed297a,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + import com . facebook . common . internal . Suppliers ; \n - public Supplier < Boolean > mSuppressBitmapPrefetchingSupplier ; \n + public Supplier < Boolean > mSuppressBitmapPrefetchingSupplier = Suppliers . of ( false ) ; \n,Set default value of SuppressBitmapPrefetching \n Reviewed By : oprisnik \n Differential Revision : D16119686 \n fbshipit - source - id : b813264c1910bb937f6d1addf20c7372217347ab,47
"vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n - / / TODO ( T35949558 ) : Add support for external request listeners \n - RequestListener requestListener = \n - mFrescoContext \n - . getImagePipeline ( ) \n - . getRequestListenerForRequest ( imageRequest , frescoState . getImageOriginListener ( ) ) ; \n - frescoState . setRequestListener ( requestListener ) ; \n - \n + setupRequestListener ( frescoState , imageRequest ) ; \n - requestListener , \n + frescoState . getRequestListener ( ) , \n + setupRequestListener ( frescoState , frescoState . getImageRequest ( ) ) ; \n + \n + private void setupRequestListener ( FrescoState frescoState , ImageRequest imageRequest ) { \n + / / TODO ( T35949558 ) : Add support for external request listeners \n + if ( imageRequest = = null ) { \n + return ; \n + } \n + final RequestListener requestListener = \n + mFrescoContext \n + . getImagePipeline ( ) \n + . getRequestListenerForRequest ( imageRequest , frescoState . getImageOriginListener ( ) ) ; \n + frescoState . setRequestListener ( requestListener ) ; \n + } \n",Set up image origin listener when not using prepare _ pipeline _ components \n Reviewed By : oprisnik \n Differential Revision : D14949698 \n fbshipit - source - id : 77bd81a92bab072165dd3417795792191d8989ff,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ OrientedDrawable . java \n - import com . facebook . common . internal . Preconditions ; \n - * @ param rotationAngle multiples of 90 or - 1 if the angle is unknown \n - * @ param exifOrientation EXIF values ( 1 - 8 ) , or 0 if unknown \n + * @ param rotationAngle multiples of 90 . Invalid value is clamped to a closest multiple of 90 . \n + * @ param exifOrientation EXIF values ( 1 - 8 ) , or 0 if unknown . Invalid value is replaced with 0 . \n - Preconditions . checkArgument ( rotationAngle % 90 = = 0 ) ; \n - Preconditions . checkArgument ( exifOrientation > = 0 & & exifOrientation < = 8 ) ; \n - mRotationAngle = rotationAngle ; \n - mExifOrientation = exifOrientation ; \n + mRotationAngle = rotationAngle - rotationAngle % 90 ; \n + mExifOrientation = \n + exifOrientation > = 0 & & exifOrientation < = 8 \n + ? exifOrientation \n + : ExifInterface . ORIENTATION _ UNDEFINED ; \n drawee \ src \ test \ java \ com \ facebook \ drawee \ drawable \ OrientedDrawableTest . java \n - @ Test \n - public void testCreation _ invalidAngle ( ) { \n - try { \n - new OrientedDrawable ( mDrawable , 20 , ExifInterface . ORIENTATION _ NORMAL ) ; \n - fail ( ) ; \n - } catch ( IllegalArgumentException e ) { \n - / / Do nothing , expected . \n - } \n - } \n - \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BasePool . java \n - \n",Ignore invalid orientation and rotation values in Exif \n Reviewed By : oprisnik \n Differential Revision : D15079407 \n fbshipit - source - id : f0eace33ac452fc491b66d90f60f36c14bb4860d,47
samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ drawee \ DraweeRotationFragment . java \n - . setImageDecodeOptions ( new ImageDecodeOptionsBuilder ( ) . setTransformToSRGB ( true ) . build ( ) ) \n + . setImageDecodeOptions ( new ImageDecodeOptionsBuilder ( ) . build ( ) ) \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ imagepipeline \ ImagePipelineResizingFragment . java \n - . setImageDecodeOptions ( new ImageDecodeOptionsBuilder ( ) . setTransformToSRGB ( true ) . build ( ) ) \n + . setImageDecodeOptions ( new ImageDecodeOptionsBuilder ( ) . build ( ) ) \n,Fix showcase build after ` Add explicit color management ' \n Reviewed By : oprisnik \n Differential Revision : D15113791 \n fbshipit - source - id : 414991b89767177c9d1a78bd24de7a000cabbc64,47
"animated - base \ src \ test \ java \ com \ facebook \ imagepipeline \ animated \ impl \ AnimatedDrawableBackendImplTest . java \n + @ Mock public Rect mRect ; \n - mAnimatedDrawableUtil , mAnimatedImageResult , new Rect ( ) , true ) ; \n + mAnimatedDrawableUtil , mAnimatedImageResult , mRect , true ) ; \n",Fix AnimatedDrawableBackendImplTest for gradle \n Reviewed By : oprisnik \n Differential Revision : D13959491 \n fbshipit - source - id : fda084ccc4f3d109d32032036448501af40c9ecd,47
"fbcore \ src \ main \ java \ com \ facebook \ common \ references \ CloseableReference . java \n - if ( t = = null ) { \n - return null ; \n - } else { \n - return new CloseableReference < T > ( t , ( ResourceReleaser < T > ) DEFAULT _ CLOSEABLE _ RELEASER ) ; \n - } \n + return of ( t , ( ResourceReleaser < T > ) DEFAULT _ CLOSEABLE _ RELEASER ) ; \n",Minor : reuse CloseableReference . of \n Reviewed By : oprisnik \n Differential Revision : D15432997 \n fbshipit - source - id : abeedcaa5bd47797665f9c4604dd09b91100564a,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n - frescoState . setAttached ( true ) ; \n + final FrescoExperiments experiments = mFrescoContext . getExperiments ( ) ; \n + if ( experiments . closeDatasource ( ) ) { \n + DeferredReleaser . getInstance ( ) . cancelDeferredRelease ( frescoState ) ; \n + } \n + frescoState . setAttached ( true ) ; \n - final FrescoExperiments experiments = mFrescoContext . getExperiments ( ) ; \n - \n - if ( experiments . closeDatasource ( ) ) { \n - DeferredReleaser . getInstance ( ) . cancelDeferredRelease ( frescoState ) ; \n - } \n - \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoExperiments . java \n + \n + public boolean resetState ( ) { \n + return false ; \n + } \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoState . java \n + \n + \n + if ( mFrescoContext . getExperiments ( ) . resetState ( ) ) { \n + mPrefetchDatasource = null ; \n + mMainFetchDatasource = null ; \n + mActualImageWrapper = null ; \n + } \n + \n,State reset : set datasources to null \n Reviewed By : oprisnik \n Differential Revision : D15055826 \n fbshipit - source - id : 3bb4242774bf87472f432b2941efc60d846ff5ed,47
"samples \ showcase \ build . gradle \n + \n + debugImplementation ( ' com . facebook . flipper : flipper : 0 . 17 . 0 ' ) { \n + exclude group : ' com . facebook . fresco ' \n + } \n + debugImplementation project ( ' : tools : flipper ' ) \n samples \ showcase \ src \ main \ AndroidManifest . xml \n + < uses - permission android : name = "" android . permission . ACCESS _ WIFI _ STATE "" / > \n + \n + < activity android : name = "" com . facebook . flipper . android . diagnostics . FlipperDiagnosticActivity "" \n + android : exported = "" true "" / > \n + \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ ShowcaseApplication . java \n + import com . facebook . flipper . android . AndroidFlipperClient ; \n + import com . facebook . flipper . android . utils . FlipperUtils ; \n + import com . facebook . flipper . core . FlipperClient ; \n + import com . facebook . flipper . plugins . fresco . FrescoFlipperPlugin ; \n + import com . facebook . flipper . plugins . inspector . DescriptorMapping ; \n + import com . facebook . flipper . plugins . inspector . InspectorFlipperPlugin ; \n + \n + if ( BuildConfig . DEBUG & & FlipperUtils . shouldEnableFlipper ( this ) ) { \n + final FlipperClient client = AndroidFlipperClient . getInstance ( this ) ; \n + client . addPlugin ( new InspectorFlipperPlugin ( this , DescriptorMapping . withDefaults ( ) ) ) ; \n + client . addPlugin ( new FrescoFlipperPlugin ( ) ) ; \n + client . start ( ) ; \n + } \n",Add flipper to showcase app \n Reviewed By : oprisnik \n Differential Revision : D14324168 \n fbshipit - source - id : 5e1aaf2506ebbeeae1b3ea50751368e38d26fbd1,47
gradle . properties \n - SAMPLES _ MIN _ SDK _ VERSION = 14 \n + SAMPLES _ MIN _ SDK _ VERSION = 15 \n samples \ showcase \ build . gradle \n - debugImplementation ( ' com . facebook . flipper : flipper : 0 . 17 . 0 ' ) { \n + implementation ( ' com . facebook . flipper : flipper : 0 . 17 . 0 ' ) { \n - debugImplementation project ( ' : tools : flipper ' ) \n + implementation project ( ' : tools : flipper ' ) \n,Fix flipper setup for Showcase sample app \n Reviewed By : oprisnik \n Differential Revision : D14343130 \n fbshipit - source - id : 5bd84f272a7b3b82f04964955e29b6d57eac6380,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n + final boolean shouldClose = mFrescoContext . getExperiments ( ) . closeDatasourceOnNewResult ( ) & & dataSource . isFinished ( ) ; \n + if ( shouldClose ) { \n + dataSource . close ( ) ; \n + } \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoExperiments . java \n + \n + public boolean closeDatasourceOnNewResult ( ) { \n + return true ; \n + } \n,Experiment : Close datasource in onNewResult \n Reviewed By : oprisnik \n Differential Revision : D15841053 \n fbshipit - source - id : 8124bea21f58aa70333e0b560185873948ad953c,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private final int mBitmapCloseableRefType ; \n + mBitmapCloseableRefType = builder . mBitmapCloseableRefType ; \n + public int getBitmapCloseableRefType ( ) { \n + return mBitmapCloseableRefType ; \n + } \n + \n + public int mBitmapCloseableRefType ; \n + public ImagePipelineConfig . Builder setBitmapCloseableRefType ( int bitmapCloseableRefType ) { \n + mBitmapCloseableRefType = bitmapCloseableRefType ; \n + return mConfigBuilder ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n + import com . facebook . common . references . CloseableReference ; \n + CloseableReference . setDisableCloseableReferencesForBitmaps ( config . getExperiments ( ) . getBitmapCloseableRefType ( ) ) ; \n,Add closeable reference param to MC . android _ image _ pipeline \n Reviewed By : oprisnik \n Differential Revision : D15844979 \n fbshipit - source - id : fc90f25c9d20d1bc3bf8d75ce200f89489262d7b,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private final Supplier < Boolean > mSuppressBitmapPrefetchingSupplier ; \n + mSuppressBitmapPrefetchingSupplier = builder . mSuppressBitmapPrefetchingSupplier ; \n + public Supplier < Boolean > getSuppressBitmapPrefetchingSupplier ( ) { \n + return mSuppressBitmapPrefetchingSupplier ; \n + } \n + \n + public Supplier < Boolean > mSuppressBitmapPrefetchingSupplier ; \n + public ImagePipelineConfig . Builder setSuppressBitmapPrefetchingSupplier ( Supplier < Boolean > suppressBitmapPrefetchingSupplier ) { \n + mSuppressBitmapPrefetchingSupplier = suppressBitmapPrefetchingSupplier ; \n + return mConfigBuilder ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n - Suppliers . of ( false ) , \n + mConfig . getExperiments ( ) . getSuppressBitmapPrefetchingSupplier ( ) , \n",Add suppress bitmap prefetching param \n Reviewed By : oprisnik \n Differential Revision : D15846301 \n fbshipit - source - id : a6b4838b624e17a1a099de119e72634c0e6e3bec,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ callercontext \ CallerContextVerifier . java \n - void verifyCallerContext ( @ Nullable Object callerContext ) ; \n + void verifyCallerContext ( @ Nullable Object callerContext , boolean isPrefetch ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n - mCallerContextVerifier . verifyCallerContext ( callerContext ) ; \n + mCallerContextVerifier . verifyCallerContext ( callerContext , false ) ; \n - mCallerContextVerifier . verifyCallerContext ( callerContext ) ; \n + mCallerContextVerifier . verifyCallerContext ( callerContext , true ) ; \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoContext . java \n - mCallerContextVerifier . verifyCallerContext ( callerContext ) ; \n + mCallerContextVerifier . verifyCallerContext ( callerContext , false ) ; \n vito \ provider \ src \ main \ java \ com \ facebook \ fresco \ vito \ provider \ DefaultFrescoContext . java \n - public void verifyCallerContext ( @ Nullable Object callerContext ) { \n + public void verifyCallerContext ( @ Nullable Object callerContext , boolean isPrefetch ) { \n",Add isPrefetch to CallerContext # verifyCallerContext \n Reviewed By : oprisnik \n Differential Revision : D16007865 \n fbshipit - source - id : e4d790326f9ad395ffff4573e1fdca8c53525245,47
"animated - gif \ src \ main \ jni \ Application . mk \n - APP _ STL : = gnustl _ static \n + APP _ STL : = c + + _ static \n - FRESCO _ CPP _ LDFLAGS : = - Wl , - - gc - sections , - - exclude - libs , libgnustl _ static . a \n + FRESCO _ CPP _ LDFLAGS : = - Wl , - - gc - sections , - - exclude - libs , libc + + _ static . a \n imagepipeline \ src \ main \ jni \ Application . mk \n - APP _ STL : = gnustl _ static \n + APP _ STL : = c + + _ static \n native - filters \ src \ main \ jni \ Application . mk \n - APP _ STL : = gnustl _ static \n + APP _ STL : = c + + _ static \n native - imagetranscoder \ src \ main \ jni \ Application . mk \n - APP _ STL : = gnustl _ static \n + APP _ STL : = c + + _ static \n static - webp \ src \ main \ jni \ Application . mk \n - APP _ STL : = gnustl _ static \n + APP _ STL : = c + + _ static \n - FRESCO _ CPP _ LDFLAGS : = - Wl , - - gc - sections , - - exclude - libs , libgnustl _ static . a \n + FRESCO _ CPP _ LDFLAGS : = - Wl , - - gc - sections , - - exclude - libs , libc + + _ static . a \n",Replace gnustl _ static with c + + _ static \n Summary : \n To make Fresco compile with ndk android - 16 this change has to be made : \n ` APP _ STL gnustl _ static is no longer supported . Please switch to either c + + _ static or c + + _ shared . ` \n Reviewed By : lambdapioneer \n Differential Revision : D13986247 \n fbshipit - source - id : 9d92dd9adfc7d680e8ebbe1b4f59fb67ddfcfffe,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n - \n + \n + return prefetchToBitmapCache ( imageRequest , callerContext , Priority . MEDIUM ) ; \n + } \n + \n + / * * Experimental prefetch method . Do not use as it can be removed in the future * / \n + @ Deprecated \n + public DataSource < Void > prefetchToBitmapCacheWithHighPriority ( \n + ImageRequest imageRequest , \n + Object callerContext ) { \n + return prefetchToBitmapCache ( imageRequest , callerContext , Priority . HIGH ) ; \n + } \n + \n + private DataSource < Void > prefetchToBitmapCache ( \n + ImageRequest imageRequest , \n + Object callerContext , \n + Priority priority ) { \n - Priority . MEDIUM ) ; \n + priority ) ; \n",Add experimental prefetch method \n Reviewed By : oprisnik \n Differential Revision : D16357234 \n fbshipit - source - id : 49dcc515ab7606eb319cde9c2a7442f613bf3b2f,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ResizeAndRotateProducer . java \n - encodedImage . close ( ) ; \n,Fix NPE when RotationOptions . disableRotation ( ) \n Summary : \n ResizeAndRotateProducer closes the encoded image when using RotationOptions . disableRotation ( ) \n This causes crash when using the same image with different configuration e . g . https : / / github . com / facebook / fresco / issues / 2371 . EncodedMemoryCacheProducer closes the encoded image anyway . \n Reviewed By : oprisnik \n Differential Revision : D16378116 \n fbshipit - source - id : e97b4d792724abffad1d5f4fa1b426c69e88882f,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n - if ( isLast & & ! EncodedImage . isValid ( newResult ) ) { \n - handleError ( new ExceptionWithNoStacktrace ( "" Encoded image is not valid . "" ) ) ; \n - return ; \n + if ( isLast ) { \n + if ( newResult = = null ) { \n + handleError ( new ExceptionWithNoStacktrace ( "" Encoded image is null . "" ) ) ; \n + return ; \n + } else if ( ! newResult . isValid ( ) ) { \n + handleError ( new ExceptionWithNoStacktrace ( "" Encoded image is not valid . "" ) ) ; \n + return ; \n + } \n","Throw "" Encoded image is null "" instead of "" Encoded image is not valid "" when image is not provided \n Reviewed By : oprisnik \n Differential Revision : D16458580 \n fbshipit - source - id : 05a255976f7f6f194eeb50640bc7a760255dc861",47
drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ FadeDrawable . java \n + / * * \n + * Makes the specified layer fully opaque \n + * \n + * @ param index the index of the layer to be shown \n + * / \n + public void showLayerImmediately ( int index ) { \n + mIsLayerOn [ index ] = true ; \n + mAlphas [ index ] = 255 ; \n + invalidateSelf ( ) ; \n + } \n + \n + / * * \n + * Makes the specified layer fully transparent \n + * \n + * @ param index the index of the layer to be hidden \n + * / \n + public void hideLayerImmediately ( int index ) { \n + mIsLayerOn [ index ] = false ; \n + mAlphas [ index ] = 0 ; \n + invalidateSelf ( ) ; \n + } \n + \n + public boolean isDefaultLayerIsOn ( ) { \n + return mDefaultLayerIsOn ; \n + } \n,Add convinience methods to FadeDrawable \n Reviewed By : oprisnik \n Differential Revision : D14745441 \n fbshipit - source - id : e15c93141d2806ba25d8a57a71482b7595f12ae2,47
"new file \n tools \ flipper \ src \ main \ java \ com \ facebook \ imagepipeline \ debug \ FlipperCacheKeyFactory . java \n + / * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * / \n + package com . facebook . imagepipeline . debug ; \n + \n + import com . facebook . cache . common . CacheKey ; \n + import com . facebook . imagepipeline . cache . DefaultCacheKeyFactory ; \n + import com . facebook . imagepipeline . request . ImageRequest ; \n + import javax . annotation . Nullable ; \n + \n + public class FlipperCacheKeyFactory extends DefaultCacheKeyFactory { \n + \n + private final @ Nullable DebugImageTracker mDebugImageTracker ; \n + \n + public FlipperCacheKeyFactory ( @ Nullable DebugImageTracker debugImageTracker ) { \n + mDebugImageTracker = debugImageTracker ; \n + } \n + \n + @ Override \n + public CacheKey getBitmapCacheKey ( ImageRequest request , Object callerContext ) { \n + CacheKey bitmapCacheKey = super . getBitmapCacheKey ( request , callerContext ) ; \n + if ( mDebugImageTracker ! = null ) { \n + mDebugImageTracker . trackImage ( request , bitmapCacheKey ) ; \n + } \n + return bitmapCacheKey ; \n + } \n + } \n",Add Flipper debug cache key factory \n Reviewed By : oprisnik \n Differential Revision : D14598273 \n fbshipit - source - id : a34c6e0df9b725d9b4887124fb7542eb56e9cec8,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ DraweeConfig . java \n + import com . facebook . drawee . backends . pipeline . info . ImagePerfDataListener ; \n + @ Nullable private final ImagePerfDataListener mImagePerfDataListener ; \n + mImagePerfDataListener = builder . mImagePerfDataListener ; \n + @ Nullable \n + public ImagePerfDataListener getImagePerfDataListener ( ) { \n + return mImagePerfDataListener ; \n + } \n + \n + private @ Nullable ImagePerfDataListener mImagePerfDataListener ; \n + public Builder setImagePerfDataListener ( @ Nullable ImagePerfDataListener imagePerfDataListener ) { \n + mImagePerfDataListener = imagePerfDataListener ; \n + return this ; \n + } \n + \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ PipelineDraweeControllerBuilderSupplier . java \n + import com . facebook . drawee . backends . pipeline . info . ImagePerfDataListener ; \n + private final @ Nullable ImagePerfDataListener mDefaultImagePerfDataListener ; \n + \n + mDefaultImagePerfDataListener = \n + draweeConfig ! = null ? draweeConfig . getImagePerfDataListener ( ) : null ; \n - return new PipelineDraweeControllerBuilder ( \n - mContext , \n - mPipelineDraweeControllerFactory , \n - mImagePipeline , \n - mBoundControllerListeners ) ; \n + PipelineDraweeControllerBuilder pipelineDraweeControllerBuilder = \n + new PipelineDraweeControllerBuilder ( \n + mContext , mPipelineDraweeControllerFactory , mImagePipeline , mBoundControllerListeners ) ; \n + return pipelineDraweeControllerBuilder . setPerfDataListener ( mDefaultImagePerfDataListener ) ; \n",Add default ImagePerfDataListener to DraweeConfig \n Reviewed By : oprisnik \n Differential Revision : D14598274 \n fbshipit - source - id : f1816d1df28064ee9edbca76d3a4783f6eee0007,47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n - mControllerSubmitTimeMs = UNSET ; \n - mControllerFinalImageSetTimeMs = UNSET ; \n - mControllerFailureTimeMs = UNSET ; \n - mControllerCancelTimeMs = UNSET ; \n - \n - mImageRequestStartTimeMs = UNSET ; \n - mImageRequestEndTimeMs = UNSET ; \n - \n - mVisibilityEventTimeMs = UNSET ; \n - mInvisibilityEventTimeMs = UNSET ; \n + \n + resetPointsTimestamps ( ) ; \n + } \n + \n + / * * \n + * Useful when reusing the same { @ link ImagePerfState } when component is being remounted \n + * / \n + public void resetPointsTimestamps ( ) { \n + mImageRequestStartTimeMs = UNSET ; \n + mImageRequestEndTimeMs = UNSET ; \n + \n + mControllerSubmitTimeMs = UNSET ; \n + mControllerFinalImageSetTimeMs = UNSET ; \n + mControllerFailureTimeMs = UNSET ; \n + mControllerCancelTimeMs = UNSET ; \n + \n + mVisibilityEventTimeMs = UNSET ; \n + mInvisibilityEventTimeMs = UNSET ; \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListener . java \n + mImagePerfState . resetPointsTimestamps ( ) ; \n + \n,Reset imagePerfState when view comes on - screen \n Reviewed By : oprisnik \n Differential Revision : D17737444 \n fbshipit - source - id : 55109f7fb7d6f5374e4d1a631131f8990b2c4332,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private boolean mEncodedCacheEnabled ; \n + mEncodedCacheEnabled = builder . mEncodedCacheEnabled ; \n + } \n + \n + public boolean isEncodedCacheEnabled ( ) { \n + return mEncodedCacheEnabled ; \n + public boolean mEncodedCacheEnabled ; \n + public ImagePipelineConfig . Builder setEncodedCacheEnabled ( boolean encodedCacheEnabled ) { \n + mEncodedCacheEnabled = encodedCacheEnabled ; \n + return mConfigBuilder ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ EncodedMemoryCacheProducer . java \n - new EncodedMemoryCacheConsumer ( consumer , mMemoryCache , cacheKey , isMemoryCacheEnabled ) ; \n + new EncodedMemoryCacheConsumer ( \n + consumer , \n + mMemoryCache , \n + cacheKey , \n + isMemoryCacheEnabled , \n + producerContext . getImagePipelineConfig ( ) . getExperiments ( ) . isEncodedCacheEnabled ( ) ) ; \n + private final boolean mEncodedCacheEnabled ; \n - boolean isMemoryCacheEnabled ) { \n + boolean isMemoryCacheEnabled , \n + boolean encodedCacheEnabled ) { \n + mEncodedCacheEnabled = encodedCacheEnabled ; \n - if ( mIsMemoryCacheEnabled ) { \n + if ( mEncodedCacheEnabled & & mIsMemoryCacheEnabled ) { \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ producers \ EncodedMemoryCacheProducerTest . java \n + import com . facebook . imagepipeline . core . ImagePipelineConfig ; \n + import com . facebook . imagepipeline . core . ImagePipelineExperiments ; \n + private ImagePipelineConfig mImagePipelineConfig ; \n + private ImagePipelineExperiments mImagePipelineExperiments ; \n + mImagePipelineConfig = mock ( ImagePipelineConfig . class ) ; \n + mImagePipelineExperiments = mock ( ImagePipelineExperiments . class ) ; \n + when ( mProducerContext . getImagePipelineConfig ( ) ) . thenReturn ( mImagePipelineConfig ) ; \n + when ( mImagePipelineConfig . getExperiments ( ) ) . thenReturn ( mImagePipelineExperiments ) ; \n + when ( mImagePipelineExperiments . isEncodedCacheEnabled ( ) ) . thenReturn ( true ) ; \n",add option to disable encoded cache \n Reviewed By : oprisnik \n Differential Revision : D18811988 \n fbshipit - source - id : 0c8038a3593cea1f0766a9009e056f351911515d,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoExperiments . java \n + \n + public boolean fadeInImages ( ) { \n + return false ; \n + } \n,Set up fading experiment \n Reviewed By : oprisnik \n Differential Revision : D14746244 \n fbshipit - source - id : 54d1e1854a02d5b4db4a30f9ce58fbdcec6c6989,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ multiuri \ MultiUri . java \n - public Builder setMultiImageRequests ( @ Nullable ImageRequest . . . multiImageRequests ) { \n + public Builder setImageRequests ( @ Nullable ImageRequest . . . multiImageRequests ) { \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ vito \ FrescoVitoLithoSimpleFragment . java \n - . setMultiImageRequests ( \n + . setImageRequests ( \n,Rename MultiUri # setMultiImageRequests to setImageRequests \n Reviewed By : oprisnik \n Differential Revision : D17810542 \n fbshipit - source - id : fcabb5f346ee1ca9a15823f4393dad66c0d9ad44,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n - frescoState . getFrescoDrawable ( ) . setImageDrawable ( placeholderDrawable ) ; \n + frescoState . getFrescoDrawable ( ) . setPlaceholderDrawable ( placeholderDrawable ) ; \n,Fading : Fix placeholder set call \n Reviewed By : oprisnik \n Differential Revision : D17828982 \n fbshipit - source - id : 548eefd8176fd147aed092689e1286a27daf874f,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private boolean mKeepCancelledFetchAsLowPriority ; \n + mKeepCancelledFetchAsLowPriority = builder . mKeepCancelledFetchAsLowPriority ; \n + public boolean shouldKeepCancelledFetchAsLowPriority ( ) { \n + return mKeepCancelledFetchAsLowPriority ; \n + } \n + \n + private boolean mKeepCancelledFetchAsLowPriority ; \n + public ImagePipelineConfig . Builder setKeepCancelledFetchAsLowPriority ( boolean keepCancelledFetchAsLowPriority ) { \n + mKeepCancelledFetchAsLowPriority = keepCancelledFetchAsLowPriority ; \n + return mConfigBuilder ; \n + } \n + \n - CloseableReferenceFactory closeableReferenceFactory ) ; \n + CloseableReferenceFactory closeableReferenceFactory , \n + boolean keepCancelledFetchAsLowPriority ) ; \n - CloseableReferenceFactory closeableReferenceFactory ) { \n + CloseableReferenceFactory closeableReferenceFactory , \n + boolean keepCancelledFetchAsLowPriority ) { \n - closeableReferenceFactory ) ; \n + closeableReferenceFactory , \n + keepCancelledFetchAsLowPriority ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n - getCloseableReferenceFactory ( ) ) ; \n + getCloseableReferenceFactory ( ) , \n + mConfig . getExperiments ( ) . shouldKeepCancelledFetchAsLowPriority ( ) ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n + private final boolean mKeepCancelledFetchAsLowPriority ; \n + \n - CloseableReferenceFactory closeableReferenceFactory ) { \n + CloseableReferenceFactory closeableReferenceFactory , \n + boolean keepCancelledFetchAsLowPriority ) { \n + \n + mKeepCancelledFetchAsLowPriority = keepCancelledFetchAsLowPriority ; \n - return new EncodedCacheKeyMultiplexProducer ( mCacheKeyFactory , inputProducer ) ; \n + return new EncodedCacheKeyMultiplexProducer ( mCacheKeyFactory , mKeepCancelledFetchAsLowPriority , inputProducer ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ EncodedCacheKeyMultiplexProducer . java \n - public EncodedCacheKeyMultiplexProducer ( CacheKeyFactory cacheKeyFactory , Producer inputProducer ) { \n - super ( inputProducer ) ; \n + public EncodedCacheKeyMultiplexProducer ( \n + CacheKeyFactory cacheKeyFactory , boolean keepCancelledFetchAsLowPriority , Producer inputProducer ) { \n + super ( inputProducer , keepCancelledFetchAsLowPriority ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ MultiplexProducer . java \n + private final boolean mKeepCancelledFetchAsLowPriority ; \n + \n + mKeepCancelledFetchAsLowPriority = false ; \n + } \n + \n + protected MultiplexProducer ( Producer < T > inputProducer , boolean keepCancelledFetchAsLowPriority ) { \n + mInputProducer = inputProducer ; \n + mMultiplexers = new HashMap < > ( ) ; \n + mKeepCancelledFetchAsLowPriority = keepCancelledFetchAsLowPriority ; \n - contextToCancel . cancel ( ) ; \n + if ( mKeepCancelledFetchAsLowPriority & & ! contextToCancel . isPrefetch ( ) ) { \n + List < ProducerContextCallbacks > callbacks = \n + contextToCancel . setPriorityNoCallbacks ( Priority . LOW ) ; \n + BaseProducerContext . callOnPriorityChanged ( callbacks ) ; \n + } else { \n + contextToCancel . cancel ( ) ; \n + } \n",Set priority of fetch requests to Low instead of cancelling them \n Reviewed By : oprisnik \n Differential Revision : D17467801 \n fbshipit - source - id : a8b640e5e2d436403447ce6f28dca79c77a1b861,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BasePool . java \n + private boolean mIgnoreHardCap ; \n + \n + public BasePool ( \n + MemoryTrimmableRegistry memoryTrimmableRegistry , \n + PoolParams poolParams , PoolStatsTracker poolStatsTracker , boolean ignoreHardCap ) { \n + this ( memoryTrimmableRegistry , poolParams , poolStatsTracker ) ; \n + mIgnoreHardCap = ignoreHardCap ; \n + } \n + \n + if ( mIgnoreHardCap ) { \n + return true ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BucketsBitmapPool . java \n - PoolStatsTracker poolStatsTracker ) { \n - super ( memoryTrimmableRegistry , poolParams , poolStatsTracker ) ; \n + PoolStatsTracker poolStatsTracker , \n + boolean ignoreHardCap ) { \n + super ( memoryTrimmableRegistry , poolParams , poolStatsTracker , ignoreHardCap ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolConfig . java \n + private final boolean mIgnoreBitmapPoolHardCap ; \n + mIgnoreBitmapPoolHardCap = builder . mIgnoreBitmapPoolHardCap ; \n + public boolean isIgnoreBitmapPoolHardCap ( ) { \n + return mIgnoreBitmapPoolHardCap ; \n + } \n + \n + public boolean mIgnoreBitmapPoolHardCap ; \n - public void setRegisterLruBitmapPoolAsMemoryTrimmable ( \n + public Builder setRegisterLruBitmapPoolAsMemoryTrimmable ( \n + return this ; \n + } \n + \n + public Builder setIgnoreBitmapPoolHardCap ( boolean ignoreBitmapPoolHardCap ) { \n + mIgnoreBitmapPoolHardCap = ignoreBitmapPoolHardCap ; \n + return this ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ PoolFactory . java \n - mConfig . getBitmapPoolStatsTracker ( ) ) ; \n + mConfig . getBitmapPoolStatsTracker ( ) , \n + mConfig . isIgnoreBitmapPoolHardCap ( ) ) ; \n - mConfig . getBitmapPoolStatsTracker ( ) ) ; \n + mConfig . getBitmapPoolStatsTracker ( ) , \n + mConfig . isIgnoreBitmapPoolHardCap ( ) ) ; \n",Add option to ignore bitmap pool hardcap \n Reviewed By : oprisnik \n Differential Revision : D18882638 \n fbshipit - source - id : 0d8173245985af141c15bf07819c93d0ad0a000c,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ InstrumentedDrawable . java \n - / / ( c ) Facebook , Inc . and its affiliates . Confidential and proprietary . \n + / * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * / \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ vito \ FrescoVitoLithoRegionDecodeFragment . java \n - * This file provided by Facebook is for non - commercial testing and evaluation \n - * purposes only . Facebook reserves all rights not expressly granted . \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n - * THE SOFTWARE IS PROVIDED "" AS IS "" , WITHOUT WARRANTY OF ANY KIND , EXPRESS OR \n - * IMPLIED , INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY , \n - * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT . IN NO EVENT SHALL \n - * FACEBOOK BE LIABLE FOR ANY CLAIM , DAMAGES OR OTHER LIABILITY , WHETHER IN AN \n - * ACTION OF CONTRACT , TORT OR OTHERWISE , ARISING FROM , OUT OF OR IN \n - * CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE . \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n",Update some license headers \n Reviewed By : oprisnik \n Differential Revision : D18897971 \n fbshipit - source - id : 98037d2d266ab81081765e8da2e9866307fbbf94,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ multiuri \ MultiUri . java \n + / * * \n + * Convenience method for creating a low res preview + main request datasource supplier \n + * / \n + public static Supplier < DataSource < CloseableReference < CloseableImage > > > getMultiUriDatasource ( \n + final ImagePipeline imagePipeline , \n + final ImageRequest lowResImageRequest , \n + final ImageRequest mainImageRequest , \n + Object callerContext ) { \n + MultiUri multiUri = MultiUri . create ( ) \n + . setLowResImageRequest ( lowResImageRequest ) \n + . setImageRequests ( mainImageRequest ) \n + . build ( ) ; \n + return getMultiUriDatasourceSupplier ( imagePipeline , multiUri , null , callerContext , null , null ) ; \n + } \n + \n",Add MultiUri helper method \n Reviewed By : oprisnik \n Differential Revision : D17861140 \n fbshipit - source - id : 3468d95ac63af8a6057029daff16fab9cc18e8ef,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ multiuri \ MultiUri . java \n - final ImageRequest imageRequest , \n + final @ Nullable ImageRequest imageRequest , \n - final RequestListener requestListener , \n - final String id ) { \n + final @ Nullable RequestListener requestListener , \n + final @ Nullable String id ) { \n - final RequestListener requestListener , \n + final @ Nullable RequestListener requestListener , \n",Add some @ Nullable ' s to MultiUri \n Reviewed By : oprisnik \n Differential Revision : D17861138 \n fbshipit - source - id : 76581079e5d12a056e7041d8311901dc7046f0c9,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + private boolean mDownsampleIfLargeBitmap ; \n + mDownsampleIfLargeBitmap = builder . mDownsampleIfLargeBitmap ; \n + } \n + \n + public boolean shouldDownsampleIfLargeBitmap ( ) { \n + return mDownsampleIfLargeBitmap ; \n + public boolean mDownsampleIfLargeBitmap ; \n + public ImagePipelineConfig . Builder setDownsampleIfLargeBitmap ( boolean downsampleIfLargeBitmap ) { \n + mDownsampleIfLargeBitmap = downsampleIfLargeBitmap ; \n + return mConfigBuilder ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + import java . util . Optional ; \n - maybeIncreaseSampleSize ( encodedImage ) ; \n + if ( producerContext \n + . getImagePipelineConfig ( ) \n + . getExperiments ( ) \n + . shouldDownsampleIfLargeBitmap ( ) ) { \n + maybeIncreaseSampleSize ( encodedImage ) ; \n + } \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducerTest . java \n + import com . facebook . imagepipeline . core . ImagePipelineExperiments ; \n + @ Mock public ImagePipelineExperiments mPipelineExperiments ; \n + when ( mConfig . getExperiments ( ) ) . thenReturn ( mPipelineExperiments ) ; \n + \n samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ ShowcaseApplication . kt \n + imagePipelineConfigBuilder . experiment ( ) . setDownsampleIfLargeBitmap ( true ) \n + \n,Add parameter to downsample if decoded bitmap would be large ( over 100Mb ) \n Reviewed By : oprisnik \n Differential Revision : D17984075 \n fbshipit - source - id : ca38bf06a044d2ddf828692723a64786eba64951,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ transcoder \ DownsampleUtil . java \n + public static int determineSampleSizeJPEG ( \n + final EncodedImage encodedImage , final int pixelSize , final int maxBitmapSizeInBytes ) { \n + int sampleSize = encodedImage . getSampleSize ( ) ; \n + final int base = encodedImage . getWidth ( ) * encodedImage . getHeight ( ) * pixelSize ; \n + \n + while ( base / sampleSize / sampleSize > maxBitmapSizeInBytes ) { \n + sampleSize * = 2 ; \n + } \n + \n + return sampleSize ; \n + } \n + \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + import com . facebook . imageutils . BitmapUtil ; \n + / / In recent versions of Android you cannot draw bitmap that is bigger than 100MB bytes : \n + / / https : / / web . archive . org / web / 20191017003524 / https : / / chromium . googlesource . com / android _ tools / + / refs / heads / master / sdk / sources / android - 25 / android / view / DisplayListCanvas . java \n + private static final int MAX _ BITMAP _ SIZE = 100 * 1024 * 1024 ; / / 100 MB \n + \n + \n + maybeIncreaseSampleSize ( encodedImage ) ; \n + \n + private void maybeIncreaseSampleSize ( final EncodedImage encodedImage ) { \n + if ( encodedImage . getImageFormat ( ) ! = DefaultImageFormats . JPEG ) { \n + return ; \n + } \n + \n + final int pixelSize = \n + BitmapUtil . getPixelSizeForBitmapConfig ( mImageDecodeOptions . bitmapConfig ) ; \n + final int sampleSize = \n + DownsampleUtil . determineSampleSizeJPEG ( encodedImage , pixelSize , MAX _ BITMAP _ SIZE ) ; \n + encodedImage . setSampleSize ( sampleSize ) ; \n + } \n + \n",Downsample image if bitmap will it exceeds 100MB in bytes size \n Reviewed By : oprisnik \n Differential Revision : D17970216 \n fbshipit - source - id : f6efc5fbf823bd40cbdfc31f1c59981247146224,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + import com . facebook . imagepipeline . image . OriginalEncodedImageInfo ; \n + \n + if ( image ! = null ) { \n + image . setOriginalEncodedImageInfo ( \n + new OriginalEncodedImageInfo ( \n + encodedImage . getWidth ( ) , encodedImage . getHeight ( ) , encodedImage . getSize ( ) ) ) ; \n + } \n + \n",Set original encoded image metadata in DecodeProducer \n Reviewed By : oprisnik \n Differential Revision : D17960951 \n fbshipit - source - id : 9d12545febc086941b92f55496cf89f5b21588c7,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ CloseableImage . java \n + private OriginalEncodedImageInfo mOriginalEncodedImageInfo ; \n + public OriginalEncodedImageInfo getOriginalEncodedImageInfo ( ) { \n + return mOriginalEncodedImageInfo ; \n + } \n + \n + public void setOriginalEncodedImageInfo ( OriginalEncodedImageInfo originalEncodedImageInfo ) { \n + mOriginalEncodedImageInfo = originalEncodedImageInfo ; \n + } \n + \n new file \n imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ OriginalEncodedImageInfo . java \n + / * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * / \n + \n + package com . facebook . imagepipeline . image ; \n + \n + public class OriginalEncodedImageInfo { \n + private static final int UNSET = - 1 ; \n + private int mWidth = UNSET ; \n + private int mHeight = UNSET ; \n + private int mSize = UNSET ; \n + \n + public OriginalEncodedImageInfo ( int width , int height , int size ) { \n + mWidth = width ; \n + mHeight = height ; \n + mSize = size ; \n + } \n + \n + public int getWidth ( ) { \n + return mWidth ; \n + } \n + \n + public int getHeight ( ) { \n + return mHeight ; \n + } \n + \n + public int getSize ( ) { \n + return mSize ; \n + } \n + } \n",Add original encoded image metadata to CloseableImage \n Reviewed By : oprisnik \n Differential Revision : D17960950 \n fbshipit - source - id : e1e45f7caa28c89118bbf10c5fec9aadb9c9264a,47
"deleted file \n native - imagetranscoder \ src \ test \ java \ com \ facebook \ transcoder \ AndroidManifest . xml \n - < manifest xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n - package = "" com . facebook . nativeimagetranscoder "" > \n - \n - < uses - permission android : name = "" android . permission . WRITE _ EXTERNAL _ STORAGE "" / > \n - \n - < / manifest > \n",Remove empty transcoder test \n Reviewed By : oprisnik \n Differential Revision : D14403789 \n fbshipit - source - id : 83d0626e4e8fb69fe708ccae1260ff730bf3b4ea,47
"fbcore \ src \ main \ java \ com \ facebook \ common \ references \ SharedReference . java \n + import com . facebook . common . internal . Objects ; \n + \n + public static String reportData ( ) { \n + return Objects . toStringHelper ( "" SharedReference "" ) \n + . add ( "" live _ objects _ count "" , sLiveObjects . size ( ) ) \n + . toString ( ) ; \n + } \n imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ cache \ CountingMemoryCache . java \n + import com . facebook . common . internal . Objects ; \n + \n + public String reportData ( ) { \n + return Objects . toStringHelper ( "" CountingMemoryCache "" ) \n + . add ( "" cached _ entries _ count : "" , mCachedEntries . getCount ( ) ) \n + . add ( "" exclusive _ entries _ count "" , mExclusiveEntries . getCount ( ) ) \n + . toString ( ) ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n + import com . facebook . common . internal . Objects ; \n + \n + @ Nullable \n + public String reportData ( ) { \n + return Objects . toStringHelper ( "" ImagePipelineFactory "" ) \n + . add ( "" bitmapCountingMemoryCache "" , mBitmapCountingMemoryCache . reportData ( ) ) \n + . add ( "" encodedCountingMemoryCache "" , mEncodedCountingMemoryCache . reportData ( ) ) \n + . toString ( ) ; \n + } \n",Add reportData methods for debugging and crash reporting \n Reviewed By : oprisnik \n Differential Revision : D18449411 \n fbshipit - source - id : be3349e370af2a070677bb2b4c2118d6c824b8eb,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n - private @ Nullable Drawable mDrawable ; \n + protected @ Nullable Drawable mDrawable ; \n + \n,Fix animatable drawable not playing \n Reviewed By : oprisnik \n Differential Revision : D18643528 \n fbshipit - source - id : 0b272fbadde7742188d785493ed004dfd595ca8e,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalVideoThumbnailProducer . java \n + import com . facebook . imagepipeline . image . OriginalEncodedImageInfo ; \n - return CloseableReference . < CloseableImage > of ( \n + CloseableStaticBitmap closeableStaticBitmap = \n + 0 ) ; \n + closeableStaticBitmap . setOriginalEncodedImageInfo ( \n + new OriginalEncodedImageInfo ( \n + producerContext . getImageRequest ( ) . getSourceUri ( ) , \n + producerContext . getEncodedImageOrigin ( ) , \n + producerContext . getCallerContext ( ) , \n + 0 , \n + 0 , \n + return CloseableReference . < CloseableImage > of ( closeableStaticBitmap ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ PostprocessorProducer . java \n - return CloseableReference . < CloseableImage > of ( \n + CloseableStaticBitmap closeableStaticBitmap = \n - bitmapRef , sourceImage . getQualityInfo ( ) , rotationAngle , exifOrientation ) ) ; \n + bitmapRef , sourceImage . getQualityInfo ( ) , rotationAngle , exifOrientation ) ; \n + closeableStaticBitmap . setOriginalEncodedImageInfo ( \n + staticBitmap . getOriginalEncodedImageInfo ( ) ) ; \n + return CloseableReference . < CloseableImage > of ( closeableStaticBitmap ) ; \n",Set encoded image info in postprocessor and local video thumb producers \n Reviewed By : oprisnik \n Differential Revision : D18697282 \n fbshipit - source - id : f629ff8c1c82ef04ad0046422dedc9a9c3b2283d,47
vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoContext . java \n - private final FrescoController mController ; \n + private FrescoController mController ; \n + \n + public void setController ( FrescoController controller ) { \n + mController = controller ; \n + } \n + \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoState . java \n + private @ Nullable Object mExtras ; \n + \n + public @ Nullable Object getExtras ( ) { \n + return mExtras ; \n + } \n + \n + public void setExtras ( @ Nullable Object extras ) { \n + mExtras = extras ; \n + } \n,Add Dialtone support \n Reviewed By : oprisnik \n Differential Revision : D15411914 \n fbshipit - source - id : 511feb004092edcf51e687629f462d3bd70cd000,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ InstrumentedDrawable . java \n - mListener . track ( viewWidth , viewHeight , imageWidth , imageHeight , scaledWidth , scaledHeight ) ; \n + if ( mListener ! = null ) { \n + mListener . track ( viewWidth , viewHeight , imageWidth , imageHeight , scaledWidth , scaledHeight ) ; \n + } \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ HierarcherImpl . java \n - actualImageWrapperDrawable = new InstrumentedDrawable ( actualDrawable , instrumentedListener ) ; \n + actualImageWrapperDrawable = new InstrumentedDrawable ( actualImageWrapperDrawable , instrumentedListener ) ; \n",Fix instrumented drawable scaling \n Reviewed By : oprisnik \n Differential Revision : D18944243 \n fbshipit - source - id : 4d3e3d6b94c64746432ac5078c105c8c749eeefb,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n - public boolean mEncodedCacheEnabled ; \n + public boolean mEncodedCacheEnabled = true ; \n,Fix encoded cache default value \n Reviewed By : yanivsb \n Differential Revision : D19175695 \n fbshipit - source - id : 471bc8658c08d2832b15989d90f4f711d9a6566f,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n - private static final int MAX _ SIMULTANEOUS _ REQUESTS = 5 ; \n + private static final int MAX _ SIMULTANEOUS _ REQUESTS = 900 ; \n,Alpha release \n Reviewed By : erikandre \n Differential Revision : D19263216 \n fbshipit - source - id : 132122340d78a7aa79055f508b43ee19d2d033b6,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n - public < T > ThreadHandoffProducer < T > newBackgroundThreadHandoffProducer ( \n + public < T > Producer < T > newBackgroundThreadHandoffProducer ( \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactory . java \n - import com . facebook . imagepipeline . producers . ThreadHandoffProducer ; \n - ThreadHandoffProducer < CloseableReference < CloseableImage > > threadHandoffProducer = \n + Producer < CloseableReference < CloseableImage > > threadHandoffProducer = \n,Change signature in ProducerFactory to a more generic one \n Reviewed By : oprisnik \n Differential Revision : D22868850 \n fbshipit - source - id : 28b7233b7c3d9d9495641fafa37b1ed5e40994cb,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalVideoThumbnailProducer . java \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" local "" ) ; \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" local "" ) ; \n",Set producer context origin in LocalVideoThumbnailProducer \n Reviewed By : wizh \n Differential Revision : D20463230 \n fbshipit - source - id : f98fc7dff8271b713f67a282202fb29a81cdb70c,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n - public NetworkFetchProducer newNetworkFetchProducer ( NetworkFetcher networkFetcher ) { \n + public Producer < EncodedImage > newNetworkFetchProducer ( NetworkFetcher networkFetcher ) { \n,Change return type to more generic \n Reviewed By : wizh \n Differential Revision : D20510873 \n fbshipit - source - id : 983a2469841c9545c6e66b639b952c1b10616a53,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ InstrumentedDrawable . java \n + private final String mScaleType ; \n + \n - int scaledHeight ) ; \n + int scaledHeight , \n + String scaleType ) ; \n + mScaleType = getScaleType ( drawable ) ; \n + } \n + \n + private String getScaleType ( Drawable drawable ) { \n + if ( drawable instanceof ScaleTypeDrawable ) { \n + ScalingUtils . ScaleType type = ( ( ScaleTypeDrawable ) drawable ) . getScaleType ( ) ; \n + return type . toString ( ) ; \n + } \n + return "" none "" ; \n - mListener . track ( viewWidth , viewHeight , imageWidth , imageHeight , scaledWidth , scaledHeight ) ; \n + mListener . track ( \n + viewWidth , viewHeight , imageWidth , imageHeight , scaledWidth , scaledHeight , mScaleType ) ; \n ui - common \ src \ main \ java \ com \ facebook \ fresco \ ui \ common \ DimensionsInfo . java \n + private final String mScaleType ; \n - int decodedImageHeight ) { \n + int decodedImageHeight , \n + String scaleType ) { \n + mScaleType = scaleType ; \n + public String getScaleType ( ) { \n + return mScaleType ; \n + } \n + \n + mDecodedImageWidth \n + "" , mDecodedImageHeight = "" \n + mDecodedImageHeight \n + + "" , mScaleType = ' "" \n + + mScaleType \n + + ' \ ' ' \n + ' } ' ; \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoControllerImpl . java \n - int scaledHeight ) { \n + int scaledHeight , \n + String scaleType ) { \n - viewWidth , viewHeight , \n - encodedImageWidth , encodedImageHeight , \n - imageWidth , imageHeight ) ; \n + viewWidth , \n + viewHeight , \n + encodedImageWidth , \n + encodedImageHeight , \n + imageWidth , \n + imageHeight , \n + scaleType ) ; \n",Add scale type logging \n Reviewed By : oprisnik \n Differential Revision : D20645543 \n fbshipit - source - id : 7736d3b266ece86dad51e881989e4b180992034c,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n - private static final int MAX _ SIMULTANEOUS _ REQUESTS = 900 ; \n + private static final int MAX _ SIMULTANEOUS _ REQUESTS = 5 ; \n,Reset MAX _ SIMULTANEOUS _ REQUESTS to default value \n Reviewed By : oprisnik \n Differential Revision : D19283109 \n fbshipit - source - id : d45e93584ed6aee6d40dd6dba54cac96e2003654,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ BitmapMemoryCacheKeyMultiplexProducer . java \n - super ( inputProducer , "" BitmapMemoryCacheKeyMultiplexProducer "" ) ; \n + super ( \n + inputProducer , \n + "" BitmapMemoryCacheKeyMultiplexProducer "" , \n + ProducerContext . ExtraKeys . MULTIPLEX _ BITMAP _ COUNT ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ EncodedCacheKeyMultiplexProducer . java \n - super ( inputProducer , "" EncodedCacheKeyMultiplexProducer "" , keepCancelledFetchAsLowPriority ) ; \n + super ( \n + inputProducer , \n + "" EncodedCacheKeyMultiplexProducer "" , \n + ProducerContext . ExtraKeys . MULTIPLEX _ ENCODED _ COUNT , \n + keepCancelledFetchAsLowPriority ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ MultiplexProducer . java \n + private final String mDedupedRequestsCountKey ; \n - protected MultiplexProducer ( Producer < T > inputProducer , String producerName ) { \n - this ( inputProducer , producerName , false ) ; \n + protected MultiplexProducer ( \n + Producer < T > inputProducer , \n + String producerName , \n + @ ProducerContext . ExtraKeys String dedupedRequestsCountKey ) { \n + this ( inputProducer , producerName , dedupedRequestsCountKey , false ) ; \n - Producer < T > inputProducer , String producerName , boolean keepCancelledFetchAsLowPriority ) { \n + Producer < T > inputProducer , \n + String producerName , \n + @ ProducerContext . ExtraKeys String dedupedRequestsCountKey , \n + boolean keepCancelledFetchAsLowPriority ) { \n + mDedupedRequestsCountKey = dedupedRequestsCountKey ; \n + final int size ; \n + size = mConsumerContextPairs . size ( ) ; \n + pair . second . setExtra ( mDedupedRequestsCountKey , size ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ProducerContext . java \n - ExtraKeys . ENCODED _ SIZE \n + ExtraKeys . ENCODED _ SIZE , \n + ExtraKeys . MULTIPLEX _ BITMAP _ COUNT , \n + ExtraKeys . MULTIPLEX _ ENCODED _ COUNT , \n + / * number of deduped request in BitmapMemoryCacheKeyMultiplexProducer * / \n + String MULTIPLEX _ BITMAP _ COUNT = "" multiplex _ bmp _ cnt "" ; \n + / * number of deduped request in EncodedCacheKeyMultiplexProducer * / \n + String MULTIPLEX _ ENCODED _ COUNT = "" multiplex _ enc _ cnt "" ; \n",Log the number of deduped requests \n Reviewed By : oprisnik \n Differential Revision : D21301447 \n fbshipit - source - id : 8ae7460595d434bcb4e8a43cd4dba68ebf1d337c,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n - ImmutableMap . < String , Object > of ( "" origin "" , "" shortcut "" ) ; \n + ImmutableMap . < String , Object > of ( \n + "" origin "" , "" memory _ bitmap "" , \n + "" origin _ sub "" , "" drawee "" ) ; \n",Set origin sub - category in Drawee \n Reviewed By : oprisnik \n Differential Revision : D21373104 \n fbshipit - source - id : 90758bc71b490f9a694139a9dcb86329d4480966,47
imagepipeline - base \ src \ main \ java \ com \ facebook \ imageutils \ BitmapUtil . java \n + case HARDWARE : \n + / / We assume ARGB _ 8888 is used underneath \n + return ARGB _ 8888 _ BYTES _ PER _ PIXEL ; \n,Handle hardware bitmaps in BitmapUtil \n Reviewed By : oprisnik \n Differential Revision : D22868854 \n fbshipit - source - id : c728da8c3bdef98484478471a735b83226dc8f79,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfData . java \n + private final @ Nullable Object mExtraData ; \n + \n - @ Nullable DimensionsInfo dimensionsInfo ) { \n + @ Nullable DimensionsInfo dimensionsInfo , \n + @ Nullable Object extraData ) { \n + mExtraData = extraData ; \n + @ Nullable \n + public Object getExtraData ( ) { \n + return mExtraData ; \n + } \n + \n + . add ( "" extra data "" , mExtraData ) \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n + private @ Nullable Object mExtraData ; \n + \n + mExtraData = null ; \n + \n - mDimensionsInfo ) ; \n + mDimensionsInfo , \n + mExtraData ) ; \n + \n + public void setExtraData ( @ Nullable Object extraData ) { \n + mExtraData = extraData ; \n + } \n + \n + public @ Nullable Object getExtraData ( ) { \n + return mExtraData ; \n + } \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListener2 . java \n + mImagePerfState . setExtraData ( extraData ) ; \n + \n","Add extra fields to ImagePerf { State , Data } \n Reviewed By : oprisnik \n Differential Revision : D21245835 \n fbshipit - source - id : fa57cf7b0b52afaef00ca278e3e5c18b4fb82ea1",47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ BitmapMemoryCacheProducer . java \n + import com . facebook . imagepipeline . image . HasImageMetadata ; \n + import com . facebook . imagepipeline . image . OriginalEncodedImageInfo ; \n + import com . facebook . imagepipeline . producers . ProducerContext . ExtraKeys ; \n + maybeSetExtrasFromCloseableImage ( cachedReference . get ( ) , producerContext ) ; \n + \n + private static void maybeSetExtrasFromCloseableImage ( \n + HasImageMetadata imageWithMeta , ProducerContext producerContext ) { \n + final OriginalEncodedImageInfo info = imageWithMeta . getOriginalEncodedImageInfo ( ) ; \n + if ( info = = null ) { \n + return ; \n + } \n + \n + producerContext . setExtra ( ExtraKeys . ENCODED _ WIDTH , info . getWidth ( ) ) ; \n + producerContext . setExtra ( ExtraKeys . ENCODED _ HEIGHT , info . getHeight ( ) ) ; \n + producerContext . setExtra ( ExtraKeys . ENCODED _ SIZE , info . getSize ( ) ) ; \n + } \n",Set producer context extras in the bitmap producer \n Reviewed By : oprisnik \n Differential Revision : D21262911 \n fbshipit - source - id : 9394a60b763e04e843020379230042078426e0ec,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DiskCacheReadProducer . java \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" disk _ none "" ) ; \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" disk _ null "" ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ PartialDiskCacheProducer . java \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" disk _ partial "" ) ; \n",Fix origin in disk producers \n Reviewed By : oprisnik \n Differential Revision : D21286223 \n fbshipit - source - id : ff5a39171bb5ef026c09338e99fbfba0b68de697,47
"drawee - backends \ drawee - pipeline \ src \ test \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfMonitorTest . java \n + import org . junit . runner . RunWith ; \n + import org . robolectric . RobolectricTestRunner ; \n + @ RunWith ( RobolectricTestRunner . class ) \n drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n + import android . graphics . Rect ; \n + import java . util . HashMap ; \n + import java . util . Map ; \n - private static final Object SHORCUT _ EXTRADATA = \n - ImmutableMap . < String , Object > of ( "" origin "" , "" shorcut "" ) ; \n + private static final Map < String , Object > SHORTCUT _ EXTRAS = \n + ImmutableMap . < String , Object > of ( "" origin "" , "" shortcut "" ) ; \n + \n + private static final Rect RECT _ ZEROES = new Rect ( ) ; \n - private Extras obtainExtras ( DataSource < T > dataSource ) { \n - return new Extras ( ) ; \n + private ControllerListener2 . Extras obtainExtras ( @ Nullable DataSource < T > dataSource ) { \n + ControllerListener2 . Extras extras = new ControllerListener2 . Extras ( ) ; \n + if ( dataSource ! = null ) { \n + extras . pipe = dataSource . getExtras ( ) ; \n + } \n + \n + extras . view = new HashMap < > ( 2 ) ; \n + addDimensions ( extras . view ) ; \n + \n + if ( dataSource = = null ) { \n + extras . view . putAll ( SHORTCUT _ EXTRAS ) ; \n + } \n + \n + return extras ; \n + } \n + \n + private void addDimensions ( Map < String , Object > extras ) { \n + Rect r = getDimensions ( ) ; \n + extras . put ( "" viewport _ width "" , r ! = null ? r . width ( ) : - 1 ) ; \n + extras . put ( "" viewport _ height "" , r ! = null ? r . height ( ) : - 1 ) ; \n + } \n + \n + private Rect getDimensions ( ) { \n + if ( mSettableDraweeHierarchy = = null ) { \n + return RECT _ ZEROES ; \n + } \n + return mSettableDraweeHierarchy . getBounds ( ) ; \n",Pass viewport dimensions in drawee \n Reviewed By : oprisnik \n Differential Revision : D21303607 \n fbshipit - source - id : 91296b4aa7b895d39ec1056375b74a0fdd24592c,47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfData . java \n + import com . facebook . fresco . ui . common . ControllerListener2 ; \n + import com . facebook . fresco . ui . common . ControllerListener2 . Extras ; \n - private final @ Nullable Object mExtraData ; \n + private final @ Nullable Extras mExtraData ; \n - @ Nullable Object extraData ) { \n + @ Nullable Extras extraData ) { \n - public Object getExtraData ( ) { \n + public Extras getExtraData ( ) { \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfState . java \n + import com . facebook . fresco . ui . common . ControllerListener2 ; \n + import com . facebook . fresco . ui . common . ControllerListener2 . Extras ; \n - private @ Nullable Object mExtraData ; \n + private @ Nullable Extras mExtraData ; \n - public void setExtraData ( @ Nullable Object extraData ) { \n + public void setExtraData ( @ Nullable Extras extraData ) { \n,Log pipeline and view extras \n Reviewed By : oprisnik \n Differential Revision : D21303608 \n fbshipit - source - id : ba620b55c2da6674c6fa644353ac0879d592707c,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ generic \ GenericDraweeHierarchy . java \n + import android . graphics . Rect ; \n + @ Override \n + public Rect getBounds ( ) { \n + return mTopLevelDrawable . getBounds ( ) ; \n + } \n + \n drawee \ src \ main \ java \ com \ facebook \ drawee \ interfaces \ DraweeHierarchy . java \n + import android . graphics . Rect ; \n + \n + / * * \n + * @ return bounds of the top drawable \n + * / \n + Rect getBounds ( ) ; \n,Add getBounds to drawee hierarchy \n Reviewed By : oprisnik \n Differential Revision : D21303610 \n fbshipit - source - id : 82cfe363a6388c7b6b1d392344d77cd9f4ca0c76,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ MultiplexProducer . java \n + import com . facebook . common . util . TriState ; \n + / * Specifies if the first of the multiplex requests of the group that the marked request belongs to is a prefetch * / \n + public static final String EXTRAS _ STARTED _ AS _ PREFETCH = "" started _ as _ prefetch "" ; \n + \n - multiplexer . startInputProducerIfHasAttachedConsumers ( ) ; \n + multiplexer . startInputProducerIfHasAttachedConsumers ( TriState . valueOf ( context . isPrefetch ( ) ) ) ; \n - private void startInputProducerIfHasAttachedConsumers ( ) { \n + private void startInputProducerIfHasAttachedConsumers ( TriState startedAsPrefetch ) { \n + if ( startedAsPrefetch . isSet ( ) ) { \n + mMultiplexProducerContext . setExtra ( EXTRAS _ STARTED _ AS _ PREFETCH , startedAsPrefetch . asBoolean ( ) ) ; \n + } \n - startInputProducerIfHasAttachedConsumers ( ) ; \n + startInputProducerIfHasAttachedConsumers ( TriState . UNSET ) ; \n",Add ' started as prefetch ' field \n Reviewed By : oprisnik \n Differential Revision : D21373094 \n fbshipit - source - id : 0f4edc307ba0f0d40faa95b7ada5703e85a538e9,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n + private static boolean sForceSinglePipelineInstance ; \n + private static ImagePipeline sImagePipeline ; \n + / * * Initializes { @ link ImagePipelineFactory } with the specified config . * / \n + public static synchronized void initialize ( \n + ImagePipelineConfig imagePipelineConfig , boolean forceSinglePipelineInstance ) { \n + if ( sInstance ! = null ) { \n + FLog . w ( \n + TAG , \n + "" ImagePipelineFactory has already been initialized ! ` ImagePipelineFactory . initialize ( . . . ) ` should only be called once to avoid unexpected behavior . "" ) ; \n + } \n + \n + sForceSinglePipelineInstance = forceSinglePipelineInstance ; \n + sInstance = new ImagePipelineFactory ( imagePipelineConfig ) ; \n + } \n + \n + if ( sForceSinglePipelineInstance ) { \n + if ( sImagePipeline = = null ) { \n + sImagePipeline = createImagePipeline ( ) ; \n + mImagePipeline = sImagePipeline ; \n + } \n + return sImagePipeline ; \n + } \n - mImagePipeline = \n - new ImagePipeline ( \n - getProducerSequenceFactory ( ) , \n - mConfig . getRequestListeners ( ) , \n - mConfig . getRequestListener2s ( ) , \n - mConfig . getIsPrefetchEnabledSupplier ( ) , \n - getBitmapMemoryCache ( ) , \n - getEncodedMemoryCache ( ) , \n - getMainBufferedDiskCache ( ) , \n - getSmallImageBufferedDiskCache ( ) , \n - mConfig . getCacheKeyFactory ( ) , \n - mThreadHandoffProducerQueue , \n - mConfig . getExperiments ( ) . getSuppressBitmapPrefetchingSupplier ( ) , \n - mConfig . getExperiments ( ) . isLazyDataSource ( ) , \n - mConfig . getCallerContextVerifier ( ) , \n - mConfig ) ; \n + mImagePipeline = createImagePipeline ( ) ; \n + private ImagePipeline createImagePipeline ( ) { \n + return new ImagePipeline ( \n + getProducerSequenceFactory ( ) , \n + mConfig . getRequestListeners ( ) , \n + mConfig . getRequestListener2s ( ) , \n + mConfig . getIsPrefetchEnabledSupplier ( ) , \n + getBitmapMemoryCache ( ) , \n + getEncodedMemoryCache ( ) , \n + getMainBufferedDiskCache ( ) , \n + getSmallImageBufferedDiskCache ( ) , \n + mConfig . getCacheKeyFactory ( ) , \n + mThreadHandoffProducerQueue , \n + mConfig . getExperiments ( ) . getSuppressBitmapPrefetchingSupplier ( ) , \n + mConfig . getExperiments ( ) . isLazyDataSource ( ) , \n + mConfig . getCallerContextVerifier ( ) , \n + mConfig ) ; \n + } \n + \n",Ensure single pipeline instance \n Reviewed By : oprisnik \n Differential Revision : D21370176 \n fbshipit - source - id : 4e7a7fb358d1f3fa60a92a3f4bc8782cb723dc19,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ CloseableImage . java \n + extras . put ( "" uri "" , mOriginalEncodedImageInfo . getUri ( ) ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ datasource \ AbstractProducerToDataSourceAdapter . java \n + setInitialExtras ( ) ; \n + \n + private void setInitialExtras ( ) { \n + ImageRequest request = mSettableProducerContext . getImageRequest ( ) ; \n + if ( request ! = null ) { \n + mSettableProducerContext . setExtra ( \n + ProducerContext . ExtraKeys . SOURCE _ URI , \n + mSettableProducerContext . getImageRequest ( ) . getSourceUri ( ) ) ; \n + } \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ProducerContext . java \n + ExtraKeys . NORMALIZED _ URI , \n + ExtraKeys . SOURCE _ URI , \n + String SOURCE _ URI = "" uri _ source "" ; \n + String NORMALIZED _ URI = "" uri _ norm "" ; \n",Set uri to producer context and image info \n Reviewed By : oprisnik \n Differential Revision : D21763217 \n fbshipit - source - id : b8a268e1dfad1c602d8d506fdecc458cd5c3290d,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n - protected ControllerListener2 getControllerListener2 ( ) { \n + protected ControllerListener2 < INFO > getControllerListener2 ( ) { \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ impl \ FrescoContextImpl . java \n - import com . facebook . drawee . backends . pipeline . info . internal . ImagePerfControllerListener2 ; \n + import com . facebook . fresco . ui . common . ControllerListener2 ; \n - @ Nullable ImagePerfControllerListener2 imagePerfControllerListener2 , \n + @ Nullable ControllerListener2 imagePerfControllerListener2 , \n",Vito : support multiple controller listeners 2 \n Reviewed By : oprisnik \n Differential Revision : D21763218 \n fbshipit - source - id : ddbf7f75ba679a054ae73b142cbfc1a2879c2131,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalExifThumbnailProducer . java \n - consumer , listener , producerContext , PRODUCER _ NAME ) { \n + consumer , listener , producerContext , PRODUCER _ NAME , "" local _ exif "" ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalFetchProducer . java \n - consumer , listener , producerContext , getProducerName ( ) ) { \n + consumer , listener , producerContext , getProducerName ( ) , "" local _ fetch "" ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalVideoThumbnailProducer . java \n - consumer , listener , producerContext , PRODUCER _ NAME ) { \n + consumer , listener , producerContext , PRODUCER _ NAME , "" local _ video "" ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ StatefulProducerRunnable . java \n + private final String mOrigin ; \n - String producerName ) { \n + String producerName , \n + String origin ) { \n + mOrigin = origin ; \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , mOrigin ) ; \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , mOrigin ) ; \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , mOrigin ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ThreadHandoffProducer . java \n - new StatefulProducerRunnable < T > ( consumer , producerListener , context , PRODUCER _ NAME ) { \n + new StatefulProducerRunnable < T > ( \n + consumer , producerListener , context , PRODUCER _ NAME , "" "" ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ WebpTranscodeProducer . java \n - consumer , producerContext . getProducerListener ( ) , producerContext , PRODUCER _ NAME ) { \n + consumer , producerContext . getProducerListener ( ) , producerContext , PRODUCER _ NAME , "" "" ) { \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ producers \ StatefulProducerRunnableTest . java \n - mConsumer , mProducerListener , mProducerContext , PRODUCER _ NAME ) { \n + mConsumer , mProducerListener , mProducerContext , PRODUCER _ NAME , "" "" ) { \n",Set origin for some local producers \n Reviewed By : wizh \n Differential Revision : D20815209 \n fbshipit - source - id : 117f1537c9831f22f837bd074028c50b0e05c90c,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ CloseableImage . java \n - "" encoded _ size "" , "" encoded _ width "" , "" encoded _ height "" , "" uri _ source "" , \n + "" encoded _ size "" , "" encoded _ width "" , "" encoded _ height "" , "" uri _ source "" , "" image _ format "" \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + mProducerContext . setExtra ( "" image _ format "" , encodedImage . getImageFormat ( ) . getName ( ) ) ; \n",Extras : set image format \n Reviewed By : oprisnik \n Differential Revision : D22032247 \n fbshipit - source - id : 8fc667acd0ba057743ddc36f5b247eb172eae62b,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ CloseableImage . java \n - "" encoded _ size "" , "" encoded _ width "" , "" encoded _ height "" , "" uri _ source "" , "" image _ format "" \n + "" encoded _ size "" , \n + "" encoded _ width "" , \n + "" encoded _ height "" , \n + "" uri _ source "" , \n + "" image _ format "" , \n + "" bitmap _ config "" \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + import com . facebook . imagepipeline . image . CloseableBitmap ; \n - mProducerContext . setExtra ( ProducerContext . ExtraKeys . ENCODED _ WIDTH , encodedImage . getWidth ( ) ) ; \n - mProducerContext . setExtra ( \n - ProducerContext . ExtraKeys . ENCODED _ HEIGHT , encodedImage . getHeight ( ) ) ; \n - mProducerContext . setExtra ( ProducerContext . ExtraKeys . ENCODED _ SIZE , encodedImage . getSize ( ) ) ; \n - if ( image ! = null ) { \n - image . setImageExtras ( mProducerContext . getExtras ( ) ) ; \n - } \n + setImageExtras ( encodedImage , image ) ; \n + private void setImageExtras ( EncodedImage encodedImage , CloseableImage image ) { \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ENCODED _ WIDTH , encodedImage . getWidth ( ) ) ; \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ENCODED _ HEIGHT , encodedImage . getHeight ( ) ) ; \n + mProducerContext . setExtra ( ProducerContext . ExtraKeys . ENCODED _ SIZE , encodedImage . getSize ( ) ) ; \n + if ( image instanceof CloseableBitmap ) { \n + Bitmap bitmap = ( ( CloseableBitmap ) image ) . getUnderlyingBitmap ( ) ; \n + Bitmap . Config config = bitmap = = null ? null : bitmap . getConfig ( ) ; \n + mProducerContext . setExtra ( "" bitmap _ config "" , String . valueOf ( config ) ) ; \n + } \n + if ( image ! = null ) { \n + image . setImageExtras ( mProducerContext . getExtras ( ) ) ; \n + } \n + } \n + \n",Set bitmap config to extras \n Reviewed By : oprisnik \n Differential Revision : D22136759 \n fbshipit - source - id : f6736b6f9eb11368848ae92b85e7a3efd5a31dc1,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ datasource \ AbstractProducerToDataSourceAdapter . java \n + import java . util . UUID ; \n + import java . util . concurrent . atomic . AtomicInteger ; \n + \n - ImageRequest request = mSettableProducerContext . getImageRequest ( ) ; \n - mSettableProducerContext . setExtra ( \n - ProducerContext . ExtraKeys . SOURCE _ URI , \n - request = = null ? "" null - request "" : request . getSourceUri ( ) ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ BaseProducerContext . java \n + import com . facebook . common . internal . ImmutableSet ; \n + import java . util . Set ; \n + public static final Set < String > INITIAL _ KEYS = ImmutableSet . of ( "" id "" , "" uri _ source "" ) ; \n + \n - private final Map < String , Object > mExtras = new HashMap < > ( ) ; \n + private final Map < String , Object > mExtras ; \n + \n + mExtras = new HashMap < > ( ) ; \n + mExtras . put ( "" id "" , mId ) ; \n + mExtras . put ( "" uri _ source "" , imageRequest = = null ? "" null - request "" : imageRequest . getSourceUri ( ) ) ; \n + \n + if ( INITIAL _ KEYS . contains ( key ) ) return ; \n - if ( extras ! = null ) { \n - mExtras . putAll ( extras ) ; \n + if ( extras = = null ) return ; \n + for ( Map . Entry < String , ? > entry : extras . entrySet ( ) ) { \n + setExtra ( entry . getKey ( ) , entry . getValue ( ) ) ; \n",Set producer context id to extras \n Reviewed By : oprisnik \n Differential Revision : D22136572 \n fbshipit - source - id : 7af7a5dace8f1bdd47203fefe2b3a700f294ca90,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ LocalVideoThumbnailProducer . java \n + producerContext . setExtra ( "" image _ format "" , "" thumbnail "" ) ; \n middleware \ src \ main \ java \ com \ facebook \ fresco \ middleware \ MiddlewareUtils . java \n + if ( imageExtras ! = null ) extras . pipe . putAll ( imageExtras ) ; \n",Report image format for postprocessed bitmap cache and video thumbnails \n Reviewed By : oprisnik \n Differential Revision : D22207781 \n fbshipit - source - id : 5278eb40e73b10b649881907b5259e8b9005e97d,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImageOriginUtils . java \n + case ImageOrigin . MEMORY _ BITMAP _ SHORTCUT : \n + return "" memory _ bitmap _ shortcut "" ; \n",Handle ImageOrigin . MEMORY _ BITMAP _ SHORTCUT in ImageOriginUtils \n Reviewed By : oprisnik \n Differential Revision : D20890385 \n fbshipit - source - id : 8c1bf5b2d3400f8e444e90aecccac17cbb3a387b,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ PostprocessedBitmapMemoryCacheProducer . java \n + producerContext . setExtra ( ProducerContext . ExtraKeys . ORIGIN , "" memory _ bitmap "" ) ; \n",Set origin for postprocessed bitmap producer \n Reviewed By : oprisnik \n Differential Revision : D20897877 \n fbshipit - source - id : 635d17993a2ae2ea0c663a9e75fd4688733d7fbf,47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfMonitor . java \n - public class ImagePerfMonitor { \n + public class ImagePerfMonitor implements ImagePerfNotifier { \n + @ Override \n + @ Override \n new file \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfNotifier . java \n + / / ( c ) Facebook , Inc . and its affiliates . Confidential and proprietary . \n + \n + package com . facebook . drawee . backends . pipeline . info ; \n + \n + public interface ImagePerfNotifier { \n + \n + void notifyListenersOfVisibilityStateUpdate ( ImagePerfState state , @ VisibilityState int visibilityState ) ; \n + \n + void notifyStatusUpdated ( ImagePerfState state , @ ImageLoadStatus int imageLoadStatus ) ; \n + \n + } \n drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListener2 . java \n - import com . facebook . drawee . backends . pipeline . info . ImagePerfMonitor ; \n + import com . facebook . drawee . backends . pipeline . info . ImagePerfNotifier ; \n - private final ImagePerfMonitor mImagePerfMonitor ; \n + private final ImagePerfNotifier mImagePerfNotifier ; \n - private final ImagePerfMonitor mMonitor ; \n + private final ImagePerfNotifier mNotifier ; \n - public LogHandler ( @ NonNull Looper looper , @ NonNull ImagePerfMonitor monitor ) { \n + public LogHandler ( @ NonNull Looper looper , @ NonNull ImagePerfNotifier notifier ) { \n - mMonitor = monitor ; \n + mNotifier = notifier ; \n - mMonitor . notifyStatusUpdated ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n + mNotifier . notifyStatusUpdated ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n - mMonitor . notifyListenersOfVisibilityStateUpdate ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n + mNotifier . notifyListenersOfVisibilityStateUpdate ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n - ImagePerfMonitor imagePerfMonitor , \n + ImagePerfNotifier imagePerfNotifier , \n - mImagePerfMonitor = imagePerfMonitor ; \n + mImagePerfNotifier = imagePerfNotifier ; \n - mImagePerfMonitor . notifyStatusUpdated ( mImagePerfState , imageLoadStatus ) ; \n + mImagePerfNotifier . notifyStatusUpdated ( mImagePerfState , imageLoadStatus ) ; \n - mImagePerfMonitor . notifyListenersOfVisibilityStateUpdate ( mImagePerfState , visibilityState ) ; \n + mImagePerfNotifier . notifyListenersOfVisibilityStateUpdate ( mImagePerfState , visibilityState ) ; \n - mHandler = new LogHandler ( handlerThread . getLooper ( ) , mImagePerfMonitor ) ; \n + mHandler = new LogHandler ( handlerThread . getLooper ( ) , mImagePerfNotifier ) ; \n",Extract ImagePerfNotifier interface \n Reviewed By : oprisnik \n Differential Revision : D21337570 \n fbshipit - source - id : f9cf002afefb1a0aef1ee46e03d7a9a715f969b3,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ CloseableImage . java \n - extras . put ( "" uri "" , mOriginalEncodedImageInfo . getUri ( ) ) ; \n + extras . put ( "" uri _ source "" , mOriginalEncodedImageInfo . getUri ( ) ) ; \n",Set up qpl fetch listener to use controller listener 2 \n Reviewed By : oprisnik \n Differential Revision : D21763216 \n fbshipit - source - id : 5881d9bfeccf14d85d4e188c605986da3744547c,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DecodeProducer . java \n + final boolean recover = mReclaimMemoryRunnable ! = null & & mRecoverFromDecoderOOM . get ( ) ; \n - if ( ! mRecoverFromDecoderOOM . get ( ) | | mReclaimMemoryRunnable = = null ) { \n + if ( ! recover ) { \n,Update recover - from - OOM experiment setup \n Reviewed By : wizh \n Differential Revision : D22546950 \n fbshipit - source - id : 4cc49c7c806f4f67f58ae2c5c2e0d03d9a2ba28b,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ProducerContext . java \n - < E > void setExtra ( @ ExtraKeys String key , @ Nullable E value ) ; \n + < E > void setExtra ( String key , @ Nullable E value ) ; \n",Minor : remove StringDef usage \n Reviewed By : oprisnik \n Differential Revision : D22574434 \n fbshipit - source - id : c25af781b95238e48e35ec7900a51ad2adc3feb1,47
imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ common \ ImageDecodeOptions . java \n + private final boolean excludeBitmapConfigFromComparison ; \n + \n + this . excludeBitmapConfigFromComparison = b . getExcludeBitmapConfigFromComparison ( ) ; \n - if ( bitmapConfig ! = that . bitmapConfig ) return false ; \n + if ( ! excludeBitmapConfigFromComparison & & bitmapConfig ! = that . bitmapConfig ) return false ; \n - result = 31 * result + bitmapConfig . ordinal ( ) ; \n + if ( ! excludeBitmapConfigFromComparison ) result = 31 * result + bitmapConfig . ordinal ( ) ; \n imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ common \ ImageDecodeOptionsBuilder . java \n + private boolean mExcludeBitmapConfigFromComparison ; \n + public T setExcludeBitmapConfigFromComparison ( boolean excludeBitmapConfigFromComparison ) { \n + mExcludeBitmapConfigFromComparison = excludeBitmapConfigFromComparison ; \n + return getThis ( ) ; \n + } \n + \n + public boolean getExcludeBitmapConfigFromComparison ( ) { \n + return mExcludeBitmapConfigFromComparison ; \n + } \n + \n,Add ImageDecodeOption parameter to exclude bitmap config from comparison \n Reviewed By : oprisnik \n Differential Revision : D22840865 \n fbshipit - source - id : 8a0b5fe61934e9885f117c47751c31d6dd4b4aef,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineConfig . java \n + @ Nullable \n + public BitmapMemoryCacheFactory getBitmapMemoryCacheFactory ( ) { \n + return mBitmapMemoryCacheFactory ; \n + } \n + \n,Minor : Add bitmap memory cache factory getter to imagepipeline config \n Reviewed By : wizh \n Differential Revision : D23078083 \n fbshipit - source - id : c79c2119feeab8ddfcdf3669c1682488d2a41327,47
"animated - gif \ src \ main \ jni \ gifimage \ gif . cpp \n + # define LOG _ TAG "" GifImage "" \n + \n",Fix build \n Reviewed By : oprisnik \n Differential Revision : D23345222 \n fbshipit - source - id : b0a365ec2aa97c98808659d237b3e0a991b387e4,47
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ ImagePerfMonitor . java \n + import java . util . concurrent . CopyOnWriteArrayList ; \n - mImagePerfDataListeners = new LinkedList < > ( ) ; \n + mImagePerfDataListeners = new CopyOnWriteArrayList < > ( ) ; \n,Use concurrent version of list in image perf monitor \n Reviewed By : oprisnik \n Differential Revision : D22433447 \n fbshipit - source - id : 1227419bcf767283012d3a32d9961faf23ae51e9,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ ImageRequest . java \n + private static boolean sUseCachedHashcodeInEquals ; \n + private static boolean sCacheHashcode ; \n + private int mHashcode ; \n + \n + if ( sUseCachedHashcodeInEquals ) { \n + int a = mHashcode ; \n + int b = request . mHashcode ; \n + if ( a ! = 0 & & b ! = 0 & & a ! = b ) { \n + return false ; \n + } \n + } \n - final CacheKey postprocessorCacheKey = \n - mPostprocessor ! = null ? mPostprocessor . getPostprocessorCacheKey ( ) : null ; \n - return Objects . hashCode ( \n - mCacheChoice , \n - mSourceUri , \n - mLocalThumbnailPreviewsEnabled , \n - mBytesRange , \n - mRequestPriority , \n - mLowestPermittedRequestLevel , \n - mIsDiskCacheEnabled , \n - mIsMemoryCacheEnabled , \n - mImageDecodeOptions , \n - mDecodePrefetches , \n - mResizeOptions , \n - mRotationOptions , \n - postprocessorCacheKey , \n - mResizingAllowedOverride ) ; \n + final boolean cacheHashcode = sCacheHashcode ; \n + int result = 0 ; \n + if ( cacheHashcode ) { \n + result = mHashcode ; \n + } \n + if ( result = = 0 ) { \n + final CacheKey postprocessorCacheKey = \n + mPostprocessor ! = null ? mPostprocessor . getPostprocessorCacheKey ( ) : null ; \n + result = \n + Objects . hashCode ( \n + mCacheChoice , \n + mSourceUri , \n + mLocalThumbnailPreviewsEnabled , \n + mBytesRange , \n + mRequestPriority , \n + mLowestPermittedRequestLevel , \n + mIsDiskCacheEnabled , \n + mIsMemoryCacheEnabled , \n + mImageDecodeOptions , \n + mDecodePrefetches , \n + mResizeOptions , \n + mRotationOptions , \n + postprocessorCacheKey , \n + mResizingAllowedOverride ) ; \n + if ( cacheHashcode ) { \n + mHashcode = result ; \n + } \n + } \n + return result ; \n + \n + public static void setUseCachedHashcodeInEquals ( boolean useCachedHashcodeInEquals ) { \n + sUseCachedHashcodeInEquals = useCachedHashcodeInEquals ; \n + } \n + \n + public static void setCacheHashcode ( boolean cacheHashcode ) { \n + sCacheHashcode = cacheHashcode ; \n + } \n",Optionally cache hashcode : ImageRequest \n Reviewed By : oprisnik \n Differential Revision : D24161969 \n fbshipit - source - id : 7afc610636247430178ff810a41131191a5c6dd2,47
"new file \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ listener \ BaseRequestListener2 . java \n + / / ( c ) Facebook , Inc . and its affiliates . Confidential and proprietary . \n + \n + package com . facebook . imagepipeline . listener ; \n + \n + import androidx . annotation . NonNull ; \n + import com . facebook . imagepipeline . producers . ProducerContext ; \n + import java . util . Map ; \n + import javax . annotation . Nullable ; \n + \n + public class BaseRequestListener2 implements RequestListener2 { \n + \n + @ Override \n + public void onRequestStart ( @ NonNull ProducerContext producerContext ) { } \n + \n + @ Override \n + public void onRequestSuccess ( @ NonNull ProducerContext producerContext ) { } \n + \n + @ Override \n + public void onRequestFailure ( @ NonNull ProducerContext producerContext , Throwable throwable ) { } \n + \n + @ Override \n + public void onRequestCancellation ( @ NonNull ProducerContext producerContext ) { } \n + \n + @ Override \n + public void onProducerStart ( \n + @ NonNull ProducerContext producerContext , @ NonNull String producerName ) { } \n + \n + @ Override \n + public void onProducerEvent ( \n + @ NonNull ProducerContext producerContext , \n + @ NonNull String producerName , \n + @ NonNull String eventName ) { } \n + \n + @ Override \n + public void onProducerFinishWithSuccess ( \n + @ NonNull ProducerContext producerContext , \n + @ NonNull String producerName , \n + @ Nullable Map < String , String > extraMap ) { } \n + \n + @ Override \n + public void onProducerFinishWithFailure ( \n + @ NonNull ProducerContext producerContext , \n + String producerName , \n + Throwable t , \n + @ Nullable Map < String , String > extraMap ) { } \n + \n + @ Override \n + public void onProducerFinishWithCancellation ( \n + @ NonNull ProducerContext producerContext , \n + @ NonNull String producerName , \n + @ Nullable Map < String , String > extraMap ) { } \n + \n + @ Override \n + public void onUltimateProducerReached ( \n + @ NonNull ProducerContext producerContext , @ NonNull String producerName , boolean successful ) { } \n + \n + @ Override \n + public boolean requiresExtraMap ( \n + @ NonNull ProducerContext producerContext , @ NonNull String producerName ) { \n + return false ; \n + } \n + } \n",Add BaseRequestListener2 \n Reviewed By : oprisnik \n Differential Revision : D19816443 \n fbshipit - source - id : c8afd2b965ea1470003f1144dd7234bce5d789c6,47
animated - base \ src \ main \ java \ com \ facebook \ fresco \ animation \ bitmap \ cache \ FrescoFrameCache . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n animated - drawable \ src \ main \ java \ com \ facebook \ fresco \ animation \ bitmap \ BitmapFrameCache . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n,Add @ Nullsafe to animation / bitmap \n Reviewed By : oprisnik \n Differential Revision : D24254676 \n fbshipit - source - id : 5187662001387582f42c8d7d61269d31aab1fbf1,47
fbcore \ src \ main \ java \ com \ facebook \ common \ references \ CloseableReference . java \n + import com . facebook . infer . annotation . FalseOnNull ; \n + @ FalseOnNull \n,Add @ FalseOnSafe to CloseableReference \n Reviewed By : oprisnik \n Differential Revision : D24254678 \n fbshipit - source - id : 0702d71a617635be09c48cc3ea21bcbbc26162c6,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ BaseProducerContext . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n - public < E > E getExtra ( String key , E valueIfNotFound ) { \n + public < E > E getExtra ( String key , @ Nullable E valueIfNotFound ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ Producer . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ ProducerContext . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n",Add @ Nullsafe to ProducerContext \n Reviewed By : oprisnik \n Differential Revision : D24254677 \n fbshipit - source - id : bfd7ed87cbfac3c92dd7c18075eccb73e5e88370,47
"fbcore \ src \ main \ java \ com \ facebook \ common \ webp \ WebpBitmapFactory . java \n + import javax . annotation . Nullable ; \n - Bitmap decodeFileDescriptor ( FileDescriptor fd , Rect outPadding , BitmapFactory . Options opts ) ; \n + Bitmap decodeFileDescriptor ( \n + FileDescriptor fd , @ Nullable Rect outPadding , BitmapFactory . Options opts ) ; \n imagepipeline - native \ src \ main \ java \ com \ facebook \ imagepipeline \ nativecode \ Bitmaps . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline - native \ src \ main \ java \ com \ facebook \ imagepipeline \ nativecode \ DalvikPurgeableDecoder . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline - native \ src \ main \ java \ com \ facebook \ imagepipeline \ nativecode \ ImagePipelineNativeLoader . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline - native \ src \ main \ java \ com \ facebook \ imagepipeline \ platform \ GingerbreadPurgeableDecoder . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n - Object rawFD = getFileDescriptorMethod ( ) . invoke ( memoryFile ) ; \n + Object rawFD = Preconditions . checkNotNull ( getFileDescriptorMethod ( ) . invoke ( memoryFile ) ) ; \n - byte [ ] suffix , \n + @ Nullable byte [ ] suffix , \n imagepipeline - native \ src \ main \ java \ com \ facebook \ imagepipeline \ platform \ KitKatPurgeableDecoder . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . LOCAL ) \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapCounter . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ BitmapCounterProvider . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ memory \ FlexByteArrayPool . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . LOCAL ) \n","Add @ Nullsafe to imagepipeline / { memory , playform } \n Reviewed By : oprisnik \n Differential Revision : D24250364 \n fbshipit - source - id : a4335244380b4866a3e2c331ed49f308c260499c",47
"fbcore \ src \ main \ java \ com \ facebook \ common \ internal \ Preconditions . java \n - public static void checkArgument ( boolean expression ) { \n - if ( ! expression ) { \n + public static void checkArgument ( @ Nullable Boolean expression ) { \n + if ( expression ! = null & & ! expression ) { \n - boolean expression , \n - @ Nullable String errorMessageTemplate , \n - @ Nullable Object . . . errorMessageArgs ) { \n + boolean expression , @ Nullable String errorMessageTemplate , Object . . . errorMessageArgs ) { \n - boolean expression , \n - @ Nullable String errorMessageTemplate , \n - @ Nullable Object . . . errorMessageArgs ) { \n + boolean expression , @ Nullable String errorMessageTemplate , Object . . . errorMessageArgs ) { \n - public static < T > T checkNotNull ( T reference ) { \n + public static < T > T checkNotNull ( @ Nullable T reference ) { \n - public static < T > T checkNotNull ( T reference , @ Nullable Object errorMessage ) { \n + public static < T > T checkNotNull ( @ Nullable T reference , @ Nullable Object errorMessage ) { \n - T reference , @ Nullable String errorMessageTemplate , @ Nullable Object . . . errorMessageArgs ) { \n + @ Nullable T reference , @ Nullable String errorMessageTemplate , Object . . . errorMessageArgs ) { \n - static String format ( @ Nullable String template , @ Nullable Object . . . args ) { \n + static String format ( @ Nullable String template , Object . . . args ) { \n",Clean up of Preconditions \n Reviewed By : wizh \n Differential Revision : D24249872 \n fbshipit - source - id : d90f71cbee8f0fa5829c70d8a45b028cbba3cbb4,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ CloseableReferenceFactory . java \n + import com . facebook . common . internal . Preconditions ; \n + import java . util . Objects ; \n - Object obj = reference . get ( ) ; \n + Object value = reference . get ( ) ; \n + String name = value ! = null ? value . getClass ( ) . getName ( ) : "" < value is null > "" ; \n - obj = = null ? null : obj . getClass ( ) . getName ( ) , \n + name , \n",Fix CloseableReferenceFactory leak reporting nullability issue \n Reviewed By : oprisnik \n Differential Revision : D24250470 \n fbshipit - source - id : e9528844486d1d7a8b0038dc289240138aa076b0,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n - public static < T > SwallowResultProducer < T > newSwallowResultProducer ( Producer < T > inputProducer ) { \n + public < T > SwallowResultProducer < T > newSwallowResultProducer ( Producer < T > inputProducer ) { \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactory . java \n - ProducerFactory . newSwallowResultProducer ( \n + mProducerFactory . newSwallowResultProducer ( \n - ProducerFactory . newSwallowResultProducer ( \n + mProducerFactory . newSwallowResultProducer ( \n,Minor : ProducerFactory : replace static with instance method \n Reviewed By : wizh \n Differential Revision : D24303369 \n fbshipit - source - id : aadfa63fffdaa6106d38452011a154acee9cf0a0,47
imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ image \ EncodedImage . java \n + private static boolean sUseCachedMetadata ; \n + \n + private boolean mHasParsedMetadata ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - parseMetaDataIfNeeded ( ) ; \n + parseMetadataIfNeeded ( ) ; \n - private void parseMetaDataIfNeeded ( ) { \n + private void parseMetadataIfNeeded ( ) { \n - / * * Sets the encoded image meta data . * / \n + if ( ! sUseCachedMetadata ) { \n + internalParseMetaData ( ) ; \n + return ; \n + } \n + \n + if ( mHasParsedMetadata ) { \n + return ; \n + } \n + internalParseMetaData ( ) ; \n + mHasParsedMetadata = true ; \n + } \n + \n + / * * Sets the encoded image meta data . * / \n + private void internalParseMetaData ( ) { \n + mHasParsedMetadata = encodedImage . hasParsedMetaData ( ) ; \n + \n + public static void setUseCachedMetadata ( boolean useCachedMetadata ) { \n + sUseCachedMetadata = useCachedMetadata ; \n + } \n + \n + protected boolean hasParsedMetaData ( ) { \n + return mHasParsedMetadata ; \n + } \n,Optionally cache EncodedImage parsed metadata \n Reviewed By : oprisnik \n Differential Revision : D24306305 \n fbshipit - source - id : 0264b1da6d1435248620e575a1762028cfee91e6,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ cache \ LruCountingMemoryCache . java \n - K key = Preconditions . checkNotNull ( mExclusiveEntries . getFirstKey ( ) ) ; \n + @ Nullable K key = mExclusiveEntries . getFirstKey ( ) ; \n + if ( key = = null ) { \n + throw new IllegalStateException ( \n + String . format ( \n + "" key is null , but exclusiveEntries count : % d , size : % d "" , \n + mExclusiveEntries . getCount ( ) , mExclusiveEntries . getSizeInBytes ( ) ) ) ; \n + } \n",MemoryCache : make null check exception more informative . \n Reviewed By : oprisnik \n Differential Revision : D24572650 \n fbshipit - source - id : 5f7933b1bd5ec54886815f9d98b935c6a235c71e,47
"imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ cache \ LruCountingMemoryCache . java \n - public @ Nullable String getDebugData ( ) { \n + public synchronized @ Nullable String getDebugData ( ) { \n - . add ( "" cached _ entries _ count : "" , mCachedEntries . getCount ( ) ) \n + . add ( "" cached _ entries _ count "" , mCachedEntries . getCount ( ) ) \n",Make reporting debug data synchronized in LruCountingMemoryCache \n Reviewed By : oprisnik \n Differential Revision : D24552555 \n fbshipit - source - id : 93abce4a5776903a30a648e9e14a500fd78437be,47
"vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ FrescoController2 . java \n + \n + import com . facebook . drawee . drawable . FadeDrawable ; \n + @ Nullable FadeDrawable . OnFadeListener onFadeListener , \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ impl \ FrescoController2Impl . java \n + import com . facebook . drawee . drawable . FadeDrawable ; \n + final @ Nullable FadeDrawable . OnFadeListener onFadeListener , \n + frescoDrawable . setOnFadeListener ( onFadeListener ) ; \n + \n vito \ core \ src \ main \ java \ com \ facebook \ fresco \ vito \ core \ impl \ FrescoDrawable2Impl . java \n + setOnFadeListener ( null ) ; \n vito \ litho \ src \ main \ java \ com \ facebook \ fresco \ vito \ litho \ FrescoVitoImage2Spec . java \n + import com . facebook . drawee . drawable . FadeDrawable ; \n + import com . facebook . fresco . ui . common . LoggingListener ; \n - \n - ComponentContext c , \n - final FrescoDrawable2 frescoDrawable , \n - @ Prop ( optional = true ) final @ Nullable Object callerContext , \n - @ Prop ( optional = true ) final @ Nullable ImageListener imageListener , \n - @ CachedValue VitoImageRequest imageRequest , \n - @ FromPrepare DataSource < Void > prefetchDataSource , \n - @ FromBoundsDefined Rect viewportDimensions , \n - @ State final @ Nullable AtomicReference < DataSource < Void > > workingRangePrefetchData ) { \n + ComponentContext c , \n + final FrescoDrawable2 frescoDrawable , \n + @ Prop ( optional = true ) final @ Nullable Object callerContext , \n + @ Prop ( optional = true ) final @ Nullable ImageListener imageListener , \n + @ CachedValue VitoImageRequest imageRequest , \n + @ FromPrepare DataSource < Void > prefetchDataSource , \n + @ FromBoundsDefined Rect viewportDimensions , \n + @ State final @ Nullable AtomicReference < DataSource < Void > > workingRangePrefetchData , \n + @ Prop ( optional = true ) FadeDrawable . OnFadeListener onFadeListener ) { \n - . fetch ( frescoDrawable , imageRequest , callerContext , imageListener , viewportDimensions ) ; \n + . fetch ( frescoDrawable , imageRequest , callerContext , imageListener , onFadeListener , viewportDimensions ) ; \n + @ Prop ( optional = true ) final @ Nullable FadeDrawable . OnFadeListener onFadeListener , \n - . fetch ( frescoDrawable , imageRequest , callerContext , imageListener , viewportDimensions ) ; \n + . fetch ( frescoDrawable , imageRequest , callerContext , imageListener , onFadeListener , viewportDimensions ) ; \n vito \ view \ src \ main \ java \ com \ facebook \ fresco \ vito \ view \ impl \ VitoViewImpl2 . java \n + null , \n",Add on fade listener prop to Vito \n Reviewed By : oprisnik \n Differential Revision : D23624272 \n fbshipit - source - id : 06cf6b164d7ae048f5d4bfcba7c1f8b002e437c3,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ FadeDrawable . java \n - if ( index = = mActualImageLayer ) { \n - maybeNotifyOnFadeStarted ( ) ; \n - } \n + maybeNotifyOnFadeStarted ( index ) ; \n + private void maybeNotifyOnFadeStarted ( int index ) { \n + if ( mOnFadeListener ! = null & & index = = mActualImageLayer & & mCallOnFadeStartedListener ) { \n + mOnFadeListener . onFadeStarted ( ) ; \n + mCallOnFadeStartedListener = false ; \n + } \n + } \n + \n - private void maybeNotifyOnFadeStarted ( ) { \n - if ( mOnFadeListener ! = null & & mCallOnFadeStartedListener ) { \n - mOnFadeListener . onFadeStarted ( ) ; \n - mCallOnFadeStartedListener = false ; \n - } \n - } \n - \n,Simplify on - fade listener \n Reviewed By : oprisnik \n Differential Revision : D23624271 \n fbshipit - source - id : 410ff5894737b6174e4510de0ae7cc87d2e812a6,47
"drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n - getControllerListener ( ) . onIntermediateImageSet ( id , getImageInfo ( image ) ) ; \n - getControllerListener2 ( ) . onIntermediateImageSet ( id , getImageInfo ( image ) ) ; \n + INFO info = getImageInfo ( image ) ; \n + getControllerListener ( ) . onIntermediateImageSet ( id , info ) ; \n + getControllerListener2 ( ) . onIntermediateImageSet ( id , info ) ; \n",Extract image info in reportIntermediateSet \n Reviewed By : oprisnik \n Differential Revision : D21500404 \n fbshipit - source - id : 32d08d98a5de779d128bdf274eb4abcdf6f3376f,47
"samples \ showcase \ src \ main \ java \ com \ facebook \ fresco \ samples \ showcase \ misc \ LogcatRequestListener2 . kt \n - \n - private fun toString ( producerContext : ProducerContext ) = "" id = $ { producerContext . id } , request = $ { producerContext . imageRequest } "" \n + \n + private fun toString ( producerContext : ProducerContext ) = producerContext . run { "" id = $ id , extras = $ extras , request = $ imageRequest "" } \n",Add extras to LogcatRequestListener2 \n Reviewed By : oprisnik \n Differential Revision : D21525047 \n fbshipit - source - id : fe7e232b88b3933181277e43e45ceebd1d92141d,47
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DiskCacheReadProducer . java \n - producerContext . putOriginExtra ( "" disk "" , "" result - is - nil "" ) ; \n + producerContext . putOriginExtra ( "" disk "" , "" nil - result _ read "" ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ DiskCacheWriteProducer . java \n + producerContext . putOriginExtra ( "" disk "" , "" nil - result _ write "" ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ EncodedMemoryCacheProducer . java \n - producerContext . putOriginExtra ( "" memory _ encoded "" ) ; \n + producerContext . putOriginExtra ( "" memory _ encoded "" , "" nil - result "" ) ; \n",Set origin in disk and encoded producers \n Reviewed By : oprisnik \n Differential Revision : D21525048 \n fbshipit - source - id : 5c7891ea9785da55628d58a781de400109b5eefc,47
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ producers \ MultiplexProducer . java \n + mMultiplexProducerContext . putExtras ( producerContext . getExtras ( ) ) ; \n,Copy initial extras from the first context to multiplex context \n Reviewed By : oprisnik \n Differential Revision : D22018172 \n fbshipit - source - id : 76335f426db1ab8920efedc57ad8dd75bac4c9ee,47
"animated - base \ src \ main \ java \ com \ facebook \ fresco \ animation \ bitmap \ wrapper \ AnimatedDrawableBackendFrameRenderer . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . LOCAL ) \n animated - base \ src \ main \ java \ com \ facebook \ imagepipeline \ animated \ base \ AnimatedDrawableBackend . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n - AnimatedDrawableBackend forNewBounds ( Rect bounds ) ; \n + AnimatedDrawableBackend forNewBounds ( @ Nullable Rect bounds ) ; \n animated - base \ src \ main \ java \ com \ facebook \ imagepipeline \ animated \ impl \ AnimatedDrawableBackendImpl . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . LOCAL ) \n - Rect bounds , \n + @ Nullable Rect bounds , \n - private static Rect getBoundsToUse ( AnimatedImage image , Rect targetBounds ) { \n + private static Rect getBoundsToUse ( AnimatedImage image , @ Nullable Rect targetBounds ) { \n - public AnimatedDrawableBackend forNewBounds ( Rect bounds ) { \n + public AnimatedDrawableBackend forNewBounds ( @ Nullable Rect bounds ) { \n - public CloseableReference < Bitmap > getPreDecodedFrame ( int frameNumber ) { \n + public @ Nullable CloseableReference < Bitmap > getPreDecodedFrame ( int frameNumber ) { \n - private synchronized void prepareTempBitmapForThisSize ( int width , int height ) { \n + private synchronized Bitmap prepareTempBitmapForThisSize ( int width , int height ) { \n + return mTempBitmap ; \n - frame . renderFrame ( frameWidth , frameHeight , mTempBitmap ) ; \n + if ( mTempBitmap ! = null ) { \n + frame . renderFrame ( frameWidth , frameHeight , mTempBitmap ) ; \n + } \n - canvas . drawBitmap ( mTempBitmap , mRenderSrcRect , mRenderDstRect , null ) ; \n + if ( mTempBitmap ! = null ) { \n + canvas . drawBitmap ( mTempBitmap , mRenderSrcRect , mRenderDstRect , null ) ; \n + } \n - prepareTempBitmapForThisSize ( frameWidth , frameHeight ) ; \n + mTempBitmap = prepareTempBitmapForThisSize ( frameWidth , frameHeight ) ; \n animated - base \ src \ main \ java \ com \ facebook \ imagepipeline \ animated \ impl \ AnimatedImageCompositor . java \n + import javax . annotation . Nullable ; \n + @ Nullable \n",@ Nullsafe : fresco / animation + imagepipeline / animated \n Reviewed By : wizh \n Differential Revision : D25533848 \n fbshipit - source - id : dcc1e4ccd356d03b09f09ea9c347b35909b5e47b,47
"fbcore \ src \ main \ java \ com \ facebook \ common \ internal \ Predicate . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n fbcore \ src \ main \ java \ com \ facebook \ common \ internal \ Supplier . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n imagepipeline - base \ src \ main \ java \ com \ facebook \ imagepipeline \ bitmaps \ PlatformBitmapFactory . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n - DisplayMetrics display , \n + @ Nullable DisplayMetrics display , \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ BasePostprocessor . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n - return CloseableReference . cloneOrNull ( destBitmapRef ) ; \n + return destBitmapRef . clone ( ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ Postprocessor . java \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . STRICT ) \n","@ Nullsafe : common / internal , postprocessor \n Reviewed By : oprisnik \n Differential Revision : D25532357 \n fbshipit - source - id : 464e5d6b32b9d59a1481a333ed54a4170646afff",47
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ info \ internal \ ImagePerfControllerListener2 . java \n + import com . facebook . common . internal . Preconditions ; \n + import com . facebook . infer . annotation . Nullsafe ; \n + @ Nullsafe ( Nullsafe . Mode . LOCAL ) \n + ImagePerfState state = ( ImagePerfState ) Preconditions . checkNotNull ( msg . obj ) ; \n - mNotifier . notifyStatusUpdated ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n + mNotifier . notifyStatusUpdated ( state , msg . arg1 ) ; \n - mNotifier . notifyListenersOfVisibilityStateUpdate ( ( ImagePerfState ) msg . obj , msg . arg1 ) ; \n + mNotifier . notifyListenersOfVisibilityStateUpdate ( state , msg . arg1 ) ; \n - Message msg = mHandler . obtainMessage ( ) ; \n + Message msg = Preconditions . checkNotNull ( mHandler ) . obtainMessage ( ) ; \n - Message msg = mHandler . obtainMessage ( ) ; \n + Message msg = Preconditions . checkNotNull ( mHandler ) . obtainMessage ( ) ; \n - mHandler = new LogHandler ( handlerThread . getLooper ( ) , mImagePerfNotifier ) ; \n + Looper looper = Preconditions . checkNotNull ( handlerThread . getLooper ( ) ) ; \n + mHandler = new LogHandler ( looper , mImagePerfNotifier ) ; \n",@ Nullsafe : internal / ImagePerfControllerListener2 \n Reviewed By : oprisnik \n Differential Revision : D25557559 \n fbshipit - source - id : 279df9fb7304a2daa327d9dcb26b65b22d44af3b,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ FadeDrawable . java \n + if ( mActualImageLayer < 0 | | mActualImageLayer > = mIsLayerOn . length ) { \n + return ; \n + } \n,Fix ArrayIndexOutOfBoundsException in FadeDrawable # onFadeStarted \n Reviewed By : oprisnik \n Differential Revision : D25657219 \n fbshipit - source - id : 954da372cd88e71c407b84b24338ce1e55b6305a,47
drawee \ src \ main \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeController . java \n + @ Override \n + public void onShownImmediately ( ) { } \n + \n drawee \ src \ main \ java \ com \ facebook \ drawee \ drawable \ FadeDrawable . java \n + private boolean mOnFadeListenerShowImmediately ; \n + if ( index = = mActualImageLayer ) { \n + mOnFadeListenerShowImmediately = true ; \n + } \n - onFadeStarted ( ) ; \n + maybeOnFadeStarted ( ) ; \n - onFadeFinished ( ) ; \n + maybeOnFadeFinished ( ) ; \n + maybeOnImageShownImmediately ( ) ; \n + private void maybeOnImageShownImmediately ( ) { \n + if ( ! mOnFadeListenerShowImmediately ) { \n + return ; \n + } \n + \n + if ( mTransitionState = = TRANSITION _ NONE & & mIsLayerOn [ mActualImageLayer ] ) { \n + if ( mOnFadeListener ! = null ) { \n + mOnFadeListener . onShownImmediately ( ) ; \n + } \n + mOnFadeListenerShowImmediately = false ; \n + } \n + } \n + \n - private void onFadeStarted ( ) { \n + private void maybeOnFadeStarted ( ) { \n - private void onFadeFinished ( ) { \n + private void maybeOnFadeFinished ( ) { \n + \n + void onShownImmediately ( ) ; \n,On fade listener : add on shown callback \n Differential Revision : D25433862 \n fbshipit - source - id : dcc8c4184ade1006e73f7bb0b5adebf4eb41db38,47
"core \ java \ android \ net \ vcn \ VcnManager . java \n + * < p > A VCN creates a virtualization layer to allow MVNOs to aggregate heterogeneous physical \n + * networks , unifying them as a single carrier network . This enables infrastructure flexibility on \n + * the part of MVNOs without impacting user connectivity , abstracting the physical network \n + * technologies as an implementation detail of their public network . \n + * \n + * < p > Each VCN virtualizes an Carrier ' s network by building tunnels to a carrier ' s core network over \n + * carrier - managed physical links and supports a IP mobility layer to ensure seamless transitions \n + * between the underlying networks . Each VCN is configured based on a Subscription Group ( see { @ link \n + * android . telephony . SubscriptionManager } ) and aggregates all networks that are brought up based on \n + * a profile or suggestion in the specified Subscription Group . \n + * \n + * < p > The VCN can be configured to expose one or more { @ link android . net . Network } ( s ) , each with \n + * different capabilities , allowing for APN virtualization . \n + * \n + * < p > If a tunnel fails to connect , or otherwise encounters a fatal error , the VCN will attempt to \n + * reestablish the connection . If the tunnel still has not reconnected after a system - determined \n + * timeout , the VCN Safe Mode ( see below ) will be entered . \n + * \n + * < p > The VCN Safe Mode ensures that users ( and carriers ) have a fallback to restore system \n + * connectivity to update profiles , diagnose issues , contact support , or perform other remediation \n + * tasks . In Safe Mode , the system will allow underlying cellular networks to be used as default . \n + * Additionally , during Safe Mode , the VCN will continue to retry the connections , and will \n + * automatically exit Safe Mode if all active tunnels connect successfully . \n + * \n","Add additional javadoc for VcnManager \n This change adds additional detail for the VCN , describing feature set , \n use cases and fail - safe modes . \n Bug : 163431877 \n Test : Compiles , Boots ( Comment - only change ) \n Change - Id : I1f82267c20dbbf5875ae27117debdb58f7b96e57",61
telephony \ java \ android \ telephony \ SubscriptionManager . java \n + @ NonNull \n - result = new ArrayList < > ( ) ; \n + result = Collections . emptyList ( ) ; \n,"Add NonNull annotation to getAllSubscriptionInfoList \n This change marks getAllSubscriptionInfoList as NonNull ; the method \n already catches all exceptions , and returns an empty ArrayList if \n something failed . \n Test : atest FrameworksTelephonyTest \n Change - Id : I7799d05f0f1f249fa5f4a47a3f4ff2c2691c75dc",61
services \ core \ java \ com \ android \ server \ OWNERS \n + per - file VcnManagementService . java = file : / services / core / java / com / android / server / vcn / OWNERS \n,Add VcnManagementService owners \n Test : No code changes \n Change - Id : I3c1ff347dbddb2a41c186ea8d18133990e39f7c4,61
new file \n core \ java \ android \ net \ vcn \ OWNERS \n + set noparent \n + \n + benedictwong @ google . com \n + ckesting @ google . com \n + evitayan @ google . com \n + nharold @ google . com \n + jchalard @ google . com \n,Add VCN file owners for android . net . vcn \n This change adds owners for the VCN files in the android . net . vcn package \n Bug : 163431877 \n Test : No code changes ; FrameworksNetTests passing \n Change - Id : I7406083b958a9fd5f1b02c2e2046a9c686622f60,61
"services \ core \ java \ com \ android \ server \ vcn \ Vcn . java \n - / / TODO : STOPSHIP : Make this use new NetworkSelection , or some magic "" max in subGrp "" value \n + / / TODO : STOPSHIP ( b / 173549607 ) : Make this use new NetworkSelection , or some magic "" max in \n + / / subGrp "" value \n",Add bug number to stopship comment for VCN Network scores \n Test : atest FrameworksVcnTests \n Change - Id : I7a637d39e7be2d59e53a1e3bd801c19b9163661d,61
core \ java \ android \ net \ LinkProperties . java \n - / * package - visibility - Used in other files ( such as Ikev2VpnProfile ) as minimum iface MTU . * / \n - static final int MIN _ MTU _ V6 = 1280 ; \n + \n + / * * @ hide * / \n + public static final int MIN _ MTU _ V6 = 1280 ; \n + \n,"Expose MIN _ MTU _ V6 as a public , @ hide constant \n MIN _ MTU _ V6 is increasingly used , and the LinkProperties version is used \n as a source of truth for the constant . \n Bug : 163602123 \n Test : atest FrameworksNetTests \n Change - Id : I67134cd4fb7e2cf59c36947b62f681ac9b94ea4a",61
"services \ core \ java \ com \ android \ server \ vcn \ VcnGatewayConnection . java \n - / / TODO ( b / 180163196 ) : Set underlying network of tunnel interface \n + tunnelIface . setUnderlyingNetwork ( underlyingNetwork ) ; \n tests \ vcn \ java \ com \ android \ server \ vcn \ VcnGatewayConnectionConnectedStateTest . java \n + import static org . mockito . Mockito . times ; \n + verify ( mIpSecSvc , times ( 2 ) ) \n + . setNetworkForTunnelInterface ( \n + eq ( TEST _ IPSEC _ TUNNEL _ RESOURCE _ ID ) , \n + eq ( TEST _ UNDERLYING _ NETWORK _ RECORD _ 1 . network ) , \n + any ( ) ) ; \n + \n + \n",Call setUnderlyingNetwork to complete VCN MOBIKE \n This change updates the underlying network for the VCN in order to \n ensure full MOBIKE switches are handled . \n Bug : 169788130 \n Test : atest FrameworksVcnTests \n Change - Id : Ib439bde4217beeb28f425c08ed9f3376dfe0033c,61
"services \ core \ java \ com \ android \ server \ vcn \ VcnGatewayConnection . java \n - import android . net . ConnectivityManager ; \n - import android . net . NetworkInfo ; \n - import android . net . NetworkInfo . DetailedState ; \n - import android . telephony . TelephonyManager ; \n - mNetworkAgent . sendNetworkInfo ( buildNetworkInfo ( false / * isConnected * / ) ) ; \n + mNetworkAgent . unregister ( ) ; \n - / / TODO : Remove this when migrating to new NetworkAgent API \n - private static NetworkInfo buildNetworkInfo ( boolean isConnected ) { \n - NetworkInfo info = \n - new NetworkInfo ( \n - ConnectivityManager . TYPE _ MOBILE , \n - TelephonyManager . NETWORK _ TYPE _ UNKNOWN , \n - "" MOBILE "" , \n - "" VCN "" ) ; \n - info . setDetailedState ( \n - isConnected ? DetailedState . CONNECTED : DetailedState . DISCONNECTED , null , null ) ; \n - \n - return info ; \n - } \n - \n",Remove usage of NetworkInfo \n Remove usages of deprecated APIs \n Bug : 8675309 \n Test : atest FrameworksVcnTests \n Change - Id : Iaaef109d00c111da2396c3eec946cfc5035f415e,61
framework - jarjar - rules . txt \n + rule com . android . server . vcn . util . * * com . android . server . vcn . repackaged . util . @ 1 \n,Repackage vcn utils in frameworks - minus - apex \n Bug : 176170669 \n Test : atest CtsStrictJavaPackagesTestCases \n Change - Id : Iae303d0fd439ade25ecc3ef2710090be785bb1ca,61
"services \ java \ com \ android \ server \ SystemServer . java \n - t . traceBegin ( "" StartVcnManagementService "" ) ; \n - try { \n - vcnManagement = VcnManagementService . create ( context ) ; \n - ServiceManager . addService ( Context . VCN _ MANAGEMENT _ SERVICE , vcnManagement ) ; \n - } catch ( Throwable e ) { \n - reportWtf ( "" starting VCN Management Service "" , e ) ; \n - } \n - t . traceEnd ( ) ; \n - \n + t . traceBegin ( "" StartVcnManagementService "" ) ; \n + try { \n + vcnManagement = VcnManagementService . create ( context ) ; \n + ServiceManager . addService ( Context . VCN _ MANAGEMENT _ SERVICE , vcnManagement ) ; \n + } catch ( Throwable e ) { \n + reportWtf ( "" starting VCN Management Service "" , e ) ; \n + } \n + t . traceEnd ( ) ; \n + \n - t . traceBegin ( "" MakeVcnManagementServiceReady "" ) ; \n - try { \n - if ( vcnManagementF ! = null ) { \n - vcnManagementF . systemReady ( ) ; \n - } \n - } catch ( Throwable e ) { \n - reportWtf ( "" making VcnManagementService ready "" , e ) ; \n - } \n - t . traceEnd ( ) ; \n + t . traceBegin ( "" MakeVcnManagementServiceReady "" ) ; \n + try { \n + if ( vcnManagementF ! = null ) { \n + vcnManagementF . systemReady ( ) ; \n + } \n + } catch ( Throwable e ) { \n + reportWtf ( "" making VcnManagementService ready "" , e ) ; \n + } \n + t . traceEnd ( ) ; \n",Start VcnManagementService after ConnectivityService \n This change alters the start - up order of the VCN and Connectivity \n services . \n Bug : 174636568 \n Test : atest FrameworksVcnTests \n Test : atest FrameworksNetTests \n Change - Id : I1af29d52b94e77781eb2bf2082fcbe43648ee800 \n Merged - In : I1af29d52b94e77781eb2bf2082fcbe43648ee800,61
"services \ core \ java \ com \ android \ server \ vcn \ Vcn . java \n + import static com . android . server . VcnManagementService . VDBG ; \n - Slog . v ( getLogTag ( ) , String . format ( "" Config updated : config = % s "" , config . hashCode ( ) ) ) ; \n + Slog . v ( getLogTag ( ) , "" Config updated : config = "" + config . hashCode ( ) ) ; \n - Slog . v ( getLogTag ( ) , \n - "" Request already satisfied by higher - scoring ( "" + score + "" ) network from "" \n - + "" provider "" + providerId + "" : "" + request ) ; \n + if ( VDBG ) { \n + Slog . v ( \n + getLogTag ( ) , \n + "" Request already satisfied by higher - scoring ( "" \n + + score \n + + "" ) network from "" \n + + "" provider "" \n + + providerId \n + + "" : "" \n + + request ) ; \n + } \n - Slog . v ( getLogTag ( ) , \n - "" Request already satisfied by existing VcnGatewayConnection : "" + request ) ; \n + if ( VDBG ) { \n + Slog . v ( \n + getLogTag ( ) , \n + "" Request already satisfied by existing VcnGatewayConnection : "" \n + + request ) ; \n + } \n - return String . format ( "" % s [ % d ] "" , TAG , mSubscriptionGroup . hashCode ( ) ) ; \n + return TAG + "" [ "" + mSubscriptionGroup . hashCode ( ) + "" ] "" ; \n services \ core \ java \ com \ android \ server \ vcn \ VcnNetworkProvider . java \n + import static com . android . server . VcnManagementService . VDBG ; \n + \n - Slog . v ( \n - TAG , \n - String . format ( \n - "" Network requested : Request = % s , score = % d , providerId = % d "" , \n - request , score , providerId ) ) ; \n + if ( VDBG ) { \n + Slog . v ( \n + TAG , \n + "" Network requested : Request = "" \n + + request \n + + "" , score = "" \n + + score \n + + "" , providerId = "" \n + + providerId ) ; \n + } \n",VDBG guard common verbose logging in Vcn \n This change ensures that debugging logs are not fired for the most \n common of cases . \n Test : atest FrameworksVcnTests \n Change - Id : I101d8949d5cfcf6d6cec5289ebc613c863d062e5,61
"services \ core \ java \ com \ android \ server \ vcn \ VcnGatewayConnection . java \n + @ VisibleForTesting ( visibility = Visibility . PRIVATE ) \n + static final InetAddress DUMMY _ ADDR = InetAddresses . parseNumericAddress ( "" 192 . 0 . 2 . 0 "" ) ; \n + \n - \n - private static final InetAddress DUMMY _ ADDR = InetAddresses . parseNumericAddress ( "" 192 . 0 . 2 . 0 "" ) ; \n - \n - @ NonNull private final IpSecTunnelInterface mTunnelIface ; \n + \n + @ Nullable private IpSecTunnelInterface mTunnelIface = null ; \n - IpSecTunnelInterface iface ; \n - try { \n - iface = \n - mIpSecManager . createIpSecTunnelInterface ( \n - DUMMY _ ADDR , DUMMY _ ADDR , new Network ( - 1 ) ) ; \n - } catch ( IOException | ResourceUnavailableException e ) { \n - teardownAsynchronously ( ) ; \n - mTunnelIface = null ; \n - \n - return ; \n - } \n - \n - mTunnelIface = iface ; \n - \n + if ( mTunnelIface = = null ) { \n + try { \n + / / Requires a real Network object in order to be created ; doing this any earlier \n + / / means not having a real Network object , or picking an incorrect Network . \n + mTunnelIface = \n + mIpSecManager . createIpSecTunnelInterface ( \n + DUMMY _ ADDR , DUMMY _ ADDR , mUnderlying . network ) ; \n + } catch ( IOException | ResourceUnavailableException e ) { \n + teardownAsynchronously ( ) ; \n + } \n + } \n + \n + @ VisibleForTesting ( visibility = Visibility . PRIVATE ) \n + void setTunnelInterface ( IpSecTunnelInterface tunnelIface ) { \n + mTunnelIface = tunnelIface ; \n + } \n + \n tests \ vcn \ java \ com \ android \ server \ vcn \ VcnGatewayConnectionDisconnectedStateTest . java \n + import static android . net . IpSecManager . IpSecTunnelInterface ; \n + \n + import static com . android . server . vcn . VcnGatewayConnection . DUMMY _ ADDR ; \n + \n + import android . net . IpSecManager ; \n + \n + final IpSecTunnelInterface tunnelIface = \n + mContext . getSystemService ( IpSecManager . class ) \n + . createIpSecTunnelInterface ( \n + DUMMY _ ADDR , DUMMY _ ADDR , TEST _ UNDERLYING _ NETWORK _ RECORD _ 1 . network ) ; \n + mGatewayConnection . setTunnelInterface ( tunnelIface ) ; \n","Lazy - create IpSecTunnelInterface \n With the Network ( int ) constructor moving to mainline , we cannot use the \n constructor , and should just create the IpSecTunnelInterface lazily , at \n first use . \n Bug : 165827287 \n Test : atest FrameworksVcnTests \n Change - Id : Ic01858e0f9c80d316676cfbae5edca114655c3fe",61
"services \ core \ java \ com \ android \ server \ vcn \ VcnGatewayConnection . java \n - / / TODO : Set underlying network of tunnel interface \n + / / TODO ( b / 180163196 ) : Set underlying network of tunnel interface \n + Slog . v ( TAG , "" Migrating to new network : "" + mUnderlying . network ) ; \n + @ Override \n + public void onIpSecTransformsMigrated ( \n + @ NonNull IpSecTransform inIpSecTransform , \n + @ NonNull IpSecTransform outIpSecTransform ) { \n + Slog . v ( TAG , "" ChildTransformsMigrated ; token "" + mToken ) ; \n + onIpSecTransformCreated ( inIpSecTransform , IpSecManager . DIRECTION _ IN ) ; \n + onIpSecTransformCreated ( outIpSecTransform , IpSecManager . DIRECTION _ OUT ) ; \n + } \n + \n tests \ vcn \ java \ com \ android \ server \ vcn \ VcnGatewayConnectionConnectedStateTest . java \n + @ Test \n + public void testMigratedTransformsAreApplied ( ) throws Exception { \n + getChildSessionCallback ( ) \n + . onIpSecTransformsMigrated ( makeDummyIpSecTransform ( ) , makeDummyIpSecTransform ( ) ) ; \n + mTestLooper . dispatchAll ( ) ; \n + \n + for ( int direction : new int [ ] { DIRECTION _ IN , DIRECTION _ OUT } ) { \n + verify ( mIpSecSvc ) \n + . applyTunnelModeTransform ( \n + eq ( TEST _ IPSEC _ TUNNEL _ RESOURCE _ ID ) , eq ( direction ) , anyInt ( ) , any ( ) ) ; \n + } \n + assertEquals ( mGatewayConnection . mConnectedState , mGatewayConnection . getCurrentState ( ) ) ; \n + } \n + \n","Implement ChildSessionCallback # onIpSecTransformsMigrated \n This change implements the Migrated callback , proxying to \n onIpSecTransformCreated \n Bug : 180163196 \n Test : atest FrameworksVcnTests \n Change - Id : Ibf07be667882ea35a4d7191b87d1193f38f9db3e",61
telephony \ java \ android \ telephony \ ims \ stub \ ImsConfigImplBase . java \n - if ( mProvisionedIntValue . containsKey ( item ) ) { \n + if ( mProvisionedStringValue . containsKey ( item ) ) { \n,Fix incorrect cache checking of string config values \n Bug : 174541711 \n Test : atest CtsTelephonyTestCases : ImsServiceTest \n Change - Id : Idca646dc7cbd562b357092967245cd7aa48a7c86,71
"telephony \ java \ android \ telephony \ ims \ ImsRcsManager . java \n + import android . os . ServiceSpecificException ; \n + } catch ( ServiceSpecificException e ) { \n + throw new ImsException ( e . toString ( ) , e . errorCode ) ; \n + \n + } catch ( ServiceSpecificException e ) { \n + throw new ImsException ( e . toString ( ) , e . errorCode ) ; \n telephony \ java \ android \ telephony \ ims \ RcsUceAdapter . java \n + import android . os . ServiceSpecificException ; \n + } catch ( ServiceSpecificException e ) { \n + throw new ImsException ( e . toString ( ) , e . errorCode ) ; \n + } catch ( ServiceSpecificException e ) { \n + throw new ImsException ( e . toString ( ) , e . errorCode ) ; \n - } catch ( android . os . ServiceSpecificException e ) { \n + } catch ( ServiceSpecificException e ) { \n - } catch ( android . os . ServiceSpecificException e ) { \n + } catch ( ServiceSpecificException e ) { \n",Catch SSE when no subId is loaded \n Correctly catch SSEs in ImsRcsManager and RcsUceAdapter and rethrow \n as checked ImsExceptions instead of using RuntimeExceptions . \n Fixes : 173436604 \n Test : atest CtsTelephonyTestCases : ImsServiceTest \n Change - Id : I80dde5556c1239f89a258b0f57f7feceb142aec7,71
"telephony \ java \ android \ telephony \ CallForwardingInfo . java \n - @ IntDef ( flag = true , prefix = { "" REASON _ "" } , value = { \n + @ IntDef ( prefix = { "" REASON _ "" } , value = { \n telephony \ java \ android \ telephony \ TelephonyManager . java \n - @ IntDef ( flag = true , prefix = { "" CDMA _ SUBSCRIPTION _ "" } , value = { \n + @ IntDef ( prefix = { "" CDMA _ SUBSCRIPTION _ "" } , value = { \n telephony \ java \ android \ telephony \ ims \ ImsExternalCallState . java \n - @ IntDef ( flag = true , \n - value = { \n + @ IntDef ( value = { \n - @ IntDef ( flag = true , \n - value = { \n + @ IntDef ( value = { \n telephony \ java \ android \ telephony \ ims \ ImsSsData . java \n - @ IntDef ( flag = true , prefix = { "" SS _ "" } , value = { \n + @ IntDef ( prefix = { "" SS _ "" } , value = { \n - @ IntDef ( flag = true , prefix = { "" SS _ "" } , value = { \n + @ IntDef ( prefix = { "" SS _ "" } , value = { \n - @ IntDef ( flag = true , prefix = { "" SS _ "" } , value = { \n + @ IntDef ( prefix = { "" SS _ "" } , value = { \n telephony \ java \ android \ telephony \ ims \ stub \ ImsRegistrationImplBase . java \n - @ IntDef ( flag = true , \n - value = { \n + @ IntDef ( value = { \n","Fix intdefs that were incorrectly defining "" flag "" \n Fixes : 174238227 \n Test : docs only change , build success \n Change - Id : I0f95aadd63ae315ffdf534e4579c4b8e64b94672",71
"core \ api \ current . txt \n + field public static final String KEY _ ENABLE _ PRESENCE _ PUBLISH _ BOOL = "" ims . enable _ presence _ publish _ bool "" ; \n telephony \ java \ android \ telephony \ CarrierConfigManager . java \n - * Flag indicating whether the carrier supports RCS presence indication for \n - * User Capability Exchange ( UCE ) . When presence is supported , the device should use the \n + * Flag indicating whether or not the carrier supports the periodic exchange of phone numbers \n + * in the user ' s address book with the carrier ' s presence server in order to retrieve the RCS \n + * capabilities for each contact used in the RCS User Capability Exchange ( UCE ) procedure . See \n + * RCC . 71 , section 3 for more information . \n + * < p > \n + * The flag { @ link Ims # KEY _ ENABLE _ PRESENCE _ PUBLISH _ BOOL } must also be enabled if this flag is \n + * enabled , as sending a periodic SIP PUBLISH with this device ' s RCS capabilities is a \n + * requirement for capability exchange to begin . \n + * < p > \n + * When presence is supported , the device should use the \n + / * * \n + * A boolean flag specifying whether or not this carrier supports the device notifying the \n + * network of its RCS capabilities using the SIP PUBLISH procedure defined for User \n + * Capability Exchange ( UCE ) . See RCC . 71 , section 3 for more information . \n + * < p > \n + * If this key ' s value is set to false , the procedure for RCS contact capability exchange \n + * via SIP SUBSCRIBE / NOTIFY will also be disabled internally , and \n + * { @ link # KEY _ USE _ RCS _ PRESENCE _ BOOL } must also be set to false to ensure apps do not \n + * improperly think that capability exchange via SIP PUBLISH is enabled . \n + * < p > The default value for this key is { @ code false } . \n + * / \n + public static final String KEY _ ENABLE _ PRESENCE _ PUBLISH _ BOOL = \n + KEY _ PREFIX + "" enable _ presence _ publish _ bool "" ; \n + \n + defaults . putBoolean ( KEY _ ENABLE _ PRESENCE _ PUBLISH _ BOOL , false ) ; \n","Add new carrier config option for enabling SIP PUBLISH of RCS caps \n Adds a new carrier config option that will bring up / down the service \n connection to the vendor IMS stack . When down , we should not \n see the vendor IMS stack generate SIP PUBLISH requests to the network . \n This is so that we do not generate SIP PUBLISH requests on networks \n that do not support this functionality . \n Bug : 173115560 \n Test : atest CarrierConfigTests \n Merged - In : If9ab9836261afc2d6cebb959690d8b44b06a3dfe \n Change - Id : If9ab9836261afc2d6cebb959690d8b44b06a3dfe",71
core \ api \ system - current . txt \n + method public void triggerSipDelegateDeregistration ( ) ; \n + method public void updateSipDelegateRegistration ( ) ; \n telephony \ java \ android \ telephony \ ims \ aidl \ IImsRegistration . aidl \n - } \n + oneway void triggerUpdateSipDelegateRegistration ( ) ; \n + oneway void triggerSipDelegateDeregistration ( ) ; \n + } \n telephony \ java \ android \ telephony \ ims \ stub \ ImsRegistrationImplBase . java \n + * < p > \n + * Note : There is no guarantee on the thread that the calls from the framework will be called on . It \n + * is the implementors responsibility to handle moving the calls to a working thread if required . \n + \n + @ Override \n + public void triggerUpdateSipDelegateRegistration ( ) { \n + ImsRegistrationImplBase . this . updateSipDelegateRegistration ( ) ; \n + } \n + \n + @ Override \n + public void triggerSipDelegateDeregistration ( ) { \n + ImsRegistrationImplBase . this . triggerSipDelegateDeregistration ( ) ; \n + } \n - * @ hide \n - * @ hide \n,Expose APIs for SipTransport registration management \n Bug : 154763999 \n Test : atest CtsTelephonyTestCases : SipDelegateManagerTest \n Change - Id : Iabd0ce70fa3b2ce961fdf0bd05659f7ba936d798,71
"telephony \ java \ android \ telephony \ ims \ DelegateRegistrationState . java \n + \n + @ Override \n + public String toString ( ) { \n + return "" DelegateRegistrationState { registered = { "" + mRegisteredTags \n + + "" } , deregistering = { "" + mDeregisteringTags + "" } , deregistered = { "" \n + + mDeregisteredTags + "" } } "" ; \n + } \n",Improve RCS single registration logging \n Test : manual - verify logs with CTS tests \n Change - Id : I14c5a38ef00bc9858945e979d081ae15ac46051c,71
"core \ api \ system - current . txt \n + field public static final String KEY _ SIP _ CONFIG _ CELLULAR _ NETWORK _ INFO _ HEADER _ STRING = "" sip _ config _ cellular _ network _ info _ header _ string "" ; \n + field public static final String KEY _ SIP _ CONFIG _ USER _ AGENT _ HEADER _ STRING = "" sip _ config _ sip _ user _ agent _ header _ string "" ; \n telephony \ java \ android \ telephony \ ims \ SipDelegateImsConfiguration . java \n + / * * \n + * The SIP User - Agent header value used by the IMS stack during IMS registration . \n + * / \n + public static final String KEY _ SIP _ CONFIG _ USER _ AGENT _ HEADER _ STRING = \n + "" sip _ config _ sip _ user _ agent _ header _ string "" ; \n + \n - * SIP P - last - access - network - info header string \n + * The SIP P - last - access - network - info header value , populated for networks that require this \n + * information to be provided in outgoing SIP messages . \n + / * * \n + * The Cellular - Network - Info header value ( See 3GPP 24 . 229 , section 7 . 2 . 15 ) , populated for \n + * networks that require this information to be provided as part of outgoing SIP messages . \n + * / \n + public static final String KEY _ SIP _ CONFIG _ CELLULAR _ NETWORK _ INFO _ HEADER _ STRING = \n + "" sip _ config _ cellular _ network _ info _ header _ string "" ; \n + \n + KEY _ SIP _ CONFIG _ USER _ AGENT _ HEADER _ STRING , \n + KEY _ SIP _ CONFIG _ CELLULAR _ NETWORK _ INFO _ HEADER _ STRING , \n",Add SIP configration Bundle keys for UA and CNI \n Adds IMS SIP configuration bundle keys for User - Agent and \n Cellular - Network - Info headers required by some networks . \n Bug : 178606181 \n Test : atest CtsTelephonyTestCases : SipDelegateManagerTest \n Change - Id : I389162ca0c6348580f6ee8bb6ce5ee3a4e84595e,71
"telephony \ java \ android \ telephony \ ims \ stub \ ImsEcbmImplBase . java \n - if ( mImsEcbm ! = null & & listener ! = null & & Objects . equals ( \n - mImsEcbm . asBinder ( ) , listener . asBinder ( ) ) ) { \n + if ( mListener ! = null & & ! mListener . asBinder ( ) . isBinderAlive ( ) ) { \n + Log . w ( TAG , "" setListener : discarding dead Binder "" ) ; \n + mListener = null ; \n + } \n + if ( mListener ! = null & & listener ! = null & & Objects . equals ( \n + mListener . asBinder ( ) , listener . asBinder ( ) ) ) { \n telephony \ java \ android \ telephony \ ims \ stub \ ImsMultiEndpointImplBase . java \n + if ( mListener ! = null & & ! mListener . asBinder ( ) . isBinderAlive ( ) ) { \n + Log . w ( TAG , "" setListener : discarding dead Binder "" ) ; \n + mListener = null ; \n + } \n telephony \ java \ android \ telephony \ ims \ stub \ ImsUtImplBase . java \n + import android . util . Log ; \n + private static final String TAG = "" ImsUtImplBase "" ; \n + if ( mUtListener ! = null \n + & & ! mUtListener . getListenerInterface ( ) . asBinder ( ) . isBinderAlive ( ) ) { \n + Log . w ( TAG , "" setListener : discarding dead Binder "" ) ; \n + mUtListener = null ; \n + } \n","Discard dead MmTelFeature Binder Instances \n When the phone process crashes and the IMS service is in \n a separate process , there is a condition where the ImsService may \n still stay unbound , but alive and not torn down . In this case , \n when the phone process comes back up and tries to register new \n binder callbacks , detect that the old binder callbacks are dead \n and discard instead of throwing an exception . \n Bug : 179217608 \n Test : kill phone process \n Change - Id : I4fc3b6d15fe19ebaf1fc52dab92a615a761222f8",71
README . md \n - compile ' io . realm : realm - android : 0 . 81 . 2 - SNAPSHOT ' \n + compile ' io . realm : realm - android : 0 . 82 . 0 - SNAPSHOT ' \n version . txt \n - 0 . 81 . 2 - SNAPSHOT \n + 0 . 82 . 0 - SNAPSHOT \n,Bump version to 0 . 82 . 0 - SNAPSHOT,80
"changelog . txt \n + * Realm . compactRealm ( ) doesn ' t throw an exception if the Realm file is opened . It just returns false instead . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTest . java \n - Realm . compactRealm ( configuration ) ; \n + assertTrue ( Realm . compactRealm ( configuration ) ) ; \n - public void testCompactRealmFileThrowsIfOpen ( ) throws IOException { \n - try { \n - Realm . compactRealm ( TestHelper . createConfiguration ( getContext ( ) ) ) ; \n - fail ( ) ; \n - } catch ( IllegalStateException expected ) { \n - } \n + public void testCompactRealmFileFailsIfOpen ( ) throws IOException { \n + assertFalse ( Realm . compactRealm ( TestHelper . createConfiguration ( getContext ( ) ) ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n - public static boolean compactRealm ( final RealmConfiguration configuration ) { \n + static boolean compactRealm ( final RealmConfiguration configuration ) { \n - final AtomicBoolean result = new AtomicBoolean ( false ) ; \n - \n - RealmCache . invokeWithGlobalRefCount ( configuration , new RealmCache . Callback ( ) { \n - @ Override \n - public void onResult ( int count ) { \n - if ( count ! = 0 ) { \n - throw new IllegalStateException ( "" Cannot compact an open Realm "" ) ; \n - } \n - result . set ( SharedGroupManager . compact ( configuration ) ) ; \n - } \n - } ) ; \n - \n - return result . get ( ) ; \n + return SharedGroupManager . compact ( configuration ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ Realm . java \n - * The file must be closed before this method is called . < br > \n + * The file must be closed before this method is called , otherwise { @ code false } will be returned . < br > \n + * @ throws IllegalArgumentException if the realm file is encrypted . Compacting an encrypted Realm file is not \n + * supported yet . \n",compact returns false if the file is opened \n Core will guarantee the file is not opened while compacting . \n Core also guarantee opening Realm will be blocked until compacting \n finished .,80
"changelog . txt \n - * Updated Realm core to version 0 . 89 . 8 \n + * Updated Realm core to version 0 . 89 . 9 \n - Fixed a potential stack overflow issue which might cause a crash when encryption was used . \n - Embedded crypto functions into Realm dynamic lib to avoid random issues on some devices . \n - Throw RealmEncryptionNotSupportedException if the device doesn ' t support Realm encryption . At least one device type ( HTX One X ) contains system bugs that prevents Realm ' s encryption from functioning properly . This is now detected , and an exception is thrown when trying to open / create an encrypted Realm file . It ' s up to the application to catch this and decide if it ' s OK to proceed without encryption instead . \n realm - jni \ build . gradle \n - ext . coreVersion = ' 0 . 89 . 8 ' \n + ext . coreVersion = ' 0 . 89 . 9 ' \n",Update core to 0 . 89 . 9,80
changelog . txt \n + * Fixed an issue preventing the call of listeners on refresh ( ) . \n + \n + 0 . 82 . 2 \n - * Fixed an issue preventing the call of listeners on refresh ( ) . \n - Fixed a potential stack overflow issue which might cause a crash when encryption was used . \n - Embedded crypto functions into Realm dynamic lib to avoid random issues on some devices . \n,Add 0 . 82 . 2 to master change log,80
realm \ src \ main \ java \ io \ realm \ Realm . java \n - sendNotifications ( ) ; \n,Fix sendNotifications called twice \n This is caused by 54501237b3 which doesn ' t seem to be right behaviour .,80
realm \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + / / Listener should only be called once \n + assertFalse ( success . get ( ) ) ; \n,"Test case for Immediate Notifications \n Listener should only be called once if the transaction happens in the \n same thread , same handler .",80
"realm \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + public void testAddDuplicatedListener ( ) throws InterruptedException , ExecutionException { \n + final AtomicInteger counter = new AtomicInteger ( 0 ) ; \n + RealmChangeListener listener = new RealmChangeListener ( ) { \n + @ Override \n + public void onChange ( ) { \n + counter . incrementAndGet ( ) ; \n + } \n + } ; \n + \n + realm = Realm . getInstance ( getContext ( ) ) ; \n + realm . addChangeListener ( listener ) ; \n + realm . addChangeListener ( listener ) ; \n + \n + realm . beginTransaction ( ) ; \n + realm . createObject ( AllTypes . class ) ; \n + realm . commitTransaction ( ) ; \n + \n + assertEquals ( 1 , counter . get ( ) ) ; \n + } \n + \n realm \ src \ main \ java \ io \ realm \ Realm . java \n + for ( WeakReference < RealmChangeListener > ref : changeListeners ) { \n + if ( ref . get ( ) = = listener ) { \n + / / It is already added before \n + return ; \n + } \n + } \n + \n + / / There won ' t be duplicated entries , checking is done when adding \n + break ; \n","Ignore dup entries when addChangeListener \n Since there should not have lots of listeners in on realm instance , \n looping should be an acceptable way to do this .",80
"realm \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + \n + / / This one will be added when listener2 ' s onChange called \n + / / This one will be existing in the list all the time \n + / / This one will be removed after first transaction \n + / / [ listener2 , listener3 ] \n + / / after listener2 . onChange \n + / / [ listener2 , listener3 , listener1 ] \n + / / after listener3 . onChange \n + / / [ listener2 , listener1 ] \n + assertEquals ( 0 , counter1 . get ( ) ) ; \n + assertEquals ( 1 , counter2 . get ( ) ) ; \n + assertEquals ( 1 , counter3 . get ( ) ) ; \n + / / [ listener2 , listener1 ] \n + / / after listener2 . onChange \n + / / Since duplicated entries will be ignored , we still have : \n + / / [ listener2 , listener1 ] \n realm \ src \ main \ java \ io \ realm \ Realm . java \n - / / It is already added before \n + / / It has already been added before \n",Fix notifcation related comments \n And make the testAddRemoveListenerConcurrency more readable .,80
realm \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + final RealmChangeListener listener = new RealmChangeListener ( ) { \n + @ Override \n + public void onChange ( ) { \n + counter . incrementAndGet ( ) ; \n + } \n + } ; \n - realm . addChangeListener ( new RealmChangeListener ( ) { \n - @ Override \n - public void onChange ( ) { \n - counter . incrementAndGet ( ) ; \n - } \n - } ) ; \n + realm . addChangeListener ( listener ) ; \n + final RealmChangeListener listener [ ] = new RealmChangeListener [ 1 ] ; \n - realm . addChangeListener ( new RealmChangeListener ( ) { \n + listener [ 0 ] = new RealmChangeListener ( ) { \n - } ) ; \n + } ; \n + realm . addChangeListener ( listener [ 0 ] ) ; \n + final RealmChangeListener listener [ ] = new RealmChangeListener [ 1 ] ; \n - realm . addChangeListener ( new RealmChangeListener ( ) { \n + listener [ 0 ] = new RealmChangeListener ( ) { \n - } ) ; \n + } ; \n + realm . addChangeListener ( listener [ 0 ] ) ; \n - realm = Realm . getInstance ( getContext ( ) ) ; \n - realm . addChangeListener ( new RealmChangeListener ( ) { \n + final RealmChangeListener listener = new RealmChangeListener ( ) { \n - } ) ; \n + } ; \n + realm = Realm . getInstance ( getContext ( ) ) ; \n + realm . addChangeListener ( listener ) ; \n,Fix uncertain test cases caused by WeakReference \n Someone has to hold a strong reference to make sure the listener won ' t \n be destroyed when transaction committed .,80
realm \ src \ main \ java \ io \ realm \ Realm . java \n - List < WeakReference < RealmChangeListener > > toRemoveList = \n - new ArrayList < WeakReference < RealmChangeListener > > ( changeListeners . size ( ) ) ; \n + List < WeakReference < RealmChangeListener > > toRemoveList = null ; \n + if ( toRemoveList = = null ) { \n + toRemoveList = new ArrayList < WeakReference < RealmChangeListener > > ( changeListeners . size ( ) ) ; \n + } \n - changeListeners . removeAll ( toRemoveList ) ; \n + if ( toRemoveList ! = null ) { \n + changeListeners . removeAll ( toRemoveList ) ; \n + } \n,Lazily create the toRemoveList \n To make it a bit faster .,80
realm \ src \ androidTest \ java \ io \ realm \ RealmMigrationTests . java \n + Realm . deleteRealm ( newConfig ) ; \n,Realm file should be deleted before creating .,80
"changelog . txt \n + 0 . 81 . 2 \n + * Closing realm on another thread different from which it was created on throws an exception . \n + \n realm \ src \ androidTest \ java \ io \ realm \ RealmTest . java \n + import java . util . concurrent . atomic . AtomicBoolean ; \n + ( totalNumberOfReferences - references . size ( ) ) + "" out of "" + totalNumberOfReferences ) ; \n + \n + / / Test close Realm in another thread different from where it is created . \n + public void testCloseRealmInDifferentThread ( ) throws InterruptedException { \n + final AtomicBoolean threadReady = new AtomicBoolean ( false ) ; \n + \n + final Thread thatThread = new Thread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + try { \n + testRealm . close ( ) ; \n + fail ( "" Close realm in a different thread should throw IllegalStateException . "" ) ; \n + } catch ( IllegalStateException ignored ) { \n + } \n + threadReady . set ( true ) ; \n + } \n + } ) ; \n + thatThread . start ( ) ; \n + \n + while ( ! threadReady . get ( ) ) { \n + Thread . sleep ( 5 ) ; \n + } \n + / / After exception thrown in another thread , nothing should be changed to the realm in this thread . \n + testRealm . checkIfValid ( ) ; \n + testRealm . close ( ) ; \n + } \n realm \ src \ main \ java \ io \ realm \ Realm . java \n + private static final String INCORRECT _ THREAD _ CLOSE _ MESSAGE = "" Realm access from incorrect thread . Realm instance can only be closed on the thread it was created . "" ; \n + * \n + * @ throws java . lang . IllegalStateException if trying to close Realm on a different thread than the \n + * one it was created on . \n + if ( this . threadId ! = Thread . currentThread ( ) . getId ( ) ) { \n + throw new IllegalStateException ( INCORRECT _ THREAD _ CLOSE _ MESSAGE ) ; \n + } \n + \n","Throw exception when close called on a diff thread . \n Without checking the thread in close , some weird logic could be \n triggered which is really hard to think about .",80
"changelog . txt \n - * Closing realm on another thread different from which it was created on throws an exception . \n + * Closing realm on another thread different from where it was created now throws an exception . \n realm \ src \ androidTest \ java \ io \ realm \ RealmTest . java \n + import junit . framework . AssertionFailedError ; \n + \n + import java . util . concurrent . CountDownLatch ; \n - import java . util . concurrent . atomic . AtomicBoolean ; \n - final AtomicBoolean threadReady = new AtomicBoolean ( false ) ; \n + final CountDownLatch latch = new CountDownLatch ( 1 ) ; \n + final AssertionFailedError threadAssertionError [ ] = new AssertionFailedError [ 1 ] ; \n - fail ( "" Close realm in a different thread should throw IllegalStateException . "" ) ; \n - } catch ( IllegalStateException ignored ) { \n + threadAssertionError [ 0 ] = new AssertionFailedError ( \n + "" Close realm in a different thread should throw IllegalStateException . "" ) ; \n + } catch ( IllegalStateException ignored ) { \n - threadReady . set ( true ) ; \n + latch . countDown ( ) ; \n - while ( ! threadReady . get ( ) ) { \n - Thread . sleep ( 5 ) ; \n + / / Timeout should never happen \n + latch . await ( ) ; \n + if ( threadAssertionError [ 0 ] ! = null ) { \n + throw threadAssertionError [ 0 ] ; \n",Fix typo and exception thrown in testcase ' s thread,80
"realm \ src \ main \ java \ io \ realm \ Realm . java \n - globalPathConfigurationCache . get ( canonicalPath ) . remove ( configuration ) ; \n - AtomicInteger counter = globalOpenInstanceCounter . get ( canonicalPath ) ; \n - if ( counter . decrementAndGet ( ) = = 0 ) { \n - globalOpenInstanceCounter . remove ( canonicalPath ) ; \n + \n + / / It is necessary to be synchronized here since there is a chance that before the counter removed , \n + / / the other thread could get the counter and increase it in createAndValidate . \n + synchronized ( Realm . class ) { \n + globalPathConfigurationCache . get ( canonicalPath ) . remove ( configuration ) ; \n + AtomicInteger counter = globalOpenInstanceCounter . get ( canonicalPath ) ; \n + if ( counter . decrementAndGet ( ) = = 0 ) { \n + globalOpenInstanceCounter . remove ( canonicalPath ) ; \n + } \n","Add synchronized block to Realm . close \n This should fix # 1247 and # 1241 . \n The Realm creation is protected by static synchronized , but Realm close \n is not . This means there is a chance globalOpenInstanceCounter is \n removed when it has a value 1 .",80
"changelog . txt \n + * Fixed a bug which might cause failure when loading the native library . \n realm \ src \ main \ java \ io \ realm \ internal \ RealmCore . java \n - import java . util . concurrent . atomic . AtomicBoolean ; \n - private static AtomicBoolean libraryIsLoaded = new AtomicBoolean ( false ) ; \n + private static volatile boolean libraryIsLoaded = false ; \n - public static void loadLibrary ( ) { \n - if ( libraryIsLoaded . get ( ) ) \n - / / only load library once \n + / / Although loadLibrary is synchronized internally from AOSP 4 . 3 , for the compatibility reason , \n + / / KEEP synchronized here for the old devices ! \n + public static synchronized void loadLibrary ( ) { \n + if ( libraryIsLoaded ) { \n + / / The java native should ensure only load the lib once , but we met some problems before . \n + / / So keep the flag . \n + } \n - libraryIsLoaded . set ( true ) ; \n + libraryIsLoaded = true ; \n",loadLibrary should be a synchronized operation \n Otherwise it might cause # 1350,80
examples \ realmModuleExample \ app \ proguard - rules . pro \n + - keep class io . realm . annotations . RealmModule \n - keep @ io . realm . annotations . RealmModule class * \n - dontwarn javax . * * \n - dontwarn io . realm . * * \n,Keep RealmModule class from being obfuscated \n Issue # 1283,80
realm \ src \ main \ java \ io \ realm \ internal \ RealmCore . java \n - import java . lang . ref . WeakReference ; \n - / * * \n - * Guarantee gc is done . \n - * / \n - public static void gcGuaranteed ( ) { \n - Object obj = new Object ( ) ; \n - WeakReference < Object > ref = new WeakReference < Object > ( obj ) ; \n - obj = null ; \n - while ( ref . get ( ) ! = null ) \n - System . gc ( ) ; \n - } \n - \n - / * * \n - * Guarantee gc is done after JVM shutdown . \n - * / \n - public static void gcOnExit ( ) { \n - Runtime . getRuntime ( ) . addShutdownHook ( new Thread ( ) { \n - @ Override \n - public void run ( ) { \n - gcGuaranteed ( ) ; \n - } \n - } ) ; \n - } \n - \n - private static void init ( ) { \n - / / Guarantee gc is done on JVM exit to clean up any native resources \n - gcOnExit ( ) ; \n - } \n - init ( ) ; \n - \n,"Remove broken shutdown hook . \n To fix # 1328 \n When System . exit ( 0 ) called , shutdown hook will be run . There is no \n guarantee in this case GC will collect everything . So a dead lock will \n happen here . \n Remove this part of code since the core side can ensure the integrity of \n db file when other resource is not released .",80
changelog . txt \n + * Updated Realm core to version 0 . 89 . 7 \n + - fixed a potential stack overflow issue which might cause a crash when encryption was used . \n + - embedded crypto functions from OpenSSL into Realm dynamic lib to avoid random issues on some devices . \n realm - jni \ build . gradle \n - ext . coreVersion = ' 0 . 89 . 5 ' \n + ext . coreVersion = ' 0 . 89 . 7 ' \n,Update core to v0 . 89 . 7,80
"realm - annotations - processor \ src \ main \ java \ io \ realm \ processor \ RealmAnalytics . java \n - / / data unless it’s necessary , we get it , and we’ve debated adding this for a \n + / / data unless it ' s necessary , we get it , and we ' ve debated adding this for a \n",Fix warning caused by non - ascii chars,80
changelog . txt \n - * Add support for x86 _ 64 . \n + * Added support for x86 _ 64 . \n,Minor fix for changelog x86 - 64 support,80
"realm \ src \ androidTest \ java \ io \ realm \ RealmListTest . java \n - import io . realm . entities . OwnerPrimaryKey ; \n - assertEquals ( oldIndex , owner . getDogs ( ) . indexOf ( dog ) ) ; \n + assertEquals ( newIndex , owner . getDogs ( ) . indexOf ( dog ) ) ; \n","Behaviour changes in LinkView . move \n In core commit da7055d8 . \n Now for the move up case , the old index will be delete first then insert \n to the new index .",80
"realm \ src \ androidTest \ java \ io \ realm \ RealmListTest . java \n - import io . realm . entities . OwnerPrimaryKey ; \n - assertEquals ( oldIndex , owner . getDogs ( ) . indexOf ( dog ) ) ; \n + assertEquals ( newIndex , owner . getDogs ( ) . indexOf ( dog ) ) ; \n","Behaviour changes in LinkView . move \n In core commit da7055d8 . \n Now for the move up case , the old index will be delete first then insert \n to the new index .",80
realm \ realm - jni \ src \ io _ realm _ internal _ TableQuery . cpp \n - pQuery - > Not ( ) . and _ query ( src _ table _ ref - > column < Link > ( S ( column _ idx ) ) . is _ null ( ) ) ; \n + pQuery - > and _ query ( src _ table _ ref - > column < Link > ( S ( column _ idx ) ) . is _ not _ null ( ) ) ; \n - pQuery - > Not ( ) . and _ query ( src _ table _ ref - > column < Link > ( S ( column _ idx ) ) . is _ null ( ) ) ; \n + pQuery - > and _ query ( src _ table _ ref - > column < Link > ( S ( column _ idx ) ) . is _ not _ null ( ) ) ; \n,Change to is _ not _ null for links \n Since it is supported by core now .,80
changelog . txt \n - * Opening a Realm file from one thread will no longer be blocked by a write transaction from another thread . \n + * BREAKING CHANGE : Database file format update . The Realm file created by this version cannot be used by previous versions of Realm . \n + * Opening a Realm file from one thread will no longer be blocked by a write transaction from another thread . \n realm - jni \ build . gradle \n - ext . coreVersion = ' 0 . 89 . 9 ' \n + ext . coreVersion = ' 0 . 93 . 0 ' \n,Update core to 0 . 93 . 0,80
changelog . txt \n - * Opening a Realm file from one thread will no longer be blocked by a write transaction from another thread . \n + * BREAKING CHANGE : Database file format update . The Realm file created by this version cannot be used by previous version Realm . \n + * Opening a Realm file from one thread will no longer be blocked by a write transaction from another thread . \n realm - jni \ build . gradle \n - ext . coreVersion = ' 0 . 89 . 9 ' \n + ext . coreVersion = ' 0 . 93 . 0 ' \n,Update core to 0 . 93 . 0,80
"examples \ migrationExample \ src \ main \ java \ io \ realm \ examples \ realmmigrationexample \ model \ Migration . java \n - petTable . addColumn ( ColumnType . STRING , "" name "" ) ; \n - petTable . addColumn ( ColumnType . STRING , "" type "" ) ; \n + long nameColumnIndex = petTable . addColumn ( ColumnType . STRING , "" name "" ) ; \n + long typeColumnIndex = petTable . addColumn ( ColumnType . STRING , "" type "" ) ; \n - personTable . getUncheckedRow ( i ) . getLinkList ( petsIndex ) . add ( petTable . add ( "" Jimbo "" , "" dog "" ) ) ; \n + long rowIndex = petTable . addEmptyRow ( ) ; \n + petTable . setString ( nameColumnIndex , rowIndex , "" Jimbo "" ) ; \n + petTable . setString ( typeColumnIndex , rowIndex , "" dog "" ) ; \n + personTable . getUncheckedRow ( i ) . getLinkList ( petsIndex ) . add ( rowIndex ) ; \n",Fix migration example . \n Table . add is not public anymore and should be removed soon,80
"examples \ migrationExample \ src \ main \ java \ io \ realm \ examples \ realmmigrationexample \ model \ Migration . java \n - petTable . addColumn ( ColumnType . STRING , "" name "" ) ; \n - petTable . addColumn ( ColumnType . STRING , "" type "" ) ; \n + long nameColumn = petTable . addColumn ( ColumnType . STRING , "" name "" ) ; \n + long typeColumn = petTable . addColumn ( ColumnType . STRING , "" type "" ) ; \n - personTable . getUncheckedRow ( i ) . getLinkList ( petsIndex ) . add ( petTable . add ( "" Jimbo "" , "" dog "" ) ) ; \n + long rowIndex = petTable . addEmptyRow ( ) ; \n + petTable . setString ( nameColumn , rowIndex , "" Jimbo "" ) ; \n + petTable . setString ( typeColumn , rowIndex , "" dog "" ) ; \n + personTable . getUncheckedRow ( i ) . getLinkList ( petsIndex ) . add ( rowIndex ) ; \n",Fix migration example . \n Table . add is not public anymore and should be removed soon,80
"changelog . txt \n - Fixed a bug where an async query can be copied incomplete in rare cases ( # 1717 ) . \n + * Fixed potential memory leak when using async query . \n realm \ realm - jni \ src \ io _ realm _ internal _ TableQuery . cpp \n - jlong * exported _ handover _ tableview _ array = new jlong [ number _ of _ queries ] ; \n + std : : vector < jlong > exported _ handover _ tableview _ array ( number _ of _ queries ) ; \n - std : : unique _ ptr < Query > * queries = new std : : unique _ ptr < Query > [ number _ of _ queries ] ; \n + std : : vector < std : : unique _ ptr < Query > > queries ( number _ of _ queries ) ; \n - delete [ ] queries ; \n - \n - env - > SetLongArrayRegion ( exported _ handover _ tableview , 0 , number _ of _ queries , exported _ handover _ tableview _ array ) ; \n + env - > SetLongArrayRegion ( exported _ handover _ tableview , 0 , number _ of _ queries , \n + exported _ handover _ tableview _ array . data ( ) ) ; \n",Leak fix \n SetLongArrayRegion will do a memcpy and queries might be leaked if \n exception happens .,80
"changelog . txt \n + 0 . 87 . 2 \n + * Fixed a bug when RealmObjectSchema . addField called with PRIMARY _ KEY modifier , the field was not set as a required field ( # 2001 ) . \n + \n realm \ realm - annotations \ src \ main \ java \ io \ realm \ annotations \ PrimaryKey . java \n - * Primary keys on Strings also counts as having the { @ link io . realm . annotations . Index } annotation . \n + * Primary keys also count as having the { @ link Index } and { @ link Required } annotations . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmObjectSchemaTests . java \n + assertFalse ( schema . isNullable ( fieldName ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ FieldAttribute . java \n - * Mark a field as a primary key . This also implicitly mark it as { @ link # INDEXED } . \n + * Mark a field as a primary key . This also implicitly mark it as { @ link # INDEXED } and { @ link # REQUIRED } . \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmObjectSchema . java \n - boolean nullable = metadata . defaultNullable & & ! containsAttribute ( attributes , FieldAttribute . REQUIRED ) ; \n + boolean nullable = metadata . defaultNullable ; \n + if ( containsAttribute ( attributes , FieldAttribute . REQUIRED ) | | \n + containsAttribute ( attributes , FieldAttribute . PRIMARY _ KEY ) ) { \n + nullable = false ; \n + } \n",addField PRIMARY _ KEY should also apply REQUIRED \n Fix # 2001,80
"CHANGELOG . md \n + * Fixed an build issue when using Realm in library project on Windows ( # 2484 ) . \n realm - transformer \ src \ main \ groovy \ io \ realm \ transformer \ RealmTransformer . groovy \n + / / The jar might not using File . separatorChar as the path separator . So we just replace both ` \ ` and \n + / / ` / ` . It depends on how the jar file was created . \n + / / See http : / / stackoverflow . com / questions / 13846000 / file - separators - of - path - name - of - zipentry \n - . replace ( File . separatorChar , ' . ' as char ) \n + . replace ( ' / ' as char , ' . ' as char ) \n + . replace ( ' \ \ ' as char , ' . ' as char ) \n",Fix transformer in lib project on Windows \n The separator in jar file might not be File . separatorChar \n Fix # 2484,80
"CHANGELOG . md \n + # # 1 . 1 . 1 \n + \n + # # # Bug fixes \n + \n + * Fixed a wrong JNI method declaration which might cause "" method not found "" crash on some devices . \n + \n realm \ realm - jni \ src \ io _ realm _ internal _ UncheckedRow . cpp \n - ( JNIEnv * env , jobject , jlong nativeRowPtr , jlong columnIndex ) \n + ( JNIEnv * env , jclass , jlong nativeRowPtr , jlong columnIndex ) \n realm \ realm - jni \ src \ io _ realm _ internal _ UncheckedRow . h \n - ( JNIEnv * , jobject , jlong , jlong ) ; \n + ( JNIEnv * , jclass , jlong , jlong ) ; \n",Fix JNI declaration for UncheckedRow ( # 3104 ),80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ rule \ TestRealmConfigurationFactory . java \n + import org . junit . runner . Description ; \n + import org . junit . runners . model . Statement ; \n + private boolean unitTestFailed = false ; \n + \n + @ Override \n + public Statement apply ( final Statement base , Description description ) { \n + return new Statement ( ) { \n + @ Override \n + public void evaluate ( ) throws Throwable { \n + before ( ) ; \n + try { \n + base . evaluate ( ) ; \n + } catch ( Throwable throwable ) { \n + unitTestFailed = true ; \n + throw throwable ; \n + } finally { \n + after ( ) ; \n + } \n + } \n + } ; \n + } \n + } catch ( IllegalStateException e ) { \n + / / Only throw the exception caused by deleting the opened Realm if the test case itself doesn ' t throw . \n + if ( ! unitTestFailed ) { \n + throw e ; \n + } \n",Not throw always in TestRealmConfigurationFactory \n Only throw the exception caused by deleting the opened Realm if the test \n case itself doesn ' t throw . Otherwise the test case cannot fail by the \n original exception .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTests . java \n + \n + / / When there is a transaction holding by a typed Realm in one thread , getInstance from the \n + / / other thread should not be blocked since we have cached the schemas already . \n + @ Test \n + public void getInstance _ shouldNotBeBlockedByTransactionInAnotherThread ( ) \n + throws InterruptedException { \n + final CountDownLatch latch = new CountDownLatch ( 1 ) ; \n + realm . beginTransaction ( ) ; \n + \n + Thread thread = new Thread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + Realm realm = Realm . getInstance ( realmConfig ) ; \n + realm . close ( ) ; \n + latch . countDown ( ) ; \n + } \n + } ) ; \n + thread . start ( ) ; \n + TestHelper . awaitOrFail ( latch ) ; \n + realm . cancelTransaction ( ) ; \n + } \n","Transaction should not block opening Realm \n This is the test case only , the problem has been fixed when we introduce \n the schema caches . \n Since we are caching the schemas for typed Realm , when a transaction \n lock is holding by one type Realm , open Realm instance in another thread \n should not be blocked . \n But if there is no typed Realm instance opened , DynamicRealm transaction \n should block the typed Realm openning .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTests . java \n + @ Test \n + public void getInstance _ context ( ) { \n + RealmConfiguration config = new RealmConfiguration . Builder ( context ) . build ( ) ; \n + Realm . deleteRealm ( config ) ; \n + \n + Realm testRealm = Realm . getInstance ( context ) ; \n + assertNotNull ( "" Realm . getInstance unexpectedly returns null "" , testRealm ) ; \n + assertTrue ( "" Realm . getInstance does not contain expected table "" , testRealm . contains ( AllTypes . class ) ) ; \n + config = testRealm . getConfiguration ( ) ; \n + config . getRealmFolder ( ) . equals ( context . getFilesDir ( ) ) ; \n + testRealm . close ( ) ; \n + Realm . deleteRealm ( config ) ; \n + } \n + \n",Add test case for getInstance ( Context ),80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + final CountDownLatch bgRealmClosedLatch = new CountDownLatch ( 1 ) ; \n - looperThread . testComplete ( ) ; \n + looperThread . testComplete ( bgRealmClosedLatch ) ; \n - looperThread . testComplete ( ) ; \n + looperThread . testComplete ( bgRealmClosedLatch ) ; \n - looperThread . testComplete ( ) ; \n + looperThread . testComplete ( bgRealmClosedLatch ) ; \n - looperThread . testComplete ( ) ; \n + looperThread . testComplete ( bgRealmClosedLatch ) ; \n + bgRealmClosedLatch . countDown ( ) ; \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ TypeBasedNotificationsTests . java \n + thread . start ( ) ; \n - \n - thread . start ( ) ; \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ rule \ RunInLooperThread . java \n + / * * \n + * Signal that the test has completed . \n + * \n + * @ param latches additional latches to wait before set the test completed flag . \n + * / \n + public void testComplete ( CountDownLatch . . . latches ) { \n + for ( CountDownLatch latch : latches ) { \n + TestHelper . awaitOrFail ( latch ) ; \n + } \n + signalTestCompleted . countDown ( ) ; \n + } \n + \n,Take latches for RunInLooperThread . testComplete \n And fix more test cases .,80
"changelog . txt \n - * Updated Realm Core to 0 . 96 . 1 \n + * Updated Realm Core to 0 . 96 . 2 \n - IllegalStateException won ' t be thrown anymore in RealmResults . where ( ) if the RealmList which the RealmResults is created on has been deleted . Instead , the RealmResults will be treated as empty forever . \n - \n - Fixed bug causing BadVersionException or crashing core when running async queries . \n realm \ realm - jni \ build . gradle \n - ext . coreVersion = ' 0 . 96 . 1 ' \n + ext . coreVersion = ' 0 . 96 . 2 ' \n - ext . coreSha256Hash = ' eb32531428f5bc2cd7fe54f9e4905398d5506141d2cebe04c6c80a17ed33df5d ' \n + ext . coreSha256Hash = ' 55d694cdec2aafd6e278688d60e256770ffd9a7ae8536168b975da71391e09b1 ' \n",Update core to 0 . 96 . 2,80
examples \ threadExample \ src \ main \ java \ io \ realm \ examples \ threads \ PassingObjectsFragment . java \n + realm . executeTransaction ( new Realm . Transaction ( ) { \n + @ Override \n + public void execute ( Realm realm ) { \n + realm . delete ( Person . class ) ; \n + } \n + } ) ; \n - realm . delete ( Person . class ) ; \n,Missing transaction in threading example ( # 3245 ) \n Close # 3244,80
CHANGELOG . md \n - * Removed ` HandlerController ` from the public API . \n + * Removed ` BaseRealm ` from the public API . \n + * Removed ` HandlerController ` from the public API . \n realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n - public abstract class BaseRealm implements Closeable { \n + abstract class BaseRealm implements Closeable { \n,BaseRealm should be package protected ( # 2673 ),80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTest . java \n - public void testCopManagedObjectToOtherRealm ( ) { \n + public void testCopyManagedObjectToOtherRealm ( ) { \n + final CountDownLatch bgThreadReadyLatch = new CountDownLatch ( 1 ) ; \n + bgThreadReadyLatch . countDown ( ) ; \n - } catch ( InterruptedException e ) { \n - fail ( ) ; \n - } finally { \n + bgRealm = null ; \n + / / DON ' T count down in the final block ! The test will fail silently ! ! ! \n + } catch ( InterruptedException e ) { \n + fail ( e . getMessage ( ) ) ; \n + } finally { \n + if ( bgRealm ! = null ) { \n + bgRealm . close ( ) ; \n + } \n + / / Wait until bgThread finishes adding listener to the RealmResults . Otherwise same TableView version won ' t \n + / / trigger the listener . \n + bgThreadReadyLatch . await ( ) ; \n,testProcessLocalListenersAfterRefresh fix \n Timing issue with testProcessLocalListenersAfterRefresh . \n RealmResults should be created before trasaction . Otherwise it fails by \n same TableView version . \n And a minor typo fix .,80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ DynamicRealmTests . java \n + looperThread . keepStrongReference . add ( allTypes ) ; \n,GCed ref causes flaky test ( # 3131 ),80
"CHANGELOG . md \n - # # 0 . 91 . 0 \n + # # 0 . 90 . 1 \n + * Fixed CannotCompileException when related class definition in android . jar cannot be found ( # 2703 ) . \n gradle - plugin \ src \ main \ groovy \ io \ realm \ gradle \ Realm . groovy \n - project . android . registerTransform ( new RealmTransformer ( ) ) \n + project . android . registerTransform ( new RealmTransformer ( project ) ) \n realm - transformer \ src \ main \ groovy \ io \ realm \ transformer \ RealmTransformer . groovy \n + import org . gradle . api . Project \n + private Project project \n + \n + public RealmTransformer ( Project project ) { \n + this . project = project \n + } \n + / / Append android . jar to class pool . We don ' t need the class names of them but only the class in the pool for \n + / / javassist . See https : / / github . com / realm / realm - java / issues / 2703 . \n + addBootClassesToClassPool ( classPool ) \n + / / There is no official way to get the path to android . jar for transform . \n + / / See https : / / code . google . com / p / android / issues / detail ? id = 209426 \n + private void addBootClassesToClassPool ( ClassPool classPool ) { \n + try { \n + project . android . bootClasspath . each { \n + String path = it . absolutePath \n + logger . info "" Add boot class "" + path + "" to class pool . "" \n + classPool . appendClassPath ( path ) \n + } \n + } catch ( Exception e ) { \n + / / Just log it . It might not impact the transforming if the method which needs to be transformer doesn ' t \n + / / contain classes from android . jar . \n + logger . info ( "" Cannot get bootClasspath caused by : "" , e ) \n + } \n + } \n","Workaround to add android . jar for transform ( # 2741 ) \n Close # 2703 \n While javassit manipulating the method , it requires all of the classed \n used in the method can be found in the class pool . But android . jar will \n not be passed to the transform - - It is not in any of \n QualifiedContent . Scope definitions . \n We use project . android . bootClasspath which is public right now to get \n the path to android . jar . Project is passed from gradle . \n See https : / / android . googlesource . com / platform / tools / base / + / studio - master - dev / build - system / gradle / src / main / groovy / com / android / build / gradle / BaseExtension . java # 737",80
"build . gradle \n - from ( "" $ { buildDir } / outputs / gradle "" ) { \n - include "" realm - android - $ { currentVersion } . jar "" \n - into ' gradle ' \n - } \n + task distributionJniUnstrippedPackage ( type : Zip ) { \n + description = ' Generate native libs package with debug symbols ' \n + dependsOn assembleRealm \n + \n + group = ' Artifact ' \n + archiveName = "" realm - java - jni - libs - unstripped - $ { currentVersion } . zip "" \n + destinationDir = file ( "" $ { buildDir } / outputs / distribution "" ) \n + \n + from ( "" realm / realm - jni / build / outputs / jniLibs - unstripped "" ) { \n + include ' * * / * . so ' \n + } \n + } \n + \n + dependsOn distributionJniUnstrippedPackage \n + commandLine ' s3cmd ' , ' put ' , "" $ { buildDir } / outputs / distribution / realm - java - jni - libs - unstripped - $ { currentVersion } . zip "" , ' s3 : / / static . realm . io / downloads / java / ' \n realm \ realm - jni \ build . gradle \n - into "" $ { projectDir } / . . / build / output / jniLibs - unstripped / $ { target . abi } "" \n + into "" $ { buildDir } / outputs / jniLibs - unstripped / $ { target . abi } "" \n - delete fileTree ( dir : "" $ { projectDir } / . . / build / output / jniLibs - unstripped / "" , include : ' * * / librealm - jni * . so ' ) \n",Upload native lib with symbols to s3 ( # 2801 ) \n And remove some useless lines,80
"examples \ build . gradle \n + maven { url ' https : / / jitpack . io ' } \n - classpath ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n - classpath ' com . jakewharton . sdkmanager : gradle - plugin : 0 . 12 . 0 ' \n + classpath ' com . github . JakeWharton : sdk - manager - plugin : 0ce4cdf08009d79223850a59959d9d6e774d0f77 ' \n examples \ newsreaderExample \ src \ release \ AndroidManifest . xml \n - < application android : name = "" . DebugNewsReaderApplication "" / > \n + < application android : name = "" . ReleaseNewsReaderApplication "" / > \n gradle - plugin \ build . gradle \n - provided ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + provided ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n gradle - plugin \ src \ test \ groovy \ io \ realm \ gradle \ PluginTest . groovy \n - classpath ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n - classpath ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n realm - transformer \ build . gradle \n - provided ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + provided ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n realm \ build . gradle \n + maven { url ' https : / / jitpack . io ' } \n - classpath ' com . android . tools . build : gradle : 1 . 5 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n - classpath ' com . jakewharton . sdkmanager : gradle - plugin : 0 . 12 . 0 ' \n + classpath ' com . github . JakeWharton : sdk - manager - plugin : 0ce4cdf08009d79223850a59959d9d6e774d0f77 ' \n",Update android gradle to 2 . 1 . 0 ( # 2743 ) \n * Use JitPack version of android - sdk - updater on examples \n * Lint issue with newspaper example,80
"CHANGELOG . md \n + # # 0 . 91 . 1 \n + \n + * Updated Realm Core . \n + \n + # # # Bug fixes \n + \n + * Fixed a bug when opening a Realm cause a staled memory mapping . Symptoms are error messages like "" Bad or incompatible history type "" , "" File format version doesn ' t match "" , and "" Encrypted interprocess sharing is currently unsupported "" . \n + \n realm \ realm - jni \ build . gradle \n - ext . coreVersion = ' 1 . 0 . 0 ' \n + ext . coreVersion = ' 1 . 0 . 1 ' \n - ext . coreSha256Hash = ' 5160c1228b56b06805dc4b5e639b721eab364ee4f8c363b70f2e5de029b5fe52 ' \n + ext . coreSha256Hash = ' e132f5824dc31e683353fb0be91eb45cac702f88f8cee819499a1dfa7936aeac ' \n",Merge remote - tracking branch ' origin / releases ' into mc / merge / 0 . 91 _ 4c48038a ( # 2873 ),80
CHANGELOG . md \n + * Removed deprecated methods Realm . getTable ( ) from public API . \n realm \ realm - library \ src \ main \ java \ io \ realm \ Realm . java \n - @ Deprecated \n - public Table getTable ( Class < ? extends RealmObject > clazz ) { \n + Table getTable ( Class < ? extends RealmObject > clazz ) { \n,Remove Realm . getTable ( ) from public API \n Close # 2546,80
"CONTRIBUTING . md \n + # # # Branch Strategy \n + \n + We have two branches for shared development : ` master ` and ` releases ` . We make releases from each . \n + \n + ` master ` : \n + \n + * The ` master ` branch is where major / minor versions are released from . \n + * It is for new features and / or breaking changes . \n + \n + ` releases ` : \n + \n + * The releases branch is where patch versions are released from . \n + * It is mainly for bug fixes . \n + * Every commit is automatically merged to ` master ` . \n + * Minor changes ( e . g . to documentation , tests , and the build system ) may not affect end users but should still be merged to ` releases ` to avoid diverging too far from ` master ` and to reduce the likelihood of merge conflicts . \n + \n",Add branch strategy to the CONTRIBUTING doc . ( # 3405 ),80
"realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ LinkView . java \n - return new TableQuery ( this . context , this . parent , nativeQueryPtr ) ; \n + return new TableQuery ( this . context , this . getTargetTable ( ) , nativeQueryPtr ) ; \n",Use getTargetTable to build query on linkview \n otherwise RealmQueryTests . findFirst ( ) will fail because it compares the \n row with the tables ' name first .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ DynamicRealmTests . java \n - @ Test \n - @ RunTestInLooperThread \n - public void accessingDynamicRealmObjectBeforeAsyncQueryCompleted ( ) { \n - / * \n - final DynamicRealm dynamicRealm = initializeDynamicRealm ( ) ; \n - final DynamicRealmObject [ ] dynamicRealmObject = new DynamicRealmObject [ 1 ] ; \n - \n - / / Intercept completion of the async DynamicRealmObject query \n - Handler handler = new HandlerProxy ( dynamicRealm . handlerController ) { \n - @ Override \n - public boolean onInterceptInMessage ( int what ) { \n - switch ( what ) { \n - case HandlerControllerConstants . COMPLETED _ ASYNC _ REALM _ OBJECT : { \n - post ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - assertFalse ( dynamicRealmObject [ 0 ] . isLoaded ( ) ) ; \n - assertFalse ( dynamicRealmObject [ 0 ] . isValid ( ) ) ; \n - try { \n - dynamicRealmObject [ 0 ] . getObject ( AllTypes . FIELD _ BINARY ) ; \n - fail ( "" trying to access a DynamicRealmObject property should throw "" ) ; \n - } catch ( IllegalStateException ignored ) { \n - \n - } finally { \n - dynamicRealm . close ( ) ; \n - looperThread . testComplete ( ) ; \n - } \n - } \n - } ) ; \n - return true ; \n - } \n - } \n - return false ; \n - } \n - } ; \n - \n - / / dynamicRealm . setHandler ( handler ) ; \n - dynamicRealmObject [ 0 ] = dynamicRealm . where ( AllTypes . CLASS _ NAME ) \n - . between ( AllTypes . FIELD _ LONG , 4 , 9 ) \n - . findFirstAsync ( ) ; \n - * / \n - } \n - \n",Remove accessingDynamicRealmObjectBeforeAsyncQueryCompleted \n Replaced by DynamicRealmRealmTests . findFirst ( ),80
"CHANGELOG . md \n + # # 1 . 0 . 2 \n + \n + # # # Bug fixes \n + \n + * Disabled the optional API transformer since it has problems with DexGuard ( 3022 ) . \n + \n gradle - plugin \ src \ main \ groovy \ io \ realm \ gradle \ Realm . groovy \n - if ( ! isAndroidLib ) { \n - project . android . registerTransform ( new RealmOptionalAPITransformer ( ) ) \n - } \n + \n gradle - plugin \ src \ test \ groovy \ io \ realm \ gradle \ PluginTest . groovy \n + import static org . junit . Assert . assertFalse \n - assertTrue ( containsTransform ( project . android . transforms , RealmOptionalAPITransformer . class ) ) \n + / / Disabled because of https : / / github . com / realm / realm - java / issues / 3022 \n + assertFalse ( containsTransform ( project . android . transforms , RealmOptionalAPITransformer . class ) ) \n","Disable optional api transformer \n Because of # 3022 , this transformer doesn ' t play well with DexGuard . \n The idea way is we can supply an option to disable it by users . But \n unfortunately it seems to be difficult : \n * The realm gradle options block is evaluated after calling \n android . registerTransformer ( ) \n * We can pass a closure to transformer later , but the problem \n Transformer . getScope cannot return null or an empty set , otherwise an \n exception will be thrown . \n Justs disable it until we find a proper way .",80
"Jenkinsfile \n - buildEnv . inside ( "" - - privileged - v / dev / bus / usb : / dev / bus / usb - v $ { env . HOME } / gradle - cache : / root / . gradle "" ) { \n + buildEnv . inside ( "" - - privileged - v / dev / bus / usb : / dev / bus / usb - v $ { env . HOME } / gradle - cache : / root / . gradle - v / root / adbkeys : / root / . android "" ) { \n",Re - use adb keys ( # 3056 ),80
"CHANGELOG . md \n + # # # Enhancements \n + \n + * Logs warning if ` DynamicRealm ` is not closed when GC happens as it does for ` Realm ` . \n + \n realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n + @ Override \n + protected void finalize ( ) throws Throwable { \n + if ( sharedGroupManager ! = null & & sharedGroupManager . isOpen ( ) ) { \n + RealmLog . w ( "" Remember to call close ( ) on all Realm instances . "" + \n + "" Realm "" + configuration . getPath ( ) + "" is being finalized without being closed , "" + \n + "" this can lead to running out of native memory . "" \n + ) ; \n + } \n + super . finalize ( ) ; \n + } \n + \n realm \ realm - library \ src \ main \ java \ io \ realm \ Realm . java \n - @ Override \n - protected void finalize ( ) throws Throwable { \n - if ( sharedGroupManager ! = null & & sharedGroupManager . isOpen ( ) ) { \n - RealmLog . w ( "" Remember to call close ( ) on all Realm instances . "" + \n - "" Realm "" + configuration . getPath ( ) + "" is being finalized without being closed , "" + \n - "" this can lead to running out of native memory . "" \n - ) ; \n - } \n - super . finalize ( ) ; \n - } \n - \n",Move Realm . finalize to BaseRealm ( # 3088 ) \n So DynamicRealm can have a warning logged as well .,80
CHANGELOG . md \n + * Fixed a concurrency allocation bug in storage engine which might lead to some random crashes . \n - * Updated Realm Core to 1 . 3 . 0 . \n + * Updated Realm Core to 1 . 3 . 1 . \n realm \ realm - jni \ build . gradle \n - ext . coreVersion = ' 1 . 3 . 0 ' \n + ext . coreVersion = ' 1 . 3 . 1 ' \n - ext . coreSha256Hash = ' f991a3f92324857f00e88f110df861c2451789f9a790edfa330b7ddede5d7036 ' \n + ext . coreSha256Hash = ' 8be0c49cda92387db0d4d455dacc6769003725eb8b44c4d8df04b621e738d66e ' \n,Update core to 1 . 3 . 1 ( # 3180 ),80
CHANGELOG . md \n - * Updated Realm Core to 1 . 3 . 1 . \n + * Updated Realm Core to 1 . 4 . 0 . \n realm \ realm - jni \ build . gradle \n - ext . coreVersion = ' 1 . 3 . 1 ' \n + ext . coreVersion = ' 1 . 4 . 0 ' \n - ext . coreSha256Hash = ' 8be0c49cda92387db0d4d455dacc6769003725eb8b44c4d8df04b621e738d66e ' \n + ext . coreSha256Hash = ' 96f784567028b766df1992416e74b6ca387487b85f049ecc846556a16c51dec6 ' \n,Update core to 1 . 4 . 0 ( # 3187 ),80
examples \ encryptionExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ gridViewExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ introExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ jsonExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ kotlinExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ migrationExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ moduleExample \ app \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ moduleExample \ library \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ newsreaderExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ rxJavaExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ threadExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n examples \ unitTestExample \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n realm \ build . gradle \n - classpath ' com . github . JakeWharton : sdk - manager - plugin : 0ce4cdf08009d79223850a59959d9d6e774d0f77 ' \n realm \ realm - library \ build . gradle \n - apply plugin : ' android - sdk - manager ' \n,Remove dependency to sdk - manager ( # 3269 ) \n Docker handles SDK setup and AS handles it for local build .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + import org . junit . Ignore ; \n + / / FIXME check if the SharedRealm Changed in handleAsyncTransactionCompleted and reenable this test . \n + @ Ignore ( "" Listener on Realm might be trigger more times , ignore for now "" ) \n",Ignore callingOrdersOfListeners for now ( # 3416 ) \n since it becomes a flaky test after # 3370 .,80
"CHANGELOG . md \n + * ` DynamicRealmObject . setList ` should only accept ` RealmList < DynamicRealmObject > ` ( # 3280 ) . \n realm \ realm - library \ src \ main \ java \ io \ realm \ DynamicRealmObject . java \n + \n + \n - RealmList < RealmObject > list = ( RealmList < RealmObject > ) value ; \n + RealmList < DynamicRealmObject > list = ( RealmList < DynamicRealmObject > ) value ; \n - public void setList ( String fieldName , RealmList < ? extends RealmModel > list ) { \n + public void setList ( String fieldName , RealmList < DynamicRealmObject > list ) { \n - RealmObjectProxy obj = ( RealmObjectProxy ) list . get ( i ) ; \n + RealmObjectProxy obj = list . get ( i ) ; \n",DynamicRealmObject . setList declaration fix ( # 3290 ) \n It should only accept RealmList < DynamicRealmObject > . \n Fix # 3280,80
CHANGELOG . md \n + * ` DynamicRealmObject . setList ` should only accept ` RealmList < DynamicRealmObject > ` ( # 3280 ) . \n - * ` DynamicRealmObject . setList ` should only accept ` RealmList < DynamicRealmObject > ` ( # 3280 ) . \n,Fix wrong section of changelog ( # 3303 ),80
CHANGELOG . md \n + * Fixed a concurrency crash which might happen when ` Realm . executeTransactionAsync ( ) ` tried to call ` onSucess ` after the Realm was closed . \n realm \ realm - library \ src \ main \ java \ io \ realm \ HandlerController . java \n - if ( onSuccess ! = null ) { \n - pendingOnSuccessAsyncTransactionCallbacks . add ( onSuccess ) ; \n + / / Same reason as handleMessage ( ) \n + if ( realm . sharedGroupManager ! = null ) { \n + if ( onSuccess ! = null ) { \n + pendingOnSuccessAsyncTransactionCallbacks . add ( onSuccess ) ; \n + } \n + realmChanged ( false ) ; \n - realmChanged ( false ) ; \n,"Verify SharedGroup in handleAsyncTransactionCompleted ( # 3313 ) \n * Verify SharedGroup in handleAsyncTransactionCompleted \n In a rare case , if handleAsyncTransactionCompleted posted before set \n handler to null , the handleAsyncTransactionCompleted will be called with \n a closed Realm .",80
"CHANGELOG . md \n - * Updated Realm Core to 1 . 5 . 0 . \n + * Updated Realm Core to 1 . 5 . 1 . \n realm \ realm - jni \ build . gradle \n - ext . coreVersion = ' 1 . 5 . 0 ' \n + ext . coreVersion = ' 1 . 5 . 1 ' \n - ext . coreSha256Hash = ' b4329935c8423602f81cb80f920a576f3b6937b6c44cb5358730ae12b87bdb20 ' \n + ext . coreSha256Hash = ' a034d3250c820a15126721142d168a2ac4a12223b75bb324958ca2a70442720d ' \n - def commonCflags = [ ' - Os ' , ' - std = c + + 14 ' , ' - Wmissing - declarations ' , ' - Werror ' ] \n + def commonCflags = [ ' - Os ' , ' - std = c + + 14 ' , ' - Wmissing - declarations ' , ' - Werror ' , ' - fsigned - char ' ] \n",Update core to 1 . 5 . 1 ( # 3320 ),80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTests . java \n - \n - @ Test \n - public void incompatibleLockFile ( ) throws IOException { \n - / / Replace . lock file with a corrupted one \n - File lockFile = new File ( realmConfig . getPath ( ) + "" . lock "" ) ; \n - assertTrue ( lockFile . exists ( ) ) ; \n - FileOutputStream fooStream = new FileOutputStream ( lockFile , false ) ; \n - fooStream . write ( "" Boom "" . getBytes ( ) ) ; \n - fooStream . close ( ) ; \n - \n - try { \n - / / This will try to open a second SharedGroup which should fail when the . lock file is corrupt \n - DynamicRealm . getInstance ( realm . getConfiguration ( ) ) ; \n - fail ( ) ; \n - } catch ( RealmError expected ) { \n - assertTrue ( expected . getMessage ( ) . contains ( "" Info size doesn ' t match "" ) ) ; \n - } finally { \n - lockFile . delete ( ) ; \n - } \n - } \n","Remove improper incompatibleLockFile test ( # 3324 ) \n This test is not constructed properly . It tries to modify the lock file \n while the Realm is still opened . This would cause some undefined \n behaviour in core . Especially when we are using the generic \n external _ commit _ helper which is based on SharedGroup : : wait _ for _ change ( ) \n the helper thread will freeze because of polling hangs forever . \n Just remove the test , core should ensure the proper exception thrown and \n we have other tests to ensure the exception conversion right .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ ManagedRealmCollectionTests . java \n + realm . beginTransaction ( ) ; \n + AllJavaTypes allJavaTypes = realm . createObject ( AllJavaTypes . class , 42 ) ; \n + realm . commitTransaction ( ) ; \n - assertTrue ( method + "" failed "" , runMethodOnWrongThread ( method ) ) ; \n + assertTrue ( method + "" failed "" , runMethodOnWrongThread ( method , allJavaTypes ) ) ; \n - private boolean runMethodOnWrongThread ( final RealmCollectionMethod method ) throws ExecutionException , InterruptedException { \n + private boolean runMethodOnWrongThread ( final RealmCollectionMethod method ) \n + throws ExecutionException , InterruptedException { \n - private boolean runMethodOnWrongThread ( final CollectionMethod method ) throws ExecutionException , InterruptedException { \n + private boolean runMethodOnWrongThread ( final CollectionMethod method , final AllJavaTypes tempObject ) \n + throws ExecutionException , InterruptedException { \n - case CLEAR : collection . clear ( ) ; case CONTAINS : \n - case CONTAINS _ ALL : collection . containsAll ( Collections . singletonList ( new AllJavaTypes ( ) ) ) ; break ; \n + case CLEAR : collection . clear ( ) ; \n + case CONTAINS : \n + case CONTAINS _ ALL : collection . containsAll ( Collections . singletonList ( tempObject ) ) ; break ; \n","Fix wrong thread test \n When call the RealmResults . contains ( ) , the given object must be a \n managed RealmObject , otherwise it will just return false .",80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ DynamicRealmObjectTests . java \n + / / To run the query of the PendingRow first . \n + assertTrue ( dObjDynamic . isValid ( ) ) ; \n + \n,Test case needs the row to be querid first,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ DynamicRealmObjectTests . java \n - / / To run the query of the PendingRow first . \n - assertTrue ( dObjDynamic . isValid ( ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmQuery . java \n - import java . lang . ref . WeakReference ; \n + long tableRowIndex = getSourceRowIndexForFirstObject ( ) ; \n + if ( tableRowIndex > = 0 ) { \n + E realmObject = realm . get ( clazz , className , tableRowIndex ) ; \n + return realmObject ; \n + } else { \n + return null ; \n + } \n + } \n + \n + / * * \n + * Similar to { @ link # findFirst ( ) } but runs asynchronously on a worker thread \n + * This method is only available from a Looper thread . \n + * \n + * @ return immediately an empty { @ link RealmObject } . Trying to access any field on the returned object \n + * before it is loaded will throw an { @ code IllegalStateException } . Use { @ link RealmObject # isLoaded ( ) } to check if \n + * the object is fully loaded or register a listener { @ link io . realm . RealmObject # addChangeListener } \n + * to be notified when the query completes . If no RealmObject was found after the query completed , the returned \n + * RealmObject will have { @ link RealmObject # isLoaded ( ) } set to { @ code true } and { @ link RealmObject # isValid ( ) } set to \n + * { @ code false } . \n + * / \n + public E findFirstAsync ( ) { \n - / * * \n - * @ deprecated use { @ link # findFirst ( ) } instead . \n - * / \n - public E findFirstAsync ( ) { \n - return findFirst ( ) ; \n - } \n - \n + \n + private long getSourceRowIndexForFirstObject ( ) { \n + return this . query . find ( ) ; \n + } \n",We cannot deprecate the findFirstAsync \n findFirst ( ) may return null before which has a differnt API behavior .,80
realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ Collection . cpp \n - / / No changes . \n - if ( changes . empty ( ) ) return ; \n,"Collection change callback should always be called \n even when the change set is empty . \n When it is empty , it could be : \n 1 . The async query finished . \n 2 . A local transaction is started . In this case , the collections will be \n switch to original Results first then switch to snapshot in after \n nativeBeginTransaction returns .",80
"realm \ realm - library \ src \ main \ java \ io \ realm \ objectserver \ User . java \n + } catch ( Throwable e ) { \n + postError ( new ObjectServerError ( ErrorCode . UNKNOWN , e ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ objectserver \ internal \ network \ AuthenticateResponse . java \n + private static final String JSON _ FIELD _ ACCESS _ TOKEN = "" access _ token "" ; \n + private static final String JSON _ FIELD _ REFRESH _ TOKEN = "" refresh _ token "" ; \n + \n - public static AuthenticateResponse createFrom ( Response response ) { \n + static AuthenticateResponse createFrom ( Response response ) { \n - * Create a unsuccessful authentication response . This should only happen in case of network / IO problems . \n + * Creates a unsuccessful authentication response . This should only happen in case of network / IO problems . \n - public AuthenticateResponse ( ObjectServerError error ) { \n + AuthenticateResponse ( ObjectServerError error ) { \n - * Parse a valid ( 200 ) server response . It might still result in a unsuccessful authentication attempt , if the \n + * Parses a valid ( 200 ) server response . It might still result in a unsuccessful authentication attempt , if the \n - public AuthenticateResponse ( String serverResponse ) { \n + private AuthenticateResponse ( String serverResponse ) { \n - String identifier ; \n - String path ; \n - String appId ; \n - accessToken = obj . has ( "" accessToken "" ) ? Token . from ( obj . getJSONObject ( "" accessToken "" ) ) : null ; \n - refreshToken = obj . has ( "" refreshToken "" ) ? Token . from ( obj . getJSONObject ( "" refreshToken "" ) ) : null ; \n + accessToken = obj . has ( JSON _ FIELD _ ACCESS _ TOKEN ) ? \n + Token . from ( obj . getJSONObject ( JSON _ FIELD _ ACCESS _ TOKEN ) ) : null ; \n + refreshToken = obj . has ( JSON _ FIELD _ REFRESH _ TOKEN ) ? \n + Token . from ( obj . getJSONObject ( JSON _ FIELD _ REFRESH _ TOKEN ) ) : null ; \n + / / noinspection ThrowableInstanceNeverThrown \n",Error in exector task and fix JSON field in auth ( # 94 ),80
"realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n - public abstract class BaseRealm implements Closeable { \n + abstract class BaseRealm implements Closeable { \n - public volatile static Context applicationContext ; \n + volatile static Context applicationContext ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ ObjectServerFacade . java \n - Class syncFacadeClass = Class . forName ( "" io . realm . internal . SyncObjectServerFacade "" ) ; \n + Class syncFacadeClass = Class . forName ( "" io . realm . internal . objectserver . SyncObjectServerFacade "" ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ objectserver \ AuthenticatingState . java \n - import io . realm . BaseRealm ; \n - if ( NetworkStateReceiver . isOnline ( BaseRealm . applicationContext ) ) { \n + if ( NetworkStateReceiver . isOnline ( SyncObjectServerFacade . getApplicationContext ( ) ) ) { \n rename from realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SyncObjectServerFacade . java \n rename to realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ objectserver \ SyncObjectServerFacade . java \n - package io . realm . internal ; \n + package io . realm . internal . objectserver ; \n + import android . annotation . SuppressLint ; \n - import io . realm . internal . objectserver . SessionStore ; \n - import io . realm . internal . objectserver . SyncSession ; \n + import io . realm . internal . Keep ; \n + import io . realm . internal . ObjectServerFacade ; \n + @ SuppressLint ( "" StaticFieldLeak "" ) / / \n + private static Context applicationContext ; \n + / / noinspection TryWithIdenticalCatches \n + / / FIXME : Reflection can be avoided by moving some functions of SyncManager and ObjectServer out of public \n + if ( applicationContext = = null ) { \n + applicationContext = context ; \n + } \n + \n + static Context getApplicationContext ( ) { \n + return applicationContext ; \n + } \n",Make BaseRealm package protected again ( # 143 ) \n and move SyncObjectServerFacade to internal / objectserver .,80
"CHANGELOG . md \n + # # # Enhancements \n + \n + * A ` RealmMigrationNeededException ` will be thrown with a cause to show the detailed message when a migration is needed and the migration block is not in the ` RealmConfiguration ` . \n + \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmConfigurationTests . java \n - } catch ( RealmMigrationNeededException ignored ) { \n + } catch ( RealmMigrationNeededException expected ) { \n + / / And it should come with a cause . \n + assertNotNull ( expected . getCause ( ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n + * @ param cause which triggers this migration . \n - final MigrationCallback callback ) throws FileNotFoundException { \n + final MigrationCallback callback , final RealmMigrationNeededException cause ) \n + throws FileNotFoundException { \n - throw new RealmMigrationNeededException ( configuration . getPath ( ) , "" RealmMigration must be provided "" ) ; \n + throw new RealmMigrationNeededException ( configuration . getPath ( ) , "" RealmMigration must be provided "" , cause ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ Realm . java \n - migrateRealm ( configuration ) ; \n + migrateRealm ( configuration , e ) ; \n - migrateRealm ( configuration , null ) ; \n + migrateRealm ( configuration , ( RealmMigration ) null ) ; \n + } \n + \n + / * * \n + * Called when migration needed in the Realm initialization . \n + * \n + * @ param configuration { @ link RealmConfiguration } \n + * @ param cause which triggers this migration . \n + * @ throws FileNotFoundException if the Realm file doesn ' t exist . \n + * / \n + private static void migrateRealm ( final RealmConfiguration configuration , final RealmMigrationNeededException cause ) \n + throws FileNotFoundException { \n + BaseRealm . migrateRealm ( configuration , null , new MigrationCallback ( ) { \n + @ Override \n + public void migrationComplete ( ) { \n + } \n + } , cause ) ; \n - } ) ; \n + } , null ) ; \n",Add cause to RealmMigrationNeededException ( # 3482 ),80
CHANGELOG . md \n + * Upgrade ReLinker to 1 . 2 . 2 . \n realm \ realm - library \ build . gradle \n - compile ' com . getkeepsafe . relinker : relinker : 1 . 2 . 1 ' \n + compile ' com . getkeepsafe . relinker : relinker : 1 . 2 . 2 ' \n,Upgrade ReLinker to 1 . 2 . 2 ( # 3487 ),80
"realm \ realm - library \ src \ main \ cpp \ io _ realm _ RealmObjectSchema . cpp \n + \n + return NULL ; \n - Java _ io _ realm _ RealmObjectSchema _ nativeGetProperties ( JNIEnv * env , jclass type , jlong nativePtr ) { \n + Java _ io _ realm _ RealmObjectSchema _ nativeGetProperties ( JNIEnv * env , jclass , jlong nativePtr ) { \n + \n + return NULL ; \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ RealmSchema . cpp \n + return 0 ; \n + return NULL ; \n realm \ realm - library \ src \ main \ cpp \ java _ binding _ context . hpp \n - JavaBindingContext ( const ConcreteJavaBindContext & ) ; \n + explicit JavaBindingContext ( const ConcreteJavaBindContext & ) ; \n + JavaBindingContext ( const JavaBindingContext & ) = delete ; \n + JavaBindingContext & operator = ( const JavaBindingContext & ) = delete ; \n + JavaBindingContext ( JavaBindingContext & & ) = delete ; \n + JavaBindingContext & operator = ( JavaBindingContext & & ) = delete ; \n + \n realm \ realm - library \ src \ main \ cpp \ objectserver _ shared . hpp \n - JniSession ( ) = delete ; \n + JniSession ( const JniSession & ) = delete ; \n + JniSession & operator = ( const JniSession & ) = delete ; \n + JniSession ( JniSession & & ) = delete ; \n + JniSession & operator = ( JniSession & & ) = delete ; \n + \n - g _ vm - > AttachCurrentThread ( & env , nullptr ) ; \n + g _ vm - > AttachCurrentThread ( & local _ env , nullptr ) ; \n realm \ realm - library \ src \ main \ cpp \ util . cpp \n - TR _ ERR ( env , "" ERROR : Couldn ' t throw exception . "" , NULL ) \n + TR _ ERR _ NO _ VA _ ARG ( env , "" ERROR : Couldn ' t throw exception . "" ) \n + / / Initial value to suppress gcc warning . \n realm \ realm - library \ src \ main \ cpp \ util . hpp \n + # define TR _ ERR _ NO _ VA _ ARG ( env , msg ) if ( trace _ level < = io _ realm _ log _ LogLevel _ ERROR ) { log _ message ( env , log _ error , msg ) ; } else { } \n + # define TR _ ERR _ NO _ VA _ ARG ( env , msg ) \n - TR _ ERR ( env , "" Expected nullable column type "" , NULL ) \n + TR _ ERR _ NO _ VA _ ARG ( env , "" Expected nullable column type "" ) \n",Fix some native compiling warnings ( # 185 ) \n Close # 184,80
realm \ realm - library \ src \ objectServer \ java \ io \ realm \ SyncConfiguration . java \n + / * FIXME : Disable this API since we cannot support it without https : / / github . com / realm / realm - core / issues / 2165 \n + * / \n realm \ realm - library \ src \ objectServer \ java \ io \ realm \ User . java \n - * < p > \n - * Any Realms owned by the user will be deleted if { @ link SyncConfiguration . Builder # deleteRealmOnLogout ( ) } is \n - * also set . \n + / * FIXME : Add this back to the javadoc when enable SyncConfiguration . Builder # deleteRealmOnLogout ( ) \n + < p > \n + Any Realms owned by the user will be deleted if { @ link SyncConfiguration . Builder # deleteRealmOnLogout ( ) } is \n + also set . \n + * / \n + / / FIXME : This will always be false since SyncConfiguration . Builder . deleteRealmOnLogout ( ) is \n + / / disabled . Make sure this works for Realm opened in the client thread / other processes . \n,Disable SyncConfig . Builder . deleteRealmOnLogout ( # 139 ) \n See https : / / github . com / realm / realm - core / issues / 2165,80
"realm \ realm - library \ build . gradle \n + ext . ccachePath = project . findProperty ( ' ccachePath ' ) ? : System . getenv ( ' NDK _ CCACHE ' ) \n + ext . lcachePath = project . findProperty ( ' lcachePath ' ) ? : System . getenv ( ' NDK _ LCACHE ' ) \n + if ( project . ccachePath ) arguments "" - DNDK _ CCACHE = $ project . ccachePath "" \n + if ( project . lcachePath ) arguments "" - DNDK _ LCACHE = $ project . lcachePath "" \n realm \ realm - library \ src \ main \ cpp \ CMakeLists . txt \n + # Setup lcache \n + if ( NDK _ LCACHE ) \n + set ( CMAKE _ CXX _ CREATE _ SHARED _ LIBRARY "" $ { NDK _ LCACHE } $ { CMAKE _ CXX _ CREATE _ SHARED _ LIBRARY } "" ) \n + endif ( ) \n + \n - \n","Accelerate build with ccache and lcache ( # 3523 ) \n See https : / / github . com / beeender / lcache for source code for lcache . \n It is very simple right now . It identify if the link target is cached by \n using checksums from command line + checksums of all input files . \n The realm - library gradle check those paths from project properties first \n , then the system env . \n So those can be set in the ~ / . gradle / gradle . properties like : \n ccachePath = / usr / bin / ccache \n lcachePath = / usr / bin / lcache \n Or by system ENVs like : \n NDK _ CCACHE = / usr / bin / ccache \n NDK _ LCACHE = / usr / bin / lcache",80
"realm \ realm - annotations - processor \ src \ main \ java \ io \ realm \ processor \ RealmProxyClassGenerator . java \n - . emitStatement ( "" CacheData < % s > cachedObject = ( CacheData ) cache . get ( realmObject ) "" , className ) \n + . emitStatement ( "" CacheData < RealmObject > cachedObject = cache . get ( realmObject ) "" ) \n - . emitStatement ( "" return cachedObject . object "" ) \n + . emitStatement ( "" return ( % s ) cachedObject . object "" , className ) \n - . emitStatement ( "" standaloneObject = cachedObject . object "" ) \n + . emitStatement ( "" standaloneObject = ( % s ) cachedObject . object "" , className ) \n realm \ realm - annotations - processor \ src \ test \ resources \ io \ realm \ AllTypesRealmProxy . java \n - CacheData < AllTypes > cachedObject = ( CacheData ) cache . get ( realmObject ) ; \n + CacheData < RealmObject > cachedObject = cache . get ( realmObject ) ; \n - return cachedObject . object ; \n + return ( AllTypes ) cachedObject . object ; \n - standaloneObject = cachedObject . object ; \n + standaloneObject = ( AllTypes ) cachedObject . object ; \n realm \ realm - annotations - processor \ src \ test \ resources \ io \ realm \ BooleansRealmProxy . java \n - CacheData < Booleans > cachedObject = ( CacheData ) cache . get ( realmObject ) ; \n + CacheData < RealmObject > cachedObject = cache . get ( realmObject ) ; \n - return cachedObject . object ; \n + return ( Booleans ) cachedObject . object ; \n - standaloneObject = cachedObject . object ; \n + standaloneObject = ( Booleans ) cachedObject . object ; \n realm \ realm - annotations - processor \ src \ test \ resources \ io \ realm \ NullTypesRealmProxy . java \n - CacheData < NullTypes > cachedObject = ( CacheData ) cache . get ( realmObject ) ; \n + CacheData < RealmObject > cachedObject = cache . get ( realmObject ) ; \n - return cachedObject . object ; \n + return ( NullTypes ) cachedObject . object ; \n - standaloneObject = cachedObject . object ; \n + standaloneObject = ( NullTypes ) cachedObject . object ; \n realm \ realm - annotations - processor \ src \ test \ resources \ io \ realm \ SimpleRealmProxy . java \n - CacheData < Simple > cachedObject = ( CacheData ) cache . get ( realmObject ) ; \n + CacheData < RealmObject > cachedObject = cache . get ( realmObject ) ; \n - return cachedObject . object ; \n + return ( Simple ) cachedObject . object ; \n - standaloneObject = cachedObject . object ; \n + standaloneObject = ( Simple ) cachedObject . object ; \n",Fix the cast in proxy generator for CacheData \n Close # 2354,80
realm \ realm - library \ src \ main \ java \ io \ realm \ OrderedRealmCollection . java \n - * @ return a sorted view of the collection . \n + * @ return a new sorted { @ link RealmResults } will be created and returned . The original collection stays unchanged . \n - * @ return a sorted view of the collection . \n + * @ return a new sorted { @ link RealmResults } will be created and returned . The original collection stays unchanged . \n - * @ return a sorted view of the collection . \n + * @ return a new sorted { @ link RealmResults } will be created and returned . The original collection stays unchanged . \n - * @ return a sorted view of the collection . \n + * @ return a new sorted { @ link RealmResults } will be created and returned . The original collection stays unchanged . \n,Java doc for RealmResults . sort ( # 2755 ),80
"realm \ realm - jni \ src \ io _ realm _ internal _ Table . cpp \n - JNIEnv * env , jobject , jlong nativeTablePtr , jlong columnIndex ) \n + JNIEnv * env , jclass , jlong nativeTablePtr , jlong columnIndex ) \n realm \ realm - jni \ src \ io _ realm _ internal _ Table . h \n - ( JNIEnv * , jobject , jlong , jlong ) ; \n + ( JNIEnv * , jclass , jlong , jlong ) ; \n",Static native method needs jclass ( # 3276 ),80
"CHANGELOG . md \n + * Error handler was not called when sync session failed ( # 3597 ) . \n realm \ realm - library \ src \ main \ cpp \ objectserver _ shared . hpp \n - m _ global _ obj _ ref = env - > NewGlobalRef ( java _ session _ obj ) ; \n - jobject global _ obj _ ref _ tmp ( m _ global _ obj _ ref ) ; \n + m _ java _ session _ ref = env - > NewGlobalRef ( java _ session _ obj ) ; \n + jobject global _ obj _ ref _ tmp ( m _ java _ session _ ref ) ; \n - / / FIXME : Simplify this by moving log _ message to AndroidLogger \n - std : : string log = num _ to _ string ( error _ code ) + "" "" + message . c _ str ( ) ; \n - log _ message ( local _ env , log _ debug , log . c _ str ( ) ) ; \n + jclass java _ session _ class = local _ env - > GetObjectClass ( global _ obj _ ref _ tmp ) ; \n + jmethodID notify _ error _ handler = local _ env - > GetMethodID ( java _ session _ class , \n + "" notifySessionError "" , "" ( ILjava / lang / String ; ) V "" ) ; \n + local _ env - > CallVoidMethod ( global _ obj _ ref _ tmp , \n + notify _ error _ handler , error _ code , env - > NewStringUTF ( message . c _ str ( ) ) ) ; \n - env - > DeleteGlobalRef ( m _ global _ obj _ ref ) ; \n + env - > DeleteGlobalRef ( m _ java _ session _ ref ) ; \n - jobject m _ global _ obj _ ref ; \n + jobject m _ java _ session _ ref ; \n realm \ realm - library \ src \ objectServer \ java \ io \ realm \ internal \ objectserver \ SyncSession . java \n - / / Called from Session . cpp and SyncMaanger \n + / / Called from JniSession in native code . \n + @ SuppressWarnings ( "" unused "" ) \n - void notifySessionError ( int errorCode , String errorMessage ) { \n + private void notifySessionError ( int errorCode , String errorMessage ) { \n",Call notifySessionError from native code ( # 3620 ) \n Fix # 3597,80
Dockerfile \n + ENV ANDROID _ NDK / opt / android - ndk \n,Add ANDROID _ NDK back ( # 3676 ),80
realm \ realm - library \ src \ main \ cpp \ CMakeLists . txt \n - set ( jni _ headers _ PATH $ { PROJECT _ BINARY _ DIR } / jni _ include ) \n + # / . / is the workaround for the problem that AS cannot find the jni headers . \n + # See https : / / github . com / googlesamples / android - ndk / issues / 319 \n + set ( jni _ headers _ PATH / . / $ { PROJECT _ BINARY _ DIR } / jni _ include ) \n,Workaround for jni headers path in AS ( # 3706 ) \n See https : / / github . com / googlesamples / android - ndk / issues / 319,80
"Dockerfile \n + ENV NDK _ LCACHE / usr / bin / lcache \n + \n + # Install lcache \n + RUN wget - q https : / / github . com / beeender / lcache / releases / download / v0 . 0 . 2 / lcache - linux - O / usr / bin / lcache & & \ \n + chmod + x / usr / bin / lcache \n Jenkinsfile \n + "" - v $ { env . HOME } / lcache : / tmp / . lcache "" + \n",Enable lcache on CI ( # 3717 ),80
CHANGELOG . md \n + * RealmTransformer fails because of missing annotation classes in user ' s project . ( # 2413 ) \n realm - transformer \ src \ main \ groovy \ io \ realm \ transformer \ RealmTransformer . groovy \n - it . getAnnotations ( ) \n,"Useless line triggers bugs \n getAnnotations will return all Annotation classes , if the class doesn ' t \n exist in the transformer project , exception will be thrown . \n Fix # 2413",80
"realm \ realm - library \ build . gradle \n + ext . ccachePath = project . findProperty ( ' ccachePath ' ) ? : System . getenv ( ' NDK _ CCACHE ' ) \n + ext . lcachePath = project . findProperty ( ' lcachePath ' ) ? : System . getenv ( ' NDK _ LCACHE ' ) \n + if ( project . ccachePath ) arguments "" - DNDK _ CCACHE = $ project . ccachePath "" \n + if ( project . lcachePath ) arguments "" - DNDK _ LCACHE = $ project . lcachePath "" \n realm \ realm - library \ src \ main \ cpp \ CMakeLists . txt \n + # Setup lcache \n + if ( NDK _ LCACHE ) \n + set ( CMAKE _ CXX _ CREATE _ SHARED _ LIBRARY "" $ { NDK _ LCACHE } $ { CMAKE _ CXX _ CREATE _ SHARED _ LIBRARY } "" ) \n + endif ( ) \n + \n - \n","Accelerate build with ccache and lcache ( # 3523 ) ( # 3609 ) \n See https : / / github . com / beeender / lcache for source code for lcache . \n It is very simple right now . It identify if the link target is cached by \n using checksums from command line + checksums of all input files . \n The realm - library gradle check those paths from project properties first \n , then the system env . \n So those can be set in the ~ / . gradle / gradle . properties like : \n ccachePath = / usr / bin / ccache \n lcachePath = / usr / bin / lcache \n Or by system ENVs like : \n NDK _ CCACHE = / usr / bin / ccache \n NDK _ LCACHE = / usr / bin / lcache",80
realm \ realm - library \ build . gradle \n - if ( ! project . hasProperty ( ' android . injected . build . abi ' ) & & project . hasProperty ( ' buildTargetABIs ' ) ) { \n + if ( project . hasProperty ( ' buildTargetABIs ' ) ) { \n,"Ignore android . injected . build . abi ( # 3612 ) \n It is set by AS randomly for some reasons , seems AS will inject ABIs \n according to execution target . But it is not having the right ABI values \n all the time . So just disable it , only check buildTargetABIs property .",80
CHANGELOG . md \n + # # # Enhancements \n + \n + * Reduce transformer logger verbosity ( # 3608 ) . \n + \n - # # # Enhancements \n - \n - * Reduce transformer logger verbosity ( # 3608 ) . \n - \n,Wrong entry in the change log ( # 3617 ),80
"CHANGELOG . md \n + # # # Enhancements \n + \n + * Prints path when file related exceptions thrown . \n + \n realm \ realm - jni \ src \ util . cpp \n + catch ( File : : AccessError & e ) { \n + ss < < e . what ( ) < < "" path : "" < < e . get _ path ( ) < < "" in "" < < file < < "" line "" < < line ; \n + ThrowException ( env , IllegalArgument , ss . str ( ) ) ; \n + } \n realm \ realm - jni \ src \ util . hpp \n - ThrowException ( env , IOFailed , string ( fileName ) , string ( "" Permission denied . "" ) + e . what ( ) ) ; \ \n + ThrowException ( env , IOFailed , string ( fileName ) , \ \n + std : : string ( e . what ( ) ) + "" path : "" + e . get _ path ( ) ) ; \ \n - catch ( util : : File : : NotFound & ) { \ \n - ThrowException ( env , FileNotFound , string ( fileName ) . data ( ) ) ; \ \n + catch ( util : : File : : NotFound & e ) { \ \n + ThrowException ( env , FileNotFound , string ( fileName ) , \ \n + std : : string ( e . what ( ) ) + "" path : "" + e . get _ path ( ) ) ; \ \n - ThrowException ( env , FileAccessError , string ( fileName ) , e . what ( ) ) ; \ \n + ThrowException ( env , FileAccessError , string ( fileName ) , \ \n + std : : string ( e . what ( ) ) + "" path : "" + e . get _ path ( ) ) ; \ \n",Print path info of File : : AccessError ( # 2768 ),80
"realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ utils \ HttpUtils . java \n + import io . realm . log . RealmLog ; \n - System . out . println ( responseHeaders . name ( i ) + "" : "" + responseHeaders . value ( i ) ) ; \n + RealmLog . debug ( responseHeaders . name ( i ) + "" : "" + responseHeaders . value ( i ) ) ; \n - System . out . println ( response . body ( ) . string ( ) ) ; \n + RealmLog . debug ( response . body ( ) . string ( ) ) ; \n - int retryTimes = 20 ; \n + int retryTimes = 50 ; \n + RealmLog . error ( "" Error response from auth server : % s "" , response . toString ( ) ) ; \n - e . printStackTrace ( ) ; \n - Thread . sleep ( 50 ) ; \n + RealmLog . error ( e ) ; \n + Thread . sleep ( 100 ) ; \n - System . out . println ( responseHeaders . name ( i ) + "" : "" + responseHeaders . value ( i ) ) ; \n + RealmLog . debug ( responseHeaders . name ( i ) + "" : "" + responseHeaders . value ( i ) ) ; \n - System . out . println ( response . body ( ) . string ( ) ) ; \n + RealmLog . debug ( response . body ( ) . string ( ) ) ; \n","Waiting longer time for checking auth server ( # 3913 ) \n From log i saw sometimes the ros testing server fails to send \n the response , maybe 20 + 50 = 1s sometimes is too short \n when the docker host is under heave loading .",80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n - @ Test \n - @ RunTestInLooperThread \n - public void realmListenerAddedAfterCommit ( ) { \n - Realm realm = looperThread . realm ; \n - realm . beginTransaction ( ) ; \n - realm . commitTransaction ( ) ; \n - \n - realm . addChangeListener ( new RealmChangeListener < Realm > ( ) { \n - @ Override \n - public void onChange ( Realm object ) { \n - looperThread . testComplete ( ) ; \n - } \n - } ) ; \n - } \n - \n,Remove realmListenerAddedAfterCommit \n This test is not needed since the listener won ' t be triggered anymore \n when Realm advanced before add listener .,80
"realm \ realm - library \ src \ androidTestObjectServer \ java \ io \ realm \ SyncUserTests . java \n + Realm . init ( InstrumentationRegistry . getInstrumentation ( ) . getContext ( ) ) ; \n + assertNotNull ( savedUser ) ; \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ RealmFileUserStore . cpp \n - static const char * ERR _ MULTIPLE _ LOGGED _ IN _ USERS = "" Cannot be called if more that one valid , logged in user exists . "" ; \n - static const std : : shared _ ptr < SyncUser > & currentUserOrThrow ( ) ; \n - \n - const std : : shared _ ptr < SyncUser > & user = currentUserOrThrow ( ) ; \n - if ( user - > state ( ) = = SyncUser : : State : : Active ) { \n + \n + const std : : shared _ ptr < SyncUser > & user = SyncManager : : shared ( ) . get _ current _ user ( ) ; \n + if ( user ) { \n - const std : : shared _ ptr < SyncUser > & user = currentUserOrThrow ( ) ; \n - user - > log _ out ( ) ; \n + const std : : shared _ ptr < SyncUser > & user = SyncManager : : shared ( ) . get _ current _ user ( ) ; \n + if ( user ) { \n + user - > log _ out ( ) ; \n + } else { \n + throw std : : runtime _ error ( ERR _ NO _ LOGGED _ IN _ USER ) ; \n + } \n - static const std : : shared _ ptr < SyncUser > & currentUserOrThrow ( ) / / throws \n - { \n - std : : vector < std : : shared _ ptr < SyncUser > > all _ users = SyncManager : : shared ( ) . all _ logged _ in _ users ( ) ; \n - if ( all _ users . size ( ) > 1 ) { \n - throw std : : runtime _ error ( ERR _ MULTIPLE _ LOGGED _ IN _ USERS ) ; \n - } else if ( all _ users . size ( ) < 1 ) { \n - throw std : : runtime _ error ( ERR _ NO _ LOGGED _ IN _ USER ) ; \n - } else { \n - return all _ users . front ( ) ; \n - } \n - } \n",Use SyncManager : : get _ current _ user \n Instead of iterating and return the first in JNI side . OS SyncManager \n will take care of throwing when more than one logged in users exist .,80
"realm \ realm - library \ src \ main \ cpp \ io _ realm _ RealmFileUserStore . cpp \n - std : : vector < std : : shared _ ptr < SyncUser > > valid _ users ; \n - jsize array _ length = std : : count _ if ( all _ users . begin ( ) , all _ users . end ( ) , \n - [ & ] ( const std : : shared _ ptr < SyncUser > & user ) { \n - if ( user - > state ( ) = = SyncUser : : State : : Active ) { \n - valid _ users . emplace _ back ( std : : move ( user ) ) ; \n - return true ; \n - } \n - return false ; \n - } ) ; \n - \n - jobjectArray users _ token = env - > NewObjectArray ( array _ length , java _ lang _ string , 0 ) ; \n - if ( users _ token = = NULL ) { \n + size _ t len = all _ users . size ( ) ; \n + jobjectArray users _ token = env - > NewObjectArray ( len , java _ lang _ string , 0 ) ; \n + if ( users _ token = = nullptr ) { \n - \n - for ( auto user : valid _ users ) { \n - env - > SetObjectArrayElement ( users _ token , - - array _ length , to _ jstring ( env , user - > refresh _ token ( ) . data ( ) ) ) ; \n + for ( int i = 0 ; i < len ; + + i ) { \n + env - > SetObjectArrayElement ( users _ token , i , to _ jstring ( env , all _ users [ i ] - > refresh _ token ( ) . data ( ) ) ) ; \n",all _ logged _ in _ users does checking active,80
README . md \n - repositories { \n - maven { \n - url ' http : / / oss . jfrog . org / artifactory / oss - snapshot - local ' \n + allprojects { \n + repositories { \n + maven { \n + url ' http : / / oss . jfrog . org / artifactory / oss - snapshot - local ' \n + } \n,snapshot local url should be inside allprojects \n Fix # 3935,80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ CollectionTests . java \n + / / Set the linked object to itself . \n + obj . setFieldObject ( obj ) ; \n,Population data of collection tests \n Set the linked object to itself for linked field sorting tests .,80
"realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ SharedRealm . cpp \n + ( * ptr ) - > close ( ) ; \n realm \ realm - library \ src \ main \ cpp \ util . cpp \n + catch ( Results : : InvalidatedException & e ) { \n + ss < < e . what ( ) < < "" in "" < < file < < "" line "" < < line ; \n + ThrowException ( env , IllegalState , ss . str ( ) ) ; \n + } \n","Call Realm : : close \n OS Results is actually holding a SharedRealm instance as a member var \n which means when call java Realm . close ( ) , the relevant Realm instance \n is not surely to be closed since it only release the shared ptr . \n Without closing the Realm , the validations in Results will be useless .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ internal \ CollectionTests . java \n - Collection collection = new Collection ( sharedRealm , table . where ( ) ) ; \n + Collection collection = new Collection ( sharedRealm , table . where ( ) . greaterThan ( new long [ ] { 2 } , 1 ) ) ; \n - assertEquals ( 4 , collection . size ( ) ) ; \n - assertEquals ( 4 , collection2 . size ( ) ) ; \n + assertEquals ( 2 , collection . size ( ) ) ; \n + assertEquals ( 2 , collection2 . size ( ) ) ; \n - assertEquals ( collection2 . getUncheckedRow ( 0 ) . getLong ( 2 ) , 1 ) ; \n - assertEquals ( collection2 . getUncheckedRow ( 3 ) . getLong ( 2 ) , 4 ) ; \n + assertEquals ( collection2 . getUncheckedRow ( 0 ) . getLong ( 2 ) , 3 ) ; \n + assertEquals ( collection2 . getUncheckedRow ( 1 ) . getLong ( 2 ) , 4 ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ Collection . java \n - private final TableQuery query ; \n + private final Table table ; \n - this . query = query ; \n + this . table = query . getTable ( ) ; \n - private Collection ( SharedRealm sharedRealm , TableQuery query , long nativePtr ) { \n - query . validateQuery ( ) ; \n + private Collection ( SharedRealm sharedRealm , Table table , long nativePtr ) { \n - this . query = query ; \n + this . table = table ; \n - return UncheckedRow . getByRowPointer ( query . table , nativeGetRow ( nativePtr , index ) ) ; \n + return UncheckedRow . getByRowPointer ( table , nativeGetRow ( nativePtr , index ) ) ; \n - return UncheckedRow . getByRowPointer ( query . table , nativeFirstRow ( nativePtr ) ) ; \n + return UncheckedRow . getByRowPointer ( table , nativeFirstRow ( nativePtr ) ) ; \n - return UncheckedRow . getByRowPointer ( query . table , nativeLastRow ( nativePtr ) ) ; \n + return UncheckedRow . getByRowPointer ( table , nativeLastRow ( nativePtr ) ) ; \n - return query . getTable ( ) ; \n + return table ; \n - return new TableQuery ( this . context , this . getTable ( ) , nativeQueryPtr ) ; \n + return new TableQuery ( this . context , this . table , nativeQueryPtr ) ; \n - return new Collection ( sharedRealm , query , nativeSort ( nativePtr , sortDescriptor ) ) ; \n + return new Collection ( sharedRealm , table , nativeSort ( nativePtr , sortDescriptor ) ) ; \n","Don ' t hold ref to query in Collection \n When build the OS Results , TableQuery will be consumed through the move \n constructor .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ TestHelper . java \n - if ( ! latch . await ( numberOfSeconds , TimeUnit . SECONDS ) ) { \n + if ( android . os . Debug . isDebuggerConnected ( ) ) { \n + / / If we are debugging the tests , just wait without a timeout . In case we are stopping at a break point \n + / / and timeout happens . \n + latch . await ( ) ; \n + } else if ( ! latch . await ( numberOfSeconds , TimeUnit . SECONDS ) ) { \n","Wait forever in debugging mode ( # 3943 ) \n * Wait forever in debugging mode \n It is quite annoy when we stop at a breakpoint the awaitOrFail timeout \n happens . By checking if the debugger connected , we can know we are \n actually debugging the test and don ' t want to be interrupted by the \n timeout .",80
"CHANGELOG . md \n + * NullPointerException when notifying a single object that it changed ( # 4086 ) . \n realm \ realm - library \ src \ main \ java \ io \ realm \ HandlerController . java \n - if ( RealmObject . isValid ( proxy ) ) { / / already completed & has a valid pointer no need to re - run \n - RealmLog . trace ( "" [ COMPLETED _ ASYNC _ REALM _ OBJECT % s ] , realm : % s . "" + \n - "" RealmObject is already loaded , just notify it "" , \n - realm , HandlerController . this ) ; \n - proxy . realmGet $ proxyState ( ) . notifyChangeListeners $ realm ( ) ; \n + if ( RealmObject . isLoaded ( proxy ) ) { / / already completed & has a valid pointer no need to re - run \n + if ( RealmObject . isValid ( proxy ) ) { \n + RealmLog . trace ( "" [ COMPLETED _ ASYNC _ REALM _ OBJECT % s ] , realm : % s . "" + \n + "" RealmObject is already loaded , just notify it "" , \n + realm , HandlerController . this ) ; \n + proxy . realmGet $ proxyState ( ) . notifyChangeListeners $ realm ( ) ; \n + } \n",RealmObject could be GCed when completedAsyncRealmObject ( # 4099 ),80
"realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 54a98b215284e58b73e0664723fbd852ffb04902 \n + Subproject commit d1a101fda6999e070c1e73cc5aff002c3de7c129 \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ SyncSessionTests . java \n + realm . close ( ) ; \n + adminRealm . close ( ) ; \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ suite \ IntegrationTestSuite . java \n + import io . realm . objectserver . ProgressListenerTests ; \n + import io . realm . objectserver . SyncSessionTests ; \n - ProcessCommitTests . class } ) \n + ProcessCommitTests . class , \n + ProgressListenerTests . class , \n + SyncSessionTests . class } ) \n","Unclosed realm & SyncManager : : reset _ for _ testing \n See https : / / github . com / realm / realm - object - store / pull / 532 \n When assertion enabled , those will fail earlier . Without the assertion , \n all different kind of native crash will happen . \n Update Object Store to d1a101fda6",80
version . txt \n - 3 . 6 . 0 \n + 3 . 6 . 1 - SNAPSHOT \n,Prepare next release v3 . 6 . 1 - SNAPSHOT,80
"realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ BaseIntegrationTest . java \n - * Stops the ROS instance used for the test . \n + * Stops the ROS instance used for the test . The { @ link # startSyncServer ( ) } will stop the sync server if needed , so \n + * normally there is no need to call this . \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ IsolatedIntegrationTests . java \n - stopSyncServer ( ) ; \n - stopSyncServer ( ) ; \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ StandardIntegrationTest . java \n - @ AfterClass \n - public static void tearDownTestClass ( ) throws Exception { \n - stopSyncServer ( ) ; \n - } \n - \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ utils \ HttpUtils . java \n + / * * \n + * Start the sync server . If the server has been started before , stop it first . \n + * / \n + / * * \n + * Stop the sync server if it is alive . { @ link # startSyncServer ( ) } will implicitly stop the server if needed , so \n + * normally there is no need to call this . \n + * / \n tools \ sync _ test _ server \ ros - testing - server . js \n + stopRealmObjectServer ( ( ) = > { \n + doStartRealmObjectServer ( onSuccess , onError ) \n + } , onError ) \n + } \n + \n + function doStartRealmObjectServer ( onSuccess , onError ) { \n - if ( syncServerChildProcess = = null ) { \n - onError ( "" No ROS process found to stop "" ) ; \n + if ( syncServerChildProcess = = null | | syncServerChildProcess . killed ) { \n + onSuccess ( "" No ROS process found or the process has been killed before "" ) ; \n","Fix a socket timeout issue with test server ( # 5466 ) \n * Fix a socket timeout issue with test server \n If startRealmObjectServer was called twice without stop in between , \n syncServerChildProcess will be overwritten by a terminated process since \n the 2nd call of creating sync server will fail and set the syncServerChildProcess . \n This would make the stopRealmObjectServer get stuck forever . \n In practice , we need to make sure the server has been stopped before \n start it . So just treat the "" start "" as a "" restart "" command which will \n stop the sync server if needed . \n Thus , no need to stop in tear down functions in java side anymore . \n * remove useless function",80
"CHANGELOG . md \n + * Fixed "" too many open files "" issue ( # 4002 ) . \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit ac2f60726434654cace0bb5e57a92df7555c8f1f \n + Subproject commit 163c1e8fb026a05d281e82096e64622d2e735f17 \n",Fix too many open files crash \n Update object store to 163c1e8fb0 to fix # 4002,80
realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ SharedRealm . cpp \n - / / FIXME : Disabled for the collection notifications . There might be some places still need it . \n - / / advance _ read needs to be handled by Java because of async query . \n - / / shared _ realm - > set _ auto _ refresh ( false ) ; \n,"Remove set _ auto _ refresh FIXME \n It is not necessary . The only place we might need it is the async \n transaction . But as long as we close the SharedRealm instance \n immediately , there is no difference by setting it or not .",80
realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 3ee17d16b4f484a8cb673d8e40477f14f50649d8 \n + Subproject commit ebadc31fd59c51f4eb6f86f974c0e4d915ed09e6 \n,Update Object Store for client reset issue \n Update it to ebadc31fd5 \n For # 4053,80
"realm \ realm - library \ src \ main \ cpp \ util . cpp \n + # include < realm / util / file . hpp > \n + catch ( File : : AccessError & e ) { \n + ss < < e . what ( ) < < "" ( "" < < e . get _ path ( ) < < "" ) in "" < < file < < "" line "" < < line ; \n + ThrowException ( env , FatalError , ss . str ( ) ) ; \n + } \n",Print the path when get File : : AccessError ( # 4068 ),80
version . txt \n - 2 . 3 . 0 \n + 2 . 3 . 1 - SNAPSHOT \n,Prepare next release v2 . 3 . 1 - SNAPSHOT,80
version . txt \n - 2 . 3 . 0 \n + 2 . 3 . 1 - SNAPSHOT \n,Prepare next release v2 . 3 . 1 - SNAPSHOT,80
Jenkinsfile \n - / / Clean any potential old containers \n - sh ' docker rm ros | | true ' \n - \n,No need to delete ros docker anymore ( # 4082 ),80
realm \ realm - library \ src \ main \ java \ io \ realm \ log \ RealmLog . java \n + if ( level < getLevel ( ) ) { \n + return ; \n + } \n + \n,Only format log message if the level is enabled \n fix # 4734,80
"tools \ release . sh \n + git submodule update - - init - - recursive \n - sed - i . bak "" 1 s / YYYY - MM - DD / $ { cur _ date } / "" CHANGELOG . md \n + sed "" 1 s / YYYY - MM - DD / $ { cur _ date } / "" CHANGELOG . md > CHANGELOG . md . tmp & & mv CHANGELOG . md . tmp CHANGELOG . md \n",Fix release script ( # 5185 ) \n - sed for Mac and Linux . \n - Update submodule when release from master branch .,80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ ManagedRealmListForValueTests . java \n - @ Test ( expected = IllegalStateException . class ) \n + @ Test ( expected = UnsupportedOperationException . class ) \n - thrown . expect ( IllegalStateException . class ) ; \n + thrown . expect ( UnsupportedOperationException . class ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmList . java \n - throw new IllegalStateException ( ALLOWED _ ONLY _ FOR _ REALM _ MODEL _ ELEMENT _ MESSAGE ) ; \n + throw new UnsupportedOperationException ( ALLOWED _ ONLY _ FOR _ REALM _ MODEL _ ELEMENT _ MESSAGE ) ; \n - throw new IllegalStateException ( ALLOWED _ ONLY _ FOR _ REALM _ MODEL _ ELEMENT _ MESSAGE ) ; \n + throw new UnsupportedOperationException ( ALLOWED _ ONLY _ FOR _ REALM _ MODEL _ ELEMENT _ MESSAGE ) ; \n,UOE instead of IAE for methods in value list,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ ManagedOrderedRealmCollectionTests . java \n - return realm . where ( Dog . class ) . findAll ( ) ; \n + return realm . where ( Dog . class ) . findAllSorted ( Dog . FIELD _ AGE ) ; \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ Collection . cpp \n - if ( wrapper - > m _ results . size ( ) > 0 ) { \n - wrapper - > m _ results . get _ tableview ( ) . remove _ last ( ) ; \n + auto row = wrapper - > m _ results . last ( ) ; \n + if ( row & & row - > is _ attached ( ) ) { \n + row - > move _ last _ over ( ) ; \n - if ( wrapper - > m _ results . size ( ) > 0 ) { \n - wrapper - > m _ results . get _ tableview ( ) . remove ( 0 ) ; \n + auto row = wrapper - > m _ results . first ( ) ; \n + if ( row & & row - > is _ attached ( ) ) { \n + row - > move _ last _ over ( ) ; \n - auto view = wrapper - > m _ results . get _ tableview ( ) ; \n - size _ t size = view . size ( ) ; \n - if ( index < 0 | | index > = static _ cast < jlong > ( size ) ) { \n - throw Results : : OutOfBoundsIndexException { static _ cast < size _ t > ( index ) , size } ; \n + auto row = wrapper - > m _ results . get ( index ) ; \n + if ( row . is _ attached ( ) ) { \n + row . move _ last _ over ( ) ; \n - view . remove ( static _ cast < size _ t > ( index ) ) ; \n",Use move _ last _ over to do deletion for Collection,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ TypeBasedNotificationsTests . java \n - realm . addChangeListener ( new RealmChangeListener < Realm > ( ) { \n - @ Override \n - public void onChange ( Realm object ) { \n - looperThread . postRunnable ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - assertEquals ( NUMBER _ OF _ LISTENERS , typebasedCommitInvocations . get ( ) ) ; \n - looperThread . testComplete ( ) ; \n - } \n - } ) ; \n - } \n - } ) ; \n - public void onChange ( RealmResults < Dog > object ) { \n - typebasedCommitInvocations . incrementAndGet ( ) ; \n + public void onChange ( RealmResults < Dog > results ) { \n + assertEquals ( 17 , results . first ( ) . getAge ( ) ) ; \n + if ( typebasedCommitInvocations . incrementAndGet ( ) = = NUMBER _ OF _ LISTENERS ) { \n + looperThread . testComplete ( ) ; \n + } \n + assertTrue ( typebasedCommitInvocations . get ( ) < = NUMBER _ OF _ LISTENERS ) ; \n",Fix flaky test \n There is no guarantee that posted event will be arrived later than \n Object Store notification .,80
"realm \ realm - library \ src \ main \ cpp \ CMakeLists . txt \n - message ( FATAL _ ERROR "" Cannot find core lib file : $ { core _ lib _ PATH } "" ) \n + message ( FATAL _ ERROR "" Cannot find core lib file : $ { sync _ lib _ PATH } "" ) \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ objectserver _ ObjectServerSession . cpp \n - JniSession * session = SS ( sessionPointer ) ; \n + JniSession * session = reinterpret _ cast < JniSession * > ( sessionPointer ) ; \n - JniSession * session _ wrapper = SS ( sessionPointer ) ; \n + JniSession * session _ wrapper = reinterpret _ cast < JniSession * > ( sessionPointer ) ; \n - JniSession * session _ wrapper = SS ( sessionPointer ) ; \n + JniSession * session _ wrapper = reinterpret _ cast < JniSession * > ( sessionPointer ) ; \n realm \ realm - library \ src \ main \ cpp \ util . hpp \n - # include < realm / sync / client . hpp > \n - # define SC ( ptr ) reinterpret _ cast < realm : : sync : : Client * > ( ptr ) \n - # define SS ( ptr ) reinterpret _ cast < JniSession * > ( ptr ) \n",Fix build base with core only ( # 4220 ) \n - The error message shout be sync lib \n - The util . hpp contains some sync only headers . It causes problem when \n build with core only for base flavour . \n - We have an agreement that use macro to do casting should be avoided \n since it is less readable .,80
"realm \ realm - library \ src \ main \ cpp \ util . hpp \n - / / Use this macro when logging a pointer using ' % p ' \n - # define VOID _ PTR ( ptr ) reinterpret _ cast < void * > ( ptr ) \n - \n + / / TODO : Clean up those marcos . Casting with marcos reduces the readability , and it is actually breaking the C + + type \n + / / conversion . e . g . : You cannot cast a pointer with S64 below . \n - / / Use S64 ( ) when logging \n - realm : : jni _ util : : Log : : e ( "" Table % 1 is no longer attached ! "" , VOID _ PTR ( objPtr ) ) ; \n + realm : : jni _ util : : Log : : e ( "" Table % 1 is no longer attached ! "" , reinterpret _ cast < int64 _ t > ( objPtr ) ) ; \n - realm : : jni _ util : : Log : : e ( "" Row % 1 is no longer attached ! "" , VOID _ PTR ( rowPtr ) ) ; \n + realm : : jni _ util : : Log : : e ( "" Row % 1 is no longer attached ! "" , reinterpret _ cast < int64 _ t > ( rowPtr ) ) ; \n",Cast to int64 _ t when logging ( # 4226 ) \n Otherwise is will be casted to bool when formatting . \n Also S64 cast won ' t work . So casting macros is still a bad idea : ),80
"CHANGELOG . md \n + * ` UnsatisfiedLinkError ` caused by ` pipe2 ` ( # 3945 ) . \n + * Unrecoverable error with message "" Try again "" when the notification fifo is full ( # 3964 ) . \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 99570ba6e0711820ef71b20d7ce0975b52cfd197 \n + Subproject commit 814beb5a1e96f0bb72cf78e206b2e710ac79e217 \n",Update object store \n to 814beb5a1e9 \n Fix # 3945 \n Fix # 3964,80
"realm \ config \ checkstyle \ checkstyle . xml \n - < property name = "" format "" value = "" ^ \ s * ( for | if | while | try ) [ ^ ] "" / > \n + < property name = "" format "" value = "" ^ \ s * ( for | if | while | try ) \ b [ ^ ] "" / > \n",Fix checkstyle space before opening parenthesis \n It should match : \n if ( ) \n but not : \n ifSomething ( ) .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ rule \ RunTestWithRemoteService . java \n - Class < ? extends RemoteTestService > value ( ) ; \n + Class < ? extends RemoteTestService > remoteService ( ) ; \n + boolean onLooperThread ( ) ; \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ rule \ RunWithRemoteService . java \n - * 5 . You also need a looper in your test thread . Normally you can just use { @ link RunTestInLooperThread } . \n + * 5 . To run the tests on the looper thread : \n + * a ) Add { @ link RunTestInLooperThread } to the tests . \n + * b ) Add { @ code @ RunTestWithRemoteService ( remoteService = SimpleCommitRemoteService . class , onLooperThread = true ) } \n + * Please notice that { @ code onLooperThread } needs to be set to true to avoid the remote service getting killed \n + * before looper thread finished \n + * c ) Call { @ code looperThread . runAfterTest ( remoteService . afterRunnable ) } to kill the remote service after test . \n + public Runnable afterRunnable = new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + after ( ) ; \n + } \n + } ; \n - public void after ( ) { \n + private void after ( ) { \n - before ( annotation . value ( ) ) ; \n + before ( annotation . remoteService ( ) ) ; \n - after ( ) ; \n + if ( ! annotation . onLooperThread ( ) ) { \n + after ( ) ; \n + } \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ ProcessCommitTests . java \n - @ RunTestWithRemoteService ( SimpleCommitRemoteService . class ) \n + @ RunTestWithRemoteService ( remoteService = SimpleCommitRemoteService . class , onLooperThread = true ) \n + looperThread . runAfterTest ( remoteService . afterRunnable ) ; \n - @ RunTestWithRemoteService ( ALotCommitsRemoteService . class ) \n + @ RunTestWithRemoteService ( remoteService = ALotCommitsRemoteService . class , onLooperThread = true ) \n + looperThread . runAfterTest ( remoteService . afterRunnable ) ; \n","Fix multi - processes tests \n When running remote service test , the remote service is killed in after \n function . It is too early when running it together with looper thread \n test .",80
"CHANGELOG . md \n + * ` findFirstAsync ( ) ` now returns an invalid object if there is no object matches the query condition instead of running the query repeatedly until it can find one ( # 4352 ) . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + / / When there is no object match the query condition , findFirstAsync should return with an invalid row . \n - public void findFirstAsync _ initalEmptyRow ( ) throws Throwable { \n + public void findFirstAsync _ initialEmptyRow ( ) throws Throwable { \n - assertTrue ( firstAsync . load ( ) ) ; \n - assertTrue ( firstAsync . isValid ( ) ) ; \n - assertEquals ( 0 , firstAsync . getColumnLong ( ) ) ; \n + assertFalse ( firstAsync . isValid ( ) ) ; \n - \n - realm . beginTransaction ( ) ; \n - realm . createObject ( AllTypes . class ) . setColumnLong ( 0 ) ; \n - realm . commitTransaction ( ) ; \n - \n - assertTrue ( firstAsync . load ( ) ) ; \n - assertTrue ( firstAsync . isLoaded ( ) ) ; \n - public void findFirstAsync _ updatedIfsyncRealmObjectIsUpdated ( ) throws Throwable { \n + public void findFirstAsync _ updatedIfSyncRealmObjectIsUpdated ( ) throws Throwable { \n realm \ realm - library \ src \ main \ java \ io \ realm \ ProxyState . java \n - if ( realm . sharedRealm = = null | | realm . sharedRealm . isClosed ( ) ) { \n + if ( realm . sharedRealm = = null | | realm . sharedRealm . isClosed ( ) | | ! row . isAttached ( ) ) { \n - / / getTable should return a non - null table since the row should always be valid here . \n - currentTableVersion = row . getTable ( ) . getVersion ( ) ; \n - registerToRealmNotifier ( ) ; \n + if ( row . isAttached ( ) ) { \n + / / getTable should return a non - null table since the row should always be valid here . \n + currentTableVersion = row . getTable ( ) . getVersion ( ) ; \n + registerToRealmNotifier ( ) ; \n + } \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ PendingRow . java \n - clearPendingCollection ( ) ; \n + } else { \n + frontEnd . onQueryFinished ( InvalidRow . INSTANCE ) ; \n - } else { \n - / / The Realm is closed . Do nothing then . \n - clearPendingCollection ( ) ; \n + \n + clearPendingCollection ( ) ; \n",findFirstAsync returns invalid row if no object \n Fix # 4352 \n The findFirstAsync ( ) ' s behavior doesn ' t match the javadoc from the first \n day the API was introduced . It kept running the query until it could \n find a row match the query condition . This behavior create difficulties \n if user want to check if there is no object in the db . Also it was not \n consistent with the behavior of findFirst ( ) which will return an invalid \n row in the same condition .,80
"realm \ realm - library \ src \ main \ java \ io \ realm \ RealmQuery . java \n - * Similar to { @ link # findFirst ( ) } but runs asynchronously on a worker thread \n - * This method is only available from a Looper thread . \n - * \n - * @ return immediately an empty { @ link RealmObject } . Trying to access any field on the returned object \n - * before it is loaded will throw an { @ code IllegalStateException } . Use { @ link RealmObject # isLoaded ( ) } to check if \n - * the object is fully loaded or register a listener { @ link io . realm . RealmObject # addChangeListener } \n - * to be notified when the query completes . If no RealmObject was found after the query completed , the returned \n - * RealmObject will have { @ link RealmObject # isLoaded ( ) } set to { @ code true } and { @ link RealmObject # isValid ( ) } set to \n - * { @ code false } . \n + * Similar to { @ link # findFirst ( ) } but runs asynchronously on a worker thread . An listener should be registered to \n + * the returned { @ link RealmObject } to get the notification when query completes . The registered listener will also \n + * be triggered if there are changes made to the queried { @ link RealmObject } . If the { @ link RealmObject } is deleted , \n + * the listener will be called one last time and then stop . The query will not be re - run . \n + * \n + * @ return immediately an empty { @ link RealmObject } with { @ code isLoaded ( ) = = false } . Trying to access any field on \n + * the returned object before it is loaded will throw an { @ code IllegalStateException } . \n + * @ throws IllegalStateException if this is called on a non - looper thread . \n",Javadoc for findFirstAsync ( # 4367 ) \n Fix # 4360,80
CHANGELOG . md \n - # # 2 . 2 . 2 ( 2016 - 01 - 16 ) \n + # # 2 . 2 . 2 ( 2017 - 01 - 16 ) \n,Fix date in changelog \n Problem was found by xiaolongyuan .,80
realm \ realm - library \ src \ main \ cpp \ util . cpp \n - # if REALM _ ENABLE _ SYNC \n - jclass java _ syncmanager ; \n - # endif \n realm \ realm - library \ src \ main \ cpp \ util . hpp \n - # if REALM _ ENABLE _ SYNC \n - extern jclass java _ syncmanager ; \n - # endif \n,Remove useless code \n These two line are supposed to be removed in # 4365 .,80
"CHANGELOG . md \n + * All Realm instances share a single notification daemon thread . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmTests . java \n + import java . io . FilenameFilter ; \n - assertEquals ( 2 , namedPipeDir . list ( ) . length ) ; \n + / / Only check the fifo file created by call , since all Realm instances share the same fifo created by \n + / / external _ commit _ helper which might not be created in the newly created dir if there are Realm instances \n + / / are not deleted when TestHelper . deleteRecursively ( namedPipeDir ) called . \n + File [ ] files = namedPipeDir . listFiles ( new FilenameFilter ( ) { \n + @ Override \n + public boolean accept ( File dir , String name ) { \n + return name . matches ( "" realm _ . * cv "" ) ; \n + } \n + } ) ; \n + assertEquals ( 1 , files . length ) ; \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ internal \ SharedRealmTests . java \n - } ) ; \n + } , true ) ; \n - } ) ; \n + } , true ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n - } ) ; \n + } , true ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SharedRealm . java \n + / / This will create a SharedRealm where autoChangeNotifications is false , \n + / / If autoChangeNotifications is true , an additional SharedGroup might be created in the OS ' s external commit helper . \n + / / That is not needed for some cases : eg . : An extra opened SharedGroup will cause a compact failure . \n - return getInstance ( config , null , null ) ; \n + return getInstance ( config , null , null , false ) ; \n - SchemaVersionListener schemaVersionListener ) { \n + SchemaVersionListener schemaVersionListener , boolean autoChangeNotifications ) { \n - boolean autoChangeNotifications = true ; \n","Single daemon thread for notification ( # 3666 ) \n With changes in https : / / github . com / realm / realm - object - store / pull / 197 , \n there is only one thread will be create for listening changes for all \n different Realms . But an additional SharedGroup will be created in the \n daemon thread for determine which SharedGroup has changed since last \n time . That requires some changes in the java side especially the daemon \n thread should not be created when Realm . compactRealm called .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmResultsTests . java \n - / / FIXME : Enable this when https : / / github . com / realm / realm - core / issues / 2378 fixed . \n - / / assertEquals ( 0 , dogs . where ( ) . findAll ( ) . size ( ) ) ; \n + assertEquals ( 0 , dogs . where ( ) . findAll ( ) . size ( ) ) ; \n - / / FIXME : Enable this when https : / / github . com / realm / realm - core / issues / 2378 fixed . \n - / / assertEquals ( 0 , dogs . where ( ) . findAll ( ) . size ( ) ) ; \n + assertEquals ( 0 , dogs . where ( ) . findAll ( ) . size ( ) ) ; \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ Collection . cpp \n - Query * query = new Query ( wrapper - > get _ original _ results ( ) . get _ query ( ) ) ; \n + auto table _ view = wrapper - > get _ original _ results ( ) . get _ tableview ( ) ; \n + Query * query = new Query ( table _ view . get _ parent ( ) , \n + std : : unique _ ptr < TableViewBase > ( new TableView ( std : : move ( table _ view ) ) ) ) ; \n",Collection . where ( ) should build query on tableview,80
CHANGELOG . md \n + * Crash with ` LogicError ` with ` Bad version number ` on notifier thread ( # 4369 ) . \n + \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 3eada170f380174992b47b6023f375f3f372a9d2 \n + Subproject commit 3b6c0f611061dddabc489f0b9f264306893c96c8 \n,Update object store ( # 4420 ) \n to 3b6c0f6110 . \n Fix # 4369,80
CHANGELOG . md \n - # # 3 . 1 . 4 \n + # # 3 . 1 . 4 ( YYYY - MM - DD ) \n,Date placeholder is needed for release script \n Otherwise the release script won ' t work .,80
version . txt \n - 3 . 1 . 4 \n + 3 . 1 . 5 - SNAPSHOT \n,Prepare next release v3 . 1 . 5 - SNAPSHOT,80
realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ CheckedRow . cpp \n - return NULL ; \n + return nullptr ; \n - return 0 ; \n + return JNI _ FALSE ; \n - return 0 ; \n + return nullptr ; \n - return 0 ; \n + return nullptr ; \n - return 0 ; \n + return JNI _ FALSE ; \n,Fix return values in JNI unchecked row \n Fix # 4505,80
"CHANGELOG . md \n + * ` NullPointerException ` caused by local transaction inside the listener of ` findFirstAsync ( ) ` ' s results ( # 4495 ) . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n - Realm Realm = looperThread . realm ; \n - populateTestRealm ( Realm , 10 ) ; \n - final AllTypes realmResults = Realm . where ( AllTypes . class ) \n + Realm realm = looperThread . realm ; \n + populateTestRealm ( realm , 10 ) ; \n + final AllTypes realmResults = realm . where ( AllTypes . class ) \n + / / For issue https : / / github . com / realm / realm - java / issues / 4495 \n + @ Test \n + @ RunTestInLooperThread \n + public void findFirstAsync _ twoListenersOnSameInvalidObjectsCauseNPE ( ) { \n + final Realm realm = looperThread . realm ; \n + final AllTypes allTypes = realm . where ( AllTypes . class ) . findFirstAsync ( ) ; \n + final AtomicBoolean firstListenerCalled = new AtomicBoolean ( false ) ; \n + \n + allTypes . addChangeListener ( new RealmChangeListener < AllTypes > ( ) { \n + @ Override \n + public void onChange ( AllTypes element ) { \n + allTypes . removeChangeListener ( this ) ; \n + assertFalse ( firstListenerCalled . getAndSet ( true ) ) ; \n + if ( ! element . isValid ( ) ) { \n + realm . beginTransaction ( ) ; \n + realm . createObject ( AllTypes . class ) ; \n + realm . commitTransaction ( ) ; \n + } \n + } \n + } ) ; \n + \n + allTypes . addChangeListener ( new RealmChangeListener < AllTypes > ( ) { \n + @ Override \n + public void onChange ( AllTypes element ) { \n + allTypes . removeChangeListener ( this ) ; \n + assertTrue ( firstListenerCalled . get ( ) ) ; \n + assertFalse ( element . isValid ( ) ) ; \n + looperThread . testComplete ( ) ; \n + } \n + } ) ; \n + } \n + \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ PendingRow . java \n + / / Clear the pending collection immediately in case beginTransaction is called in the listener which will \n + / / execute the query again . \n + clearPendingCollection ( ) ; \n + } else { \n + clearPendingCollection ( ) ; \n - clearPendingCollection ( ) ; \n",Clear pending collection first for findFirstAsync ( # 4497 ) \n Otherwise the pending query will be executed again if there is a local \n transaction in the listener . That would cause a infinite recursion or \n NPE ( like # 4495 ) . \n Fix # 4495,80
"CHANGELOG . md \n + * Native crash with "" Invalid argument "" error happened on some Android 7 . 1 . 1 devices when opening Realm on external storage ( # 4461 ) . \n - * Upgraded to Realm Sync 1 . 5 . 2 . \n + * Upgraded to Realm Sync 1 . 6 . 0 . \n + * Upgraded to Realm Core 2 . 6 . 1 . \n dependencies . list \n - REALM _ SYNC _ VERSION = 1 . 5 . 2 \n - REALM _ SYNC _ SHA256 = e7a0134b5b69c5a571e3f49901bb8d8ca634b166873c5a422909e7d2016a00e7 \n + REALM _ SYNC _ VERSION = 1 . 6 . 0 \n + REALM _ SYNC _ SHA256 = e8a973dbe6ab33ac49d3d0e45d6b63d69cec8d1d87d9a2311fcdd02767f76cf8 \n",Update realm sync to 1 . 6 . 0 ( # 4523 ) \n core to 2 . 6 . 1 \n Fix # 4461,80
version . txt \n - 3 . 1 . 3 \n + 3 . 1 . 4 - SNAPSHOT \n,Prepare next release v3 . 1 . 4 - SNAPSHOT,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + newRealm . close ( ) ; \n + newRealm . close ( ) ; \n - realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n - @ Override \n - public void execute ( Realm realm ) { \n + try { \n + realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n + @ Override \n + public void execute ( Realm realm ) { \n - } \n - } , new Realm . Transaction . OnSuccess ( ) { \n - @ Override \n - public void onSuccess ( ) { \n - } \n - } ) ; \n + } \n + } , new Realm . Transaction . OnSuccess ( ) { \n + @ Override \n + public void onSuccess ( ) { \n + } \n + } ) ; \n + } finally { \n + realm . close ( ) ; \n + } \n - realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n - @ Override \n - public void execute ( Realm realm ) { \n + try { \n + realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n + @ Override \n + public void execute ( Realm realm ) { \n - } \n - } , new Realm . Transaction . OnError ( ) { \n - @ Override \n - public void onError ( Throwable error ) { \n - } \n - } ) ; \n + } \n + } , new Realm . Transaction . OnError ( ) { \n + @ Override \n + public void onError ( Throwable error ) { \n + } \n + } ) ; \n + } finally { \n + realm . close ( ) ; \n + } \n","Fix flaky test caused by non - closed Realm ( # 4528 ) \n When the case is using ExpectedException , TestRealmConfigurationFactory \n won ' t be able to detect the Realm instance is not closed .",80
"CHANGELOG . md \n + * ` OrderedRealmCollectionSnapshot . get ( ) ` returned a wrong object ( # 4554 ) . \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmListTests . java \n + import io . realm . internal . Table ; \n + \n + / / https : / / github . com / realm / realm - java / issues / 4554 \n + @ Test \n + public void createSnapshot _ shouldUseTargetTable ( ) { \n + int sizeBefore = collection . size ( ) ; \n + OrderedRealmCollectionSnapshot < Dog > snapshot = collection . createSnapshot ( ) ; \n + realm . beginTransaction ( ) ; \n + snapshot . get ( 0 ) . deleteFromRealm ( ) ; \n + realm . commitTransaction ( ) ; \n + assertEquals ( sizeBefore - 1 , collection . size ( ) ) ; \n + \n + assertNotNull ( collection . view ) ; \n + assertEquals ( collection . view . getTargetTable ( ) . getName ( ) , snapshot . getTable ( ) . getName ( ) ) ; \n + } \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ Collection . java \n - this . table = linkView . getTable ( ) ; \n + this . table = linkView . getTargetTable ( ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ LinkView . java \n - / * * \n - * Returns the { @ link Table } which all links point to . \n - * / \n - public Table getTable ( ) { \n - return parent ; \n - } \n - \n - Table table = new Table ( this . parent , nativeTablePointer ) ; \n - return table ; \n + return new Table ( this . parent , nativeTablePointer ) ; \n",Use target table to create snapshot from LinkView ( # 4556 ) \n - Fix # 4554 . \n - Remove useless confusing ` LinkView . getTable ( ) ` .,80
version . txt \n - 2 . 2 . 2 \n + 2 . 2 . 3 - SNAPSHOT \n,Prepare next release v2 . 2 . 3 - SNAPSHOT,80
"build . gradle \n - task uploadDistributionPackage ( type : Exec ) { \n + task uploadDistributionPackage { \n - commandLine ' s3cmd ' , ' put ' , "" $ { buildDir } / outputs / distribution / realm - java - $ { currentVersion } . zip "" , ' s3 : / / static . realm . io / downloads / java / ' \n - commandLine ' s3cmd ' , ' put ' , "" $ { buildDir } / outputs / distribution / realm - java - jni - libs - unstripped - $ { currentVersion } . zip "" , ' s3 : / / static . realm . io / downloads / java / ' \n + doLast { \n + exec { \n + workingDir "" $ { buildDir } / outputs / distribution / "" \n + commandLine ' s3cmd ' , ' put ' , "" realm - java - $ { currentVersion } . zip "" , ' s3 : / / static . realm . io / downloads / java / ' \n + } \n + exec { \n + workingDir "" $ { buildDir } / outputs / distribution / "" \n + commandLine ' s3cmd ' , ' put ' , "" realm - java - jni - libs - unstripped - $ { currentVersion } . zip "" , ' s3 : / / static . realm . io / downloads / java / ' \n + } \n + } \n",realm - java - < version > . zip cannot be uploaded \n The gradle exec task only takes the last commandLine arg . \n To fix the manual uploading in the release process .,80
"realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n + private static final String LISTENER _ NOT _ ALLOWED _ MESSAGE = \n + "" Listeners cannot be used on current thread . "" ; \n + sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n + sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n + sharedRealm . capabilities . checkCanDeliverNotification ( "" removeListener cannot be called on current thread . "" ) ; \n","Disallow Realm listeners on non - looper thread \n It is possible to have listeners for non - looper thread , and trigger \n them through SharedRealm . refresh ( ) . But there are many corner cases need \n to be covered if we enable it . Disallow it for now to stick with current \n behaviour .",80
"realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ Collection . cpp \n + JNIEXPORT jboolean JNICALL \n + Java _ io _ realm _ internal _ Collection _ nativeIsValid ( JNIEnv * env , jclass , jlong native _ ptr ) \n + { \n + TR _ ENTER _ PTR ( native _ ptr ) \n + try { \n + auto wrapper = reinterpret _ cast < ResultsWrapper * > ( native _ ptr ) ; \n + return wrapper - > get _ results ( ) . is _ valid ( ) ; \n + } CATCH _ STD ( ) \n + return JNI _ FALSE ; \n + } \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmResults . java \n - return ! realm . isClosed ( ) ; \n + return collection . isValid ( ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ Collection . java \n + public boolean isValid ( ) { \n + return nativeIsValid ( nativePtr ) ; \n + } \n + \n + private static native boolean nativeIsValid ( long nativePtr ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ PendingRow . java \n - / / PendingRow will always get the first Row of the query since we only support findFirst . \n - UncheckedRow uncheckedRow = pendingCollection . firstUncheckedRow ( ) ; \n - / / If no rows returned by the query , just wait for the query updates until it returns a valid row . \n - if ( uncheckedRow ! = null ) { \n - Row row = returnCheckedRow ? CheckedRow . getFromRow ( uncheckedRow ) : uncheckedRow ; \n - / / Ask the front end to reset the row and stop async query . \n - frontEnd . get ( ) . onQueryFinished ( row ) ; \n + if ( pendingCollection . isValid ( ) ) { \n + / / PendingRow will always get the first Row of the query since we only support findFirst . \n + UncheckedRow uncheckedRow = pendingCollection . firstUncheckedRow ( ) ; \n + / / If no rows returned by the query , just wait for the query updates until it returns a valid row . \n + if ( uncheckedRow ! = null ) { \n + Row row = returnCheckedRow ? CheckedRow . getFromRow ( uncheckedRow ) : uncheckedRow ; \n + / / Ask the front end to reset the row and stop async query . \n + frontEnd . get ( ) . onQueryFinished ( row ) ; \n + clearPendingCollection ( ) ; \n + } \n + } else { \n + / / The Realm is closed . Do nothing then . \n","Add Collection . isValid \n Also checking in the pending row , if the pending collection becomes \n invalid , just do nothing .",80
"realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n - private static final String LISTENER _ NOT _ ALLOWED _ MESSAGE = \n - "" Listeners cannot be used on current thread . "" ; \n + private static final String LISTENER _ NOT _ ALLOWED _ MESSAGE = "" Listeners cannot be used on current thread . "" ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmObject . java \n + private static final String LISTENER _ NOT _ ALLOWED _ MESSAGE = "" Listeners cannot be used on current thread . "" ; \n - realm . sharedRealm . capabilities . checkCanDeliverNotification ( "" Listener cannot be added . "" ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n - proxy . realmGet $ proxyState ( ) . getRealm $ realm ( ) . checkIfValid ( ) ; \n + BaseRealm realm = proxy . realmGet $ proxyState ( ) . getRealm $ realm ( ) ; \n + realm . checkIfValid ( ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n + / / FIXME : Below doesn ' t seem to be correct ? \n - proxy . realmGet $ proxyState ( ) . getRealm $ realm ( ) . checkIfValid ( ) ; \n + BaseRealm realm = proxy . realmGet $ proxyState ( ) . getRealm $ realm ( ) ; \n + realm . checkIfValid ( ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmResults . java \n + private static final String LISTENER _ NOT _ ALLOWED _ MESSAGE = "" Listeners cannot be used on current thread . "" ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( LISTENER _ NOT _ ALLOWED _ MESSAGE ) ; \n",Disallow listeners for Results & Object on non - looper,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ OrderedCollectionChangeSetTests . java \n - import java . util . concurrent . CountDownLatch ; \n - / / The change set should empty when the async query returns at the first time . \n + / / The change set should be empty when the async query returns at the first time . \n + looperThread . keepStrongReference ( results ) ; \n - assertEquals ( 9 , collection . size ( ) ) ; \n + assertEquals ( 10 , collection . size ( ) ) ; \n - \n - final CountDownLatch bgDeletionLatch = new CountDownLatch ( 1 ) ; \n - / / beginTransaction ( ) will make the async query return immediately . So we have to create an object in another \n - / / thread . Also , the latch has to be counted down after transaction committed so the async query results can \n - / / contain the modification in the background transaction . \n - new Thread ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - Realm realm = Realm . getInstance ( looperThread . getConfiguration ( ) ) ; \n - realm . beginTransaction ( ) ; \n - realm . where ( Dog . class ) . equalTo ( Dog . FIELD _ AGE , 0 ) . findFirst ( ) . deleteFromRealm ( ) ; \n - realm . commitTransaction ( ) ; \n - realm . close ( ) ; \n - bgDeletionLatch . countDown ( ) ; \n - } \n - } ) . start ( ) ; \n - TestHelper . awaitOrFail ( bgDeletionLatch ) ; \n","Fix flaky emptyChangeSet _ findAllAsync ( # 4913 ) \n There is no guarantee that async query will be finished later after the \n transaction . So the original assertEquals ( 9 , collection . size ( ) ) might \n not be true always . \n Just remove the object deletion logic since it has nothing to do with \n the test purpose .",80
CHANGELOG . md \n + * Upgraded to Realm Sync 2 . 1 . 8 . \n + * Upgraded to Realm Core 4 . 0 . 4 . \n dependencies . list \n - REALM _ SYNC _ VERSION = 2 . 1 . 4 \n - REALM _ SYNC _ SHA256 = 6d32ef44acbf4a63b654ceeaadce036feeefd04a4ca649a95a22a0e7d56df84d \n + REALM _ SYNC _ VERSION = 2 . 1 . 8 \n + REALM _ SYNC _ SHA256 = 14e4aabe270638aa96f84396be27985b6809e532183035c5150dd2933d676248 \n - REALM _ OBJECT _ SERVER _ DE _ VERSION = 2 . 0 . 18 \n + REALM _ OBJECT _ SERVER _ DE _ VERSION = 2 . 1 . 0 \n,Update sync to 2 . 1 . 8 ( # 5582 ),80
version . txt \n - 3 . 2 . 0 \n + 3 . 2 . 1 - SNAPSHOT \n,Prepare next release v3 . 2 . 1 - SNAPSHOT,80
"tools \ release . sh \n - # FIXME : Only patch release is supported now . \n - if [ [ "" $ BRANCH _ TO _ RELEASE "" ! = "" releases "" ] ] ; then \n - echo "" Releasing from other branches than ' releases ' is not supported right now . "" \n - exit - 1 \n - fi \n - \n + # Merge the branch to the releases branch and check the CHANGELOG . md \n + if [ [ "" $ BRANCH _ TO _ RELEASE "" ! = "" releases "" ] ] ; then \n + git merge "" origin / $ BRANCH _ TO _ RELEASE "" \n + \n + while true \n + do \n + read - r - p "" Type the command to edit CHANGELOG . md , default ( vim ) : "" editor \n + if [ - z "" $ editor "" ] ; then \n + editor = "" vim "" \n + fi \n + "" $ editor "" CHANGELOG . md \n + \n + read - r - p "" Please merge the unreleased entries in the ' CHANGELOG . md ' and then press any key to continue . . . "" _ \n + if [ "" $ ( grep - c "" YYYY - MM - DD "" CHANGELOG . md ) "" - eq 1 ] ; then \n + break \n + else \n + echo "" There are more than one or none unreleased entries in the ' CHANGELOG . md ' . "" \n + fi \n + done \n + # CHANGELOG . md is modified . \n + if ! git diff - index - - quiet HEAD CHANGELOG . md ; then \n + git add CHANGELOG . md \n + git commit - m "" Merge entries in changelog "" \n + fi \n + fi \n + \n",Support minor release for release script ( # 4649 ),80
CHANGELOG . md \n + * Fixed random crashes which were caused by a race condition in encrypted Realm ( # 4343 ) . \n + \n + * Upgraded to Realm Sync 1 . 8 . 5 . \n + * Upgraded to Realm Core 2 . 8 . 0 . \n + \n dependencies . list \n - REALM _ SYNC _ VERSION = 1 . 6 . 0 \n - REALM _ SYNC _ SHA256 = e8a973dbe6ab33ac49d3d0e45d6b63d69cec8d1d87d9a2311fcdd02767f76cf8 \n + REALM _ SYNC _ VERSION = 1 . 8 . 5 \n + REALM _ SYNC _ SHA256 = 71e70f83b1604672bbfd7c04fcf984ecc8ac683864943ef3de262994c2e7b7fc \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ OsObject . cpp \n + # include < shared _ realm . hpp > \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit dfddfa7f7bf564619e2257243c252ffad6d5c9c3 \n + Subproject commit 4330f13eedfad4f34bcecdca25f71fb949fbc4b2 \n,Update sync to 1 . 8 . 5 ( # 4670 ) \n And update Object Store to 4330f13eedf,80
version . txt \n - 3 . 2 . 1 \n + 3 . 2 . 2 - SNAPSHOT \n,Prepare next release v3 . 2 . 2 - SNAPSHOT,80
version . txt \n - 3 . 3 . 1 \n + 3 . 3 . 2 - SNAPSHOT \n,Prepare next release v3 . 3 . 2 - SNAPSHOT,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n + @ Ignore ( "" Listeners for non - looper thread are not allowed for now "" ) \n + realm = Realm . getInstance ( realmConfig ) ; \n + @ Ignore ( "" Listeners for non - looper thread are not allowed for now "" ) \n + realm = Realm . getInstance ( realmConfig ) ; \n",Ignore non - looper listener related test cases,80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ internal \ RealmNotifierTests . java \n - import static junit . framework . Assert . assertTrue ; \n + sharedRealm . close ( ) ; \n + sharedRealm . close ( ) ; \n realm \ realm - library \ src \ main \ cpp \ java _ binding _ context . cpp \n - void JavaBindingContext : : changes _ available ( ) \n + void JavaBindingContext : : before _ notify ( ) \n realm \ realm - library \ src \ main \ cpp \ java _ binding _ context . hpp \n - virtual void changes _ available ( ) ; \n + virtual void before _ notify ( ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ Collection . java \n - / / For the stable iteration . \n - / / It is needed when the local commit triggered async query updates . And this is called in the next event loop \n - / / by OS Realm : : notify ( ) . \n - if ( ! emptyChanges ) { \n - this . disableSnapshot ( ) ; \n - } \n - \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ RealmNotifier . java \n + / / For the stable iteration . \n,reattach when BindingContext : : before _ notify,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n - @ Test \n - @ RunTestInLooperThread \n - public void warnIfMixingSyncWritesAndAsyncQueries ( ) { \n - final Realm realm = looperThread . realm ; \n - final AtomicBoolean warningLogged = new AtomicBoolean ( false ) ; \n - final TestHelper . TestLogger testLogger = new TestHelper . TestLogger ( ) { \n - @ Override \n - public void log ( int level , String tag , Throwable throwable , String message ) { \n - assertTrue ( message . contains ( "" Mixing asynchronous queries with local writes should be avoided . "" ) ) ; \n - if ( level = = LogLevel . WARN ) { \n - warningLogged . set ( true ) ; \n - } \n - } \n - } ; \n - RealmLog . add ( testLogger ) ; \n - \n - realm . beginTransaction ( ) ; \n - realm . createObject ( AllTypes . class ) ; \n - realm . commitTransaction ( ) ; \n - \n - RealmResults < AllTypes > results = realm . where ( AllTypes . class ) . findAllAsync ( ) ; \n - looperThread . keepStrongReference . add ( results ) ; \n - results . addChangeListener ( new RealmChangeListener < RealmResults < AllTypes > > ( ) { \n - @ Override \n - public void onChange ( RealmResults < AllTypes > element ) { \n - RealmLog . remove ( testLogger ) ; \n - assertTrue ( warningLogged . get ( ) ) ; \n - looperThread . testComplete ( ) ; \n - } \n - } ) ; \n - } \n - \n","Remove warnIfMixingSyncWritesAndAsyncQueries test \n Since all the queries are async by default , print this warning doesn ' t \n help too much anymore .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n - assertEquals ( 0 , allTypesAsync . size ( ) ) ; \n + / / Call where ( ) on an async results will load the async query immediately . \n + assertEquals ( 4 , allTypesAsync . size ( ) ) ; \n",Where on async results will load the query,80
CHANGELOG . md \n + * Crash caused by JNI couldn ' t find ` SharedRealm ` ' s inner classes when ProGuard is enabled ( # 5211 ) . \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ Keep . java \n + * < p > \n + * NOTE : The outer class and the inner class have to be both annotated by this if they need to be kept . \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SharedRealm . java \n + @ Keep \n + @ Keep \n + @ Keep \n,Keep SharedRealm ' s inner classes ( # 5212 ) \n Close # 5211,80
"tools \ sync _ test _ server \ Dockerfile \n - COPY keys / public . pem keys / private . pem keys / 127 _ 0 _ 0 _ 1 - server . key . pem keys / 127 _ 0 _ 0 _ 1 - chain . crt . pem configuration . yml / \n - COPY ros - testing - server . js / usr / bin / \n - \n + COPY keys / public . pem keys / private . pem keys / 127 _ 0 _ 0 _ 1 - server . key . pem keys / 127 _ 0 _ 0 _ 1 - chain . crt . pem configuration . yml / \n + COPY ros - testing - server . js / usr / bin / \n + \n tools \ sync _ test _ server \ configuration . yml \n - listen _ address : ' : : ' \n + listen _ address : ' 0 . 0 . 0 . 0 ' \n - listen _ address : ' : : ' \n + listen _ address : ' 0 . 0 . 0 . 0 ' \n tools \ sync _ test _ server \ ros - testing - server . js \n - function startRealmObjectServer ( ) { \n + function startRealmObjectServer ( done ) { \n + / / Hack for checking the ROS is fully initialized . \n + / / Consider the ROS is initialized fully only if log below shows twice \n + / / "" client : Closing Realm file : / tmp / ros117521 - 7 - 1eiqt7a / internal _ data / permission / _ _ auth . realm "" \n + / / https : / / github . com / realm / realm - object - server / issues / 1297 \n + var logFindingCounter = 2 \n + \n - { env : env } ) ; \n + { env : env } ) ; \n + if ( logFindingCounter ! = 0 & & / client : Closing Realm file : . * _ _ auth . realm / . test ( data ) ) { \n + if ( logFindingCounter = = 1 ) { \n + done ( ) \n + } \n + logFindingCounter - - \n + } \n + \n - startRealmObjectServer ( ) ; \n - res . writeHead ( 200 , { ' Content - Type ' : ' text / plain ' } ) ; \n - res . end ( ' Starting a server ' ) ; \n + startRealmObjectServer ( ( ) = > { \n + res . writeHead ( 200 , { ' Content - Type ' : ' text / plain ' } ) ; \n + res . end ( ' Starting a server ' ) ; \n + } ) \n","Fix flaky tests caused by half inited ROS \n - Hack for detecting if the ROS is fully initialized in the docker \n sided . \n - Dockerfile optimization . \n - Use "" 0 . 0 . 0 . 0 "" instead of "" : : "" to solve dns issues inside docker .",80
CHANGELOG . md \n + # # # Deprecated \n + \n + * ` RealmSchema . close ( ) ` and ` RealmObjectSchema . close ( ) ` . They don ' t need to be closed manually . They were added to the public API by mistake . \n + \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmObjectSchema . java \n - * Release the object schema and any of native resources it might hold . \n + * @ deprecated { @ link RealmObjectSchema } doesn ' t have to be released manually . \n + @ Deprecated \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmSchema . java \n - * Release the schema and any of native resources it might hold . \n + * @ deprecated { @ link RealmSchema } doesn ' t have to be released manually . \n + @ Deprecated \n,Decpreate schema ' s close ( ) methods,80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + looperThread . keepStrongReference ( allTypes ) ; \n,Fix GCed ref caused flaky test ( # 4827 ),80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmMigrationTests . java \n - / / Adding search index is idempotent . \n - @ Test \n - public void addingSearchIndexTwice ( ) throws IOException { \n - final Class [ ] classes = { PrimaryKeyAsLong . class , PrimaryKeyAsString . class } ; \n - \n - for ( final Class clazz : classes ) { \n - final AtomicBoolean didMigrate = new AtomicBoolean ( false ) ; \n - \n - RealmMigration migration = new RealmMigration ( ) { \n - @ Override \n - public void migrate ( DynamicRealm realm , long oldVersion , long newVersion ) { \n - RealmObjectSchema schema = realm . getSchema ( ) . getSchemaForClass ( clazz . getSimpleName ( ) ) ; \n - schema . addIndex ( "" id "" ) ; \n - / / @ PrimaryKey fields in PrimaryKeyAsLong and PrimaryKeyAsString . class should be set ' nullable ' . \n - schema . setNullable ( "" name "" , true ) ; \n - didMigrate . set ( true ) ; \n - } \n - } ; \n - RealmConfiguration realmConfig = configFactory . createConfigurationBuilder ( ) \n - . schemaVersion ( 42 ) \n - . schema ( clazz ) \n - . migration ( migration ) \n - . build ( ) ; \n - Realm . deleteRealm ( realmConfig ) ; \n - configFactory . copyRealmFromAssets ( context , "" default - before - migration . realm "" , Realm . DEFAULT _ REALM _ NAME ) ; \n - Realm . migrateRealm ( realmConfig ) ; \n - realm = Realm . getInstance ( realmConfig ) ; \n - assertEquals ( 42 , realm . getVersion ( ) ) ; \n - assertTrue ( didMigrate . get ( ) ) ; \n - Table table = realm . getTable ( clazz ) ; \n - assertEquals ( true , table . hasSearchIndex ( table . getColumnIndex ( "" id "" ) ) ) ; \n - realm . close ( ) ; \n - } \n - } \n - \n","Remove outdated addSearchIndexTwice \n RealmObjectSchema . addIndex ( ) is not idempotent . The test was created \n in # 1544 for issue # 1385 which was using Table . addSearchIndex ( ) . \n RealmObjectSchema . addIndex ( ) will just throw when called twice , it is \n guaranteed by test addIndexFieldModifier _ alreadyIndexedThrows . \n The test can accidentally pass is just because of \n default - before - migration . realm was created before 0 . 82 when the primary \n key was not auto - indexed yet .",80
"realm \ realm - library \ src \ objectServer \ java \ io \ realm \ ObjectServer . java \n + import java . io . File ; \n + import java . io . IOException ; \n + \n - SyncManager . nativeInitializeSyncManager ( context . getFilesDir ( ) . getPath ( ) ) ; \n + if ( SyncManager . Debug . separatedDirForSyncManager ) { \n + try { \n + / / Files . createTempDirectory is not available on JDK 6 . \n + File dir = File . createTempFile ( "" remote _ sync _ "" , "" _ "" + android . os . Process . myPid ( ) , \n + context . getFilesDir ( ) ) ; \n + if ( ! dir . delete ( ) ) { \n + throw new IllegalStateException ( String . format ( "" Temp file ' % s ' cannot be deleted . "" , dir . getPath ( ) ) ) ; \n + } \n + if ( ! dir . mkdir ( ) ) { \n + throw new IllegalStateException ( String . format ( "" Directory ' % s ' for SyncManager cannot be created . "" , \n + dir . getPath ( ) ) ) ; \n + } \n + SyncManager . nativeInitializeSyncManager ( dir . getPath ( ) ) ; \n + } catch ( IOException e ) { \n + throw new IllegalStateException ( e ) ; \n + } \n + } else { \n + SyncManager . nativeInitializeSyncManager ( context . getFilesDir ( ) . getPath ( ) ) ; \n + } \n realm \ realm - library \ src \ objectServer \ java \ io \ realm \ SyncManager . java \n + / * * \n + * Set this to true to init a SyncManager with a directory named by the process ID . This is useful for \n + * integration tests which are emulating multiple sync client by using multiple processes . \n + * / \n + public static boolean separatedDirForSyncManager = false ; \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ utils \ RemoteIntegrationTestService . java \n + SyncManager . Debug . separatedDirForSyncManager = true ; \n",Separated dir for remote SyncManager ( # 4808 ) \n This may cause some flaky tests on CI .,80
version . txt \n - 3 . 1 . 1 \n + 3 . 1 . 2 - SNAPSHOT \n,Prepare next release v3 . 1 . 2 - SNAPSHOT,80
"Dockerfile \n - ENV NDK _ LCACHE / usr / bin / lcache \n - \n - # Install lcache \n - RUN wget - q https : / / github . com / beeender / lcache / releases / download / v0 . 0 . 2 / lcache - linux - O / usr / bin / lcache & & \ \n - chmod + x / usr / bin / lcache \n Jenkinsfile \n - "" - v $ { env . HOME } / lcache : / tmp / . lcache "" + \n","Disable lcache ( # 5072 ) \n Since the lto has been disabled , linking is much faster now . No need to \n use lcache anymore .",80
version . txt \n - 3 . 7 . 1 \n + 3 . 7 . 2 - SNAPSHOT \n,Prepare next release v3 . 7 . 2 - SNAPSHOT,80
"realm \ realm - library \ src \ androidTest \ AndroidManifest . xml \n - < uses - permission android : name = "" android . permission . SET _ DEBUG _ APP "" / > \n - < application \n - android : debuggable = "" true "" > \n + < application > \n","Revert "" Options in AndroidManifest for attaching debugger "" \n This reverts commit 790f225bf1820ddca2b6d52fa997466e078afef8 . \n That commit triggered a stange crash in JNI when Running RealmTest , it \n failed with a native crash on test compactOnLaunch _ shouldNotCompact : \n JNI DETECTED ERROR IN APPLICATION : \n can ' t call boolean \n io . realm . DefaultCompactOnLaunchCallback . shouldCompact ( long , long ) on instance of \n io . realm . RealmTests $ 6 ' \n Looks very much like a bug in Android .",80
CHANGELOG . md \n - # # 4 . 0 . 0 - BETA1 ( YYYY - MM - DD ) \n + # # 4 . 0 . 0 - BETA2 ( 2017 - 07 - 27 ) \n + \n + # # # Bug Fixes \n + \n + * [ ObjectServer ] ` metatable ` might not be created for sync 2 . 0 . 0 ( https : / / github . com / realm / realm - object - store / issues / 502 ) . \n + \n + # # 4 . 0 . 0 - BETA1 ( 2017 - 07 - 13 ) \n realm \ realm - library \ src \ androidTestObjectServer \ java \ io \ realm \ SyncedRealmMigrationTests . java \n + import static org . junit . Assert . assertNotNull ; \n + Realm realm = Realm . getInstance ( config ) ; / / Opening at different schema version ( 42 ) should rebuild indexes \n - Realm realm = Realm . getInstance ( config ) ; / / Opening at different schema version ( 42 ) should rebuild indexes \n - fail ( ) ; \n - } catch ( RealmMigrationNeededException ignored ) { \n + RealmObjectSchema indexedFieldsSchema = realm . getSchema ( ) . get ( className ) ; \n + assertNotNull ( indexedFieldsSchema ) ; \n + assertTrue ( indexedFieldsSchema . hasIndex ( IndexedFields . FIELD _ INDEXED _ STRING ) ) ; \n + assertFalse ( indexedFieldsSchema . hasIndex ( IndexedFields . FIELD _ NON _ INDEXED _ STRING ) ) ; \n + } finally { \n + realm . close ( ) ; \n - \n - / / FIXME : This is the intended behaviour \n - / / RealmObjectSchema indexedFieldsSchema = realm . getSchema ( ) . get ( className ) ; \n - / / try { \n - / / assertTrue ( indexedFieldsSchema . hasIndex ( IndexedFields . FIELD _ INDEXED _ STRING ) ) ; \n - / / assertFalse ( indexedFieldsSchema . hasIndex ( IndexedFields . FIELD _ NON _ INDEXED _ STRING ) ) ; \n - / / } finally { \n - / / realm . close ( ) ; \n - / / } \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit b2a358a1f7a00972f65104f6f61f18445ee04980 \n + Subproject commit 4b12f29145350b02c94bbd46b11c98db8ffcb566 \n version . txt \n - 4 . 0 . 0 - BETA1 - SNAPSHOT \n + 4 . 0 . 0 - BETA2 - SNAPSHOT \n,Cherry pick OS # 504 fix ( # 5030 ) \n Update object store to 4b12f29145 . \n Prepare for beta2 snapshot release .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + import io . realm . internal . async . RealmThreadPoolExecutor ; \n - public void executeTransactionAsync _ callbacksShouldBeClearedBeforeCalling ( ) { \n + public void executeTransactionAsync _ callbacksShouldBeClearedBeforeCalling ( ) \n + throws NoSuchFieldException , IllegalAccessException { \n + / / Use single thread executor \n + TestHelper . replaceRealmThreadExecutor ( RealmThreadPoolExecutor . newSingleThreadExecutor ( ) ) ; \n + \n - / / Delay to post this to ensure the async transaction posted callback will arrive first . \n - looperThread . postRunnableDelayed ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - / / Manually call refresh , so the did _ change will be triggered . \n - foregroundRealm . sharedRealm . refresh ( ) ; \n - foregroundRealm . setAutoRefresh ( true ) ; \n - } \n - } , 50 ) ; \n + \n + / / Wait for all async tasks finish to ensure the async transaction posted callback will arrive first . \n + TestHelper . resetRealmThreadExecutor ( ) ; \n + looperThread . postRunnable ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + / / Manually call refresh , so the did _ change will be triggered . \n + foregroundRealm . sharedRealm . refresh ( ) ; \n + foregroundRealm . setAutoRefresh ( true ) ; \n + } \n + } ) ; \n",Wait for async tasks finish to solve flaky test ( # 4603 ) \n Apparently waiting some random millisecond is never a good idea .,80
"realm \ realm - library \ build . gradle \n + / / We did strip with cmake for release build . \n + / / Please , Gradle , you are not that smart ! Pleas DO NOT strip debug symbols for debug build ! \n + doNotStrip "" * / * / * . so "" \n","Don ' t strip debug symbols for debug build ! \n From Android Plugin Version 2 . 2 . 0 , it tries to strip debug symbols of \n native libs for all build types ( even debug build ! ! ? ? ) . \n I don ' t like something try to be smart , so just let our cmake handler \n stripping and backup the unstripped libs .",80
"CHANGELOG . md \n + * Upgraded Realm Sync to 1 . 10 . 8 \n dependencies . list \n - REALM _ SYNC _ VERSION = 1 . 10 . 5 \n - REALM _ SYNC _ SHA256 = c93caa9b0ff1391550ce6b68ab3822fea7e6ae921498a3ebf3a5e6b17c56fa9b \n + REALM _ SYNC _ VERSION = 1 . 10 . 8 \n + REALM _ SYNC _ SHA256 = ee47cbce2bcbd105a27d0a6b64316f8ffcb1a090e697c8025d738ef5917de408 \n realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ SharedRealm . cpp \n - static _ assert ( SchemaMode : : ReadOnly = = \n + static _ assert ( SchemaMode : : Immutable = = \n + static _ cast < SchemaMode > ( io _ realm _ internal _ SharedRealm _ SCHEMA _ MODE _ VALUE _ IMMUTABLE ) , \n + "" "" ) ; \n + static _ assert ( SchemaMode : : ReadOnlyAlternative = = \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 50cf5ee58366065fa3faca266c371bedc29dc2c7 \n + Subproject commit 2274604de9c1b34667a78246d86437f64ae6896f \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SharedRealm . java \n - private static final byte SCHEMA _ MODE _ VALUE _ READONLY = 1 ; \n - private static final byte SCHEMA _ MODE _ VALUE _ RESET _ FILE = 2 ; \n - private static final byte SCHEMA _ MODE _ VALUE _ ADDITIVE = 3 ; \n - private static final byte SCHEMA _ MODE _ VALUE _ MANUAL = 4 ; \n + private static final byte SCHEMA _ MODE _ VALUE _ IMMUTABLE = 1 ; \n + private static final byte SCHEMA _ MODE _ VALUE _ READONLY = 2 ; \n + private static final byte SCHEMA _ MODE _ VALUE _ RESET _ FILE = 3 ; \n + private static final byte SCHEMA _ MODE _ VALUE _ ADDITIVE = 4 ; \n + private static final byte SCHEMA _ MODE _ VALUE _ MANUAL = 5 ; \n + SCHEMA _ MODE _ IMMUTABLE ( SCHEMA _ MODE _ VALUE _ IMMUTABLE ) , \n",Update realm - sync to 1 . 10 . 8 ( # 5129 ) \n And update object - store to 2274604de9,80
"tools \ sync _ test _ server \ ros - testing - server . js \n - / / this query is used to check if ROS has started \n - / / while waiting for a permanante fix in https : / / github . com / realm / realm - object - server / issues / 1297 . \n - / / query should return 200 with the JSON payload Ex : { "" version "" : "" 1 . 8 . 1 "" , "" flavor "" : "" developer "" , "" setupRequired "" : true } \n - var options = { \n - hostname : ' 127 . 0 . 0 . 1 ' , \n - port : 9080 , \n - path : ' / api / info ' , \n - method : ' GET ' \n - } ; \n - \n - function tryUntilROSStart ( options , callback ) { \n - var req = http . request ( options , function ( res ) { \n - callback ( null , res ) ; \n - } ) ; \n - req . on ( ' error ' , function ( e ) { \n - tryUntilROSStart ( options , callback ) ; \n - } ) ; \n - req . end ( ) ; \n - } \n - \n + / / Hack for checking the ROS is fully initialized . \n + / / Consider the ROS is initialized fully only if log below shows twice \n + / / "" client : Closing Realm file : / tmp / ros117521 - 7 - 1eiqt7a / internal _ data / permission / _ _ auth . realm "" \n + / / https : / / github . com / realm / realm - object - server / issues / 1297 \n + var logFindingCounter = 2 \n + \n + if ( logFindingCounter ! = 0 & & / client : Closing Realm file : . * _ _ auth . realm / . test ( data ) ) { \n + if ( logFindingCounter = = 1 ) { \n + done ( ) \n + } \n + logFindingCounter - - \n + } \n - \n - tryUntilROSStart ( options , function ( err , resp ) { \n - winston . info ( ' > > > > > > > > > > > > > > > > > > > [ ROS ] server started < < < < < < < < < < < < < < < < < < < ' ) ; \n - done ( ) \n - } ) ; \n - res . end ( ' Server started ' ) ; \n + res . end ( ' Starting a server ' ) ; \n","Revert "" Upgrade Integration Test setup "" Test if CI is better ( # 5174 ) \n * Revert "" Better detection of when ROS is running . Upgrade ROS used by integration tests . ( # 5128 ) "" \n This reverts commit 47027d9bcb1d1398efc0d70415f9474326e7c9a4 .",80
realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ RealmNotifier . java \n - private final static ObserverPairList . Callback < RealmObserverPair > onChangeCallBack = \n + private final ObserverPairList . Callback < RealmObserverPair > onChangeCallBack = \n - pair . onChange ( observer ) ; \n + if ( sharedRealm ! = null & & ! sharedRealm . isClosed ( ) ) { \n + pair . onChange ( observer ) ; \n + } \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SharedRealm . java \n + if ( isClosed ( ) ) { \n + return ; \n + } \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ android \ AndroidRealmNotifier . java \n - \n - @ Override \n - public void close ( ) { \n - super . close ( ) ; \n - if ( handler ! = null ) { \n - handler . removeCallbacksAndMessages ( null ) ; \n - handler = null ; \n - } \n - } \n,Don ' t remove callback in AndroidRealmNotifier \n We still have to ensure the async transaction callbacks delivered .,80
"realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ AuthTests . java \n - / / FIXME : https : / / github . com / realm / realm - java / issues / 4711 \n - / / fail may be related to this issue https : / / github . com / realm / realm - java / issues / 5068 \n - @ Ignore ( "" This fails expectSimpleCommit for some reasons , needs to be FIXED ASAP . "" ) \n - \n - / / FIXME : Right now we have no Java API for detecting when a session is established \n - / / So we optimistically assume it has been connected after 1 second . \n - looperThread . postRunnableDelayed ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - assertTrue ( SyncManager . getSession ( config ) . getUser ( ) . isValid ( ) ) ; \n - looperThread . testComplete ( ) ; \n - } \n - } , 1000 ) ; \n + assertTrue ( config . getUser ( ) . isValid ( ) ) ; \n + looperThread . testComplete ( ) ; \n",Enable test login _ withAccessToken \n Close # 4711,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmQueryTests . java \n - @ Ignore ( "" Disabled because it is time consuming "" ) \n - @ Test \n - public void largeRealmMultipleThreads ( ) throws InterruptedException { \n - final int nObjects = 500000 ; \n - final int nThreads = 3 ; \n - final CountDownLatch latch = new CountDownLatch ( nThreads ) ; \n - \n - realm . beginTransaction ( ) ; \n - realm . delete ( StringOnly . class ) ; \n - for ( int i = 0 ; i < nObjects ; i + + ) { \n - StringOnly stringOnly = realm . createObject ( StringOnly . class ) ; \n - stringOnly . setChars ( String . format ( "" string % d "" , i ) ) ; \n - } \n - realm . commitTransaction ( ) ; \n - \n - \n - for ( int i = 0 ; i < nThreads ; i + + ) { \n - Thread thread = new Thread ( \n - new Runnable ( ) { \n - @ Override \n - @ SuppressWarnings ( "" ElementsCountedInLoop "" ) \n - public void run ( ) { \n - RealmConfiguration realmConfig = configFactory . createConfiguration ( ) ; \n - Realm realm = Realm . getInstance ( realmConfig ) ; \n - RealmResults < StringOnly > realmResults = realm . where ( StringOnly . class ) . findAll ( ) ; \n - int n = 0 ; \n - for ( StringOnly ignored : realmResults ) { \n - n = n + 1 ; \n - } \n - assertEquals ( nObjects , n ) ; \n - realm . close ( ) ; \n - latch . countDown ( ) ; \n - } \n - } \n - ) ; \n - thread . start ( ) ; \n - } \n - \n - TestHelper . awaitOrFail ( latch ) ; \n - } \n - \n","Remove largeRealmMultipleThreads \n It was added in # 1379 to expose the timeout problem in finalizer . Since \n we are not using finalizer anymore , just remove it .",80
realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmObjectTests . java \n - allTypesPrimaryKey . setColumnFloat ( 42f ) ; \n + allTypesPrimaryKey . setColumnFloat ( 0f ) ; \n + \n + / / Change the object to trigger the listener . \n + realm . beginTransaction ( ) ; \n + allTypesPrimaryKey . setColumnFloat ( 42f ) ; \n + realm . commitTransaction ( ) ; \n,"Fix addChangeListener _ returnedObjectOfCopyToRealmOrUpdate \n The original test won ' t pass since the object doesn ' t change after \n adding the listener . So change it to trigger the listener . This doesn ' t \n change the purpose of the test , the target of the test is to check if \n the listener on the return value of copyToRealmOrUpdate will be called .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmObjectTests . java \n + import java . util . concurrent . atomic . AtomicInteger ; \n - / / The object should not be added to HandlerController again after the async query loaded . \n + / / step 1 : findFirstAsync \n + / / step 2 : async query returns , change the object in the listener \n + / / step 3 : listener gets called again \n - public void addChangeListener _ checkHandlerRealmObjectsWhenCallingOnAsyncObject ( ) { \n - / * Realm realm = looperThread . realm ; \n + public void addChangeListener _ listenerShouldBeCalledIfObjectChangesAfterAsyncReturn ( ) { \n + final AtomicInteger listenerCounter = new AtomicInteger ( 0 ) ; \n + final Realm realm = looperThread . realm ; \n - final ConcurrentHashMap < WeakReference < RealmObjectProxy > , Object > realmObjects = \n - realm . handlerController . realmObjects ; \n + / / Step 1 \n - allTypesPrimaryKey . addChangeListener ( new RealmChangeListener < AllTypesPrimaryKey > ( ) { \n - @ Override \n - public void onChange ( AllTypesPrimaryKey element ) { \n - \n - } \n - } ) ; \n - assertEquals ( 1 , realmObjects . size ( ) ) ; \n - looperThread . testComplete ( ) ; \n + int count = listenerCounter . getAndAdd ( 1 ) ; \n + if ( count = = 0 ) { \n + / / Step 2 \n + realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n + @ Override \n + public void execute ( Realm realm ) { \n + realm . where ( AllTypesPrimaryKey . class ) . findFirst ( ) . setColumnFloat ( 42f ) ; \n + } \n + } ) ; \n + } else if ( count = = 1 ) { \n + / / Step 3 \n + assertEquals ( allTypesPrimaryKey . getColumnFloat ( ) , 42f , 0 ) ; \n + looperThread . testComplete ( ) ; \n + } else { \n + fail ( ) ; \n + } \n - assertEquals ( 1 , realmObjects . size ( ) ) ; \n - for ( Object query : realmObjects . values ( ) ) { \n - assertNotNull ( query ) ; \n - } * / \n","Fix addChangeListener _ listenerShouldBeCalledIfObjectChangesAfterAsyncReturn \n Since the HandlerController is removed , the orginal test doesn ' t make \n sense anymore . Rewrite it to a more generic test .",80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ NotificationsTest . java \n - import io . realm . log . LogLevel ; \n - import static org . junit . Assert . assertNull ; \n - \n - \n - @ Test \n - @ Ignore ( "" Listeners for non - looper thread are not allowed for now "" ) \n - public void globalListener _ nonLooperThread _ triggeredByWaitForChange ( ) { \n - realm = Realm . getInstance ( realmConfig ) ; \n - final CountDownLatch latch = new CountDownLatch ( 1 ) ; \n - realm . addChangeListener ( new RealmChangeListener < Realm > ( ) { \n - @ Override \n - public void onChange ( Realm element ) { \n - latch . countDown ( ) ; \n - } \n - } ) ; \n - realm . executeTransactionAsync ( new Realm . Transaction ( ) { \n - @ Override \n - public void execute ( Realm realm ) { \n - realm . createObject ( AllTypes . class ) ; \n - } \n - } ) ; \n - realm . waitForChange ( ) ; \n - TestHelper . awaitOrFail ( latch ) ; \n - } \n - \n - @ Test \n - @ Ignore ( "" Listeners for non - looper thread are not allowed for now "" ) \n - public void globalListener _ nonLooperThread _ triggeredByLocalCommit ( ) { \n - realm = Realm . getInstance ( realmConfig ) ; \n - final CountDownLatch latch = new CountDownLatch ( 1 ) ; \n - realm . addChangeListener ( new RealmChangeListener < Realm > ( ) { \n - @ Override \n - public void onChange ( Realm element ) { \n - latch . countDown ( ) ; \n - } \n - } ) ; \n - realm . executeTransaction ( new Realm . Transaction ( ) { \n - @ Override \n - public void execute ( Realm realm ) { \n - realm . createObject ( AllTypes . class ) ; \n - } \n - } ) ; \n - TestHelper . awaitOrFail ( latch ) ; \n - } \n - \n",Remove ignored test cases . \n Those are ignored since currently adding listeners in non - looper thread \n is not allowed .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ TypeBasedNotificationsTests . java \n + import org . junit . Ignore ; \n + / / FIXME : https : / / github . com / realm / realm - core / pull / 2385 \n + @ Ignore ( "" Enable this after core 2 . 3 . 1 released ! ! "" ) \n",Temporarily disable a test \n https : / / github . com / realm / realm - core / pull / 2385,80
"realm \ realm - library \ src \ androidTest \ AndroidManifest . xml \n + < uses - permission android : name = "" android . permission . SET _ DEBUG _ APP "" / > \n - < application > \n + < application \n + android : debuggable = "" true "" > \n","Options in AndroidManifest for attaching debugger \n android . permission . SET _ DEBUG _ APP and android : debuggable = "" true "" are \n needed for attaching debugger on some devices ( eg . : Huawei device ) .",80
"realm \ realm - library \ src \ androidTest \ AndroidManifest . xml \n + < uses - permission android : name = "" android . permission . SET _ DEBUG _ APP "" / > \n - < application > \n + < application \n + android : debuggable = "" true "" > \n","Options in AndroidManifest for attaching debugger \n android . permission . SET _ DEBUG _ APP and android : debuggable = "" true "" are \n needed for attaching debugger on some devices ( eg . : Huawei device ) .",80
CHANGELOG . md \n + * Upgraded to Realm Sync 2 . 0 . 0 . \n + * Upgraded to Realm Core 4 . 0 . 2 . \n + \n dependencies . list \n - REALM _ SYNC _ VERSION = 2 . 0 . 0 - rc27 \n - REALM _ SYNC _ SHA256 = 3a558b10ecab3e8dbf6cbceae7fe40af38ad8d8467ddd1fe036ce92c1e7810f4 \n + REALM _ SYNC _ VERSION = 2 . 0 . 0 \n + REALM _ SYNC _ SHA256 = 2d3661cdb94d6509b4a43d6daab17c9223fbb1e6608e317205bd61b4ef1b9516 \n,Update Sync to 2 . 0 . 0 ( # 5415 ),80
"CHANGELOG . md \n + * [ ObjectServer ] Fixed "" Cannot open the read only Realm "" issue when get ` PermissionManager ` ( # 5414 ) . \n realm \ realm - library \ src \ objectServer \ java \ io \ realm \ PermissionManager . java \n - . readOnly ( ) \n + / / FIXME : Something is seriously wrong with the Permission Realm . It doesn ' t seem to \n + / / exist on the server . Making it impossible to mark it read only \n + / / . readOnly ( ) \n",Remove readonly for defaultPermissionRealmConfig \n close # 5414,80
"realm \ realm - library \ src \ main \ cpp \ CMakeLists . txt \n - set ( openssl _ FILENAME "" openssl - $ { openssl _ build _ TYPE } - $ { openssl _ VERSION } - Android - $ { ANDROID _ ABI } "" ) \n + set ( openssl _ BUILD _ NUMBER "" 1 "" ) \n + set ( openssl _ FILENAME "" openssl - $ { openssl _ build _ TYPE } - $ { openssl _ VERSION } - $ { openssl _ BUILD _ NUMBER } - Android - $ { ANDROID _ ABI } "" ) \n realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ SSLConfigurationTests . java \n - @ Ignore ( "" See https : / / github . com / realm / ros / issues / 240 "" ) \n - Realm . deleteRealm ( configOld ) ; \n + . name ( "" useSsl "" ) \n - Realm . deleteRealm ( configOld ) ; \n + . name ( "" useSsl "" ) \n - Realm . deleteRealm ( configOld ) ; \n + . name ( "" useSsl "" ) \n + int originalLevel = RealmLog . getLevel ( ) ; \n + RealmLog . remove ( testLogger ) ; \n + RealmLog . setLevel ( originalLevel ) ; \n tools \ sync _ test _ server \ ros - testing - server . js \n + ' - - https ' , \n + ' - - https - key ' , ' / 127 _ 0 _ 0 _ 1 - server . key . pem ' , \n + ' - - https - cert ' , ' / 127 _ 0 _ 0 _ 1 - chain . crt . pem ' , \n + ' - - https - port ' , ' 9443 ' , \n",Enable SSL integration tests ( # 5430 ) \n - Some features were missing which caused ssl tests failures . \n See https : / / github . com / realm / openssl - android / pull / 2 \n Linking with pre - build openssl 1 . 0 . 2k - 1 . \n - Use a new Realm instead of using deleteRealm ( ),80
"CHANGELOG . md \n + # # 4 . 0 . 1 ( YYYY - MM - DD ) \n + \n + # # Bug Fixes \n + \n + * Added ` realm . ignoreKotlinNullability ` as a kapt argument to disable treating kotlin non - null types as ` @ Required ` ( # 5412 ) ( introduced in ` v3 . 6 . 0 ` ) . \n + \n + \n realm \ realm - annotations - processor \ src \ main \ java \ io \ realm \ processor \ ClassMetaData . java \n + private static final String OPTION _ IGNORE _ KOTLIN _ NULLABILITY = "" realm . ignoreKotlinNullability "" ; \n + \n + private final boolean ignoreKotlinNullability ; \n + \n + \n + ignoreKotlinNullability = Boolean . valueOf ( \n + env . getOptions ( ) . getOrDefault ( OPTION _ IGNORE _ KOTLIN _ NULLABILITY , "" false "" ) ) ; \n + if ( ignoreKotlinNullability ) { \n + return false ; \n + } \n + \n realm \ realm - annotations - processor \ src \ main \ java \ io \ realm \ processor \ RealmProcessor . java \n - @ SupportedOptions ( value = { "" realm . suppressWarnings "" } ) \n + @ SupportedOptions ( value = { "" realm . suppressWarnings "" , "" realm . ignoreKotlinNullability "" } ) \n","Add realm . ignoreKotlinNullability \n To disable treating kotlin non - null types as @ Required . \n From v3 . 6 . 0 , all the kotlin RealmModel ' s non - null field will be set as \n required in the schema . However it is a breaking change for the kotlin \n project which has a Realm file created before 3 . 6 . 0 . \n To disable this behaviour introduced in 3 . 6 . 0 , add below things to the \n project ' s build . gradle : \n kapt { \n arguments { \n arg ( "" realm . ignoreKotlinNullability "" , true ) \n } \n } \n Close # 5412",80
"realm \ realm - library \ src \ syncIntegrationTest \ java \ io \ realm \ objectserver \ ProgressListenerTests . java \n + import org . junit . Ignore ; \n + @ Ignore ( "" https : / / github . com / realm / realm - sync / issues / 1770 "" ) \n",Ignore downloadProgressListener _ indefinitely \n Need fix https : / / github . com / realm / realm - sync / issues / 1770,80
"CHANGELOG . md \n + * Increased http connect / write timeout for low bandwidth network . \n realm \ realm - library \ src \ objectServer \ java \ io \ realm \ internal \ network \ OkHttpAuthenticationServer . java \n - . connectTimeout ( 10 , TimeUnit . SECONDS ) \n - . writeTimeout ( 10 , TimeUnit . SECONDS ) \n + . connectTimeout ( 15 , TimeUnit . SECONDS ) \n + . writeTimeout ( 15 , TimeUnit . SECONDS ) \n",Increase http timeout \n Otherwise integration tests would fail when setting the network type to \n GSM on emulator .,80
version . txt \n - 4 . 1 . 0 \n + 4 . 1 . 1 - SNAPSHOT \n,Prepare next release v4 . 1 . 1 - SNAPSHOT,80
dependencies . list \n - REALM _ OBJECT _ SERVER _ DE _ VERSION = 2 . 0 . 0 - rc . 11 \n + REALM _ OBJECT _ SERVER _ DE _ VERSION = 2 . 0 . 4 \n tools \ sync _ test _ server \ Dockerfile \n + # Bypass the ROS license check \n + ENV DOCKER _ DATA _ PATH / \n + ENV ROS _ TOS _ EMAIL _ ADDRESS ' ci @ realm . io ' \n + \n tools \ sync _ test _ server \ ros - testing - server . js \n - env . JENKINS = 1 ; / / Skip email check in ROS \n,Update ROS to 2 . 0 . 4 ( # 5440 ),80
"realm \ realm - library \ src \ main \ java \ io \ realm \ BaseRealm . java \n + import io . realm . internal . ObjectServerFacade ; \n + ObjectServerFacade . getFacade ( configuration . isSyncConfiguration ( ) ) \n + . notifyCommit ( configuration , sharedRealm . getLastSnapshotVersion ( ) ) ; \n",Bring ObjectServer notifyCommit back \n It can be removed in another PR . It is not related with OS Results \n integration .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ internal \ RealmNotifierTests . java \n - RealmNotifier notifier = new AndroidRealmNotifier ( capabilitiesCanDeliver ) ; \n + RealmNotifier notifier = new AndroidRealmNotifier ( null , capabilitiesCanDeliver ) ; \n - final RealmNotifier notifier = new AndroidRealmNotifier ( capabilitiesCanDeliver ) ; \n + final RealmNotifier notifier = new AndroidRealmNotifier ( null , capabilitiesCanDeliver ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ RealmNotifier . java \n + protected RealmNotifier ( SharedRealm sharedRealm ) { \n + this . sharedRealm = sharedRealm ; \n + } \n + \n - void setSharedRealm ( SharedRealm sharedRealm ) { \n - this . sharedRealm = sharedRealm ; \n - } \n - \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ SharedRealm . java \n - private SharedRealm ( long nativePtr , \n + private SharedRealm ( long nativeConfigPtr , \n - Capabilities capabilities , \n - RealmNotifier notifier , \n - this . nativePtr = nativePtr ; \n + Capabilities capabilities = new AndroidCapabilities ( ) ; \n + RealmNotifier realmNotifier = new AndroidRealmNotifier ( this , capabilities ) ; \n + \n + this . nativePtr = nativeGetSharedRealm ( nativeConfigPtr , realmNotifier ) ; \n - this . realmNotifier = notifier ; \n - if ( this . realmNotifier ! = null ) { \n - this . realmNotifier . setSharedRealm ( this ) ; \n - } \n + this . realmNotifier = realmNotifier ; \n - Capabilities capabilities = new AndroidCapabilities ( ) ; \n - RealmNotifier realmNotifier = new AndroidRealmNotifier ( capabilities ) ; \n - return new SharedRealm ( \n - nativeGetSharedRealm ( nativeConfigPtr , realmNotifier ) , \n - config , \n - capabilities , \n - realmNotifier , \n - schemaVersionListener ) ; \n + return new SharedRealm ( nativeConfigPtr , config , schemaVersionListener ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ android \ AndroidRealmNotifier . java \n + import io . realm . internal . SharedRealm ; \n - public AndroidRealmNotifier ( Capabilities capabilities ) { \n + public AndroidRealmNotifier ( SharedRealm sharedRealm , Capabilities capabilities ) { \n + super ( sharedRealm ) ; \n",Init some member vars in SharedRealm constructor \n move initialization of RealmNotifier and Capabilities to SharedRealm \n constructor to make it less confusing .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ DynamicRealmTests . java \n + assertTrue ( allTypes . isLoaded ( ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmResults . java \n - * @ deprecated \n + * Returns { @ code false } if the results are not yet loaded , { @ code true } if they are loaded . \n + * \n + * @ return { @ code true } if the query has completed and the data is available , { @ code false } if the query is still \n + * running in the background . \n - return true ; \n + realm . checkIfValid ( ) ; \n + return collection . getMode ( ) = = Collection . Mode . TABLEVIEW ; \n",Add RealmResults . isLoaded ( ) \n Needed by RxJava support .,80
CHANGELOG . md \n + # # 3 . 1 . 2 ( YYYY - MM - DD ) \n + \n + # # # Bug Fixes \n + \n + * Crash caused by JNI couldn ' t find ` OsObject . notifyChangeListeners ` when ProGurad is enabled ( # 4461 ) . \n + \n realm \ realm - library \ src \ main \ cpp \ jni _ util \ java _ method . cpp \n - REALM _ ASSERT _ DEBUG ( m _ method _ id ! = nullptr ) ; \n + REALM _ ASSERT _ RELEASE ( m _ method _ id ! = nullptr ) ; \n - REALM _ ASSERT _ DEBUG ( m _ method _ id ! = nullptr ) ; \n + REALM _ ASSERT _ RELEASE ( m _ method _ id ! = nullptr ) ; \n - REALM _ ASSERT _ DEBUG ( cls ! = nullptr ) ; \n + REALM _ ASSERT _ RELEASE ( cls ! = nullptr ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ OsObject . java \n + @ KeepMember \n + @ KeepMember \n,KeepMember OsObject . notifyChangeListeners \n - Fix # 4461 . \n - Use release assertion when finding java method .,80
dependencies . list \n - REALM _ SYNC _ SHA256 = b7dd873feac88ec562a3940a799085b99bb8aed3013c36e141e40472837b7040 \n + REALM _ SYNC _ SHA256 = c93caa9b0ff1391550ce6b68ab3822fea7e6ae921498a3ebf3a5e6b17c56fa9b \n,sync 1 . 10 . 5 SHA1 changed due to mistake,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmQueryTests . java \n - assertEquals ( 2 , results . size ( ) ) ; \n + / / FIXME : This bug has not been fixed by the core on the master - 4 . 0 right now . \n + / / This test will failed when core gets updated . \n + / / assertEquals ( 2 , results . size ( ) ) ; \n + assertEquals ( 1 , results . size ( ) ) ; \n",4788 is not fixed on master 4 . 0,80
version . txt \n - 3 . 5 . 0 \n + 3 . 5 . 1 - SNAPSHOT \n,Prepare next release v3 . 5 . 1 - SNAPSHOT,80
"CHANGELOG . md \n + * Crash with "" ' xxx ' doesn ' t exist in current schema . "" when ProGuard is enabled ( # 5211 ) . \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ ColumnIndices . java \n - if ( modelClass . getSimpleName ( ) . equals ( simpleClassName ) ) { \n + if ( Table . getClassNameForTable ( mediator . getTableName ( modelClass ) ) . equals ( simpleClassName ) ) { \n",getColumnInfo was checking obfuscated class name \n It should check the table name instead . \n Close # 5211,80
"examples \ encryptionExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ gridViewExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ introExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ jsonExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ kotlinExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ migrationExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ newsreaderExample \ build . gradle \n + / / FIXME : Fix the proguard with 3rd party libs \n + signingConfig signingConfigs . debug \n examples \ objectServerExample \ build . gradle \n + minifyEnabled true \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n examples \ rxJavaExample \ build . gradle \n + / / FIXME : Fix the proguard with 3rd party libs \n + signingConfig signingConfigs . debug \n examples \ secureTokenAndroidKeyStore \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' \n + } \n + debug { \n + minifyEnabled true \n examples \ threadExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n examples \ threadExample \ src \ main \ java \ io \ realm \ examples \ threads \ ThreadFragment . java \n + dotsView . setRealmResults ( null ) ; \n examples \ threadExample \ src \ main \ java \ io \ realm \ examples \ threads \ widget \ DotsView . java \n + if ( results = = null ) { \n + return ; \n + } \n examples \ unitTestExample \ build . gradle \n - minifyEnabled false \n + minifyEnabled true \n + signingConfig signingConfigs . debug \n + } \n + debug { \n + minifyEnabled true \n","Sign release apk for examples \n - Close # 5184 . without siging , monkeyRelease will fail with \n INSTALL _ PARSE _ FAILED _ NO _ CERTIFICATES \n - Enable proguard for all most all examples , both debug & release . This \n will give us a chance to see proguard issues as early as possible . \n - Fix a "" realm was closed "" crash for thread example .",80
"CHANGELOG . md \n - * Leaked file handler in the Realm Transformer ( # 5521 ) \n + * Leaked file handler in the Realm Transformer ( # 5521 ) . \n + * Potential fix for "" RealmError : Incompatible lock file "" crash ( # 2459 ) . \n - * Updated JavaAssist to 3 . 22 . 0 - GA \n + * Updated JavaAssist to 3 . 22 . 0 - GA . \n + * Upgraded to Realm Sync 2 . 1 . 4 . \n + * Upgraded to Realm Core 4 . 0 . 3 . \n - * Updated Realm Sync to 2 . 1 . 0 \n + * Updated Realm Sync to 2 . 1 . 0 . \n dependencies . list \n - REALM _ SYNC _ VERSION = 2 . 1 . 0 \n - REALM _ SYNC _ SHA256 = cd52b2ee53ef80b4b9ec80eede7ca5fa28a96353ad7e4d26cf516dbb12586966 \n + REALM _ SYNC _ VERSION = 2 . 1 . 4 \n + REALM _ SYNC _ SHA256 = 6d32ef44acbf4a63b654ceeaadce036feeefd04a4ca649a95a22a0e7d56df84d \n",Update sync to 2 . 1 . 4 \n Close # 2459,80
version . txt \n - 4 . 2 . 0 \n + 4 . 2 . 1 - SNAPSHOT \n,Prepare next release v4 . 2 . 1 - SNAPSHOT,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RxJavaTests . java \n - / * final AtomicBoolean subscribedNotified = new AtomicBoolean ( false ) ; \n + final AtomicBoolean subscribedNotified = new AtomicBoolean ( false ) ; \n - assertEquals ( 1 , realm . handlerController . changeListeners . size ( ) ) ; \n + assertEquals ( 1 , realm . sharedRealm . realmNotifier . getListnersListSize ( ) ) ; \n - assertEquals ( 0 , realm . handlerController . changeListeners . size ( ) ) ; * / \n + assertEquals ( 0 , realm . sharedRealm . realmNotifier . getListnersListSize ( ) ) ; \n - / * final CountDownLatch unsubscribeCompleted = new CountDownLatch ( 1 ) ; \n + final CountDownLatch unsubscribeCompleted = new CountDownLatch ( 1 ) ; \n - assertEquals ( 1 , realm . handlerController . changeListeners . size ( ) ) ; \n + assertEquals ( 1 , realm . sharedRealm . realmNotifier . getListnersListSize ( ) ) ; \n - assertEquals ( 1 , realm . handlerController . changeListeners . size ( ) ) ; \n + assertEquals ( 1 , realm . sharedRealm . realmNotifier . getListnersListSize ( ) ) ; \n - realm . close ( ) ; * / \n + realm . close ( ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ internal \ RealmNotifier . java \n + \n + public int getListnersListSize ( ) { \n + return realmObserverPairs . size ( ) ; \n + } \n",Expose listeners list size from RealmNotifier \n And enable related RxJava tests .,80
"realm \ realm - library \ src \ main \ java \ io \ realm \ RealmResults . java \n - if ( className ! = null ) { \n - return new RealmResults < E > ( realm , sortedCollection , className ) ; \n - } else { \n - return new RealmResults < E > ( realm , sortedCollection , classSpec ) ; \n - } \n + return createLoadedResults ( sortedCollection ) ; \n - if ( className ! = null ) { \n - return new RealmResults < E > ( realm , sortedCollection , className ) ; \n - } else { \n - return new RealmResults < E > ( realm , sortedCollection , classSpec ) ; \n - } \n + return createLoadedResults ( sortedCollection ) ; \n - if ( className ! = null ) { \n - return new RealmResults < E > ( realm , sortedCollection , className ) ; \n - } else { \n - return new RealmResults < E > ( realm , sortedCollection , classSpec ) ; \n - } \n + return createLoadedResults ( sortedCollection ) ; \n - if ( className ! = null ) { \n - return new RealmResults < E > ( realm , distinctCollection , className ) ; \n - } else { \n - return new RealmResults < E > ( realm , distinctCollection , classSpec ) ; \n - } \n + return createLoadedResults ( distinctCollection ) ; \n + \n + private RealmResults < E > createLoadedResults ( Collection newCollection ) { \n + RealmResults < E > results ; \n + if ( className ! = null ) { \n + results = new RealmResults < E > ( realm , newCollection , className ) ; \n + } else { \n + results = new RealmResults < E > ( realm , newCollection , classSpec ) ; \n + } \n + results . load ( ) ; \n + return results ; \n + } \n",Load the results of sort / distinct on RealmResults \n Otherwise the size will return 0 which is unexpected .,80
"realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmAsyncQueryTests . java \n + fail ( ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmQuery . java \n + static final String ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE = "" Async query cannot be created on current thread . "" ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE ) ; \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmResults . java \n + realm . sharedRealm . capabilities . checkCanDeliverNotification ( RealmQuery . ASYNC _ QUERY _ WRONG _ THREAD _ MESSAGE ) ; \n",Disallow calling findAllAsync on non - looper thread,80
version . txt \n - 3 . 1 . 2 \n + 3 . 1 . 3 - SNAPSHOT \n,Prepare next release v3 . 1 . 3 - SNAPSHOT,80
"realm \ realm - library \ src \ main \ cpp \ io _ realm _ internal _ SharedRealm . cpp \n - shared _ realm - > update _ schema ( * schema , static _ cast < uint64 _ t > ( version ) , nullptr , true ) ; \n + shared _ realm - > update _ schema ( * schema , static _ cast < uint64 _ t > ( version ) , nullptr , nullptr , true ) ; \n realm \ realm - library \ src \ main \ cpp \ object - store \n - Subproject commit 7c12b340e078aa4ce371347e235eba51f37f84c4 \n + Subproject commit b2a358a1f7a00972f65104f6f61f18445ee04980 \n",Update Object Store \n to b2a358a1f7a \n For getting https : / / github . com / realm / realm - object - store / pull / 485 for the \n following Object Store schema integration work .,80
version . txt \n - 3 . 7 . 2 \n + 3 . 7 . 3 - SNAPSHOT \n,Prepare next release v3 . 7 . 3 - SNAPSHOT,80
"CHANGELOG . md \n + # # 4 . 3 . 2 ( YYYY - MM - DD ) \n + \n + # # # Bug Fixes \n + \n + * Throws a better exception message when calling ` RealmObjectSchema . addField ( ) ` with a ` RealmModel ` class ( # 3388 ) . \n + \n + \n realm \ realm - library \ src \ androidTest \ java \ io \ realm \ RealmObjectSchemaTests . java \n + @ Test \n + public void addField _ realmModelThrows ( ) { \n + if ( type = = ObjectSchemaType . IMMUTABLE ) { \n + return ; \n + } \n + try { \n + schema . addField ( "" test "" , Dog . class ) ; \n + fail ( ) ; \n + } catch ( IllegalArgumentException e ) { \n + assertThat ( e . getMessage ( ) , CoreMatchers . containsString ( \n + "" Use ' addRealmObjectField ( ) ' instead to add fields that link to other RealmObjects : "" ) ) ; \n + } \n + } \n + \n realm \ realm - library \ src \ main \ java \ io \ realm \ MutableRealmObjectSchema . java \n + } else if ( RealmModel . class . isAssignableFrom ( fieldType ) ) { \n + throw new IllegalArgumentException ( String . format ( Locale . US , \n + "" Use ' addRealmObjectField ( ) ' instead to add fields that link to other RealmObjects : % s ( % s ) "" , \n + fieldName , fieldType ) ) ; \n realm \ realm - library \ src \ main \ java \ io \ realm \ RealmObjectSchema . java \n - * @ throws UnsupportedOperationException if this { @ link RealmObjectSchema } is immutable . \n + * @ throws UnsupportedOperationException if this { @ link RealmObjectSchema } is immutable . \n",Better exception message for addField ( ) ( # 5610 ) \n * Better exception message for addField ( ) \n Close # 3388,80
"CHANGELOG . md \n + * Use https for Realm version checker ( # 4043 ) . \n realm \ realm - annotations - processor \ src \ main \ java \ io \ realm \ processor \ RealmVersionChecker . java \n - public static final String REALM _ ANDROID _ DOWNLOAD _ URL = "" http : / / static . realm . io / downloads / java / latest "" ; \n + public static final String REALM _ ANDROID _ DOWNLOAD _ URL = "" https : / / static . realm . io / downloads / java / latest "" ; \n - private static final String VERSION _ URL = "" http : / / static . realm . io / update / java ? "" ; \n + private static final String VERSION _ URL = "" https : / / static . realm . io / update / java ? "" ; \n",Use https for RealmVersionChecker \n Close # 4043,80
"tools \ sync _ test _ server \ ros - testing - server . js \n - waitForRosToInitialize ( attempts - 1 , onSuccess , onError , startSequence ) \n + setTimeout ( function ( ) { \n + waitForRosToInitialize ( attempts - 1 , onSuccess , onError , startSequence ) ; \n + } , 500 ) ; \n - } , 200 ) ; \n + } , 500 ) ; \n - waitForRosToInitialize ( 100 , onSuccess , onError , Date . now ( ) ) ; \n + / / The interval between every health check is 0 . 5 second . Give the ROS 15 seconds to get fully initialized . \n + waitForRosToInitialize ( 30 , onSuccess , onError , Date . now ( ) ) ; \n","Fix CI failure caused by ROS docker \n Health checking without waiting is too frequent . Use 0 . 5 second as the \n interval between every attempt . \n NOTE : CI failure caused by this usually cannot be seen the exact test \n case in the gradle log . But it will give you something like : \n "" Tests on Nexus 5X - 6 . 0 failed : Test run failed to complete . Expected \n 3762 tests , received 3 """,80
"realm - annotations \ src \ main \ java \ io \ realm \ annotations \ Required . java \n - * This annotation will mark the field as not nullable . When the field is { @ link Required } , \n - * it cannot be set to { @ code null } . \n + * This annotation will mark the field or the element of a primitive { @ link io . realm . RealmList } as not nullable . \n - * Only { @ code Boolean , Byte , Short , Integer , Long , Float , Double , String , byte [ ] , Date } can be annotated \n - * with { @ link Required } . Compiling will fail when fields with other types have { @ link Required } annotation . \n - * Fields with primitive types and the { @ link io . realm . RealmList } type are required implicitly . \n - * Fields with { @ link io . realm . RealmObject } type are always nullable . \n + * When a field of type { @ code Boolean , Byte , Short , Integer , Long , Float , Double , String , byte [ ] , Date } is annotated \n + * with { @ link Required } , it cannot be set to { @ code null } . \n + * < p > \n + * Fields with primitive types are implicitly required . \n + * < p > \n + * When a primitive { @ link io . realm . RealmList } ( { @ code RealmList < String > , RealmList < byte [ ] > , RealmList < Boolean > , \n + * RealmList < Byte > , RealmList < Short > , RealmList < Integer > , RealmList < Long > , RealmList < Float > , RealmList < Double > , \n + * RealmList < Date > } ) is annotated with { @ link Required } , it cannot contain { @ code null } values . \n + * < p > \n + * The { @ link io . realm . RealmList } field itself is required always . \n + * < p > \n + * Compiling will fail when fields with other types have { @ link Required } annotation . \n",Javadoc for Required annotation ( # 5646 ) \n It caused confusion like : \n https : / / stackoverflow . com / questions / 47940219 / realmmigrationneededexception - when - adding - realmlistint - kotlin,80
AndroidAnnotations \ androidannotations \ src \ main \ java \ org \ androidannotations \ holder \ EFragmentHolder . java \n + findViewById . annotate ( Override . class ) ; \n + \n - \n + \n,Add missing @ Override annotation for generated fragments,106
AndroidAnnotations \ androidannotations - api \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n AndroidAnnotations \ androidannotations - bundle \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n AndroidAnnotations \ androidannotations - with - codemodel \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n AndroidAnnotations \ androidannotations \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n AndroidAnnotations \ functional - test - 1 - 5 - tests \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n AndroidAnnotations \ functional - test - 1 - 5 \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n - < ignore > < / ignore > \n + < ignore / > \n AndroidAnnotations \ pom . xml \n - < version > 3 . 1 - SNAPSHOT < / version > \n + < version > 3 . 1 < / version > \n - < / scm > \n + < tag > androidannotations - 3 . 1 < / tag > \n + < / scm > \n,[ maven - release - plugin ] prepare release androidannotations - 3 . 1,106
AndroidAnnotations \ androidannotations - api \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations - bundle \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations - with - codemodel \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ functional - test - 1 - 5 - tests \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ functional - test - 1 - 5 \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n AndroidAnnotations \ pom . xml \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 - SNAPSHOT < / version > \n - < tag > androidannotations - 3 . 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,106
. travis . yml \n - build - tools - 19 . 1 \n - android - 14 \n - jdk : \n - - oraclejdk7 \n - - openjdk6 \n - mvn - f AndroidAnnotations / pom . xml install \n - mvn - f examples / maveneclipse / pom . xml install \n,"Revert "" Using JDK6 and JDK7 in Travis "" \n This reverts commit f81d2ba225070b49f2b600986055c9d05121149d .",106
AndroidAnnotations \ androidannotations - api \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n AndroidAnnotations \ androidannotations - bundle \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n AndroidAnnotations \ androidannotations - with - codemodel \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n AndroidAnnotations \ androidannotations \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n AndroidAnnotations \ functional - test - 1 - 5 \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n AndroidAnnotations \ pom . xml \n - < version > 3 . 2 - SNAPSHOT < / version > \n + < version > 3 . 2 < / version > \n - < tag > HEAD < / tag > \n + < tag > androidannotations - 3 . 2 < / tag > \n,[ maven - release - plugin ] prepare release androidannotations - 3 . 2,106
AndroidAnnotations \ androidannotations - api \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations - bundle \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations - with - codemodel \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n AndroidAnnotations \ androidannotations \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n AndroidAnnotations \ functional - test - 1 - 5 \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n AndroidAnnotations \ pom . xml \n - < version > 3 . 2 < / version > \n + < version > 3 . 3 - SNAPSHOT < / version > \n - < tag > androidannotations - 3 . 2 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,106
"x - pack \ docs \ en \ watcher \ actions \ pagerduty . asciidoc \n - "" description "" : "" Main system down , please check ! Happened at { { ctx . execution _ time } } "" \n + "" description "" : "" Main system down , please check ! Happened at { { ctx . execution _ time } } "" , \n",Add missing comma in sample payload for the watcher ' s pagerduty action ( # 65819 ),108
"plugins \ ingest - attachment \ src \ test \ java \ org \ elasticsearch \ ingest \ attachment \ AttachmentProcessorTests . java \n - Map < String , Object > document = new HashMap < > ( ) ; \n - document . put ( "" source _ field "" , getAsBinaryOrBase64 ( file ) ) ; \n - document . putAll ( optionalFields ) ; \n - \n - IngestDocument ingestDocument = RandomDocumentPicks . randomIngestDocument ( random ( ) , document ) ; \n - processor . execute ( ingestDocument ) ; \n - \n - @ SuppressWarnings ( "" unchecked "" ) \n - Map < String , Object > attachmentData = ( Map < String , Object > ) ingestDocument . getSourceAndMetadata ( ) . get ( "" target _ field "" ) ; \n - return attachmentData ; \n + return parseDocument ( file , processor , optionalFields , false ) ; \n",Minor DRYing up of attachment processor tests ( # 65975 ),108
"docs \ plugins \ ingest - attachment . asciidoc \n + | ` resource _ name ` | no | | Field containing the name of the resource to decode . If specified , the processor passes this resource name to the underlying Tika library to enable https : / / tika . apache . org / 1 . 24 . 1 / detection . html # Resource _ Name _ Based _ Detection [ Resource Name Based Detection ] . \n - \n + \n - ' http : / / localhost : 9200 / my - index - 000001 / _ doc / my _ id ? pipeline = cbor - attachment ' , \n - data = cbor2 . dumps ( doc ) , \n + ' http : / / localhost : 9200 / my - index - 000001 / _ doc / my _ id ? pipeline = cbor - attachment ' , \n + data = cbor2 . dumps ( doc ) , \n - - - - \n - To prevent extracting too many chars and overload the node memory , the number of chars being used for extraction \n - is limited by default to ` 100000 ` . You can change this value by setting ` indexed _ chars ` . Use ` - 1 ` for no limit but \n + To prevent extracting too many chars and overload the node memory , the number of chars being used for extraction \n + is limited by default to ` 100000 ` . You can change this value by setting ` indexed _ chars ` . Use ` - 1 ` for no limit but \n",[ DOCS ] resource _ name property for attachment ingest processor ( # 65974 ),108
"docs \ reference \ cat \ shards . asciidoc \n + \n - deprecated : : [ 7 . 10 . 0 , "" This parameter does not affect the request . It will be removed in a future release . "" ] \n + deprecated : : [ 7 . 11 . 0 , "" This parameter does not affect the request . It will be removed in a future release . "" ] \n rest - api - spec \ src \ main \ resources \ rest - api - spec \ api \ cat . shards . json \n - "" version "" : "" 8 . 0 . 0 "" , \n + "" version "" : "" 7 . 11 . 0 "" , \n",Adjust deprecation version after backport ( # 64789 ),108
"docs \ reference \ cat \ indices . asciidoc \n + \n - deprecated : : [ 7 . 10 . 0 , "" This parameter does not affect the request . It will be removed in a future release . "" ] \n + deprecated : : [ 7 . 11 . 0 , "" This parameter does not affect the request . It will be removed in a future release . "" ] \n rest - api - spec \ src \ main \ resources \ rest - api - spec \ api \ cat . indices . json \n - "" version "" : "" 8 . 0 . 0 "" , \n + "" version "" : "" 7 . 11 . 0 "" , \n",Adjust deprecation version after backport ( # 64794 ) \n Co - authored - by : Elastic Machine < elasticmachine @ users . noreply . github . com >,108
"plugins \ ingest - attachment \ src \ test \ java \ org \ elasticsearch \ ingest \ attachment \ AttachmentProcessorTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 66086 "" ) \n",Mute failing AttachmentProcessor . testIndexedCharsWithResourceName test ( # 66121 ),108
"server \ src \ main \ java \ org \ elasticsearch \ cluster \ metadata \ MetadataMigrateToDataStreamService . java \n - if ( currentState . nodes ( ) . getMinNodeVersion ( ) . before ( Version . V _ 8 _ 0 _ 0 ) ) { \n - throw new IllegalStateException ( "" data stream migration requires minimum node version of "" + Version . V _ 8 _ 0 _ 0 ) ; \n + if ( currentState . nodes ( ) . getMinNodeVersion ( ) . before ( Version . V _ 7 _ 11 _ 0 ) ) { \n + throw new IllegalStateException ( "" data stream migration requires minimum node version of "" + Version . V _ 7 _ 11 _ 0 ) ; \n x - pack \ plugin \ src \ test \ resources \ rest - api - spec \ test \ data _ stream \ 130 _ migrate _ to _ data _ stream . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : "" change to 7 . 10 . 99 after backport "" \n + version : "" - 7 . 10 . 99 "" \n + reason : "" migrate API released in 7 . 11 . 0 "" \n - do : \n",Update BWC versions after backport of # 61525 ( # 66195 ),108
"server \ src \ main \ java \ org \ elasticsearch \ rest \ action \ cat \ RestNodesAction . java \n - import org . elasticsearch . Version ; \n - if ( request . hasParam ( "" local "" ) & & Version . CURRENT . major = = Version . V _ 7 _ 0 _ 0 . major + 1 ) { / / only needed in v8 to catch breaking usages \n - throw new IllegalArgumentException ( "" parameter [ local ] is not supported "" ) ; \n - } \n server \ src \ test \ java \ org \ elasticsearch \ rest \ action \ cat \ RestNodesActionTests . java \n - import org . elasticsearch . client . node . NodeClient ; \n - import org . elasticsearch . common . settings . Settings ; \n - import org . elasticsearch . threadpool . TestThreadPool ; \n - import static org . hamcrest . Matchers . is ; \n - \n - public void testCatNodesRejectsLocalParameter ( ) { \n - assumeTrue ( "" test is only needed in v8 , can be removed in v9 "" , Version . CURRENT . major = = Version . V _ 7 _ 0 _ 0 . major + 1 ) ; \n - TestThreadPool threadPool = new TestThreadPool ( RestNodesActionTests . class . getName ( ) ) ; \n - NodeClient client = new NodeClient ( Settings . EMPTY , threadPool ) ; \n - FakeRestRequest request = new FakeRestRequest ( ) ; \n - request . params ( ) . put ( "" local "" , randomFrom ( "" "" , "" true "" , "" false "" , randomAlphaOfLength ( 10 ) ) ) ; \n - assertThat ( expectThrows ( IllegalArgumentException . class , ( ) - > action . doCatRequest ( request , client ) ) . getMessage ( ) , \n - is ( "" parameter [ local ] is not supported "" ) ) ; \n - terminate ( threadPool ) ; \n - } \n",Remove redundant check in RestNodesAction ( # 64952 ),108
"server \ src \ main \ java \ org \ elasticsearch \ cluster \ metadata \ IndexNameExpressionResolver . java \n + import java . util . LinkedHashSet ; \n - final Set < Index > concreteIndices = new HashSet < > ( expressions . size ( ) ) ; \n + final Set < Index > concreteIndices = new LinkedHashSet < > ( expressions . size ( ) ) ; \n server \ src \ test \ java \ org \ elasticsearch \ cluster \ metadata \ IndexNameExpressionResolverTests . java \n + public void testConcreteIndicesPreservesOrdering ( ) { \n + final String dataStreamName = "" my - data - stream - 2020 - 02 - 27 "" ; \n + IndexMetadata index1 = createBackingIndex ( dataStreamName , 1 ) . build ( ) ; \n + IndexMetadata index2 = createBackingIndex ( dataStreamName , 2 ) . build ( ) ; \n + \n + Metadata . Builder mdBuilder = Metadata . builder ( ) \n + . put ( index1 , false ) \n + . put ( index2 , false ) \n + . put ( new DataStream ( dataStreamName , createTimestampField ( "" @ timestamp "" ) , List . of ( index1 . getIndex ( ) , index2 . getIndex ( ) ) ) ) ; \n + ClusterState state = ClusterState . builder ( new ClusterName ( "" _ name "" ) ) . metadata ( mdBuilder ) . build ( ) ; \n + \n + { \n + IndicesOptions indicesOptions = IndicesOptions . STRICT _ EXPAND _ OPEN ; \n + Index [ ] result = indexNameExpressionResolver . concreteIndices ( state , indicesOptions , true , dataStreamName ) ; \n + assertThat ( result . length , equalTo ( 2 ) ) ; \n + assertThat ( result [ 0 ] . getName ( ) , equalTo ( DataStream . getDefaultBackingIndexName ( dataStreamName , 1 ) ) ) ; \n + assertThat ( result [ 1 ] . getName ( ) , equalTo ( DataStream . getDefaultBackingIndexName ( dataStreamName , 2 ) ) ) ; \n + } \n + } \n + \n",Preserve ordering when resolving data stream indices ( # 65027 ),108
"build . gradle \n - boolean bwc _ tests _ enabled = true \n - final String bwc _ tests _ disabled _ issue = "" "" / * place a PR link here when committing bwc changes * / \n + boolean bwc _ tests _ enabled = false \n + final String bwc _ tests _ disabled _ issue = "" https : / / github . com / elastic / elasticsearch / issues / 66370 "" / * place a PR link here when committing bwc changes * / \n",Disable BWC tests until # 66370 is closed ( # 66378 ),108
CONTRIBUTING . md \n - file is generated automatically after IntelliJ finishes syncing . \n + file is generated automatically after IntelliJ finishes syncing . You can \n + manually generate the file with ` . / gradlew configureIdeCheckstyle ` in case \n + it is removed due to a ` . / gradlew clean ` or other action . \n,Add command for manually generating Checkstyle config ( # 66421 ),108
"server \ src \ main \ java \ org \ elasticsearch \ index \ cache \ query \ QueryCacheStats . java \n + import org . apache . logging . log4j . LogManager ; \n + import org . apache . logging . log4j . Logger ; \n + import org . apache . logging . log4j . message . ParameterizedMessage ; \n + import org . elasticsearch . ExceptionsHelper ; \n + private static final Logger logger = LogManager . getLogger ( QueryCacheStats . class ) ; \n + \n + \n + / / log only the first time a negative value is encountered for query cache size \n + / / see : https : / / github . com / elastic / elasticsearch / issues / 55434 \n + if ( ramBytesUsed < - 1 & & ( ramBytesUsed + stats . ramBytesUsed > = 0 ) ) { \n + logger . debug ( ( ) - > new ParameterizedMessage ( \n + "" negative query cache size [ { } ] on thread [ { } ] with stats [ { } ] and stack trace : \ n { } "" , \n + ramBytesUsed , \n + Thread . currentThread ( ) . getName ( ) , \n + stats . ramBytesUsed , \n + ExceptionsHelper . formatStackTrace ( Thread . currentThread ( ) . getStackTrace ( ) ) ) ) ; \n + } \n",Debug logging for error conditions in query cache stats ( # 67444 ),108
"x - pack \ plugin \ ingest \ src \ main \ java \ org \ elasticsearch \ xpack \ ingest \ CommunityIdProcessor . java \n - private final MessageDigest messageDigest ; \n + private final ThreadLocal < MessageDigest > messageDigest ; \n - MessageDigest messageDigest , \n + ThreadLocal < MessageDigest > messageDigest , \n - return messageDigest ; \n + return messageDigest . get ( ) ; \n - ingestDocument . setFieldValue ( targetField , flow . toCommunityId ( messageDigest , seed ) ) ; \n + MessageDigest md = messageDigest . get ( ) ; \n + md . reset ( ) ; \n + ingestDocument . setFieldValue ( targetField , flow . toCommunityId ( md , seed ) ) ; \n - MessageDigest messageDigest ; \n - try { \n - messageDigest = MessageDigest . getInstance ( "" SHA - 1 "" ) ; \n - } catch ( NoSuchAlgorithmException e ) { \n - throw new IllegalStateException ( "" unable to obtain SHA - 1 hasher "" , e ) ; \n - } \n + ThreadLocal < MessageDigest > messageDigest = ThreadLocal . withInitial ( ( ) - > { \n + try { \n + return MessageDigest . getInstance ( "" SHA - 1 "" ) ; \n + } catch ( NoSuchAlgorithmException e ) { \n + throw new IllegalStateException ( "" unable to obtain SHA - 1 hasher "" , e ) ; \n + } \n + } ) ; \n x - pack \ plugin \ ingest \ src \ test \ java \ org \ elasticsearch \ xpack \ ingest \ CommunityIdProcessorTests . java \n + import java . security . NoSuchAlgorithmException ; \n - private MessageDigest messageDigest ; \n + private ThreadLocal < MessageDigest > messageDigest ; \n - messageDigest = MessageDigest . getInstance ( "" SHA - 1 "" ) ; \n + messageDigest = ThreadLocal . withInitial ( ( ) - > { \n + try { \n + return MessageDigest . getInstance ( "" SHA - 1 "" ) ; \n + } catch ( NoSuchAlgorithmException e ) { \n + throw new IllegalStateException ( "" unable to obtain SHA - 1 hasher "" , e ) ; \n + } \n + } ) ; \n",Use thread - local instances of MessageDigest in community _ id processor ( # 68032 ),108
server \ src \ test \ java \ org \ elasticsearch \ cluster \ metadata \ DataStreamTests . java \n - var indicesToAdd = DataStreamTestHelper . randomIndexInstances ( ) ; \n + var indicesToAdd = new ArrayList < Index > ( ) ; \n + while ( indicesToAdd . isEmpty ( ) ) { \n + / / ensure at least one index \n + indicesToAdd . addAll ( DataStreamTestHelper . randomIndexInstances ( ) ) ; \n + } \n,Fix failing data stream snapshot test ( # 69004 ),108
"x - pack \ qa \ rolling - upgrade \ src \ test \ java \ org \ elasticsearch \ upgrades \ MlJobSnapshotUpgradeIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67059 "" ) \n",Mute failing MlJobSnapshotUpgradeIT . testSnapshotUpgrader test ( # 67060 ),108
"plugins \ ingest - attachment \ src \ test \ java \ org \ elasticsearch \ ingest \ attachment \ AttachmentProcessorTests . java \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 66086 "" ) \n - assertThat ( attachmentData . get ( "" content "" ) . toString ( ) , containsString ( "" 碩鼠よ碩鼠よ、 \ n我が黍を食らう無かれ！ "" ) ) ; \n + assertThat ( attachmentData . get ( "" content "" ) . toString ( ) , containsString ( "" 碩鼠よ碩鼠よ、 "" + System . lineSeparator ( ) + "" 我が黍を食らう無かれ！ "" ) ) ; \n",Fix attachment processor test that fails on Windows ( # 67156 ),108
"server \ src \ main \ resources \ org \ elasticsearch \ bootstrap \ security . policy \n + / / system memory on Linux systems affected by JDK bug ( # 66629 ) \n + permission java . io . FilePermission "" / proc / meminfo "" , "" read "" ; \n",Allow reading of / proc / meminfo for JDK bug workaround ( # 68742 ),108
"server \ src \ main \ java \ org \ elasticsearch \ action \ admin \ indices \ rollover \ MetadataRolloverService . java \n + \n + @ Override \n + public String toString ( ) { \n + return String . format ( \n + Locale . ROOT , \n + "" cluster state version [ % d ] , rollover index name [ % s ] , source index name [ % s ] "" , \n + clusterState . version ( ) , \n + rolloverIndexName , \n + sourceIndexName \n + ) ; \n + } \n server \ src \ main \ java \ org \ elasticsearch \ action \ admin \ indices \ rollover \ TransportRolloverAction . java \n + import org . apache . logging . log4j . LogManager ; \n + import org . apache . logging . log4j . Logger ; \n + private static final Logger logger = LogManager . getLogger ( TransportRolloverAction . class ) ; \n + logger . trace ( "" rollover pre - result [ { } ] "" , preResult ) ; \n + logger . trace ( "" rollover result [ { } ] "" , rolloverResult ) ; \n - throw new ElasticsearchException ( "" Concurrent modification of alias [ { } ] during rollover "" , \n - rolloverRequest . getRolloverTarget ( ) ) ; \n + throw new ElasticsearchException ( "" Concurrent modification of alias or data stream [ { } ] during "" + \n + "" rollover ( expected [ { } ] but found [ { } ] ) "" , \n + rolloverRequest . getRolloverTarget ( ) , sourceIndexName , rolloverResult . sourceIndexName ) ; \n",Improve rollover logging for error scenarios ( # 67294 ),108
"backends \ gdx - backend - lwjgl3 \ src \ com \ badlogic \ gdx \ backends \ lwjgl3 \ Lwjgl3Application . java \n + import com . badlogic . gdx . utils . SharedLibraryLoader ; \n - / / GLFW . glfwWindowHint ( GLFW . GLFW _ CLIENT _ API , GLFW . GLFW _ OPENGL _ API ) ; \n - GLFW . glfwWindowHint ( GLFW . GLFW _ OPENGL _ FORWARD _ COMPAT , GLFW . GLFW _ TRUE ) ; \n - GLFW . glfwWindowHint ( GLFW . GLFW _ OPENGL _ PROFILE , GLFW . GLFW _ OPENGL _ CORE _ PROFILE ) ; \n + if ( SharedLibraryLoader . isMac ) { \n + / / hints mandatory on OS X for GL 3 . 2 + context creation , but fail on Windows if the \n + / / WGL _ ARB _ create _ context extension is not available \n + / / see : http : / / www . glfw . org / docs / latest / compat . html \n + GLFW . glfwWindowHint ( GLFW . GLFW _ OPENGL _ FORWARD _ COMPAT , GLFW . GLFW _ TRUE ) ; \n + GLFW . glfwWindowHint ( GLFW . GLFW _ OPENGL _ PROFILE , GLFW . GLFW _ OPENGL _ CORE _ PROFILE ) ; \n + } \n",GL3 core profile hint only mandatory on OS X . Fixes # 3932 .,115
tests \ gdx - tests - lwjgl3 \ src \ com \ badlogic \ gdx \ tests \ lwjgl3 \ Lwjgl3TestStarter . java \n - lastClickedTestButton . setColor ( Color . WHITE ) ; \n + if ( lastClickedTestButton ! = null ) { \n + lastClickedTestButton . setColor ( Color . WHITE ) ; \n + } \n,Fix NPE on first run of Lwjgl3TestStarter on a system w / o previously saved prefs .,115
"gdx \ src \ com \ badlogic \ gdx \ graphics \ g3d \ decals \ CameraGroupStrategy . java \n + "" void main ( ) \ n "" / / \n + "" { \ n "" / / \n + "" v _ color = "" + ShaderProgram . COLOR _ ATTRIBUTE + "" ; \ n "" / / \n + + "" v _ color . a = v _ color . a * ( 255 . 0 / 254 . 0 ) ; \ n "" / / \n + "" v _ texCoords = "" + ShaderProgram . TEXCOORD _ ATTRIBUTE + "" 0 ; \ n "" / / \n + "" gl _ Position = u _ projectionViewMatrix * "" + ShaderProgram . POSITION _ ATTRIBUTE + "" ; \ n "" / / \n + "" } \ n "" ; \n",Apply vertex color alpha scaling to default shader in CameraGroupStrategy . See # 1815 for original issue .,115
"gdx \ src \ com \ badlogic \ gdx \ graphics \ Texture . java \n - setFilter ( minFilter , magFilter ) ; \n - setWrap ( uWrap , vWrap ) ; \n + unsafeSetFilter ( minFilter , magFilter , true ) ; \n + unsafeSetWrap ( uWrap , vWrap , true ) ; \n","Avoid calls to bind ( ) when creating texture ( # 4632 ) \n More simple version of the original PR , using existing unsafe * ( ) functions .",115
"CHANGES \n - API Addition : Make it possible to disable sound on the GWT - Backend with disableSound = true . \n - API Change : ScrollPane setWidget deprecated in favor of setActor to match other APIs . \n - API Change : removed JGLFW backend \n + - Fixed mixed up use of TexturePacker . Settings . stripWhitespaceX | Y . \n - Fix performance regression in LWJGL3 backend , use java . nio instead of BufferUtils . Those are intrinsics and quite a bit faster than BufferUtils on HotSpot . \n extensions \ gdx - tools \ src \ com \ badlogic \ gdx \ tools \ texturepacker \ ImageProcessor . java \n - if ( settings . stripWhitespaceX ) { \n + if ( settings . stripWhitespaceY ) { \n - if ( settings . stripWhitespaceY ) { \n + if ( settings . stripWhitespaceX ) { \n",Fix mixed up use of stripWhitespaceX | Y texture packer settings .,115
"gdx \ src \ com \ badlogic \ gdx \ scenes \ scene2d \ Stage . java \n - if ( screenX < viewport . getScreenX ( ) | | screenX > = viewport . getScreenX ( ) + viewport . getScreenWidth ( ) ) return false ; \n - if ( Gdx . graphics . getHeight ( ) - screenY < viewport . getScreenY ( ) \n - | | Gdx . graphics . getHeight ( ) - screenY > = viewport . getScreenY ( ) + viewport . getScreenHeight ( ) ) return false ; \n + if ( ! isInsideViewport ( screenX , screenY ) ) return false ; \n - if ( screenX < viewport . getScreenX ( ) | | screenX > = viewport . getScreenX ( ) + viewport . getScreenWidth ( ) ) return false ; \n - if ( Gdx . graphics . getHeight ( ) - screenY < viewport . getScreenY ( ) \n - | | Gdx . graphics . getHeight ( ) - screenY > = viewport . getScreenY ( ) + viewport . getScreenHeight ( ) ) return false ; \n + if ( ! isInsideViewport ( screenX , screenY ) ) return false ; \n + / * * Check if screen coordinates are inside the viewport ' s screen area . * / \n + protected boolean isInsideViewport ( int screenX , int screenY ) { \n + int x0 = viewport . getScreenX ( ) ; \n + int x1 = x0 + viewport . getScreenWidth ( ) ; \n + int y0 = viewport . getScreenY ( ) ; \n + int y1 = y0 + viewport . getScreenHeight ( ) ; \n + screenY = Gdx . graphics . getHeight ( ) - screenY ; \n + return screenX > = x0 & & screenX < x1 & & screenY > = y0 & & screenY < y1 ; \n + } \n + \n","Move mouse / touch event checks against viewport area into separate member function . \n Allows applications to override these checks in case they are not applicable , e . g . if the stage operates with a logical size not matching Gdx . graphics . get [ Width | Height ] ( ) .",115
"fetch . xml \n - < property name = "" lwjgl - version "" value = "" 3 . 1 . 5 "" / > \n + < property name = "" lwjgl - version "" value = "" 3 . 2 . 0 "" / > \n gradle \ dependencies . gradle \n - versions . lwjgl3 = "" 3 . 1 . 5 "" \n + versions . lwjgl3 = "" 3 . 2 . 0 "" \n pom . xml \n - < lwjgl3 . version > 3 . 1 . 5 < / lwjgl3 . version > \n + < lwjgl3 . version > 3 . 2 . 0 < / lwjgl3 . version > \n",Update to LWJGL 3 . 2 . 0,115
"extensions \ gdx - controllers \ gdx - controllers - lwjgl3 \ src \ com \ badlogic \ gdx \ controllers \ lwjgl3 \ Lwjgl3Controller . java \n - listener . axisMoved ( this , i , axes . get ( i ) ) ; \n + if ( listener . axisMoved ( this , i , axes . get ( i ) ) ) break ; \n - listener . buttonDown ( this , i ) ; \n + if ( listener . buttonDown ( this , i ) ) break ; \n - listener . buttonUp ( this , i ) ; \n + if ( listener . buttonUp ( this , i ) ) break ; \n - listener . povMoved ( this , i , getPov ( i ) ) ; \n + if ( listener . povMoved ( this , i , getPov ( i ) ) ) break ; \n extensions \ gdx - controllers \ gdx - controllers - lwjgl3 \ src \ com \ badlogic \ gdx \ controllers \ lwjgl3 \ Lwjgl3ControllerManager . java \n - listener . axisMoved ( controller , axisCode , value ) ; \n + if ( listener . axisMoved ( controller , axisCode , value ) ) break ; \n - listener . buttonDown ( controller , buttonCode ) ; \n + if ( listener . buttonDown ( controller , buttonCode ) ) break ; \n - listener . buttonUp ( controller , buttonCode ) ; \n + if ( listener . buttonUp ( controller , buttonCode ) ) break ; \n - listener . povMoved ( controller , hatCode , value ) ; \n + if ( listener . povMoved ( controller , hatCode , value ) ) break ; \n","lwjgl3 controller : fulfill interface contract , stop iterating listeners on return value",115
"CHANGES \n - Update to MobiVM 2 . 3 . 6 release \n + - Update to LWJGL 3 . 2 . 1 \n - API Addition : Input allows getting the maximum number of pointers supported by the backend \n - API Addition : Configuration option added to allow setting a max number of threads to use for net requests \n - API Change : NetJavaImpl now uses a cached thread pool to allow concurrent requests ( by default , the thread pool is unbounded - use maxNetThreads in backend configurations to set a limit - set to 1 for previous behavior ) \n fetch . xml \n - < property name = "" lwjgl - version "" value = "" 3 . 2 . 0 "" / > \n + < property name = "" lwjgl - version "" value = "" 3 . 2 . 1 "" / > \n gradle \ dependencies . gradle \n - versions . lwjgl3 = "" 3 . 2 . 0 "" \n + versions . lwjgl3 = "" 3 . 2 . 1 "" \n pom . xml \n - < lwjgl3 . version > 3 . 2 . 0 < / lwjgl3 . version > \n + < lwjgl3 . version > 3 . 2 . 1 < / lwjgl3 . version > \n",Update LWJGL3 backend to 3 . 2 . 1 .,115
"CHANGES \n - Removed OSX 32 - bit support \n - API Change : By default LWJGL2 backend no longer does pause / resume when becoming background / foreground window . New app config setting was added to enable the old behavior . \n - API Change : By default LWJGL2 backend now does pause / resume when window is minimized / restored . New app config setting was added to disable this behavior . \n + - LWJGL3 : Fixed window creation ignoring refresh rate of fullscreen mode . \n - API Addition : Add support for stripping whitespace in PixmapPacker \n backends \ gdx - backend - lwjgl3 \ src \ com \ badlogic \ gdx \ backends \ lwjgl3 \ Lwjgl3Application . java \n - / / glfwWindowHint ( GLFW . GLFW _ REFRESH _ RATE , config . fullscreenMode . refreshRate ) ; \n + GLFW . glfwWindowHint ( GLFW . GLFW _ REFRESH _ RATE , config . fullscreenMode . refreshRate ) ; \n",LWJGL3 : fixed window creation ignoring refresh rate of fullscreen mode .,115
samples \ guide \ src \ main \ java \ okhttp3 \ recipes \ ParseResponseWithGson . java \n + response . body ( ) . close ( ) ; \n + \n,Updated gson recipe to close response body .,121
okhttp - testing - support \ src \ main \ java \ okhttp3 \ internal \ io \ InMemoryFileSystem . java \n - @ Override public boolean exists ( File file ) throws IOException { \n + @ Override public boolean exists ( File file ) { \n okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ DiskLruCacheTest . java \n - private void assertGarbageFilesAllDeleted ( ) throws Exception { \n + private void assertGarbageFilesAllDeleted ( ) { \n okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ FaultyFileSystem . java \n - @ Override public boolean exists ( File file ) throws IOException { \n + @ Override public boolean exists ( File file ) { \n okhttp \ src \ main \ java \ okhttp3 \ internal \ io \ FileSystem . java \n - @ Override public boolean exists ( File file ) throws IOException { \n + @ Override public boolean exists ( File file ) { \n - boolean exists ( File file ) throws IOException ; \n + boolean exists ( File file ) ; \n,Removed IOException from FileSystem exists method as this should never occur .,121
"okhttp - tests \ src \ test \ java \ okhttp3 \ InterceptorTest . java \n + import okhttp3 . mockwebserver . SocketPolicy ; \n + @ Test public void networkInterceptorReturnsConnectionOnEmptyBody ( ) throws Exception { \n + server . enqueue ( new MockResponse ( ) \n + . setSocketPolicy ( SocketPolicy . DISCONNECT _ AT _ END ) \n + . addHeader ( "" Connection "" , "" Close "" ) ) ; \n + \n + Interceptor interceptor = new Interceptor ( ) { \n + @ Override public Response intercept ( Chain chain ) throws IOException { \n + Response response = chain . proceed ( chain . request ( ) ) ; \n + assertNotNull ( chain . connection ( ) ) ; \n + return response ; \n + } \n + } ; \n + \n + client = client . newBuilder ( ) \n + . addNetworkInterceptor ( interceptor ) \n + . build ( ) ; \n + \n + Request request = new Request . Builder ( ) \n + . url ( server . url ( "" / "" ) ) \n + . build ( ) ; \n + \n + Response response = client . newCall ( request ) . execute ( ) ; \n + response . body ( ) . close ( ) ; \n + } \n + \n okhttp \ src \ main \ java \ okhttp3 \ internal \ http \ HttpEngine . java \n - networkResponse = new NetworkInterceptorChain ( 0 , networkRequest ) . proceed ( networkRequest ) ; \n + networkResponse = new NetworkInterceptorChain ( 0 , networkRequest , \n + streamAllocation . connection ( ) ) . proceed ( networkRequest ) ; \n + private final Connection connection ; \n - NetworkInterceptorChain ( int index , Request request ) { \n + NetworkInterceptorChain ( int index , Request request , Connection connection ) { \n + this . connection = connection ; \n - return streamAllocation . connection ( ) ; \n + return connection ; \n - NetworkInterceptorChain chain = new NetworkInterceptorChain ( index + 1 , request ) ; \n + NetworkInterceptorChain chain = new NetworkInterceptorChain ( index + 1 , request , connection ) ; \n",Ensure network interceptors always have access to the underlying connection .,121
"okhttp \ src \ main \ java \ okhttp3 \ RealCall . java \n - super ( "" OkHttp % s "" , originalRequest . url ( ) . toString ( ) ) ; \n + super ( "" OkHttp % s "" , redactedUrl ( ) . toString ( ) ) ; \n - HttpUrl redactedUrl = originalRequest . url ( ) . resolve ( "" / . . . "" ) ; \n - return string + "" to "" + redactedUrl ; \n + return string + "" to "" + redactedUrl ( ) ; \n + } \n + \n + HttpUrl redactedUrl ( ) { \n + return originalRequest . url ( ) . resolve ( "" / . . . "" ) ; \n",Redact the full url in AsyncCall thread name . \n We don ' t want to accidentally leak sensitive information that may be \n embedded in the url .,121
"okhttp - ws - tests \ src \ test \ java \ okhttp3 \ ws \ WebSocketCallTest . java \n - @ Test public void okButNotOk ( ) { \n - server . enqueue ( new MockResponse ( ) . setResponseCode ( 200 ) ) ; \n + @ Test public void non101RetainsBody ( ) throws IOException { \n + server . enqueue ( new MockResponse ( ) . setResponseCode ( 200 ) . setBody ( "" Body "" ) ) ; \n + listener . assertResponse ( 200 , "" Body "" ) ; \n - @ Test public void notFound ( ) { \n + @ Test public void notFound ( ) throws IOException { \n + listener . assertResponse ( 404 , "" "" ) ; \n + } \n + \n + @ Test public void clientTimeoutClosesBody ( ) throws IOException { \n + server . enqueue ( new MockResponse ( ) . setResponseCode ( 408 ) ) ; \n + WebSocketListener serverListener = new EmptyWebSocketListener ( ) ; \n + server . enqueue ( new MockResponse ( ) . withWebSocketUpgrade ( serverListener ) ) ; \n + \n + WebSocket webSocket = awaitWebSocket ( ) ; \n + webSocket . sendPing ( new Buffer ( ) . writeUtf8 ( "" WebSockets are fun ! "" ) ) ; \n + listener . assertPong ( new Buffer ( ) . writeUtf8 ( "" WebSockets are fun ! "" ) ) ; \n - listener . onFailure ( e , null ) ; \n + listener . onFailure ( e , response ) ; \n okhttp - ws - tests \ src \ test \ java \ okhttp3 \ ws \ WebSocketRecorder . java \n + private Response response ; \n + this . response = response ; \n + public void assertResponse ( int code , String body ) throws IOException { \n + assertNotNull ( response ) ; \n + assertEquals ( code , response . code ( ) ) ; \n + assertEquals ( body , response . body ( ) . string ( ) ) ; \n + } \n + \n okhttp - ws \ src \ main \ java \ okhttp3 \ ws \ WebSocketCall . java \n - Util . closeQuietly ( response . body ( ) ) ; \n + response . code ( ) \n + "" "" \n okhttp \ src \ main \ java \ okhttp3 \ internal \ http \ HttpEngine . java \n - if ( ! forWebSocket ) { \n + if ( ! forWebSocket | | networkResponse . code ( ) ! = 101 ) { \n","Retain response body when web socket returns non - 101 response code . \n This change also fixes an edge case where a server returns a response \n that allows a follow up request . Previously , this would cause an \n exception because the body was being ignored .",121
"okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ framed \ Http2ConnectionTest . java \n + import org . junit . Ignore ; \n - @ Test public void peerHttp2ServerZerosCompressionTable ( ) throws Exception { \n + @ Test \n + @ Ignore ( "" Working through making this work with the new HPACK encoder . "" ) \n + public void peerHttp2ServerZerosCompressionTable ( ) throws Exception { \n okhttp \ src \ main \ java \ okhttp3 \ internal \ framed \ Http2 . java \n - if ( settings . getHeaderTableSize ( ) > = 0 ) { \n - hpackReader . headerTableSizeSetting ( settings . getHeaderTableSize ( ) ) ; \n - } \n",Do not allow remote peer to arbitrarily size the HPACK decoder dynamic table .,121
okhttp \ src \ main \ java \ okhttp3 \ internal \ http2 \ Http2Writer . java \n - if ( peerSettings . getHeaderTableSize ( ) > - 1 ) { \n + if ( peerSettings . getHeaderTableSize ( ) ! = - 1 ) { \n,Clarify comparison test for a change in header table size .,121
"okhttp \ src \ main \ java \ okhttp3 \ internal \ http2 \ Http2Codec . java \n - import okhttp3 . internal . http . HttpMethod ; \n - boolean permitsRequestBody = HttpMethod . permitsRequestBody ( request . method ( ) ) ; \n + boolean hasRequestBody = request . body ( ) ! = null ; \n - stream = connection . newStream ( requestHeaders , permitsRequestBody ) ; \n + stream = connection . newStream ( requestHeaders , hasRequestBody ) ; \n",Avoid sending empty HTTP / 2 data frames when there is no request body . \n Closes : https : / / github . com / square / okhttp / issues / 2892,121
"okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ cache \ DiskLruCacheTest . java \n + import org . junit . Ignore ; \n + @ Test \n + @ Ignore \n + public void recoverFromInitializationFailure ( ) throws IOException { \n + / / Add an uncommitted entry . This will get detected on initialization , and the cache will \n + / / attempt to delete the file . Do not explicitly close the cache here so the entry is left as \n + / / incomplete . \n + DiskLruCache . Editor creator = cache . edit ( "" k1 "" ) ; \n + BufferedSink sink = Okio . buffer ( creator . newSink ( 0 ) ) ; \n + sink . writeUtf8 ( "" Hello "" ) ; \n + sink . close ( ) ; \n + \n + / / Simulate a filesystem failure on the first initialization . \n + fileSystem . setFaultyDelete ( new File ( cacheDir , "" k1 . 0 . tmp "" ) , true ) ; \n + fileSystem . setFaultyDelete ( cacheDir , true ) ; \n + \n + cache = new DiskLruCache ( fileSystem , cacheDir , appVersion , 2 , Integer . MAX _ VALUE , executor ) ; \n + toClose . add ( cache ) ; \n + \n + try { \n + cache . get ( "" k1 "" ) ; \n + fail ( ) ; \n + } catch ( Exception expected ) { \n + } \n + \n + / / Now let it operate normally . \n + fileSystem . setFaultyDelete ( new File ( cacheDir , "" k1 . 0 . tmp "" ) , false ) ; \n + fileSystem . setFaultyDelete ( cacheDir , false ) ; \n + \n + DiskLruCache . Snapshot snapshot = cache . get ( "" k1 "" ) ; \n + assertNull ( snapshot ) ; \n + } \n + \n okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ io \ FaultyFileSystem . java \n + if ( deleteFaults . contains ( directory ) ) throw new IOException ( "" boom ! "" ) ; \n",Added test for cache initialization failure and recovery . \n https : / / github . com / square / okhttp / issues / 3115,121
"okhttp - tests \ src \ test \ java \ okhttp3 \ internal \ cache \ DiskLruCacheTest . java \n - @ Test \n - @ Ignore \n - public void recoverFromInitializationFailure ( ) throws IOException { \n + @ Test public void recoverFromInitializationFailure ( ) throws IOException { \n - / / Simulate a filesystem failure on the first initialization . \n + / / Simulate a severe filesystem failure on the first initialization . \n - } catch ( Exception expected ) { \n + } catch ( IOException expected ) { \n okhttp \ src \ main \ java \ okhttp3 \ internal \ cache \ DiskLruCache . java \n + journalIsCorrupt . getMessage ( ) + "" , removing "" , journalIsCorrupt ) ; \n + } \n + \n + / / The cache is corrupted , attempt to delete the contents of the directory . This can throw and \n + / / we ' ll let that propagate out as it likely means there is a severe filesystem problem . \n + try { \n + } finally { \n",Recover from a severe cache initialization failure . \n Closes : https : / / github . com / square / okhttp / issues / 3115,121
"okhttp \ src \ main \ java \ okhttp3 \ internal \ publicsuffix \ PublicSuffixDatabase . java \n - * Returns null if the domain is a public suffix or the list was unable to be loaded . \n + * Returns null if the domain is a public suffix . \n - if ( rule = = null \n - | | ( domainLabels . length = = rule . length & & rule [ 0 ] . charAt ( 0 ) ! = EXCEPTION _ MARKER ) ) { \n - / / We failed to read the list or the domain is a public suffix . \n + if ( domainLabels . length = = rule . length & & rule [ 0 ] . charAt ( 0 ) ! = EXCEPTION _ MARKER ) { \n + / / The domain is a public suffix . \n - / / We failed to read the public suffix list . One scenario where this might happen is if the \n - / / thread is interrupted . \n - return null ; \n + throw new IllegalStateException ( "" Unable to load "" + PUBLIC _ SUFFIX _ RESOURCE + "" resource "" \n + + "" from the classpath . "" ) ; \n",Explode if the public suffix list cannot be loaded .,121
"okhttp - tests \ src \ test \ java \ okhttp3 \ ConnectionCoalescingTest . java \n + import java . util . concurrent . atomic . AtomicReference ; \n + / * * Test a previously coalesced connection that ' s no longer healthy . * / \n + @ Test public void staleCoalescedConnection ( ) throws Exception { \n + server . enqueue ( new MockResponse ( ) . setResponseCode ( 200 ) ) ; \n + server . enqueue ( new MockResponse ( ) . setResponseCode ( 200 ) ) ; \n + \n + final AtomicReference < Connection > connection = new AtomicReference < > ( ) ; \n + client = client . newBuilder ( ) \n + . addNetworkInterceptor ( new Interceptor ( ) { \n + @ Override public Response intercept ( Chain chain ) throws IOException { \n + connection . set ( chain . connection ( ) ) ; \n + return chain . proceed ( chain . request ( ) ) ; \n + } \n + } ) \n + . build ( ) ; \n + dns . set ( "" san . com "" , Dns . SYSTEM . lookup ( server . getHostName ( ) ) . subList ( 0 , 1 ) ) ; \n + \n + assert200Http2Response ( execute ( url ) , server . getHostName ( ) ) ; \n + \n + / / Simulate a stale connection in the pool . \n + connection . get ( ) . socket ( ) . close ( ) ; \n + \n + HttpUrl sanUrl = url . newBuilder ( ) . host ( "" san . com "" ) . build ( ) ; \n + assert200Http2Response ( execute ( sanUrl ) , "" san . com "" ) ; \n + \n + assertEquals ( 1 , client . connectionPool ( ) . connectionCount ( ) ) ; \n + } \n + \n + response . body ( ) . close ( ) ; \n okhttp \ src \ main \ java \ okhttp3 \ internal \ connection \ StreamAllocation . java \n - if ( connection ! = null ) return connection ; \n + if ( connection ! = null ) { \n + route = selectedRoute ; \n + return connection ; \n + } \n",Recover from a stale coalesced connection . \n https : / / github . com / square / okhttp / issues / 3308,121
"okhttp \ src \ test \ java \ okhttp3 \ internal \ http2 \ HttpOverHttp2Test . java \n - . around ( clientTestRule ) \n - . around ( new Timeout ( 5 , SECONDS ) ) ; \n + . around ( new Timeout ( 60 , SECONDS ) ) \n + . around ( clientTestRule ) ; \n",Prefer reporting a JUnit Timeout failure in HttpOverHttp2Test . ( # 5802 ),121
"okhttp \ src \ test \ java \ okhttp3 \ internal \ ws \ RealWebSocketTest . java \n + \n + client . listener . assertClosed ( 1000 , "" Hello ! "" ) ; \n + \n + server . processNextFrame ( ) ; \n + server . listener . assertClosing ( 1000 , "" Bye ! "" ) ; \n + server . listener . assertClosed ( 1000 , "" Bye ! "" ) ; \n",Fixed flaky RealWebSocketTest . serverCloseThenClientClose ( ) . ( # 5800 ) \n https : / / github . com / square / okhttp / issues / 5708,121
"okhttp \ src \ main \ java \ okhttp3 \ internal \ connection \ RealConnection . kt \n + val rawSocket = this . rawSocket ! ! \n - if ( socket . isClosed | | socket . isInputShutdown | | socket . isOutputShutdown ) { \n + if ( rawSocket . isClosed | | socket . isClosed | | socket . isInputShutdown | | \n + socket . isOutputShutdown ) { \n okhttp \ src \ test \ java \ okhttp3 \ CallTest . java \n + import static java . util . Collections . singletonList ; \n + / * * \n + * This test cancels the call just after the response body ends . In effect we end up with a \n + * connection that returns to the connection pool with the underlying socket closed . This relies \n + * on an implementation detail so it might not be a valid test case in the future . \n + * / \n + @ Test public void cancelAfterResponseBodyEnd ( ) throws Exception { \n + enableTls ( ) ; \n + server . enqueue ( new MockResponse ( ) . setBody ( "" abc "" ) ) ; \n + server . enqueue ( new MockResponse ( ) . setBody ( "" def "" ) ) ; \n + \n + client = client . newBuilder ( ) \n + . protocols ( singletonList ( Protocol . HTTP _ 1 _ 1 ) ) \n + . build ( ) ; \n + \n + OkHttpClient cancelClient = client . newBuilder ( ) \n + . eventListener ( new EventListener ( ) { \n + @ Override public void responseBodyEnd ( Call call , long byteCount ) { \n + call . cancel ( ) ; \n + } \n + } ) \n + . build ( ) ; \n + \n + Call call = cancelClient . newCall ( new Request . Builder ( ) \n + . url ( server . url ( "" / "" ) ) \n + . build ( ) ) ; \n + Response response = call . execute ( ) ; \n + assertThat ( response . body ( ) . string ( ) ) . isEqualTo ( "" abc "" ) ; \n + \n + executeSynchronously ( "" / "" ) . assertCode ( 200 ) ; \n + } \n + \n",Flag connection as unhealthy when underlying socket is closed . \n https : / / github . com / square / okhttp / issues / 5819,121
"okhttp \ src \ main \ java \ okhttp3 \ internal \ connection \ ExchangeFinder . kt \n - / / Confirm that the connection is good . If it isn ' t , take it out of the pool and start again . \n - if ( ! candidate . isHealthy ( doExtensiveHealthChecks ) ) { \n - candidate . noNewExchanges ( ) \n - continue \n + / / Confirm that the connection is good . \n + if ( candidate . isHealthy ( doExtensiveHealthChecks ) ) { \n + return candidate \n - return candidate \n + / / If it isn ' t , take it out of the pool . \n + candidate . noNewExchanges ( ) \n + \n + / / Make sure we have some routes left to try . One example where we may exhaust all the routes \n + / / would happen if we made a new connection and it immediately is detected as unhealthy . \n + synchronized ( connectionPool ) { \n + val routesLeft = routeSelection ? . hasNext ( ) ? : true \n + val routesSelectionLeft = routeSelector ? . hasNext ( ) ? : true \n + if ( nextRouteToTry = = null & & ! routesLeft & & ! routesSelectionLeft ) { \n + throw IOException ( "" exhausted all routes "" ) \n + } \n + } \n okhttp \ src \ test \ java \ okhttp3 \ CallTest . java \n + import okhttp3 . internal . Util ; \n + @ Test public void connectionIsImmediatelyUnhealthy ( ) throws Exception { \n + EventListener listener = new EventListener ( ) { \n + @ Override public void connectionAcquired ( Call call , Connection connection ) { \n + Util . closeQuietly ( connection . socket ( ) ) ; \n + } \n + } ; \n + \n + client = client . newBuilder ( ) \n + . eventListener ( listener ) \n + . build ( ) ; \n + \n + executeSynchronously ( "" / "" ) . assertFailure ( IOException . class ) ; \n + } \n + \n",Give up when ExchangeFinder exhausts all routes . \n https : / / github . com / square / okhttp / issues / 3308,121
"okhttp \ src \ main \ java \ okhttp3 \ internal \ connection \ ExchangeFinder . kt \n + if ( nextRouteToTry ! = null ) return @ synchronized \n + \n + if ( routesLeft ) return @ synchronized \n + \n - if ( nextRouteToTry = = null & & ! routesLeft & & ! routesSelectionLeft ) { \n - throw IOException ( "" exhausted all routes "" ) \n - } \n + if ( routesSelectionLeft ) return @ synchronized \n + \n + throw IOException ( "" exhausted all routes "" ) \n okhttp \ src \ test \ java \ okhttp3 \ CallTest . java \n - executeSynchronously ( "" / "" ) . assertFailure ( IOException . class ) ; \n + executeSynchronously ( "" / "" ) \n + . assertFailure ( IOException . class ) \n + . assertFailure ( "" exhausted all routes "" ) ; \n",Short circuit more aggressively when ExchangeFinder has routes .,121
"build . gradle \n - boolean bwc _ tests _ enabled = true \n - final String bwc _ tests _ disabled _ issue = "" "" / * place a PR link here when committing bwc changes * / \n + boolean bwc _ tests _ enabled = false \n + final String bwc _ tests _ disabled _ issue = "" https : / / github . com / elastic / elasticsearch / pull / 65759 "" / * place a PR link here when committing bwc changes * / \n",[ ML ] Disable BWC tests for Datafeed Config change ( # 65764 ) \n For # 65759,124
x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ xpack \ core \ ml \ datafeed \ DatafeedConfig . java \n - import org . elasticsearch . Version ; \n - if ( in . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n - runtimeMappings = in . readMap ( ) ; \n - } else { \n - runtimeMappings = Collections . emptyMap ( ) ; \n - } \n + runtimeMappings = in . readMap ( ) ; \n - if ( out . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n - out . writeMap ( runtimeMappings ) ; \n - } \n + out . writeMap ( runtimeMappings ) ; \n,[ ML ] Adjust DatafeedConfig serialisation version after backport ( # 66001 ) \n Related to # 65759,124
"x - pack \ plugin \ searchable - snapshots \ src \ test \ java \ org \ elasticsearch \ xpack \ searchablesnapshots \ cache \ CacheServiceTests . java \n + import org . apache . lucene . util . Constants ; \n + assumeFalse ( "" https : / / github . com / elastic / elasticsearch / issues / 65543 "" , Constants . WINDOWS ) ; \n","Mute CacheServiceTests . testCacheSynchronization ( # 65581 ) \n Windows only , for # 65543",124
"docs \ reference \ rollup \ apis \ rollup - api . asciidoc \n - - - - \n - / / TEST [ setup : my _ index ] \n + / / CONSOLE \n + / / TEST [ skip : "" AwaitsFix https : / / github . com / elastic / elasticsearch / issues / 65544 "" ] \n + \n",Mute rollup docs test ( # 65585 ) \n For # 65544,124
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryActionConditionTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65064 "" ) \n",mute HistoryActionConditionTests . testActionCondition ( # 65592 ),124
"server \ src \ test \ java \ org \ elasticsearch \ index \ engine \ SegmentsStatsTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65267 "" ) \n",Mute SegmentsStatsTests testFileExtensionDescriptions ( # 65615 ) \n For # 65267,124
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryActionConditionTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65064 "" ) \n",mute HistoryActionConditionTests . testActionCondition ( # 68650 ),124
"x - pack \ plugin \ ml \ build . gradle \n + testImplementation project ( ' : modules : ingest - common ' ) \n x - pack \ plugin \ ml \ src \ test \ java \ org \ elasticsearch \ xpack \ ml \ support \ BaseMlIntegTestCase . java \n + import org . elasticsearch . ingest . common . IngestCommonPlugin ; \n + IngestCommonPlugin . class , \n",[ ML ] Reduce log noise in BaseMlIntegTestCase ( # 65675 ) \n Tests inheriting ` BaseMlIntegTestCase ` have noisy \n logs with the error ` No processor type exists with name [ . . . ] ` . \n Those are caused because of loaded templates that need \n the ` IngestCommonPlugin ` loaded . \n This commit adds a test dependency to the ` ingest - common ` module \n and loads ` IngestCommonPlugin ` in ` BaseMlIntegTestCase ` to reduce \n such noise .,137
x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ xpack \ core \ ml \ action \ RevertModelSnapshotAction . java \n - if ( in . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n + if ( in . getVersion ( ) . onOrAfter ( Version . V _ 7 _ 11 _ 0 ) ) { \n - if ( out . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n + if ( out . getVersion ( ) . onOrAfter ( Version . V _ 7 _ 11 _ 0 ) ) { \n,[ ML ] Update serialization versions for revert snapshot force param ( # 65680 ),137
"x - pack \ plugin \ ml \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ MlDistributedFailureIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65710 "" ) \n",[ ML ] Mute failing MlDistributedFailureIT test ( # 65747 ) \n Relates # 64710,137
"x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ upgraded _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n - - - \n + - skip : \n + version : "" - 7 . 99 . 99 "" \n + reason : "" _ doc _ count field is currently implemented only in 8 . x "" \n - do : \n - - - \n + - skip : \n + version : "" - 7 . 99 . 99 "" \n + reason : "" _ doc _ count field is currently implemented only in 8 . x "" \n - do : \n",[ ML ] Further mutes on DFA upgrade tests ( # 64545 ) \n Because of # 64503 . This adds to # 64540 .,137
"x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ upgraded _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n + version : "" - 8 . 00 . 00 "" \n - do : \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n + version : "" - 8 . 00 . 00 "" \n - do : \n",[ ML ] Actually fix DFA mixed cluster tests ( # 64551 ) \n Relates # 64503 .,137
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RegressionIT . java \n - waitUntilAnalyticsIsStopped ( jobId ) ; \n + \n + / / This seems to some times take a bit longer than 30 seconds on CI \n + / / so we give it a minute . \n + waitUntilAnalyticsIsStopped ( jobId , TimeValue . timeValueMinutes ( 1 ) ) ; \n","[ ML ] Increase timeout for RegressionIT . testAliasFields job to run ( # 64866 ) \n I looked into the failures for this test as reported in # 63268 . \n Nothing seems odd . The tests failed because the job did not complete \n within the 30 seconds we provide . This seems to be happening on \n CI workers occasionally . As the test is useful , I think it is ok \n to increase the timeout a bit and see how it goes . \n Fixes # 63268",137
"x - pack \ plugin \ transform \ src \ main \ java \ org \ elasticsearch \ xpack \ transform \ utils \ ExceptionRootCauseFinder . java \n - SearchPhaseExecutionException searchPhaseException = ( SearchPhaseExecutionException ) t ; \n + SearchPhaseExecutionException searchPhaseException = ( SearchPhaseExecutionException ) unwrappedThrowable ; \n x - pack \ plugin \ transform \ src \ test \ java \ org \ elasticsearch \ xpack \ transform \ utils \ ExceptionRootCauseFinderTests . java \n + import org . elasticsearch . ElasticsearchException ; \n + import org . elasticsearch . action . search . SearchPhaseExecutionException ; \n + import org . elasticsearch . action . search . ShardSearchFailure ; \n + import org . elasticsearch . indices . IndexCreationException ; \n + import static org . hamcrest . Matchers . equalTo ; \n + \n + \n + public void testGetRootCauseException _ GivenWrappedSearchPhaseException ( ) { \n + SearchPhaseExecutionException searchPhaseExecutionException = new SearchPhaseExecutionException ( "" test - phase "" , \n + "" partial shards failure "" , new ShardSearchFailure [ ] { new ShardSearchFailure ( new ElasticsearchException ( "" for the cause ! "" ) ) } ) ; \n + \n + Throwable rootCauseException = ExceptionRootCauseFinder . getRootCauseException ( \n + new IndexCreationException ( "" test - index "" , searchPhaseExecutionException ) ) ; \n + \n + assertThat ( rootCauseException . getMessage ( ) , equalTo ( "" for the cause ! "" ) ) ; \n + } \n + \n + \n",[ Transform ] Fix casting in ExceptionRootCauseFinder ( # 66123 ) \n Method ` getRootCauseException ` is checking whether the unwrapped \n exception is an instance of ` SearchPhaseExecutionException ` but then \n proceeds to cast the parent exception . This would lead to a casting \n error . This commit fixes this and adds a unit test to guard it .,137
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ dataframe \ extractor \ DataFrameDataExtractor . java \n - return new Row ( extractedValues , hit , isTraining ) ; \n + Row row = new Row ( extractedValues , hit , isTraining ) ; \n + LOGGER . debug ( ( ) - > new ParameterizedMessage ( "" [ { } ] Extracted row : sort key = [ { } ] , is _ training = [ { } ] , values = { } "" , \n + context . jobId , row . getSortKey ( ) , isTraining , Arrays . toString ( row . values ) ) ) ; \n + return row ; \n",[ ML ] Add debug logging showing extracted rows for DFA jobs ( # 65007 ) \n This is helpful to debug discrepancies between different runs \n of the same job .,137
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ ClassificationIT . java \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - waitUntilAnalyticsIsStopped ( jobId , TimeValue . timeValueMinutes ( 1 ) ) ; \n + waitUntilAnalyticsIsStopped ( jobId ) ; \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 64926 "" ) \n x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ MlNativeDataFrameAnalyticsIntegTestCase . java \n - waitUntilAnalyticsIsStopped ( id , TimeValue . timeValueSeconds ( 30 ) ) ; \n + waitUntilAnalyticsIsStopped ( id , TimeValue . timeValueSeconds ( 60 ) ) ; \n x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RegressionIT . java \n - waitUntilAnalyticsIsStopped ( jobId , TimeValue . timeValueMinutes ( 1 ) ) ; \n + waitUntilAnalyticsIsStopped ( jobId ) ; \n - / / This seems to some times take a bit longer than 30 seconds on CI \n - / / so we give it a minute . \n - waitUntilAnalyticsIsStopped ( jobId , TimeValue . timeValueMinutes ( 1 ) ) ; \n + waitUntilAnalyticsIsStopped ( jobId ) ; \n",[ ML ] Increase timeout waiting for DFA jobs to finish in integ tests ( # 65126 ) \n It appears that occasionally 30 seconds are not enough for CI workers \n to complete DFA jobs . In order to eliminate such failures we increase \n the time we wait for DFA jobs to complete in integration tests to \n 60 seconds . \n Fixes # 64926,137
docs \ reference \ upgrade \ reindex _ upgrade . asciidoc \n - . . Create an index the appropriate mappings and settings . Set the \n + . . Create an index with the appropriate mappings and settings . Set the \n,"[ DOCS ] Add missing "" with "" in remote reindex doc ( # 65532 )",137
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ action \ TransportExplainDataFrameAnalyticsAction . java \n + import org . elasticsearch . common . unit . ByteSizeValue ; \n - / / Set the auth headers ( preferring the secondary headers ) to the caller ' s . \n + / / Set the auth headers ( preferring the secondary headers ) to the caller ' s . \n + if ( extractedFields . getAllFields ( ) . isEmpty ( ) ) { \n + listener . onResponse ( new MemoryEstimation ( ByteSizeValue . ZERO , ByteSizeValue . ZERO ) ) ; \n + return ; \n + } \n + \n x - pack \ plugin \ src \ test \ resources \ rest - api - spec \ test \ ml \ explain _ data _ frame _ analytics . yml \n - match : { field _ selection . 4 . is _ required : false } \n - match : { field _ selection . 4 . feature _ type : "" categorical "" } \n - is _ false : field _ selection . 4 . reason \n + \n + - - - \n + "" Test given no included field "" : \n + \n + - do : \n + indices . create : \n + index : index - source \n + body : \n + mappings : \n + properties : \n + x : \n + type : keyword \n + \n + - do : \n + index : \n + index : index - source \n + refresh : true \n + body : { x : "" hello ! "" } \n + - match : { result : "" created "" } \n + \n + - do : \n + ml . explain _ data _ frame _ analytics : \n + body : \n + source : { index : "" index - source "" } \n + analysis : { outlier _ detection : { } } \n + - match : \n + memory _ estimation . expected _ memory _ without _ disk : "" 0 "" \n + - match : \n + memory _ estimation . expected _ memory _ with _ disk : "" 0 "" \n + - length : { field _ selection : 1 } \n + - match : { field _ selection . 0 . name : "" x "" } \n + - match : { field _ selection . 0 . is _ included : false } \n","[ ML ] DFA _ explain API should not fail when none field is included ( # 66281 ) \n This commit fixes an issue with DFA _ explain API where if it is called \n and no field is included , it results to an error message coming from \n the c + + process due to the data frame having no columns . \n We want the _ explain API not to error when no fields are included \n exactly in order to explain to the user why it is that no fields \n are included . Thus , we can simply fix this by not running the \n memory estimation process and returning zero estimates instead . \n Note that the _ start API will fail with a user friendly error message \n that informs there are no included fields .",137
x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ xpack \ core \ ml \ job \ process \ autodetect \ state \ DataCounts . java \n - import org . elasticsearch . Version ; \n - if ( in . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n - logTime = in . readOptionalInstant ( ) ; \n - } else { \n - logTime = null ; \n - } \n + logTime = in . readOptionalInstant ( ) ; \n - if ( out . getVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) ) { \n - out . writeOptionalInstant ( logTime ) ; \n - } \n + out . writeOptionalInstant ( logTime ) ; \n,[ ML ] Adjust data counts log _ time serialization versions ( # 66437 ) \n After backporting # 66343,137
"client \ rest - high - level \ src \ test \ java \ org \ elasticsearch \ client \ security \ InvalidateApiKeyRequestTests . java \n - IntStream . range ( 1 , randomIntBetween ( 1 , 5 ) ) . mapToObj ( ignored - > randomAlphaOfLength ( 5 ) ) . collect ( Collectors . toList ( ) ) , \n + IntStream . range ( 1 , randomIntBetween ( 2 , 5 ) ) . mapToObj ( ignored - > randomAlphaOfLength ( 5 ) ) . collect ( Collectors . toList ( ) ) , \n",[ TEST ] Ensure ` InvalidateApiKeyRequest ` has at least one key in test ( # 66696 ) \n Fixes potential failure in ` InvalidateApiKeyRequestTests ` where \n a request is constructed with empty keys . \n Relates # 66317,137
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RegressionIT . java \n - . put ( "" logger . org . elasticsearch . xpack . ml . process . logging . CppLogMessageHandler "" , "" DEBUG "" ) ) \n + . put ( "" logger . org . elasticsearch . xpack . ml . process "" , "" DEBUG "" ) ) \n - . putNull ( "" logger . org . elasticsearch . xpack . ml . process . logging . CppLogMessageHandler "" ) ) \n + . putNull ( "" logger . org . elasticsearch . xpack . ml . process "" ) ) \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67581 "" ) \n",[ ML ] Unmute RegressionIT . testStopAndRestart with process logging ( # 68266 ) \n Relates # 67581,137
"docs \ reference \ ml \ df - analytics \ apis \ get - dfanalytics - stats . asciidoc \n - values : ` analyzing ` , ` failed ` , ` reindexing ` , ` started ` , ` starting ` , ` stopping ` , \n - ` stopped ` . \n + values : ` failed ` , ` started ` , ` starting ` , ` stopping ` , ` stopped ` . \n",[ ML ] Remove DFA job states reindexing and analyzing from docs ( # 67658 ) \n These states do no longer exist as of # 67423,137
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ dataframe \ steps \ FinalStep . java \n + import org . elasticsearch . action . admin . indices . refresh . RefreshAction ; \n + import org . elasticsearch . action . index . IndexAction ; \n - import org . elasticsearch . client . ParentTaskAssigningClient ; \n - import org . elasticsearch . common . util . concurrent . ThreadContext ; \n + import static org . elasticsearch . xpack . core . ClientHelper . executeAsyncWithOrigin ; \n - parentTaskClient ( ) . index ( indexRequest , listener ) ; \n + executeAsyncWithOrigin ( parentTaskClient ( ) , ML _ ORIGIN , IndexAction . INSTANCE , indexRequest , listener ) ; \n - ParentTaskAssigningClient parentTaskClient = parentTaskClient ( ) ; \n - try ( ThreadContext . StoredContext ignore = parentTaskClient . threadPool ( ) . getThreadContext ( ) . stashWithOrigin ( ML _ ORIGIN ) ) { \n - parentTaskClient . admin ( ) . indices ( ) . refresh ( refreshRequest , listener ) ; \n - } \n + executeAsyncWithOrigin ( parentTaskClient ( ) , ML _ ORIGIN , RefreshAction . INSTANCE , refreshRequest , listener ) ; \n","[ ML ] Persist data counts in DFA final step with ML origin ( # 67674 ) \n In # 67623 I moved persisting the data counts at the end of a \n data frame analytics job into a ` FinalStep ` class . However , \n I forgot to execute the index request with ML origin resulting \n in authentication problems if the user that runs the DFA job \n does not have read privileges in the ML stats index . \n This commit fixes this by executing that index request with ML \n origin .",137
"buildSrc \ src \ main \ java \ org \ elasticsearch \ gradle \ testclusters \ ElasticsearchNode . java \n - logToProcessStdout ( "" Installing "" + modules . size ( ) + "" modules "" ) ; \n + logToProcessStdout ( "" Installing "" + modules . size ( ) + "" modules "" ) ; \n","Add missing space in installing modules log message ( # 67593 ) \n Adds a missing space in the "" Installing x modules "" log \n message that appears on node startup .",137
"x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ mixed _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 67950 "" \n + \n - - - \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ old _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 67950 "" \n - do : \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ upgraded _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 67950 "" \n + \n - - - \n",[ ML ] Mute data frame analytics BWC tests ( # 67970 ) \n Until # 67937 and # 67950 are backported to 7 . x,137
"x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ xpack \ core \ ml \ job \ results \ ReservedFieldNames . java \n + BoostedTreeParams . ALPHA . getPreferredName ( ) , \n + BoostedTreeParams . DOWNSAMPLE _ FACTOR . getPreferredName ( ) , \n + BoostedTreeParams . ETA _ GROWTH _ RATE _ PER _ TREE . getPreferredName ( ) , \n + BoostedTreeParams . MAX _ OPTIMIZATION _ ROUNDS _ PER _ HYPERPARAMETER . getPreferredName ( ) , \n + BoostedTreeParams . SOFT _ TREE _ DEPTH _ LIMIT . getPreferredName ( ) , \n + BoostedTreeParams . SOFT _ TREE _ DEPTH _ TOLERANCE . getPreferredName ( ) , \n x - pack \ plugin \ core \ src \ main \ resources \ org \ elasticsearch \ xpack \ core \ ml \ config _ index _ mappings . json \n + "" alpha "" : { \n + "" type "" : "" double "" \n + } , \n + "" downsample _ factor "" : { \n + "" type "" : "" double "" \n + } , \n + "" eta _ growth _ rate _ per _ tree "" : { \n + "" type "" : "" double "" \n + } , \n + "" max _ optimization _ rounds _ per _ hyperparameter "" : { \n + "" type "" : "" integer "" \n + } , \n + "" soft _ tree _ depth _ limit "" : { \n + "" type "" : "" double "" \n + } , \n + "" soft _ tree _ depth _ tolerance "" : { \n + "" type "" : "" double "" \n + } , \n + "" alpha "" : { \n + "" type "" : "" double "" \n + } , \n + "" downsample _ factor "" : { \n + "" type "" : "" double "" \n + } , \n + "" eta _ growth _ rate _ per _ tree "" : { \n + "" type "" : "" double "" \n + } , \n + "" max _ optimization _ rounds _ per _ hyperparameter "" : { \n + "" type "" : "" integer "" \n + } , \n + "" soft _ tree _ depth _ limit "" : { \n + "" type "" : "" double "" \n + } , \n + "" soft _ tree _ depth _ tolerance "" : { \n + "" type "" : "" double "" \n + } , \n",[ ML ] Add new hyperparams to config index mappings ( # 68103 ) \n This is a follow - up PR adding mappings for the hyperparams \n that were added in # 67950,137
"x - pack \ plugin \ src \ test \ resources \ rest - api - spec \ test \ ml \ explain _ data _ frame _ analytics . yml \n - - - \n - - skip : \n - version : "" all "" \n - reason : "" Awaits fix : https : / / github . com / elastic / elasticsearch / issues / 68337 "" \n - do : \n",[ ML ] Unmute explain _ data _ frame _ analytics / Test field _ selection given body ( # 68348 ) \n The test was failing in the release tests as a new parameter was added \n in the c + + side and we had to build a non - snapshot artifact for the ml - cpp \n repo . This is now done so we can unmute the test . \n Fixes # 68337,137
"x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ mixed _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 69183 "" \n + \n - - - \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ old _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 69183 "" \n - do : \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ upgraded _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 69183 "" \n + \n - - - \n",[ ML ] Mute data frame analytics BWC tests ( # 69275 ) \n Until # 69183 is backported to 7 . x,137
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ dataframe \ DestinationIndex . java \n - Map < String , Object > runtimeMappings = getOrPutDefault ( mappingsAsMap , RUNTIME , HashMap : : new ) ; \n - runtimeMappings . putAll ( config . getSource ( ) . getRuntimeMappings ( ) ) ; \n + if ( config . getSource ( ) . getRuntimeMappings ( ) . isEmpty ( ) = = false ) { \n + Map < String , Object > runtimeMappings = getOrPutDefault ( mappingsAsMap , RUNTIME , HashMap : : new ) ; \n + runtimeMappings . putAll ( config . getSource ( ) . getRuntimeMappings ( ) ) ; \n + } \n + \n - addedMappings . put ( RUNTIME , config . getSource ( ) . getRuntimeMappings ( ) ) ; \n + if ( config . getSource ( ) . getRuntimeMappings ( ) . isEmpty ( ) = = false ) { \n + addedMappings . put ( RUNTIME , config . getSource ( ) . getRuntimeMappings ( ) ) ; \n + } \n","[ ML ] Do not add runtime section to DFA dest index mappings unnecessarily ( # 69329 ) \n Since config runtime mappings were added to data frame analytics jobs \n in # 69183 , when we create the destination index we add a ` runtime ` \n section in its mappings regardless of whether the job config contains \n any runtime fields . This causes failures in the BWC tests when in a \n mixed cluster where there are nodes versioned before runtime fields \n were introduced . \n This is the first part of the fix were we do not create a ` runtime ` section \n in the destination index mappings unless necessary .",137
"x - pack \ plugin \ searchable - snapshots \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ searchablesnapshots \ SearchableSnapshotsIntegTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 69336 "" ) \n",Mute testCreateAndRestoreSearchableSnapshot ( # 69337 ) \n . . . in SearchableSnapshotsIntegTests . \n Relates # 69336,137
"x - pack \ plugin \ ilm \ qa \ multi - node \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ilm \ TimeSeriesLifecycleActionsIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 69340 "" ) \n",Mute TimeSeriesLifecycleActionsIT . testAllocateOnlyAllocation ( # 69341 ) \n Relates # 69340,137
"x - pack \ plugin \ ilm \ qa \ multi - node \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ilm \ actions \ ShrinkActionIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 69325 "" ) \n",Mute ShrinkActionIT . testShrinkDuringSnapshot ( # 69342 ) \n Relates # 69325,137
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ action \ TransportStartDataFrameAnalyticsAction . java \n - import org . elasticsearch . action . search . SearchResponse ; \n - import org . elasticsearch . action . support . IndicesOptions ; \n - import org . elasticsearch . index . query . QueryBuilders ; \n - import org . elasticsearch . search . SearchHit ; \n - import org . elasticsearch . xpack . ml . dataframe . StoredProgress ; \n - import org . elasticsearch . xpack . ml . utils . persistence . MlParserUtils ; \n - startContext - > { \n - estimateMemoryUsageAndUpdateMemoryTracker ( startContext , memoryUsageHandledListener ) ; \n - } , \n + startContext - > estimateMemoryUsageAndUpdateMemoryTracker ( startContext , memoryUsageHandledListener ) , \n - private void searchProgressFromIndex ( String jobId , ActionListener < StoredProgress > listener ) { \n - SearchRequest searchRequest = new SearchRequest ( AnomalyDetectorsIndex . jobStateIndexPattern ( ) ) ; \n - searchRequest . indicesOptions ( IndicesOptions . lenientExpandOpen ( ) ) ; \n - searchRequest . source ( ) . size ( 1 ) ; \n - searchRequest . source ( ) . query ( QueryBuilders . idsQuery ( ) . addIds ( StoredProgress . documentId ( jobId ) ) ) ; \n - searchRequest . allowPartialSearchResults ( false ) ; \n - \n - ActionListener < SearchResponse > searchListener = ActionListener . wrap ( \n - searchResponse - > { \n - SearchHit [ ] hits = searchResponse . getHits ( ) . getHits ( ) ; \n - if ( hits . length = = 0 ) { \n - logger . debug ( ( ) - > new ParameterizedMessage ( "" [ { } ] No stored progress found "" , jobId ) ) ; \n - listener . onResponse ( null ) ; \n - } else { \n - StoredProgress storedProgress = MlParserUtils . parse ( hits [ 0 ] , StoredProgress . PARSER ) ; \n - logger . debug ( ( ) - > new ParameterizedMessage ( "" [ { } ] Found stored progress { } "" , jobId , storedProgress . get ( ) . get ( 0 ) ) ) ; \n - listener . onResponse ( storedProgress ) ; \n - } \n - } , \n - listener : : onFailure \n - ) ; \n - \n - executeAsyncWithOrigin ( client , ML _ ORIGIN , SearchAction . INSTANCE , searchRequest , searchListener ) ; \n - } \n - \n",[ ML ] Remove unused method in TransportStartDataFrameAnalyticsAction ( # 68409 ) \n Removes method ` searchStoredProgress ` which is now unused as we retrieve \n progress via a call in the _ stats API .,137
x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ job \ task \ OpenJobPersistentTasksExecutor . java \n + import org . elasticsearch . Version ; \n + / / Resuming a job with a running datafeed from its current snapshot was added in 7 . 11 and \n + / / can only be done if the master node is on or after that version . \n + private static final Version MIN _ MASTER _ NODE _ VERSION _ FOR _ REVERTING _ TO _ CURRENT _ SNAPSHOT = Version . V _ 7 _ 11 _ 0 ; \n + \n - if ( hasRunningDatafeed ) { \n + if ( hasRunningDatafeed & & clusterState . nodes ( ) . getMasterNode ( ) . getVersion ( ) . onOrAfter ( \n + MIN _ MASTER _ NODE _ VERSION _ FOR _ REVERTING _ TO _ CURRENT _ SNAPSHOT ) ) { \n + \n,"[ ML ] Only resume job from current snapshot if master node supports it ( # 66815 ) \n As resuming a job from its current snapshot requires functionality added \n to the _ revert API in version ` 7 . 11 ` , we need to ensure we do not do this \n unless the master node has been updated to a version that supports this \n feature . \n Closes # 66752",137
"x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ xpack \ core \ ml \ inference \ TrainedModelConfig . java \n - import org . elasticsearch . xpack . core . ml . inference . trainedmodel . metadata . TotalFeatureImportance ; \n + import org . elasticsearch . xpack . core . ml . inference . trainedmodel . metadata . TotalFeatureImportance ; \n - import java . util . HashSet ; \n - import java . util . Set ; \n - private static final Set < String > RESERVED _ METADATA _ FIELDS = new HashSet < > ( Arrays . asList ( \n - TOTAL _ FEATURE _ IMPORTANCE , \n - FEATURE _ IMPORTANCE _ BASELINE ) ) ; \n",[ ML ] Remove unused parse field from TrainedModelConfig ( # 68670 ),137
"server \ src \ test \ java \ org \ elasticsearch \ index \ engine \ ReadOnlyEngineTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67232 "" ) \n",[ TEST ] Mute ReadOnlyEngineTests . testForceMergeOnReadOnlyEngine ( # 67234 ) \n Relates # 67232,137
"data \ etc \ privapp - permissions - platform . xml \n + < ! - - Needed for test only - - > \n + < permission name = "" android . permission . NETWORK _ AIRPLANE _ MODE "" / > \n packages \ Shell \ AndroidManifest . xml \n + < ! - - Permission needed to read wifi network credentials for CtsNetTestCases - - > \n + < uses - permission android : name = "" android . permission . NETWORK _ AIRPLANE _ MODE "" / > \n + \n",Grant shell permissions for Airplane Mode to Shell to support CTS \n New permission is needed to allow CTS to trigger the new WiFi subsystem \n restart API . \n Bug : 175084231 \n Test : atest android . net . wifi . cts . WifiManagerTest # testRestartWifiSubsystem \n Change - Id : Id844fb799c61f65580e686d1da7ec38a62dd01d0,163
"core \ api \ system - current . txt \n + field public static final String RESTART _ WIFI _ SUBSYSTEM = "" android . permission . RESTART _ WIFI _ SUBSYSTEM "" ; \n core \ res \ AndroidManifest . xml \n + < ! - - Allows applications to restart the Wi - Fi subsystem . \n + @ SystemApi \n + < p > Not for use by third - party applications . @ hide - - > \n + < permission android : name = "" android . permission . RESTART _ WIFI _ SUBSYSTEM "" \n + android : protectionLevel = "" signature | setup "" / > \n + \n - - > \n",[ WIFI ] New permission to control restart of the WiFi subsystem \n Bug : 175084231 \n Bug : 178125790 \n Test : atest android . net . wifi . cts . WifiManagerTest # testRestartWifiSubsystem \n Change - Id : Iec9b579da912a105c46b2cb129bc625655124f52,163
"data \ etc \ privapp - permissions - platform . xml \n + < permission name = "" android . permission . RESTART _ WIFI _ SUBSYSTEM "" / > \n packages \ Shell \ AndroidManifest . xml \n + < ! - - Permission needed to restart WiFi Subsystem - - > \n + < uses - permission android : name = "" android . permission . RESTART _ WIFI _ SUBSYSTEM "" / > \n + \n",Grant shell permissions for restart WiFi subsystem to Shell to support CTS \n New permission is needed to allow CTS to trigger the new WiFi subsystem \n restart API . \n Bug : 175084231 \n Bug : 178125790 \n Test : atest android . net . wifi . cts . WifiManagerTest # testRestartWifiSubsystem \n Change - Id : I0eb0362e6421480c10ba64f923a9069d1258d4ca,163
"data \ etc \ privapp - permissions - platform . xml \n - < permission name = "" android . permission . NETWORK _ AIRPLANE _ MODE "" / > \n packages \ Shell \ AndroidManifest . xml \n - < ! - - Permission needed to read wifi network credentials for CtsNetTestCases - - > \n - < uses - permission android : name = "" android . permission . NETWORK _ AIRPLANE _ MODE "" / > \n - \n","Revert "" Grant shell permissions for Airplane Mode to Shell to support CTS "" \n This reverts commit ddb4902597df7beb978a20a2299b784e2d9c5c6f . \n Change - Id : I7d5433bf676661ede208f840c27a71abbe663195",163
"core \ res \ AndroidManifest . xml \n - android : protectionLevel = "" signature | setup "" / > \n + android : protectionLevel = "" signature | privileged "" / > \n",[ WIFI ] Fix typo in permission type for RESTART _ WIFI _ SUBSYSTEM \n Bug : 175084231 \n Bug : 178125790 \n Test : atest android . net . wifi . cts . WifiManagerTest # testRestartWifiSubsystem \n Test : atest android . permission2 . cts . PermissionPolicyTest # platformPermissionPolicyIsUnaltered \n Change - Id : Icb5db0a347c4714398fd4cbaef86bad2fd896358,163
new file \n packages \ SettingsLib \ src \ com \ android \ settingslib \ connectivity \ OWNERS \n + # Default reviewers for this and subdirectories . \n + andychou @ google . com \n + arcwang @ google . com \n + goldmanj @ google . com \n + qal @ google . com \n + wengsu @ google . com \n + \n + # Emergency approvers in case the above are not available \n,New OWNERS file for a new sub - directory \n This sub - directory is not targeting the SysUI as such but is ( currently ) \n targeting the Settings app . Hence moving OWNERShip to the Settings team . \n Bug : 175084231 \n Test : N / A \n Change - Id : I52a21a4a5b42d32774a4d74792529280c5a15610,163
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipeline . java \n - / * * \n - * @ deprecated Use { @ link # getDataSourceSupplier ( ImageRequest , Object , ImageRequest . RequestLevel ) } \n - * instead . \n - * / \n - @ Deprecated \n - public Supplier < DataSource < CloseableReference < CloseableImage > > > getDataSourceSupplier ( \n - final ImageRequest imageRequest , \n - final Object callerContext , \n - final boolean bitmapCacheOnly ) { \n - ImageRequest . RequestLevel requestLevel = bitmapCacheOnly ? \n - ImageRequest . RequestLevel . BITMAP _ MEMORY _ CACHE : \n - ImageRequest . RequestLevel . FULL _ FETCH ; \n - return getDataSourceSupplier ( \n - imageRequest , \n - callerContext , \n - requestLevel ) ; \n - } \n - \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineTest . java \n - mImagePipeline . getDataSourceSupplier ( mImageRequest , mCallerContext , true ) ; \n + mImagePipeline . getDataSourceSupplier ( \n + mImageRequest , \n + mCallerContext , \n + ImageRequest . RequestLevel . BITMAP _ MEMORY _ CACHE ) ; \n - Supplier < DataSource < CloseableReference < CloseableImage > > > dataSourceSupplier = \n - mImagePipeline . getDataSourceSupplier ( mImageRequest , mCallerContext , false ) ; \n + Supplier < DataSource < CloseableReference < CloseableImage > > > dataSourceSupplier = mImagePipeline \n + . getDataSourceSupplier ( mImageRequest , mCallerContext , ImageRequest . RequestLevel . FULL _ FETCH ) ; \n",Remove deprecated version of ImagePipeline # getDataSourceSupplier \n Reviewed By : erikandre \n Differential Revision : D5407007 \n fbshipit - source - id : d51723055d72754320f13e8d75ccea478150db5a,164
"docs \ Gemfile \n - gem ' github - pages ' , ' ~ > 104 ' , group : : jekyll _ plugins \n + gem ' github - pages ' , ' ~ > 145 ' , group : : jekyll _ plugins \n docs \ _ layouts \ redirect . html \n - < meta http - equiv = "" refresh "" content = "" 0 ; { { page . destination } } "" > \n + < meta http - equiv = "" refresh "" content = "" 0 ; { { page . redirect . to } } "" > \n","fix redirect loop \n Summary : \n Redirects are broken ( e . g . http : / / frescolib . org / docs / using - drawees - xml . html ) , we should fix this . \n Update ` github - pages ` gem to latest version , this triggers the repro locally . Update redirect template to use correct variables - > repro goes away . \n Closes https : / / github . com / facebook / fresco / pull / 1832 \n Differential Revision : D5457438 \n Pulled By : erikandre \n fbshipit - source - id : 108328a75c5518b7509bc1133e4c374277a5de60",164
gradle . properties \n - BUILD _ TOOLS _ VERSION = 25 . 0 . 2 \n - COMPILE _ SDK _ VERSION = 25 \n - ANDROID _ GRADLE _ PLUGIN _ VERSION = 2 . 3 . 0 \n + BUILD _ TOOLS _ VERSION = 26 . 0 . 0 \n + COMPILE _ SDK _ VERSION = 26 \n + ANDROID _ GRADLE _ PLUGIN _ VERSION = 2 . 3 . 3 \n,"update build tools , gradle plugin and compile sdk \n Reviewed By : oprisnik \n Differential Revision : D5388739 \n fbshipit - source - id : fbdb809516c90dfb32867292b60aa7c810fd13ea",164
"circle . yml \n - - if [ ! - d "" / usr / local / android - sdk - linux / platforms / android - 25 "" ] ; then echo y | android update sdk - - no - ui - - all - - filter "" android - 25 "" ; fi \n - - if [ ! - d "" / usr / local / android - sdk - linux / build - tools / 25 . 0 . 2 "" ] ; then echo y | android update sdk - - no - ui - - all - - filter "" build - tools - 25 . 0 . 2 "" ; fi \n + - if [ ! - d "" / usr / local / android - sdk - linux / platforms / android - 26 "" ] ; then echo y | android update sdk - - no - ui - - all - - filter "" android - 26 "" ; fi \n + - if [ ! - d "" / usr / local / android - sdk - linux / build - tools / 26 . 0 . 0 "" ] ; then echo y | android update sdk - - no - ui - - all - - filter "" build - tools - 26 . 0 . 0 "" ; fi \n - if [ ! - d "" / usr / local / android _ sdk / extras / android / m2repository / com / android / support / support - core - utils / 25 . 1 . 0 "" ] ; then echo y | android update sdk - - no - ui - - all - - filter "" extra - android - m2repository "" ; fi \n",Attempt to fix CircleCI build \n Summary : \n Doing this as a PR to get quick CircleCI feedback . \n Closes https : / / github . com / facebook / fresco / pull / 1820 \n Differential Revision : D5388866 \n Pulled By : erikandre \n fbshipit - source - id : e3c49b34cf4225f2f03827be4bb7fc2dc94e3ca4,164
"gradle . properties \n + org . gradle . jvmargs = - Xmx3072m \n - TARGET _ SDK _ VERSION = 25 \n + TARGET _ SDK _ VERSION = 26 \n samples \ showcase \ build . gradle \n + dexOptions { \n + maxProcessCount 2 \n + javaMaxHeapSize "" 2g "" \n + } \n + \n + productFlavors { \n + instantRunConfig { \n + minSdkVersion 21 \n + } \n + } \n",apply some instant run optimizations \n Summary : Apply recommendations from here : https : / / www . youtube . com / watch ? v = StqAZ1OQbqA \n Reviewed By : kirwan \n Differential Revision : D5388994 \n fbshipit - source - id : 08749884c7f3332fed2ac138109e530ce38a5a5a,164
"gradle . properties \n - org . gradle . jvmargs = - Xmx3072m \n + org . gradle . jvmargs = - Xmx2048m \n samples \ showcase \ build . gradle \n - javaMaxHeapSize "" 2g "" \n + javaMaxHeapSize "" 1g "" \n",Fix CircleCI build again \n Summary : Closes https : / / github . com / facebook / fresco / pull / 1821 \n Differential Revision : D5390911 \n Pulled By : lambdapioneer \n fbshipit - source - id : 5fe2407859bac1613cd2ad1bff598005f8aeaf2b,164
docs \ _ docs \ 00 - index . md \n - Download the [ zip file ] ( https : / / github . com / facebook / fresco / releases / download / v { { site . current _ version } } / frescolib - v { { site . current _ version } } . zip ) . \n + Download the [ zip file ] ( https : / / github . com / facebook / fresco / archive / v { { site . current _ version } } . zip ) . \n,Fix zip download URL \n Reviewed By : oprisnik \n Differential Revision : D5048391 \n fbshipit - source - id : c59d096f758a20a91b7a0a20a8f55d573b9c8083,164
"fbcore \ src \ test \ java \ com \ facebook \ common \ util \ UriUtilTest . java \n + import java . util . Collection ; \n - import org . junit . runners . Parameterized ; \n - import org . junit . runners . Parameterized . Parameters ; \n + import org . robolectric . ParameterizedRobolectricTestRunner ; \n + import org . robolectric . ParameterizedRobolectricTestRunner . Parameters ; \n - @ RunWith ( Parameterized . class ) \n + @ RunWith ( ParameterizedRobolectricTestRunner . class ) \n - public static Iterable < ? extends Object > data ( ) { \n - return Arrays . asList ( "" http "" , "" https "" , "" ftp "" , "" file "" ) ; \n + public static Collection < Object [ ] > data ( ) { \n + return Arrays . asList ( \n + new Object [ ] { "" http "" } , new Object [ ] { "" https "" } , new Object [ ] { "" ftp "" } , new Object [ ] { "" file "" } ) ; \n",fix oss build \n Reviewed By : kirwan \n Differential Revision : D6361939 \n fbshipit - source - id : 7eabc172666e448bb702a2178e7f159b86fda9d3,164
"fbcore \ src \ main \ java \ com \ facebook \ common \ util \ UriUtil . java \n - / * * \n - * URI prefix ( including scheme ) for contact photos \n - * / \n - private static final String LOCAL _ CONTACT _ IMAGE _ PREFIX = \n - Uri . withAppendedPath ( ContactsContract . AUTHORITY _ URI , "" display _ photo "" ) . getPath ( ) ; \n + / * * URI prefix ( including scheme ) for contact photos * / \n + private static final Uri LOCAL _ CONTACT _ IMAGE _ URI = \n + Uri . withAppendedPath ( ContactsContract . AUTHORITY _ URI , "" display _ photo "" ) ; \n - & & ! uri . getPath ( ) . startsWith ( LOCAL _ CONTACT _ IMAGE _ PREFIX ) ; \n + & & ! uri . getPath ( ) . startsWith ( LOCAL _ CONTACT _ IMAGE _ URI . getPath ( ) ) ; \n",fix oss build + + \n Reviewed By : dmitry - voronkevich \n Differential Revision : D6373794 \n fbshipit - source - id : 166049ea60b73cbe8268bde06a8ddb35422848d3,164
"animated - drawable \ build . gradle \n + testOptions { \n + unitTests . returnDefaultValues = true \n + } \n + testCompile "" org . powermock : powermock - module - junit4 : $ { POWERMOCK _ VERSION } "" \n animated - drawable \ src \ test \ java \ com \ facebook \ fresco \ animation \ bitmap \ cache \ FrescoFrameCacheTest . java \n + import org . powermock . core . classloader . annotations . PrepareForTest ; \n + @ PrepareForTest ( CloseableReference . class ) \n animated - drawable \ src \ test \ java \ com \ facebook \ fresco \ animation \ bitmap \ preparation \ DefaultBitmapFramePreparerTest . java \n + import org . powermock . core . classloader . annotations . PrepareForTest ; \n + @ PrepareForTest ( CloseableReference . class ) \n","Fix OSS tests \n Summary : There was one powermock dependency missing from ` animated - drawable ` , plus I had to add ` PrepareForTest ( CloseableReference . class ) ` so that we can mock final classes . The other ` build . gradle ` change ( adding ` returnDefaultValues = true ` ) was to get ` SparseArray ` working for ` DefaultBitmapFramePreparerTest ` . \n Reviewed By : oprisnik \n Differential Revision : D5052792 \n fbshipit - source - id : 147f53185f554d8655e7813ebf9d2ae1da480b21",164
gradle . properties \n - VERSION _ NAME = 1 . 6 . 0 \n + VERSION _ NAME = 1 . 7 . 0 \n,bump oss version \n Reviewed By : oprisnik \n Differential Revision : D6579267 \n fbshipit - source - id : bbc51267aacd37851a019673f99689b9c085058b,164
README . md \n - compile ' com . facebook . fresco : fresco : 1 . 5 . 0 ' \n + compile ' com . facebook . fresco : fresco : 1 . 7 . 0 ' \n docs \ _ config . yml \n - current _ version : 1 . 5 . 0 \n + current _ version : 1 . 7 . 0 \n,update version in README . md and docs / _ config . yml \n Reviewed By : oprisnik \n Differential Revision : D6579348 \n fbshipit - source - id : e93549721a7b299913775f745fd8109f5388e222,164
gradle . properties \n - VERSION _ NAME = 1 . 7 . 0 \n + VERSION _ NAME = 1 . 7 . 1 \n,bump version to 1 . 7 . 1 \n Reviewed By : cuva \n Differential Revision : D6601225 \n fbshipit - source - id : f2e05c54109c9055a9d6d2d1d45140e4afe3e047,164
README . md \n - compile ' com . facebook . fresco : fresco : 1 . 7 . 0 ' \n + compile ' com . facebook . fresco : fresco : 1 . 7 . 1 ' \n docs \ _ config . yml \n - current _ version : 1 . 7 . 0 \n + current _ version : 1 . 7 . 1 \n,update version to 1 . 7 . 1 in README . md and docs / _ config . yml \n Reviewed By : oprisnik \n Differential Revision : D6601229 \n fbshipit - source - id : 4d7ed533f6ec5a8eb278c7350fb39d2cf99c4c79,164
"docs \ javadoc \ reference \ com \ facebook \ common \ media \ MediaUtils . html \n + static \n + \n + boolean \n + < / td > \n + < td class = "" jd - linkcol "" width = "" 100 % "" > \n + < span class = "" sympad "" > < a href = "" . . / . . / . . / . . / com / facebook / common / media / MediaUtils . html # isThreeD ( java . lang . String ) "" > isThreeD < / a > < / span > ( String mimeType ) \n + \n + < / td > < / tr > \n + \n + \n + \n + < tr class = "" alt - color api apilevel - "" > \n + < td class = "" jd - typecol "" > \n + \n + \n + \n + < a id = "" isThreeD ( java . lang . String ) "" > < / a > \n + \n + < div class = "" jd - details api apilevel - "" > \n + < h4 class = "" jd - details - title "" > \n + < span class = "" normal "" > \n + public \n + static \n + \n + \n + \n + boolean \n + < / span > \n + < span class = "" sympad "" > isThreeD < / span > \n + < span class = "" normal "" > ( String mimeType ) < / span > \n + < / h4 > \n + < div class = "" api - level "" > \n + < div > \n + \n + < / div > \n + \n + \n + \n + < / div > \n + < div class = "" jd - details - descr "" > \n + \n + < div class = "" jd - tagdata jd - tagdescr "" > < p > < / p > < / div > \n + \n + < / div > \n + < / div > \n + \n + \n docs \ javadoc \ reference \ current . xml \n + < method name = "" isThreeD "" \n + return = "" boolean "" \n + abstract = "" false "" \n + native = "" false "" \n + synchronized = "" false "" \n + static = "" true "" \n + final = "" false "" \n + deprecated = "" not deprecated "" \n + visibility = "" public "" \n + > \n + < parameter name = "" mimeType "" type = "" java . lang . String "" > \n + < / parameter > \n + < / method > \n","update javadoc to 1 . 7 . 1 \n Reviewed By : erikandre , oprisnik \n Differential Revision : D6601557 \n fbshipit - source - id : c2c6f3ba6e808a432468125b50b40baa9b3c9a29",164
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ datasource \ AbstractProducerToDataSourceAdapter . java \n + import com . facebook . imagepipeline . request . DataSourceWithImageRequest ; \n + import com . facebook . imagepipeline . request . ImageRequest ; \n - public abstract class AbstractProducerToDataSourceAdapter < T > extends AbstractDataSource < T > { \n + public abstract class AbstractProducerToDataSourceAdapter < T > extends AbstractDataSource < T > \n + implements DataSourceWithImageRequest < T > { \n + @ Override \n + public ImageRequest getImageRequest ( ) { \n + return mSettableProducerContext . getImageRequest ( ) ; \n + } \n + \n new file \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ DataSourceWithImageRequest . java \n + / * \n + * Copyright ( c ) 2017 - present , Facebook , Inc . \n + * All rights reserved . \n + * \n + * This source code is licensed under the BSD - style license found in the \n + * LICENSE file in the root directory of this source tree . An additional grant \n + * of patent rights can be found in the PATENTS file in the same directory . \n + * / \n + package com . facebook . imagepipeline . request ; \n + \n + import com . facebook . datasource . DataSource ; \n + \n + public interface DataSourceWithImageRequest < T > extends DataSource < T > { \n + \n + ImageRequest getImageRequest ( ) ; \n + } \n",extend fresco info in layout plugin \n Reviewed By : emilsjolander \n Differential Revision : D6683186 \n fbshipit - source - id : af27b9f03fdafaa5a7f2046e4e5640d7d9511bd5,164
drawee - backends \ drawee - volley \ src \ main \ java \ com \ facebook \ drawee \ backends \ volley \ VolleyDraweeController . java \n + import com . facebook . drawee . interfaces . DraweeController ; \n + \n + @ Override \n + public boolean isSameImageRequest ( DraweeController other ) { \n + return false ; \n + } \n,Implement isSameImageRequest in VolleyDraweeController \n Reviewed By : erikandre \n Differential Revision : D7488970 \n fbshipit - source - id : 0b8e907499dd7b219a23682f2397ac65a3d294f3,164
"drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ PipelineDraweeController . java \n + import com . facebook . drawee . interfaces . DraweeController ; \n + @ Override \n + public boolean isSameImageRequest ( @ Nullable DraweeController other ) { \n + if ( other instanceof PipelineDraweeController ) { \n + return Objects . equal ( mCacheKey , ( ( PipelineDraweeController ) other ) . getCacheKey ( ) ) ; \n + } \n + return false ; \n + } \n + \n drawee \ src \ main \ java \ com \ facebook \ drawee \ interfaces \ DraweeController . java \n + \n + / * * Returns whether { @ code other } would fetch the same image as { @ code this } . * / \n + boolean isSameImageRequest ( DraweeController other ) ; \n drawee \ src \ test \ java \ com \ facebook \ drawee \ controller \ AbstractDraweeControllerTest . java \n + import com . facebook . drawee . interfaces . DraweeController ; \n + \n + @ Override \n + public boolean isSameImageRequest ( DraweeController other ) { \n + return false ; \n + } \n",base controller equality check on cachekey \n Reviewed By : erikandre \n Differential Revision : D7428583 \n fbshipit - source - id : bcd80397ae34e72fb3a3cfdd4502179be812e8bc,164
drawee - backends \ drawee - pipeline \ src \ main \ java \ com \ facebook \ drawee \ backends \ pipeline \ PipelineDraweeController . java \n - if ( other instanceof PipelineDraweeController ) { \n + if ( mCacheKey ! = null & & other instanceof PipelineDraweeController ) { \n,fix isSameImageRequest when cacheKey is null \n Differential Revision : D8144667 \n fbshipit - source - id : 37bb2efb2ea7eeabdea784bffb3468ab4bcb7022,164
imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ datasource \ AbstractProducerToDataSourceAdapter . java \n - import com . facebook . imagepipeline . request . DataSourceWithImageRequest ; \n + import com . facebook . imagepipeline . request . HasImageRequest ; \n - implements DataSourceWithImageRequest < T > { \n + implements HasImageRequest { \n rename from imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ DataSourceWithImageRequest . java \n rename to imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ request \ HasImageRequest . java \n - import com . facebook . datasource . DataSource ; \n + import javax . annotation . Nullable ; \n - public interface DataSourceWithImageRequest < T > extends DataSource < T > { \n + public interface HasImageRequest { \n + @ Nullable \n,Rename DataSourceWithImageRequest interface to HasImageRequest and generify \n Reviewed By : oprisnik \n Differential Revision : D7218114 \n fbshipit - source - id : f9b173460be4754c4d8199d2fe3a3fe8922cc457,164
fbcore \ src \ main \ java \ com \ facebook \ common \ statfs \ StatFsHelper . java \n + public boolean isLowSpaceCondition ( ) { \n + return getAvailableStorageSpace ( StatFsHelper . StorageType . INTERNAL ) \n + < DEFAULT _ DISK _ YELLOW _ LEVEL _ IN _ BYTES ; \n + } \n + \n,FBEvictionPluginController \n Differential Revision : D17977495 \n fbshipit - source - id : 243ded757b1f2b37637e1cfabeb88b78d1c153fa,164
fbcore \ src \ main \ java \ com \ facebook \ common \ statfs \ StatFsHelper . java \n + public static final int DEFAULT _ DISK _ RED _ LEVEL _ IN _ MB = 100 ; \n + \n + public static final long DEFAULT _ DISK _ RED _ LEVEL _ IN _ BYTES = \n + DEFAULT _ DISK _ RED _ LEVEL _ IN _ MB * 1024 * 1024 ; \n + \n + public boolean isVeryLowSpaceCondition ( ) { \n + return getAvailableStorageSpace ( StatFsHelper . StorageType . INTERNAL ) \n + < DEFAULT _ DISK _ RED _ LEVEL _ IN _ BYTES ; \n + } \n + \n,add support for / very / low space situations \n Differential Revision : D18085342 \n fbshipit - source - id : f0a20cc1356ac074756fa0165f4c9a92e87ac3c0,164
fbcore \ src \ main \ java \ com \ facebook \ common \ statfs \ StatFsHelper . java \n + public static final long DEFAULT _ DISK _ OLIVE _ LEVEL _ IN _ BYTES = 1000 * 1024 * 1024 ; \n + \n + public boolean isHighSpaceCondition ( ) { \n + return getAvailableStorageSpace ( StatFsHelper . StorageType . INTERNAL ) \n + > DEFAULT _ DISK _ OLIVE _ LEVEL _ IN _ BYTES ; \n + } \n + \n,add StatFsHelper # isHighSpaceCondition \n Differential Revision : D20558733 \n fbshipit - source - id : e228e182e54ba05ad96ccce029e85d9ff7c0f27a,164
"imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineExperiments . java \n + import com . facebook . common . memory . PooledByteStreams ; \n + private final boolean mUseCombinedNetworkAndCacheProducer ; \n + mUseCombinedNetworkAndCacheProducer = builder . mUseCombinedNetworkAndCacheProducer ; \n + public boolean shouldUseCombinedNetworkAndCacheProducer ( ) { \n + return mUseCombinedNetworkAndCacheProducer ; \n + } \n + \n + private boolean mUseCombinedNetworkAndCacheProducer = false ; \n + public ImagePipelineConfig . Builder setUseCombinedNetworkAndCacheProducer ( \n + boolean useCombinedNetworkAndCacheProducer ) { \n + mUseCombinedNetworkAndCacheProducer = useCombinedNetworkAndCacheProducer ; \n + return mConfigBuilder ; \n + } \n + \n + PooledByteStreams pooledByteStreams , \n + PooledByteStreams pooledByteStreams , \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ImagePipelineFactory . java \n + mConfig . getPoolFactory ( ) . getPooledByteStreams ( ) , \n - mConfig . getExperiments ( ) . isDiskCacheProbingEnabled ( ) ) ; \n + mConfig . getExperiments ( ) . isDiskCacheProbingEnabled ( ) , \n + mConfig . getExperiments ( ) . shouldUseCombinedNetworkAndCacheProducer ( ) ) ; \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerFactory . java \n + import androidx . annotation . Nullable ; \n + \n + public @ Nullable Producer < EncodedImage > newCombinedNetworkAndCacheProducer ( \n + final NetworkFetcher networkFetcher ) { \n + return null ; \n + } \n imagepipeline \ src \ main \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactory . java \n + private final boolean mUseCombinedNetworkAndCacheProducer ; \n - boolean isDiskCacheProbingEnabled ) { \n + boolean isDiskCacheProbingEnabled , \n + boolean useCombinedNetworkAndCacheProducer ) { \n + mUseCombinedNetworkAndCacheProducer = useCombinedNetworkAndCacheProducer ; \n - / * * multiplex - > encoded cache - > disk cache - > ( webp transcode ) - > network fetch . * / \n + / * * \n + * multiplex - > encoded cache - > disk cache - > ( webp transcode ) - > network fetch . Alternatively , \n + * multiplex - > combined network and cache \n + * / \n - newEncodedCacheMultiplexToTranscodeSequence ( \n - mProducerFactory . newNetworkFetchProducer ( mNetworkFetcher ) ) ; \n + mUseCombinedNetworkAndCacheProducer \n + ? mProducerFactory . newCombinedNetworkAndCacheProducer ( mNetworkFetcher ) \n + : newEncodedCacheMultiplexToTranscodeSequence ( \n + mProducerFactory . newNetworkFetchProducer ( mNetworkFetcher ) ) ; \n imagepipeline \ src \ test \ java \ com \ facebook \ imagepipeline \ core \ ProducerSequenceFactoryTest . java \n + false , \n + false , \n","add support for a combined network , disk and encoded cache producer \n Reviewed By : defHLT \n Differential Revision : D24051233 \n fbshipit - source - id : fb1d3aed84293c1bb453fe592ce1cc3ce8d92b7e",164
src \ main \ java \ rx \ internal \ operators \ OnSubscribeFromIterable . java \n - o . onCompleted ( ) ; \n + if ( ! o . isUnsubscribed ( ) ) { \n + o . onCompleted ( ) ; \n + } \n src \ main \ java \ rx \ internal \ operators \ OperatorMerge . java \n - request ( 1 ) ; \n + if ( ! isUnsubscribed ( ) ) \n + request ( 1 ) ; \n,Remove extraneous request ( n ) and onCompleted ( ) calls when unsubscribed .,178
"CONTRIBUTING . md \n - * Copyright 2013 Netflix , Inc . \n + * Copyright 2014 Netflix , Inc . \n",Update CONTRIBUTING . md \n updating the date .,178
"rxjava - core \ src \ main \ java \ rx \ Observable . java \n - public final Observable < T > retryWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? extends Notification < ? > > > notificationHandler , Scheduler scheduler ) { \n + public final Observable < T > retryWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? > > notificationHandler , Scheduler scheduler ) { \n",Make retryWhen the same with the Scheduler as the retryWhen without the Scheduler .,178
"rxjava - core \ src \ main \ java \ rx \ Observable . java \n - public final Observable < T > repeatWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? extends Notification < ? > > > notificationHandler , Scheduler scheduler ) { \n + public final Observable < T > repeatWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? > > notificationHandler , Scheduler scheduler ) { \n - public final Observable < T > repeatWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? extends Notification < ? > > > notificationHandler ) { \n + public final Observable < T > repeatWhen ( Func1 < ? super Observable < ? extends Notification < ? > > , ? extends Observable < ? > > notificationHandler ) { \n",removed the unnecessary ` extends Notification < ? > ` from repeatWhen too .,178
"build . gradle \n + javadoc { \n + exclude "" * * / rx / internal / * * "" \n + } \n + \n deleted file \n src \ main \ java \ rx \ plugins \ RxJavaErrorHandlerDefault . java \n - / * * \n - * Copyright 2014 Netflix , Inc . \n - * \n - * Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n - * you may not use this file except in compliance with the License . \n - * You may obtain a copy of the License at \n - * \n - * http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n - * \n - * Unless required by applicable law or agreed to in writing , software \n - * distributed under the License is distributed on an "" AS IS "" BASIS , \n - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n - * See the License for the specific language governing permissions and \n - * limitations under the License . \n - * / \n - package rx . plugins ; \n - \n - / * * \n - * Default implementation of { @ link RxJavaErrorHandler } that does nothing . \n - * \n - * @ ExcludeFromJavadoc \n - * / \n - public class RxJavaErrorHandlerDefault extends RxJavaErrorHandler { \n - \n - private static RxJavaErrorHandlerDefault INSTANCE = new RxJavaErrorHandlerDefault ( ) ; \n - \n - public static RxJavaErrorHandler getInstance ( ) { \n - return INSTANCE ; \n - } \n - \n - } \n src \ main \ java \ rx \ plugins \ RxJavaPlugins . java \n + static final RxJavaErrorHandler DEFAULT _ ERROR _ HANDLER = new RxJavaErrorHandler ( ) { \n + } ; \n + \n - errorHandler . compareAndSet ( null , RxJavaErrorHandlerDefault . getInstance ( ) ) ; \n + errorHandler . compareAndSet ( null , DEFAULT _ ERROR _ HANDLER ) ; \n src \ test \ java \ rx \ plugins \ RxJavaPluginsTest . java \n + import static org . junit . Assert . assertSame ; \n - assertTrue ( impl instanceof RxJavaErrorHandlerDefault ) ; \n + assertSame ( RxJavaPlugins . DEFAULT _ ERROR _ HANDLER , impl ) ; \n",exclude rx . internal . \n exclude RxJavaErrorHandlerDefault by deleting it .,178
"src \ main \ java \ rx \ internal \ operators \ OperatorSubscribeOn . java \n - inner . schedule ( new Action0 ( ) { \n + subscriber . add ( inner . schedule ( new Action0 ( ) { \n - } ) ; \n + } ) ) ; \n src \ test \ java \ rx \ internal \ operators \ OperatorReplayTest . java \n + verify ( mockSubscription , times ( 1 ) ) . unsubscribe ( ) ; \n + verify ( mockSubscription , times ( 1 ) ) . unsubscribe ( ) ; \n",subscribeOn drops the subscriptions returned from the scheduler .,178
src \ main \ java \ rx \ internal \ operators \ OperatorReplay . java \n - setFirst ( next ) ; \n + setFirst ( next . get ( ) ) ; \n - / * test * / final void removeSome ( int n ) { \n + final void removeSome ( int n ) { \n - setFirst ( head ) ; \n + setFirst ( head . get ( ) ) ; \n - set ( n ) ; \n + Node newHead = new Node ( null ) ; \n + newHead . lazySet ( n ) ; \n + if ( n = = null ) { \n + tail = newHead ; \n + } \n + set ( newHead ) ; \n - Node prev = get ( ) ; \n - Node next = prev . get ( ) ; \n + Node head = get ( ) ; \n + Node next = head . get ( ) ; \n - prev = next ; \n - prev = next ; \n - setFirst ( prev ) ; \n + setFirst ( next ) ; \n - Node prev = get ( ) ; \n - Node next = prev . get ( ) ; \n + Node head = get ( ) ; \n + Node next = head . get ( ) ; \n - prev = next ; \n - setFirst ( prev ) ; \n + setFirst ( next ) ; \n,"Revert "" No need to allocate a new head node . "" \n This reverts commit 46f9138f509f22be61d435cfb79335396fc92c48 .",178
src \ main \ java \ rx \ Observable . java \n - * < dd > This operator supports backpressure . < / dd > \n + * < dd > This operator does not support upstream backpressure as it is purposefully requesting and caching \n + * everything emitted . < / dd > \n - * < dd > This operator supports backpressure . < / dd > \n + * < dd > This operator does not support upstream backpressure as it is purposefully requesting and caching \n + * everything emitted . < / dd > \n,"Revert "" If cache ( ) now supports backpressure , correct javadocs to indicate this . "" \n This reverts commit ec3d522c826c3135b9f5e3a9bb34f62756ec95cc .",178
"hexagonal \ src \ test \ java \ com \ iluwatar \ hexagonal \ domain \ LotteryTest . java \n - private final LotteryTicketRepository repository = new LotteryTicketInMemoryRepository ( ) ; \n - repository . deleteAll ( ) ; \n + / / add funds to the test player ' s bank account \n + wireTransfers . setFunds ( "" 123 - 12312 "" , 100 ) ; \n - \n - / / setup bank account with funds \n - wireTransfers . setFunds ( "" 123 - 12312 "" , 100 ) ; \n - \n",Hexagonal pattern : remove unnecessary repository usage from a unit test,211
hexagonal \ README . md \n + # # Tutorials \n + * [ Build Maintainable Systems With Hexagonal Architecture ] ( http : / / java - design - patterns . com / blog / build - maintainable - systems - with - hexagonal - architecture / ) \n + \n,Link Hexagonal Architecture pattern to corresponding blog entry,211
hexagonal \ src \ main \ java \ com \ iluwatar \ hexagonal \ domain \ LotteryNumbers . java \n - @ Override \n - public int hashCode ( ) { \n - final int prime = 31 ; \n - int result = 1 ; \n - result = prime * result + ( ( numbers = = null ) ? 0 : numbers . hashCode ( ) ) ; \n - return result ; \n - } \n - \n - @ Override \n - public boolean equals ( Object obj ) { \n - if ( this = = obj ) { \n - return true ; \n - } \n - if ( obj = = null ) { \n - return false ; \n - } \n - if ( getClass ( ) ! = obj . getClass ( ) ) { \n - return false ; \n - } \n - LotteryNumbers other = ( LotteryNumbers ) obj ; \n - if ( numbers = = null ) { \n - if ( other . numbers ! = null ) { \n - return false ; \n - } \n - } else if ( ! numbers . equals ( other . numbers ) ) { \n - return false ; \n - } \n - return true ; \n - } \n - \n - \n + \n + \n + @ Override \n + public int hashCode ( ) { \n + final int prime = 31 ; \n + int result = 1 ; \n + result = prime * result + ( ( numbers = = null ) ? 0 : numbers . hashCode ( ) ) ; \n + return result ; \n + } \n + \n + @ Override \n + public boolean equals ( Object obj ) { \n + if ( this = = obj ) { \n + return true ; \n + } \n + if ( obj = = null ) { \n + return false ; \n + } \n + if ( getClass ( ) ! = obj . getClass ( ) ) { \n + return false ; \n + } \n + LotteryNumbers other = ( LotteryNumbers ) obj ; \n + if ( numbers = = null ) { \n + if ( other . numbers ! = null ) { \n + return false ; \n + } \n + } else if ( ! numbers . equals ( other . numbers ) ) { \n + return false ; \n + } \n + return true ; \n + } \n,Reorganize LotteryNumbers for easier inclusion in the blog,211
"hexagonal \ src \ main \ java \ com \ iluwatar \ hexagonal \ administration \ LotteryAdministrationImpl . java \n + private static final int WIN _ AMOUNT = 100000 ; \n + \n + private static final String PRIZE _ PAYER _ BANK _ ACCOUNT = "" 123 - 123 "" ; \n + \n - bank . transferFunds ( 1000 , "" 123 - 123 "" , tickets . get ( id ) . getPlayerDetails ( ) . getBankAccount ( ) ) ; \n - notifications . notifyPrize ( tickets . get ( id ) . getPlayerDetails ( ) , 1000 ) ; \n + bank . transferFunds ( WIN _ AMOUNT , PRIZE _ PAYER _ BANK _ ACCOUNT , tickets . get ( id ) . getPlayerDetails ( ) . getBankAccount ( ) ) ; \n + notifications . notifyPrize ( tickets . get ( id ) . getPlayerDetails ( ) , WIN _ AMOUNT ) ; \n",Add constants for win sum and prize payer ' s bank account,211
". travis . yml \n - GH _ REF : github . com / iluwatar / java - design - patterns . git \n - secure : LxTDuNS / rBWIvKkaEqr79ImZAe48mCdoYCF41coxNXgNoippo4GIBArknqtv + XvdkiuRZ1yGyj6pn8GU33c / yn + krddTUkVCwTbVatbalW5jhQjDbHYym / JcxaK9ZS / 3JTeGcWrBgiPqHEEDhCf26vPZsXoMSeVCEORVKTp1BSg = \n + - secure : "" eoWlW9GyTJY04P8K3pxayXwU9 / hmptQg / LfirispQkV9YvmziCfSzXnatnBhNfud98sCzY8BScXnb + OWLTnjLKpId4rtEqb0aJ40Jc32cUKzgzFAUn7cNcDAbUIfyPAGVqyQqfj / 11wYSADwWMMOPlW97ExUtoyiH2WenXuRHso = "" \n - export DISPLAY = : 99 . 0 \n - mvn clean test jacoco : report coveralls : report \n + - mvn clean org . jacoco : jacoco - maven - plugin : prepare - agent package sonar : sonar - Dsonar . host . url = https : / / sonarqube . com - Dsonar . login = SONAR _ TOKEN \n - bash update - ghpages . sh \n",Add Travis instructions for SonarQube . com analysis,211
queue - load - leveling \ README . md \n + # # Tutorials \n + * [ Queue - Based Load Leveling Pattern ] ( http : / / java - design - patterns . com / blog / queue - load - leveling / ) \n + \n,# 525 Add link to Queue - Based Load Leveling blog,211
pom . xml \n + < param > singleton < / param > \n,# 590 Skip puml processing for singleton module,211
. travis . yml \n - dist : trusty # Xenial build environment won ' t allow installation of Java 8 \n + dist : xenial \n - - oraclejdk8 \n + - openjdk8 \n + - openjdk11 \n - mvn clean org . jacoco : jacoco - maven - plugin : prepare - agent package sonar : sonar - Dsonar . host . url = https : / / sonarcloud . io - Dsonar . login = $ SONAR _ TOKEN \n - bash update - ghpages . sh \n - # use latest java version available instead of travis default \n - addons : \n - apt : \n - packages : \n - - oracle - java8 - installer \n - \n - iluwatar @ gmail . com \n,Configure Travis to build on JDK8 and JDK11,211
pom . xml \n + < module > game - loop < / module > \n,Add game - loop to parent pom . xml,211
abstract - factory \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n adapter \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n bridge \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n builder \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n chain \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n command \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n composite \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n interpreter \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n iterator \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n memento \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n singleton \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n state \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n strategy \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n template - method \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n visitor \ README . md \n - - Gang Of Four \n + - Gang of Four \n - - - \n,https : / / github . com / iluwatar / java - design - patterns - web / issues / 8 Fix typo in tag,211
"abstract - factory \ README . md \n - > To create a kingdom we need objects with common theme . Elven kingdom needs an Elven king , Elven castle and Elven army whereas Orcish kingdom needs an Orcish king , Orcish castle and Orcish army . There is a dependency between the objects in the kingdom . \n + > To create a kingdom we need objects with a common theme . Elven kingdom needs an Elven king , Elven castle and Elven army whereas Orcish kingdom needs an Orcish king , Orcish castle and Orcish army . There is a dependency between the objects in the kingdom . \n - Translating the kingdom example above . First of all we have some interfaces and implementation for the objects in the kingdom \n + Translating the kingdom example above . First of all we have some interfaces and implementation for the objects in the \n + kingdom . \n - # # Use Cases : \n + Example use cases \n - * Selecting to call the appropriate implementation of FileSystemAcmeService or DatabaseAcmeService or NetworkAcmeService at runtime . \n + * Selecting to call to the appropriate implementation of FileSystemAcmeService or DatabaseAcmeService or NetworkAcmeService at runtime . \n - \n - # # Real world examples \n + # # Known uses \n + # # Related patterns \n + \n + [ Factory Method ] ( https : / / java - design - patterns . com / patterns / factory - method / ) \n + [ Factory Kit ] ( https : / / java - design - patterns . com / patterns / factory - kit / ) \n + \n",# 590 add related patterns to Abstract Factory,211
data - transfer - object \ README . md \n + * [ Patterns of Enterprise Application Architecture ] ( https : / / www . amazon . com / gp / product / 0321127420 / ref = as _ li _ tl ? ie = UTF8 & camp = 1789 & creative = 9325 & creativeASIN = 0321127420 & linkCode = as2 & tag = javadesignpat - 20 & linkId = 014237a67c9d46f384b35e10151956bd ) \n lazy - loading \ README . md \n + * [ Patterns of Enterprise Application Architecture ] ( https : / / www . amazon . com / gp / product / 0321127420 / ref = as _ li _ tl ? ie = UTF8 & camp = 1789 & creative = 9325 & creativeASIN = 0321127420 & linkCode = as2 & tag = javadesignpat - 20 & linkId = d9f7d37b032ca6e96253562d075fcc4a ) \n repository \ README . md \n + * [ Patterns of Enterprise Application Architecture ] ( https : / / www . amazon . com / gp / product / 0321127420 / ref = as _ li _ tl ? ie = UTF8 & camp = 1789 & creative = 9325 & creativeASIN = 0321127420 & linkCode = as2 & tag = javadesignpat - 20 & linkId = d9f7d37b032ca6e96253562d075fcc4a ) \n unit - of - work \ README . md \n + * [ Patterns of Enterprise Application Architecture ] ( https : / / www . amazon . com / gp / product / 0321127420 / ref = as _ li _ tl ? ie = UTF8 & camp = 1789 & creative = 9325 & creativeASIN = 0321127420 & linkCode = as2 & tag = javadesignpat - 20 & linkId = d9f7d37b032ca6e96253562d075fcc4a ) \n,Add references to Patterns of Enterprise Application Architecture,211
. github \ workflows \ maven . yml \n - name : Install xvfb \n + # SonarQube scan does not work for forked repositories \n + # See https : / / jira . sonarsource . com / browse / MMF - 1371 \n - name : Build with Maven \n + if : github . ref ! = ‘refs / heads / master’ \n + run : xvfb - run mvn clean verify \n + - name : Build with Maven and run SonarQube analysis \n + if : github . ref = = ‘refs / heads / master’ \n,SonarQube check runs only in master branch ( workaround for https : / / jira . sonarsource . com / browse / MMF - 1371 ),211
naked - objects \ pom . xml \n - < version > 3 . 2 . 3 < / version > \n + < version > 2 . 4 < / version > \n,"Revert "" Bump maven - war - plugin from 2 . 4 to 3 . 2 . 3 ( # 1129 ) "" \n This reverts commit b99d37506f0ad572824f6edab838505c951117db .",211
pom . xml \n - < version > 3 . 0 . 0 - M4 < / version > \n + < version > 3 . 0 . 0 - M3 < / version > \n,"Revert "" Bump maven - surefire - plugin from 3 . 0 . 0 - M3 to 3 . 0 . 0 - M4 ( # 1126 ) "" \n This reverts commit f00523f7c0f8a008f3e5e5616f156e615bc47e16 .",211
"compiler \ frontend \ src \ org \ jetbrains \ kotlin \ resolve \ lazy \ descriptors \ AbstractLazyMemberScope . kt \n - storageManager . createMemoizedFunction { doGetTypeAliases ( it ) } \n + storageManager . createMemoizedFunction ( { doGetTypeAliases ( it ) } , onRecursiveCall = { _ , _ - > emptyList ( ) } ) \n new file \n compiler \ testData \ diagnostics \ tests \ typealias \ boundsViolationRecursive . fir . kt \n + / / ! DIAGNOSTICS : - UNUSED _ VARIABLE - UNUSED _ PARAMETER \n + \n + typealias R < T : List < R > > = List < T > \n new file \n compiler \ testData \ diagnostics \ tests \ typealias \ boundsViolationRecursive . kt \n + / / ! DIAGNOSTICS : - UNUSED _ VARIABLE - UNUSED _ PARAMETER \n + \n + typealias R < T : < ! BOUND _ ON _ TYPE _ ALIAS _ PARAMETER _ NOT _ ALLOWED ! > List < < ! UNRESOLVED _ REFERENCE ! > R < ! > > < ! > > = List < T > \n new file \n compiler \ testData \ diagnostics \ tests \ typealias \ boundsViolationRecursive . txt \n + package \n + \n + public typealias R < / * 0 * / T : kotlin . collections . List < [ ERROR : R ] > > = kotlin . collections . List < T > \n compiler \ tests - common - new \ tests - gen \ org \ jetbrains \ kotlin \ test \ runners \ DiagnosticTestGenerated . java \n + @ Test \n + @ TestMetadata ( "" boundsViolationRecursive . kt "" ) \n + public void testBoundsViolationRecursive ( ) throws Exception { \n + runTest ( "" compiler / testData / diagnostics / tests / typealias / boundsViolationRecursive . kt "" ) ; \n + } \n + \n compiler \ tests - common - new \ tests - gen \ org \ jetbrains \ kotlin \ test \ runners \ FirOldFrontendDiagnosticsTestGenerated . java \n + @ Test \n + @ TestMetadata ( "" boundsViolationRecursive . kt "" ) \n + public void testBoundsViolationRecursive ( ) throws Exception { \n + runTest ( "" compiler / testData / diagnostics / tests / typealias / boundsViolationRecursive . kt "" ) ; \n + } \n + \n","Do not throw assertion on recursion in typealias declaration , \n return empty list of descriptors instead , allowing for proper error \n reporting later . \n # KT - 18344 fixed",214
"compiler \ frontend \ src \ org \ jetbrains \ kotlin \ resolve \ DescriptorResolver . java \n - assert owner . getDispatchReceiverParameter ( ) = = null \n + ReceiverParameterDescriptor dispatchReceiver = owner . getDispatchReceiverParameter ( ) ; \n + assert dispatchReceiver = = null | | dispatchReceiver . getContainingDeclaration ( ) instanceof ScriptDescriptor \n new file \n plugins \ scripting \ scripting - compiler \ testData \ compiler \ kt42530 . kts \n + \n + fun Int . isOdd ( ) = ( this % 2 ) = = 1 \n + val list : List < Pair < Int , String > > = listOf ( 1 to "" a "" , 2 to "" b "" ) \n + val ( odds , evens ) = list . partition { ( i , _ ) - > i . isOdd ( ) } \n + odds \n plugins \ scripting \ scripting - compiler \ tests \ org \ jetbrains \ kotlin \ scripting \ compiler \ test \ ScriptTest . kt \n + fun testKt42530 ( ) { \n + val aClass = compileScript ( "" kt42530 . kts "" , StandardScriptDefinition ) \n + Assert . assertNotNull ( aClass ) \n + val out = captureOut { \n + val anObj = tryConstructClassFromStringArgs ( aClass ! ! , emptyList ( ) ) \n + Assert . assertNotNull ( anObj ) \n + } \n + assertEqualsTrimmed ( "" [ ( 1 , a ) ] "" , out ) \n + } \n + \n",Remove assertion about dispatch receiver in scripts \n # KT - 42530 fixed,214
"compiler \ cli \ cli - runner \ src \ org \ jetbrains \ kotlin \ runner \ Main . kt \n + var noStdLib = false \n + else if ( "" - no - stdlib "" = = arg ) { \n + noStdLib = true \n + compilerArguments . add ( arg ) \n + } \n - classpath . addPath ( "" $ KOTLIN _ HOME / lib / kotlin - stdlib . jar "" ) \n + if ( ! noStdLib ) { \n + classpath . addPath ( "" $ KOTLIN _ HOME / lib / kotlin - stdlib . jar "" ) \n + } \n - classpath ( - cp ) < path > Paths where to find user class files \n - Dname = value Set a system JVM property \n - J < option > Pass an option directly to JVM \n + - no - stdlib Don ' t include Kotlin standard library into classpath \n - no - reflect Don ' t include Kotlin reflection implementation into classpath \n - X < flag > [ = value ] Pass - X argument to the compiler \n - version Display Kotlin version \n compiler \ tests \ org \ jetbrains \ kotlin \ cli \ LauncherScriptTest . kt \n + fun testNoStdLib ( ) { \n + runProcess ( "" kotlin "" , "" - e "" , "" println ( 42 ) "" , expectedStdout = "" 42 \ n "" ) \n + runProcess ( \n + "" kotlin "" , "" - no - stdlib "" , "" - e "" , "" println ( 42 ) "" , \n + expectedExitCode = 1 , expectedStderrContains = Regex ( "" error : unresolved reference : println "" ) \n + ) \n + } \n + \n",Implement - no - stdlib argument support in kotlin runner \n # KT - 43294 fixed,214
"libraries \ tools \ kotlin - main - kts - test \ test \ org \ jetbrains \ kotlin \ mainKts \ test \ mainKtsIT . kt \n - cacheDir : File ? = null \n + cacheDir : Path ? = null \n - additionalEnvVars = listOf ( COMPILED _ SCRIPTS _ CACHE _ DIR _ ENV _ VAR to ( cacheDir ? . absolutePath ? : "" "" ) ) \n + additionalEnvVars = listOf ( COMPILED _ SCRIPTS _ CACHE _ DIR _ ENV _ VAR to ( cacheDir ? . toAbsolutePath ( ) ? . toString ( ) ? : "" "" ) ) \n - cacheDir : File ? = null \n + cacheDir : Path ? = null \n - withProperty ( COMPILED _ SCRIPTS _ CACHE _ DIR _ PROPERTY , cacheDir ? . absolutePath ? : "" "" ) { \n + withProperty ( COMPILED _ SCRIPTS _ CACHE _ DIR _ PROPERTY , cacheDir ? . toAbsolutePath ( ) ? . toString ( ) ? : "" "" ) { \n",[ minor ] use new kotlin . io . path API in tests,214
"buildSrc \ src \ main \ kotlin \ jdksFinder . kt \n - private val macOsJavaHomeOutRegexes = listOf ( Regex ( "" "" "" \ s + ( \ S + ) , \ s + ( \ S + ) : \ s + "" . * ? "" \ s + ( . + ) "" "" "" ) , \n - Regex ( "" "" "" \ s + ( \ S + ) \ s + \ ( ( . * ? ) \ ) : \ s + ( . + ) "" "" "" ) ) \n + private val macOsJavaHomeOutRegexes = \n + listOf ( \n + Regex ( "" "" "" \ s + ( \ S + ) , \ s + ( \ S + ) : \ s + "" . * ? "" \ s + ( . + ) "" "" "" ) , \n + Regex ( "" "" "" \ s + ( \ S + ) \ s + \ ( ( . * ? ) \ ) : \ s + ( . + ) "" "" "" ) , \n + Regex ( "" "" "" \ s + ( \ S + ) \ s + \ ( ( . * ? ) \ ) \ s + "" [ ^ "" ] * "" \ s + - \ s + "" [ ^ "" ] * "" \ s ( . + ) "" "" "" ) \n + ) \n",[ build ] Fix JDK detection on Mac OS X 11 ( Big Sur ) \n # KTI - 443 fixed,214
"compiler \ cli \ cli - runner \ src \ org \ jetbrains \ kotlin \ runner \ Main . kt \n - J < option > Pass an option directly to JVM \n - no - stdlib Don ' t include Kotlin standard library into classpath \n - no - reflect Don ' t include Kotlin reflection implementation into classpath \n + - compiler - path Kotlin compiler classpath for compiling script or expression or running REPL \n + If not specified , try to find the compiler in the environment \n - X < flag > [ = value ] Pass - X argument to the compiler \n - version Display Kotlin version \n - help ( - h ) Print a synopsis of options \n",[ minor ] document - compiler - path option for kotlin runner,214
"plugins \ scripting \ scripting - compiler \ build . gradle . kts \n - languageVersion = "" 1 . 3 "" \n - apiVersion = "" 1 . 3 "" \n plugins \ scripting \ scripting - compiler \ src \ org \ jetbrains \ kotlin \ scripting \ compiler \ plugin \ repl \ ReplFromTerminal . kt \n + is ReplEvalResult . HistoryMismatch - > { } / / assuming handled elsewhere \n plugins \ scripting \ scripting - compiler \ tests \ org \ jetbrains \ kotlin \ scripting \ compiler \ test \ CompileTimeFibonacciTest . kt \n - ? . max ( ) ? : return @ onAnnotations context . compilationConfiguration . asSuccess ( ) \n + ? . maxOrNull ( ) ? : return @ onAnnotations context . compilationConfiguration . asSuccess ( ) \n",[ minor ] fix warnings in the script compiler and tests,214
"build . gradle . kts \n - "" : kotlin - scripting - compiler : compileTestKotlin "" , \n","Revert "" Add : kotlin - scripting - compiler . test to modules with disabled - Werror flag "" \n This reverts commit 21f022de",214
idea \ src \ org \ jetbrains \ kotlin \ idea \ script \ ScriptTemplatesClassRootsIndex . kt \n - & & file . path . endsWith ( SCRIPT _ DEFINITION _ MARKERS _ EXTENSION _ WITH _ DOT ) \n,"Do not check script discovery file extension \n it is optional ( so far ) , so this check was incorrect . \n # KT - 44117 fixed",214
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ lower \ PropertyLazyInitLowering . kt \n - if ( container . origin ! in compatibleOrigins ) return \n + if ( ! container . isCompatibleDeclaration ( ) ) return \n + container . assertCompatibleDeclaration ( ) \n + \n - ? . let { it . initializer = null } \n + ? . let { \n + it . assertCompatibleDeclaration ( ) \n + it . initializer = null \n + } \n + private fun IrDeclaration . assertCompatibleDeclaration ( ) { \n + assert ( ( this as ? PersistentIrElementBase < * > ) ? . createdOn ? . let { it = = 0 } ! = false ) \n + } \n + \n + IrDeclarationOrigin . PROPERTY _ DELEGATE , \n compiler \ testData \ codegen \ box \ properties \ noInitializationLazilyOnNonPropertiesCall . kt \n + / / KJS _ WITH _ FULL _ RUNTIME \n + val b1 by lazy { \n + "" b1 "" \n + } \n + \n",[ JS IR ] Assert createdOn equals 0 for properties initialization fun for file,215
libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ nodejs \ NodeJsExec . kt \n + @ Input \n + var nodeArgs : MutableList < String > = mutableListOf ( ) \n + \n + val newArgs = mutableListOf < String > ( ) \n + newArgs . addAll ( nodeArgs ) \n - val newArgs = mutableListOf < String > ( ) \n - args ? . let { newArgs . addAll ( it ) } \n - args = newArgs \n + args ? . let { newArgs . addAll ( it ) } \n + args = newArgs \n,"[ Gradle , JS ] Add nodeArgs to NodeJsExec \n ^ KT - 43793 fixed",215
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ webpack \ KotlinWebpackConfig . kt \n - library : "" $ { output ! ! . library } "" , \n - libraryTarget : "" $ { output ! ! . libraryTarget } "" , \n + $ { output ! ! . library ? . let { "" library : $ { it . jsQuoted ( ) } , "" } ? : "" "" } \n + $ { output ! ! . libraryTarget ? . let { "" libraryTarget : $ { it . jsQuoted ( ) } , "" } ? : "" "" } \n","[ Gradle , JS ] Null library and libraryTarget when they are null \n ^ KT - 43842 fixed",215
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ NpmDependency . kt \n - \n - fun uniqueRepresentation ( ) = \n - "" $ scope $ key : $ version , $ generateExternals "" \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ NpmDependencyDeclaration . kt \n + fun NpmDependencyDeclaration . uniqueRepresentation ( ) = \n + "" $ scope $ name : $ version , $ generateExternals "" \n + \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ resolver \ KotlinCompilationNpmResolver . kt \n + @ Transient \n + val externalNpmDependencyDeclarations by lazy { \n + externalNpmDependencies . map { \n + it . toDeclaration ( ) \n + } \n + } \n + \n - externalNpmDependencies . map { it . uniqueRepresentation ( ) } , \n + externalNpmDependencyDeclarations . map { it . uniqueRepresentation ( ) } , \n - val allNpmDependencies = externalNpmDependencies . map { it . toDeclaration ( ) } + toolsNpmDependencies \n + val allNpmDependencies = externalNpmDependencyDeclarations + toolsNpmDependencies \n","[ Gradle , JS ] Npm dependencies as transient , and store only declarations",215
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ transformers \ irToJs \ IrElementToJsExpressionTransformer . kt \n - val argumentsAsSingleArray = argumentsAsSingleArray ( \n + val argumentsAsSingleArray = argumentsWithVarargAsSingleArray ( \n compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ transformers \ irToJs \ jsAstUtils . kt \n - val argumentsAsSingleArray = argumentsAsSingleArray ( \n + val argumentsAsSingleArray = argumentsWithVarargAsSingleArray ( \n - internal fun argumentsAsSingleArray ( \n + fun argumentsWithVarargAsSingleArray ( \n - varargParameterIndex : Int ? \n + varargParameterIndex : Int , \n - var varargArgument : JsExpression ? = null \n - val additionalSize = additionalReceiver ? . let { 1 } ? : 0 \n - / / size + 1 because arguments size + potential additionalReceiver \n - val nonVarArgs : MutableList < JsExpression > = \n - ArrayList < JsExpression > ( arguments . size + additionalSize ) . apply { \n - additionalReceiver ? . let { add ( it ) } \n - } \n + var arraysForConcat : MutableList < JsExpression > = mutableListOf < JsExpression > ( ) . apply { \n + additionalReceiver ? . let { add ( it ) } \n + } \n + val concatElements : MutableList < JsExpression > = mutableListOf ( ) \n - varargArgument = if ( argument is JsArrayLiteral ) { \n + concatElements . add ( JsArrayLiteral ( arraysForConcat ) ) \n + arraysForConcat = mutableListOf ( ) \n + \n + val varargArgument = if ( argument is JsArrayLiteral ) { \n + \n + concatElements . add ( varargArgument ) \n - else - > nonVarArgs . add ( argument ) \n + else - > { \n + arraysForConcat . add ( argument ) \n + } \n - val nonVarArgArrayLiteral = JsArrayLiteral ( nonVarArgs ) \n - return varargArgument ? . let { \n - JsInvocation ( \n - JsNameRef ( "" concat "" , nonVarArgArrayLiteral ) , \n - it \n + if ( arraysForConcat . isNotEmpty ( ) | | concatElements . isEmpty ( ) ) { \n + concatElements . add ( JsArrayLiteral ( arraysForConcat ) ) \n + } \n + \n + return concatElements . singleOrNull ( ) \n + ? : JsInvocation ( \n + JsNameRef ( "" concat "" , concatElements . first ( ) ) , \n + concatElements . drop ( 1 ) \n - } ? : nonVarArgArrayLiteral \n",[ JS IR ] Use one concat elements for non vararg and vararg arguments \n ^ KT - 42357 fixed,215
libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ resolver \ KotlinCompilationNpmResolver . kt \n - . filter { it . exists ( ) } \n + . filter { it . exists ( ) & & it . isFile } \n,"[ Gradle , JS ] Add filter on file on fileCollectionDependencies because Gradle can ' t hash directory \n ^ KT - 43668 fixed",215
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ Kotlin2JsGradlePluginIT . kt \n + \n + @ Test \n + fun testDirectoryDependencyNotFailProjectResolution ( ) { \n + with ( Project ( "" kotlin - js - nodejs - project "" ) ) { \n + setupWorkingDir ( ) \n + gradleBuildScript ( ) . modify ( : : transformBuildScriptWithPluginsDsl ) \n + gradleSettingsScript ( ) . modify ( : : transformBuildScriptWithPluginsDsl ) \n + \n + gradleBuildScript ( ) . appendText ( \n + "" "" "" $ { "" \ n "" } \n + dependencies { \n + implementation ( files ( "" $ { "" $ "" } { projectDir } / custom "" ) ) \n + implementation ( files ( "" $ { "" $ "" } { projectDir } / custom2 "" ) ) \n + } \n + "" "" "" . trimIndent ( ) \n + ) \n + \n + build ( \n + "" packageJson "" \n + ) { \n + assertSuccessful ( ) \n + } \n + } \n + } \n new file \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ resources \ testProject \ kotlin - js - nodejs - project \ custom \ main . txt \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ resolver \ KotlinCompilationNpmResolver . kt \n - . filter { it . exists ( ) & & it . isFile } \n + / / Gradle can hash with FileHasher only files and only existed files \n + . filter { it . isFile } \n","[ Gradle , JS ] Add test on resolution of js project with directory dependency \n ^ KT - 43668 fixed",215
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ NpmProject . kt \n + . replace ( DECAMELIZE _ REGEX ) { \n + it . groupValues \n + . drop ( 1 ) \n + . joinToString ( prefix = "" - "" , separator = "" - "" ) \n + } \n + . toLowerCase ( ) \n + \n + private val DECAMELIZE _ REGEX = "" ( [ A - Z ] ) "" . toRegex ( ) \n","[ Gradle , JS ] Fix upper case names in js files , decamelize instead \n ^ KT - 43237 fixed",215
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ DukatIntegrationIT . kt \n - val externalSrcs = "" build / externals / both - jsIr / src "" \n + val externalSrcs = "" build / externals / both - js - ir / src "" \n - val legacyExternals = "" build / externals / both - jsLegacy / src "" \n + val legacyExternals = "" build / externals / both - js - legacy / src "" \n - val externalSrcs = "" build / externals / both - jsLegacy / src "" \n + val externalSrcs = "" build / externals / both - js - legacy / src "" \n - val irExternals = "" build / externals / both - jsIr / src "" \n + val irExternals = "" build / externals / both - js - ir / src "" \n - val externalSrcs = "" build / externals / both - jsIr / src "" \n + val externalSrcs = "" build / externals / both - js - ir / src "" \n - val legacyExternals = "" build / externals / both - jsLegacy / src "" \n + val legacyExternals = "" build / externals / both - js - legacy / src "" \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ Kotlin2JsGradlePluginIT . kt \n - assertFileExists ( "" build / js / packages / kotlin - js - browser - base - jsIr "" ) \n - assertFileExists ( "" build / js / packages / kotlin - js - browser - base - jsLegacy "" ) \n + assertFileExists ( "" build / js / packages / kotlin - js - browser - base - js - ir "" ) \n + assertFileExists ( "" build / js / packages / kotlin - js - browser - base - js - legacy "" ) \n - assertFileExists ( "" build / js / packages / kotlin - js - browser - app / kotlin - dce / kotlin - js - browser - base - jsLegacy . js "" ) \n + assertFileExists ( "" build / js / packages / kotlin - js - browser - app / kotlin - dce / kotlin - js - browser - base - js - legacy . js "" ) \n","[ Gradle , JS ] Fix tests with decamelizing names \n ^ KT - 43237 fixed",215
"libraries \ tools \ new - project - wizard \ src \ org \ jetbrains \ kotlin \ tools \ projectWizard \ Versions . kt \n - val KOTLIN _ REDUX = wrapperVersion ( "" 7 . 2 . 2 "" ) \n + val KOTLIN _ REDUX = wrapperVersion ( "" 4 . 0 . 5 "" ) \n","[ Wizard , JS ] Fix kotlin - redux version",215
"libraries \ tools \ kotlin - gradle - plugin \ build . gradle . kts \n - implementation ( "" com . github . gundy : semver4j : 0 . 16 . 4 "" ) \n + implementation ( "" com . github . gundy : semver4j : 0 . 16 . 4 : nodeps "" ) { \n + exclude ( group = "" * "" ) \n + } \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ NpmRangeVisitor . kt \n + import com . github . gundy . hidden . antlr . v4 . runtime . tree . TerminalNode \n - import org . antlr . v4 . runtime . tree . TerminalNode \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ npm \ NpmVersions . kt \n + import com . github . gundy . hidden . antlr . v4 . runtime . ANTLRInputStream \n + import com . github . gundy . hidden . antlr . v4 . runtime . CommonTokenStream \n - import org . antlr . v4 . runtime . ANTLRInputStream \n - import org . antlr . v4 . runtime . CommonTokenStream \n","[ Gradle , JS ] Exclude transitive dependencies of semver4j \n ^ KT - 44204 fixed",215
"js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ es6 \ semantics \ IrBoxJsES6TestGenerated . java \n + @ TestMetadata ( "" overridenMethod . kt "" ) \n + public void testOverridenMethod ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / export / overridenMethod . kt "" ) ; \n + } \n + \n js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ ir \ semantics \ IrBoxJsTestGenerated . java \n + @ TestMetadata ( "" overridenMethod . kt "" ) \n + public void testOverridenMethod ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / export / overridenMethod . kt "" ) ; \n + } \n + \n js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ semantics \ BoxJsTestGenerated . java \n + @ TestMetadata ( "" overridenMethod . kt "" ) \n + public void testOverridenMethod ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / export / overridenMethod . kt "" ) ; \n + } \n + \n new file \n js \ js . translator \ testData \ box \ export \ overridenMethod . kt \n + abstract class Foo1 { \n + abstract fun ok ( ) : String \n + } \n + \n + @ JsExport \n + class Bar1 : Foo1 ( ) { \n + override fun ok ( ) : String { \n + return "" OK "" \n + } \n + } \n + \n + open class Foo2 { \n + open fun ok ( ) : String { \n + return "" fail "" \n + } \n + } \n + \n + @ JsExport \n + class Bar2 : Foo2 ( ) { \n + override fun ok ( ) : String { \n + return "" OK "" \n + } \n + } \n + \n + fun box ( ) : String { \n + return if ( Bar1 ( ) . ok ( ) = = "" OK "" & & Bar2 ( ) . ok ( ) = = "" OK "" ) "" OK "" else "" fail "" \n + } \n",[ JS IR ] Add test on exportable overriden method \n ^ KT - 44415 fixed,215
compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ utils \ misc . kt \n - import org . jetbrains . kotlin . ir . expressions . * \n + import org . jetbrains . kotlin . ir . expressions . IrExpression \n - import org . jetbrains . kotlin . ir . types . isUnit \n - origin = = IrDeclarationOrigin . FUNCTION _ FOR _ DEFAULT _ PARAMETER \n + origin = = IrDeclarationOrigin . FUNCTION _ FOR _ DEFAULT _ PARAMETER | | \n + origin = = IrDeclarationOrigin . BRIDGE \n,[ JS IR ] Add BRIDGE origin as ignore for stabitility of names \n ^ KT - 44415 fixed,215
compiler \ testData \ codegen \ box \ extensionFunctions \ classMethodCallExtensionSuper . kt \n - class Bottom ( val data : Int ) : DefaultImpl { \n + class Bottom ( val data : Int ) : DefaultImpl ( ) { \n,[ JS IR ] Fix of test with method in abstract class calling extension on super type,215
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ export \ ExportModelGenerator . kt \n - private fun shouldDeclarationBeExported ( declaration : IrDeclarationWithName , context : JsIrBackendContext ) : Boolean { \n - if ( declaration . fqNameWhenAvailable in context . additionalExportedDeclarationNames ) \n + private fun shouldDeclarationBeExported ( declaration : IrDeclarationWithName , context : JsIrBackendContext ? ) : Boolean { \n + if ( context ? . additionalExportedDeclarationNames ? . contains ( declaration . fqNameWhenAvailable ) = = true ) \n - if ( declaration in context . additionalExportedDeclarations ) \n + if ( context ? . additionalExportedDeclarations ? . contains ( declaration ) = = true ) \n - fun IrDeclaration . isExported ( context : JsIrBackendContext ) : Boolean { \n + fun IrDeclaration . isExported ( context : JsIrBackendContext ? ) : Boolean { \n compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ utils \ misc . kt \n + import org . jetbrains . kotlin . ir . backend . js . export . isExported \n - return ( isEffectivelyExternal ( ) | | getJsName ( ) ! = null | | isJsExport ( ) | | parentClassOrNull ? . isJsExport ( ) = = true ) & & namedOrMissingGetter \n + return ( isEffectivelyExternal ( ) | | getJsName ( ) ! = null | | isExported ( null ) ) & & namedOrMissingGetter \n",[ JS IR ] Use recursive isExported for stable name detection \n ^ KT - 44469 fixed,215
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ lower \ JsSingleAbstractMethodLowering . kt \n - import org . jetbrains . kotlin . backend . common . lower . SingleAbstractMethodLowering \n + import org . jetbrains . kotlin . backend . common . lower . SingleAbstractMethodLowering \n - import org . jetbrains . kotlin . ir . symbols . IrSymbol \n + import org . jetbrains . kotlin . ir . symbols . IrSymbol \n - override fun getWrapperVisibility ( expression : IrTypeOperatorCall , scopes : List < ScopeWithIr > ) : DescriptorVisibility { \n - return DescriptorVisibilities . PRIVATE \n - } \n + override fun getWrapperVisibility ( expression : IrTypeOperatorCall , scopes : List < ScopeWithIr > ) : DescriptorVisibility = \n + DescriptorVisibilities . LOCAL \n compiler \ testData \ codegen \ box \ coroutines \ featureIntersection \ funInterface . kt \n - / / IGNORE _ BACKEND : JVM , JS _ IR \n + / / IGNORE _ BACKEND : JVM \n",[ JS IR ] Use local scope for SAM if there are scopes \n [ JS IR ] Use private for top level sam wrappers and local otherwise \n ^ KT - 44433 fixed,215
compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ Dce . kt \n - return result \n + return result + context . additionalExportedDeclarations \n compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ lower \ ExportedDefaultParameterStub . kt \n + import org . jetbrains . kotlin . ir . builders . declarations . addFunction \n + context . additionalExportedDeclarations . add ( exportedDefaultStubFun ) \n + \n,[ JS IR ] Add additional exported declarations with exported stub to dce \n ^ KT - 44469 fixed,215
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ Dce . kt \n + \n + context . additionalExportedDeclarations \n + . forEach { it . enqueue ( null , "" from additionalExportedDeclarations "" , altFromFqn = "" < ROOT > "" ) } \n - return result + context . additionalExportedDeclarations \n + return result \n",[ JS IR ] Add additional exported declarations inside dce loop \n [ JS IR ] Remove useless filter in dce for more log information \n ^ KT - 44469 fixed,215
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ nodejs \ NodeJsRootExtension . kt \n - var nodeVersion by Property ( "" 12 . 16 . 1 "" ) \n + var nodeVersion by Property ( "" 14 . 15 . 4 "" ) \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ js \ yarn \ YarnRootExtension . kt \n - var version by Property ( "" 1 . 22 . 4 "" ) \n + var version by Property ( "" 1 . 22 . 10 "" ) \n","[ Gradle , JS ] Update tool versions \n - Node . js - 14 . 15 . 4 \n - Yarn - 1 . 22 . 10 \n ^ KT - 44614 fixed",215
"compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ lower \ JsCodeOutliningLowering . kt \n + import org . jetbrains . kotlin . ir . util . dumpKotlinLike \n + import java . lang . IllegalStateException \n - outlinedFunction . parent = container as IrDeclarationParent \n + outlinedFunction . parent = when ( container ) { \n + is IrDeclarationParent - > container \n + else - > container . parent \n + } \n js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ es6 \ semantics \ IrBoxJsES6TestGenerated . java \n + @ TestMetadata ( "" init . kt "" ) \n + public void testInit ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / jsCode / init . kt "" ) ; \n + } \n + \n js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ ir \ semantics \ IrBoxJsTestGenerated . java \n + @ TestMetadata ( "" init . kt "" ) \n + public void testInit ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / jsCode / init . kt "" ) ; \n + } \n + \n js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ semantics \ BoxJsTestGenerated . java \n + @ TestMetadata ( "" init . kt "" ) \n + public void testInit ( ) throws Exception { \n + runTest ( "" js / js . translator / testData / box / jsCode / init . kt "" ) ; \n + } \n + \n new file \n js \ js . translator \ testData \ box \ jsCode \ init . kt \n + / / EXPECTED _ REACHABLE _ NODES : 1282 \n + package foo \n + \n + class A { \n + var ok : String \n + \n + init { \n + var ok = "" fail "" \n + ok = js ( \n + "" "" "" \n + ok = ' OK ' \n + return ok \n + "" "" "" \n + ) \n + this . ok = ok \n + } \n + } \n + \n + fun box ( ) : String { \n + return A ( ) . ok \n + } \n","[ JS IR ] Not cast to declaration parent in JsCodeOutlineLowering , use parent otherwise \n ^ KT - 45057 fixed",215
"js \ js . tests \ tests - gen \ org \ jetbrains \ kotlin \ js \ test \ semantics \ BoxJsTestGenerated . java \n - @ TestMetadata ( "" init . kt "" ) \n - public void testInit ( ) throws Exception { \n - runTest ( "" js / js . translator / testData / box / jsCode / init . kt "" ) ; \n - } \n - \n js \ js . translator \ testData \ box \ jsCode \ init . kt \n - / / EXPECTED _ REACHABLE _ NODES : 1282 \n + / / TARGET _ BACKEND : JS _ IR \n + \n",[ JS IR ] JS code in init block only for js ir backend test,215
"js \ js . translator \ testData \ box \ export \ exportNestedClass . kt \n + \n + fun bar ( k : String ) : String { \n + return foo ( k ) \n + } \n - return new this [ "" export - nested - class "" ] . B . Foo ( ) . foo ( "" K "" ) ; \n + return new this [ "" export - nested - class "" ] . B . Foo ( ) . bar ( "" K "" ) ; \n",[ JS IR ] Add exported method into exportNestedClass . kt \n ^ KT - 44616 fixed,215
compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ export \ ExportModelGenerator . kt \n + import org . jetbrains . kotlin . backend . common . ir . isMethodOfAny \n - return declaration . isOverriddenExported ( context ) \n + return declaration . isOverriddenExported ( context ) | | \n + declaration . isMethodOfAny ( ) / / Handle names for special functions \n compiler \ ir \ backend . js \ src \ org \ jetbrains \ kotlin \ ir \ backend \ js \ utils \ misc . kt \n - import org . jetbrains . kotlin . ir . util . parentClassOrNull \n,[ JS IR ] Method of any is exported \n ^ KT - 44616 fixed,215
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ compilerRunner \ reportUtils . kt \n - buildDir : File \n + buildDir : File , \n + jvmArgs : List < String > = emptyList ( ) \n - val builder = ProcessBuilder ( javaBin , "" - cp "" , classpathString , compilerClassName , "" @ $ { compilerOptions . absolutePath } "" ) \n + val builder = ProcessBuilder ( \n + javaBin , \n + * ( jvmArgs . toTypedArray ( ) ) , \n + "" - cp "" , \n + classpathString , \n + compilerClassName , \n + "" @ $ { compilerOptions . absolutePath } "" \n + ) \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ tasks \ KotlinJsDce . kt \n + @ Input \n + var jvmArgs = mutableListOf < String > ( ) \n + \n - project . buildDir \n + project . buildDir , \n + jvmArgs \n","[ Gradle , JS ] Add possibility to set jvmArgs for dce process \n ^ KT - 44104 fixed",215
services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + import java . util . Collections ; \n + final List < NetworkRequest > mRequests ; \n + \n + mRequests = initializeRequests ( r ) ; \n + mRequests = initializeRequests ( r ) ; \n + private List < NetworkRequest > initializeRequests ( NetworkRequest r ) { \n + final ArrayList < NetworkRequest > tempRequests = new ArrayList < > ( ) ; \n + tempRequests . add ( new NetworkRequest ( r ) ) ; \n + return Collections . unmodifiableList ( tempRequests ) ; \n + } \n + \n + \n,"Adding multilayered requests to NetworkRequestInfo \n Updating NetworkRequestInfo for "" multilayered requests "" functionality so that \n requests can support a network hierarchy . I . e . , requests network \n with capability A first and if not available , request network with \n capability B . This CL is the first step in adding that support by \n updating the request object from a single request to a collection . \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest NetworkStackTests \n atest FrameworksNetIntegrationTests \n atest NetworkStackIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : I64a124802986e4cf4aa7de158c6690fdf9851cb2",228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - private void callCallbackForRequest ( NetworkRequestInfo nri , \n - NetworkAgentInfo networkAgent , int notificationType , int arg1 ) { \n + private void callCallbackForRequest ( @ NonNull final NetworkRequestInfo nri , \n + @ NonNull final NetworkAgentInfo networkAgent , final int notificationType , \n + final int arg1 ) { \n + / / In the case of multi - layer NRIs , the first request is not necessarily the one that \n + / / is satisfied . This is vexing , but the ConnectivityManager code that receives this \n + / / callback is only using the request as a token to identify the callback , so it doesn ' t \n + / / matter too much at this point as long as the callback can be found . \n + / / TODO b / 177608132 : make sure callbacks are indexed by NRIs and not NetworkRequest objects . \n - putParcelable ( bundle , new NetworkRequest ( nri . request ) ) ; \n + final NetworkRequest nrForCallback = new NetworkRequest ( nri . mRequests . get ( 0 ) ) ; \n + putParcelable ( bundle , nrForCallback ) ; \n - nc , nri . mUid , nri . request . getRequestorPackageName ( ) ) ) ; \n + nc , nri . mUid , nrForCallback . getRequestorPackageName ( ) ) ) ; \n - netCap , nri . mUid , nri . request . getRequestorPackageName ( ) ) ) ; \n + netCap , nri . mUid , nrForCallback . getRequestorPackageName ( ) ) ) ; \n - log ( "" sending notification "" + notification + "" for "" + nri . request ) ; \n + log ( "" sending notification "" + notification + "" for "" + nrForCallback ) ; \n - loge ( "" RemoteException caught trying to send a callback msg for "" + nri . request ) ; \n + loge ( "" RemoteException caught trying to send a callback msg for "" + nrForCallback ) ; \n",Multilayer request updates to request callbacks \n Updated to ConnectivityService to support multilayer requests when \n sending request level callbacks . \n Bug : 174797702 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest NetworkStackTests \n atest FrameworksNetIntegrationTests \n atest NetworkStackIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : I3d6896f5705509bcfff5544d2eb13c31feaf1937,228
tests \ net \ common \ java \ android \ net \ NetworkCapabilitiesTest . java \n - @ Test \n + @ Test @ IgnoreUpTo ( Build . VERSION _ CODES . R ) \n,Adding @ IgnoreUpTo for testOemPrivate \n Adding @ IgnoreUpTo for NetworkCapabilitiesTest . testOemPrivate so that \n this test can run on previous releases . \n Bug : 172400600 \n Bug : 171505922 \n Test : atest CtsNetTestCasesLatestSdk : NetworkCapabilitiesTest \n Change - Id : Ibc728c986ad6faeed78c631ca2675956b95c6ac1,228
"core \ java \ android \ net \ OemNetworkPreferences . java \n - * Prefer networks in order : NET _ CAPABILITY _ NOT _ METERED , NET _ CAPABILITY _ OEM _ PAID , default . \n + * If an unmetered network is available , use it . \n + * Otherwise , if a network with the OEM _ PAID capability is available , use it . \n + * Otherwise , use the general default network . \n - * Prefer networks in order : NET _ CAPABILITY _ NOT _ METERED , NET _ CAPABILITY _ OEM _ PAID . \n + * If an unmetered network is available , use it . \n + * Otherwise , if a network with the OEM _ PAID capability is available , use it . \n + * Otherwise , the app doesn ' t get a network . \n",Updating network preference comments \n Updating comments for network preferences to better clarify that \n preferences which include more than one network type will then rely on \n scoring to determine which of those networks are chosen . \n Bug : 171795464 \n Test : atest FrameworksNetTests \n Change - Id : I9eb5683f2cd69281bbee9fb70028d45f07720914,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - private void sendAllRequestsToProvider ( NetworkProviderInfo npi ) { \n + private void sendAllRequestsToProvider ( @ NonNull final NetworkProviderInfo npi ) { \n - for ( NetworkRequestInfo nri : mNetworkRequests . values ( ) ) { \n - if ( nri . request . isListen ( ) ) continue ; \n - NetworkAgentInfo nai = nri . getSatisfier ( ) ; \n - final int score ; \n - final int serial ; \n - if ( nai ! = null ) { \n - score = nai . getCurrentScore ( ) ; \n - serial = nai . factorySerialNumber ; \n - } else { \n - score = 0 ; \n - serial = NetworkProvider . ID _ NONE ; \n + for ( final NetworkRequestInfo nri : getNrisFromGlobalRequests ( ) ) { \n + for ( final NetworkRequest req : nri . mRequests ) { \n + if ( req . isListen ( ) & & nri . getActiveRequest ( ) = = req ) { \n + break ; \n + } \n + if ( req . isListen ( ) ) { \n + continue ; \n + } \n + / / Only set the nai for the request it is satisfying . \n + final NetworkAgentInfo nai = \n + nri . getActiveRequest ( ) = = req ? nri . getSatisfier ( ) : null ; \n + final int score ; \n + final int serial ; \n + if ( null ! = nai ) { \n + score = nai . getCurrentScore ( ) ; \n + serial = nai . factorySerialNumber ; \n + } else { \n + score = 0 ; \n + serial = NetworkProvider . ID _ NONE ; \n + } \n + npi . requestNetwork ( req , score , serial ) ; \n + / / For multilayer requests , don ' t send lower priority requests if a higher priority \n + / / request is already satisfied . \n + if ( null ! = nai ) { \n + break ; \n + } \n - npi . requestNetwork ( nri . request , score , serial ) ; \n",Update to sendAllRequestsToProvider for Multilayer \n Updates to ConnectivityService . sendAllRequestsToProvider to support \n Multilayer requests . \n Bug : 175051182 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest FrameworksNetIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : Id7a6175cee28d2de1f6194cd0fc8c739d667427d,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - return mRequest . request . requestId + "" : "" \n + return mRequest . mRequests . get ( 0 ) . requestId + "" : "" \n + ( null ! = mOldNetwork ? mOldNetwork . network . netId : "" null "" ) \n + "" → "" + ( null ! = mNewNetwork ? mNewNetwork . network . netId : "" null "" ) ; \n",Update toString ( ) to use the correct request \n Update ConnectivityService . NetworkReassignment # toString to use either \n the current satisfier ' s request otherwise highest priority request when \n executing toString ( ) . This is part of the mulilayered request changes . \n Bug : 173336774 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n Change - Id : Ibed6cdd4522133164b2b919f62ecc9411943f026,228
services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - private ArrayList < Integer > getSignalStrengthThresholds ( NetworkAgentInfo nai ) { \n + private ArrayList < Integer > getSignalStrengthThresholds ( @ NonNull final NetworkAgentInfo nai ) { \n - for ( NetworkRequestInfo nri : mNetworkRequests . values ( ) ) { \n - if ( nri . request . networkCapabilities . hasSignalStrength ( ) & & \n - nai . satisfiesImmutableCapabilitiesOf ( nri . request ) ) { \n - thresholds . add ( nri . request . networkCapabilities . getSignalStrength ( ) ) ; \n + for ( final NetworkRequestInfo nri : mNetworkRequests . values ( ) ) { \n + for ( final NetworkRequest req : nri . mRequests ) { \n + if ( req . networkCapabilities . hasSignalStrength ( ) \n + & & nai . satisfiesImmutableCapabilitiesOf ( req ) ) { \n + thresholds . add ( req . networkCapabilities . getSignalStrength ( ) ) ; \n + } \n,Update getSignalStrengthThresholds for multilayer \n Update ConnectivityService . getSignalStrengthThresholds so that \n thresholds are created for multilayer requests . \n Bug : 173650494 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest FrameworksNetIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : Ib3b9f52cf371efd1c7d9b176565c7ea8c46375f1,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + final NetworkRequest satisfiedRequest = nri . getSatisfiedRequest ( ) ; \n + int requestId = satisfiedRequest ! = null \n + ? satisfiedRequest . requestId : nri . mRequests . get ( 0 ) . requestId ; \n - "" % s % d ( % d ) on netId % d "" , action , nri . mUid , nri . request . requestId , net . getNetId ( ) ) ) ; \n + "" % s % d ( % d ) on netId % d "" , action , nri . mUid , requestId , net . getNetId ( ) ) ) ; \n",maybeLogBlockedStatusChanged multilayer requests \n Updating maybeLogBlockedStatusChanged logging so that it outputs the \n currently active request ' s information as part of the multilayared \n requests updates . \n Bug : 173145245 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n Change - Id : I68f364b457e0e5ac8f47df4a4356e4bc25360bca,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - int requestId = satisfiedRequest ! = null \n + final int requestId = satisfiedRequest ! = null \n - protected NetworkRequestInfo [ ] requestsSortedById ( ) { \n + NetworkRequestInfo [ ] requestsSortedById ( ) { \n - releaseNetworkRequest ( mRequests ) ; \n + releaseNetworkRequests ( mRequests ) ; \n - private void releaseNetworkRequest ( List < NetworkRequest > networkRequests ) { \n + private void releaseNetworkRequests ( List < NetworkRequest > networkRequests ) { \n tests \ net \ java \ com \ android \ server \ ConnectivityServiceTest . java \n - StringWriter stringWriter = new StringWriter ( ) ; \n + / / Filing a couple requests prior to testing the dump . \n + final TestNetworkCallback genericNetworkCallback = new TestNetworkCallback ( ) ; \n + final TestNetworkCallback wifiNetworkCallback = new TestNetworkCallback ( ) ; \n + final NetworkRequest genericRequest = new NetworkRequest . Builder ( ) \n + . clearCapabilities ( ) . build ( ) ; \n + final NetworkRequest wifiRequest = new NetworkRequest . Builder ( ) \n + . addTransportType ( TRANSPORT _ WIFI ) . build ( ) ; \n + mCm . registerNetworkCallback ( genericRequest , genericNetworkCallback ) ; \n + mCm . registerNetworkCallback ( wifiRequest , wifiNetworkCallback ) ; \n + final StringWriter stringWriter = new StringWriter ( ) ; \n - ConnectivityService . NetworkRequestInfo [ ] nriOutput = mService . requestsSortedById ( ) ; \n + final ConnectivityService . NetworkRequestInfo [ ] nriOutput = mService . requestsSortedById ( ) ; \n - boolean isRequestIdInOrder = \n + final boolean isRequestIdInOrder = \n","nits removing extra space , change method name , etc \n Minor cleanup as per nit comments on approved CLs in the relation chain . \n Namely : \n - removing an extranous space \n - changing requestsSortedById ( ) to be package private \n - changing releaseNetworkRequest ( ) name to releaseNetworkRequests ( ) \n - adding final in a couple spots \n - added some test requests in testDumpDoesNotCrash ( ) \n Bug : 173145245 \n Bug : 173292541 \n Bug : 173146509 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n Change - Id : I177ec6072a44acd247022b65b56e90cc231094b9",228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - / / request , we can return immediately . For multilayer requests , we have to check to see if \n - / / any of the multilayer requests may have a potential satisfier . \n + / / request , return immediately . For multilayer requests , check to see if any of the \n + / / multilayer requests may have a potential satisfier . \n + / / Connectivity Diagnostics are meant to be used with a single network request . It would be \n + / / confusing for these networks to change when an NRI is satisfied in another layer . \n + if ( nri . isMultilayerRequest ( ) ) { \n + throw new IllegalArgumentException ( "" Connectivity Diagnostics do not support multilayer "" \n + + "" network requests . "" ) ; \n + } \n + \n - if ( nai . satisfies ( nri . request ) ) { \n + / / Connectivity Diagnostics rejects multilayer requests at registration hence get ( 0 ) \n + if ( nai . satisfies ( nri . mRequests . get ( 0 ) ) ) { \n - if ( nai . satisfies ( nri . request ) ) { \n + / / Connectivity Diagnostics rejects multilayer requests at registration hence get ( 0 ) . \n + if ( nai . satisfies ( nri . mRequests . get ( 0 ) ) ) { \n",Update to Diagnostic Callback flows for multilayer \n Updates to ConnectivityDiagnosticsCallback flows that directly accessed \n the NRI ' request ' member to now instead use mRequests . This will be done \n by first not allowing multilayer requests on registration of a \n connectivity diagnostic and then accessing the ' 0 ' index of mRequests . \n Bug : 174187714 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest FrameworksNetIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : Ida98036b70fa290a214ee23236bfd0aad08e90a3,228
tests \ net \ common \ java \ android \ net \ OemNetworkPreferencesTest . java \n + import android . os . Build ; \n + import com . android . testutils . DevSdkIgnoreRule . IgnoreUpTo ; \n + \n + @ IgnoreUpTo ( Build . VERSION _ CODES . R ) \n,Adding @ IgnoreUpTo to OemNetworkPreferencesTest \n Adding @ IgnoreUpTo to OemNetworkPreferencesTest so that it can run as \n part of MTS . \n Bug : 174268969 \n Bug : 171505922 \n Test : atest FrameworksNetTests : android . net . OemNetworkPreferencesTest \n Change - Id : If7fb039c2cdb061f803c8a59e826e485e1f1c761,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + private void ensureAllNetworkRequestsHaveType ( List < NetworkRequest > requests ) { \n + for ( int i = 0 ; i < requests . size ( ) ; i + + ) { \n + ensureNetworkRequestHasType ( requests . get ( i ) ) ; \n + } \n + } \n + \n - ensureNetworkRequestHasType ( request ) ; \n + ensureAllNetworkRequestsHaveType ( mRequests ) ; \n - ensureNetworkRequestHasType ( request ) ; \n + ensureAllNetworkRequestsHaveType ( mRequests ) ; \n + private NetworkRequest getSatisfiedRequest ( ) { \n + if ( mSatisfier = = null ) { \n + return null ; \n + } \n + \n + for ( NetworkRequest req : mRequests ) { \n + if ( mSatisfier . isSatisfyingRequest ( req . requestId ) ) { \n + return req ; \n + } \n + } \n + \n + return null ; \n + } \n + @ Override \n - request + "" , "" + mBinder + "" ) "" ) ; \n - releaseNetworkRequest ( request ) ; \n + mRequests + "" , "" + mBinder + "" ) "" ) ; \n + releaseNetworkRequest ( mRequests ) ; \n + @ Override \n - return "" uid / pid : "" + mUid + "" / "" + mPid + "" "" + request \n + return "" uid / pid : "" + mUid + "" / "" + mPid + "" "" + mRequests \n + ( mPendingIntent = = null ? "" "" : "" to trigger "" + mPendingIntent ) ; \n + private void releaseNetworkRequest ( List < NetworkRequest > networkRequests ) { \n + for ( int i = 0 ; i < networkRequests . size ( ) ; i + + ) { \n + releaseNetworkRequest ( networkRequests . get ( i ) ) ; \n + } \n + } \n + \n","Allow a way to track the active request in an NRI \n As we are now allowing for multi - layered requests in NetworkRequestInfo \n ( NRI ) , we need a way to track which of those requests ended up being \n satisfied . This also includes updates to NetworkRequestInfo itself to \n support multilayared requests . \n Bug : 173146509 \n Bug : 171991028 \n Test : atest FrameworksNetTests \n atest FrameworksNetIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : I7bb5a564769c90928871fe28de05195c9cfae6b5 \n Change - Id : Ibf37f94b53eb2e833821553e00d76fe38bfea266",228
"packages \ Connectivity \ framework \ src \ android \ net \ ConnectivityManager . java \n - private void setOemNetworkPreference ( @ NonNull OemNetworkPreferences preference ) { \n - Log . d ( TAG , "" setOemNetworkPreference called with preference : "" \n - + preference . toString ( ) ) ; \n + private void setOemNetworkPreference ( @ NonNull final OemNetworkPreferences preference ) { \n + try { \n + mService . setOemNetworkPreference ( preference ) ; \n + } catch ( RemoteException e ) { \n + Log . e ( TAG , "" setOemNetworkPreference ( ) failed for preference : "" + preference . toString ( ) ) ; \n + throw e . rethrowFromSystemServer ( ) ; \n + } \n packages \ Connectivity \ framework \ src \ android \ net \ IConnectivityManager . aidl \n + import android . net . OemNetworkPreferences ; \n + \n + void setOemNetworkPreference ( in OemNetworkPreferences preference ) ; \n services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + import android . net . OemNetworkPreferences ; \n + \n + \n + @ Override \n + public void setOemNetworkPreference ( @ NonNull final OemNetworkPreferences preference ) { \n + / / TODO http : / / b / 176495594 track multiple default networks with networkPreferences \n + if ( DBG ) log ( "" setOemNetworkPreference ( ) called with : "" + preference . toString ( ) ) ; \n + } \n",Stubbed setOemNetworkPreference in Connectivity \n Stubbed setOemNetworkPreference ( ) in ConnectivityService and connected \n it to ConnectivityManager . \n Bug : 176495254 \n Bug : 176494815 \n Test : atest FrameworksNetTests \n atest FrameworksNetIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : Iabad7300a8b058e1edcb0defab8a031d21e6433c,228
tests \ net \ java \ com \ android \ server \ ConnectivityServiceTest . java \n + waitForIdle ( ) ; \n,Waiting for idle in test \n Waiting for idle in testRequestsSortedByIdSortsCorrectly to give it time \n to handle async operations as part of registering network callbacks . \n Bug : 177376544 \n Test : atest FrameworksNetTests : ConnectivityServiceTest # \n testRequestsSortedByIdSortsCorrectly - - rerun - until - failure 200 \n Change - Id : I268c4607d1a4c79e79f1385f014563cea0c2f979,228
"core \ api \ system - current . txt \n + field public static final String CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE = "" android . permission . CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE "" ; \n core \ res \ AndroidManifest . xml \n + < ! - - @ SystemApi @ hide Allows an application to manage an automotive device ' s application network \n + preference as it relates to OEM _ PAID and OEM _ PRIVATE capable networks . \n + < p > Not for use by third - party or privileged applications . - - > \n + < permission android : name = "" android . permission . CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE "" \n + android : protectionLevel = "" signature "" / > \n + \n packages \ Connectivity \ framework \ src \ android \ net \ ConnectivityManager . java \n + @ RequiresPermission ( android . Manifest . permission . CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE ) \n services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + private void enforceOemNetworkPreferencesPermission ( ) { \n + mContext . enforceCallingOrSelfPermission ( \n + android . Manifest . permission . CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE , \n + "" ConnectivityService "" ) ; \n + } \n + \n + \n + enforceOemNetworkPreferencesPermission ( ) ; \n - / / TODO http : / / b / 176496438 add permission check once permissions are added . \n tests \ net \ AndroidManifest . xml \n + < uses - permission android : name = "" android . permission . CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE "" / > \n",Adding permission for OEM managed preferences \n Adding CONTROL _ OEM _ PAID _ NETWORK _ PREFERENCE as a signature level \n permission to allow an application to control OEM managed network \n preferences . \n Bug : 176496438 \n Bug : 176494815 \n Test : atest FrameworksNetTests \n atest NetworkStackTests \n atest FrameworksNetIntegrationTests \n atest NetworkStackIntegrationTests \n atest CtsNetTestCasesLatestSdk \n Change - Id : Iee13e89f3931c7079c2d88cb57b249b1b1cf93ad \n Change - Id : Id29cafe1eaf5dff8a0605cb2579204d9c77b7e70,228
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - final NetworkRequestInfo nri = getNriForAppRequest ( request ) ; \n + / / Additionally , this lookup needs to be relatively fast ( hence the lookup optimization ) \n + / / to avoid potential race conditions when validating a package - > uid mapping when sending \n + / / the callback on the very low - chance that an application shuts down prior to the callback \n + / / being sent . \n + final NetworkRequestInfo nri = mNetworkRequests . get ( request ) ! = null \n + ? mNetworkRequests . get ( request ) : getNriForAppRequest ( request ) ; \n","Optimization when looking up requests for release \n Including an optimzation in handleReleaseNetworkRequest when \n looking up a request so that in the chance an app shuts down prior to \n the request being released , it doesn ' t cause errors when looking \n validating that apps uid - > package name . \n Bug : 178729499 \n Test : atest FrameworksNetTests \n atest ExtServicesUnitTests on CF and making sure no remote exceptions . \n Change - Id : I2c49511a1385b47fba075b2794685ae2bc80abba",228
services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - handleRemoveNetworkRequests ( mDefaultNetworkRequests ) ; \n + / / Pass in a defensive copy as this collection will be updated on remove . \n + handleRemoveNetworkRequests ( new ArraySet < > ( mDefaultNetworkRequests ) ) ; \n,Using defensive copy for default request remove \n Passing in a defensive copy for the default requests in \n ConnectivityService prior to updating that collection so as to not have \n issues when removing elements as part of the per - app preference update \n flow . \n Bug : 176494815 \n Bug : 178632672 \n Test : atest FrameworksNetTests \n atest FrameworksNetTests : com . android . server \n . ConnectivityServiceTest # testSetOemNetworkPreference \n ClearPreviousOemValues - - iterations \n Change - Id : Ia683d5035dda2be35fd2f2b7ee038e806caab6f9,228
"presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ metadata \ ShardCleaner . java \n + import org . apache . hadoop . fs . FileSystem ; \n - import org . apache . hadoop . fs . RawLocalFileSystem ; \n - import static com . facebook . presto . raptor . storage . LocalOrcDataEnvironment . tryGetLocalFileSystem ; \n - import static com . google . common . base . Preconditions . checkState ; \n - private final Optional < RawLocalFileSystem > localFileSystem ; \n + private final FileSystem fileSystem ; \n - this . localFileSystem = tryGetLocalFileSystem ( requireNonNull ( environment , "" environment is null "" ) ) ; \n - checkState ( ( ! backupStore . isPresent ( ) | | localFileSystem . isPresent ( ) ) , "" cannot support backup for remote file system "" ) ; \n + this . fileSystem = requireNonNull ( environment , "" environment is null "" ) . getFileSystem ( ) ; \n - localFileSystem . get ( ) . delete ( file , false ) ; \n + fileSystem . delete ( file , false ) ; \n",Fix ShardCleaner not running on HDFS \n ShardCleaner needs to clean up files even on HDFS .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ gen \ DereferenceCodeGenerator . java \n - int index = ( int ) ( ( ConstantExpression ) arguments . get ( 1 ) ) . getValue ( ) ; \n + int index = ( ( Number ) ( ( ConstantExpression ) arguments . get ( 1 ) ) . getValue ( ) ) . intValue ( ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ RowExpressionInterpreter . java \n - int index = ( int ) node . getArguments ( ) . get ( 1 ) . accept ( this , context ) ; \n + int index = ( ( Number ) node . getArguments ( ) . get ( 1 ) . accept ( this , context ) ) . intValue ( ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ relational \ SqlToRowExpressionTranslator . java \n - return specialForm ( DEREFERENCE , returnType , process ( node . getBase ( ) , context ) , constant ( index , INTEGER ) ) ; \n + return specialForm ( DEREFERENCE , returnType , process ( node . getBase ( ) , context ) , constant ( ( long ) index , INTEGER ) ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ TestRowExpressionSerde . java \n + @ Test \n + public void testDereference ( ) \n + { \n + String sql = "" CAST ( ROW ( 1 ) AS ROW ( col1 integer ) ) . col1 "" ; \n + RowExpression before = translate ( expression ( sql , new ParsingOptions ( AS _ DOUBLE ) ) , false ) ; \n + RowExpression after = getRoundTrip ( sql , false ) ; \n + assertEquals ( before , after ) ; \n + } \n + \n presto - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ AbstractTestQueries . java \n + assertQuery ( "" SELECT a FROM ( VALUES ROW ( CAST ( ROW ( 1 , 2 ) AS ROW ( col0 integer , col1 integer ) ) . col0 ) ) AS t ( a ) "" , "" SELECT 1 "" ) ; \n",Fix dereference passing long instead of integer as index \n A ConstantExpression should not be created with value and type mismatch . \n The index of a deference call is an integer but will be saved as long \n in the ConstantExpression .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ LiteralEncoder . java \n + import com . facebook . presto . spi . relation . RowExpression ; \n + import static com . facebook . presto . sql . relational . Expressions . constant ; \n + import static com . facebook . presto . sql . relational . Expressions . constantNull ; \n + / / Unlike toExpression , toRowExpression should be very straightforward given object is serializable \n + public static RowExpression toRowExpression ( Object object , Type type ) \n + { \n + requireNonNull ( type , "" type is null "" ) ; \n + \n + if ( object instanceof RowExpression ) { \n + return ( RowExpression ) object ; \n + } \n + \n + if ( object = = null ) { \n + return constantNull ( type ) ; \n + } \n + \n + return constant ( object , type ) ; \n + } \n + \n + @ Deprecated \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ RowExpressionInterpreter . java \n + import static com . facebook . presto . sql . planner . LiteralEncoder . toRowExpression ; \n - import static com . facebook . presto . sql . relational . Expressions . constant ; \n - import static com . facebook . presto . sql . relational . Expressions . constantNull ; \n - private RowExpression toRowExpression ( Object object , Type type ) \n - { \n - requireNonNull ( type , "" type is null "" ) ; \n - \n - if ( object = = null ) { \n - return constantNull ( type ) ; \n - } \n - if ( object instanceof RowExpression ) { \n - return ( RowExpression ) object ; \n - } \n - return constant ( object , type ) ; \n - } \n - \n",Introduce LiteralEncoder : : toRowExpression \n LiteralEncoder : : toRowExpression is the counterpart for \n LiteralEncoder : : toExpression,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ QueryPlanner . java \n - Optional . ofNullable ( frameStart ) , \n - Optional . ofNullable ( frameEnd ) ) ; \n + Optional . ofNullable ( frameStart ) . map ( Expression : : toString ) , \n + Optional . ofNullable ( frameEnd ) . map ( Expression : : toString ) ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ plan \ WindowNode . java \n - import com . facebook . presto . sql . tree . Expression ; \n - private final Optional < Expression > originalStartValue ; \n - private final Optional < Expression > originalEndValue ; \n + private final Optional < String > originalStartValue ; \n + private final Optional < String > originalEndValue ; \n - @ JsonProperty ( "" originalStartValue "" ) Optional < Expression > originalStartValue , \n - @ JsonProperty ( "" originalEndValue "" ) Optional < Expression > originalEndValue ) \n + @ JsonProperty ( "" originalStartValue "" ) Optional < String > originalStartValue , \n + @ JsonProperty ( "" originalEndValue "" ) Optional < String > originalEndValue ) \n - public Optional < Expression > getOriginalStartValue ( ) \n + public Optional < String > getOriginalStartValue ( ) \n - public Optional < Expression > getOriginalEndValue ( ) \n + public Optional < String > getOriginalEndValue ( ) \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ planner \ assertions \ WindowFrameProvider . java \n - originalStartValue , \n - originalEndValue ) ; \n + originalStartValue . map ( Expression : : toString ) , \n + originalEndValue . map ( Expression : : toString ) ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ planner \ iterative \ rule \ TestPruneWindowColumns . java \n + import com . facebook . presto . sql . tree . Expression ; \n - Optional . of ( startValue1 . toSymbolReference ( ) ) , \n - Optional . of ( endValue2 . toSymbolReference ( ) ) ) ) , \n + Optional . of ( startValue1 . toSymbolReference ( ) ) . map ( Expression : : toString ) , \n + Optional . of ( endValue2 . toSymbolReference ( ) ) . map ( Expression : : toString ) ) ) , \n - Optional . of ( startValue2 . toSymbolReference ( ) ) , \n - Optional . of ( endValue2 . toSymbolReference ( ) ) ) ) ) , \n + Optional . of ( startValue2 . toSymbolReference ( ) ) . map ( Expression : : toString ) , \n + Optional . of ( endValue2 . toSymbolReference ( ) ) . map ( Expression : : toString ) ) ) ) , \n",Replace WindowNode . Frame . Expression with String \n originalStartValue and originalEndValue are used only by plan printer . \n Replace them with string types .,232
presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ SymbolsExtractor . java \n + import com . facebook . presto . spi . relation . DefaultRowExpressionTraversalVisitor ; \n - import com . facebook . presto . sql . relational . DefaultRowExpressionTraversalVisitor ; \n rename from presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ relational \ DefaultRowExpressionTraversalVisitor . java \n rename to presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ relation \ DefaultRowExpressionTraversalVisitor . java \n - package com . facebook . presto . sql . relational ; \n - \n - import com . facebook . presto . spi . relation . CallExpression ; \n - import com . facebook . presto . spi . relation . ConstantExpression ; \n - import com . facebook . presto . spi . relation . InputReferenceExpression ; \n - import com . facebook . presto . spi . relation . LambdaDefinitionExpression ; \n - import com . facebook . presto . spi . relation . RowExpressionVisitor ; \n - import com . facebook . presto . spi . relation . SpecialFormExpression ; \n - import com . facebook . presto . spi . relation . VariableReferenceExpression ; \n + package com . facebook . presto . spi . relation ; \n,Move DefaultRowExpressionTraversalVisitor to SPI \n DefaultRowExpressionTraversalVisitor could be a generic helper .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ LocalExecutionPlanner . java \n - Type type = filterExpression . get ( ) . getType ( ) ; \n - Object value = new RowExpressionInterpreter ( filterExpression . get ( ) , metadata , session . toConnectorSession ( ) , true ) . optimize ( ) ; \n - if ( value instanceof RowExpression ) { \n - RowExpression optimizedFilter = ( RowExpression ) value ; \n - / / building channel info \n - optimizedFilter = SymbolToChannelTranslator . translate ( optimizedFilter , sourceLayout ) ; \n - filterExpression = Optional . of ( optimizedFilter ) ; \n - } \n - else { \n - / / TODO : theoretically value should either be true or false ; we could possibly optimized the execution based on this \n - filterExpression = Optional . of ( constant ( value , type ) ) ; \n - } \n + / / TODO : theoretically , filterExpression could be a constant value ( true or false ) after optimization ; we could possibly optimize the execution . \n + filterExpression = Optional . of ( bindChannels ( filterExpression . get ( ) , sourceLayout ) ) ; \n + / / TODO : migrate ` toRowExpression ` to ` bindChannels ` \n + private RowExpression bindChannels ( RowExpression expression , Map < Symbol , Integer > sourceLayout ) \n + { \n + Type type = expression . getType ( ) ; \n + Object value = new RowExpressionInterpreter ( expression , metadata , session . toConnectorSession ( ) , true ) . optimize ( ) ; \n + if ( value instanceof RowExpression ) { \n + RowExpression optimized = ( RowExpression ) value ; \n + / / building channel info \n + expression = SymbolToChannelTranslator . translate ( optimized , sourceLayout ) ; \n + } \n + else { \n + expression = constant ( value , type ) ; \n + } \n + return expression ; \n + } \n + \n",Extract bindChannels helper in LocalExecutionPlanner \n bindChannels is to replace toRowExpression in LocalExecutionPlanner . \n It generates channel info for expressions as well as optimizes them .,232
"presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ connector \ ConnectorMetadata . java \n - * @ apiNote This method is unstable and subject to change in the future . \n + * This method is unstable and subject to change in the future . \n + @ Experimental \n - * @ apiNote This method is unstable and subject to change in the future . \n + * This method is unstable and subject to change in the future . \n + @ Experimental \n presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ function \ FunctionHandle . java \n + import com . facebook . presto . spi . api . Experimental ; \n - * @ apiNote FunctionHandle is a unique handle to identify the function implementation from namespaces . \n - * However , currently it is still under changes , so please don ' t assume it is backward compatible . \n + * FunctionHandle is a unique handle to identify the function implementation from namespaces . \n + * However , currently it is still under changes , so please don ' t assume it is backward compatible . \n - \n + @ Experimental \n presto - spi \ src \ main \ java \ com \ facebook \ presto \ spi \ relation \ PredicateCompiler . java \n + import com . facebook . presto . spi . api . Experimental ; \n + \n - * @ apiNote An experimental API to allow Hive connector to implement smart \n + * An experimental API to allow Hive connector to implement smart \n + @ Experimental \n",Replace all apiNote with Experimental annotation in SPI \n apiNote is the legacy way to indicate an experimental interface . Replace \n the usage with new Experimental annotation .,232
presto - tpcds \ pom . xml \n - \n - < dependency > \n - < groupId > io . airlift < / groupId > \n - < artifactId > bytecode < / artifactId > \n - < scope > test < / scope > \n - < / dependency > \n,Remove unused bytecode dependency from presto - tpcds,232
"presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ storage \ OrcStorageManager . java \n + / / Raptor does not store time - related data types as they are in ORC . \n + / / They will be casted to BIGINT or INTEGER to avoid timezone conversion . \n + / / This is due to the historical reason of using the legacy ORC read / writer that does not support timestamp types . \n + / / In order to be consistent , we still enforce the conversion . \n + / / The following DEFAULT _ STORAGE _ TIMEZONE is not used by the optimized ORC read / writer given we never read / write timestamp types . \n + public static final DateTimeZone DEFAULT _ STORAGE _ TIMEZONE = UTC ; \n - OrcRecordReader recordReader = reader . createRecordReader ( includedColumns . build ( ) , predicate , UTC , systemMemoryUsage , INITIAL _ BATCH _ SIZE ) ; \n + OrcRecordReader recordReader = reader . createRecordReader ( includedColumns . build ( ) , predicate , DEFAULT _ STORAGE _ TIMEZONE , systemMemoryUsage , INITIAL _ BATCH _ SIZE ) ; \n",Use single source of truth for ORC timezone,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ FilterStatsCalculator . java \n + import static com . facebook . presto . sql . relational . Expressions . constantNull ; \n + import static com . facebook . presto . sql . tree . BooleanLiteral . FALSE _ LITERAL ; \n - OptionalDouble literal = doubleValueFromLiteral ( getType ( left ) , ( Literal ) right ) ; \n + Object literalValue = LiteralInterpreter . evaluate ( metadata , session . toConnectorSession ( ) , right ) ; \n + if ( literalValue = = null ) { \n + return visitBooleanLiteral ( FALSE _ LITERAL , null ) ; \n + } \n + OptionalDouble literal = toStatsRepresentation ( metadata , session , getType ( left ) , literalValue ) ; \n - \n - private OptionalDouble doubleValueFromLiteral ( Type type , Literal literal ) \n - { \n - Object literalValue = LiteralInterpreter . evaluate ( metadata , session . toConnectorSession ( ) , literal ) ; \n - return toStatsRepresentation ( metadata , session , type , literalValue ) ; \n - } \n - OptionalDouble literal = toStatsRepresentation ( metadata , session , right . getType ( ) , ( ( ConstantExpression ) right ) . getValue ( ) ) ; \n + Object rightValue = ( ( ConstantExpression ) right ) . getValue ( ) ; \n + if ( rightValue = = null ) { \n + return visitConstant ( constantNull ( BOOLEAN ) , null ) ; \n + } \n + OptionalDouble literal = toStatsRepresentation ( metadata , session , right . getType ( ) , rightValue ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ cost \ StatsUtil . java \n + import static java . util . Objects . requireNonNull ; \n + requireNonNull ( value , "" value is null "" ) ; \n + \n presto - main \ src \ test \ java \ com \ facebook \ presto \ cost \ TestFilterStatsCalculator . java \n + assertExpression ( "" x IN ( null ) "" ) . outputRowsCount ( 0 . 0 ) ; \n + \n",Handle inList with null for FilterStatsCalculator \n inList in FilterStatsCalculator will be translated into a disjunction of \n equals . Need to handle nulls for comparisons .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ ApplyConnectorOptimization . java \n - import com . facebook . presto . spi . ConnectorSession ; \n - ConnectorSession connectorSession = session . toConnectorSession ( ) ; \n - \n - newNode = optimizer . optimize ( newNode , connectorSession , symbolAllocator , idAllocator ) ; \n + newNode = optimizer . optimize ( newNode , session . toConnectorSession ( connectorId ) , symbolAllocator , idAllocator ) ; \n",Fix connector session creation in ApplyConnectorOptimization \n connector optimizers should take connector session for its own connector \n rather than a full connector session .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ connector \ ConnectorManager . java \n + public ConnectorPlanOptimizerManager getConnectorPlanOptimizerManager ( ) \n + { \n + return connectorPlanOptimizerManager ; \n + } \n + \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ PlanOptimizers . java \n + import com . facebook . presto . connector . ConnectorManager ; \n - ConnectorPlanOptimizerManager planOptimizerManager , \n + ConnectorManager connectorManager , \n - planOptimizerManager , \n + connectorManager . getConnectorPlanOptimizerManager ( ) , \n",Force ConnectorManager to load all optimizers before PlanOptimizers \n PlanOptimizers cannot be initialized without loading all connector \n optimizers .,232
presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ TranslateExpressions . java \n - / / TODO : finish all other PlanNodes that have Expression \n,Remove TODO in TranslateExpressions \n PlanNode has been completely migrated from Expression to RowExpression . \n The TODO is no longer needed .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ Serialization . java \n + / / for variable SerDe ; variable names might contain "" ( ) "" ; use angle brackets to avoid conflict \n + private static final char VARIABLE _ TYPE _ OPEN _ BRACKET = ' < ' ; \n + private static final char VARIABLE _ TYPE _ CLOSE _ BRACKET = ' > ' ; \n + \n - jsonGenerator . writeFieldName ( format ( "" % s ( % s ) "" , value . getName ( ) , value . getType ( ) ) ) ; \n + / / serialize variable as "" name < type > "" \n + jsonGenerator . writeFieldName ( format ( "" % s % s % s % s "" , value . getName ( ) , VARIABLE _ TYPE _ OPEN _ BRACKET , value . getType ( ) , VARIABLE _ TYPE _ CLOSE _ BRACKET ) ) ; \n - throws IOException \n - int p = key . indexOf ( "" ( "" ) ; \n - if ( p < = 0 | | key . charAt ( key . length ( ) - 1 ) ! = ' ) ' ) { \n - throw new IllegalArgumentException ( format ( "" Expect key to be of format ' name ( type ) ' , found % s "" , key ) ) ; \n + int p = key . indexOf ( VARIABLE _ TYPE _ OPEN _ BRACKET ) ; \n + if ( p < = 0 | | key . charAt ( key . length ( ) - 1 ) ! = VARIABLE _ TYPE _ CLOSE _ BRACKET ) { \n + throw new IllegalArgumentException ( format ( "" Expect key to be of format ' name < type > ' , found % s "" , key ) ) ; \n presto - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ AbstractTestQueries . java \n + assertQuery ( \n + "" WITH unioned AS ( SELECT 1 UNION ALL SELECT 2 ) SELECT * FROM unioned CROSS JOIN UNNEST ( ARRAY [ 3 ] ) steps ( step ) "" , \n + "" SELECT * FROM ( VALUES ( 1 , 3 ) , ( 2 , 3 ) ) "" ) ; \n","Fix variable expression serde \n Variables were serialized as "" name ( type ) "" . This conflicts with some \n special literal naming convention like "" $ literal $ array ( integer ) "" , which \n is a legit name . Fix this by using angle brackets "" name < type > "" .",232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ SymbolAllocator . java \n + import java . util . regex . Pattern ; \n + private static final Pattern DISALLOWED _ CHAR _ PATTERN = Pattern . compile ( "" [ ^ a - zA - Z0 - 9 _ \ \ - $ ] + "" ) ; \n + \n + / / remove special characters for other special serde \n + unique = DISALLOWED _ CHAR _ PATTERN . matcher ( unique ) . replaceAll ( "" _ "" ) ; \n","Prevent special serde conflict with symbol names \n Symbol names are created based on hints . If hints contain special \n characters , some specialized serde may fail . Remove special characters \n in symbols .",232
presto - raptor \ src \ test \ java \ com \ facebook \ presto \ raptor \ backup \ TestFileBackupStore . java \n + @ Test ( singleThreaded = true ) \n,Make TestFileBackupStore single threaded \n Make TestFileBackupStore single threaded to prevent long running test \n duration .,232
"presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ backup \ BackupManager . java \n + import org . apache . hadoop . fs . Path ; \n - public CompletableFuture < ? > submit ( UUID uuid , File source ) \n + public CompletableFuture < ? > submit ( UUID uuid , Path source ) \n - CompletableFuture < ? > future = runAsync ( new BackgroundBackup ( uuid , source ) , executorService ) ; \n + CompletableFuture < ? > future = runAsync ( new BackgroundBackup ( uuid , localFileSystem . pathToFile ( source ) ) , executorService ) ; \n presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ storage \ OrcStorageManager . java \n - getFutureValue ( backupManager . submit ( newShardUuid , localFileSystem . pathToFile ( output ) ) ) ; \n + getFutureValue ( backupManager . submit ( newShardUuid , output ) ) ; \n - File stagingFile = localFileSystem . pathToFile ( storageService . getStagingFile ( shardUuid ) ) ; \n + Path stagingFile = storageService . getStagingFile ( shardUuid ) ; \n - shards . add ( createShardInfo ( shardUuid , bucketNumber , stagingFile , nodes , rowCount , uncompressedSize ) ) ; \n + shards . add ( createShardInfo ( shardUuid , bucketNumber , localFileSystem . pathToFile ( stagingFile ) , nodes , rowCount , uncompressedSize ) ) ; \n presto - raptor \ src \ test \ java \ com \ facebook \ presto \ raptor \ backup \ TestBackupManager . java \n + import org . apache . hadoop . fs . Path ; \n - futures . add ( backupManager . submit ( uuids . get ( i ) , file ) ) ; \n + futures . add ( backupManager . submit ( uuids . get ( i ) , path ( file ) ) ) ; \n - backupManager . submit ( FAILURE _ UUID , file ) . get ( 1 , SECONDS ) ; \n + backupManager . submit ( FAILURE _ UUID , path ( file ) ) . get ( 1 , SECONDS ) ; \n - backupManager . submit ( CORRUPTION _ UUID , file ) . get ( 1 , SECONDS ) ; \n + backupManager . submit ( CORRUPTION _ UUID , path ( file ) ) . get ( 1 , SECONDS ) ; \n + private static Path path ( File file ) \n + { \n + return new Path ( file . toURI ( ) ) ; \n + } \n + \n",Update BackupManager : : submit to use HDFS path,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ LiteralInterpreter . java \n - return new SqlIntervalYearMonth ( ( int ) node . getValue ( ) ) ; \n + return new SqlIntervalYearMonth ( ( ( Long ) node . getValue ( ) ) . intValue ( ) ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ planner \ TestRowExpressionFormatter . java \n + import static com . facebook . presto . type . IntervalDayTimeType . INTERVAL _ DAY _ TIME ; \n + import static com . facebook . presto . type . IntervalYearMonthType . INTERVAL _ YEAR _ MONTH ; \n + / / interval \n + constantExpression = constant ( 24L , INTERVAL _ DAY _ TIME ) ; \n + assertEquals ( format ( constantExpression ) , "" INTERVAL DAY TO SECOND 0 00 : 00 : 00 . 024 "" ) ; \n + constantExpression = constant ( 25L , INTERVAL _ YEAR _ MONTH ) ; \n + assertEquals ( format ( constantExpression ) , "" INTERVAL YEAR TO MONTH 2 - 1 "" ) ; \n + \n","Fix long - to - int cast in LiteralInterpreter \n ConstantExpression takes long as its value for some numeric types . It \n should avoid direct cast to integers . The bug was introduced with the \n LiteralInterpreter but got exposed during the "" Assignment "" refactoring .",232
presto - orc \ src \ main \ java \ com \ facebook \ presto \ orc \ reader \ SliceDictionaryBatchStreamReader . java \n + currentDictionaryData = null ; \n + rowGroupDictionaryLength = null ; \n + dictionaryBlock = null ; \n,Clean up arrays in ORC dictionary after close \n Like all other array deallocation in the same class . Set them to null to \n enforce faster GC .,232
pom . xml \n - < version > 3 . 1 . 4 - 1 < / version > \n + < version > 3 . 6 . 0 - 1 < / version > \n,Bump up Cassandra driver version to 3 . 6 . 0 - 1,232
"presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ RaptorModule . java \n - binder . bind ( RaptorMetadataFactory . class ) . in ( Scopes . SINGLETON ) ; \n - binder . bind ( RaptorTableProperties . class ) . in ( Scopes . SINGLETON ) ; \n presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ metadata \ DatabaseMetadataModule . java \n + import com . facebook . presto . raptor . RaptorMetadataFactory ; \n + import com . facebook . presto . raptor . RaptorTableProperties ; \n - protected void setup ( Binder ignored ) \n + protected void setup ( Binder binder ) \n - binder - > { \n + innerBinder - > { \n - bindDaoSupplier ( binder , ShardDao . class , MySqlShardDao . class ) ; \n + bindDaoSupplier ( innerBinder , ShardDao . class , MySqlShardDao . class ) ; \n - binder - > { \n + innerBinder - > { \n + \n + binder . bind ( RaptorMetadataFactory . class ) . in ( Scopes . SINGLETON ) ; \n + binder . bind ( RaptorTableProperties . class ) . in ( Scopes . SINGLETON ) ; \n",Move Raptor metadata related singletons to metastore module,232
"presto - raptor \ src \ test \ java \ com \ facebook \ presto \ raptor \ integration \ TestRaptorIntegrationSmokeTestMySql . java \n + . put ( "" raptor . startup - grace - period "" , "" 10s "" ) \n",Lower startup - grace - period for TestRaptorIntegrationSmokeTestMySql \n TestRaptorIntegrationSmokeTestMySql is flaky due to long startup grace \n period . Lower it to 10 seconds .,232
presto - raptor \ src \ test \ java \ com \ facebook \ presto \ raptor \ integration \ TestRaptorIntegrationSmokeTestMySql . java \n - @ Test \n + @ Test ( singleThreaded = true ) \n,"Make TestRaptorIntegrationSmokeTestMySql single threaded \n Multiple tests running in TestRaptorIntegrationSmokeTestMySql can cause \n MySQL deadlock . This is expected as different transactions can hold \n locks in different orders . In production , this can also happen but with \n less concern as we do not expect multiple write operations happening to \n the same table .",232
presto - raptor \ src \ main \ java \ com \ facebook \ presto \ raptor \ filesystem \ HdfsModule . java \n - import com . facebook . airlift . configuration . AbstractConfigurationAwareModule ; \n + import com . google . inject . Module ; \n - extends AbstractConfigurationAwareModule \n + implements Module \n - public void setup ( Binder binder ) \n + public void configure ( Binder binder ) \n - CacheConfig cacheConfig = buildConfigObject ( CacheConfig . class ) ; \n - if ( cacheConfig . getBaseDirectory ( ) ! = null ) { \n - binder . bind ( CacheStats . class ) . in ( Scopes . SINGLETON ) ; \n - newExporter ( binder ) . export ( CacheStats . class ) . withGeneratedName ( ) ; \n + configBinder ( binder ) . bindConfig ( CacheConfig . class ) ; \n + binder . bind ( CacheStats . class ) . in ( Scopes . SINGLETON ) ; \n + newExporter ( binder ) . export ( CacheStats . class ) . withGeneratedName ( ) ; \n - binder . bind ( RaptorHdfsConfiguration . class ) . annotatedWith ( ForCachingFileSystem . class ) . to ( RaptorHiveHdfsConfiguration . class ) . in ( Scopes . SINGLETON ) ; \n - binder . bind ( RaptorHdfsConfiguration . class ) . to ( RaptorCachingHdfsConfiguration . class ) . in ( Scopes . SINGLETON ) ; \n - } \n - else { \n - binder . bind ( RaptorHdfsConfiguration . class ) . to ( RaptorHiveHdfsConfiguration . class ) . in ( Scopes . SINGLETON ) ; \n - } \n + binder . bind ( RaptorHdfsConfiguration . class ) . annotatedWith ( ForCachingFileSystem . class ) . to ( RaptorHiveHdfsConfiguration . class ) . in ( Scopes . SINGLETON ) ; \n + binder . bind ( RaptorHdfsConfiguration . class ) . to ( RaptorCachingHdfsConfiguration . class ) . in ( Scopes . SINGLETON ) ; \n,Inject cache manager for Raptor HdfsModule with provider,232
"presto - mongodb \ pom . xml \n - < netty . version > 4 . 0 . 32 . Final < / netty . version > \n + < exclusions > \n + < exclusion > \n + < groupId > io . netty < / groupId > \n + < artifactId > * < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < exclusions > \n + < exclusion > \n + < groupId > io . netty < / groupId > \n + < artifactId > * < / artifactId > \n + < / exclusion > \n + < / exclusions > \n - \n - < dependency > \n - < groupId > io . netty < / groupId > \n - < artifactId > netty - transport < / artifactId > \n - < version > $ { netty . version } < / version > \n - < scope > test < / scope > \n - < / dependency > \n presto - mongodb \ src \ test \ java \ com \ facebook \ presto \ mongodb \ SyncMemoryBackend . java \n - import io . netty . channel . Channel ; \n - import org . bson . BSONObject ; \n - \n - @ Override \n - public synchronized BSONObject handleCommand ( Channel channel , String command , BSONObject query ) \n - throws MongoServerException \n - { \n - return super . handleCommand ( channel , command , query ) ; \n - } \n",Remove netty dependency from presto - mongodb \n SyncMemoryBackend : : handleCommand does not override parent method . Remove \n the implementation to avoid netty dependency .,232
"presto - benchto - benchmarks \ src \ test \ resources \ sql \ presto \ tpcds \ q76 . plan . txt \n - remote exchange ( REPARTITION , HASH , [ d _ qoy , d _ year , expr _ 12 , expr _ 217 , i _ category ] ) \n - partial aggregation over ( d _ qoy , d _ year , expr _ 12 , expr _ 217 , i _ category ) \n + remote exchange ( REPARTITION , HASH , [ cast , d _ qoy , d _ year , expr _ 12 , i _ category ] ) \n + partial aggregation over ( cast , d _ qoy , d _ year , expr _ 12 , i _ category ) \n - remote exchange ( REPARTITION , HASH , [ d _ qoy _ 49 , d _ year _ 45 , expr _ 223 , expr _ 68 , i _ category _ 29 ] ) \n - partial aggregation over ( d _ qoy _ 49 , d _ year _ 45 , expr _ 223 , expr _ 68 , i _ category _ 29 ) \n + remote exchange ( REPARTITION , HASH , [ cast _ 222 , d _ qoy _ 49 , d _ year _ 45 , expr _ 68 , i _ category _ 29 ] ) \n + partial aggregation over ( cast _ 222 , d _ qoy _ 49 , d _ year _ 45 , expr _ 68 , i _ category _ 29 ) \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ PlanOptimizers . java \n - new PushAggregationThroughOuterJoin ( metadata . getFunctionManager ( ) ) ) ) , \n - inlineProjections , \n - simplifyOptimizer , / / Re - run the SimplifyExpressions to simplify any recomposed expressions from other optimizations \n - projectionPushDown , \n - new UnaliasSymbolReferences ( metadata . getFunctionManager ( ) ) , / / Run again because predicate pushdown and projection pushdown might add more projections \n - new PruneUnreferencedOutputs ( ) ) ; / / Make sure to run this before index join . Filtered projections may not have all the columns . \n + new PushAggregationThroughOuterJoin ( metadata . getFunctionManager ( ) ) ) ) ) ; \n + inlineProjections , \n + simplifyRowExpressionOptimizer , / / Re - run the SimplifyExpressions to simplify any recomposed expressions from other optimizations \n + projectionPushDown , \n + new UnaliasSymbolReferences ( metadata . getFunctionManager ( ) ) , / / Run again because predicate pushdown and projection pushdown might add more projections \n + new PruneUnreferencedOutputs ( ) , / / Make sure to run this before index join . Filtered projections may not have all the columns . \n",Move TranslateExpressions below PushAggregationThroughOuterJoin \n The patch also alters the variable names in TestTpcdsCostBasedPlan as \n variable allocator assign names to variables based on function name \n hints . This causes assignment variables have function name hints before \n got inlined with projections .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ NullabilityAnalyzer . java \n + break ; \n + break ; \n + default : \n + / / no - op \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ planner \ TestLogicalPlanner . java \n - / / cast function cannot be optimized on coordinator ; it will only be optimized on workers \n - "" l _ comment = ' 42 ' and ' 42 ' = cast ( l _ comment as varchar ) "" , \n + "" l _ comment = ' 42 ' "" , \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ planner \ TestNullabilityAnalyzer . java \n - / / TODO following two tests should return false but we are not yet smart enough to infer it . \n + / / TODO following test should return false but we are not yet smart enough to infer it . \n - assertNullability ( "" CAST ( ' 123 ' AS VARCHAR ) "" , true ) ; \n + \n + assertNullability ( "" CAST ( ' 123 ' AS VARCHAR ) "" , false ) ; \n",Fix NullabilityAnalyzer for RowExpression \n The swtich / case forgot to break .,232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ buffer \ PageSplitterUtil . java \n - / / if the size of the page doesn ' t improve from the previous call we terminate the recursion . \n - if ( page . getSizeInBytes ( ) = = previousPageSize | | page . getSizeInBytes ( ) < = maxPageSizeInBytes | | page . getPositionCount ( ) = = 1 ) { \n + / / if the size of the page doesn ' t improve too much from the previous call we terminate the recursion . \n + if ( page . getSizeInBytes ( ) > previousPageSize * 0 . 9 | | page . getSizeInBytes ( ) < = maxPageSizeInBytes | | page . getPositionCount ( ) = = 1 ) { \n presto - main \ src \ test \ java \ com \ facebook \ presto \ execution \ TestPageSplitterUtil . java \n + import com . facebook . presto . common . block . DictionaryBlock ; \n + import io . airlift . slice . Slices ; \n + import static com . facebook . presto . block . BlockAssertions . createRandomDictionaryBlock ; \n + import static com . facebook . presto . block . BlockAssertions . createSlicesBlock ; \n + \n + @ Test \n + public void testSplitDictionaryBlock ( ) \n + { \n + / / create a huge dictionary with a single entry \n + Block dictionary = createSlicesBlock ( Slices . utf8Slice ( new String ( new char [ 1 _ 000 _ 000 ] ) ) ) ; \n + \n + / / make every row in the block identical to the single entry in the dictionary \n + DictionaryBlock dictionaryBlock = createRandomDictionaryBlock ( dictionary , 50000 ) ; \n + \n + List < Page > pages = splitPage ( new Page ( dictionaryBlock ) , 1000 ) ; \n + assertEquals ( pages . size ( ) , 2 ) ; \n + } \n","Fix page splitter creating large dictionary page list \n Page splitter does not work well for dictionary blocks . When a split \n happens on a dictionary block , the dictionary will be shallow copied \n into the two split pages . Both these two pages will still be large \n because of the dictionary . Recursion will continue until there is one \n row per page and a large dictionary in each split page . The fix is to \n stop splitting once we do not see enough improvement after a split .",232
"presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ RowExpressionInterpreter . java \n - checkState ( ( resolution . isCastFunction ( ( ( CallExpression ) possibleCompiledPattern ) . getFunctionHandle ( ) ) ) ) ; \n - possibleCompiledPattern = functionInvoker . invoke ( ( ( CallExpression ) possibleCompiledPattern ) . getFunctionHandle ( ) , session , nonCompiledPattern ) ; \n + \n + checkState ( possibleCompiledPattern instanceof CallExpression ) ; \n + / / this corresponds to ExpressionInterpreter : : getConstantPattern \n + if ( hasEscape ) { \n + / / like _ pattern ( pattern , escape ) \n + possibleCompiledPattern = functionInvoker . invoke ( ( ( CallExpression ) possibleCompiledPattern ) . getFunctionHandle ( ) , session , nonCompiledPattern , escape ) ; \n + } \n + else { \n + / / like _ pattern ( pattern ) \n + possibleCompiledPattern = functionInvoker . invoke ( ( ( CallExpression ) possibleCompiledPattern ) . getFunctionHandle ( ) , session , nonCompiledPattern ) ; \n + } \n + \n + checkState ( possibleCompiledPattern instanceof Regex , "" unexpected like pattern type "" + possibleCompiledPattern . getClass ( ) ) ; \n presto - main \ src \ test \ java \ com \ facebook \ presto \ sql \ TestExpressionInterpreter . java \n + \n + assertRowExpressionEquals ( SERIALIZABLE , "" ' % ' LIKE ' z % ' ESCAPE ' z ' "" , "" true "" ) ; \n + assertRowExpressionEquals ( SERIALIZABLE , "" ' % ' LIKE ' z % ' "" , "" false "" ) ; \n - assertRowExpressionOptimizedEquals ( \n + assertRowExpressionEquals ( \n - assertRowExpressionOptimizedEquals ( \n + assertRowExpressionEquals ( \n - assertRowExpressionOptimizedEquals ( \n + assertRowExpressionEquals ( \n - private static void assertRowExpressionOptimizedEquals ( Level level , @ Language ( "" SQL "" ) String actual , @ Language ( "" SQL "" ) String expected ) \n + private static void assertRowExpressionEquals ( Level level , @ Language ( "" SQL "" ) String actual , @ Language ( "" SQL "" ) String expected ) \n","Fix like pattern interpretation \n like pattern constant folding happens only when the optimization level \n is above SERIALIZABLE . However , RowExpressionInterpreter : : tryHandleLike \n handles like function in a way that it will take the constant folded \n like pattern result together with the original arguments . Under such \n case , tryHandleLike expects the given constant folded like pattern \n should always be a compiled Regex but is not in the above case . \n The patch relaxes the restriction on the like pattern to be more \n generic . As long as the return type is Regex , tryHandleLike should be \n able to handle it .",232
pom . xml \n + < dependency > \n + < groupId > org . apache . hudi < / groupId > \n + < artifactId > hudi - hadoop - mr < / artifactId > \n + < version > 0 . 5 . 1 - incubating < / version > \n + < exclusions > \n + < exclusion > \n + < groupId > org . objenesis < / groupId > \n + < artifactId > objenesis < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > commons - logging < / groupId > \n + < artifactId > commons - logging < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . slf4j < / groupId > \n + < artifactId > jcl - over - slf4j < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . apache . httpcomponents < / groupId > \n + < artifactId > httpclient < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < / dependency > \n + \n presto - hive \ pom . xml \n - < version > 0 . 5 . 1 - incubating < / version > \n - < exclusions > \n - < exclusion > \n - < groupId > org . objenesis < / groupId > \n - < artifactId > objenesis < / artifactId > \n - < / exclusion > \n - < exclusion > \n - < groupId > commons - logging < / groupId > \n - < artifactId > commons - logging < / artifactId > \n - < / exclusion > \n - < exclusion > \n - < groupId > org . slf4j < / groupId > \n - < artifactId > jcl - over - slf4j < / artifactId > \n - < / exclusion > \n - < / exclusions > \n,Strip httpcomponents dependency from Hudi \n Also move depenendency declaration to the root pom . xml,232
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ actions \ TimeThrottleIntegrationTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65176 "" ) \n",Mute TimeThrottleIntegrationTests . testTimeThrottle ( # 65844 ) \n This test is failing on master in CI occasionally . This change mutes \n the test to stop the noise until it can be looked at again . \n Relates # 65176,240
"client \ rest - high - level \ src \ test \ java \ org \ elasticsearch \ client \ IndicesClientIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 60461 "" ) \n",Mute IndicesClientIT . testDataStreams ( # 65856 ) \n This commit mutes IndicesClientIT . testDataStreams as this test is \n failing in CI intermittently . \n Relates # 60746 \n Relates # 60461,240
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryTemplateIndexActionMappingsTests . java \n + import org . apache . lucene . util . LuceneTestCase . AwaitsFix ; \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65091 "" ) \n",Mute HistoryTemplateIndexActionMappingsTests ( # 65860 ) \n HistoryTemplateIndexActionMappingsTests testIndexActionFields has been \n failing in CI . This commit mutes the test . \n Relates # 65091,240
"qa \ mixed - cluster \ src \ test \ java \ org \ elasticsearch \ backwards \ IndexingIT . java \n + import static org . hamcrest . Matchers . oneOf ; \n - contains ( "" Synced flush is deprecated and will be removed in 8 . 0 . Use flush at _ / flush or / { index } / _ flush instead . "" ) ) ; \n + contains ( \n + oneOf ( "" Synced flush is deprecated and will be removed in 8 . 0 . Use flush at _ / flush or / { index } / _ flush instead . "" , \n + "" Synced flush is deprecated and will be removed in 8 . 0 . Use flush at / _ flush or / { index } / _ flush instead . "" ) \n + ) ) ; \n test \ framework \ src \ main \ java \ org \ elasticsearch \ test \ rest \ ESRestTestCase . java \n + final List < String > fixedDeprecationMessages = List . of ( \n + "" Synced flush is deprecated and will be removed in 8 . 0 . Use flush at / _ flush or / { index } / _ flush instead . "" ) ; \n - warningsHandler = warnings - > warnings . equals ( deprecationMessages ) = = false & & warnings . equals ( transitionMessages ) = = false ; \n + warningsHandler = warnings - > warnings . equals ( deprecationMessages ) = = false & & warnings . equals ( transitionMessages ) = = false & & \n + warnings . equals ( fixedDeprecationMessages ) = = false ; \n",Update deprecation messages for synced flush ( # 66181 ) \n This commit updates the deprecation messages that are expected on \n master to account for the change to the synced flush deprecation \n message that was modified in # 66130 .,240
"x - pack \ plugin \ watcher \ src \ test \ java \ org \ elasticsearch \ xpack \ watcher \ support \ WatcherUtilsTests . java \n + import static org . elasticsearch . xpack . watcher . support . search . WatcherSearchTemplateRequest . DEFAULT _ INDICES _ OPTIONS ; \n - randomBoolean ( ) , WatcherSearchTemplateRequest . DEFAULT _ INDICES _ OPTIONS ) ; \n + randomBoolean ( ) , randomBoolean ( ) , DEFAULT _ INDICES _ OPTIONS . allowAliasesToMultipleIndices ( ) , \n + DEFAULT _ INDICES _ OPTIONS . forbidClosedIndices ( ) , DEFAULT _ INDICES _ OPTIONS . ignoreAliases ( ) , \n + DEFAULT _ INDICES _ OPTIONS . ignoreThrottled ( ) ) ; \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65397 "" ) \n - IndicesOptions indicesOptions = WatcherSearchTemplateRequest . DEFAULT _ INDICES _ OPTIONS ; \n + IndicesOptions indicesOptions = DEFAULT _ INDICES _ OPTIONS ; \n - randomBoolean ( ) , WatcherSearchTemplateRequest . DEFAULT _ INDICES _ OPTIONS ) ; \n - builder . startObject ( "" indices _ options "" ) \n - . field ( "" allow _ no _ indices "" , indicesOptions . allowNoIndices ( ) ) \n - . field ( "" expand _ wildcards "" , indicesOptions . expandWildcardsClosed ( ) & & indicesOptions . expandWildcardsOpen ( ) ? "" all "" : \n - indicesOptions . expandWildcardsClosed ( ) ? "" closed "" : \n - indicesOptions . expandWildcardsOpen ( ) ? "" open "" : \n - "" none "" ) \n - . field ( "" ignore _ unavailable "" , indicesOptions . ignoreUnavailable ( ) ) \n - . endObject ( ) ; \n + randomBoolean ( ) , randomBoolean ( ) , indicesOptions . allowAliasesToMultipleIndices ( ) , \n + indicesOptions . forbidClosedIndices ( ) , indicesOptions . ignoreAliases ( ) , indicesOptions . ignoreThrottled ( ) ) ; \n + builder . startObject ( "" indices _ options "" ) ; \n + indicesOptions . toXContent ( builder , ToXContent . EMPTY _ PARAMS ) ; \n + builder . endObject ( ) ; \n - \n","Fix watcher search template test after # 65332 ( # 65379 ) \n In # 65332 , the serialization of the WatcherSearchTemplateRequest class \n changed to use IndicesOptions built in XContent facilities . This had \n the side effect of fixing the handling of ` all ` for ` expand _ wildcards ` \n to include hidden indices . However , the tests in WatcherUtilsTests were \n missed . This change updates those tests . \n Co - authored - by : Martijn van Groningen < martijn . v . groningen @ gmail . com >",240
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ api \ indices . stats . json \n - "" suggest "" , \n - "" suggest "" , \n - "" description "" : "" A comma - separated list of fields for ` fielddata ` and ` suggest ` index metric ( supports wildcards ) "" \n + "" description "" : "" A comma - separated list of fields for the ` completion ` index metric ( supports wildcards ) "" \n - "" description "" : "" A comma - separated list of fields for ` fielddata ` index metric ( supports wildcards ) "" \n + "" description "" : "" A comma - separated list of fields for the ` fielddata ` index metric ( supports wildcards ) "" \n rest - api - spec \ src \ main \ resources \ rest - api - spec \ api \ nodes . stats . json \n - "" suggest "" , \n - "" suggest "" , \n - "" description "" : "" A comma - separated list of fields for ` fielddata ` and ` suggest ` index metric ( supports wildcards ) "" \n + "" description "" : "" A comma - separated list of fields for the ` completion ` index metric ( supports wildcards ) "" \n - "" description "" : "" A comma - separated list of fields for ` fielddata ` index metric ( supports wildcards ) "" \n + "" description "" : "" A comma - separated list of fields for the ` fielddata ` index metric ( supports wildcards ) "" \n",Remove suggest reference in some API specs ( # 66180 ) \n This commit removes the reference to the suggest index metric in the \n nodes stats and indices stats rest api spec files . Suggest has been \n removed so it is no longer correct to have it in these files . \n Closes # 43407,240
"x - pack \ plugin \ watcher \ qa \ rest \ src \ yamlRestTest \ resources \ rest - api - spec \ test \ watcher \ put _ watch \ 92 _ put _ watch _ with _ indices _ options . yml \n - - - \n - skip : \n - version : "" 7 . 10 . 1 - 7 . 99 . 99 "" \n - reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 "" \n + version : "" 7 . 10 . 1 - 7 . 10 . 2 "" \n + reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 and 7 . 10 . 2 "" \n - do : \n - - - \n - skip : \n - version : "" 7 . 10 . 1 - 7 . 99 . 99 "" \n - reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 "" \n + version : "" 7 . 10 . 1 - 7 . 10 . 2 "" \n + reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 and 7 . 10 . 2 "" \n - do : \n - - - \n - skip : \n - version : "" 7 . 10 . 1 - 7 . 99 . 99 "" \n - reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 "" \n + version : "" 7 . 10 . 1 - 7 . 10 . 2 "" \n + reason : "" watch parsing with partial indices options was broken in 7 . 10 . 1 and 7 . 10 . 2 "" \n - do : \n",Update watcher test skip versions after # 68076 ( # 68154 ) \n This commit updates the skip versions used in tests that put watches \n with partial indices options to only skip 7 . 10 . 1 and 7 . 10 . 2 now that \n the fix has been backported .,240
core \ res \ OWNERS \n + juliacr @ google . com \n,Add juliacr @ to core / res / OWNERS \n Change - Id : I1fb6814dc965158f23a3c6453ce6f7eb61445e53,241
core \ java \ android \ view \ OWNERS \n + # Notifications \n + per - file Notification * . java = file : / services / core / java / com / android / server / notification / OWNERS \n + \n,Add SystemUI owners NotificationHeaderView and NotificationTopLineView \n Change - Id : I3164c8562a193bd5f352040d496707df03cd1ca6,241
core \ java \ android \ provider \ OWNERS \n + per - file * Settings * = file : / packages / SettingsProvider / OWNERS \n packages \ SettingsProvider \ OWNERS \n + hackbod @ android . com \n,Add SettingsProvider team as OWNERS of android . provider . Settings \n Change - Id : Ifa4a11780bb934f7b644ad150f3c09493b23f9f4,241
core \ java \ com \ android \ internal \ widget \ OWNERS \n + \n + # Notification related \n + per - file * Notification * = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file * Messaging * = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file * Message * = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file * Conversation * = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file * ImageResolver * = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file CallLayout . java = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file CachingIconView . java = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file ImageFloatingTextView . java = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file ObservableTextView . java = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file RemeasuringLinearLayout . java = file : / services / core / java / com / android / server / notification / OWNERS \n + per - file ViewClippingUtil . java = file : / services / core / java / com / android / server / notification / OWNERS \n,Add core notifications team as owners of internal notification widgets . \n Change - Id : Ie1a8e61f8c250340083940af866552e0d15851dd,241
core \ java \ com \ android \ internal \ widget \ OWNERS \n + per - file * People * = file : / services / core / java / com / android / server / notification / OWNERS \n,Add People widgets to those owned by System UI Notifications team \n Change - Id : I15afb8f80a3d067af522707748a5b07c015af138,241
core \ java \ android \ util \ OWNERS \n + \n + per - file TypedValue . java = file : / core / java / android / content / res / OWNERS \n + per - file AttributeSet . java = file : / core / java / android / content / res / OWNERS \n,Add ' Android Resources ' team as OWNERS of classes in android . util \n Change - Id : If56558ebc4733b8266c231385fab4fb6b9316976,241
"new file \n dubbo - compatible \ README . md \n + # # # dubbo - compatible \n + \n + Hi , all \n + \n + From 2 . 7 . x , ` Dubbo ` has renamed package to ` org . apache . dubbo ` , so ` dubbo - compatible ` module is provided . \n + \n + For compatibility with older versions , we provider the following most popular APIs ( classes / interfaces ) : \n + \n + * com . alibaba . dubbo . rpc . Filter / Invocation / Invoker / Result / RpcContext / RpcException \n + * com . alibaba . dubbo . config . annotation . Reference / Service \n + * com . alibaba . dubbo . config . spring . context . annotation . EnableDubbo \n + * com . alibaba . dubbo . common . Constants / URL \n + * com . alibaba . dubbo . common . extension . ExtensionFactory \n + * com . alibaba . dubbo . common . serialize . Serialization / ObjectInput / ObjectOutput \n + * com . alibaba . dubbo . cache . CacheFactory / Cache \n + * com . alibaba . dubbo . rpc . service . EchoService / GenericService \n + \n + The above APIs work fine with some unit tests in the test root . \n + \n + Except these APIs , others provided in ` dubbo - compatible ` are just bridge APIs without any unit tests , they may work with wrong . If you have any demand for them , you could : \n + \n + * Implement your own extensions with new APIs . ( RECOMMENDED ) \n + * Follow ` com . alibaba . dubbo . rpc . Filter ` to implement bridge APIs , and then contribute to community . \n + * Open issue on github . \n + \n + By the way , We will remove this module some day , so it ' s recommended that implementing your extensions with new APIs at the right time . \n + \n + Now we need your help : Any other popular APIs are missing ? \n + \n + For compatible module , any suggestions are welcome . Thanks . \n",add README for compatible module ( # 2019 ),245
dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ extension \ Activate . java \n + @ Deprecated \n + @ Deprecated \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ Activate . java \n + * Deprecated since 2 . 7 . 0 \n + @ Deprecated \n + * Deprecated since 2 . 7 . 0 \n + @ Deprecated \n,deprecated unused method for Activate # 2180 ( # 2193 ),245
rename from all \ pom . xml \n rename to dubbo - all \ pom . xml \n rename from bom \ pom . xml \n rename to dubbo - bom \ pom . xml \n rename from dependencies - bom \ pom . xml \n rename to dubbo - dependencies - bom \ pom . xml \n rename from distribution \ pom . xml \n rename to dubbo - distribution \ pom . xml \n rename from distribution \ src \ assembly \ bin - release . xml \n rename to dubbo - distribution \ src \ assembly \ bin - release . xml \n rename from distribution \ src \ assembly \ source - release . xml \n rename to dubbo - distribution \ src \ assembly \ source - release . xml \n pom . xml \n + < module > dubbo - metrics < / module > \n - < module > dependencies - bom < / module > \n - < module > bom < / module > \n - < module > all < / module > \n - < module > distribution < / module > \n - < module > dubbo - metrics < / module > \n + < module > dubbo - dependencies - bom < / module > \n + < module > dubbo - bom < / module > \n + < module > dubbo - all < / module > \n + < module > dubbo - distribution < / module > \n,Uniform module directory names ( # 2214 ),245
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ Version . java \n - / / Dubbo RPC protocol version \n - public static final String DEFAULT _ DUBBO _ PROTOCOL _ VERSION = "" 2 . 0 . 2 "" ; \n + / / Dubbo RPC protocol version , for compatibility , it must not be between 2 . 0 . 10 ~ 2 . 6 . 2 \n + public static final String DEFAULT _ DUBBO _ PROTOCOL _ VERSION = "" 2 . 0 . 1 "" ; \n - private static final int LOWEST _ VERSION _ FOR _ RESPONSE _ ATTATCHMENT = 202 ; / / 2 . 0 . 2 \n + private static final int LOWEST _ VERSION _ FOR _ RESPONSE _ ATTATCHMENT = 20001 ; / / 2 . 0 . 1 \n - return getIntVersion ( version ) > = LOWEST _ VERSION _ FOR _ RESPONSE _ ATTATCHMENT ; \n + / / for previous dubbo version ( 2 . 0 . 10 / 020010 ~ 2 . 6 . 2 / 020602 ) , this version is the jar ' s version , so they need to be ignore \n + int iVersion = getIntVersion ( version ) ; \n + if ( iVersion > = 20010 & & iVersion < = 20602 ) { \n + return false ; \n + } \n + \n + return iVersion > = LOWEST _ VERSION _ FOR _ RESPONSE _ ATTATCHMENT ; \n - for ( int i = 1 ; i < = len ; i + + ) { \n - v + = Integer . parseInt ( vArr [ len - i ] ) * Math . pow ( 10 , i - 1 ) ; \n + for ( int i = 0 ; i < len ; i + + ) { \n + v + = Integer . parseInt ( getDigital ( vArr [ i ] ) ) * Math . pow ( 10 , ( len - i - 1 ) * 2 ) ; \n + private static String getDigital ( String v ) { \n + int index = 0 ; \n + for ( int i = 0 ; i < v . length ( ) ; i + + ) { \n + char c = v . charAt ( i ) ; \n + if ( Character . isDigit ( c ) ) { \n + if ( i = = v . length ( ) - 1 ) { \n + index = i + 1 ; \n + } else { \n + index = i ; \n + } \n + continue ; \n + } else { \n + index = i ; \n + break ; \n + } \n + } \n + return v . substring ( 0 , index ) ; \n + } \n + \n","Merge pull request # 2118 , fix protocol version compatibility with lower versions .",245
all \ pom . xml \n - < groupId > org . jboss . netty < / groupId > \n - < artifactId > netty < / artifactId > \n + < groupId > io . netty < / groupId > \n + < artifactId > netty - all < / artifactId > \n,upgrade netty for dubbo - all ( # 2123 ),245
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ CompatibleTypeUtils . java \n + } else if ( char [ ] . class . equals ( type ) ) { \n + / / Process string to char array for generic invoke \n + / / See \n + / / - https : / / github . com / apache / incubator - dubbo / issues / 2003 \n + if ( string = = null ) { \n + return null ; \n + } \n + else { \n + int len = string . length ( ) ; \n + char [ ] chars = new char [ len ] ; \n + string . getChars ( 0 , len , chars , 0 ) ; \n + return chars ; \n + } \n dubbo - common \ src \ test \ java \ org \ apache \ dubbo \ common \ utils \ CompatibleTypeUtilsTest . java \n + \n + result = CompatibleTypeUtils . compatibleTypeConvert ( "" ab "" , char [ ] . class ) ; \n + assertEquals ( 2 , ( ( char [ ] ) result ) . length ) ; \n + assertEquals ( ' a ' , ( ( char [ ] ) result ) [ 0 ] ) ; \n + assertEquals ( ' b ' , ( ( char [ ] ) result ) [ 1 ] ) ; \n + \n + result = CompatibleTypeUtils . compatibleTypeConvert ( "" "" , char [ ] . class ) ; \n + assertEquals ( 0 , ( ( char [ ] ) result ) . length ) ; \n + \n + result = CompatibleTypeUtils . compatibleTypeConvert ( null , char [ ] . class ) ; \n + assertEquals ( null , result ) ; \n","support char [ ] for generic invoke , # 2003 ( # 2138 )",245
README . md \n - < version > 2 . 6 . 3 < / version > \n + < version > 2 . 6 . 4 < / version > \n,update lastest version to 2 . 6 . 4 ( # 2601 ),245
. travis . yml \n - oraclejdk9 \n - oraclejdk8 \n - script : \n - - travis _ wait 30 . / mvnw clean package - Dcheckstyle . skip = false - Drat . skip = false \n + cache : \n + directories : \n + - ' $ HOME / . m2 / repository ' \n + \n + install : \n + - . / mvnw clean install - DskipTests = true - Dcheckstyle . skip = false - Drat . skip = false - Dmaven . javadoc . skip = true \n + \n + script : \n + - travis _ wait 30 . / mvnw test \n - bash < ( curl - s https : / / codecov . io / bash ) \n,change travis ci configuration ( # 2306 ),245
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ AbstractClusterInvoker . java \n - / / If we only have two invokers , use round - robin instead . \n - if ( invokers . size ( ) = = 2 & & selected ! = null & & ! selected . isEmpty ( ) ) { \n - return selected . get ( 0 ) = = invokers . get ( 0 ) ? invokers . get ( 1 ) : invokers . get ( 0 ) ; \n - } \n - invoker = index < invokers . size ( ) - 1 ? invokers . get ( index + 1 ) : invoker ; \n + invoker = index < invokers . size ( ) - 1 ? invokers . get ( index + 1 ) : invokers . get ( 0 ) ; \n dubbo - cluster \ src \ test \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ AbstractClusterInvokerTest . java \n + import org . mockito . Mockito ; \n - invokers . add ( invoker1 ) ; \n + invokers . add ( invoker4 ) ; \n - selectedInvokers . add ( invoker1 ) ; \n - Invoker invoker = cluster . select ( null , null , invokers , selectedInvokers ) ; \n + selectedInvokers . add ( invoker4 ) ; \n + Invoker invoker = cluster . select ( null , invocation , invokers , selectedInvokers ) ; \n - Invoker invoker = cluster . select ( null , null , invokers , selectedInvokers ) ; \n - Assert . assertEquals ( invoker1 , invoker ) ; \n + Invoker invoker = cluster . select ( null , invocation , invokers , selectedInvokers ) ; \n + Assert . assertEquals ( invoker4 , invoker ) ; \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n + \n + \n + Mockito . clearInvocations ( invoker1 , invoker2 , invoker3 , invoker4 , invoker5 ) ; \n dubbo - cluster \ src \ test \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ FailoverClusterInvokerTest . java \n - assertTrue ( expected . isTimeout ( ) ) ; \n + assertTrue ( ( expected . isTimeout ( ) | | expected . getCode ( ) = = 0 ) ) ; \n","Fix # 934 # 1756 use loadBalance policy to choose invoke when providers less 2 ( # 1759 ) \n * fix # 934 use loadBalance policy to choose invoke when providers less than 2 \n * fix # 1756 , clear mock invocation after invoking",245
dubbo - all \ pom . xml \n + \n + < profiles > \n + < profile > \n + < id > release < / id > \n + < build > \n + < plugins > \n + < plugin > \n + < artifactId > maven - javadoc - plugin < / artifactId > \n + < version > $ { maven _ javadoc _ version } < / version > \n + < executions > \n + < execution > \n + < id > attach - javadoc < / id > \n + < goals > \n + < goal > jar < / goal > \n + < / goals > \n + < configuration > \n + < doclint > none < / doclint > \n + < / configuration > \n + < / execution > \n + < / executions > \n + < configuration > \n + < includeDependencySources > true < / includeDependencySources > \n + < dependencySourceIncludes > \n + < dependencySourceInclude > org . apache . dubbo : dubbo - * < / dependencySourceInclude > \n + < dependencySourceExclude > com . alibaba : hessian - * < / dependencySourceExclude > \n + < / dependencySourceIncludes > \n + < show > public < / show > \n + < charset > UTF - 8 < / charset > \n + < encoding > UTF - 8 < / encoding > \n + < docencoding > UTF - 8 < / docencoding > \n + < links > \n + < link > http : / / docs . oracle . com / javase / 7 / docs / api < / link > \n + < / links > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + < / profile > \n + < / profiles > \n,fix # 2600 add javadoc - plugin to dubbo - all module ( # 2604 ),245
"dubbo - remoting \ dubbo - remoting - mina \ src \ test \ java \ org \ apache \ remoting \ transport \ mina \ MinaClientToServerTest . java \n - return Exchangers . connect ( URL . valueOf ( "" exchange : / / localhost : "" + port + "" ? client = mina "" ) ) ; \n + return Exchangers . connect ( URL . valueOf ( "" exchange : / / localhost : "" + port + "" ? client = mina & timeout = 3000 "" ) ) ; \n dubbo - remoting \ dubbo - remoting - netty4 \ src \ test \ java \ org \ apache \ dubbo \ remoting \ transport \ netty4 \ NettyClientToServerTest . java \n - return Exchangers . connect ( URL . valueOf ( "" exchange : / / localhost : "" + port + "" ? client = netty4 "" ) ) ; \n + return Exchangers . connect ( URL . valueOf ( "" exchange : / / localhost : "" + port + "" ? client = netty4 & timeout = 3000 "" ) ) ; \n",set timeout to 3000 ( # 2536 ),245
"dubbo - rpc \ dubbo - rpc - dubbo \ src \ test \ java \ org \ apache \ dubbo \ rpc \ protocol \ dubbo \ telnet \ ListTelnetHandlerTest . java \n - given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 20885 / demo "" ) ) ; \n + given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 30005 / demo "" ) ) ; \n - given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 20885 / demo "" ) ) ; \n + given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 30006 / demo "" ) ) ; \n - given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 20885 / demo "" ) ) ; \n + given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 30007 / demo "" ) ) ; \n - given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 20885 / demo "" ) ) ; \n + given ( mockInvoker . getUrl ( ) ) . willReturn ( URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 30008 / demo "" ) ) ; \n","fix # 2532 , change different port ( # 2551 )",245
. travis . yml \n - oraclejdk11 \n - - oraclejdk10 \n - - oraclejdk9 \n - oraclejdk8 \n,rm java 9 and 10 on travis ( # 2559 ),245
"dubbo - config \ dubbo - config - spring \ src \ test \ java \ org \ apache \ dubbo \ config \ spring \ initializer \ DubboApplicationContextInitializerTest . java \n - tomcat . setBaseDir ( "" src / test / resources "" ) ; \n + tomcat . setBaseDir ( "" target / test - classes "" ) ; \n - tomcat . setBaseDir ( "" src / test / resources "" ) ; \n + tomcat . setBaseDir ( "" target / test - classes "" ) ; \n - tomcat . setBaseDir ( "" src / test / resources "" ) ; \n + tomcat . setBaseDir ( "" target / test - classes "" ) ; \n","fix # 2560 , use target / test - classes as the basedir ( # 2563 )",245
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ wrapper \ MockClusterInvoker . java \n - logger . info ( "" fail - mock : "" + invocation . getMethodName ( ) + "" fail - mock enabled , url : "" + directory . getUrl ( ) , e ) ; \n + logger . warn ( "" fail - mock : "" + invocation . getMethodName ( ) + "" fail - mock enabled , url : "" + directory . getUrl ( ) , e ) ; \n","Fix # 1539 , change log method ( # 1578 )",245
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ status \ support \ LoadStatusChecker . java \n + if ( load = = - 1 ) { \n + com . sun . management . OperatingSystemMXBean bean = \n + ( com . sun . management . OperatingSystemMXBean ) operatingSystemMXBean ; \n + load = bean . getSystemCpuLoad ( ) ; \n + } \n,"fix # 1641 , support get system load on windows ( # 2631 )",245
leakcanary - analyzer \ build . gradle \n - compile ' com . squareup . haha : haha : 2 . 0 . 2 ' \n + compile ' com . squareup . haha : haha : 2 . 0 . 3 ' \n,Update HAHA 2 . 0 . 2 - > 2 . 0 . 3,257
gradle . properties \n + \n + org . gradle . jvmargs = - Xmx1536M \n,Increase Gradle daemon heap to run dex in process,257
"build . gradle \n - ' minSdk ' : 9 , \n + ' minSdk ' : 14 , \n - ' supportLibrary ' : ' 25 . 3 . 0 ' , \n + ' supportLibrary ' : ' 26 . 0 . 0 ' , \n","Bump support library deps \n Requires minSdk 14 or tools : overrideLibrary = "" android . support . compat """,257
. travis . yml \n - android : \n - components : \n - - tools \n - - platform - tools \n - \n - oraclejdk8 \n,Remove android : components block from Travis config,257
picasso - pollexor \ build . gradle \n + defaultConfig { \n + minSdkVersion versions . minSdk \n + } \n + \n - \n - defaultConfig { \n - minSdkVersion versions . minSdk \n - } \n picasso - sample \ build . gradle \n - dependencies { \n - implementation deps . supportV4 \n - compileOnly deps . supportAnnotations \n - implementation project ( ' : picasso ' ) \n - } \n - \n + defaultConfig { \n + minSdkVersion versions . minSdk \n + targetSdkVersion versions . targetSdk \n + applicationId ' com . example . picasso ' \n + \n + versionCode 1 \n + versionName ' 1 . 0 ' \n + } \n + \n - defaultConfig { \n - minSdkVersion versions . minSdk \n - targetSdkVersion versions . targetSdk \n - applicationId ' com . example . picasso ' \n - \n - versionCode 1 \n - versionName ' 1 . 0 ' \n - } \n - \n + \n + dependencies { \n + compileOnly deps . supportAnnotations \n + implementation deps . supportV4 \n + implementation project ( ' : picasso ' ) \n + } \n picasso \ build . gradle \n + defaultConfig { \n + minSdkVersion versions . minSdk \n + consumerProguardFiles ' consumer - proguard - rules . txt ' \n + } \n + \n - \n - defaultConfig { \n - minSdkVersion versions . minSdk \n - \n - consumerProguardFiles ' consumer - proguard - rules . txt ' \n - } \n,Nit : Shuffle some Android project config blocks,257
"build . gradle \n - supportV4 : "" com . android . support : support - v4 : $ { versions . supportLibrary } "" , \n + supportCompat : "" com . android . support : support - compat : $ { versions . supportLibrary } "" , \n + supportFragment : "" com . android . support : support - fragment : $ { versions . supportLibrary } "" , \n picasso - sample \ build . gradle \n - implementation deps . supportV4 \n + implementation deps . supportCompat \n + implementation deps . supportFragment \n",Replace support - v4 with - compat and - fragment,257
"build . gradle \n - ' androidPlugin ' : ' 3 . 0 . 1 ' , \n - ' androidTools ' : ' 26 . 0 . 1 ' , \n - ' kotlin ' : ' 1 . 2 . 10 ' , \n + ' androidPlugin ' : ' 3 . 1 . 0 - alpha09 ' , \n + ' androidTools ' : ' 26 . 1 . 0 - alpha09 ' , \n + ' kotlin ' : ' 1 . 2 . 21 ' , \n",Update to AGP 3 . 1 . 0 - alpha09 \n Can ' t bump to latest cuz https : / / issuetracker . google . com / issues / 73450622,257
"picasso - sample \ src \ main \ java \ com \ example \ picasso \ PicassoSampleAdapter . java \n + import android . app . NotificationChannel ; \n + import android . os . Build ; \n + private static final String CHANNEL _ ID = "" channel - id "" ; \n - NotificationCompat . Builder builder = \n - new NotificationCompat . Builder ( activity ) . setSmallIcon ( R . drawable . icon ) \n + Notification notification = \n + new NotificationCompat . Builder ( activity , CHANNEL _ ID ) \n + . setSmallIcon ( R . drawable . icon ) \n - . setContent ( remoteViews ) ; \n - \n - Notification notification = builder . getNotification ( ) ; \n + . setContent ( remoteViews ) \n + . setAutoCancel ( true ) \n + . setChannelId ( CHANNEL _ ID ) \n + . build ( ) ; \n + \n + if ( Build . VERSION . SDK _ INT > = Build . VERSION _ CODES . O ) { \n + NotificationChannel channel = \n + new NotificationChannel ( CHANNEL _ ID , "" Picasso Notification Channel "" , \n + NotificationManager . IMPORTANCE _ DEFAULT ) ; \n + notificationManager . createNotificationChannel ( channel ) ; \n + } \n + \n",Fix Notifications to use channels on O +,257
"picasso - sample \ src \ main \ java \ com \ example \ picasso \ SampleContactsActivity . java \n + import android . content . pm . PackageManager ; \n + import android . support . annotation . NonNull ; \n + import android . support . v4 . app . ActivityCompat ; \n + import android . widget . Toast ; \n + import static android . Manifest . permission . READ _ CONTACTS ; \n + import static android . content . pm . PackageManager . PERMISSION _ GRANTED ; \n + private static final int REQUEST _ READ _ CONTACTS = 123 ; \n + \n + if ( ActivityCompat . checkSelfPermission ( this , READ _ CONTACTS ) = = PERMISSION _ GRANTED ) { \n + loadContacts ( ) ; \n + } else { \n + ActivityCompat . requestPermissions ( this , new String [ ] { READ _ CONTACTS } , \n + REQUEST _ READ _ CONTACTS ) ; \n + } \n + } \n + \n + private void loadContacts ( ) { \n + @ Override public void onRequestPermissionsResult ( int requestCode , @ NonNull String [ ] permissions , \n + @ NonNull int [ ] grantResults ) { \n + if ( requestCode = = REQUEST _ READ _ CONTACTS ) { \n + if ( grantResults . length > 0 \n + & & grantResults [ 0 ] = = PackageManager . PERMISSION _ GRANTED ) { \n + loadContacts ( ) ; \n + } else { \n + Toast . makeText ( this , "" Read contacts permission denied "" , Toast . LENGTH _ LONG ) . show ( ) ; \n + finish ( ) ; \n + } \n + } else { \n + super . onRequestPermissionsResult ( requestCode , permissions , grantResults ) ; \n + } \n + } \n + \n",Fix Contacts activity to request permissions on M +,257
"picasso \ src \ main \ java \ com \ squareup \ picasso3 \ Dispatcher . java \n + import android . util . Log ; \n + import static com . squareup . picasso3 . Picasso . TAG ; \n - dispatcher . dispatchNetworkStateChange ( connectivityManager . getActiveNetworkInfo ( ) ) ; \n + NetworkInfo networkInfo = null ; \n + try { \n + networkInfo = connectivityManager . getActiveNetworkInfo ( ) ; \n + } catch ( RuntimeException re ) { \n + Log . w ( TAG , "" System UI crashed , ignoring attempt to change network state . "" ) ; \n + return ; \n + } \n + if ( networkInfo = = null ) { \n + Log . w ( TAG , "" No default network is currently active , ignoring attempt to change "" \n + + "" network state . "" ) ; \n + return ; \n + } \n + dispatcher . dispatchNetworkStateChange ( networkInfo ) ; \n",Better query handling for active network state \n Closes # 1903,257
. travis . yml \n - android : \n - components : \n - # Update tools and then platform - tools explicitly so lint gets an updated database . Can be removed once 3 . 0 is out . \n - - tools \n - - platform - tools \n - - extra - android - m2repository \n - - android - 28 \n - \n - oraclejdk8 \n,Remove unnecessary android components from travis . yml,257
"build . gradle \n - ' supportLibrary ' : ' 28 . 0 . 0 - alpha3 ' \n + ' supportLibrary ' : ' 28 . 0 . 0 - rc01 ' \n - androidPlugin : ' com . android . tools . build : gradle : 3 . 2 . 0 - beta05 ' , \n + androidPlugin : ' com . android . tools . build : gradle : 3 . 2 . 0 - rc02 ' , \n",Bump AGP and Support libs \n AGP 3 . 2 . 0 - b5 - > 3 . 2 . 0 - rc02 \n Support libs 28 . 0 . 0 - a3 - > 28 . 0 . 0 - rc01,257
"build . gradle \n - truth : ' com . google . truth : truth : 0 . 36 ' , \n + truth : ' com . google . truth : truth : 0 . 39 ' , \n + classpath ' com . github . ben - manes : gradle - versions - plugin : 0 . 17 . 0 ' \n + apply plugin : ' com . github . ben - manes . versions ' \n + \n","Add versions plugin \n Also , bump Truth",257
shark - android \ src \ main \ java \ shark \ AndroidReferenceMatchers . kt \n - sdkInt in 24 . . 28 \n + sdkInt in 24 . . 29 \n,Extend range for ASSIST _ STRUCTURE leak pattern \n See : https : / / twitter . com / Piwai / status / 1107731823625265152,257
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ model \ ScheduleItem . java \n - import com . google . samples . apps . iosched . Config ; \n + import com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations ; \n + / / is the item a Keynote session \n + public boolean isKeynote = false ; \n + \n - public boolean inSchedule ; \n + public boolean inSchedule = false ; \n - public int reservationStatus ; \n + public int reservationStatus = MyReservations . RESERVATION _ STATUS _ UNRESERVED ; \n - public boolean hasGivenFeedback ; \n + public boolean hasGivenFeedback = false ; \n - return mainTag ! = null & & Config . Tags . SPECIAL _ KEYNOTE . equals ( mainTag ) ; \n + return isKeynote ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ model \ ScheduleItemHelper . java \n - import static com . google . samples . apps . iosched . model . ScheduleItem . detectSessionType ; \n - \n + import com . google . samples . apps . iosched . Config . Tags ; \n + import static com . google . samples . apps . iosched . model . ScheduleItem . detectSessionType ; \n + \n - item . tags = cursor . getString ( cursor . getColumnIndex ( Sessions . SESSION _ TAGS ) ) . split ( "" , "" ) ; \n + String tags = cursor . getString ( cursor . getColumnIndex ( Sessions . SESSION _ TAGS ) ) ; \n + if ( tags ! = null ) { \n + item . tags = tags . split ( "" , "" ) ; \n + item . isKeynote = tags . contains ( Tags . SPECIAL _ KEYNOTE ) ; \n + } \n","Don ' t show bookmark icon for keynotes in session \n Alternatively ( or in addition ) , backend can add "" FLAG _ KEYNOTE "" as the \n mainTag for these sessions . \n Bug : 37815217 \n Change - Id : Iaac1ea9f82dc5438b743d364d0ce9fbf52ac7b7c",261
"android \ src \ main \ AndroidManifest . xml \n - android : exported = "" true "" > \n + android : exported = "" true "" \n + tools : ignore = "" ExportedReceiver "" > \n - < receiver android : name = "" com . google . android . gms . analytics . AnalyticsReceiver "" \n - android : enabled = "" true "" > \n + < receiver \n + android : name = "" com . google . android . gms . analytics . AnalyticsReceiver "" \n + android : enabled = "" true "" \n + tools : ignore = "" ExportedReceiver "" > \n - < service android : name = "" com . google . android . gms . analytics . AnalyticsService "" \n - android : enabled = "" true "" \n - android : exported = "" false "" / > \n - \n + < service \n + android : name = "" com . google . android . gms . analytics . AnalyticsService "" \n + android : enabled = "" true "" \n + android : exported = "" false "" / > \n - android : name = "" sync . account . AuthenticatorService "" > \n + android : name = "" sync . account . AuthenticatorService "" \n + tools : ignore = "" ExportedService "" > \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ sync \ account \ AuthenticatorService . java \n + import android . annotation . SuppressLint ; \n + @ SuppressLint ( "" Registered "" ) / / Lint thinks this is missing from AndroidManifest , but it ' s there \n",Resolve some manifest - related lint warnings \n Change - Id : Iafa8ac7fbdc13cd18f02126889a8160eb74f36fa,261
"android \ lint . xml \n - - > \n + < ! - - Availablility of new versions of dependencies should not affect builds - - > \n + < issue id = "" GradleDependency "" severity = "" informational "" / > \n + < issue id = "" OldTargetApi "" severity = "" informational "" / > \n + \n",Lower issues related to new dependency versions to info level \n Change - Id : If1a8428a4952419c9ad0c5de9dc6a9ebdcfdffa1,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ info \ CollapsibleCard . java \n + import android . view . MotionEvent ; \n + private View mTitleContainer ; \n + mTitleContainer = root . findViewById ( R . id . title _ container ) ; \n + \n + @ Override \n + public boolean onInterceptTouchEvent ( MotionEvent ev ) { \n + if ( ev . getActionMasked ( ) = = MotionEvent . ACTION _ DOWN ) { \n + / / propagate hotspot for ripple \n + mTitleContainer . getBackground ( ) . setHotspot ( ev . getX ( ) , ev . getY ( ) ) ; \n + } \n + return super . onInterceptTouchEvent ( ev ) ; \n + } \n lib \ src \ main \ res \ layout \ collapsible _ card _ content . xml \n + android : id = "" @ + id / title _ container "" \n + android : addStatesFromChildren = "" true "" \n + android : background = "" ? selectableItemBackground "" \n - android : background = "" ? selectableItemBackground "" \n - android : background = "" ? selectableItemBackgroundBorderless "" \n lib \ src \ main \ res \ values \ styles . xml \n - < style name = "" Settings . LinkButton "" parent = "" @ style / Widget . AppCompat . Button . Borderless . Colored "" > \n + < style name = "" Settings . LinkButton "" parent = "" @ style / Widget . AppCompat . Button . Borderless "" > \n + < item name = "" android : textSize "" > 15sp < / item > \n - < item name = "" android : gravity "" > center _ vertical | start < / item > \n - < item name = "" android : minHeight "" > ? android : listPreferredItemHeightSmall < / item > \n - < item name = "" android : paddingEnd "" > ? android : listPreferredItemPaddingEnd < / item > \n - < item name = "" android : paddingStart "" > ? android : listPreferredItemPaddingStart < / item > \n - < item name = "" android : paddingTop "" > @ dimen / spacing _ normal < / item > \n - < item name = "" android : paddingBottom "" > @ dimen / spacing _ normal < / item > \n + < item name = "" android : fontFamily "" > sans - serif - medium < / item > \n + < item name = "" android : padding "" > @ dimen / padding _ normal < / item > \n + < item name = "" android : textAllCaps "" > true < / item > \n",Make Info > About items look more consistent \n Bug : 37896282 \n Change - Id : I744d1572af2abbe704f51771abb48428f0705a08,261
lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleModel . java \n - import com . google . samples . apps . iosched . util . RegistrationUtils ; \n - return RegistrationUtils . isRegisteredAttendee ( context ) = = \n - RegistrationUtils . REGSTATUS _ REGISTERED ; \n + / / return RegistrationUtils . isRegisteredAttendee ( context ) = = \n + / / RegistrationUtils . REGSTATUS _ REGISTERED ; \n + return false ; \n,Don ' t show pre - conference day \n Bug : 37844763 \n Change - Id : Ie9ff19b3f3b9be2dab09ddf68797cb2c63665d78,261
"lib \ src \ main \ res \ layout \ schedule _ non _ session _ item . xml \n - android : paddingLeft = "" @ dimen / padding _ normal "" \n - android : paddingRight = "" @ dimen / padding _ normal "" > \n + android : padding = "" @ dimen / padding _ normal "" > \n - android : paddingTop = "" @ dimen / padding _ normal "" \n - android : paddingBottom = "" @ dimen / padding _ normal "" \n - android : layout _ width = "" 0dp "" \n - android : layout _ height = "" 0dp "" \n - app : layout _ constraintDimensionRatio = "" 1 "" \n + android : layout _ width = "" 40dp "" \n + android : layout _ height = "" 40dp "" \n - app : layout _ constraintTop _ toTopOf = "" @ id / slot _ title "" \n - app : layout _ constraintBottom _ toBottomOf = "" @ id / slot _ description "" \n + app : layout _ constraintTop _ toTopOf = "" parent "" \n + app : layout _ constraintBottom _ toBottomOf = "" parent "" \n",Make agenda item icons smaller \n Bug : 37808057 \n Change - Id : Ibb6e819fd979dea3b008b4248823d14f3207594b,261
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n + import android . support . v4 . widget . TextViewCompat ; \n + import android . support . v7 . content . res . AppCompatResources ; \n + import android . widget . Button ; \n - private View mClearFilters ; \n + private Button mClearFilters ; \n - mClearFilters = findViewById ( R . id . clear _ filters ) ; \n + mClearFilters = ( Button ) findViewById ( R . id . clear _ filters ) ; \n + TextViewCompat . setCompoundDrawablesRelativeWithIntrinsicBounds ( mClearFilters , null , null , \n + AppCompatResources . getDrawable ( this , R . drawable . ic _ clear _ all ) , null ) ; \n android \ src \ main \ res \ layout \ my _ schedule _ filter _ drawer . xml \n + android : baselineAligned = "" false "" \n + android : gravity = "" center _ vertical "" \n - android : gravity = "" center _ vertical "" \n - android : baselineAligned = "" false "" \n - android : drawableEnd = "" @ drawable / ic _ clear _ all "" \n - android : drawableRight = "" @ drawable / ic _ clear _ all "" \n + tools : drawableEnd = "" @ drawable / ic _ clear _ all "" \n",Fix crash with compound drawable on pre - 21 \n Change - Id : Ie06b6e3996219a3ce2db8dcae29d4c63f2985fc8,261
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n + import android . support . v4 . view . GravityCompat ; \n + import android . view . MenuItem ; \n + @ Override \n + public boolean onOptionsItemSelected ( MenuItem item ) { \n + if ( item . getItemId ( ) = = R . id . menu _ filter ) { \n + mDrawerLayout . openDrawer ( GravityCompat . END ) ; \n + return true ; \n + } \n + return super . onOptionsItemSelected ( item ) ; \n + } \n android \ src \ main \ res \ drawable \ ic _ action _ filter . xml \n - android : viewportHeight = "" 24 "" > \n + android : viewportHeight = "" 24 "" \n + android : tint = "" ? colorControlNormal "" > \n android \ src \ main \ res \ menu \ my _ schedule . xml \n - android : id = "" @ + id / menu _ refresh "" \n + android : id = "" @ + id / menu _ filter "" \n + android : icon = "" @ drawable / ic _ action _ filter "" \n - android : title = "" @ string / description _ refresh "" \n - app : showAsAction = "" never "" / > \n + android : title = "" @ string / description _ filter "" \n + app : showAsAction = "" always "" / > \n android \ src \ main \ res \ values \ ids . xml \n + < ! - - Used in BaseActivity - - > \n + < item name = "" menu _ refresh "" type = "" id "" / > \n + \n",Add filter icon to app bar \n Bug : 35698703 \n Change - Id : I73a4c2feeec26e5fd2c3a10e29c774e58e0d5822,261
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n + TagFilterHolder filters = mScheduleFilterFragment . getFilters ( ) ; \n + mModel . setFilters ( filters ) ; \n + contentFragment . onFiltersChanged ( filters ) ; \n + \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleSingleDayFragment . java \n - import android . app . Activity ; \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ ScheduleFilterFragment . java \n + public TagFilterHolder getFilters ( ) { \n + return mAdapter . getFilters ( ) ; \n + } \n + \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ SessionsFilterAdapter . java \n + public TagFilterHolder getFilters ( ) { \n + return mTagFilterHolder ; \n + } \n + \n,Fix filters being lost after config change \n Bug : 35848152 \n Change - Id : I16441a0be7e6d1644bb385917bd5fe3e2e60cc22,261
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n + @ Override \n + public void onBackPressed ( ) { \n + if ( mDrawerLayout . isDrawerOpen ( GravityCompat . END ) ) { \n + mDrawerLayout . closeDrawer ( GravityCompat . END ) ; \n + } else { \n + super . onBackPressed ( ) ; \n + } \n + } \n + \n,Close the filter drawer on back press \n Bug : 35851103 \n Change - Id : I4ff2a47e54aa8f2de212da642dc0bc8043901a57,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myio \ MyIOContract . java \n + \n + void refreshUI ( LoaderManager loaderManager ) ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myio \ MyIOFragment . java \n + import android . os . Handler ; \n + import com . google . samples . apps . iosched . util . LogUtils ; \n + import com . google . samples . apps . iosched . util . TimeUtils ; \n + private static final String TAG = LogUtils . makeLogTag ( MyIOFragment . class ) ; \n + \n + private static final long UI _ REFRESH _ DELAY = TimeUtils . MINUTE ; \n + \n + private Handler mHandler ; \n + \n + private Runnable mUiRefreshRunnable = new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + if ( mPresenter ! = null ) { \n + mPresenter . refreshUI ( getLoaderManager ( ) ) ; \n + } \n + maybePostUiRefreshRunnable ( ) ; \n + } \n + } ; \n + \n + mHandler = new Handler ( ) ; \n + } \n + \n + @ Override \n + public void onStart ( ) { \n + super . onStart ( ) ; \n + maybePostUiRefreshRunnable ( ) ; \n + @ Override \n + public void onStop ( ) { \n + super . onStop ( ) ; \n + mHandler . removeCallbacks ( mUiRefreshRunnable ) ; \n + } \n + \n + private void maybePostUiRefreshRunnable ( ) { \n + if ( TimeUtils . isConferenceInProgress ( getContext ( ) ) ) { \n + mHandler . removeCallbacks ( mUiRefreshRunnable ) ; \n + mHandler . postDelayed ( mUiRefreshRunnable , UI _ REFRESH _ DELAY ) ; \n + } \n + } \n + \n + / / - - MyIoView callbacks \n + \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myio \ MyIOPresenterImpl . java \n + @ Override \n + public void refreshUI ( LoaderManager loaderManager ) { \n + loaderManager . restartLoader ( LOADER _ SCHEDULE , null , mSessionsLoaderCallbacks ) ; \n + loaderManager . restartLoader ( LOADER _ TAG _ METADATA , null , mTagMetadataLoaderCallbacks ) ; \n + } \n + \n",Preiodically refresh My I / O UI during conference \n Bug : 36853754 \n Change - Id : I78a5ceff08a4e05ab07283cdf31a8baae25c8102,261
"new file \n lib \ src \ main \ res \ values - h400dp \ dimens . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" utf - 8 "" ? > \n + < ! - - \n + Copyright ( C ) 2017 Google Inc . \n + \n + Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + you may not use this file except in compliance with the License . \n + You may obtain a copy of the License at \n + \n + http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + \n + Unless required by applicable law or agreed to in writing , software \n + distributed under the License is distributed on an "" AS IS "" BASIS , \n + WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + See the License for the specific language governing permissions and \n + limitations under the License . \n + - - > \n + < resources > \n + < dimen name = "" extended _ appbar _ height "" > 180dp < / dimen > \n + < / resources > \n",Fix onboarding header height \n Bug : 37918573 \n Change - Id : Ie66c8e738ac6f7fa60f03099d418b5fb78723a38,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleSingleDayFragment . java \n + mRecyclerView . setLayoutManager ( \n + new StickyHeadersLinearLayoutManager < ScheduleDayAdapter > ( getContext ( ) ) ) ; \n + mViewAdapter = new ScheduleDayAdapter ( getContext ( ) , this , mTagMetadata , true ) ; \n + mRecyclerView . setAdapter ( mViewAdapter ) ; \n - if ( isVisible ( ) ) { \n - showSchedule ( ) ; \n - if ( mViewAdapter = = null ) { \n - mViewAdapter = new ScheduleDayAdapter ( getContext ( ) , this , mTagMetadata , true ) ; \n - mRecyclerView . setLayoutManager ( \n - new StickyHeadersLinearLayoutManager < ScheduleDayAdapter > ( getContext ( ) ) ) ; \n - } \n - mViewAdapter . updateItems ( model . getConferenceDataForDay ( mDayId ) ) ; \n - if ( mRecyclerView . getAdapter ( ) = = null ) { \n - mRecyclerView . setAdapter ( mViewAdapter ) ; \n - } \n + showSchedule ( ) ; \n + mViewAdapter . updateItems ( model . getConferenceDataForDay ( mDayId ) ) ; \n - if ( isShowingCurrentDay ( ) ) { \n - LinearLayoutManager lm = ( LinearLayoutManager ) mRecyclerView . getLayoutManager ( ) ; \n - if ( lm . findFirstVisibleItemPosition ( ) = = 0 ) { \n - / / If we ' re showing the current day and we ' re still showing the first pos , move \n - / / to the current time slot \n - moveToCurrentTimeSlot ( false ) ; \n - } \n + if ( isShowingCurrentDay ( ) ) { \n + LinearLayoutManager lm = ( LinearLayoutManager ) mRecyclerView . getLayoutManager ( ) ; \n + if ( lm . findFirstVisibleItemPosition ( ) = = 0 ) { \n + / / If we ' re showing the current day and we ' re still showing the first pos , move \n + / / to the current time slot \n + moveToCurrentTimeSlot ( false ) ; \n",Fix schedule disappearing on orientation change \n Bug : 37956238 \n Change - Id : I681bbdbc3f0d1bfaaea054ee6d65410b9d3fb974,261
lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleFilterFragment . java \n - import android . support . v7 . widget . DividerItemDecoration ; \n + TagFilterHolder filters = mAdapter . getFilters ( ) ; \n + if ( filters ! = null ) { \n + mClearFilters . setVisibility ( filters . hasAnyFilters ( ) ? View . VISIBLE : View . GONE ) ; \n + } \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ SessionsFilterAdapter . java \n - private TagFilterHolder mTagFilterHolder = new TagFilterHolder ( ) ; \n + private TagFilterHolder mTagFilterHolder ; \n + restoreFromState ( savedState ) ; \n - \n - restoreFromState ( savedState ) ; \n + if ( mTagFilterHolder = = null ) { \n + mTagFilterHolder = new TagFilterHolder ( ) ; \n + } \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ TagFilterHolder . java \n - return mSelectedTopics . contains ( tag ) | | mSelectedTopics . contains ( tag ) ; \n + return mSelectedTypes . contains ( tag ) | | mSelectedTopics . contains ( tag ) ; \n,"Fix filters rotation bugs \n - Fix "" clear all "" button disappearing \n - Fix event type filters losing checkmark \n Bug : 37958327 \n Change - Id : Ic4143d01bda23e3ac0465fb411122626fc1369d4",261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ SessionItemViewHolder . java \n - mBookmark . setEnabled ( ! item . isKeynote ( ) & & mCallbacks . bookmarkingEnabled ( ) ) ; \n - / / activated is proxy for in - schedule \n - mBookmark . setActivated ( item . isKeynote ( ) | | item . inSchedule ) ; \n + if ( mCallbacks . bookmarkingEnabled ( ) ) { \n + mBookmark . setVisibility ( VISIBLE ) ; \n + mBookmark . setEnabled ( ! item . isKeynote ( ) ) ; \n + / / activated is proxy for in - schedule \n + mBookmark . setActivated ( item . isKeynote ( ) | | item . inSchedule ) ; \n + } else { \n + mBookmark . setVisibility ( GONE ) ; \n + } \n - * @ return true if bookmark icons should be clickable and call back to this listener . \n + * @ return true if bookmark icons should be shown \n lib \ src \ main \ res \ layout \ schedule _ session _ item . xml \n - app : layout _ constraintTop _ toBottomOf = "" @ id / reserve _ status "" / > \n + app : layout _ constraintTop _ toBottomOf = "" @ id / reserve _ status "" \n + tools : layout _ height = "" 48dp "" / > \n - app : layout _ constraintStart _ toEndOf = "" @ id / tags _ holder "" \n",Don ' t display bookmark icon on My I / O \n Bug : 37348831 \n Change - Id : I5156622b9a3cacdbe8e5b0f1b09f8f6797d64760,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ map \ MapActivity . java \n + setFullscreenLayout ( ) ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ navigation \ AppNavigationViewAsBottomNavImpl . java \n - import android . os . Handler ; \n - import android . view . View ; \n - import com . google . samples . apps . iosched . lib . R ; \n - private static final int CONTENT _ FADE _ OUT _ DURATION = 150 ; \n - private static final int BOTTOM _ NAV _ SELECTED _ DELAY = 240 ; \n - \n - private final Handler mHandler = new Handler ( ) ; \n - \n - / / Launch the target Activity after a short delay , to allow the close animation to play \n - mHandler . postDelayed ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - itemSelected ( navItem ) ; \n - } \n - } , BOTTOM _ NAV _ SELECTED _ DELAY ) ; \n - \n - / / Fade out the main content \n - View mainContent = mActivity . findViewById ( R . id . main _ content ) ; \n - if ( mainContent ! = null ) { \n - mainContent . animate ( ) . alpha ( 0 ) . setDuration ( CONTENT _ FADE _ OUT _ DURATION ) ; \n - } \n - \n + itemSelected ( navItem ) ; \n lib \ src \ main \ res \ layout \ map _ act . xml \n - android : fitsSystemWindows = "" true "" \n + android : fitsSystemWindows = "" true "" \n lib \ src \ main \ res \ values \ styles . xml \n - < style name = "" Theme . IOSched . Welcome "" > \n - < item name = "" android : windowBackground "" > @ color / background < / item > \n - < item name = "" android : statusBarColor "" > @ color / immersive _ status _ bar < / item > \n - < / style > \n - \n + < style name = "" Theme . IOSched . Welcome "" parent = "" @ style / Theme . IOSched . Immersive "" / > \n + \n - < style name = "" Theme . IOSched . Map "" > \n - < item name = "" colorPrimaryDark "" > # ff16b990 < / item > \n - < / style > \n + < style name = "" Theme . IOSched . Map "" parent = "" @ style / Theme . IOSched . Immersive "" / > \n",Remove delays when switching top - level activities \n Bug : 37486883 \n Change - Id : I6b611dc775b8a8c3f6949612d7f5779689a4ef63,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleActivity . java \n + @ Override \n + public void openFilterDrawer ( ) { \n + mDrawerLayout . openDrawer ( GravityCompat . END ) ; \n + } \n + \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ SchedulePagerFragment . java \n + mFiltersDescription . setOnClickListener ( new OnClickListener ( ) { \n + @ Override \n + public void onClick ( View v ) { \n + Activity activity = getActivity ( ) ; \n + if ( activity instanceof ScheduleViewParent ) { \n + ( ( ScheduleViewParent ) activity ) . openFilterDrawer ( ) ; \n + } \n + } \n + } ) ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleViewParent . java \n + \n + void openFilterDrawer ( ) ; \n lib \ src \ main \ res \ layout \ schedule _ pager _ fragment . xml \n - android : layout _ height = "" wrap _ content "" \n - android : layout _ marginLeft = "" @ dimen / padding _ normal "" \n - android : layout _ marginStart = "" @ dimen / padding _ normal "" \n + android : layout _ height = "" match _ parent "" \n + android : paddingStart = "" @ dimen / padding _ normal "" \n + android : paddingEnd = "" @ dimen / padding _ normal "" \n + android : gravity = "" center _ vertical "" \n - android : maxLines = "" 2 "" \n - tools : text = "" Filters : Sessions Only , Android "" / > \n + android : maxLines = "" 2 "" \n + tools : text = "" Filters : Sessions , Android "" / > \n - android : layout _ height = "" wrap _ content "" \n - android : layout _ marginLeft = "" @ dimen / padding _ normal "" \n - android : layout _ marginStart = "" @ dimen / padding _ normal "" \n + android : layout _ height = "" match _ parent "" \n + android : scaleType = "" center "" \n",Tapping filters bar opens filter drawer \n Bug : 37497810 \n Change - Id : Ifd7b03e97c93798f5cc1cb046ac7ebb60af278d2,261
"lib \ src \ main \ res \ layout \ info _ pager _ frag . xml \n + app : tabIndicatorHeight = "" 4dp "" \n lib \ src \ main \ res \ layout \ schedule _ pager _ fragment . xml \n + app : tabTextColor = "" @ android : color / white "" \n + app : tabIndicatorHeight = "" 4dp "" \n",TabLayout tweaks \n - Fix tab text contrast on Schedule \n - Make indicator height larger \n Bug : 37518468 \n Change - Id : Ib7208b0a2f1807490df2fd5948737bb05293af90,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ provider \ ScheduleProvider . java \n + / / queries for sessions in user ' s schedule are affected by this change \n + notifyChange ( Sessions . CONTENT _ MY _ SCHEDULE _ URI ) ; \n - notifyChange ( uri ) ; \n + if ( retVal > 0 ) { \n + notifyChange ( uri ) ; \n + } \n - notifyChange ( uri ) ; \n + if ( retVal > 0 ) { \n + notifyChange ( uri ) ; \n + } \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ sync \ userdata \ UserActionHelper . java \n - String account ) { \n + String account ) { \n - batch . add ( createUpdateOperation ( context , action , account ) ) ; \n + batch . add ( createUpdateOperation ( action , account ) ) ; \n - static private ContentProviderOperation createUpdateOperation ( Context context , \n - UserAction action , String account ) { \n + static private ContentProviderOperation createUpdateOperation ( UserAction action , \n + String account ) { \n",Notify sessions / my _ schedule when reservations change \n Bug : 37486266 \n Change - Id : Idd46f03ce1379eb7fa250c3c6d5f0c3ce858a9ce,261
lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ SessionItemViewHolder . java \n - import com . google . samples . apps . iosched . provider . ScheduleContract ; \n - import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations . RESERVATION _ STATUS _ RESERVED ; \n - import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations . RESERVATION _ STATUS _ UNRESERVED ; \n - import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations . RESERVATION _ STATUS _ WAITLISTED ; \n + import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations \n + . RESERVATION _ STATUS _ RESERVED ; \n + import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations \n + . RESERVATION _ STATUS _ UNRESERVED ; \n + import static com . google . samples . apps . iosched . provider . ScheduleContract . MyReservations \n + . RESERVATION _ STATUS _ WAITLISTED ; \n + mReservationStatus . setVisibility ( VISIBLE ) ; \n,Fix reservation status visiblity not being set properly \n Change - Id : I59d58e8f4b360c76bcc2dfd37be47e8fa7deb26f,261
"lib \ src \ main \ res \ layout \ schedule _ non _ session _ item . xml \n - android : padding = "" @ dimen / padding _ normal "" > \n + android : paddingLeft = "" @ dimen / padding _ normal "" \n + android : paddingRight = "" @ dimen / padding _ normal "" > \n + android : paddingTop = "" @ dimen / padding _ normal "" \n + android : textStyle = "" italic "" \n - android : paddingTop = "" @ dimen / spacing _ micro "" \n + android : paddingBottom = "" @ dimen / padding _ normal "" \n + android : layout _ marginTop = "" @ dimen / spacing _ micro "" \n - android : layout _ width = "" 24dp "" \n - android : layout _ height = "" 24dp "" \n - android : layout _ marginTop = "" @ dimen / spacing _ normal "" \n - android : background = "" @ drawable / break _ icon _ background "" \n - android : importantForAccessibility = "" no "" \n - android : padding = "" @ dimen / spacing _ micro "" \n - android : src = "" @ drawable / break _ icon "" \n + android : layout _ width = "" 0dp "" \n + android : layout _ height = "" 0dp "" \n + app : layout _ constraintDimensionRatio = "" 1 "" \n - app : layout _ constraintTop _ toBottomOf = "" @ id / slot _ description "" / > \n + app : layout _ constraintEnd _ toEndOf = "" parent "" \n + app : layout _ constraintTop _ toTopOf = "" @ id / slot _ title "" \n + app : layout _ constraintBottom _ toBottomOf = "" @ id / slot _ description "" \n + android : importantForAccessibility = "" no "" \n + android : alpha = "" . 15 "" \n + android : src = "" @ drawable / break _ icon "" / > \n",Differentiate non - clickable items in schedule \n Bug : 37498064 \n Change - Id : I242315742cfdcd6c87cecf211610645d5f5081b7,261
lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleActivity . java \n - if ( savedInstanceState = = null ) { \n - mScheduleFilterFragment . initWithArguments ( intentToFragmentArguments ( getIntent ( ) ) ) ; \n - } \n - \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleFilterFragment . java \n - if ( args ! = null & & mAdapter ! = null ) { \n + if ( args ! = null ) { \n - maybeApplyPendingFilterTag ( ) ; \n + maybeApplyPendingFilterTag ( ) ; \n,Fix filters not shown after tapping a tag \n Bug : 37548890 \n Change - Id : Ia88262a458a7e9f1c6f46ee566884fba062f33f9,261
"lib \ src \ main \ res \ layout \ info _ faq _ frag . xml \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n + < ImageView \n + android : layout _ width = "" match _ parent "" \n + android : layout _ height = "" wrap _ content "" \n + android : src = "" @ drawable / io17 _ logo "" \n + tools : ignore = "" ContentDescription "" / > \n + \n lib \ src \ main \ res \ layout \ info _ travel _ frag . xml \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n - android : src = "" @ drawable / io17 _ logo "" / > \n + android : src = "" @ drawable / io17 _ logo "" \n + tools : ignore = "" ContentDescription "" / > \n",Add logo to FAQ \n Bug : 37666419 \n Change - Id : Ia3bbd7a29f6b06a7dd9ff2021243c083f264f615,261
"lib \ src \ main \ res \ values \ colors . xml \n - < color name = "" lightish _ blue "" > # 536dfe < / color > \n + < color name = "" lightish _ blue "" > # 4a5cfe < / color > \n - < color name = "" theme _ primary "" > # 4C6AF2 < / color > \n + < color name = "" theme _ primary "" > @ color / lightish _ blue < / color > \n",Fix contrast on some buttons and nagivation text \n Bug : 37518133 \n Bug : 37518368 \n Change - Id : Ibe0ace3065f09fa5c7b0a1c2e9dbfd15c2652250,261
"lib \ src \ main \ res \ values \ colors . xml \n + < color name = "" immersive _ status _ bar _ dark "" > # 66000000 < / color > \n lib \ src \ main \ res \ values \ styles . xml \n - < style name = "" Theme . IOSched . Info "" parent = "" @ style / Theme . IOSched . Immersive "" / > \n + < style name = "" Theme . IOSched . Info "" parent = "" @ style / Theme . IOSched . Immersive "" > \n + < item name = "" android : statusBarColor "" > @ color / immersive _ status _ bar _ dark < / item > \n + < / style > \n",Darken status bar on Info \n Bug : 37775245 \n Change - Id : Iabb2b9350fe50349fb9dae9e40fb73399a9f31c9,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ SessionItemViewHolder . java \n + if ( mTagsHolder . getChildCount ( ) > 0 ) { \n + / / Insert the spacer first \n + layoutInflater . inflate ( R . layout . include _ schedule _ live _ spacer , mTagsHolder ) ; \n + } \n lib \ src \ main \ res \ layout \ include _ schedule _ live . xml \n - android : layout _ marginTop = "" @ dimen / spacing _ normal "" \n lib \ src \ main \ res \ layout \ schedule _ session _ item . xml \n + app : alignItems = "" center "" \n",Fix alignment of tags and icons on Schedule \n Bug : 37776512 \n Change - Id : Idf2aa0c401bdedb2deaa23c5368b5095dff8d4b5,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailFragment . java \n - trackColor = UIUtils . getThemeColor ( getContext ( ) , R . attr . colorPrimary , \n - R . color . theme _ primary ) ; \n + trackColor = ContextCompat . getColor ( getContext ( ) , R . color . neon _ blue ) ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailModel . java \n + import android . graphics . Color ; \n - import android . support . v4 . content . ContextCompat ; \n - public int getSessionColor ( ) { \n - return mSessionColor ; \n - } \n - \n - return mTagMetadata ! = null & & mMainTag ! = null ; \n + return mTagMetadata ! = null ; \n - if ( isSessionTrackColorAvailable ( ) ) { \n + if ( mTagMetadata ! = null & & mMainTag ! = null ) { \n - / / else default to the session color which is defaulted to the theme primary color \n - return mSessionColor ; \n + return Color . TRANSPARENT ; \n - mSessionColor = cursor . getInt ( \n - cursor . getColumnIndex ( ScheduleContract . Sessions . SESSION _ COLOR ) ) ; \n - if ( mSessionColor = = 0 ) { \n - mSessionColor = ContextCompat . getColor ( mContext , R . color . default _ session _ color ) ; \n - } else { \n - mSessionColor = UIUtils . setColorOpaque ( mSessionColor ) ; \n - } \n - \n",Default header color for sessions w / o a track \n Using neon _ blue since that ' s what is in the mocks . Theme primary color \n is too dark since we have dark icons when there is no video thumbnail . \n Bug : 37778173 \n Change - Id : I680564a18746140c73cece9af00ab1f7ed3afa1d,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ RegistrationUtils . java \n - import static java . lang . annotation . RetentionPolicy . SOURCE ; \n - \n + import static java . lang . annotation . RetentionPolicy . SOURCE ; \n + \n - * @ param newValue New value that will be set . \n + * @ param registered True if the user is a registered attendee . \n - public static void setRegisteredAttendee ( final Context context , final boolean newValue ) { \n + public static void setRegisteredAttendee ( final Context context , final boolean registered ) { \n - newValue ? REGSTATUS _ UNREGISTERED : REGSTATUS _ REGISTERED ) \n + registered ? REGSTATUS _ REGISTERED : REGSTATUS _ UNREGISTERED ) \n",Fix reservation status \n Change - Id : I2ea856305d0d8447745f9ddb93a59226c070c120,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ schedule \ ScheduleFilterFragment . java \n - AnalyticsHelper . sendEvent ( "" Filters "" , "" Filters Updated "" , filtersDesc . toString ( ) ) ; \n + AnalyticsHelper . sendEvent ( "" Filters "" , "" Filters Updated "" , \n + String . valueOf ( filtersDesc ) ) ; \n",Fix NPE when unchecking the last checked filter \n Bug : 37790881 \n Change - Id : I050da971b5089a96ee0f8f02372fd4020cf14bbd,261
"lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ io \ SessionsHandler . java \n + import com . google . gson . Gson ; \n + import com . google . gson . JsonElement ; \n - import com . google . gson . Gson ; \n - import com . google . gson . JsonElement ; \n - import static com . google . samples . apps . iosched . util . LogUtils . * ; \n + import static com . google . samples . apps . iosched . util . LogUtils . LOGD ; \n + import static com . google . samples . apps . iosched . util . LogUtils . LOGE ; \n + import static com . google . samples . apps . iosched . util . LogUtils . LOGW ; \n + import static com . google . samples . apps . iosched . util . LogUtils . makeLogTag ; \n + buildRelatedSessionsMapping ( session , list ) ; \n - . withValue ( \n - ScheduleDatabase . SessionsTags . SESSION _ ID , \n - session . id ) \n - . withValue ( ScheduleDatabase . SessionsTags . TAG _ ID , \n - tag ) . build ( ) ) ; \n + . withValue ( ScheduleDatabase . SessionsTags . SESSION _ ID , session . id ) \n + . withValue ( ScheduleDatabase . SessionsTags . TAG _ ID , tag ) \n + . build ( ) ) ; \n + } \n + } \n + } \n + \n + private void buildRelatedSessionsMapping ( Session session , \n + ArrayList < ContentProviderOperation > list ) { \n + final Uri uri = ScheduleContractHelper . setUriAsCalledFromSyncAdapter ( \n + ScheduleContract . Sessions . buildRelatedSessionsDirUri ( session . id ) ) ; \n + \n + / / delete existing mappings \n + list . add ( ContentProviderOperation . newDelete ( uri ) . build ( ) ) ; \n + \n + / / add a mapping for each related session id \n + if ( session . relatedSessionIds ! = null ) { \n + for ( String id : session . relatedSessionIds ) { \n + list . add ( ContentProviderOperation . newInsert ( uri ) \n + . withValue ( ScheduleContract . Sessions . RELATED _ SESSION _ ID , id ) \n + . build ( ) ) ; \n lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ io \ model \ Session . java \n - import com . google . samples . apps . iosched . util . HashUtils ; \n - \n + public String [ ] relatedSessionIds ; \n",Store related sessions during sync \n Bug : 36001302 \n Change - Id : Ib9844a3c9bbaeb312f44d1b229b2bcb4bd3e6203,261
rename from apk \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ RegistrationUtils . java \n rename to lib \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ RegistrationUtils . java \n,Move class that got orphaned during directory changes \n Change - Id : I87f8ca4bfc389fdfba3999646905d84a97f88cc5,261
. gitignore \n - . idea / * \n - # Forcibly including certain files we want propagated . \n - ! \ . idea / codeStyleSettings . xml \n - ! \ . idea / copyright \n + . idea / \n + # Android Studio captures folder \n + captures / \n,Update gitignore \n Change - Id : I98b645354a20d12fb390cbf36f71fb4ddf09e550,261
"deleted file \n . idea \ copyright \ profiles _ settings . xml \n - < component name = "" CopyrightManager "" > \n - < settings default = "" "" / > \n - < / component > \n",Remove . idea / from git \n Change - Id : Ie478dd588181d2572447ca10ea3de6a657d91b4a,261
"kokoro \ build . sh \n - cd git / iosched \n + # Set up local maven repo \n + cd $ KOKORO _ GFILE _ DIR \n + unzip repository . zip \n + cd repository \n + mdc _ repo _ location = $ ( pwd ) \n - . / gradlew build \n + cd $ KOKORO _ ARTIFACTS _ DIR / git / iosched \n + \n + . / gradlew - Pmdc _ repo _ location = "" $ mdc _ repo _ location "" build \n kokoro \ continuous . cfg \n + # Extra input files / directories for the build \n + gfile _ resources : "" / x20 / teams / iosched - eng / mdc "" \n kokoro \ presubmit . cfg \n + # Extra input files / directories for the build \n + gfile _ resources : "" / x20 / teams / iosched - eng / mdc "" \n",Add local maven repo to CI \n Change - Id : I997ab4326e55be26c12ec3590fcff3a77b0a6d9c,261
"kokoro \ build . sh \n + GRADLE _ FLAGS = ( ) \n + if [ [ - n "" $ GRADLE _ DEBUG "" ] ] ; then \n + GRADLE _ FLAGS = ( - - debug - - stacktrace ) \n + fi \n + \n - . / gradlew - Pmdc _ repo _ location = "" $ mdc _ repo _ location "" build \n + . / gradlew "" $ { GRADLE _ FLAGS [ @ ] } "" - Pmdc _ repo _ location = "" $ mdc _ repo _ location "" build \n kokoro \ continuous . cfg \n + \n + env _ vars { \n + key : "" GRADLE _ DEBUG "" \n + value : "" "" \n + } \n kokoro \ continuous . sh \n + env | sort \n kokoro \ presubmit . sh \n + env | sort \n","Gradle debug option for CI \n Allows a GRADLE _ DEBUG environment variable to be set for continuous \n builds . If set to any value other than empty string , Gradle invocations \n are run with the - - debug - - stacktrace flags . \n Note that environment variables can only be passed to kokoro jobs via \n stubby . \n Change - Id : Ifdccbe3614f79a303c115abf70a12b9ba02554e3",261
"mobile \ src \ main \ res \ values \ dimens . xml \n + < dimen name = "" margin _ small "" > 8dp < / dimen > \n",Restore @ dimen / margin _ small \n Change - Id : I3d620b5270cdf33250b56df9ab74ca171ea187d2,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n + / / Also make it draw over the bottom sheet \n + child . elevation = resources . getDimension ( R . dimen . bottom _ sheet _ elevation ) \n mobile \ src \ main \ res \ layout \ fragment _ schedule _ filter . xml \n - android : elevation = "" 8dp "" \n + android : elevation = "" @ dimen / bottom _ sheet _ elevation "" \n mobile \ src \ main \ res \ values \ dimens . xml \n + < dimen name = "" bottom _ sheet _ elevation "" > 8dp < / dimen > \n",Make snackbars draw over bottom sheet \n Bug : 76395179 \n Change - Id : I92eebdaff941fd0ef04592d864f59400cb1e4448,261
wear \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ wear \ ui \ schedule \ ScheduleViewModel . kt \n - import com . google . samples . apps . iosched . shared . schedule . TagFilterMatcher \n + import com . google . samples . apps . iosched . shared . schedule . UserSessionMatcher . TagFilterMatcher \n,Fix import in wear \n Change - Id : Idd048b15f98a60bff07c2a0d36c2bcf52d41ade3,261
"mobile \ src \ main \ res \ layout \ include _ schedule _ appbar . xml \n - app : layout _ scrollFlags = "" scroll | snap | exitUntilCollapsed "" > \n + app : layout _ scrollFlags = "" scroll | snap | enterAlways "" > \n",Add quick return to schedule app bar \n Change - Id : Id6ca41e49af8b51e29ca06273c5e738d97a60dd5,261
"build . gradle \n - androidGradlePluginVersion = ' 3 . 2 . 0 - alpha17 ' \n - appcompatVersion = ' 1 . 0 . 0 - alpha1 ' \n - browserVersion = ' 1 . 0 . 0 - alpha1 ' \n - constraintLayoutVersion = ' 1 . 1 . 0 ' \n - crashlyticsVersion = ' 2 . 9 . 2 ' \n + androidGradlePluginVersion = ' 3 . 2 . 0 - beta04 ' \n + appcompatVersion = ' 1 . 0 . 0 - beta01 ' \n + browserVersion = ' 1 . 0 . 0 - beta01 ' \n + constraintLayoutVersion = ' 1 . 1 . 2 ' \n + crashlyticsVersion = ' 2 . 9 . 4 ' \n - firebaseAuthVersion = ' 15 . 1 . 0 ' \n - firebaseConfigVersion = ' 15 . 0 . 2 ' \n - firebaseCoreVersion = ' 15 . 0 . 2 ' \n - firebaseFirestoreVersion = ' 16 . 0 . 0 ' \n - firebaseMessagingVersion = ' 15 . 0 . 2 ' \n + firebaseAuthVersion = ' 16 . 0 . 2 ' \n + firebaseConfigVersion = ' 16 . 0 . 0 ' \n + firebaseCoreVersion = ' 16 . 0 . 1 ' \n + firebaseFirestoreVersion = ' 17 . 0 . 3 ' \n + firebaseMessagingVersion = ' 17 . 1 . 0 ' \n - kotlinVersion = ' 1 . 2 . 41 ' \n - ktxVersion = "" 1 . 0 . 0 - alpha1 "" \n + kotlinVersion = ' 1 . 2 . 50 ' \n + ktxVersion = "" 1 . 0 . 0 - beta01 "" \n - leanbackVersion = ' 1 . 0 . 0 - alpha1 ' \n + leanbackVersion = ' 1 . 0 . 0 - beta01 ' \n - lifecycleVersion = ' 2 . 0 . 0 - alpha1 ' \n + lifecycleVersion = ' 2 . 0 . 0 - beta01 ' \n - materialVersion = ' 1 . 0 . 0 - alpha1 ' \n + materialVersion = ' 1 . 0 . 0 - beta01 ' \n - tvproviderVersion = ' 1 . 0 . 0 - alpha1 ' \n + tvproviderVersion = ' 1 . 0 . 0 - beta01 ' \n mobile \ src \ main \ res \ values \ styles . xml \n - < style name = "" TextAppearance . IOSched . AboutButtons "" parent = "" @ style / TextAppearance . MaterialComponents . MaterialButton . Secondary "" > \n + < style name = "" TextAppearance . IOSched . AboutButtons "" parent = "" @ style / TextAppearance . MaterialComponents . Button "" > \n",AGP and dependency version bumps \n Change - Id : I63f775e3b99246ae59126ff324cb277085816fd6,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleTimeHeadersDecoration . kt \n - private val hourMinFormatter = DateTimeFormatter . ofPattern ( "" h : m "" ) \n + private val hourMinFormatter = DateTimeFormatter . ofPattern ( "" h : mm "" ) \n mobile \ src \ main \ res \ layout \ item _ session _ tag . xml \n - android : layout _ marginTop = "" @ dimen / spacing _ normal "" \n + android : layout _ marginTop = "" @ dimen / spacing _ micro "" \n",Minor UI tweaks from ADSSched \n - Fix time header minutes display \n - Adjust position of inline tags \n Bug : 124096833 \n Change - Id : Ide93d376d7b48ac85065d8a52c06f19fdc6fa0d0,261
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ feedback \ FeedbackEndpoint . kt \n - "" responses "" to responses \n + "" responses "" to responses , \n + "" client "" to "" ANDROID "" \n",Add ' client ' field to session feedback requests \n Bug : 131772361 \n Change - Id : I40cca531d1c594aaab38877dbeb27ba893a0f082,261
"mobile \ src \ main \ AndroidManifest . xml \n + < ! - - Required for apps targeting API 28 and above and using Google Maps . - - > \n + < uses - library android : name = "" org . apache . http . legacy "" android : required = "" false "" / > \n + \n",Fix crash when opening Map on API 28 and above \n Change - Id : Iaced1a2df842099c5afd1c2c86d1f7318bb1374c,261
"mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n - android : elevation = "" 6dp "" \n + app : elevation = "" 6dp "" \n",Fix crash when opening session detail \n Change - Id : Iaec7f2eeb8b27ace63e23efbb0c7f960e6355c70,261
"mobile \ src \ main \ res \ values \ strings . xml \n + \n + < ! - - Codelabs - - > \n + < string name = "" codelabs _ information "" translation _ description = "" Information about codelabs . "" > Learn about the latest and greatest Google technologies via self - paced tutorials in our ready - to - code kiosks , or bring your own machine and take your work home with you . Kiosks are open daily except during the first Keynote . < / string > \n + < string name = "" codelabs _ building "" translation _ description = "" Text of a button that shows where the Codelabs building is on the map . "" > Codelabs building < / string > \n + < string name = "" codelabs _ website "" translation _ description = "" Text of a button that launches the Codelabs website . "" > Codelabs website < / string > \n + < string name = "" codelab _ duration "" translation _ description = "" Text showing the approximate time in minutes that a user would spend during a codelab tutorial . Abbreviated . "" > Duration : % 1 $ d min < / string > \n + < string name = "" start _ codelab "" translation _ description = "" Text of a button that allows a user to start a codelab tutorial . "" > Start codelab < / string > \n",Strings for codelabs feature \n Change - Id : I284edbb63dc1ce6420cb606403d6153293be2a46,261
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ config \ AppConfigDataSource . kt \n + fun isCodelabsFeatureEnabled ( ) : Boolean \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ config \ RemoteAppConfigDataSource . kt \n + override fun isCodelabsFeatureEnabled ( ) : Boolean = \n + firebaseRemoteConfig . getBoolean ( CODELABS _ FEATURE _ ENABLED ) \n + \n + const val CODELABS _ FEATURE _ ENABLED = "" codelabs _ enabled "" \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ di \ FeatureFlagAnnotations . kt \n + \n + / / Whether or not the Codelabs feature is enabled \n + @ Qualifier \n + @ Target ( \n + AnnotationTarget . FUNCTION , AnnotationTarget . PROPERTY _ GETTER , \n + AnnotationTarget . PROPERTY _ SETTER , AnnotationTarget . FIELD \n + ) \n + annotation class CodelabsEnabledFlag \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ di \ FeatureFlagsModule . kt \n + \n + @ Provides \n + @ CodelabsEnabledFlag \n + fun provideCodelabsEnabledFlag ( appConfig : AppConfigDataSource ) : Boolean { \n + return appConfig . isCodelabsFeatureEnabled ( ) \n + } \n shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n + < entry > \n + < key > codelabs _ enabled < / key > \n + < value > true < / value > \n + < / entry > \n shared \ src \ staging \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ FakeAppConfigDataSource . kt \n + override fun isCodelabsFeatureEnabled ( ) : Boolean = true \n",Add config flag for codelabs \n Bug : 123675403 \n Change - Id : I9df596f9b7fc97a212d5ba8d3eb8cf8057304ecc,261
"mobile \ src \ main \ res \ values \ styles . xml \n + < item name = "" android : textSize "" tools : ignore = "" SpUsage "" > 20dp < / item > \n",Don ' t shrink toolbar titles in landscape \n Bug : 129806266 \n Change - Id : Ic902a18ce417ab7887bf69283907d5ae70fb28a8,261
"mobile \ src \ main \ res \ values - night \ colors . xml \n - < color name = "" system _ ui _ scrim _ black "" > # 54000000 < / color > < ! - - 33 % black - - > \n + < color name = "" system _ ui _ scrim _ black "" > # B3000000 < / color > < ! - - 70 % black - - > \n",Make the nav bar scrim darker in night mode \n Bug : 129805953 \n Change - Id : I72e6f60a89d43cf5fede36cfbc0998313b157a48,261
"mobile \ src \ main \ res \ values \ strings . xml \n - < ! - - Day labels for schedule - - > \n - < string name = "" day _ indicators _ label _ date "" translation _ description = "" Label in front of conference day indicators above schedule content when using conference time zone "" > May : < / string > \n - < string name = "" day _ indicators _ label _ ordinal "" translation _ description = "" Label in front of conference day indicators above schedule content when using another time zone "" > Day : < / string > \n - < string name = "" day1 "" translation _ description = "" Label for the first day of the conference "" > Day 1 < / string > \n - < string name = "" day2 "" translation _ description = "" Label for the second day of the conference "" > Day 2 < / string > \n - < string name = "" day3 "" translation _ description = "" Label for the third day of the conference "" > Day 3 < / string > \n - < string name = "" day1 _ date "" translation _ description = "" Actual date of the first day of the conference "" > May 7 < / string > \n - < string name = "" day2 _ date "" translation _ description = "" Actual date of the second day of the conference "" > May 8 < / string > \n - < string name = "" day3 _ date "" translation _ description = "" Actual date of the third day of the conference "" > May 9 < / string > \n - \n",Remove duplicate schedule strings \n Change - Id : I2ec0598835e9d894f68ac2be3882e4c3d4812c81,261
"mobile \ build . gradle \n - api "" com . jakewharton . threetenabp : threetenabp : $ rootProject . threetenabpVersion "" \n + implementation "" com . jakewharton . threetenabp : threetenabp : $ rootProject . threetenabpVersion "" \n",Use implementation for threetenabp \n Change - Id : I64d41c20a353ada28ee4413de4e2414c82b9ab75,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ MainActivity . kt \n - import androidx . appcompat . content . res . AppCompatResources \n + import com . google . samples . apps . iosched . util . navigationItemBackground \n - / / Need to inflate the CSL via AppCompatResources and set it as the tint \n - itemBackground = itemBackground ? . mutate ( ) ? . apply { \n - val tint = AppCompatResources . getColorStateList ( \n - context , R . color . navigation _ item _ background _ tint ) \n - setTintList ( tint ) \n - } \n + itemBackground = navigationItemBackground ( context ) \n new file \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ UiUtils . kt \n + / * \n + * Copyright 2019 Google LLC \n + * \n + * Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + * you may not use this file except in compliance with the License . \n + * You may obtain a copy of the License at \n + * \n + * https : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + * \n + * Unless required by applicable law or agreed to in writing , software \n + * distributed under the License is distributed on an "" AS IS "" BASIS , \n + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + * See the License for the specific language governing permissions and \n + * limitations under the License . \n + * / \n + \n + package com . google . samples . apps . iosched . util \n + \n + import android . content . Context \n + import android . graphics . drawable . Drawable \n + import androidx . appcompat . content . res . AppCompatResources \n + import androidx . core . graphics . drawable . DrawableCompat \n + import com . google . samples . apps . iosched . R \n + \n + fun navigationItemBackground ( context : Context ) : Drawable ? { \n + / / Need to inflate the drawable and CSL via AppCompatResources to work on Lollipop \n + var background = \n + AppCompatResources . getDrawable ( context , R . drawable . navigation _ item _ background ) \n + if ( background ! = null ) { \n + val tint = AppCompatResources . getColorStateList ( \n + context , R . color . navigation _ item _ background _ tint \n + ) \n + background = DrawableCompat . wrap ( background . mutate ( ) ) \n + background . setTintList ( tint ) \n + } \n + return background \n + } \n",Fix navigation drawer item background on Lollipop \n Bug : 129468745 \n Change - Id : Iea0f4bbc7ab08e4202ce0423eb8b3d4e5acaff65,261
"mobile \ src \ main \ res \ values - night \ colors . xml \n + < color name = "" color _ on _ secondary "" > # 000 < / color > \n mobile \ src \ main \ res \ values \ colors . xml \n + < color name = "" color _ on _ secondary "" > # FFF < / color > \n mobile \ src \ main \ res \ values \ themes . xml \n + < item name = "" colorOnSecondary "" > @ color / color _ on _ secondary < / item > \n",Make FAB icon tint respond to theme setting \n Bug : 129543449 \n Change - Id : I9a00bed579f828fc125f1b2043c306fa5d3787fa,261
"mobile \ src \ main \ res \ values \ styles . xml \n - < style name = "" AlertDialog . Style "" parent = "" MaterialAlertDialog . MaterialComponents "" > \n - < item name = "" shapeAppearanceOverlay "" > @ style / AlertDialog . ShapeAppearanceOverlay < / item > \n - < / style > \n - \n - < style name = "" AlertDialog . ShapeAppearanceOverlay "" parent = "" ShapeAppearance . MaterialComponents . MediumComponent "" > \n - < item name = "" cornerSize "" > @ dimen / dialog _ corner _ radius < / item > \n - < / style > \n - \n mobile \ src \ main \ res \ values \ themes . xml \n - < item name = "" alertDialogTheme "" > @ style / AlertDialog . Theme < / item > \n - < item name = "" alertDialogStyle "" > @ style / AlertDialog . Style < / item > \n + < item name = "" materialAlertDialogTheme "" > @ style / AlertDialog . Theme < / item > \n - < style name = "" AlertDialog . Theme "" parent = "" ThemeOverlay . MaterialComponents . Dialog . Alert "" > \n - < item name = "" android : textViewStyle "" > @ style / Widget . IOSched . TextView < / item > \n - < item name = "" materialAlertDialogTitleTextStyle "" > @ style / AlertDialog . TitleText < / item > \n - < item name = "" materialAlertDialogTitlePanelStyle "" > @ style / AlertDialog . TitlePanel < / item > \n + < style name = "" AlertDialog . Theme "" parent = "" ThemeOverlay . MaterialComponents . MaterialAlertDialog "" > \n - < item name = "" buttonBarPositiveButtonStyle "" > @ style / Widget . IOSched . RaisedButton < / item > \n + < item name = "" buttonBarPositiveButtonStyle "" > @ style / Widget . IOSched . BorderlessButton < / item > \n + < item name = "" dialogCornerRadius "" > @ dimen / dialog _ corner _ radius < / item > \n - < ! - - This is the text appearance of AlertDialog ' s message - - > \n - < item name = "" textAppearanceBody1 "" > @ style / TextAppearance . AlertDialog . Message < / item > \n + < item name = "" materialAlertDialogTitleTextStyle "" > @ style / AlertDialog . TitleText < / item > \n + < item name = "" materialAlertDialogTitlePanelStyle "" > @ style / AlertDialog . TitlePanel < / item > \n + < item name = "" materialAlertDialogBodyTextStyle "" > @ style / TextAppearance . AlertDialog . Message < / item > \n",Update material dialog theme \n - Fixes how our material dialog theme is applied \n - Updates positive button style according to latest mocks \n Change - Id : I0087c6481e5d2310103d548fb34ae6c926cf05a6,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n + super . onViewCreated ( view , savedInstanceState ) \n mobile \ src \ main \ res \ drawable \ ic _ menu . xml \n - - > \n - android : width = "" 24dp "" \n - android : height = "" 24dp "" \n - android : viewportWidth = "" 24 . 0 "" \n - android : viewportHeight = "" 24 . 0 "" > \n + android : width = "" 24dp "" \n + android : height = "" 24dp "" \n + android : viewportWidth = "" 24 . 0 "" \n + android : viewportHeight = "" 24 . 0 "" \n + android : tint = "" ? colorControlNormal "" > \n - android : pathData = "" M3 , 18h18v - 2L3 , 16v2zM3 , 13h18v - 2L3 , 11v2zM3 , 6v2h18L21 , 6L3 , 6z "" / > \n + android : pathData = "" M3 , 18h18v - 2L3 , 16v2zM3 , 13h18v - 2L3 , 11v2zM3 , 6v2h18L21 , 6L3 , 6z "" / > \n",More toolbar fixes \n Bug : 127419772 \n Change - Id : Id839e301f553e6b439c89b3ffc6180f8a055b833,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ codelabs \ CodelabsFragment . kt \n + import com . google . samples . apps . iosched . shared . util . activityViewModelProvider \n - binding = FragmentCodelabsBinding . inflate ( inflater , container , false ) \n + binding = FragmentCodelabsBinding . inflate ( inflater , container , false ) . apply { \n + activityViewModel = activityViewModelProvider ( viewModelFactory ) \n + } \n mobile \ src \ main \ res \ layout \ fragment _ codelabs . xml \n + \n + < variable \n + name = "" activityViewModel "" \n + type = "" com . google . samples . apps . iosched . ui . MainActivityViewModel "" / > \n - app : title = "" @ string / event _ codelabs _ title "" / > \n + app : title = "" @ string / event _ codelabs _ title "" > \n + \n + < ImageView \n + android : id = "" @ + id / user _ avatar "" \n + android : layout _ width = "" @ dimen / nav _ account _ image _ size "" \n + android : layout _ height = "" @ dimen / nav _ account _ image _ size "" \n + android : layout _ gravity = "" center _ vertical | end "" \n + android : layout _ margin = "" @ dimen / margin _ small "" \n + android : contentDescription = "" @ null "" \n + android : onClick = "" @ { ( ) - > activityViewModel . onProfileClicked ( ) } "" \n + app : clipToCircle = "" @ { true } "" \n + app : imageUri = "" @ { activityViewModel . currentUserImageUri } "" \n + app : placeholder = "" @ { @ drawable / ic _ default _ profile _ avatar } "" \n + app : signInContentDescription = "" @ { activityViewModel . currentUserInfo } "" \n + tools : srcCompat = "" @ drawable / ic _ default _ profile _ avatar "" / > \n + \n + < / androidx . appcompat . widget . Toolbar > \n",Show profile avatar on Codelabs \n Bug : 123675403 \n Change - Id : I14a0fabcca7ac235cb95d5e03361a622d0eb194e,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ filters \ EventFilterView . kt \n + import android . graphics . Typeface \n + private val cornerRadius : Float \n + \n + typeface = Typeface . MONOSPACE \n + cornerRadius = a . getDimension ( R . styleable . EventFilterView _ cornerRadius , 0f ) \n - outline . setRoundRect ( 0 , 0 , w , h , h / 2f ) \n + val rounding = cornerRadius . coerceAtMost ( h / 2f ) \n + outline . setRoundRect ( 0 , 0 , w , h , rounding ) \n - val rounding = ( height - strokeWidth ) / 2f \n + val rounding = cornerRadius . coerceAtMost ( ( height - strokeWidth ) / 2f ) \n mobile \ src \ main \ res \ values \ attrs . xml \n + < attr name = "" cornerRadius "" format = "" dimension "" / > \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" starred _ and _ reserved _ short "" > Starred & amp ; reserved < / string > \n + < string name = "" starred _ and _ reserved _ short "" > Your events < / string > \n mobile \ src \ main \ res \ values \ styles . xml \n + < item name = "" android : fontFamily "" > monospace < / item > \n + < item name = "" android : fontFamily "" > monospace < / item > \n - < item name = "" android : strokeColor "" > ? android : textColorTertiary < / item > \n + < item name = "" android : strokeColor "" > ? colorControlLight < / item > \n + < item name = "" cornerRadius "" > 8dp < / item > \n",Update tags UI on sessions and in filters sheet \n Bug : 129995760 \n Change - Id : Ib72d21bea0582be694aa1f395d4154d0d933a16a,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ filters \ EventFilterView . kt \n - var selectedTextColor : Int ? = null \n + var selectedTextColor : Int = 0 \n + set ( value ) { \n + field = value \n + if ( value ! = 0 ) { \n + clear . mutate ( ) . setTint ( value ) \n + } \n + } \n - textPaint . color = if ( selectedColor ! = null & & selectedColor ! = 0 & & progress > 0 ) { \n + textPaint . color = if ( selectedColor ! = 0 & & progress > 0 ) { \n mobile \ src \ main \ res \ drawable \ ic _ clear _ all . xml \n - android : tint = "" ? colorPrimary "" > \n + android : tint = "" ? colorControlNormal "" > \n mobile \ src \ main \ res \ layout \ fragment _ schedule _ filter . xml \n - android : tint = "" ? attr / colorControlNormal "" \n shared \ src \ main \ res \ drawable \ tag _ clear . xml \n + < ! - - Tinted at runtime - - > \n - android : fillAlpha = "" 0 . 8 "" \n - android : fillColor = "" # fff "" \n - android : pathData = "" M12 , 0 A12 , 12 , 0 1 , 1 12 , 24 A12 , 12 , 0 1 , 1 12 , 0 z "" / > \n - < path \n - android : pathData = "" M7 , 7L17 , 17M17 , 7L7 , 17Z "" \n - android : strokeAlpha = "" 0 . 5 "" \n + android : pathData = "" M4 , 4L20 , 20M20 , 4L4 , 20Z "" \n - android : strokeWidth = "" 2 "" / > \n + android : strokeWidth = "" 3 "" / > \n",Fix tag filter ' x ' icon for dark mode \n Change - Id : Ia43179ce7b6f65b15c208a8a037dbf10db14c40d,261
"rename from mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ DispatchInsetsNavHostFragment . kt \n rename to mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ DispatchInsetsNavHostFragment . kt \n - package com . google . samples . apps . iosched \n + package com . google . samples . apps . iosched . ui \n - import android . view . LayoutInflater \n - override fun onCreateView ( \n - inflater : LayoutInflater , \n - container : ViewGroup ? , \n - savedInstanceState : Bundle ? \n - ) : View ? { \n - val root = super . onCreateView ( inflater , container , savedInstanceState ) \n - root ? . setOnApplyWindowInsetsListener { v , insets - > \n + override fun onViewCreated ( view : View , savedInstanceState : Bundle ? ) { \n + super . onViewCreated ( view , savedInstanceState ) \n + view . setOnApplyWindowInsetsListener { v , insets - > \n - return root \n mobile \ src \ main \ res \ layout \ activity _ main . xml \n - android : name = "" com . google . samples . apps . iosched . DispatchInsetsNavHostFragment "" \n + android : name = "" com . google . samples . apps . iosched . ui . DispatchInsetsNavHostFragment "" \n",Move DispathInsetsNavHostFragment to ui package \n Change - Id : I3fe63084b887e896c28d910a580c2726661c1f0e,261
"shared \ src \ main \ res \ font \ google _ sans _ medium . xml \n - - > \n - < font - family xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + < font - family \n + xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n - app : fontProviderQuery = "" Google Sans : 500 "" / > \n + app : fontProviderQuery = "" Google Sans : 500 "" \n + tools : ignore = "" FontValidationError , FontValidationWarning , UnusedAttribute "" / > \n",Fix lint warnings for Google Sans Medium \n Change - Id : If40bae390efe8210f98b8faf40e8463ac683f5e1,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapUtils . kt \n - setTitle ( title ) \n + / / Don ' t set the title because we don ' t want to show an InfoWindow , but set the snippet for \n + / / accessibility services ( TalkBack ) . \n + snippet = title \n",Don ' t show InfoWindow for text label map markers \n Bug : 130692240 \n Change - Id : Id5160e752ff8339e76043530b9a4f69150b664cd,261
"mobile \ src \ main \ res \ layout \ item _ codelabs _ information _ card . xml \n - app : contentPadding = "" @ dimen / margin _ normal "" \n + app : contentPaddingBottom = "" @ dimen / margin _ small "" \n + app : contentPaddingLeft = "" @ dimen / margin _ normal "" \n + app : contentPaddingRight = "" @ dimen / margin _ normal "" \n + app : contentPaddingTop = "" @ dimen / margin _ normal "" \n + android : layout _ marginTop = "" @ dimen / margin _ small "" \n",Adjust button alignment in codelabs info card \n Change - Id : Iba6e26527efc2c3c8d74cc498dc9e723f40d608d,261
"build . gradle \n - lottieVersion = "" 2 . 5 . 1 "" \n + lottieVersion = "" 3 . 0 . 0 "" \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ widget \ CountdownView . kt \n - import com . airbnb . lottie . LottieAnimationView . CacheStrategy . Strong \n - view . setAnimation ( "" anim / $ oldValue . json "" , Strong ) \n + view . setAnimation ( "" anim / $ oldValue . json "" ) \n - view . setAnimation ( "" anim / $ newValue . json "" , Strong ) \n + view . setAnimation ( "" anim / $ newValue . json "" ) \n - view . setAnimation ( "" anim / $ newValue . json "" , Strong ) \n + view . setAnimation ( "" anim / $ newValue . json "" ) \n",Update Lottie version \n Change - Id : I6da2366c57fd89d344fa03791d0776e6b3cf6d00,261
gradle . properties \n - conference _ day1 _ afterhours _ start = 2019 - 05 - 07T19 : 00 : 00 - 07 : 00 \n + conference _ day1 _ afterhours _ start = 2019 - 05 - 07T18 : 30 : 00 - 07 : 00 \n,Fix start time for After Dark \n Change - Id : I170e4c3ef6fcb76159049d1c55008bb8956200cc,261
"mobile \ src \ main \ res \ raw \ map _ markers _ day . json \n - "" id "" : "" community _ lounge "" , \n + "" id "" : "" 110e32b3 - 50b9 - 4661 - 873d - 4ac68a691375 , community _ lounge "" , \n + { \n + "" id "" : "" bb3d8fbf - 6b3f - 4316 - 816e - deae33bdf035 , boardwalk "" , \n + "" type "" : "" Feature "" , \n + "" properties "" : { \n + "" title "" : "" Boardwalk "" , \n + "" description "" : "" Experience all the community and culture of I / O by taking a stroll down the Boardwalk . There you’ll find our own Broadcast Studio , Draw to Art ( interactive easels from Google Arts & Culture powered by ML ) , lightning sessions , and other fun surprises . "" , \n + "" minZoom "" : 99 \n + } , \n + "" geometry "" : { \n + "" type "" : "" Point "" , \n + "" coordinates "" : [ - 122 . 079476 , 37 . 425391 ] \n + } \n + } , \n mobile \ src \ main \ res \ raw \ map _ markers _ night . json \n + { \n + "" id "" : "" bb3d8fbf - 6b3f - 4316 - 816e - deae33bdf035 , boardwalk "" , \n + "" type "" : "" Feature "" , \n + "" properties "" : { \n + "" title "" : "" Boardwalk "" , \n + "" description "" : "" Experience all the community and culture of I / O by taking a stroll down the Boardwalk . There you’ll find our own Broadcast Studio , Draw to Art ( interactive easels from Google Arts & Culture powered by ML ) , lightning sessions , and other fun surprises . "" , \n + "" minZoom "" : 99 \n + } , \n + "" geometry "" : { \n + "" type "" : "" Point "" , \n + "" coordinates "" : [ - 122 . 079476 , 37 . 425391 ] \n + } \n + } , \n","Fix map linking for Meetups and Lightning Talks \n - Adds the room ID for Community Lounge \n - Adds an invisible marker for Boardwalk since "" Boardwalk "" appears on \n the map overlay \n Bug : 131463430 \n Change - Id : I3f3fc2011e5af2161739411353e4b3e14a6c4af3",261
"build . gradle \n + \n + / / ` spotlessCheck ` runs when a build includes ` check ` , notably during presubmit . In these cases \n + / / we prefer ` spotlessCheck ` run as early as possible since it fails in seconds . This prevents a \n + / / build from running for several minutes doing other intensive tasks ( resource processing , code \n + / / generation , compilation , etc ) only to fail on a formatting nit . \n + / / Using ` mustRunAfter ` avoids creating a task dependency . The order is enforced only if \n + / / ` spotlessCheck ` is already scheduled to run , so we can still build and launch from the IDE \n + / / while the code is "" dirty "" . \n + tasks . whenTaskAdded { \n + if ( name = = ' preBuild ' ) { \n + mustRunAfter ' spotlessCheck ' \n + } \n + } \n","Make spotlessCheck run early \n spotlessCheck is very quick , so executing it early prevents a build \n from running for several minutes and then failing due to a formatting \n nit . \n Bug : 131610133 \n Change - Id : Iff7962592d786155cc09b414528b8a36c438387b",261
"mobile \ build . gradle \n - resValue "" string "" , "" version _ name "" , "" Version $ { rootProject . versionName } "" \n - \n + versionNameSuffix = ' - debug ' \n + versionNameSuffix = ' - staging ' \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ settings \ SettingsFragment . kt \n + import android . widget . TextView \n + import com . google . samples . apps . iosched . R \n + \n + @ BindingAdapter ( "" versionName "" ) \n + fun setVersionName ( view : TextView , versionName : String ) { \n + view . text = view . resources . getString ( R . string . version _ name , versionName ) \n + } \n mobile \ src \ main \ res \ layout \ fragment _ settings . xml \n + < import type = "" com . google . samples . apps . iosched . BuildConfig "" / > \n + \n - android : text = "" @ string / version _ name "" / > \n + app : versionName = "" @ { BuildConfig . VERSION _ NAME } "" / > \n mobile \ src \ main \ res \ values \ strings . xml \n - \n + < ! - - Settings - - > \n + < string name = "" settings _ title "" translation _ description = "" Title for the tab that shows all the settings of this app . "" > Settings < / string > \n + < string name = "" version _ name "" translation _ description = "" Label for the app version name in Settings . "" > Version % s < / string > \n + \n - < string name = "" settings _ title "" translation _ description = "" Title for the tab that shows all the settings of this app . "" > Settings < / string > \n",Add versionNameSuffix to build configs \n Adds a versionNameSuffix so that it ' s easy to tell which build variant \n is running by checking in Settings . Release builds have no suffix . \n Change - Id : I9290a95dba5b11434ae8aca6e217c0ec75f1b972,261
"mobile \ src \ main \ res \ layout \ fragment _ schedule . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n - tools : text = "" @ string / schedule _ filters _ empty "" \n mobile \ src \ main \ res \ layout \ fragment _ search . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n mobile \ src \ main \ res \ layout \ item _ feed _ announcements _ placeholder . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n mobile \ src \ main \ res \ values \ styles . xml \n + < ! - - Misc - - > \n + < style name = "" Widget . IOSched . EmptyResults "" > \n + < item name = "" android : drawablePadding "" > @ dimen / margin _ normal < / item > \n + < item name = "" android : drawableTop "" > @ drawable / no _ items _ found _ 204 < / item > \n + < item name = "" android : gravity "" > center _ horizontal < / item > \n + < item name = "" android : textAppearance "" > ? android : textAppearanceMedium < / item > \n + < / style > \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ feed \ LoadAnnouncementsUseCase . kt \n - import com . google . samples . apps . iosched . shared . data . feed . FeedRepository \n + import com . google . samples . apps . iosched . shared . data . feed . FeedRepository \n",Consolidate style for empty results views \n Change - Id : Ib6af7aa8965309aa70549e2a0aa66591e7688a49,261
"mobile \ src \ main \ res \ layout \ fragment _ schedule . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n - tools : text = "" @ string / schedule _ filters _ empty "" \n mobile \ src \ main \ res \ layout \ fragment _ search . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : layout _ gravity = "" center "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n mobile \ src \ main \ res \ layout \ item _ feed _ announcements _ placeholder . xml \n + style = "" @ style / Widget . IOSched . EmptyResults "" \n - android : drawablePadding = "" @ dimen / spacing _ normal "" \n - android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n - android : gravity = "" center "" \n mobile \ src \ main \ res \ values \ styles . xml \n + < ! - - Misc - - > \n + < style name = "" Widget . IOSched . EmptyResults "" > \n + < item name = "" android : drawablePadding "" > @ dimen / margin _ normal < / item > \n + < item name = "" android : drawableTop "" > @ drawable / no _ items _ found _ 204 < / item > \n + < item name = "" android : gravity "" > center _ horizontal < / item > \n + < item name = "" android : textAppearance "" > ? android : textAppearanceMedium < / item > \n + < / style > \n",Consolidate style for empty results views \n Change - Id : I0e66477c24f7c1534772a620658f06586a09147f,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ MainActivityViewModel . kt \n - import com . google . samples . apps . iosched . domain . ar . ArCoreAvailabilityLiveData \n + import com . google . samples . apps . iosched . ui . ar . ArCoreAvailabilityLiveData \n rename from mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ domain \ ar \ ArCoreAvailabilityLiveData . kt \n rename to mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ ar \ ArCoreAvailabilityLiveData . kt \n - package com . google . samples . apps . iosched . domain . ar \n + package com . google . samples . apps . iosched . ui . ar \n rename from mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ domain \ ar \ ArCoreNotSupportedFragment . kt \n rename to mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ ar \ ArCoreNotSupportedFragment . kt \n - package com . google . samples . apps . iosched . domain . ar \n + package com . google . samples . apps . iosched . ui . ar \n - } \n + } \n rename from mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ domain \ ar \ NoNetworkConnectionFragment . kt \n rename to mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ ar \ NoNetworkConnectionFragment . kt \n - package com . google . samples . apps . iosched . domain . ar \n + package com . google . samples . apps . iosched . ui . ar \n - } \n + } \n mobile \ src \ main \ res \ navigation \ nav _ graph . xml \n - android : name = "" com . google . samples . apps . iosched . domain . ar . NoNetworkConnectionFragment "" \n + android : name = "" com . google . samples . apps . iosched . ui . ar . NoNetworkConnectionFragment "" \n - android : name = "" com . google . samples . apps . iosched . domain . ar . ArCoreNotSupportedFragment "" \n + android : name = "" com . google . samples . apps . iosched . ui . ar . ArCoreNotSupportedFragment "" \n",Move AR to ui package \n Change - Id : Ia10e2fa767ef3e09bfa1ea097758a0ef9ea20cab,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ filters \ EventFilterView . kt \n - var showIcons : Boolean = true \n + private var showIcons : Boolean = true \n + letterSpacing = a . getFloat ( R . styleable . EventFilterView _ android _ letterSpacing , 0f ) \n mobile \ src \ main \ res \ values \ attrs . xml \n + < attr name = "" android : letterSpacing "" / > \n mobile \ src \ main \ res \ values \ dimens . xml \n + < item name = "" tag _ letter _ spacing "" type = "" dimen "" format = "" float "" > - 0 . 06 < / item > \n + \n mobile \ src \ main \ res \ values \ styles . xml \n - < style name = "" TextAppearance . IOSched . Tag "" parent = "" @ style / TextAppearance . IOSched . ListSecondary "" / > \n + < style name = "" TextAppearance . IOSched . Tag "" parent = "" @ style / TextAppearance . IOSched . ListSecondary "" > \n + < item name = "" android : fontFamily "" > monospace < / item > \n + < item name = "" android : letterSpacing "" > @ dimen / tag _ letter _ spacing < / item > \n + < / style > \n - < item name = "" android : fontFamily "" > monospace < / item > \n - < / style > \n - \n - < style name = "" Widget . IOSched . Tag . Chip "" > \n - < item name = "" android : background "" > @ drawable / tag _ filled < / item > \n - < item name = "" android : paddingLeft "" > @ dimen / tag _ hz _ padding < / item > \n - < item name = "" android : paddingRight "" > @ dimen / tag _ hz _ padding < / item > \n - < item name = "" android : paddingTop "" > @ dimen / tag _ vert _ padding < / item > \n - < item name = "" android : paddingBottom "" > @ dimen / tag _ vert _ padding < / item > \n - < item name = "" android : textColor "" > ? android : textColorPrimary < / item > \n - < item name = "" android : fontFamily "" > monospace < / item > \n + < item name = "" android : letterSpacing "" > @ dimen / tag _ letter _ spacing < / item > \n",Shrink letter spacing on tags & filters \n Bug : 129995760 \n Change - Id : Ic75f9570ce846a7fd7fe5b315e0109db177c7f23,261
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ session \ json \ SpeakerDeserializer . kt \n - websiteUrl = social ? . get ( "" website "" ) ? . asString , \n - twitterUrl = social ? . get ( "" twitter "" ) ? . asString , \n - githubUrl = social ? . get ( "" github "" ) ? . asString , \n - linkedInUrl = social ? . get ( "" linkedin "" ) ? . asString \n + websiteUrl = social ? . get ( "" Website "" ) ? . asString , \n + twitterUrl = social ? . get ( "" Twitter "" ) ? . asString , \n + githubUrl = social ? . get ( "" GitHub "" ) ? . asString , \n + linkedInUrl = social ? . get ( "" LinkedIn "" ) ? . asString \n",Update Speaker deserializer \n Bug : 130086627 \n Change - Id : I3588be0717b72865e732df06f113354bfcd04701,261
"ar \ build . gradle \n + buildTypes { \n + staging { \n + initWith debug \n + \n + / / Specifies a sorted list of fallback build types that the \n + / / plugin should try to use when a dependency does not include a \n + / / "" staging "" build type . \n + / / Used with : test - shared , which doesn ' t have a staging variant . \n + matchingFallbacks = [ ' debug ' ] \n + } \n + } \n + \n - \n",Staging build type in ar module \n Bug : 130159276 \n Change - Id : I57aec2f2066c236bf099746134810db9dce168f8,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ codelabs \ CodelabsAdapter . kt \n - private val tagViewPool : RecycledViewPool , \n + private val tagViewPool : RecycledViewPool , \n + private val isMapEnabled : Boolean , \n + mapEnabled = isMapEnabled \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ codelabs \ CodelabsFragment . kt \n + import com . google . samples . apps . iosched . shared . di . MapFeatureEnabledFlag \n + @ Inject \n + @ JvmField \n + @ MapFeatureEnabledFlag \n + var mapFeatureEnabled : Boolean = false \n + \n - codelabsAdapter = CodelabsAdapter ( tagRecycledViewPool , this , savedInstanceState ) \n + codelabsAdapter = CodelabsAdapter ( \n + this , \n + tagRecycledViewPool , \n + mapFeatureEnabled , \n + savedInstanceState \n + ) \n mobile \ src \ main \ res \ layout \ item _ codelabs _ header . xml \n + \n + < variable \n + name = "" mapEnabled "" \n + type = "" boolean "" / > \n + app : goneUnless = "" @ { mapEnabled } "" \n","Hide "" Codelabs building "" button when Map is disabled \n Bug : 130162753 \n Change - Id : I15b071ae4cf7331a1c94274e28ac992ed9d8e359",261
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ filters \ ScheduleFilterFragment . kt \n - eventFilters . forEach { outer - > \n - if ( outer is ViewGroup ) { \n - outer . forEach { view - > \n - if ( view is EventFilterView & & view . isChecked ) { \n - view . animateCheckedAndInvoke ( false ) { \n - listener . onClick ( reset ) \n - } \n + eventFilters . forEach { child - > \n + child . findViewById < EventFilterView > ( R . id . filter _ label ) ? . let { filterView - > \n + if ( filterView . isChecked ) { \n + filterView . animateCheckedAndInvoke ( false ) { \n + listener . onClick ( reset ) \n,Fix Reset button on filterrs bottom sheet not working \n Bug : 130202241 \n Change - Id : Ie05506fdcda09099692939d2f83fc99337c55937,261
"new file \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ DispatchInsetsNavHostFragment . kt \n + / * \n + * Copyright 2019 Google LLC \n + * \n + * Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + * you may not use this file except in compliance with the License . \n + * You may obtain a copy of the License at \n + * \n + * https : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + * \n + * Unless required by applicable law or agreed to in writing , software \n + * distributed under the License is distributed on an "" AS IS "" BASIS , \n + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + * See the License for the specific language governing permissions and \n + * limitations under the License . \n + * / \n + \n + package com . google . samples . apps . iosched \n + \n + import android . os . Bundle \n + import android . view . LayoutInflater \n + import android . view . View \n + import android . view . ViewGroup \n + import androidx . core . view . forEach \n + import androidx . navigation . fragment . NavHostFragment \n + \n + class DispatchInsetsNavHostFragment : NavHostFragment ( ) { \n + \n + override fun onCreateView ( \n + inflater : LayoutInflater , \n + container : ViewGroup ? , \n + savedInstanceState : Bundle ? \n + ) : View ? { \n + val root = super . onCreateView ( inflater , container , savedInstanceState ) \n + root ? . setOnApplyWindowInsetsListener { v , insets - > \n + / / During fragment transitions , multiple fragment ' s view hierarchies can be added at the \n + / / same time . If one consumes window insets , the other might not be layed out properly . \n + / / To workaround that , make sure we dispatch the insets to all children , regardless of \n + / / how they are consumed . \n + ( v as ? ViewGroup ) ? . forEach { child - > \n + child . dispatchApplyWindowInsets ( insets ) \n + } \n + insets \n + } \n + return root \n + } \n + } \n mobile \ src \ main \ res \ layout \ activity _ main . xml \n - android : name = "" androidx . navigation . fragment . NavHostFragment "" \n + android : name = "" com . google . samples . apps . iosched . DispatchInsetsNavHostFragment "" \n",Fix window insets when returning from Speaker Detail \n Bug : 130197122 \n Change - Id : I93655257e7030ac341cf2a90dcd27c8ecee67846,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ codelabs \ CodelabsFragment . kt \n + import android . net . Uri \n - import com . google . samples . apps . iosched . util . openWebsiteUrl \n + import com . google . samples . apps . iosched . util . openWebsiteUri \n + private const val PARAM _ UTM _ SOURCE = "" utm _ source "" \n + private const val PARAM _ UTM _ MEDIUM = "" utm _ medium "" \n + private const val VALUE _ UTM _ SOURCE = "" ioapp "" \n + private const val VALUE _ UTM _ MEDIUM = "" android "" \n - openWebsiteUrl ( requireContext ( ) , CODELABS _ WEBSITE ) \n + openWebsiteUri ( requireContext ( ) , addCodelabsAnalyticsQueryParams ( CODELABS _ WEBSITE ) ) \n - openWebsiteUrl ( requireContext ( ) , codelab . codelabUrl ) \n + openWebsiteUri ( requireContext ( ) , addCodelabsAnalyticsQueryParams ( codelab . codelabUrl ) ) \n + \n + private fun addCodelabsAnalyticsQueryParams ( url : String ) : Uri { \n + return Uri . parse ( url ) \n + . buildUpon ( ) \n + . appendQueryParameter ( PARAM _ UTM _ SOURCE , VALUE _ UTM _ SOURCE ) \n + . appendQueryParameter ( PARAM _ UTM _ MEDIUM , VALUE _ UTM _ MEDIUM ) \n + . build ( ) \n + } \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ ViewBindingAdapters . kt \n + openWebsiteUri ( context , Uri . parse ( url ) ) \n + } \n + \n + fun openWebsiteUri ( context : Context , uri : Uri ) { \n - CustomTabsIntent . Builder ( ) . apply { \n - setToolbarColor ( ContextCompat . getColor ( context , R . color . colorPrimary ) ) \n - setSecondaryToolbarColor ( ContextCompat . getColor ( context , R . color . colorPrimaryDark ) ) \n - } . build ( ) . launchUrl ( context , Uri . parse ( url ) ) \n + CustomTabsIntent . Builder ( ) \n + . setToolbarColor ( ContextCompat . getColor ( context , R . color . colorPrimary ) ) \n + . setSecondaryToolbarColor ( ContextCompat . getColor ( context , R . color . colorPrimaryDark ) ) \n + . build ( ) \n + . launchUrl ( context , uri ) \n - val intent = Intent ( Intent . ACTION _ VIEW ) . apply { \n - data = Uri . parse ( url ) \n - } \n - context . startActivity ( intent , null ) \n + context . startActivity ( Intent ( Intent . ACTION _ VIEW , uri ) ) \n",Append analytics query parameters to codelabs urls \n Bug : 130243593 \n Change - Id : Icec721d0ba7fdc7ea5b7922f45fd6d6fdfe041fd,261
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ widget \ JumpSmoothScroller . kt \n - import kotlin . math . abs \n - val firstVisible = layoutManager . findFirstVisibleItemPosition ( ) \n - if ( abs ( firstVisible - targetPosition ) > maxDifference ) { \n - val jumpTo = if ( targetPosition < firstVisible ) { \n - targetPosition + maxDifference \n - } else { \n - targetPosition - maxDifference \n - } \n - action . jumpTo ( jumpTo ) \n + if ( targetPosition + maxDifference < layoutManager . findFirstVisibleItemPosition ( ) ) { \n + action . jumpTo ( targetPosition + maxDifference ) \n + return \n + } \n + if ( targetPosition - maxDifference > layoutManager . findLastVisibleItemPosition ( ) ) { \n + action . jumpTo ( targetPosition - maxDifference ) \n,Fix smooth scroll on Schedule in landscape \n Bug : 130263415 \n Change - Id : I0956fdee579acec5464b3a4cec5bef1d5a456c72,261
"shared \ src \ main \ res \ values \ strings . xml \n + \n + < string name = "" day0 "" translation _ description = "" Label for the day before the conference . "" > The day before < / string > \n + < string name = "" day0 _ day _ date "" translation _ description = "" Actual day and date of the first day of the conference . "" > Monday , May 6 < / string > \n + < string name = "" day1 _ day _ date "" translation _ description = "" Actual day and date of the first day of the conference . "" > Tuesday , May 7 < / string > \n + < string name = "" day2 _ day _ date "" translation _ description = "" Actual day and date of the second day of the conference . "" > Wednesday , May 8 < / string > \n + < string name = "" day3 _ day _ date "" translation _ description = "" Actual day and date of the third day of the conference . "" > Thursday , May 9 < / string > \n + \n",Extra strings for conference day labels \n Change - Id : I51747ee3f81d4d8bd505ed7e4e49e69cf4ed38e3,261
"mobile \ src \ main \ res \ layout \ include _ agenda _ contents . xml \n + android : textAlignment = "" viewStart "" \n + android : textAlignment = "" viewStart "" \n",RTL fixes for Agenda \n Bug : 130295189 \n Change - Id : I9e3e33df829122a7cc7961a24ea7e4fc9054a97d,261
"mobile \ src \ main \ res \ layout \ item _ codelab . xml \n + android : textAlignment = "" viewStart "" \n + android : textAlignment = "" viewStart "" \n",RTL fixes for Codelabs \n Bug : 130306676 \n Change - Id : I10a53aef6ec3d9aac4270a73e42351cbc9a786b4,261
"mobile \ src \ main \ res \ layout \ item _ speaker . xml \n - app : speakerImage = "" @ { speaker } "" / > \n + app : speakerImage = "" @ { speaker } "" \n + tools : src = "" @ drawable / ic _ default _ avatar _ 1 "" / > \n + android : textAlignment = "" viewStart "" \n + android : textAlignment = "" viewStart "" \n mobile \ src \ main \ res \ layout \ item _ speaker _ info . xml \n + android : textAlignment = "" viewStart "" \n",RTL fixes for Speakers \n Bug : 130307696 \n Change - Id : I36303fdd0f48fdb06b70faaa7f984ae19391a60d,261
"mobile \ src \ main \ res \ layout \ fragment _ settings . xml \n - android : gravity = "" center _ vertical "" \n + android : gravity = "" start | center _ vertical "" \n + android : textAlignment = "" viewStart "" \n mobile \ src \ main \ res \ values \ styles . xml \n + < item name = "" android : textAlignment "" > viewStart < / item > \n + < item name = "" android : textAlignment "" > viewStart < / item > \n - < item name = "" android : textAppearance "" > @ style / TextAppearance . IOSched . Subhead < / item > \n + < item name = "" android : textAlignment "" > viewStart < / item > \n + < item name = "" android : textAppearance "" > @ style / TextAppearance . IOSched . Subhead < / item > \n",RTL fixes for Settings \n Bug : 130308969 \n Change - Id : I9db704261cf620724ef708fd8395a19cd65b3d73,261
"mobile \ src \ main \ res \ layout \ collapsible _ card _ content . xml \n + android : textAlignment = "" viewStart "" \n + android : textAlignment = "" viewStart "" \n mobile \ src \ main \ res \ layout \ fragment _ info . xml \n + < ! - - ViewPager doesn ' t work in RTL , so force the tabs to layout LTR . - - > \n - android : layout _ height = "" wrap _ content "" / > \n + android : layout _ height = "" wrap _ content "" \n + android : layoutDirection = "" ltr "" / > \n mobile \ src \ main \ res \ layout \ fragment _ info _ event . xml \n - android : layout _ width = "" 0dp "" \n + android : layout _ width = "" wrap _ content "" \n - app : layout _ constraintEnd _ toEndOf = "" parent "" \n + android : textAlignment = "" viewStart "" \n + android : textAlignment = "" viewStart "" \n mobile \ src \ main \ res \ layout \ info _ wifi _ card . xml \n - android : layout _ width = "" match _ parent "" \n + android : layout _ width = "" wrap _ content "" \n - android : layout _ width = "" match _ parent "" \n + android : layout _ width = "" wrap _ content "" \n + android : textAlignment = "" viewStart "" \n",RTL fixes for Info \n Bug : 130310104 \n Change - Id : I8b849fa3bb18da0034e4dcd746a989066c46d14b,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ info \ EventInfoViewModel . kt \n - "" https : / / assistant . google . com / services / a / uid / 000000449633043c "" \n + "" https : / / assistant . google . com / services / invoke / uid / 0000009fca77b068 "" \n",Update I / O Assistant app url \n Bug : 129980315 \n Change - Id : I868ee12da2445495efd5f0c53bfc4d2b4bbd47ba,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapVariantSelectionDialogFragment . kt \n + import android . annotation . SuppressLint \n + @ SuppressLint ( "" RtlHardcoded "" ) \n - attributes . gravity = Gravity . BOTTOM or Gravity . END \n + val isRtl = resources . configuration . layoutDirection = = View . LAYOUT _ DIRECTION _ RTL \n + attributes . gravity = Gravity . BOTTOM or if ( isRtl ) Gravity . LEFT else Gravity . RIGHT \n mobile \ src \ main \ res \ layout \ fragment _ map . xml \n - android : padding = "" @ dimen / margin _ normal "" / > \n + android : padding = "" @ dimen / margin _ normal "" \n + android : textAlignment = "" viewStart "" / > \n - android : gravity = "" center _ vertical "" \n + android : gravity = "" start | center _ vertical "" \n + android : textAlignment = "" viewStart "" \n",RTL fixes for Map \n Bug : 130316965 \n Change - Id : I0be479820101c34b950b2f72cb4eeb4960877d47,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailViewModel . kt \n - import com . google . samples . apps . iosched . shared . domain . users . StarEventParameter \n + import com . google . samples . apps . iosched . shared . domain . users . StarEventParameter \n - return observeRegisteredUser ( ) . value = = true & & session . value ? . isReservable ( ) = = true \n + return observeRegisteredUser ( ) . value = = true & & session . value ? . isReservable = = true \n model \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ model \ Session . kt \n - import com . google . samples . apps . iosched . model . SessionType . SESSION \n + import com . google . samples . apps . iosched . model . SessionType . Companion . reservableTypes \n - fun isReservable ( ) = type = = SESSION \n + val isReservable : Boolean by lazy ( LazyThreadSafetyMode . PUBLICATION ) { \n + type in reservableTypes \n + } \n + \n + internal val reservableTypes = listOf ( SESSION , OFFICE _ HOURS , APP _ REVIEW , GAME _ REVIEW ) \n",Add and update reservable event types \n Bug : 130367461 \n Change - Id : I778792e421aef9d8eb1f947586e650f6e2e42b03,261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n - val firstDay = dayIndexer . dayForPosition ( first , 0 ) \n - val lastDay = dayIndexer . dayForPosition ( last , - 1 ) \n + val firstDay = dayIndexer . dayForPosition ( first ) ? : return \n + val lastDay = dayIndexer . dayForPosition ( last ) ? : return \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ sessions \ ConferenceDayIndexer . kt \n - fun dayForPosition ( position : Int , fallback : Int ? = null ) : ConferenceDay { \n + fun dayForPosition ( position : Int ) : ConferenceDay ? { \n - if ( fallback ! = null ) { \n - return if ( fallback < 0 ) { \n - days [ days . size + fallback ] \n - } else { \n - days [ fallback ] \n - } \n - } \n - throw IllegalArgumentException ( "" Invalid position : $ position "" ) \n + return null \n",Fix crash toggling some filters \n Bug : 130195280 \n Change - Id : I222e0ee1ae2fff6bb1b65d89051b4c3006f661c5,261
"mobile \ build . gradle \n + vectorDrawables . useSupportLibrary = true \n mobile \ src \ main \ res \ drawable \ filters _ sheet _ background . xml \n - < solid android : color = "" @ color / white "" / > \n + < solid android : color = "" ? colorSurface "" / > \n mobile \ src \ main \ res \ drawable \ ic _ nav _ map . xml \n - android : viewportHeight = "" 24 "" > \n + android : viewportHeight = "" 24 "" \n + android : tint = "" ? colorControlNormal "" > \n",Color fixes for Lollipop \n Bug : 130384512 \n Change - Id : I94bd8a309e522c92d47bb6186f7d4b179c6bf29f,261
"mobile \ src \ main \ res \ drawable \ avd _ reservable _ to _ pending . xml \n + android : valueFrom = "" # 8a8a8a "" \n",Fix crash when reserving on Lollipop \n Bug : 130384202 \n Change - Id : I18bebb536a8beb4ad25e78cb4b5e3f0d7e112138,261
"mobile \ src \ main \ res \ layout \ fragment _ schedule _ filter . xml \n - android : layout _ gravity = "" center _ vertical | start "" \n + android : layout _ marginStart = "" @ dimen / spacing _ normal "" \n",Adjust reset button position \n Bug : 130288279 \n Change - Id : I5ec896b6e4c2df564d50656f2442363fb13f6993,261
"mobile \ src \ main \ res \ values \ styles . xml \n - < item name = "" android : textAppearance "" > @ style / TextAppearance . AlertDialog . Title < / item > \n + < item name = "" android : textSize "" > 22sp < / item > \n + < item name = "" android : fontFamily "" > @ font / google _ sans < / item > \n - < style name = "" TextAppearance . AlertDialog . Title "" parent = "" MaterialAlertDialog . MaterialComponents . Body . Text "" > \n - < item name = "" android : textSize "" > 22sp < / item > \n - < item name = "" android : fontFamily "" > @ font / google _ sans < / item > \n - < / style > \n - \n",Fix alert dialog title typeface \n Bug : 130288556 \n Change - Id : Ic0c0a304d69318ae1e07d2a1456804fc3bbed548,261
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ DayIndicatorAdapter . kt \n - viewModel = scheduleViewModel \n - setLifecycleOwner ( lifecycleOwner ) \n + viewModel = scheduleViewModel \n + lifecycleOwner = this @ DayIndicatorViewHolder . lifecycleOwner \n,Fix schedule bubbles not respecting time zone preference \n Bug : 128426011 \n Change - Id : I39d0db34039d6544b1e525afe2145b225a25ebcd,261
"mobile \ build . gradle \n + \n + buildConfigField "" String "" , "" MAP _ TILE _ URL _ BASE "" , "" \ "" https : / / storage . googleapis . com / io2019 - festivus - prod / images / maptiles \ "" "" \n + \n + buildConfigField "" String "" , "" MAP _ TILE _ URL _ BASE "" , "" \ "" https : / / storage . googleapis . com / io2019 - festivus / images / maptiles \ "" "" \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapTileProvider . kt \n + import com . google . samples . apps . iosched . BuildConfig \n - private const val TILE _ URL _ BASE = \n - "" https : / / storage . googleapis . com / io2019 - festivus / images / maptiles / % s / % d / % d / % d _ % d . png "" \n + private const val BASE _ URL = BuildConfig . MAP _ TILE _ URL _ BASE + "" / % s / % d / % d / % d _ % d . png "" \n - / / TODO change path based on variant when we have tiles for other variants . \n - return URL ( TILE _ URL _ BASE . format ( "" day "" , tileSize , zoom , x , y ) ) \n + return URL ( BASE _ URL . format ( variant . mapTilePrefix , tileSize , zoom , x , y ) ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapVariant . kt \n - @ RawRes val markersResId : Int \n + @ RawRes val markersResId : Int , \n + val mapTilePrefix : String \n - raw . map _ markers \n + raw . map _ markers , \n + "" night "" \n - raw . map _ markers \n + raw . map _ markers , \n + "" concert "" \n - raw . map _ markers \n + raw . map _ markers , \n + "" day "" \n",Change map tile URL based on selected variant \n Also added base URLs for dev and prod . \n Bug : 128655496 \n Change - Id : Ide9fd7e56e0a041cfda62d36392636e86c51195d,261
shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n - < value > true < / value > \n + < value > false < / value > \n,Turn off the map feature \n Change - Id : Ib2518c4658f75c5beef06924f8d7ba6bf5bf8083,261
"mobile \ src \ main \ res \ layout \ fragment _ search . xml \n + android : imeOptions = "" actionDone | flagNoExtractUi "" \n","Tweak search view IME options \n - use "" Done "" action instead of default "" Search "" action \n - prefer not to use the extracted UI \n Change - Id : Ie4ee10aa1fd05a715d66119f931d2d838d4fc99e",261
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchViewModel . kt \n + / / Cancel any in - flight searches \n + searchJob ? . cancel ( ) \n + \n - / / The user could be typing or toggling filters in quick succession . Giving the search job \n - / / a slight delay and cancelling it on each call to this method effectively debounces . \n - searchJob ? . cancel ( ) \n + / / The user could be typing or toggling filters rapidly . Giving the search job \n + / / a slight delay and cancelling it on each call to this method effectively debounces . \n,Fix search job not being canceled when backspacing \n Bug : 157142832 \n Change - Id : Ia5b9eb099b6cafaea2dc0c8005763846481b4232,261
"build . gradle . kts \n - ktlint ( ktlintVer ) . userData ( mapOf ( "" max _ line _ length "" to "" 100 "" ) ) \n + ktlint ( ktlintVer ) . userData ( \n + mapOf ( "" max _ line _ length "" to "" 100 "" , "" disabled _ rules "" to "" import - ordering "" ) \n + ) \n","Disable import - order rule in spotlessKotlin \n ktlint and Android Studio are in disagreement about import order . Since \n Android Studio sometimes changes them automatically when you work on a \n file , it ' s less friction to turn this off in ktlint until they resolve \n the issue . \n Note this will still catch unused imports . \n Bug : 149046243 \n Change - Id : I00f9d2afa18dca9359e2d4d2f3c3e1d3a3a48da4",261
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ MainActivity . kt \n - import com . google . android . play . core . ktx . AppUpdateResult \n - viewModel . appUpdateAvailability . observe ( this , Observer { \n - when ( it ) { \n - is AppUpdateResult . Available - > TODO ( ) \n - is AppUpdateResult . InProgress - > Unit / / do nothing \n - is AppUpdateResult . Downloaded - > TODO ( ) \n - AppUpdateResult . NotAvailable - > \n - Timber . d ( "" No App Update available at this time . "" ) \n - } \n - } ) \n + / / TODO ( b / 150719453 ) \n + / / viewModel . appUpdateAvailability . observe ( this , Observer { \n + / / when ( it ) { \n + / / is AppUpdateResult . Available - > TODO ( ) \n + / / is AppUpdateResult . InProgress - > Unit / / do nothing \n + / / is AppUpdateResult . Downloaded - > TODO ( ) \n + / / AppUpdateResult . NotAvailable - > \n + / / Timber . d ( "" No App Update available at this time . "" ) \n + / / } \n + / / } ) \n",Temporarily disable app update check \n Bug : 150719453 \n Change - Id : I8b40219e2566761fb2117f4ceecd8aabb524cf48,261
mobile \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleViewModelTest . kt \n - Flow < Result < LoadFilteredUserSessionsResult > > { \n + Flow < Result < LoadFilteredUserSessionsResult > > = flow { \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ FlowUseCase . kt \n - import kotlinx . coroutines . flow . emitAll \n - import kotlinx . coroutines . flow . flow \n - operator fun invoke ( parameters : P ) : Flow < Result < R > > = flow { \n - emitAll ( execute ( parameters ) ) \n - } \n + operator fun invoke ( parameters : P ) : Flow < Result < R > > = execute ( parameters ) \n shared \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ FlowUseCaseTest . kt \n + import kotlinx . coroutines . flow . flow \n - override fun execute ( parameters : Unit ) : Flow < Result < Unit > > { \n + override fun execute ( parameters : Unit ) : Flow < Result < Unit > > = flow { \n,Revert change for FlowUseCase \n Also fixes a test that prompted the original change to FlowUseCase . \n Bug : 150233285 \n Change - Id : I3720e5410bcbd5f530d927a4e4a7daf1240e4230,261
"repositories . gradle \n - url "" http : / / maven . google . com "" \n + url "" https : / / maven . google . com "" \n - url ' http : / / dl . bintray . com / kotlin / kotlin - eap ' \n + url ' https : / / dl . bintray . com / kotlin / kotlin - eap ' \n",[ SECURITY ] Resolve Dependencies over HTTPS \n Resolves a security vulnerability where artifacts would be resolved over HTTP instead of HTTPS .,262
"codec - http \ src \ main \ java \ io \ netty \ handler \ codec \ http \ DefaultHttpHeaders . java \n + / * * \n + * < b > Warning ! < / b > Setting < code > validate < / code > to < code > false < / code > will mean that Netty won ' t \n + * validate & protect against user - supplied header values that are malicious . \n + * This can leave your server implementation vulnerable to \n + * < a href = "" https : / / cwe . mitre . org / data / definitions / 113 . html "" > \n + * CWE - 113 : Improper Neutralization of CRLF Sequences in HTTP Headers ( ' HTTP Response Splitting ' ) \n + * < / a > . \n + * When disabling this validation , it is the responsibility of the caller to ensure that the values supplied \n + * do not contain a non - url - escaped carriage return ( CR ) and / or line feed ( LF ) characters . \n + * \n + * @ param validate Should Netty validate Header values to ensure they aren ' t malicious . \n + * / \n",[ DOC ] Add CWE - 113 warning to DefaultHttpHeaders constructor ( # 9646 ) \n # # # Motivation : \n I ' ve now found two libraries that use Netty to be vulnerable to [ CWE - 113 : Improper Neutralization of CRLF Sequences in HTTP Headers ( ' HTTP Response Splitting ' ) ] ( https : / / cwe . mitre . org / data / definitions / 113 . html ) due to using ` new DefaultHttpHeaders ( false ) ` . \n Some part of me hopes that this warning will help dissuade library authors from disabling this important security check . \n # # # Modification : \n Add documentation to ` DefaultHttpHeaders ( boolean ) ` to warn about the implications of ` false ` . \n # # # Result : \n This improves the documentation on ` DefaultHttpHeaders ` .,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action ( # 6848 ) \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action \n ( cherry picked from commit 474643fc8d3ce264cb44cf782a275dbddf69b8f6 ),262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to list of triggers,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to list of triggers,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to list of triggers,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to Wrapper Validation Triggers \n Fixes a bug .,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push , pull _ request ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action ( # 531 ) \n * Official Gradle Wrapper Validation GitHub Action \n See : https : / / github . com / gradle / wrapper - validation - action \n * Add ` pull _ request ` to list of triggers,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to Wrapper Validation Triggers ( # 6849 ),262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push , pull _ request ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation GitHub Action ( # 2457 ) \n Summary : \n # Motivation ( required ) \n This is one of the most popular JVM based projects on GitHub . \n See : https : / / github . com / gradle / wrapper - validation - action \n Pull Request resolved : https : / / github . com / facebook / fresco / pull / 2457 \n Reviewed By : passy \n Differential Revision : D19428197 \n Pulled By : oprisnik \n fbshipit - source - id : cb1309b858a9b0e747b4384849b7899bfdd4c056,262
". github \ workflows \ gradle - wrapper - validation . yml \n - on : [ push ] \n + on : [ push , pull _ request ] \n",Add ` pull _ request ` to Wrapper Validation Triggers \n ( cherry picked from commit bcad18536596ee0ea3589d0f39b612024a8f7d4b ),262
"new file \n . lgtm . yml \n + extraction : \n + java : \n + prepare : \n + packages : \n + - "" autoconf "" \n + - "" automake "" \n + - "" libtool "" \n + - "" make "" \n + - "" tar "" \n + - "" libaio - dev "" \n + - "" libssl - dev "" \n + - "" libapr1 - dev "" \n + - "" lksctp - tools "" \n","Enables lgtm . com to process this project and create a CodeQL database \n Motivation : \n I ' m performing some security research against various Java - based projects as a part of the new [ GitHub Security Lab ] ( https : / / securitylab . github . com / ) Bug Bounty program . \n Currently , LGTM . com can ' t create a CodeQL database for this project because of missing dependencies . This fixes the build so it works correctly . \n The maintainers may also want to consider enabling the free [ LGTM Integration ] ( https : / / github . com / marketplace / lgtm ) once this PR is merged . \n Modification : \n Adds a ` . lgtm . yml ` with a tested configuration : \n A successful build can be found here : \n https : / / lgtm . com / logs / 6695df28f6b2b1d3fd4d03e968b600a3e9c9aecf / lang : java \n Result : \n LGTM . com will be able to process this repository to create a CodeQL database .",262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push , pull _ request ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation Action ( # 1330 ) \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push , pull _ request ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation Action \n See : https : / / github . com / gradle / wrapper - validation - action,262
"new file \n . github \ workflows \ gradle - wrapper - validation . yml \n + name : "" Validate Gradle Wrapper "" \n + on : [ push , pull _ request ] \n + \n + jobs : \n + validation : \n + name : "" Validation "" \n + runs - on : ubuntu - latest \n + steps : \n + - uses : actions / checkout @ v2 \n + - uses : gradle / wrapper - validation - action @ v1 \n",Official Gradle Wrapper Validation Action ( # 6740 ) \n See : https : / / github . com / gradle / wrapper - validation - action,262
naked - objects \ pom . xml \n - < url > http : / / repository - estatio . forge . cloudbees . com / snapshot / < / url > \n + < url > https : / / repository - estatio . forge . cloudbees . com / snapshot / < / url > \n,Use HTTPS instead of HTTP to resolve dependencies ( # 1184 ) \n This fixes a security vulnerability in this project where the ` pom . xml ` \n files were configuring Maven to resolve dependencies over HTTP instead of \n HTTPS . \n Signed - off - by : Jonathan Leitschuh < Jonathan . Leitschuh @ gmail . com >,262
"README . md \n + \n + # # # Add library code \n + Assemble the JAR files locally using : \n + \n + ` ` ` shell \n + . / gradlew assemble \n + ` ` ` \n + \n + Copy the relevant jar files to your ` libs / ` directory . Only the main ` stetho ` \n + jar file is strictly required , however you may wish to copy \n + ` stetho - urlconnection ` or ` stetho - okhttp ` for simplified network integration . \n + Also take note that you will need to rename the jar files to avoid conflicts . \n + The jar files are located in their respective ` build ` directories : \n + \n + ` ` ` shell \n + . / stetho / build / intermediates / bundles / debug / classes . jar \n + . / stetho - urlconnection / build / intermediates / bundles / debug / classes . jar \n + . / stetho - okhttp / build / intermediates / bundles / debug / classes . jar \n + ` ` ` \n + \n + You will also need Apache ' s ` commons - cli ` library , which you can access from \n + ` build . gradle ` : \n + \n + ` ` ` groovy \n + compile ' commons - cli : commons - cli : 1 . 2 ' \n + ` ` ` \n + \n + # # # Set - up \n","Add README instructions for using JAR files from Stetho ' s build system \n Without Maven repository support , the integration steps are a little \n more involved , requiring developers to build the artifacts locally and \n copy / rename them into their project ' s ` libs / ` directory . It is also \n required to reference ` commons - cli ` manually because there is no \n dependency resolution when dealing with jar files . \n This can be simplified greatly once the project is fully open by \n uploading artifacts to Maven central or BinTray ' s jcenter .",268
new file \n scripts \ . gitignore \n + _ _ pycache _ _ \n,Add scripts / _ _ pycache _ _ to . gitignore \n This directory appears to be created each time I run ` . / scripts / dumpapp ` . \n That ' s annoying : ),268
scripts \ dumpapp \n + except BrokenPipeError as e : \n + sys . exit ( 0 ) \n,Handle SIGPIPE gracefully in . / scripts / dumpapp \n A broken pipe can be observed by scripting commands as in : \n . / scripts / dumpapp printforever | head - 1 \n Though the intended behaviour is to have dumpapp die early and report \n success as ` head ` in this case has caused the pipe to be broken on \n purpose .,268
stetho \ build . gradle \n + task androidJavadoc ( type : Javadoc ) { \n + source = android . sourceSets . main . java . srcDirs \n + classpath + = files ( android . bootClasspath ) \n + } \n + \n + task androidJavadocJar ( type : Jar ) { \n + classifier = ' javadoc ' \n + from androidJavadoc . destinationDir \n + } \n + \n - androidSourcesJar \n + archives androidJavadocJar \n + archives androidSourcesJar \n,Add androidJavadocJar archive \n This is a requirement for uploading to Maven Central .,268
"release . gradle \n + android . libraryVariants . all { variant - > \n + def name = variant . name . capitalize ( ) \n + task "" jar $ { name } "" ( type : Jar ) { \n + from variant . javaCompile . destinationDir \n + } \n + } \n + \n stetho - okhttp \ build . gradle \n - apply from : ' . . / release . gradle ' \n + apply from : rootProject . file ( ' release . gradle ' ) \n stetho - urlconnection \ build . gradle \n - apply from : ' . . / release . gradle ' \n + apply from : rootProject . file ( ' release . gradle ' ) \n stetho \ build . gradle \n - apply from : ' . . / release . gradle ' \n + apply from : rootProject . file ( ' release . gradle ' ) \n","Add jarDebug / Release tasks to simplify release deployment \n Releases include JAR files uploaded in the github releases system which \n are clumsy to extract from the AAR files . With this new task , it is \n easier to do a release using just ` gradle uploadArchives jarRelease ` and \n then uploading the resulting jar files ( base + javadoc + sources jar )",268
"release . gradle \n + description ' Stetho Debugging Platform for Android ' \n + \n + developers { \n + developer { \n + id ' facebook ' \n + name ' Facebook ' \n + } \n + } \n stetho - okhttp \ build . gradle \n - compile ' com . squareup . okhttp : okhttp : 2 . 2 . 0 + ' \n + compile ' com . squareup . okhttp : okhttp : [ 2 , 3 ) ' \n","Comply with Maven Central policies \n Add developers , description , and use interval ranges instead of ' + ' .",268
"README . md \n - # # # Add library code \n - Assemble the JAR files locally using : \n - \n - ` ` ` shell \n - . / gradlew assemble \n + # # # Download \n + Download [ the latest JARs ] ( https : / / github . com / facebook / stetho / releases / latest ) or grab via Gradle : \n + ` ` ` groovy \n + compile ' com . facebook . stetho : stetho : 1 . 0 . 0 ' \n - \n - Copy the relevant jar files to your ` libs / ` directory . Only the main ` stetho ` \n - jar file is strictly required , however you may wish to copy \n - ` stetho - urlconnection ` or ` stetho - okhttp ` for simplified network integration . \n - Also take note that you will need to rename the jar files to avoid conflicts . \n - The jar files are located in their respective ` build ` directories : \n - \n - ` ` ` shell \n - . / stetho / build / intermediates / bundles / debug / classes . jar \n - . / stetho - urlconnection / build / intermediates / bundles / debug / classes . jar \n - . / stetho - okhttp / build / intermediates / bundles / debug / classes . jar \n + or Maven : \n + ` ` ` xml \n + < dependency > \n + < groupId > com . facebook . stetho < / groupid > \n + < artifactId > stetho < / artifactId > \n + < version > 1 . 0 . 0 < / version > \n + < / dependency > \n - You will also need Apache ' s ` commons - cli ` library , which you can access from \n - ` build . gradle ` : \n + Only the main ` stetho ` dependency is strictly required , however you may also wish to use one of the network helpers : \n - compile ' commons - cli : commons - cli : 1 . 2 ' \n + compile ' com . facebook . stetho : stetho - okhttp : 1 . 0 . 0 ' \n + ` ` ` \n + or : \n + ` ` ` groovy \n + compile ' com . facebook . stetho : stetho - urlconnection : 1 . 0 . 0 ' \n",Update README to refer to Maven / Gradle deployment,268
"stetho \ build . gradle \n + \n + android . libraryVariants . all { variant - > \n + def name = variant . name . capitalize ( ) \n + task "" fatjar $ { name } "" ( type : Jar , dependsOn : "" jar $ { name } "" ) { \n + classifier = ' fatjar ' \n + from variant . javaCompile . destinationDir \n + from { \n + configurations . compile . findAll { \n + it . getName ( ) = = ' commons - cli - 1 . 2 . jar ' \n + } . collect { \n + it . isDirectory ( ) ? it : zipTree ( it ) \n + } \n + } \n + } \n + } \n",Add fatjarRelease task to fix stetho . jar export \n Release fail . The stetho - 1 . 0 . 0 . jar that was released excludes \n commons - cli and will fail as a result . This dependency is so esoteric \n for an Android app that it feels appropriate to just bundle it .,268
"scripts \ stetho _ open . py \n - if len ( row ) > 7 : \n - socket _ name = row [ 7 ] \n - if socket _ name . startswith ( ' @ stetho _ ' ) : \n - last _ stetho _ socket _ name = socket _ name [ 1 : ] \n - process _ names . append ( \n - _ parse _ process _ from _ stetho _ socket ( socket _ name ) ) \n + if len ( row ) < 8 : \n + continue \n + socket _ name = row [ 7 ] \n + if not socket _ name . startswith ( ' @ stetho _ ' ) : \n + continue \n + # Filter out entries that are not server sockets \n + if int ( row [ 3 ] , 16 ) ! = 0x10000 or int ( row [ 5 ] ) ! = 1 : \n + continue \n + last _ stetho _ socket _ name = socket _ name [ 1 : ] \n + process _ names . append ( \n + _ parse _ process _ from _ stetho _ socket ( socket _ name ) ) \n","Fix duplicate dumpapp endpoints for a single process \n stetho _ open . py naively assumes any entry matching @ stetho _ * represents a \n bound server socket , however this is not true . Connected client sockets \n will also appear with different flags and in a different state . Filter \n based on this criteria to only identify server sockets . \n Closes # 37",268
. travis . yml \n - gh - pages \n + \n + sudo : false \n + \n + cache : \n + directories : \n + - $ HOME / . m2 \n + - $ HOME / . gradle \n,Optimize Travis - CI builds by caching Gradle / Maven artifacts \n These artifacts are those downloaded as part of the dynamic build \n process and which don ' t change regularly .,268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ server \ LocalSocketHttpServer . java \n + LogUtil . i ( "" Listening on @ "" + address ) ; \n + return ; \n",Break the bindToSocket retry loop on success \n This caused all invocations to print a stack trace indicating a serious \n sounding error when in fact everything was working fine . Added a log \n statement to clarify that everything is fine : ) \n Closes # 49,268
gradle . properties \n - VERSION _ NAME = 1 . 0 . 0 \n + VERSION _ NAME = 1 . 0 . 1 - SNAPSHOT \n,Bump to 1 . 0 . 1 - SNAPSHOT . \n Should ' ve done this as part of the initial 1 . 0 . 0 release . Will need to \n automate the release process soon .,268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ network \ NetworkEventReporterImpl . java \n - if ( contentType ! = null ) { \n - responseJSON . mimeType = getResourceTypeHelper ( ) . stripContentExtras ( contentType ) ; \n - } \n + responseJSON . mimeType = contentType ! = null ? \n + getResourceTypeHelper ( ) . stripContentExtras ( contentType ) : \n + "" application / octet - stream "" ; \n - if ( contentType ! = null ) { \n - receivedParams . type = getResourceTypeHelper ( ) . determineResourceType ( contentType ) ; \n - } \n + receivedParams . type = contentType ! = null ? \n + getResourceTypeHelper ( ) . determineResourceType ( contentType ) : \n + Page . ResourceType . OTHER ; \n",Avoid sending a null ` type ` or ` mimeType ` in network responses \n DevTools refuses to show any entry that lacks the ` type ` property in \n recent versions . This makes it possible to inspect network responses \n that for whatever reason don ' t have the ` Content - Type ` header available . \n Closes # 57,268
. travis . yml \n - gh - pages \n - \n - cache : \n - directories : \n - - $ HOME / . m2 \n - - $ HOME / . gradle \n,Stop using Travis - CI cache \n This just doesn ' t optimize things with Gradle due to the lock file being \n changed in ~ / . gradle / caches on each build . Disable for now ; hopefully \n Travis - CI will fix this .,268
"scripts \ stetho _ open . py \n - return ' . ' . join ( parts [ 1 : - 2 ] ) \n + return ' _ ' . join ( parts [ 1 : - 2 ] ) \n - return ' . ' . join ( parts [ 1 : ] ) \n + return ' _ ' . join ( parts [ 1 : ] ) \n - filtered = process . replace ( ' . ' , ' _ ' ) . replace ( ' : ' , ' _ ' ) \n - return ' stetho _ % s _ devtools _ remote ' % ( filtered ) \n + return ' stetho _ % s _ devtools _ remote ' % ( process ) \n stetho \ src \ main \ java \ com \ facebook \ stetho \ server \ LocalSocketHttpServer . java \n - import java . io . IOException ; \n - import java . io . InterruptedIOException ; \n - import java . net . BindException ; \n - import java . net . SocketException ; \n - import java . util . concurrent . TimeUnit ; \n - import java . util . concurrent . atomic . AtomicInteger ; \n - \n - \n - \n - import org . apache . http . protocol . BasicHttpContext ; \n - import org . apache . http . protocol . BasicHttpProcessor ; \n - import org . apache . http . protocol . HttpContext ; \n - import org . apache . http . protocol . HttpRequestHandlerRegistry ; \n - import org . apache . http . protocol . HttpService ; \n - import org . apache . http . protocol . ResponseConnControl ; \n - import org . apache . http . protocol . ResponseContent ; \n - import org . apache . http . protocol . ResponseDate ; \n - import org . apache . http . protocol . ResponseServer ; \n + import org . apache . http . protocol . * ; \n + import java . io . IOException ; \n + import java . io . InterruptedIOException ; \n + import java . net . BindException ; \n + import java . net . SocketException ; \n + import java . util . concurrent . atomic . AtomicInteger ; \n - tidyProcessName ( ProcessUtil . getProcessName ( ) ) + \n + ProcessUtil . getProcessName ( ) + \n - private static String tidyProcessName ( String processName ) { \n - return processName . replaceAll ( "" [ \ \ \ \ \ \ . : ] "" , "" _ "" ) ; \n - } \n - \n",Use raw process name for UNIX abstract socket name \n Previously we formatted the process name using underscores due to \n primitive tooling that has since been replaced . We can now use the real \n process name which fixes an issue with . / scripts / dumpapp output when \n there are multiple targets that include derivative processes \n ( com . mypackage : myprocess ) . Previously this would show up as \n com . mypackage . myprocess .,268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ ChromeDiscoveryHandler . java \n + import com . facebook . stetho . common . ProcessUtil ; \n - page . put ( "" title "" , getAppLabel ( ) + "" ( powered by Stetho ) "" ) ; \n + page . put ( "" title "" , makeTitle ( ) ) ; \n + private String makeTitle ( ) { \n + StringBuilder b = new StringBuilder ( ) ; \n + b . append ( getAppLabel ( ) ) ; \n + \n + b . append ( "" ( powered by Stetho ) "" ) ; \n + \n + String processName = ProcessUtil . getProcessName ( ) ; \n + int colonIndex = processName . indexOf ( ' : ' ) ; \n + if ( colonIndex > = 0 ) { \n + String nonDefaultProcessName = processName . substring ( colonIndex ) ; \n + b . append ( nonDefaultProcessName ) ; \n + } \n + \n + return b . toString ( ) ; \n + } \n + \n stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ protocol \ module \ Page . java \n + import com . facebook . stetho . common . ProcessUtil ; \n - private final Context mContext ; \n - \n + @ SuppressWarnings ( "" unused "" ) \n - mContext = context . getApplicationContext ( ) ; \n - "" Attached to "" + mContext . getPackageName ( ) + "" \ n "" ; \n + "" Attached to "" + ProcessUtil . getProcessName ( ) + "" \ n "" ; \n",Add process name to chrome : / / inspect UI \n This makes it possible to distinguish multiple processes from the same \n application . The information is also confirmed in the Console tab after \n the DevTools attaches . \n Closes # 65,268
"release . gradle \n - task "" jar $ { name } "" ( type : Jar ) { \n + task "" jar $ { name } "" ( type : Jar , dependsOn : variant . javaCompile ) { \n + archives jarRelease \n stetho \ build . gradle \n - task "" fatjar $ { name } "" ( type : Jar , dependsOn : "" jar $ { name } "" ) { \n - classifier = ' fatjar ' \n - from variant . javaCompile . destinationDir \n - from { \n - configurations . compile . findAll { \n - it . getName ( ) = = ' commons - cli - 1 . 2 . jar ' \n - } . collect { \n - it . isDirectory ( ) ? it : zipTree ( it ) \n - } \n - } \n + \n + / / Ugly kludge to rename license files in the bundled commons - cli \n + / / dependency so that they do not appear to describe Stetho ' s license . \n + configurations . compile . each { \n + if ( it . getName ( ) = = ' commons - cli - 1 . 2 . jar ' ) { \n + def depJarPath = it . getPath ( ) \n + task "" tidyCommonsCli $ { name } "" ( type : Copy ) { \n + from zipTree ( depJarPath ) \n + into "" build / commons - cli - tidy - $ { name } "" \n + rename ' LICENSE ' , ' commons - cli - LICENSE ' \n + rename ' NOTICE ' , ' commons - cli - NOTICE ' \n + } \n + } \n + } \n + \n + task "" metainf $ { name } "" ( type : Copy ) { \n + from rootProject . file ( ' LICENSE ' ) \n + into "" build / metainf - $ { name } / META - INF "" \n + } \n + \n + task "" fatjar $ { name } "" ( type : Jar , dependsOn : [ "" jar $ { name } "" , "" tidyCommonsCli $ { name } "" , "" metainf $ { name } "" ] ) { \n + classifier = ' fatjar ' \n + from variant . javaCompile . destinationDir \n + from "" build / commons - cli - tidy - $ { name } "" \n + from "" build / metainf - $ { name } "" \n","Fix confusing LICENSE issue in fatjar release \n The fatjar release for 1 . 0 . 0 automatically merged commons - cli ' s \n LICENSE . txt file into the base META - INF directory , appearing to replace \n our own LICENSE with the Apache 2 . 0 license . Very bad : ) \n This corrects the situation by somewhat manually organizing the \n dependencies into the following structure : \n META - INF / \n META - INF / commons - cli - LICENSE . txt \n META - INF / commons - cli - NOTICE . txt \n META - INF / LICENSE \n META - INF / MANIFEST . MF \n META - INF / maven / \n META - INF / maven / commons - cli / \n META - INF / maven / commons - cli / commons - cli / \n META - INF / maven / commons - cli / commons - cli / pom . properties \n META - INF / maven / commons - cli / commons - cli / pom . xml",268
"scripts \ stetho _ open . py \n + import re \n - parts = socket _ name . split ( ' _ ' ) \n - if len ( parts ) < 2 or parts [ 0 ] ! = ' @ stetho ' : \n + m = re . match ( "" ^ \ @ stetho _ ( . + ) _ devtools _ remote $ "" , socket _ name ) \n + if m is None : \n - if parts [ - 2 : ] = = [ ' devtools ' , ' remote ' ] : \n - return ' _ ' . join ( parts [ 1 : - 2 ] ) \n - else : \n - return ' _ ' . join ( parts [ 1 : ] ) \n + return m . group ( 1 ) \n",Simplify stetho _ open . py process name parsing \n Regular expressions FTW,268
"stetho - okhttp \ build . gradle \n - / / noinspection GradleDynamicVersion \n - compile ' com . squareup . okhttp : okhttp : [ 2 , 3 ) ' \n + compile ' com . squareup . okhttp : okhttp : 2 . 2 . 0 ' \n","Avoid wildcard dependency in stetho - okhttp \n According to # 59 , it should be safe to just depend on 2 . 2 . 0 and ask the \n dependency resolver to figure it out .",268
README . md \n - compile ' com . facebook . stetho : stetho : 1 . 0 . 0 ' \n + compile ' com . facebook . stetho : stetho : 1 . 0 . 1 ' \n - < version > 1 . 0 . 0 < / version > \n + < version > 1 . 0 . 1 < / version > \n - compile ' com . facebook . stetho : stetho - okhttp : 1 . 0 . 0 ' \n + compile ' com . facebook . stetho : stetho - okhttp : 1 . 0 . 1 ' \n - compile ' com . facebook . stetho : stetho - urlconnection : 1 . 0 . 0 ' \n + compile ' com . facebook . stetho : stetho - urlconnection : 1 . 0 . 1 ' \n gradle . properties \n - VERSION _ NAME = 1 . 0 . 1 - SNAPSHOT \n + VERSION _ NAME = 1 . 0 . 1 \n,Bump version to 1 . 0 . 1,268
new file \n CHANGELOG . md \n + Change Log \n + = = = = = = = = = = \n + \n + # # Version 1 . 0 . 0 \n + \n + _ 2015 - 02 - 18 _ \n + \n + * Initial release . \n,Add CHANGELOG . md \n Retroactively fill in v1 . 0 . 0 details .,268
"CHANGELOG . md \n + # # Version 1 . 0 . 1 \n + \n + _ 2015 - 02 - 27 _ \n + \n + * * * ` SharedPreferences ` inspection . * * \n + It ' s now possible to inspect SharedPreference files from the "" Resources "" \n + tab . \n + \n + * New # 65 : Show non - default process name to chrome : / / inspect UI . \n + * Fix # 57 : HTTP responses without the Content - Type header do not appear in the \n + DevTools UI . \n + * Fix # 49 : Unconditional "" Could not bind to socket "" error . \n + * Fix # 37 : Duplicate dumpapp endpoints for the same process . \n + * Fix : Use raw process name for Stetho sockets to fix an issue formatting \n + choices in ` dumpapp ` \n + \n",Update CHANGELOG . md to v1 . 0 . 1,268
"README . md \n - If you are using any of other network stack options , you will need to manually \n - provide data to the ` NetworkEventReporter ` interface . The general pattern for implementing this is : \n - \n - ` ` ` java \n - NetworkEventReporter reporter = NetworkEventReporterImpl . get ( ) ; \n - / / Important to check if it is enabled first so as not to add overhead to \n - / / the common case that is not under scrutiny . \n - if ( reporter . isEnabled ( ) ) { \n - reporter . requestWillBeSent ( new MyInspectorRequest ( request ) ) ; \n - } \n - ` ` ` \n + If you are using ` HttpURLConnection ` , you can use ` StethoURLConnectionManager ` \n + to assist with integration though you should be aware that there are some \n + caveats with this approach . In particular , compressed payload sizes may not be \n + visualized even though compression is indeed in effect . \n",Update README with mention of ` StethoURLConnectionManager ` .,268
stetho \ src \ main \ java \ com \ facebook \ stetho \ server \ LocalSocketHttpServerConnection . java \n + \n + @ Override \n + public void flush ( ) throws IOException { \n + / / Do not call through to super . flush ( ) to fix a serious throughput issue due to a \n + / / polling / sleep based implementation of LocalSocketImpl # flush . This is apparently done to \n + / / guarantee that after flush is called the write buffer has been fully drained but we don ' t \n + / / need or expect this guarantee since our buffering strategy is entirely at the HTTP \n + / / level . \n + flushBuffer ( ) ; \n + } \n,"Workaround serious throughput issue in Stetho ' s HTTP server \n All communication between host and Stetho is done by a LocalSocket ( a \n UNIX abstract domain socket ) which has a very heavy - handed \n implementation of LocalSocketImpl # flush which polls / sleeps waiting for \n the kernel buffer to become empty . This behaviour in practice reduces \n observed throughput of dumpapp ( using either the buffered stdout or \n stderr ) to between 300 and 600KB / s despite adb being capable of ~ 5MB / s \n on the same device . \n This workaround involves blocking the final flush call to the socket \n output stream . This still drains the local Java buffer as originally \n intended , but does not ask the kernel to drain its buffer ( and block \n doing so ) . This kernel draining behaviour is entirely unnecessary for \n our purposes and presumably for everyone else as it appears to be added \n for some special purpose hack in the Bluetooh implementation .",268
stetho \ src \ main \ java \ com \ facebook \ stetho \ common \ Util . java \n - public static void awaitUninterruptibly ( CountDownLatch latch ) { \n + public static void joinUninterruptibly ( Thread t ) { \n - latch . await ( ) ; \n + t . join ( ) ; \n stetho \ src \ main \ java \ com \ facebook \ stetho \ dumpapp \ plugins \ CrashDumperPlugin . java \n - CountDownLatch impossibleLatch = new CountDownLatch ( 1 ) ; \n - Util . awaitUninterruptibly ( impossibleLatch ) ; \n + Util . joinUninterruptibly ( crashThread ) ; \n - ExceptionUtil . propagate ( e . getCause ( ) ) ; \n + throw ExceptionUtil . propagate ( e . getCause ( ) ) ; \n,"Don ' t sleep forever in ` dumpapp crash throw ` \n Wait on the crash thread instead , which will appropriately block the \n command line until the crash is acknowledged by Android and takes down \n the process . Tested this with : \n former = Thread . getDefaultUncaughtExceptionHandler ( ) ; \n Thread . setDefaultUncaughtExceptionHandler ( ( . . . ) - > { \n Thread . sleep ( 5000 ) ; \n former . uncaughtException ( . . . ) ; \n } ) ; \n This caused ` dumpapp crash throw ` to hang for 5 seconds before the \n process crashed and then the control was returned to the command line as \n expected . \n Separately , not invoking former . uncaughtException caused the process to \n continue running , and ` dumpapp crash throw ` returns immediately ( as \n it should even if counter intuitively ) .",268
gradle . properties \n - VERSION _ NAME = 1 . 1 . 1 \n + VERSION _ NAME = 1 . 2 . 0 - SNAPSHOT \n,"Change version to 1 . 2 . 0 - SNAPSHOT \n This was supposed to be done after 1 . 1 . 1 was cut but I must have forgot . \n Sigh , we need to bring in the gradle release plugin : )",268
stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ network \ NetworkEventReporterImpl . java \n + params . type = Page . ResourceType . OTHER ; \n - } \n + } \n,"Fix issue that can hide slow network requests \n WebKit Inspector contains an apparent implementation bug whereby if the \n request does not provide a Page . ResourceType guess then it will hide it \n from the UI until Network . responseReceived is delivered with the actual \n Page . ResourceType is given . This works fine when there is a small delay \n between requestWillBeSent and responseReceived , but if the delay widens \n significantly , the Inspector UI will discard the record and fail to show \n it no matter how progress is made after that point . \n This can be demonstrated by adding significant timing delays in network \n events ( such as by using iptables to slow down or stop traffic entirely ) \n or just adding delays in NetworkEventReporterImpl .",268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ network \ NetworkEventReporterImpl . java \n + \n + / / Type is now required as of at least WebKit Inspector rev @ 188492 . If you don ' t send \n + / / it , Chrome will refuse to draw the row in the Network tab until the response is \n + / / received ( providing the type ) . This delay is very noticable on slow networks . \n + \n + failedParams . type = Page . ResourceType . OTHER ; \n stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ protocol \ module \ Network . java \n + \n + / / Chrome introduced this undocumented new addition that , if not sent , will cause the row \n + / / to be removed from the UI and raise a JavaScript exception in the console . This is \n + / / clearly an upstream bug that needs to be fixed , though we can work around it by \n + / / providing this new undocumented field . \n + @ JsonProperty \n + public Page . ResourceType type ; \n","Work around an issue causing network requests to disappear from the UI \n This works around an apparent upstream bug in which a new undocumented \n field which , if not added , will cause a JavaScript error to occur in the \n UI and the row will be removed during Network . loadingFailed . This \n appears to be a related regression to that fixes in PR # 10 .",268
gradle . properties \n - VERSION _ NAME = 1 . 1 . 0 \n + VERSION _ NAME = 1 . 1 . 0 - SNAPSHOT \n,Move to 1 . 1 . 0 - SNAPSHOT . \n This should have been done immediately following the release but as yet \n is not automated and was forgotten about : \,268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ domstorage \ DOMStoragePeerManager . java \n + import com . facebook . stetho . common . LogUtil ; \n - throw new RuntimeException ( "" Prefs change detected for unknown key = "" + key ) ; \n + / / This can happen due to the async nature of the onSharedPreferenceChanged callback . A \n + / / rapid put / remove as two separate commits on a background thread would cause this . \n + LogUtil . i ( "" Detected rapid put / remove of % s "" , key ) ; \n",Fix crash when rapidly adding / removing SharedPreferences keys \n This is a simple race condition that was overlooked during development \n and manifests itself in practice via a third party analytics library \n ( though it is not known which one exactly ) . The issue is clearly \n demonstrable outside the context of this library though . \n Closes # 151,268
"stetho \ src \ main \ java \ com \ facebook \ stetho \ inspector \ protocol \ module \ Database . java \n + import com . facebook . stetho . inspector . jsonrpc . JsonRpcException ; \n + import com . facebook . stetho . inspector . jsonrpc . protocol . JsonRpcError ; \n - public JsonRpcResult getDatabaseTableNames ( JsonRpcPeer peer , JSONObject params ) { \n + public JsonRpcResult getDatabaseTableNames ( JsonRpcPeer peer , JSONObject params ) \n + throws JsonRpcException { \n - GetDatabaseTableNamesResponse response = new GetDatabaseTableNamesResponse ( ) ; \n - response . tableNames = mDatabasePeerManager . getDatabaseTableNames ( request . databaseId ) ; \n - return response ; \n + try { \n + GetDatabaseTableNamesResponse response = new GetDatabaseTableNamesResponse ( ) ; \n + response . tableNames = mDatabasePeerManager . getDatabaseTableNames ( request . databaseId ) ; \n + return response ; \n + } catch ( SQLiteException e ) { \n + throw new JsonRpcException ( \n + new JsonRpcError ( \n + JsonRpcError . ErrorCode . INVALID _ REQUEST , \n + e . toString ( ) , \n + null / * data * / ) ) ; \n + } \n",Work around a subtle race condition in Database . getDatabaseTableNames \n The protocol asks for a list of databases first then allows the user to \n expand that at any later time to a list of tables . The database may \n have been removed however and there is seemingly no protocol support for \n communicating this removal . We have no choice but to yield a JSON - RPC \n error . \n Closes # 154,268
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ FilterAndProjectOperator . java \n + import static com . facebook . presto . memory . context . AggregatedMemoryContext . newSimpleAggregatedMemoryContext ; \n - this . pageProcessorMemoryContext = operatorContext . newLocalSystemMemoryContext ( FilterAndProjectOperator . class . getSimpleName ( ) ) ; \n + this . pageProcessorMemoryContext = newSimpleAggregatedMemoryContext ( ) . newLocalMemoryContext ( ScanFilterAndProjectOperator . class . getSimpleName ( ) ) ; \n - outputMemoryContext . setBytes ( mergingOutput . getRetainedSizeInBytes ( ) ) ; \n + outputMemoryContext . setBytes ( mergingOutput . getRetainedSizeInBytes ( ) + pageProcessorMemoryContext . getBytes ( ) ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ ScanFilterAndProjectOperator . java \n + import static com . facebook . presto . memory . context . AggregatedMemoryContext . newSimpleAggregatedMemoryContext ; \n - this . pageProcessorMemoryContext = operatorContext . newLocalSystemMemoryContext ( ScanFilterAndProjectOperator . class . getSimpleName ( ) ) ; \n + this . pageProcessorMemoryContext = newSimpleAggregatedMemoryContext ( ) . newLocalMemoryContext ( ScanFilterAndProjectOperator . class . getSimpleName ( ) ) ; \n - outputMemoryContext . setBytes ( mergingOutput . getRetainedSizeInBytes ( ) ) ; \n + outputMemoryContext . setBytes ( mergingOutput . getRetainedSizeInBytes ( ) + pageProcessorMemoryContext . getBytes ( ) ) ; \n,"Use simple memory context for tracking page processor memory \n When page processor produces small pages those would be merged \n together into larger pages . In such case , we shouldn ' t use \n operator memory context directly as it propagates synchronized \n ( between queries ) update up to memory pool which will throttle \n performance .",284
"presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ project \ PageProcessor . java \n + import static com . google . common . base . Preconditions . checkArgument ; \n - private final Page page ; \n + private Page page ; \n + checkArgument ( ! selectedPositions . isEmpty ( ) , "" selectedPositions is empty "" ) ; \n + \n - updateRetainedSize ( ) ; \n - memoryContext . setBytes ( 0 ) ; \n + updateRetainedSize ( ) ; \n - updateRetainedSize ( ) ; \n + if ( ! selectedPositions . isEmpty ( ) ) { \n + / / there are still some positions to process therefore we need to retain page and account its memory \n + updateRetainedSize ( ) ; \n + } \n + else { \n + page = null ; \n + for ( int i = 0 ; i < previouslyComputedResults . length ; i + + ) { \n + previouslyComputedResults [ i ] = null ; \n + } \n + memoryContext . setBytes ( 0 ) ; \n + } \n + \n presto - main \ src \ test \ java \ com \ facebook \ presto \ operator \ project \ TestPageProcessor . java \n - import static sun . misc . Unsafe . ARRAY _ OBJECT _ INDEX _ SCALE ; \n - assertEquals ( memoryContext . getBytes ( ) , new Page ( createLongSequenceBlock ( 0 , 100 ) ) . getRetainedSizeInBytes ( ) + ARRAY _ OBJECT _ INDEX _ SCALE ) ; \n - assertEquals ( memoryContext . getBytes ( ) , inputPage . getRetainedSizeInBytes ( ) ) ; \n + assertEquals ( memoryContext . getBytes ( ) , 0 ) ; \n","Update retained size in PageProcessor less eagerly \n Two observations : \n 1 . It is allowed to not account for the retained size of in - flight pages . \n Therefore , in PageProcessor we can get rid of the retained size calculations \n if the page is not being retained for further processing . \n 2 . When page processor is created it will be immediately asked for a page . \n Therefore construction time page memory accounting is not needed . \n Benchmarks runs after this change : \n PageProcessorBenchmark . columnOriented 4 true varchar avgt 100 8079 , 359 ± 23 , 942 ns / op \n PageProcessorBenchmark . columnOriented 4 true bigint avgt 100 7216 , 566 ± 30 , 264 ns / op \n PageProcessorBenchmark . columnOriented 8 true varchar avgt 100 13814 , 018 ± 22 , 518 ns / op \n PageProcessorBenchmark . columnOriented 8 true bigint avgt 100 12123 , 872 ± 41 , 617 ns / op \n PageProcessorBenchmark . columnOriented 16 true varchar avgt 100 25385 , 354 ± 45 , 014 ns / op \n PageProcessorBenchmark . columnOriented 16 true bigint avgt 100 21864 , 345 ± 56 , 244 ns / op \n PageProcessorBenchmark . columnOriented 32 true varchar avgt 100 49770 , 337 ± 138 , 455 ns / op \n PageProcessorBenchmark . columnOriented 32 true bigint avgt 100 42554 , 134 ± 97 , 979 ns / op \n Best benchmarks runs before this change : \n PageProcessorBenchmark . columnOriented 4 true varchar avgt 100 8492 , 099 ± 64 , 626 ns / op \n PageProcessorBenchmark . columnOriented 4 true bigint avgt 100 7631 , 967 ± 58 , 890 ns / op \n PageProcessorBenchmark . columnOriented 8 true varchar avgt 100 15073 , 985 ± 31 , 890 ns / op \n PageProcessorBenchmark . columnOriented 8 true bigint avgt 100 13517 , 819 ± 53 , 616 ns / op \n PageProcessorBenchmark . columnOriented 16 true varchar avgt 100 28601 , 589 ± 78 , 549 ns / op \n PageProcessorBenchmark . columnOriented 16 true bigint avgt 100 25268 , 339 ± 98 , 642 ns / op \n PageProcessorBenchmark . columnOriented 32 true varchar avgt 100 56747 , 235 ± 154 , 714 ns / op \n PageProcessorBenchmark . columnOriented 32 true bigint avgt 100 49163 , 406 ± 126 , 056 ns / op",284
presto - benchto - benchmarks \ pom . xml \n - < dep . logback . version > 1 . 1 . 3 < / dep . logback . version > \n + < dep . logback . version > 1 . 2 . 3 < / dep . logback . version > \n,Update logback version to 1 . 2 . 3,284
pom . xml \n + < dep . logback . version > 1 . 2 . 3 < / dep . logback . version > \n presto - benchto - benchmarks \ pom . xml \n - < dep . logback . version > 1 . 2 . 3 < / dep . logback . version > \n,Move dep . logback . version param to main pom . xml,284
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ ValuesOperator . java \n - operatorContext . recordRawInput ( page . getSizeInBytes ( ) ) ; \n,Don ' t record raw input for ValuesOperator,284
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ exchange \ LocalExchangeSourceOperator . java \n - operatorContext . recordRawInput ( page . getSizeInBytes ( ) ) ; \n,Don ' t record raw input for LocalExchangeSourceOperator,284
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ exchange \ LocalMergeSourceOperator . java \n - operatorContext . recordRawInput ( page . getSizeInBytes ( ) ) ; \n,Don ' t record raw input for LocalMergeSourceOperator,284
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ HiveEventClient . java \n - log . info ( "" File created : query : % s , schema : % s , table : % s , partition : ' % s ' , format : % s , size : % s , path : % s "" , \n + log . debug ( "" File created : query : % s , schema : % s , table : % s , partition : ' % s ' , format : % s , size : % s , path : % s "" , \n",Make dummy HiveEventClient use DEBUG log instead of INFO \n This reduces logging output during tests .,284
presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ planner \ optimizations \ PropertyDerivations . java \n - . unordered ( unordered ) \n + . unordered ( true ) \n - . unordered ( unordered ) \n - . unordered ( unordered ) \n,Fix RIGHT / OUTER Join stream ordering property derivations \n Extracted - From : https : / / github . com / prestosql / presto / commit / 6b9c0891c264be2d1e565badd690a6d7a3dce933,284
"presto - product - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ hive \ TestHiveStorageFormats . java \n + import com . facebook . presto . tests . utils . JdbcDriverUtils ; \n + / / only admin user is allowed to change session properties \n + setRole ( "" admin "" ) ; \n + / / only admin user is allowed to change session properties \n + setRole ( "" admin "" ) ; \n + / / only admin user is allowed to change session properties \n + setRole ( "" admin "" ) ; \n + / / only admin user is allowed to change session properties \n + setRole ( "" admin "" ) ; \n + private static void setRole ( String role ) \n + { \n + Connection connection = defaultQueryExecutor ( ) . getConnection ( ) ; \n + try { \n + JdbcDriverUtils . setRole ( connection , role ) ; \n + } \n + catch ( SQLException e ) { \n + throw new RuntimeException ( e ) ; \n + } \n + } \n + \n presto - product - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ utils \ JdbcDriverUtils . java \n + public static void setRole ( Connection connection , String role ) \n + throws SQLException \n + { \n + try ( Statement statement = connection . createStatement ( ) ) { \n + statement . execute ( String . format ( "" SET ROLE % s "" , role ) ) ; \n + } \n + } \n + \n",Set admin role before setting system properties in storage format test,284
"presto - docs \ src \ main \ sphinx \ admin \ spill . rst \n + Revocable memory and reserved pool \n + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n + \n + Both reserved memory pool and revocable memory are designed to cope with low memory conditions . \n + When user memory pool is exhausted then a single query will be promoted to a reserved pool . \n + In such case only that query is allowed to progress thus reducing cluster \n + concurrency . Revocable memory will try to prevent that by triggering spill . \n + Reserved pool is of ` ` query . max - total - memory - per - node ` ` size . If \n + ` ` query . max - total - memory - per - node ` ` is large compared to the total memory \n + available on the node , then the general memory pool may not have enough \n + memory to run larger queries . If spill is enabled , then this will cause \n + excessive spilling for queries that consume large amounts of memory per node . \n + These queries would finish much quicker if spill were disabled because they \n + would execute in the reserved pool . However , doing so could also significantly \n + reduce cluster concurrency . In such a situation we recommend disabling the \n + reserved memory pool via the ` ` experimental . reserved - pool - enabled ` ` config \n + property . \n + \n - - - - - - - - - - - - - - - - \n",Add revocable memory and reserved memory pool docs to spill \n Cherry - pick of https : / / github . com / prestosql / presto / pull / 285 and \n https : / / github . com / prestosql / presto / pull / 1226 \n Co - authored - by : praveenkrishna < praveenkrishna @ tutanota . com > \n Co - authored - by : Ariel Weisberg < aweisberg @ fb . com >,284
presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ s3 \ PrestoS3FileSystem . java \n - break ; \n + if ( read > 0 ) { \n + return read ; \n + } \n + return - 1 ; \n,Make PrestoS3InputStream # read comply with read method contract on EOF \n Read should return - 1 when no data was read but EOF is reached \n Cherry - pick of https : / / github . com / prestosql / presto / pull / 1293 \n Co - authored - by : Ariel Weisberg < aweisberg @ fb . com >,284
presto - main \ src \ main \ java \ com \ facebook \ presto \ operator \ OperatorContext . java \n - return delegate . trySetBytes ( bytes ) ; \n + if ( delegate . trySetBytes ( bytes ) ) { \n + allocationListener . run ( ) ; \n + return true ; \n + } \n + \n + return false ; \n + allocationListener . run ( ) ; \n,Run allocationListener on trySetBytes and close \n Co - authored - by : Ariel Weisberg < aweisberg @ fb . com >,284
"docs \ reference \ ml \ anomaly - detection \ apis \ index . asciidoc \n + / / UPGRADE \n + include : : upgrade - job - model - snapshot . asciidoc [ leveloffset = + 2 ] \n docs \ reference \ ml \ anomaly - detection \ apis \ ml - apis . asciidoc \n - = = Model Snapshots \n + = = Model snapshots \n - \n + * < < ml - upgrade - job - model - snapshot , Upgrade model snapshot > > \n docs \ reference \ ml \ anomaly - detection \ apis \ upgrade - job - model - snapshot . asciidoc \n - = Upgrade { anomaly - jobs } Snapshot API \n + = Upgrade model snapshots API \n + + + + \n - < titleabbrev > Upgrade job snapshot < / titleabbrev > \n + < titleabbrev > Upgrade model snapshots < / titleabbrev > \n + + + + \n - Upgrades an { anomaly - job } snapshot to the latest major version . \n + Upgrades an { anomaly - detect } model snapshot to the latest major version . \n - ` POST _ ml / anomaly _ detectors / { job _ id } / model _ snapshots / { snapshot _ id } / _ upgrade ` \n + ` POST _ ml / anomaly _ detectors / < job _ id > / model _ snapshots / < snapshot _ id > / _ upgrade ` \n - Overtime , older snapshot formats are deprecated and removed . { anomaly - jobs } will only \n - support snapshots that are from the current or previous major version . \n + Over time , older snapshot formats are deprecated and removed . { anomaly - jobs - cap } \n + support only snapshots that are from the current or previous major version . \n - This API provides a means to upgrade a snapshot to the current major version . This \n - aids in preparing the cluster for an upgrade to the next major version . \n + This API provides a means to upgrade a snapshot to the current major version . \n + This aids in preparing the cluster for an upgrade to the next major version . \n - Only one snapshot per { anomaly - job } can be upgraded at a time and the upgraded snapshot cannot \n - be the current snapshot of the { anomaly - job } . \n + Only one snapshot per { anomaly - job } can be upgraded at a time and the upgraded \n + snapshot cannot be the current snapshot of the { anomaly - job } . \n - [ [ ml - upgrade - job - model - snapshot - path - parms ] ] \n - = = { api - path - parms - title } \n - \n",[ DOCS ] Adds new snapshot upgrade API ( # 65095 ),303
"docs \ reference \ settings \ ml - settings . asciidoc \n - ( < < static - cluster - setting , Static > > ) If this setting is ` true ` , the \n + ( < < cluster - update - settings , Dynamic > > ) If this setting is ` true ` , the \n",[ DOCS ] Changes static ML setting to dynamic ( # 66286 ),303
"docs \ reference \ settings \ ml - settings . asciidoc \n + ` xpack . ml . max _ ml _ node _ size ` : : \n + ( < < cluster - update - settings , Dynamic > > ) \n + The maximum node size for { ml } nodes in a deployment that supports automatic \n + cluster scaling . Defaults to ` 0b ` , which means this value is ignored . If you set \n + it to the maximum possible size of future { ml } nodes , when a { ml } job is \n + assigned to a lazy node it can check ( and fail quickly ) when scaling cannot \n + support the size of the job . \n + \n",[ DOCS ] Adds xpack . ml . max _ ml _ node _ size ( # 66285 ),303
"docs \ reference \ docs \ delete - by - query . asciidoc \n + [ [ docs - delete - by - query - throttle ] ] \n docs \ reference \ settings \ ml - settings . asciidoc \n - ( < < cluster - update - settings , Dynamic > > ) The rate at which the nightly maintenance task \n - deletes expired model snapshots and results . The setting is a proxy to the \n - [ requests _ per _ second ] ( https : / / www . elastic . co / guide / en / elasticsearch / reference / current / docs - delete - by - query . html # _ throttling _ delete _ requests ) \n - parameter used in the Delete by query requests and controls throttling . \n - Valid values must be greater than ` 0 . 0 ` or equal to ` - 1 . 0 ` where ` - 1 . 0 ` means a default value \n - is used . Defaults to ` - 1 . 0 ` \n + ( < < cluster - update - settings , Dynamic > > ) The rate at which the nightly maintenance \n + task deletes expired model snapshots and results . The setting is a proxy to the \n + < < docs - delete - by - query - throttle , requests _ per _ second > > parameter used in the \n + delete by query requests and controls throttling . Valid values must be greater \n + than ` 0 . 0 ` or equal to ` - 1 . 0 ` where ` - 1 . 0 ` means a default value is used . \n + Defaults to ` - 1 . 0 ` \n",[ DOCS ] Fix link in machine learning nightly maintenance setting ( # 69760 ),303
"docs \ reference \ transform \ limitations . asciidoc \n + [ discrete ] \n + [ [ transform - space - limitations ] ] \n + = = { transforms - cap } are visible in all { kib } spaces \n + \n + { kibana - ref } / xpack - spaces . html [ Spaces ] enable you to organize your source and \n + destination indices and other saved objects in { kib } and to see only the objects \n + that belong to your space . However , this limited scope does not apply to \n + { transforms } ; they are visible in all spaces . \n + \n",[ DOCS ] Add space limitations for transforms ( # 66810 ),303
"docs \ reference \ modules \ node . asciidoc \n - + \n - IMPORTANT : If you use the { oss - dist } , do not add the ` ml ` role . Otherwise , the \n - node fails to start . \n - coordinating nodes . If you have the { oss - dist } , do not use these settings . \n + coordinating nodes . \n - { transform - cap } nodes run { transforms } and handle { transform } API requests . If \n - you have the { oss - dist } , do not use these settings . For more information , see \n - < < transform - settings > > . \n + { transform - cap } nodes run { transforms } and handle { transform } API requests . For \n + more information , see < < transform - settings > > . \n docs \ reference \ settings \ ml - settings . asciidoc \n + \n - By default , every node is a { ml } node . If you set ` node . roles ` , however , \n - you must explicitly specify all the required roles for the node . To learn more , \n - refer to < < modules - node > > . \n + If you set ` node . roles ` , you must explicitly specify all the required roles for \n + the node . To learn more , refer to < < modules - node > > . \n + \n docs \ reference \ settings \ transform - settings . asciidoc \n + \n - By default , every node is a { transform } node . If you set ` node . roles ` , however , \n - you must explicitly specify all the required roles for the node . To learn more , \n - refer to < < modules - node > > . \n + If you set ` node . roles ` , you must explicitly specify all the required roles for \n + the node . To learn more , refer to < < modules - node > > . \n + \n",[ DOCS ] Clarifies default ML and transform node settings ( # 67671 ),303
"docs \ reference \ monitoring \ configuring - metricbeat . asciidoc \n - . Enable the { es } { xpack } module in { metricbeat } on each { es } node . \n + . Enable the { es } module in { metricbeat } on each { es } node . \n + \n - - \n - For example , to enable the default configuration in the ` modules . d ` directory , \n - run the following command : \n + For example , to enable the default configuration for the { stack - monitor - features } \n + in the ` modules . d ` directory , run the following command : \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - Alternatively , you can use the { es } module , as described in the \n - { metricbeat - ref } / metricbeat - module - elasticsearch . html [ { es } module usage for { stack } monitoring ] . \n + For more information , refer to \n + { metricbeat - ref } / metricbeat - module - elasticsearch . html [ { es } module ] . \n - - \n - . Configure the { es } { xpack } module in { metricbeat } on each { es } node . \n + . Configure the { es } module in { metricbeat } on each { es } node . \n + \n - - \n",[ DOCS ] Clarify elasticsearch module for Stack monitoring ( # 64497 ),303
docs \ java - rest \ high - level \ textstructure \ find - structure . asciidoc \n - experimental : : [ ] \n - \n - The following arguments are optional . \n + The following arguments are optional : \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n,[ DOCS ] Remove experimental tag from find structure API ( # 68153 ),303
docs \ reference \ ml \ df - analytics \ apis \ put - dfanalytics . asciidoc \n - ` ngram _ encoding ` : : : : \n + ` n _ gram _ encoding ` : : : : \n + \n - . Properties of ` ngram _ encoding ` \n + . Properties of ` n _ gram _ encoding ` \n docs \ reference \ ml \ ml - shared . asciidoc \n - The configuration information necessary to perform ngram encoding . Features \n + The configuration information necessary to perform n - gram encoding . Features \n - Specifies the length of the ngram substring . Defaults to ` 50 ` . Must be greater \n + Specifies the length of the n - gram substring . Defaults to ` 50 ` . Must be greater \n - Specifies which ngrams to gather . It’s an array of integer values where the \n + Specifies which n - grams to gather . It’s an array of integer values where the \n - Specifies the zero - indexed start of the ngram substring . Negative values are \n - allowed for encoding ngram of string suffixes . Defaults to ` 0 ` . \n + Specifies the zero - indexed start of the n - gram substring . Negative values are \n + allowed for encoding n - grams of string suffixes . Defaults to ` 0 ` . \n,[ DOCS ] Fixes n _ gram _ encoding in data frame analytics APIs ( # 69084 ),303
"docs \ reference \ ml \ ml - shared . asciidoc \n - Advanced configuration option . \n - A collection of feature preprocessors that modify one or more included fields . \n - The analysis uses the resulting one or more features instead of the \n - original document field . Multiple ` feature _ processors ` entries can refer to the \n - same document fields . Automatic categorical \n - { ml - docs } / ml - feature - encoding . html [ feature encoding ] still occurs for the fields \n - that are unprocessed by a custom processor or that have categorical values . \n - Only use this if you want to override the automatic feature encoding of the \n - specified fields . Refer to \n + Advanced configuration option . A collection of feature preprocessors that modify \n + one or more included fields . The analysis uses the resulting one or more \n + features instead of the original document field . However , these features are \n + ephemeral ; they are not stored in the destination index . Multiple \n + ` feature _ processors ` entries can refer to the same document fields . Automatic \n + categorical { ml - docs } / ml - feature - encoding . html [ feature encoding ] still occurs \n + for the fields that are unprocessed by a custom processor or that have \n + categorical values . Use this property only if you want to override the automatic \n + feature encoding of the specified fields . Refer to \n - written out by this encoder have the following name format : \n + created by this encoder have the following name format : \n",[ DOCS ] Clarify put data frame analytics API feature processors option ( # 69158 ),303
"docs \ reference \ rest - api \ index . asciidoc \n - * < < graph - explore - api , Graph Explore API > > \n - * < < find - structure > > \n + * < < graph - explore - api , Graph explore API > > \n + * < < find - structure , Find structure API > > \n - * < < indices - reload - analyzers , Reload Search Analyzers API > > \n - * < < repositories - metering - apis , Repositories Metering APIs > > \n + * < < indices - reload - analyzers , Reload search analyzers API > > \n + * < < repositories - metering - apis , Repositories metering APIs > > \n",[ DOCS ] Fixes italics and capitalization ( # 69387 ),303
"docs \ reference \ aggregations \ pipeline \ inference - bucket - aggregation . asciidoc \n - privileges that are required for using the < < get - trained - models > > . \n + privileges that are required for using the < < get - trained - models , get trained models API > > . \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - < 1 > The ID of model to use . \n + < 1 > The unique identifier or alias for the trained model . \n - | ` model _ id ` | The ID of the model to load and infer against | Required | - \n + | ` model _ id ` | The ID or alias for the trained model . | Required | - \n - < 3 > { infer - cap } bucket aggregation that contains the model ID and maps the \n + < 3 > { infer - cap } bucket aggregation that specifies the trained model and maps the \n docs \ reference \ ingest \ processors \ inference . asciidoc \n - | ` model _ id ` | yes | - | ( String ) The ID of the model to load and infer against . \n + | ` model _ id ` | yes | - | ( String ) The ID or alias for the trained model . \n",[ DOCS ] Adds model alias to inference processor and agg ( # 69576 ),303
"docs \ reference \ ml \ anomaly - detection \ ml - delayed - data - detection . asciidoc \n - Delayed data are documents that are indexed late . That is to say , it is data \n - related to a time that the { dfeed } has already processed . \n + Delayed data are documents that are indexed late . That is to say , it is data \n + related to a time that your { dfeed } has already processed and it is therefore \n + never analyzed by your { anomaly - job } . \n - \n",[ DOCS ] Clarify impact of delayed data in anomaly detection ( # 66816 ) \n Co - authored - by : Benjamin Trent < ben . w . trent @ gmail . com >,303
docs \ reference \ transform \ apis \ preview - transform . asciidoc \n + beta : [ ] \n + \n docs \ reference \ transform \ apis \ put - transform . asciidoc \n + beta : [ ] \n + \n,[ DOCS ] Add beta qualifier to transform latest APIs ( # 67036 ),303
"docs \ reference \ ml \ ml - shared . asciidoc \n - Advanced configuration option . { ml } uses loss guided tree growing . \n + Advanced configuration option . { ml - cap } uses loss guided tree growing . \n - Advanced configuration option . { ml } uses loss guided tree growing . \n - This means that trees will grow where the regularized loss reduces \n - the most . The regularized loss increases quickly where the tree depth \n - exceeds this parameter . This is a soft limit , it can be exceeded . \n - Values must be greater than or equal to 0 . \n - By default , this value is calculated during hyperparameter optimization . \n + Advanced configuration option . { ml - cap } uses loss guided tree growing , which \n + means that the decision trees grow where the regularized loss decreases most quickly . This \n + soft limit combines with the ` soft _ tree _ depth _ tolerance ` to penalize trees that \n + exceed the specified depth ; the regularized loss increases quickly beyond this \n + depth . Values must be greater than or equal to 0 . By default , this value is \n + calculated during hyperparameter optimization . \n - Advanced configuration option . \n - This controls how quickly the regularized loss increases when the tree \n - depth exceeds ` soft _ tree _ depth _ limit ` . \n - Values must be greater than or equal to 0 . 01 . \n - By default , this value is calculated during hyperparameter optimization . \n + Advanced configuration option . This option controls how quickly the regularized \n + loss increases when the tree depth exceeds ` soft _ tree _ depth _ limit ` . Values must \n + be greater than or equal to 0 . 01 . By default , this value is calculated during \n + hyperparameter optimization . \n",[ DOCS ] Clarify soft _ tree _ depth _ limit ( # 68787 ) \n Co - authored - by : Tom Veasey < tveasey @ users . noreply . github . com >,303
"src \ main \ java \ org \ junit \ internal \ runners \ rules \ RuleFieldValidator . java \n - private final boolean fOnlyStaticMembers ; \n + private final boolean fStaticMembers ; \n - boolean methods , boolean fOnlyStaticMembers ) { \n + boolean methods , boolean fStaticMembers ) { \n - this . fOnlyStaticMembers = fOnlyStaticMembers ; \n + this . fStaticMembers = fStaticMembers ; \n - optionallyValidateStatic ( member , errors ) ; \n + validateStatic ( member , errors ) ; \n - private void optionallyValidateStatic ( FrameworkMember < ? > member , \n + private void validateStatic ( FrameworkMember < ? > member , \n - if ( fOnlyStaticMembers & & ! member . isStatic ( ) ) \n + if ( fStaticMembers & & ! member . isStatic ( ) ) \n + if ( ! fStaticMembers & & member . isStatic ( ) ) \n + addError ( errors , member , "" must not be static . "" ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ RuleFieldValidatorTest . java \n + @ Test \n + public void rejectStaticTestRule ( ) { \n + TestClass target = new TestClass ( TestWithStaticTestRule . class ) ; \n + RULE _ VALIDATOR . validate ( target , errors ) ; \n + assertOneErrorWithMessage ( "" The @ Rule ' temporaryFolder ' must not be static . "" ) ; \n + } \n + \n + public static class TestWithStaticTestRule { \n + @ Rule \n + public static TestRule temporaryFolder = new TemporaryFolder ( ) ; \n + } \n + \n + @ Test \n + public void rejectMethodStaticTestRule ( ) { \n + TestClass target = new TestClass ( TestMethodWithStaticTestRule . class ) ; \n + RULE _ METHOD _ VALIDATOR . validate ( target , errors ) ; \n + assertOneErrorWithMessage ( "" The @ Rule ' getTemporaryFolder ' must not be static . "" ) ; \n + } \n + \n + public static class TestMethodWithStaticTestRule { \n + @ Rule \n + public static TestRule getTemporaryFolder ( ) { return new TemporaryFolder ( ) ; } \n + } \n + \n",@ Rule fields / methods must not be static \n Fixes KentBeck / junit # 339,314
"src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ UnsuccessfulWithDataPointFields . java \n + import static org . hamcrest . CoreMatchers . allOf ; \n - both ( failureCountIs ( 3 ) ) \n - . and ( \n - hasFailureContaining ( "" DataPoint field THREE must be public "" ) ) \n - . and ( \n - hasFailureContaining ( "" DataPoint field FOUR must be public "" ) ) \n - . and ( \n - hasFailureContaining ( "" DataPoint field FIVE must be public "" ) ) ) ; \n + allOf ( failureCountIs ( 3 ) , \n + hasFailureContaining ( "" DataPoint field THREE must be public "" ) , \n + hasFailureContaining ( "" DataPoint field FOUR must be public "" ) , \n + hasFailureContaining ( "" DataPoint field FIVE must be public "" ) ) ) ; \n",Fix javac build \n Replace both ( ) with allOf ( ),314
"src \ main \ java \ org \ junit \ experimental \ results \ ResultMatchers . java \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n + import org . hamcrest . TypeSafeMatcher ; \n src \ main \ java \ org \ junit \ internal \ matchers \ TypeSafeMatcher . java \n + * \n + * @ deprecated Please use { @ link org . hamcrest . TypeSafeMatcher } . \n + @ Deprecated \n src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n + import org . hamcrest . TypeSafeMatcher ; \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n src \ test \ java \ org \ junit \ tests \ experimental \ parallel \ ParallelClassTest . java \n + import org . hamcrest . TypeSafeMatcher ; \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n src \ test \ java \ org \ junit \ tests \ experimental \ parallel \ ParallelMethodTest . java \n + import org . hamcrest . TypeSafeMatcher ; \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ ExpectedExceptionRuleTest . java \n + import static org . hamcrest . CoreMatchers . startsWith ; \n - import org . hamcrest . Description ; \n - import org . hamcrest . Matcher ; \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n - \n - \n - private static Matcher < String > startsWith ( final String prefix ) { \n - return new TypeSafeMatcher < String > ( ) { \n - public void describeTo ( Description description ) { \n - description . appendText ( "" starts with "" ) ; \n - description . appendText ( prefix ) ; \n - } \n - \n - @ Override \n - public boolean matchesSafely ( String item ) { \n - return item . startsWith ( prefix ) ; \n - } \n - } ; \n - } \n - \n src \ test \ java \ org \ junit \ tests \ running \ classes \ ParentRunnerTest . java \n + import org . hamcrest . TypeSafeMatcher ; \n - import org . junit . internal . matchers . TypeSafeMatcher ; \n",Deprecate TypeSafeMatcher which is now provided by Hamcrest,314
build \ maven \ junit - dep - pom - template . xml \n - < distributionManagement > \n - < relocation > \n - < artifactId > junit < / artifactId > \n - < / relocation > \n - < / distributionManagement > \n + < distributionManagement > \n + < relocation > \n + < artifactId > junit < / artifactId > \n + < / relocation > \n + < / distributionManagement > \n,Line up indentation ( replace tabs with spaces ),314
src \ test \ java \ org \ junit \ internal \ MethodSorterTest . java \n - private static class Dummy { \n + static class Dummy { \n - private static class Super { \n + static class Super { \n - private static class Sub extends Super { \n + static class Sub extends Super { \n - private static class DummySortWithDefault { \n + static class DummySortWithDefault { \n - private static class DummySortJvm { \n + static class DummySortJvm { \n - private static class DummySortWithNameAsc { \n + static class DummySortWithNameAsc { \n,Fix warnings in MethodSorterTest \n There were several compiler warnings due to seemingly unused members of \n private classes that were only used via reflection .,314
"src \ test \ java \ org \ junit \ tests \ running \ methods \ AnnotationTest . java \n + import static org . hamcrest . CoreMatchers . allOf ; \n - import org . hamcrest . CoreMatchers ; \n - assertThat ( \n - runner . getFailures ( ) . toString ( ) , \n - CoreMatchers . < String > both ( containsString ( "" hereAfter "" ) ) . and ( \n - containsString ( "" inTest "" ) ) ) ; \n + assertThat ( runner . getFailures ( ) . toString ( ) , allOf ( containsString ( "" hereAfter "" ) , containsString ( "" inTest "" ) ) ) ; \n",Use allOf ( ) instead of both ( ) to avoid type parameter,314
src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n - fMatcher . and ( matcher ) ; \n + fMatcher . andAlso ( matcher ) ; \n - fMatcher . andHasMessage ( matcher ) ; \n + fMatcher . andAlsoHasMessage ( matcher ) ; \n - fMatcher . andHasCause ( expectedCause ) ; \n + fMatcher . andAlsoHasCause ( expectedCause ) ; \n src \ main \ java \ org \ junit \ rules \ ExpectedExceptionMatcher . java \n - void and ( Matcher < ? > matcher ) { \n + void andAlso ( Matcher < ? > matcher ) { \n - void andHasMessage ( Matcher < String > matcher ) { \n - and ( hasMessage ( matcher ) ) ; \n + void andAlsoHasMessage ( Matcher < String > matcher ) { \n + andAlso ( hasMessage ( matcher ) ) ; \n - void andHasCause ( Matcher < ? extends Throwable > causeMatcher ) { \n - and ( hasCause ( causeMatcher ) ) ; \n + void andAlsoHasCause ( Matcher < ? extends Throwable > matcher ) { \n + andAlso ( hasCause ( matcher ) ) ; \n - private Matcher < Throwable > hasCause ( final Matcher < ? extends Throwable > causeMatcher ) { \n + private Matcher < Throwable > hasCause ( final Matcher < ? extends Throwable > matcher ) { \n - description . appendDescriptionOf ( causeMatcher ) ; \n + description . appendDescriptionOf ( matcher ) ; \n - return causeMatcher . matches ( item . getCause ( ) ) ; \n + return matcher . matches ( item . getCause ( ) ) ; \n,Rename ` and ` methods to ` andAlso `,314
"src \ main \ java \ org \ junit \ rules \ ExpectedExceptionMatcher . java \n + import org . hamcrest . TypeSafeDiagnosingMatcher ; \n - public boolean matchesSafely ( Throwable item ) { \n + protected boolean matchesSafely ( Throwable item ) { \n + \n + @ Override \n + protected void describeMismatchSafely ( Throwable item , \n + Description mismatchDescription ) { \n + mismatchDescription . appendText ( "" message "" ) ; \n + matcher . describeMismatch ( item . getMessage ( ) , mismatchDescription ) ; \n + } \n - public boolean matchesSafely ( Throwable item ) { \n + protected boolean matchesSafely ( Throwable item ) { \n + \n + @ Override \n + protected void describeMismatchSafely ( Throwable item , \n + Description mismatchDescription ) { \n + mismatchDescription . appendText ( "" cause "" ) ; \n + matcher . describeMismatch ( item . getCause ( ) , mismatchDescription ) ; \n + } \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ ExpectedExceptionTest . java \n - + "" but : was < java . lang . IllegalArgumentException : actualMessage > "" ) ) } , \n + + "" but : message was \ "" actualMessage \ "" "" ) ) } , \n + containsString ( "" cause was < java . lang . NullPointerException : an unexpected cause > "" ) , \n",Both hasCause ( ) and hasMessage ( ) describe mismatches,314
"src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n + import static junit . framework . Assert . fail ; \n + import junit . framework . Assert ; \n + if ( fMatcherBuilder . expectsThrowable ( ) ) \n + failDueToMissingException ( ) ; \n - return ; \n - return ; \n - return ; \n - if ( fMatcherBuilder . expectsThrowable ( ) ) \n - throw new AssertionError ( "" Expected test to throw "" \n - + StringDescription . toString ( fMatcherBuilder . build ( ) ) ) ; \n + private void failDueToMissingException ( ) throws AssertionError { \n + String expectation = StringDescription . toString ( fMatcherBuilder . build ( ) ) ; \n + fail ( "" Expected test to throw "" + expectation ) ; \n + } \n + \n",Linear control flow in ExpectedExceptionStatement ( refactoring ),314
src \ main \ java \ org \ junit \ matchers \ JUnitMatchers . java \n - return CoreMatchers . hasItem ( elementMatcher ) ; \n + return CoreMatchers . < T > hasItem ( elementMatcher ) ; \n,Workaround for compilation problem on non - recent JDKs . \n Fixes # 474 .,314
src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n - import static junit . framework . Assert . fail ; \n + import static org . junit . Assert . fail ; \n - import junit . framework . Assert ; \n,Use org . junit . Assert instead of junit . framework . Assert,314
"src \ test \ java \ org \ junit \ tests \ experimental \ theories \ ParameterSignatureTest . java \n - import static org . hamcrest . CoreMatchers . hasItem ; \n + import org . hamcrest . CoreMatchers ; \n - hasItem ( isA ( TestedOn . class ) ) ) ; \n + CoreMatchers . < TestedOn > hasItem ( isA ( TestedOn . class ) ) ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ UnsuccessfulWithDataPointFields . java \n - import static org . hamcrest . CoreMatchers . both ; \n + import org . hamcrest . CoreMatchers ; \n + import org . junit . experimental . results . PrintableResult ; \n - both ( failureCountIs ( 2 ) ) \n + CoreMatchers . < PrintableResult > both ( failureCountIs ( 2 ) ) \n src \ test \ java \ org \ junit \ tests \ running \ methods \ AnnotationTest . java \n + import org . hamcrest . CoreMatchers ; \n - assertThat ( runner . getFailures ( ) . toString ( ) , both ( containsString ( "" hereAfter "" ) ) . and ( containsString ( "" inTest "" ) ) ) ; \n + assertThat ( \n + runner . getFailures ( ) . toString ( ) , \n + CoreMatchers . < String > both ( containsString ( "" hereAfter "" ) ) . and ( \n + containsString ( "" inTest "" ) ) ) ; \n","Fix javac build \n There seems to be a problem compiling calls of the new \n assertThat ( T actual , Matcher < ? super T > matcher ) \n using javac and matchers like ` hasItem ` and ` both ` that also use \n ` Matcher < ? super T > ` as parameter .",314
"build \ maven \ junit - dep - pom - template . xml \n + < packaging > pom < / packaging > \n + < version > @ version @ < / version > \n + < message > The artifact junit : junit does not contain Hamcrest anymore but declares a dependency to Hamcrest . Thus , junit : junit - dep has become obsolete . < / message > \n + < name > JUnit < / name > \n + < url > http : / / junit . org < / url > \n + < description > \n + JUnit is a regression testing framework written by Erich Gamma and Kent Beck . \n + It is used by the developer who implements unit tests in Java . \n + < / description > \n + < organization > \n + < name > JUnit < / name > \n + < url > http : / / www . junit . org < / url > \n + < / organization > \n + < mailingLists > \n + < mailingList > \n + < name > JUnit Mailing List < / name > \n + < post > junit @ yahoogroups . com < / post > \n + < archive > \n + http : / / tech . groups . yahoo . com / group / junit / \n + < / archive > \n + < / mailingList > \n + < / mailingLists > \n + < licenses > \n + < license > \n + < name > Common Public License Version 1 . 0 < / name > \n + < url > http : / / www . opensource . org / licenses / cpl1 . 0 . txt < / url > \n + < / license > \n + < / licenses > \n + < scm > \n + < connection > scm : git : git : / / github . com / KentBeck / junit . git < / connection > \n + < developerConnection > scm : git : git @ github . com : KentBeck / junit . git < / developerConnection > \n + < url > http : / / github . com / KentBeck / junit / tree / master < / url > \n + < / scm > \n + < developers > \n + < developer > \n + < id > dsaff < / id > \n + < name > David Saff < / name > \n + < email > david @ saff . net < / email > \n + < / developer > \n + < / developers > \n",Adjustments for deploying releases to Mvn central \n - Packaging - type POM \n - message for relocation \n - project description and meta data \n See https : / / issues . sonatype . org / browse / OSSRH - 4501 for rationale .,314
rename from doc \ ReleaseNotes4 . 11 . txt \n rename to doc \ ReleaseNotes4 . 11 . md \n,Change to Markdown extension for ease of viewing,314
"build . xml \n - < arg file = "" $ { basename } . txt "" / > \n + < arg file = "" $ { basename } . md "" / > \n",Ant target ' release - notes ' uses . md extension,314
"src \ main \ java \ org \ junit \ experimental \ ParallelComputer . java \n - fService . awaitTermination ( Long . MAX _ VALUE , TimeUnit . DAYS ) ; \n + fService . awaitTermination ( Long . MAX _ VALUE , TimeUnit . NANOSECONDS ) ; \n",Use TimeUnit . NANOSECONDS for JDK 5 compatibility \n Fixes # 531 .,314
doc \ ReleaseNotes4 . 11 . html \n - < h2 > Summary of changes in version 4 . 11 [ unreleased ! ] < / h2 > \n + < h2 > Summary of changes in version 4 . 11 < / h2 > \n + < li > < code > MethodRule < / code > is no longer deprecated . < / li > \n doc \ ReleaseNotes4 . 11 . md \n - # # Summary of changes in version 4 . 11 [ unreleased ! ] \n + # # Summary of changes in version 4 . 11 \n + * ` MethodRule ` is no longer deprecated . \n,"Final version , includes changes from # 519",314
new file \n doc \ ReleaseNotes4 . 12 . md \n + # # Summary of changes in version 4 . 12 [ unreleased ! ] \n + \n,Ready to collect release notes for 4 . 12,314
src \ test \ java \ org \ junit \ tests \ internal \ runners \ statements \ FailOnTimeoutTest . java \n + import org . junit . Ignore ; \n + / / TODO Fix this . See https : / / github . com / junit - team / junit / issues / 963 \n + @ Ignore \n,Ignore FailOnTimeoutTest for now ( see # 963 ),314
pom . xml \n - < version > 4 . 12 - beta - 1 < / version > \n + < version > 4 . 12 - SNAPSHOT < / version > \n - < tag > r4 . 12 - beta - 1 < / tag > \n + < tag > HEAD < / tag > \n,"Revert "" [ maven - release - plugin ] prepare release r4 . 12 - beta - 1 "" \n This reverts commit e9b8b4478b71c272ef270335326d7789d4364112 .",314
pom . xml \n - < version > 4 . 12 - beta - 1 < / version > \n + < version > 4 . 12 - SNAPSHOT < / version > \n - < tag > r4 . 12 - beta - 1 < / tag > \n + < tag > HEAD < / tag > \n,"Revert "" [ maven - release - plugin ] prepare release r4 . 12 - beta - 1 "" \n This reverts commit cf2fe3a3abef29c252e1dc62bd6118af5ddaef58 .",314
src \ test \ java \ org \ junit \ tests \ experimental \ rules \ MethodRulesTest . java \n - \n - @ Override \n - \n - @ Override \n,Fix Incompatibility with JDK5 source level \n @ Override is not allowed when implementing an interface method,314
"src \ main \ java \ org \ junit \ validator \ AnnotationValidatorFactory . java \n - if ( clazz = = null ) { \n - throw new IllegalArgumentException ( "" Can ' t create validator , value is null in annotation "" + validateWithAnnotation . getClass ( ) . getName ( ) ) ; \n - } \n src \ test \ java \ org \ junit \ validator \ AnnotationValidatorFactoryTest . java \n - import org . junit . Rule ; \n - import org . junit . Test ; \n - import org . junit . rules . ExpectedException ; \n - \n - import java . lang . annotation . Annotation ; \n - \n + import org . junit . Rule ; \n + import org . junit . Test ; \n + import org . junit . rules . ExpectedException ; \n - @ Test \n - public void exceptionWhenAnnotationWithNullClassIsPassedIn ( ) { \n - exception . expect ( IllegalArgumentException . class ) ; \n - exception . expectMessage ( "" Can ' t create validator , value is null in "" + \n - "" annotation org . junit . validator . AnnotationValidatorFactoryTest $ ValidatorWithNullValue "" ) ; \n - \n - new AnnotationValidatorFactory ( ) . createAnnotationValidator ( new ValidatorWithNullValue ( ) ) ; \n - } \n - \n - \n - public static class ValidatorWithNullValue implements ValidateWith { \n - public Class < ? extends AnnotationValidator > value ( ) { \n - return null ; \n - } \n - \n - public Class < ? extends Annotation > annotationType ( ) { \n - return ValidateWith . class ; \n - } \n - } \n - \n",Remove useless test for @ ValidateWith \n You cannot pass ` null ` as a class literal : @ ValidateWith ( null ) results \n in a compiler error .,314
"src \ test \ java \ org \ junit \ tests \ assertion \ AssertionTest . java \n + @ SuppressWarnings ( "" unused "" ) \n + @ SuppressWarnings ( "" unused "" ) \n",Fix dead code warnings in recent Eclipse IDEs,314
"src \ main \ java \ org \ junit \ runner \ FilterFactory . java \n + @ SuppressWarnings ( "" serial "" ) \n",Suppress serialization warning \n FilterNotCreatedException does not add any fields to Exception .,314
"src \ site \ xdoc \ index . xml \n - < li > \n - < a href = "" https : / / github . com / junit - team / junit / wiki / 4 . 12 - release - notes "" > 4 . 12 < / a > - ( unreleased ) < / li > \n + < li > < a href = "" https : / / github . com / junit - team / junit / blob / master / doc / ReleaseNotes4 . 12 . md "" > 4 . 12 < / a > < / li > \n",Fix # 995 - correct link to 4 . 12 release notes,314
"src \ test \ java \ org \ junit \ tests \ internal \ runners \ statements \ FailOnTimeoutTest . java \n - private static final long DURATION _ THAT _ EXCEEDS _ TIMEOUT = TimeUnit . MILLISECONDS . convert ( 1 , TimeUnit . HOURS ) ; \n + private static final long DURATION _ THAT _ EXCEEDS _ TIMEOUT = 60 * 60 * 1000 ; / / 1 hour \n",Fix : TimeUnit . HOURS does not exist in JDK5,314
CONTRIBUTING . md \n + # # # Project License : Eclipse Public License v1 . 0 \n + \n + - You will only Submit Contributions where You have authored 100 % of the content . \n + - You will only Submit Contributions to which You have the necessary rights . This means that if You are employed You have received the necessary permissions from Your employer to make the Contributions . \n + - Whatever content You Contribute will be provided under the Project License ( s ) . \n + \n + - - - \n + \n + # # # How to submit a pull request \n + \n,EPL agreement will be shown for new pull requests \n The Eclipse Foundation requires that all contributors agree to these \n terms so that Eclipse can continue to ship with Eclipse .,314
"src \ site \ xhtml \ junit - lambda . xhtml \n - < h2 align = "" center "" class = "" muted "" > The crowdfunding campaign will start on August 1st , 2015 ! < / h2 > \n + < h2 align = "" center "" class = "" muted "" > The crowdfunding campaign will start on August 3 , 2015 ! < / h2 > \n","Crowdfunding will start on August 3 , 2015",314
src \ site \ site . xml \n - < src > . / images / junit45 - combined . png < / src > \n + < src > . / images / junit - logo . png < / src > \n,Revert to plain JUnit logo to avoid confusion,314
"src \ site \ site . xml \n - < menu name = "" Overview "" > \n + < menu name = "" JUnit 4 "" > \n - < menu ref = "" reports "" inherit = "" bottom "" / > \n + < menu name = "" JUnit 4 Project Documentation "" ref = "" reports "" inherit = "" bottom "" / > \n","Explicitly state "" JUnit 4 "" in menus",314
"src \ main \ java \ org \ junit \ Assert . java \n - expectedThrowable . getSimpleName ( ) , actualThrown . getClass ( ) . getSimpleName ( ) ) ; \n + expectedThrowable . getName ( ) , actualThrown . getClass ( ) . getName ( ) ) ; \n src \ test \ java \ org \ junit \ rules \ VerifierRuleTest . java \n - "" expected : < IllegalArgumentException > but was : < NullPointerException > "" ) ) ; \n + "" expected : < java . lang . IllegalArgumentException > but was : < java . lang . NullPointerException > "" ) ) ; \n src \ test \ java \ org \ junit \ tests \ assertion \ AssertionTest . java \n - assertEquals ( "" unexpected exception type thrown ; expected : < IOException > but was : < NullPointerException > "" , \n + assertEquals ( "" unexpected exception type thrown ; expected : < java . io . IOException > but was : < java . lang . NullPointerException > "" , \n",Use fully qualified class name for failure message in expectThrows \n Fixes # 1388 .,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - beta - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - beta - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - beta - 1,314
pom . xml \n - < version > 4 . 13 - beta - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - beta - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
"src \ site \ xdoc \ index . xml \n + < li > < a href = "" https : / / github . com / junit - team / junit4 / blob / master / doc / ReleaseNotes4 . 13 . md "" > 4 . 13 < / a > < / li > \n",Add link to 4 . 13 release notes to website,314
"deleted file \n src \ changes \ changes . xml \n - < document xmlns = "" http : / / maven . apache . org / changes / 1 . 0 . 0 "" \n - xmlns : xsi = "" http : / / www . w3 . org / 2001 / XMLSchema - instance "" \n - xsi : schemaLocation = "" http : / / maven . apache . org / changes / 1 . 0 . 0 http : / / maven . apache . org / xsd / changes - 1 . 0 . 0 . xsd "" > \n - < body > \n - < release version = "" 4 . 12 "" > \n - < / release > \n - \n - < release version = "" 4 . 11 "" date = "" 2012 - 11 - 14 "" > \n - < / release > \n - \n - < release version = "" 4 . 10 "" > \n - < / release > \n - \n - < release version = "" 4 . 9 . 1 "" > \n - < / release > \n - \n - < release version = "" 4 . 9 "" > \n - < / release > \n - \n - < release version = "" 4 . 8 . 2 "" > \n - < / release > \n - \n - < release version = "" 4 . 8 . 1 "" > \n - < / release > \n - \n - < release version = "" 4 . 8 "" > \n - < / release > \n - \n - < release version = "" 4 . 7 "" > \n - < / release > \n - \n - < release version = "" 4 . 6 "" > \n - < / release > \n - \n - < release version = "" 4 . 5 "" > \n - < / release > \n - < / body > \n - < / document > \n",Delete unused source file for changes site report,314
"acknowledgements . txt \n - http : / / github . com / junit - team / junit \n + http : / / github . com / junit - team / junit4 \n doc \ ReleaseNotes4 . 12 . md \n - # # # [ Pull request # 1013 : ] ( https : / / github . com / junit - team / junit / pull / 1013 ) Make ErrorCollector # checkSucceeds generic \n + # # # [ Pull request # 1013 : ] ( https : / / github . com / junit - team / junit4 / pull / 1013 ) Make ErrorCollector # checkSucceeds generic \n doc \ homepage . html \n - JUnit source code is now hosted on < a href = "" http : / / github . com / junit - team / junit "" > GitHub < / a > . \n + JUnit source code is now hosted on < a href = "" http : / / github . com / junit - team / junit4 "" > GitHub < / a > . \n src \ site \ fml \ faq . fml \n - href = "" http : / / github / junit - team / junit "" > GitHub < / a > . \n + href = "" http : / / github / junit - team / junit4 "" > GitHub < / a > . \n src \ site \ site . xml \n - < projectId > junit - team / junit < / projectId > \n + < projectId > junit - team / junit4 < / projectId > \n src \ site \ xdoc \ index . xml \n - target : $ ( ' body a [ href = "" http : / / github . com / junit - team / junit "" ] img ' ) [ 0 ] , \n + target : $ ( ' body a [ href = "" http : / / github . com / junit - team / junit4 "" ] img ' ) [ 0 ] , \n src \ site \ xhtml \ junit - lambda - campaign . xhtml \n - < p > All development will happen openly on < a href = "" https : / / github . com / junit - team / junit "" > GitHub < / a > in order to foster early feedback and detect problems as soon as possible . < / p > \n + < p > All development will happen openly on < a href = "" https : / / github . com / junit - team / junit5 "" > GitHub < / a > in order to foster early feedback and detect problems as soon as possible . < / p > \n",Change links to point directly to junit4 / 5 repos,314
. travis . yml \n - addons : \n - apt : \n - packages : \n - - openjdk - 6 - jdk \n - \n - . / mvnw install - DskipTests \n - - openjdk6 \n - openjdk7 \n - oraclejdk8 \n - oraclejdk9 \n,Remove openjdk6 from Travis pipeline for now \n Related issue : # 1577,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 2 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 2 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 2,314
pom . xml \n - < version > 4 . 13 - rc - 2 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 2 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 2 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 2 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 2,314
pom . xml \n - < version > 4 . 13 - rc - 2 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 2 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n + < build > \n + < plugins > \n + < plugin > \n + < artifactId > maven - javadoc - plugin < / artifactId > \n + < configuration > \n + < source > 1 . 6 < / source > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n,Fix Javadoc generation on OpenJDK 11 . 0 . 2,314
pom . xml \n - < version > 2 . 10 . 1 < / version > \n + < version > 2 . 10 . 3 < / version > \n + < reporting > \n + < plugins > \n + < plugin > \n + < artifactId > maven - javadoc - plugin < / artifactId > \n + < configuration > \n + < source > 1 . 6 < / source > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / reporting > \n,Fix site : site build on OpenJDK 11 . 0 . 2,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - beta - 2 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - beta - 2 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - beta - 2,314
pom . xml \n - < version > 4 . 13 - beta - 2 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - beta - 2 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - beta - 3 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - beta - 3 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - beta - 3,314
pom . xml \n - < version > 4 . 13 - beta - 3 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - beta - 3 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
"src \ test \ java \ org \ junit \ tests \ experimental \ AssumptionTest . java \n - / / expected \n + assertEquals ( "" got : < false > , expected : is < true > "" , e . getMessage ( ) ) ; \n + } \n + } \n + \n + @ Test \n + public void assumeFalseWorks ( ) { \n + try { \n + Assume . assumeFalse ( true ) ; \n + fail ( "" should throw AssumptionViolatedException "" ) ; \n + } catch ( AssumptionViolatedException e ) { \n + assertEquals ( "" got : < true > , expected : is < false > "" , e . getMessage ( ) ) ; \n",Add test for failure message of assumeTrue / assumeFalse,314
"src \ main \ java \ org \ junit \ ClassRule . java \n + * \n + * < h3 > Usage < / h3 > \n + * < h3 > Ordering < / h3 > \n + * < p > \n + * You can use { @ link # order ( ) } if you want to have control over the order in \n + * which the Rules are applied . \n + * \n + * < pre > \n + * public class ThreeClassRules { \n + * & # 064 ; ClassRule ( order = 0 ) \n + * public static LoggingRule outer = new LoggingRule ( "" outer rule "" ) ; \n + * \n + * & # 064 ; ClassRule ( order = 1 ) \n + * public static LoggingRule middle = new LoggingRule ( "" middle rule "" ) ; \n + * \n + * & # 064 ; ClassRule ( order = 2 ) \n + * public static LoggingRule inner = new LoggingRule ( "" inner rule "" ) ; \n + * \n + * / / . . . \n + * } \n + * < / pre > \n + * \n src \ main \ java \ org \ junit \ Rule . java \n - * be executed around those returned by the latter . You can use a { @ link org . junit . rules . RuleChain } \n - * if you want to have control over the order in which the Rules are applied . \n + * be executed around those returned by the latter . \n + * < h3 > Usage < / h3 > \n + * < h3 > Ordering < / h3 > \n + * < p > \n + * You can use { @ link # order ( ) } if you want to have control over the order in \n + * which the Rules are applied . \n + * \n + * < pre > \n + * public class ThreeRules { \n + * & # 064 ; Rule ( order = 0 ) \n + * public LoggingRule outer = new LoggingRule ( "" outer rule "" ) ; \n + * \n + * & # 064 ; Rule ( order = 1 ) \n + * public LoggingRule middle = new LoggingRule ( "" middle rule "" ) ; \n + * \n + * & # 064 ; Rule ( order = 2 ) \n + * public LoggingRule inner = new LoggingRule ( "" inner rule "" ) ; \n + * \n + * / / . . . \n + * } \n + * < / pre > \n + * \n","Document order attribute of Rule and ClassRule \n Instead of mentioning the now deprecated ` RuleChain ` , the Javadoc of the \n ` Rule ` and ` ClassRule ` annotation now contains an example on how to use \n the new ` order ` attribute . \n Resolves # 1593 .",314
"src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n - * @ deprecated Since 4 . 13 \n - * { @ link org . junit . Assert # assertThrows ( Class , org . junit . function . ThrowingRunnable ) \n - * Assert . assertThrows } can be used to verify that your code throws a specific \n - * exception . \n - @ Deprecated \n + * \n + * @ deprecated Since 4 . 13 \n + * { @ link org . junit . Assert # assertThrows ( Class , org . junit . function . ThrowingRunnable ) \n + * Assert . assertThrows } can be used to verify that your code throws a specific \n + * exception . \n + @ Deprecated \n","Only deprecate ExpectedException . none ( ) \n Instead of deprecating the whole class , now only the factory method is \n deprecated and points to ` assertThrows ( ) ` . This will make it easier to \n temporarily suppress the exception for codebases that use it \n extensively by adding an intermediate factory method of their own . \n Resolves # 1609 .",314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,"Revert "" [ maven - release - plugin ] prepare release r4 . 13 - rc - 1 "" \n This reverts commit 720ee195d250190921e6440f88795869997d1a13 .",314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 - rc - 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 - rc - 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 - rc - 1,314
pom . xml \n - < version > 4 . 13 - rc - 1 < / version > \n + < version > 4 . 13 - SNAPSHOT < / version > \n - < tag > r4 . 13 - rc - 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 - SNAPSHOT < / version > \n + < version > 4 . 13 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13,314
pom . xml \n - < version > 4 . 13 < / version > \n + < version > 4 . 14 - SNAPSHOT < / version > \n - < tag > r4 . 13 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
"pom . xml \n - < version > 4 . 14 - SNAPSHOT < / version > \n + < version > 4 . 13 . 1 - SNAPSHOT < / version > \n src \ main \ java \ junit \ runner \ Version . java \n - return "" 4 . 14 - SNAPSHOT "" ; \n + return "" 4 . 13 . 1 - SNAPSHOT "" ; \n src \ main \ java \ org \ junit \ runners \ model \ FrameworkField . java \n - * < p > Access relaxed to { @ code public } since version 4 . 14 . \n + * < p > Access relaxed to { @ code public } since version 4 . 13 . 1 . \n",Change version to 4 . 13 . 1 - SNAPSHOT,314
"new file \n doc \ ReleaseNotes4 . 13 . 1 . md \n + # # Summary of changes in version 4 . 13 . 1 \n + \n + # Test Runners \n + \n + # # # [ Pull request # 1669 : ] ( https : / / github . com / junit - team / junit / pull / 1669 ) Make ` FrameworkField ` constructor public \n + \n + Prior to this change , custom runners could make ` FrameworkMethod ` instances , but not ` FrameworkField ` instances . This small change allows for both now , because ` FrameworkField ` ' s constructor has been promoted from package - private to public . \n src \ site \ xdoc \ index . xml \n + < li > < a href = "" https : / / github . com / junit - team / junit4 / blob / HEAD / doc / ReleaseNotes4 . 13 . 1 . md "" > 4 . 13 . 1 < / a > < / li > \n",Draft 4 . 13 . 1 release notes,314
pom . xml \n - < version > 4 . 13 . 1 - SNAPSHOT < / version > \n + < version > 4 . 13 . 1 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 . 1 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 . 1,314
pom . xml \n - < version > 4 . 13 . 1 < / version > \n + < version > 4 . 13 . 2 - SNAPSHOT < / version > \n - < tag > r4 . 13 . 1 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
pom . xml \n - < version > 4 . 13 . 2 - SNAPSHOT < / version > \n + < version > 4 . 13 . 2 < / version > \n - < tag > HEAD < / tag > \n + < tag > r4 . 13 . 2 < / tag > \n,[ maven - release - plugin ] prepare release r4 . 13 . 2,314
pom . xml \n - < version > 4 . 13 . 2 < / version > \n + < version > 4 . 13 . 3 - SNAPSHOT < / version > \n - < tag > r4 . 13 . 2 < / tag > \n + < tag > HEAD < / tag > \n,[ maven - release - plugin ] prepare for next development iteration,314
"src \ site \ xdoc \ index . xml \n + < li > < a href = "" https : / / github . com / junit - team / junit4 / blob / HEAD / doc / ReleaseNotes4 . 13 . 2 . md "" > 4 . 13 . 2 < / a > < / li > \n",Link to 4 . 13 . 2 release notes,314
"src \ main \ java \ junit \ runner \ Version . java \n - return "" 4 . 13 . 2 - SNAPSHOT "" ; \n + return "" 4 . 13 . 3 - SNAPSHOT "" ; \n",Change version to 4 . 13 . 3 - SNAPSHOT,314
code \ src \ main \ com \ lmax \ disruptor \ BatchEntryConsumer . java \n - sequence = i ; \n + sequence = entry . getSequence ( ) ; \n - sequence + + ; \n + sequence = entry . getSequence ( ) ; \n,Set BatchEntryConsumer sequence for advancement directly from the Entry to prevent getting out of step .,322
"code \ src \ test \ com \ lmax \ disruptor \ BatchConsumerSequenceTrackingCallbackTest . java \n - private final CountDownLatch onAvailableLatch = new CountDownLatch ( 2 ) ; \n - private final CountDownLatch readyToCallbackLatch = new CountDownLatch ( 1 ) ; \n + private final CountDownLatch callbackLatch = new CountDownLatch ( 1 ) ; \n + private final CountDownLatch onEndOfBatchLatch = new CountDownLatch ( 1 ) ; \n + thread . setDaemon ( true ) ; \n - producerBarrier . commit ( producerBarrier . nextEntry ( ) ) ; \n - onAvailableLatch . await ( ) ; \n - assertEquals ( - 1L , batchConsumer . getSequence ( ) ) ; \n - producerBarrier . commit ( producerBarrier . nextEntry ( ) ) ; \n - readyToCallbackLatch . await ( ) ; \n - assertEquals ( 2L , batchConsumer . getSequence ( ) ) ; \n + callbackLatch . await ( ) ; \n + assertEquals ( 0L , batchConsumer . getSequence ( ) ) ; \n + \n + onEndOfBatchLatch . countDown ( ) ; \n + assertEquals ( 0L , batchConsumer . getSequence ( ) ) ; \n - if ( entry . getSequence ( ) = = 2L ) \n - { \n - sequenceTrackerCallback . onCompleted ( entry . getSequence ( ) ) ; \n - readyToCallbackLatch . countDown ( ) ; \n - } \n - else \n - { \n - onAvailableLatch . countDown ( ) ; \n - } \n + sequenceTrackerCallback . onCompleted ( entry . getSequence ( ) ) ; \n + callbackLatch . countDown ( ) ; \n + onEndOfBatchLatch . await ( ) ; \n",Report sequence progress within batch but also confirm it is set at end of batch .,322
"code \ build . xml \n - < sysproperty key = "" com . lmax . runQueueTests "" value = "" false "" / > \n + < sysproperty key = "" com . lmax . runQueueTests "" value = "" true "" / > \n",Default to true for running the queue tests against the Disruptor .,322
"code \ src \ main \ com \ lmax \ disruptor \ WaitStrategy . java \n + import java . util . concurrent . locks . LockSupport ; \n - * Sleeping strategy that initially spins , then uses a Thread . yield ( ) , and eventually sleeping for 1ms \n - * while the { @ link EventProcessor } s are waiting on a barrier . \n + * Sleeping strategy that initially spins , then uses a Thread . yield ( ) , and eventually for the minimum number of nanos \n + * the OS and JVM will allow while the { @ link EventProcessor } s are waiting on a barrier . \n - try \n - { \n - Thread . sleep ( 1L ) ; \n - } \n - catch ( InterruptedException ex ) \n - { \n - / / do nothing \n - } \n + LockSupport . parkNanos ( 1L ) ; \n",Use LockSupport . parkNanos in SleepingWaitStrategy to reduce latency by sleeping for must less than 1ms .,322
code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n - if ( SequenceReportingEventHandler . class . isAssignableFrom ( eventHandler . getClass ( ) ) ) \n + if ( eventHandler instanceof SequenceReportingEventHandler ) \n - if ( LifecycleAware . class . isAssignableFrom ( eventHandler . getClass ( ) ) ) \n + if ( eventHandler instanceof LifecycleAware ) \n - if ( LifecycleAware . class . isAssignableFrom ( eventHandler . getClass ( ) ) ) \n + if ( eventHandler instanceof LifecycleAware ) \n code \ src \ main \ com \ lmax \ disruptor \ WorkProcessor . java \n - if ( LifecycleAware . class . isAssignableFrom ( workHandler . getClass ( ) ) ) \n + if ( workHandler instanceof LifecycleAware ) \n - if ( LifecycleAware . class . isAssignableFrom ( workHandler . getClass ( ) ) ) \n + if ( workHandler instanceof LifecycleAware ) \n,Use instanceof rather than isAssignableFrom to simplify code .,322
code \ src \ main \ com \ lmax \ disruptor \ BatchEntryConsumer . java \n + barrier . alert ( ) ; \n code \ src \ main \ com \ lmax \ disruptor \ EntryConsumer . java \n - * If thread is waiting on a { @ link ThresholdBarrier } is it necessary to call { @ link ThresholdBarrier # alert ( ) } \n - * to notify the thread to check status . \n + * It will call { @ link ThresholdBarrier # alert ( ) } to notify the thread to check status . \n code \ src \ test \ com \ lmax \ disruptor \ BatchEntryConsumerTest . java \n - barrier . alert ( ) ; \n - barrier . alert ( ) ; \n - barrier . alert ( ) ; \n,Move code to alert on the barrier inside the halt method on BatchEntryConsumer,322
"code \ src \ test \ com \ lmax \ disruptor \ BatchEntryConsumerTest . java \n + import org . hamcrest . Description ; \n + import org . jmock . api . Action ; \n + import org . jmock . api . Invocation ; \n - final BatchEntryHandler < StubEntry > batchEntryHandler = new TestBatchEntryHandler < StubEntry > ( ex ) ; \n - final BatchEntryConsumer batchEntryConsumer = new BatchEntryConsumer < StubEntry > ( barrier , batchEntryHandler ) ; \n - \n + oneOf ( batchEntryHandler ) . onAvailable ( ringBuffer . getEntry ( 0 ) ) ; \n + inSequence ( lifecycleSequence ) ; \n + will ( new Action ( ) \n + { \n + @ Override \n + public Object invoke ( final Invocation invocation ) throws Throwable \n + { \n + throw ex ; \n + } \n + \n + @ Override \n + public void describeTo ( final Description description ) \n + { \n + description . appendText ( "" Throws exception "" ) ; \n + } \n + } ) ; \n + \n + inSequence ( lifecycleSequence ) ; \n + \n + oneOf ( batchEntryHandler ) . onCompletion ( ) ; \n + inSequence ( lifecycleSequence ) ; \n - \n - private static final class TestBatchEntryHandler < T extends Entry > implements BatchEntryHandler < T > \n - { \n - private final Exception ex ; \n - \n - private TestBatchEntryHandler ( final Exception ex ) \n - { \n - this . ex = ex ; \n - } \n - \n - @ Override \n - public void onAvailable ( final T entry ) throws Exception \n - { \n - throw ex ; \n - } \n - \n - @ Override \n - public void onEndOfBatch ( ) throws Exception \n - { \n - } \n - \n - @ Override \n - public void onCompletion ( ) \n - { \n - } \n - } \n",Removed stub from exception test and replaced with a mock .,322
code \ src \ test \ com \ lmax \ disruptor \ BatchEntryConsumerTest . java \n - import org . junit . Assert ; \n + @ Test ( expected = NullPointerException . class ) \n + public void shouldThrowExceptionOnSettingNullExceptionHandler ( ) \n + { \n + batchEntryConsumer . setExceptionHandler ( null ) ; \n + } \n + \n,NullPointerException check on setting the exception handler on the BatchEntryConsumer .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * { @ link ClaimStrategy . Option # MULTI _ THREADED } and { @ link WaitStrategy . Option # BLOCKING } \n + * { @ link ClaimStrategy . Option # MULTI _ THREADED } and { @ link WaitStrategy . Option # SLEEPING } \n - WaitStrategy . Option . BLOCKING ) ; \n + WaitStrategy . Option . SLEEPING ) ; \n,Changed default RingBuffer WaitStrategy to SLEEPING from BLOCKING for better scalability .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - private long minProcessorSequence = RingBuffer . INITIAL _ CURSOR _ VALUE ; \n + private final long [ ] minProcessorSequence = new long [ 15 ] ; / / cache line padded \n + minProcessorSequence [ SEQ _ INDEX ] = RingBuffer . INITIAL _ CURSOR _ VALUE ; \n - if ( wrapPoint > minProcessorSequence ) \n + if ( wrapPoint > minProcessorSequence [ SEQ _ INDEX ] ) \n - minProcessorSequence = minSequence ; \n + minProcessorSequence [ SEQ _ INDEX ] = minSequence ; \n,Add padding to prevent false sharing on minProcessorSequence field . Unicast can now do 50m + events per second : - ),322
code \ src \ main \ com \ lmax \ disruptor \ dsl \ Disruptor . java \n - eventProcessorRepository . unmarkEventProcessorsAsEndOfChain ( barrierEventProcessors ) ; \n + eventProcessorRepository . unMarkEventProcessorsAsEndOfChain ( barrierEventProcessors ) ; \n code \ src \ main \ com \ lmax \ disruptor \ dsl \ EventProcessorInfo . java \n - \n - this . endOfChain = true ; \n - public void usedInBarrier ( ) \n + public void markAsUsedInBarrier ( ) \n code \ src \ main \ com \ lmax \ disruptor \ dsl \ EventProcessorRepository . java \n - public void unmarkEventProcessorsAsEndOfChain ( final EventProcessor . . . barrierEventProcessors ) \n + public void unMarkEventProcessorsAsEndOfChain ( final EventProcessor . . . barrierEventProcessors ) \n - getEventProcessorInfo ( barrierEventProcessor ) . usedInBarrier ( ) ; \n + getEventProcessorInfo ( barrierEventProcessor ) . markAsUsedInBarrier ( ) ; \n code \ src \ test \ com \ lmax \ disruptor \ dsl \ EventProcessorRepositoryTest . java \n - eventProcessorRepository . unmarkEventProcessorsAsEndOfChain ( eventProcessor2 ) ; \n + eventProcessorRepository . unMarkEventProcessorsAsEndOfChain ( eventProcessor2 ) ; \n,Tidy up endOfChain code in the Disruptor .,322
"code \ src \ test \ com \ lmax \ disruptor \ MultiThreadedClaimStrategyTest . java \n + import java . util . concurrent . atomic . AtomicReferenceArray ; \n - final AtomicInteger tOneCounter = new AtomicInteger ( 0 ) ; \n - final AtomicInteger tTwoCounter = new AtomicInteger ( 0 ) ; \n - final AtomicReference < String > firstToUpdate = new AtomicReference < String > ( "" init "" ) ; \n + final AtomicReferenceArray < String > threadSequences = new AtomicReferenceArray < String > ( 2 ) ; \n - @ Override \n - public long get ( ) \n - { \n - if ( "" tOne "" . equals ( Thread . currentThread ( ) . getName ( ) ) ) \n - { \n - tOneCounter . getAndIncrement ( ) ; \n - } \n - \n - if ( "" tTwo "" . equals ( Thread . currentThread ( ) . getName ( ) ) ) \n - { \n - tTwoCounter . getAndIncrement ( ) ; \n - } \n - \n - return super . get ( ) ; \n - } \n - \n - firstToUpdate . compareAndSet ( "" init "" , threadName ) ; \n + threadSequences . set ( ( int ) value , threadName ) ; \n - assertEquals ( 1L , tOneCounter . get ( ) ) ; \n - assertTrue ( tTwoCounter . get ( ) > 1L ) ; \n - assertEquals ( "" tOne "" , firstToUpdate . get ( ) ) ; \n + assertEquals ( "" tOne "" , threadSequences . get ( 0 ) ) ; \n + assertEquals ( "" tTwo "" , threadSequences . get ( 1 ) ) ; \n",Cleaner handling of serialisationPublishing test for MultiThreadedClaimStrategy .,322
code \ src \ main \ com \ lmax \ disruptor \ Barrier . java \n + / * * \n + * Get the { @ link Entry } for a given sequence from the underlying { @ link RingBuffer } . \n + * \n + * @ param sequence of the { @ link Entry } to get . \n + * @ return the { @ link Entry } for the sequence . \n + * / \n + T getEntry ( long sequence ) ; \n + \n code \ src \ main \ com \ lmax \ disruptor \ BatchEntryConsumer . java \n - entry = barrier . getRingBuffer ( ) . getEntry ( i ) ; \n + entry = barrier . getEntry ( i ) ; \n code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n + @ Override \n + public T getEntry ( final long sequence ) \n + { \n + return ringBuffer . getEntry ( sequence ) ; \n + } \n + \n,Add T getEntry ( long sequence ) to the Barrier interface .,322
"code \ src \ main \ com \ lmax \ disruptor \ AbstractEntry . java \n - private CommitCallback commitCallback ; \n + private RingBuffer . CommitCallback commitCallback ; \n - public void setSequence ( final long sequence , final CommitCallback commitCallback ) \n + public void setSequence ( final long sequence , final RingBuffer . CommitCallback commitCallback ) \n deleted file \n code \ src \ main \ com \ lmax \ disruptor \ CommitCallback . java \n - package com . lmax . disruptor ; \n - \n - / * * \n - * Callback into { @ link RingBuffer } to signal that the producer has populated the { @ link Entry } \n - * and it is not ready for use . \n - * / \n - interface CommitCallback \n - { \n - / * * \n - * Callback to signal { @ link Entry } is ready for consumption . \n - * \n - * @ param sequence of the { @ link Entry } that is ready for consumption . \n - * / \n - public void commit ( long sequence ) ; \n - } \n code \ src \ main \ com \ lmax \ disruptor \ Entry . java \n - void setSequence ( long sequence , CommitCallback commitCallback ) ; \n + void setSequence ( long sequence , RingBuffer . CommitCallback commitCallback ) ; \n code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n + \n + / * * \n + * Callback into { @ link com . lmax . disruptor . RingBuffer } to signal that the producer has populated the { @ link com . lmax . disruptor . Entry } \n + * and it is not ready for use . \n + * / \n + interface CommitCallback \n + { \n + / * * \n + * Callback to signal { @ link com . lmax . disruptor . Entry } is ready for consumption . \n + * \n + * @ param sequence of the { @ link com . lmax . disruptor . Entry } that is ready for consumption . \n + * / \n + public void commit ( long sequence ) ; \n + } \n",Moved CommitCallback interface to inside the RingBuffer .,322
code \ src \ main \ com \ lmax \ disruptor \ EventFactory . java \n - T create ( ) ; \n + T newInstance ( ) ; \n code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * @ param eventFactory to create events for filling the RingBuffer \n + * @ param eventFactory to newInstance events for filling the RingBuffer \n - * @ param eventFactory to create events for filling the RingBuffer \n + * @ param eventFactory to newInstance events for filling the RingBuffer \n - events [ i ] = eventFactory . create ( ) ; \n + events [ i ] = eventFactory . newInstance ( ) ; \n code \ src \ main \ com \ lmax \ disruptor \ wizard \ DisruptorWizard . java \n - * @ param eventFactory the factory to create events in the ring buffer . \n + * @ param eventFactory the factory to newInstance events in the ring buffer . \n - * @ param eventFactory the factory to create events in the ring buffer . \n + * @ param eventFactory the factory to newInstance events in the ring buffer . \n code \ src \ perf \ com \ lmax \ disruptor \ support \ FizzBuzzEvent . java \n - public FizzBuzzEvent create ( ) \n + public FizzBuzzEvent newInstance ( ) \n code \ src \ perf \ com \ lmax \ disruptor \ support \ FunctionEvent . java \n - public FunctionEvent create ( ) \n + public FunctionEvent newInstance ( ) \n code \ src \ perf \ com \ lmax \ disruptor \ support \ ValueEvent . java \n - public ValueEvent create ( ) \n + public ValueEvent newInstance ( ) \n code \ src \ test \ com \ lmax \ disruptor \ EventTranslatorTest . java \n - StubEvent event = StubEvent . EVENT _ FACTORY . create ( ) ; \n + StubEvent event = StubEvent . EVENT _ FACTORY . newInstance ( ) ; \n code \ src \ test \ com \ lmax \ disruptor \ support \ StubEvent . java \n - public StubEvent create ( ) \n + public StubEvent newInstance ( ) \n code \ src \ test \ com \ lmax \ disruptor \ support \ TestEvent . java \n - public TestEvent create ( ) \n + public TestEvent newInstance ( ) \n,Rename of EventFactory . create ( ) to EventFactory . newInstance ( ) to follow current Java coding convention .,322
"code \ build . xml \n - < sysproperty key = "" com . lmax . runQueueTests "" value = "" false "" / > \n + < sysproperty key = "" com . lmax . runQueueTests "" value = "" true "" / > \n",Revert commit of runQueueTest = false back to true .,322
"code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - final long sequence = claimStrategy . incrementAndGet ( sequenceBatch . getSize ( ) ) ; \n + final int batchSize = sequenceBatch . getSize ( ) ; \n + if ( batchSize > events . length ) \n + { \n + final String msg = "" Batch size "" + batchSize + "" is greater than buffer size of "" + events . length ; \n + throw new IllegalArgumentException ( msg ) ; \n + } \n + \n + final long sequence = claimStrategy . incrementAndGet ( batchSize ) ; \n",Do not allow a batch size greater than the ring buffer size .,322
"code \ build . xml \n - fork = "" true "" \n - forkmode = "" perTest "" \n + fork = "" false "" \n",Forking tests was screwing up results . Test now run without forking .,322
"code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - public ConsumerBarrier < T > createBarrier ( final EntryConsumer . . . entryConsumers ) \n + public ConsumerBarrier < T > createConsumerBarrier ( final EntryConsumer . . . entryConsumers ) \n - public ProducerBarrier < T > createClaimer ( final int bufferReserve , final EntryConsumer . . . entryConsumers ) \n + public ProducerBarrier < T > createProducerBarrier ( final int bufferReserve , final EntryConsumer . . . entryConsumers ) \n code \ src \ test \ com \ lmax \ disruptor \ BatchEntryConsumerSequenceTrackingCallbackTest . java \n - final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createBarrier ( ) ; \n - final ProducerBarrier < StubEntry > producerBarrier = ringBuffer . createClaimer ( 0 ) ; \n + final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createConsumerBarrier ( ) ; \n + final ProducerBarrier < StubEntry > producerBarrier = ringBuffer . createProducerBarrier ( 0 ) ; \n code \ src \ test \ com \ lmax \ disruptor \ BatchEntryConsumerTest . java \n - private final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createBarrier ( ) ; \n + private final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createConsumerBarrier ( ) ; \n - private final ProducerBarrier < StubEntry > producerBarrier = ringBuffer . createClaimer ( 0 , batchEntryConsumer ) ; \n + private final ProducerBarrier < StubEntry > producerBarrier = ringBuffer . createProducerBarrier ( 0 , batchEntryConsumer ) ; \n code \ src \ test \ com \ lmax \ disruptor \ ConsumerBarrierTest . java \n - consumerBarrier = ringBuffer . createBarrier ( entryConsumer1 , entryConsumer2 , entryConsumer3 ) ; \n - producerBarrier = ringBuffer . createClaimer ( 0 ) ; \n + consumerBarrier = ringBuffer . createConsumerBarrier ( entryConsumer1 , entryConsumer2 , entryConsumer3 ) ; \n + producerBarrier = ringBuffer . createProducerBarrier ( 0 ) ; \n - final ConsumerBarrier consumerBarrier = ringBuffer . createBarrier ( workers ) ; \n + final ConsumerBarrier consumerBarrier = ringBuffer . createConsumerBarrier ( workers ) ; \n - final ConsumerBarrier consumerBarrier = ringBuffer . createBarrier ( entryConsumers ) ; \n + final ConsumerBarrier consumerBarrier = ringBuffer . createConsumerBarrier ( entryConsumers ) ; \n code \ src \ test \ com \ lmax \ disruptor \ RingBufferTest . java \n - consumerBarrier = ringBuffer . createBarrier ( ) ; \n - producerBarrier = ringBuffer . createClaimer ( 0 ) ; \n + consumerBarrier = ringBuffer . createConsumerBarrier ( ) ; \n + producerBarrier = ringBuffer . createProducerBarrier ( 0 ) ; \n - final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createBarrier ( ) ; \n + final ConsumerBarrier < StubEntry > consumerBarrier = ringBuffer . createConsumerBarrier ( ) ; \n",Rename Claimer and Barrier to ProducerBarrier and ConsumerBarrier .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - if ( batchSize > events . length ) \n + if ( batchSize > = events . length ) \n,Batch size check needs to allow one item being processed .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - if ( batchSize > = events . length ) \n + if ( batchSize > events . length ) \n,Revert change for limit of batch size .,322
"code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedAtomicLong . java \n - public volatile long p1 , p2 , p3 , p4 , p5 , p6 , p7 = 7L ; \n + public volatile long p1 , p2 , p3 , p4 , p5 = 7L ; \n code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedLong . java \n - * Cache line padded long variable to be used when the false sharing maybe an issue . \n + * Cache line padded long variable to be used when false sharing maybe an issue . \n - public volatile long p1 , p2 , p3 , p4 , p5 , p6 , p7 = 7L ; \n + public volatile long p1 , p2 , p3 , p4 , p5 = 7L ; \n",Reduce padding to the minimum to avoid waste,322
"code \ src \ main \ com \ lmax \ disruptor \ BatchEventConsumer . java \n - entry = barrier . getRingBuffer ( ) . get ( i ) ; \n + entry = barrier . getRingBuffer ( ) . getEntry ( i ) ; \n code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - public T get ( long sequence ) \n + public T getEntry ( long sequence ) \n code \ src \ test \ com \ lmax \ disruptor \ RingBufferTest . java \n - StubEntry entry = ringBuffer . get ( sequence ) ; \n + StubEntry entry = ringBuffer . getEntry ( sequence ) ; \n - StubEntry entry = ringBuffer . get ( sequence ) ; \n + StubEntry entry = ringBuffer . getEntry ( sequence ) ; \n - assertEquals ( i , ringBuffer . get ( i ) . getValue ( ) ) ; \n + assertEquals ( i , ringBuffer . getEntry ( i ) . getValue ( ) ) ; \n - assertEquals ( i , ringBuffer . get ( i ) . getValue ( ) ) ; \n + assertEquals ( i , ringBuffer . getEntry ( i ) . getValue ( ) ) ; \n - StubEntry entry = ringBuffer . get ( sequence ) ; \n + StubEntry entry = ringBuffer . getEntry ( sequence ) ; \n code \ src \ test \ com \ lmax \ disruptor \ support \ ReadingCallable . java \n - messages . add ( ringBuffer . get ( l ) ) ; \n + messages . add ( ringBuffer . getEntry ( l ) ) ; \n",Rename get ( long sequence ) to getEntry ( long sequence ),322
code \ src \ main \ com \ lmax \ disruptor \ BatchEventConsumer . java \n - public ThresholdBarrier getBarrier ( ) \n + public ThresholdBarrier < ? extends T > getBarrier ( ) \n code \ src \ main \ com \ lmax \ disruptor \ EventConsumer . java \n - public interface EventConsumer extends Runnable \n + public interface EventConsumer < T extends Entry > extends Runnable \n - ThresholdBarrier getBarrier ( ) ; \n + ThresholdBarrier < T > getBarrier ( ) ; \n,Extend generics on EventConsumer for retrieving the underlying ThresholdBarrier,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * Ring based store of reusable entries that are items containing the data being exchanged between producers and consumers representing an event . \n + * Ring based store of reusable entries that are items containing the data representing an event being exchanged between producers and consumers . \n - private final boolean hasGatingEventProcessors ; \n - hasGatingEventProcessors = eventConsumers . length ! = 0 ; \n - if ( hasGatingEventProcessors ) \n + if ( 0 ! = eventConsumers . length ) \n - if ( hasGatingEventProcessors ) \n + if ( 0 ! = eventConsumers . length ) \n,Refactored out unnecessary hasGatingEventProcessors field from ThresholdBarrier .,322
"code \ src \ perf \ com \ lmax \ disruptor \ Pipeline3StepLatencyPerfTest . java \n + import java . io . PrintStream ; \n - System . out . format ( "" % s run % d Disruptor % s \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) , histogram ) ; \n + System . out . format ( "" % s run % d Disruptor \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) ) ; \n + dumpHistogram ( System . out ) ; \n - System . out . format ( "" % s run % d Queues % s \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) , histogram ) ; \n + System . out . format ( "" % s run % d Queues \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) ) ; \n + dumpHistogram ( System . out ) ; \n + } \n + } \n + \n + private void dumpHistogram ( final PrintStream out ) \n + { \n + for ( int i = 0 , size = histogram . getSize ( ) ; i < size ; i + + ) \n + { \n + out . print ( histogram . getIntervalUpperBound ( i ) ) ; \n + out . print ( ' \ t ' ) ; \n + out . print ( histogram . getObservationCount ( i ) ) ; \n + out . println ( ) ; \n",Format Histogram output for easy load into a spreadsheet .,322
"code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedAtomicBoolean . java \n - public volatile long p1 , p2 , p3 , p4 , p5 , p6 = 7L ; \n + public volatile long p1 , p2 , p3 , p4 , p5 , p6 , p7 = 7L ; \n",DependencyBarrier to SequenceBarrier name change and added PaddedAtomicBoolean,322
"code \ src \ perf \ com \ lmax \ disruptor \ Sequencer3P1CPerfTest . java \n - private final ProducerBarrier < ValueEntry > producerBarrier = ringBuffer . createProducerBarrier ( 0 , batchConsumer ) ; \n + private final ProducerBarrier < ValueEntry > producerBarrier = ringBuffer . createProducerBarrier ( NUM _ PRODUCERS , batchConsumer ) ; \n",Forgot to add ring buffer reserve on the ProducerBarrier when multiple producers exist .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * The bufferReserve should be at least the number of producing threads . \n + * The bufferReserve can be used situations were { @ link Consumer } s may not be available for a while . \n - private final int threshold ; \n + private final long threshold ; \n - gateOnConsumers ( ) ; \n - \n + ensureConsumersAreInRange ( sequence ) ; \n + \n - gateOnConsumers ( ) ; \n + ensureConsumersAreInRange ( sequence ) ; \n - private void gateOnConsumers ( ) \n + private void ensureConsumersAreInRange ( final long sequence ) \n - while ( ( cursor - getMinimumSequence ( consumers ) ) > = threshold ) \n + while ( ( sequence - getMinimumSequence ( consumers ) ) > = threshold ) \n,Track consumers after claim to prevent wrap when multiple producers exist .,322
code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n - long nextSequence = sequence . get ( ) + 1 ; \n + long nextSequence = sequence . get ( ) + 1L ; \n - nextSequence = event . getSequence ( ) + 1 ; \n + nextSequence = event . getSequence ( ) + 1L ; \n,Use long constants in code when they are long .,322
rename from code \ src \ main \ com \ lmax \ disruptor \ dsl \ ConsumerInfo . java \n rename to code \ src \ main \ com \ lmax \ disruptor \ dsl \ EventProcessorInfo . java \n rename from code \ src \ main \ com \ lmax \ disruptor \ dsl \ ConsumerRepository . java \n rename to code \ src \ main \ com \ lmax \ disruptor \ dsl \ EventProcessorRepository . java \n + \n + \n code \ src \ main \ com \ lmax \ disruptor \ dsl \ ExceptionHandlerSetting . java \n - / * * A support class used as part of setting an exception handler for a specific event handler . \n + / * * \n + * A support class used as part of setting an exception handler for a specific event handler . \n - / * * Specify the { @ link ExceptionHandler } to use with the event handler . \n + / * * \n + * Specify the { @ link ExceptionHandler } to use with the event handler . \n,Corrected file names to be the same as package scope Java classes .,322
"code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n + sequenceBarrier . clearAlert ( ) ; \n + \n code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + private final PaddedAtomicLong minGatingSequence = new PaddedAtomicLong ( Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n - private final PaddedAtomicLong minTrackedSequence = new PaddedAtomicLong ( Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n - if ( wrapPoint > minTrackedSequence . get ( ) ) \n + if ( wrapPoint > minGatingSequence . get ( ) ) \n - minTrackedSequence . lazySet ( minSequence ) ; \n + minGatingSequence . lazySet ( minSequence ) ; \n + private final PaddedLong minGatingSequence = new PaddedLong ( Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n - private final PaddedLong minTrackedSequence = new PaddedLong ( Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n - if ( wrapPoint > minTrackedSequence . get ( ) ) \n + if ( wrapPoint > minGatingSequence . get ( ) ) \n - minTrackedSequence . set ( minSequence ) ; \n + minGatingSequence . set ( minSequence ) ; \n code \ src \ main \ com \ lmax \ disruptor \ ProcessingSequenceBarrier . java \n - public volatile long p1 , p2 , p3 , p4 , p5 , p6 , p7 = 7L ; / / cache line padding \n - \n code \ src \ perf \ com \ lmax \ disruptor \ DiamondPath1P3CPerfTest . java \n - sequenceBarrier . clearAlert ( ) ; \n - sequenceBarrierFizzBuzz . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ MultiCast1P3CPerfTest . java \n - sequenceBarrier . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ Pipeline3StepLatencyPerfTest . java \n - stepOneSequenceBarrier . clearAlert ( ) ; \n - stepTwoSequenceBarrier . clearAlert ( ) ; \n - stepThreeSequenceBarrier . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ Pipeline3StepPerfTest . java \n - stepOneSequenceBarrier . clearAlert ( ) ; \n - stepTwoSequenceBarrier . clearAlert ( ) ; \n - stepThreeSequenceBarrier . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ Sequencer3P1CPerfTest . java \n - sequenceBarrier . clearAlert ( ) ; \n - \n code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CBatchPerfTest . java \n - sequenceBarrier . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CPerfTest . java \n - sequenceBarrier . clearAlert ( ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ UniCastRaw1P1CPerfTest . java \n - barrier . clearAlert ( ) ; \n + \n",Naming consistency and clearAlert ( ) on barrier each time the run ( ) method is invoked on the BatchEventProcessor .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + private static final int RETRIES = 200 ; \n + int counter = 100 ; \n - Thread . yield ( ) ; \n + counter = applyBackPressure ( counter ) ; \n - int counter = 1000 ; \n + int counter = RETRIES ; \n - if ( 0 = = - - counter ) \n + if ( counter > 100 ) \n - counter = 1000 ; \n - Thread . yield ( ) ; \n + - - counter ; \n + } \n + else \n + { \n + counter = applyBackPressure ( counter ) ; \n + } \n + } \n + } \n + \n + private int applyBackPressure ( int counter ) \n + { \n + if ( counter > 0 ) \n + { \n + - - counter ; \n + Thread . yield ( ) ; \n + } \n + else \n + { \n + try \n + { \n + counter = RETRIES ; \n + Thread . sleep ( 1L ) ; \n + } \n + catch ( InterruptedException e ) \n + { \n + / / don ' t care \n + \n + return counter ; \n + private static final int RETRIES = 100 ; \n + int counter = RETRIES ; \n - Thread . yield ( ) ; \n + counter = applyBackPressure ( counter ) ; \n + \n + private int applyBackPressure ( int counter ) \n + { \n + if ( counter > 0 ) \n + { \n + - - counter ; \n + Thread . yield ( ) ; \n + } \n + else \n + { \n + try \n + { \n + counter = RETRIES ; \n + Thread . sleep ( 1L ) ; \n + } \n + catch ( InterruptedException e ) \n + { \n + / / don ' t care \n + } \n + } \n + \n + return counter ; \n + } \n code \ src \ main \ com \ lmax \ disruptor \ WaitStrategy . java \n - private static final int SPIN _ TRIES = 200 ; \n + private static final int RETRIES = 200 ; \n - int counter = SPIN _ TRIES ; \n + int counter = RETRIES ; \n - int counter = SPIN _ TRIES ; \n + int counter = RETRIES ; \n,Apply back pressure strategies when event processors cannot keep up .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - long minSequence ; \n + long minSequence ; \n - if ( counter > 100 ) \n - { \n - - - counter ; \n - } \n - else \n + - - counter ; \n + if ( counter < 0 ) \n - counter = applyBackPressure ( counter ) ; \n + Thread . yield ( ) ; \n,Don ' t sleep when serialising the publishing .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + / * * \n + * Is there available capacity in the buffer for the requested sequence . \n + * \n + * @ param sequence to check is in range \n + * @ param dependentSequences to be checked for range . \n + * / \n + boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) ; \n + \n + @ Override \n + public boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) \n + { \n + final long wrapPoint = sequence - bufferSize ; \n + if ( wrapPoint > minGatingSequence . get ( ) ) \n + { \n + long minSequence = getMinimumSequence ( dependentSequences ) ; \n + minGatingSequence . set ( minSequence ) ; \n + \n + if ( wrapPoint > minSequence ) \n + { \n + return false ; \n + } \n + } \n + \n + return true ; \n + } \n + \n + \n + @ Override \n + public boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) \n + { \n + final long wrapPoint = sequence - bufferSize ; \n + if ( wrapPoint > minGatingSequence . get ( ) ) \n + { \n + long minSequence = getMinimumSequence ( dependentSequences ) ; \n + minGatingSequence . set ( minSequence ) ; \n + \n + if ( wrapPoint > minSequence ) \n + { \n + return false ; \n + } \n + } \n + \n + return true ; \n + } \n + \n code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n + / * * \n + * Has the buffer got capacity to allocate another sequence . \n + * \n + * @ return true if the buffer has the capacity to allocate the next sequence otherwise false . \n + * / \n + public boolean hasAvailableCapacity ( ) \n + { \n + return claimStrategy . hasAvailableCapacity ( cursor . get ( ) + 1L , gatingSequences ) ; \n + } \n + \n + / * * \n + * Has the buffer got capacity to allocate another batch of sequences . \n + * \n + * @ return true if the buffer has the capacity to allocate the next sequence batch otherwise false . \n + * / \n + public boolean hasAvailableCapacity ( final SequenceBatch sequenceBatch ) \n + { \n + return claimStrategy . hasAvailableCapacity ( cursor . get ( ) + sequenceBatch . getSize ( ) , gatingSequences ) ; \n + } \n + \n",Added the ability to ask the Sequencer if the buffer has capacity to allocate the next sequence .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - - counter ; \n - if ( counter < 0 ) \n + if ( counter = = 0 ) \n + counter = RETRIES ; \n,Only yield occasionally when serialising the publishing .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - * @ param sequence to check is in range \n - boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) ; \n + boolean hasAvailableCapacity ( final Sequence [ ] dependentSequences ) ; \n - public boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) \n + public boolean hasAvailableCapacity ( final Sequence [ ] dependentSequences ) \n - final long wrapPoint = sequence - bufferSize ; \n + final long wrapPoint = ( sequence . get ( ) + 1L ) - bufferSize ; \n - public boolean hasAvailableCapacity ( final long sequence , final Sequence [ ] dependentSequences ) \n + public boolean hasAvailableCapacity ( final Sequence [ ] dependentSequences ) \n - final long wrapPoint = sequence - bufferSize ; \n + final long wrapPoint = ( sequence . get ( ) + 1L ) - bufferSize ; \n code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n - return claimStrategy . hasAvailableCapacity ( cursor . get ( ) + 1L , gatingSequences ) ; \n - } \n - \n - / * * \n - * Has the buffer got capacity to allocate another batch of sequences . \n - * \n - * @ return true if the buffer has the capacity to allocate the next sequence batch otherwise false . \n - * / \n - public boolean hasAvailableCapacity ( final SequenceBatch sequenceBatch ) \n - { \n - return claimStrategy . hasAvailableCapacity ( cursor . get ( ) + sequenceBatch . getSize ( ) , gatingSequences ) ; \n + return claimStrategy . hasAvailableCapacity ( gatingSequences ) ; \n",Check against the allocation sequence rather than cursor for available capacity,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - minGatingSequence . set ( minSequence ) ; \n + minGatingSequence . lazySet ( minSequence ) ; \n,lazySet min gating sequence rather than set with memory barrier .,322
code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n + claimStrategy . setSequence ( sequence ) ; \n - claimStrategy . setSequence ( sequence ) ; \n,Set claim sequence when the claim happens and not on publish .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - checkCapacity ( dependentSequences ) ; \n - int counter = RETRIES ; \n - while ( ! hasAvailableCapacity ( dependentSequences ) ) \n + final long wrapPoint = ( sequence . get ( ) + 1L ) - bufferSize ; \n + if ( wrapPoint > minGatingSequence . get ( ) ) \n - counter = applyBackPressure ( counter ) ; \n + int counter = RETRIES ; \n + long minSequence ; \n + while ( wrapPoint > ( minSequence = getMinimumSequence ( dependentSequences ) ) ) \n + { \n + counter = applyBackPressure ( counter ) ; \n + } \n + \n + minGatingSequence . lazySet ( minSequence ) ; \n - checkCapacity ( dependentSequences ) ; \n - checkCapacity ( dependentSequences ) ; \n - private void checkCapacity ( final Sequence [ ] dependentSequences ) \n - { \n - int counter = RETRIES ; \n - while ( ! hasAvailableCapacity ( dependentSequences ) ) \n - { \n - counter = applyBackPressure ( counter ) ; \n - } \n - } \n - \n - \n - private int applyBackPressure ( int counter ) \n - { \n - if ( 0 ! = counter ) \n - { \n - - - counter ; \n - Thread . yield ( ) ; \n - } \n - else \n - { \n - try \n - { \n - Thread . sleep ( 1L ) ; \n - } \n - catch ( InterruptedException e ) \n - { \n - / / don ' t care \n - } \n - } \n - \n - return counter ; \n - } \n,Optimised checkAvailability on multi - threaded sequence claim .,322
docs \ Disruptor . docx \n Binary files a / docs / Disruptor . docx and b / docs / Disruptor . docx differ \n,Add some meat from our results to the abstract,322
"code \ src \ main \ com \ lmax \ disruptor \ collections \ Histogram . java \n + \n + lowerBound = upperBound + 1 ; \n code \ src \ test \ com \ lmax \ disruptor \ collections \ HistogramTest . java \n - assertThat ( histogram . getMean ( ) , is ( new BigDecimal ( "" 94 . 17 "" ) ) ) ; \n + assertThat ( histogram . getMean ( ) , is ( new BigDecimal ( "" 103 . 83 "" ) ) ) ; \n - "" Histogram { min = 1 , max = 300 , mean = 127 . 50 , 99 % = 1000 , 99 . 99 % = 1000 , [ 1 = 1 , 10 = 2 , 100 = 0 , 1000 = 1 , 9223372036854775807 = 0 ] } "" ; \n + "" Histogram { min = 1 , max = 300 , mean = 140 . 50 , 99 % = 1000 , 99 . 99 % = 1000 , [ 1 = 1 , 10 = 2 , 100 = 0 , 1000 = 1 , 9223372036854775807 = 0 ] } "" ; \n",Correction to lowerBound tracking in mean histogram calculation .,322
"code \ src \ main \ com \ lmax \ disruptor \ collections \ Histogram . java \n - long lowerBound = counts [ 0 ] > 0 ? minValue : 0L ; \n + long lowerBound = counts [ 0 ] > 0L ? minValue : 0L ; \n - lowerBound = Math . max ( upperBounds [ i ] + 1 , minValue ) ; \n + lowerBound = Math . max ( upperBounds [ i ] + 1L , minValue ) ; \n code \ src \ test \ com \ lmax \ disruptor \ collections \ HistogramTest . java \n - assertThat ( histogram . getMean ( ) . intValue ( ) , is ( 125 ) ) ; \n + \n + assertThat ( histogram . getMean ( ) , is ( new BigDecimal ( "" 125 . 02 "" ) ) ) ; \n",Improved approximation of Histogram mean for skewed populations with sparsely populated upper and lower intervals,322
"code \ src \ main \ com \ lmax \ disruptor \ collections \ Histogram . java \n + if ( 0L = = getCount ( ) ) \n + { \n + return BigDecimal . ZERO ; \n + } \n + \n - long upperBound = Math . min ( upperBounds [ i ] , maxValue ) ; \n - long midPoint = lowerBound + ( ( upperBound - lowerBound ) / 2L ) ; \n + if ( 0L ! = counts [ i ] ) \n + { \n + long upperBound = Math . min ( upperBounds [ i ] , maxValue ) ; \n + long midPoint = lowerBound + ( ( upperBound - lowerBound ) / 2L ) ; \n + \n + BigDecimal intervalTotal = new BigDecimal ( midPoint ) . multiply ( new BigDecimal ( counts [ i ] ) ) ; \n + total = total . add ( intervalTotal ) ; \n - BigDecimal intervalTotal = new BigDecimal ( midPoint ) . multiply ( new BigDecimal ( counts [ i ] ) ) ; \n - total = total . add ( intervalTotal ) ; \n - lowerBound = Math . max ( upperBounds [ i ] + 1L , minValue ) ; \n + lowerBound = Math . max ( upperBounds [ i ] + 1L , minValue ) ; \n + } \n",Only calculate total for interval when count is greater than zero .,322
"code \ build . xml \n - fork = "" false "" \n - haltonfailure = "" true "" > \n + fork = "" true "" \n + forkmode = "" perTest "" \n + haltonfailure = "" false "" > \n - < report todir = "" $ { dir . reports } / perf "" / > \n + < report todir = "" $ { dir . reports } / perf "" / > \n",Run performance tests by forking a new JVM,322
code \ src \ main \ com \ lmax \ disruptor \ package . html \n + / / Entry holder for data to be exchange that must extend AbstractEntry \n + public final class ValueEntry extends AbstractEntry \n + { \n + private long value ; \n + \n + public long getValue ( ) \n + { \n + return value ; \n + } \n + \n + public void setValue ( final long value ) \n + { \n + this . value = value ; \n + } \n + \n + public final static EntryFactory & lt ; ValueEntry & gt ; ENTRY _ FACTORY = new EntryFactory & lt ; ValueEntry & gt ; ( ) \n + { \n + public ValueEntry create ( ) \n + { \n + return new ValueEntry ( ) ; \n + } \n + } ; \n + } \n + \n - / / copy data into the entry \n + entry . setValue ( 1234 ) ; \n,Removed Entry interface so all entries must extend AbstractEntry,322
"code \ src \ main \ com \ lmax \ disruptor \ BatchConsumer . java \n - public long p1 , p2 , p3 , p4 , p5 , p6 , p7 ; / / cache line padding \n - private volatile boolean running = true ; \n - public long p8 , p9 , p10 , p11 , p12 , p13 , p14 ; / / cache line padding \n - private volatile long sequence = - 1L ; \n - public long p15 , p16 , p17 , p18 , p19 ; / / cache line padding \n - \n + public long p1 , p2 , p3 , p4 , p5 , p6 , p7 ; / / cache line padding \n + private volatile boolean running = true ; \n + public long p8 , p9 , p10 , p11 , p12 , p13 , p14 ; / / cache line padding \n + private volatile long sequence = - 1L ; \n + public long p15 , p16 , p17 , p18 , p19 , p20 ; / / cache line padding \n + @ Override \n + public long getSequence ( ) \n + { \n + return sequence ; \n + } \n + \n + @ Override \n + public void halt ( ) \n + { \n + running = false ; \n + consumerBarrier . alert ( ) ; \n + } \n + \n - @ Override \n - public long getSequence ( ) \n - { \n - return sequence ; \n - } \n - \n - \n - @ Override \n - public void halt ( ) \n - { \n - running = false ; \n - consumerBarrier . alert ( ) ; \n - } \n - \n - \n - if ( noSequenceTracker ) \n - { \n - sequence = entry . getSequence ( ) ; \n - } \n + \n + if ( noSequenceTracker ) \n + { \n + sequence = entry . getSequence ( ) ; \n + } \n + \n",Move sequence tracking outside of batch loop .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n + private volatile long lastConsumerMinimum = 0L ; \n - while ( ( sequence - getMinimumSequence ( consumers ) ) > = entries . length ) \n + final long wrapPoint = sequence - entries . length ; \n + if ( lastConsumerMinimum < = wrapPoint ) \n - Thread . yield ( ) ; \n + lastConsumerMinimum = getMinimumSequence ( consumers ) ; \n + while ( lastConsumerMinimum < = wrapPoint ) \n + { \n + Thread . yield ( ) ; \n + lastConsumerMinimum = getMinimumSequence ( consumers ) ; \n + } \n + private long lastConsumerMinimum = 0L ; \n - while ( ( sequence - getMinimumSequence ( consumers ) ) > = entries . length ) \n + final long wrapPoint = sequence - entries . length ; \n + if ( lastConsumerMinimum < = wrapPoint ) \n - Thread . yield ( ) ; \n + lastConsumerMinimum = getMinimumSequence ( consumers ) ; \n + while ( lastConsumerMinimum < = wrapPoint ) \n + { \n + Thread . yield ( ) ; \n + lastConsumerMinimum = getMinimumSequence ( consumers ) ; \n + } \n,Cache last consumer minimum in producer barrier .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - final class ConsumerTrackingProducerBarrier implements ProducerBarrier < T > \n + private final class ConsumerTrackingProducerBarrier implements ProducerBarrier < T > \n - private volatile long lastConsumerMinimum = 0L ; \n + private long lastConsumerMinimum = 0L ; \n - final class ForceFillConsumerTrackingProducerBarrier implements ForceFillProducerBarrier < T > \n + private final class ForceFillConsumerTrackingProducerBarrier implements ForceFillProducerBarrier < T > \n - private long lastConsumerMinimum = 0L ; \n + private long lastConsumerMinimum = 0L ; \n,cached value does not need to be volatile,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * Ring based store of reusable entries containing the data representing an { @ link AbstractEntry } being exchanged between producers and consumers . \n + * Ring based store of reusable entries containing the data representing an { @ link AbstractEntry } being exchanged between producers and consumersToTrack . \n - private long lastConsumerMinimum = INITIAL _ CURSOR _ VALUE ; \n - private Consumer [ ] consumers ; \n + private long lastTrackedConsumerMin = INITIAL _ CURSOR _ VALUE ; \n + private Consumer [ ] consumersToTrack ; \n - * @ param waitStrategyOption waiting strategy employed by consumers waiting on { @ link AbstractEntry } s becoming available . \n + * @ param waitStrategyOption waiting strategy employed by consumersToTrack waiting on { @ link AbstractEntry } s becoming available . \n - * Set the consumers that will be tracked to prevent the ring wrapping . \n + * Set the consumersToTrack that will be tracked to prevent the ring wrapping . \n - this . consumers = consumers ; \n + this . consumersToTrack = consumers ; \n - \n - while ( wrapPoint > lastConsumerMinimum & & \n - wrapPoint > ( lastConsumerMinimum = getMinimumSequence ( consumers ) ) ) \n + while ( wrapPoint > lastTrackedConsumerMin & & \n + wrapPoint > ( lastTrackedConsumerMin = getMinimumSequence ( consumersToTrack ) ) ) \n - * ConsumerBarrier handed out for gating consumers of the RingBuffer and dependent { @ link Consumer } ( s ) \n + * ConsumerBarrier handed out for gating consumersToTrack of the RingBuffer and dependent { @ link Consumer } ( s ) \n,Rename fields for tracked consumers in the RingBuffer .,322
rename from code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CBatchPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastBatchPerfTest . java \n - public final class UniCast1P1CBatchPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class OnePublisherToOneProcessorUniCastBatchPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastPerfTest . java \n - public final class UniCast1P1CPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class OnePublisherToOneProcessorUniCastPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ UniCastRaw1P1CPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastRawPerfTest . java \n - public class UniCastRaw1P1CPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public class OnePublisherToOneProcessorUniCastRawPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ DiamondPath1P3CPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorDiamondPerfTest . java \n - public final class DiamondPath1P3CPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class OnePublisherToThreeProcessorDiamondPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ MultiCast1P3CPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorMultiCastPerfTest . java \n - public final class MultiCast1P3CPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class OnePublisherToThreeProcessorMultiCastPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ Pipeline3StepPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorPipelinePerfTest . java \n - public final class Pipeline3StepPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class OnePublisherToThreeProcessorPipelinePerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ Sequencer3P1CPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ ThreePublisherToOneProcessorSequencedPerfTest . java \n - public final class Sequencer3P1CPerfTest extends AbstractPerfTestQueueVsDisruptor \n + public final class ThreePublisherToOneProcessorSequencedPerfTest extends AbstractPerfTestQueueVsDisruptor \n rename from code \ src \ perf \ com \ lmax \ disruptor \ Pipeline3StepLatencyPerfTest . java \n rename to code \ src \ perf \ com \ lmax \ disruptor \ ThrottledOnePublisherToThreeProcessorPipelineLatencyPerfTest . java \n - public final class Pipeline3StepLatencyPerfTest \n + public final class ThrottledOnePublisherToThreeProcessorPipelineLatencyPerfTest \n,Rename performance tests to reflect new naming .,322
"code \ build . xml \n - < zip destfile = "" $ { dir . dist } / disruptor - src . zip "" basedir = "" $ { dir . main . src } "" / > \n - < zip destfile = "" $ { dir . dist } / disruptor - api . zip "" basedir = "" $ { dir . docs } "" / > \n + < jar destfile = "" $ { dir . dist } / disruptor - src . jar "" basedir = "" $ { dir . main . src } "" / > \n + < jar destfile = "" $ { dir . dist } / disruptor - api . jar "" basedir = "" $ { dir . docs } "" / > \n",Create source and javadoc as jar files rather than zip .,322
"code \ src \ perf \ com \ lmax \ disruptor \ AbstractPerfTestQueueVsDisruptor . java \n - System . out . format ( "" % s OpsPerSecond run % d : BlockingQueues = % d , Disruptor = % d \ n "" , \n + System . out . format ( "" % s OpsPerSecond run % d : BlockingQueues = % , d , Disruptor = % , d \ n "" , \n",Add comma to number format in performance figures output .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - import java . util . concurrent . atomic . AtomicLong ; \n + import java . util . concurrent . atomic . AtomicLongArray ; \n - private final AtomicLong sequence = new AtomicLong ( RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n + private final AtomicLongArray sequence = new AtomicLongArray ( 5 ) ; / / cache line padded \n + \n + public MultiThreadedStrategy ( ) \n + { \n + sequence . set ( 0 , RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n + } \n - return sequence . incrementAndGet ( ) ; \n + return sequence . incrementAndGet ( 0 ) ; \n - return sequence . addAndGet ( delta ) ; \n + return sequence . addAndGet ( 0 , delta ) ; \n - this . sequence . set ( sequence ) ; \n + this . sequence . lazySet ( 0 , sequence ) ; \n - private long sequence = RingBuffer . INITIAL _ CURSOR _ VALUE ; \n + private final long [ ] sequence = new long [ 5 ] ; / / cache line padded \n + \n + public SingleThreadedStrategy ( ) \n + { \n + sequence [ 0 ] = RingBuffer . INITIAL _ CURSOR _ VALUE ; \n + } \n - return + + sequence ; \n + return + + sequence [ 0 ] ; \n - sequence + = delta ; \n - return sequence ; \n + sequence [ 0 ] + = delta ; \n + return sequence [ 0 ] ; \n - this . sequence = sequence ; \n + this . sequence [ 0 ] = sequence ; \n",Padded ClaimStrategy cache lines to prevent false sharing .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - private long [ ] minProcessorSequence = new long [ 5 ] ; / / padded to prevent false sharing . \n + private final long [ ] minProcessorSequence = new long [ 5 ] ; / / padded to prevent false sharing . \n,Made minProcessorSequence [ ] final so the reference can be cached in a register .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + * @ param bufferSize of the { @ link RingBuffer } for events . \n - private final Sequence minProcessorSequence = new Sequence ( RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n + private final AtomicLongArray minProcessorSequence = new AtomicLongArray ( 5 ) ; / / cache line padded \n + minProcessorSequence . set ( 0 , RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n - if ( wrapPoint > minProcessorSequence . get ( ) ) \n + if ( wrapPoint > minProcessorSequence . get ( 0 ) ) \n - minProcessorSequence . set ( minSequence ) ; \n + minProcessorSequence . lazySet ( 0 , minSequence ) ; \n",Removed a layer of indirection for tracking the event processor minimum sequence .,322
code \ src \ main \ com \ lmax \ disruptor \ NoOpEventProcessor . java \n - super ( - 1L ) ; \n + super ( RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n,Use RingBuffer . INITIAL _ CURSOR _ VALUE constant rather than - 1L ;,322
code \ src \ main \ com \ lmax \ disruptor \ Sequence . java \n - public static final int VALUE _ PLUS _ CACHE _ LINE _ PADDING = 5 ; \n + public static final int VALUE _ PLUS _ CACHE _ LINE _ PADDING = 6 ; \n,Cache line padding need one more for 32 - bit .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - public T publishEventAtSequence ( final long sequence ) \n + public T claimEventAtSequence ( final long sequence ) \n code \ src \ test \ com \ lmax \ disruptor \ RingBufferTest . java \n - StubEvent expectedEvent = ringBuffer . publishEventAtSequence ( expectedSequence ) ; \n + StubEvent expectedEvent = ringBuffer . claimEventAtSequence ( expectedSequence ) ; \n,Renaming mistake for publishEventAtSequence should have been claimEventAtSequence,322
code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CBatchPerfTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 500L ; \n + private static final long ITERATIONS = 1000L * 1000L * 50L ; \n + long offset = 0 ; \n - \n - int offset = 0 ; \n - entry . setValue ( i + offset + + ) ; \n + entry . setValue ( offset + + ) ; \n - \n,Factored out sequence to be like non - batch case .,322
"deleted file \n code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedAtomicBoolean . java \n - package com . lmax . disruptor . util ; \n - \n - import java . util . concurrent . atomic . AtomicBoolean ; \n - \n - / * * \n - * Version of AtomicBoolean with cache line padding to prevent false sharing . \n - * / \n - public class PaddedAtomicBoolean extends AtomicBoolean \n - { \n - public volatile long p1 , p2 , p3 , p4 , p5 , p6 , p7 = 7L ; \n - \n - / * * \n - * Default constructor \n - * / \n - public PaddedAtomicBoolean ( ) \n - { \n - } \n - \n - / * * \n - * Construct with an initial value . \n - * \n - * @ param initialValue for initialisation \n - * / \n - public PaddedAtomicBoolean ( final boolean initialValue ) \n - { \n - super ( initialValue ) ; \n - } \n - } \n code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedAtomicLong . java \n + \n + public long sumPaddingToPreventOptimisation ( ) \n + { \n + return p1 + p2 + p3 + p4 + p5 + p6 ; \n + } \n code \ src \ main \ com \ lmax \ disruptor \ util \ PaddedLong . java \n + \n + public long sumPaddingToPreventOptimisation ( ) \n + { \n + return p1 + p2 + p3 + p4 + p5 + p6 ; \n + } \n",Make it harder for the JVM to optimise away false sharing padding .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - private static final ThreadLocal < MutableLong > minGatingSequenceThreadLocal = new ThreadLocal < MutableLong > ( ) \n + private final ThreadLocal < MutableLong > minGatingSequenceThreadLocal = new ThreadLocal < MutableLong > ( ) \n,Bugfix for issue id = 10 : ClaimStrategy . Option . MULTI _ THREADED thread local catch of gated minimum needs to be by instance of the strategy .,322
"code \ src \ main \ com \ lmax \ disruptor \ dsl \ Disruptor . java \n + @ SuppressWarnings ( value = "" unchecked "" ) \n - final BatchEventProcessor < T > batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , eventHandler ) ; \n + \n + final BatchEventProcessor < T > batchEventProcessor ; \n + if ( eventHandler instanceof SequenceReportingEventHandler ) \n + { \n + batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , ( SequenceReportingEventHandler ) eventHandler ) ; \n + } \n + else \n + { \n + batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , eventHandler ) ; \n + } \n + \n",Bugfix for issue id = 9 : Disruptor DSL not working with SequenceReportingEventHandler,322
"code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n - } \n - / * * \n - * Construct a batch event processor that will allow a { @ link SequenceReportingEventHandler } \n - * to callback and update its sequence within a batch . The Sequence will be updated at the end of \n - * a batch regardless . \n - * \n - * @ param ringBuffer to which events are published . \n - * @ param sequenceBarrier on which it is waiting . \n - * @ param eventHandler is the delegate to which events are dispatched . \n - * / \n - public BatchEventProcessor ( final RingBuffer < T > ringBuffer , \n - final SequenceBarrier sequenceBarrier , \n - final SequenceReportingEventHandler < T > eventHandler ) \n - { \n - this . ringBuffer = ringBuffer ; \n - this . sequenceBarrier = sequenceBarrier ; \n - this . eventHandler = eventHandler ; \n - eventHandler . setSequenceCallback ( sequence ) ; \n + if ( SequenceReportingEventHandler . class . isAssignableFrom ( eventHandler . getClass ( ) ) ) \n + { \n + ( ( SequenceReportingEventHandler ) eventHandler ) . setSequenceCallback ( sequence ) ; \n + } \n - / * * \n - * Get the { @ link SequenceBarrier } the { @ link EventProcessor } is waiting on . \n - * \n - * @ return the sequenceBarrier this { @ link EventProcessor } is using . \n - * / \n - public SequenceBarrier getSequenceBarrier ( ) \n - { \n - return sequenceBarrier ; \n - } \n - \n - ( ( LifecycleAware ) eventHandler ) . onStart ( ) ; \n + ( ( LifecycleAware ) eventHandler ) . onStart ( ) ; \n - ( ( LifecycleAware ) eventHandler ) . onShutdown ( ) ; \n + ( ( LifecycleAware ) eventHandler ) . onShutdown ( ) ; \n code \ src \ main \ com \ lmax \ disruptor \ dsl \ Disruptor . java \n - final BatchEventProcessor < T > batchEventProcessor ; \n - if ( eventHandler instanceof SequenceReportingEventHandler ) \n - { \n - batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , ( SequenceReportingEventHandler ) eventHandler ) ; \n - } \n - else \n - { \n - batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , eventHandler ) ; \n - } \n + final BatchEventProcessor < T > batchEventProcessor = new BatchEventProcessor < T > ( ringBuffer , barrier , eventHandler ) ; \n code \ src \ test \ com \ lmax \ disruptor \ BatchEventProcessorTest . java \n - @ Test \n - public void shouldReturnUnderlyingBarrier ( ) \n - { \n - assertEquals ( sequenceBarrier , batchEventProcessor . getSequenceBarrier ( ) ) ; \n - } \n - \n",Better bugfix for id = 9 : Disruptor DSL not working with SequenceReportingEventHandler,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - checkCapacity ( dependentSequences , minGatingSequence ) ; \n + pauseForCapacity ( dependentSequences , minGatingSequence ) ; \n - private void checkCapacity ( final Sequence [ ] dependentSequences , final MutableLong minGatingSequence ) \n + private void pauseForCapacity ( final Sequence [ ] dependentSequences , final MutableLong minGatingSequence ) \n - int counter = RETRIES ; \n - if ( - - counter = = 0 ) \n - { \n - counter = RETRIES ; \n - Thread . yield ( ) ; \n - } \n + Thread . yield ( ) ; \n - private static final int RETRIES = 100 ; \n - int counter = RETRIES ; \n - if ( - - counter = = 0 ) \n - { \n - counter = RETRIES ; \n - Thread . yield ( ) ; \n - } \n + Thread . yield ( ) ; \n",No point spinning when there is insufficient capacity for publishing .,322
"code \ src \ perf \ com \ lmax \ disruptor \ ThreePublisherToOneProcessorSequencedThroughputTest . java \n - valueQueuePublishers [ 0 ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS ) ; \n - valueQueuePublishers [ 1 ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS ) ; \n - valueQueuePublishers [ 2 ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS ) ; \n + for ( int i = 0 ; i < NUM _ PUBLISHERS ; i + + ) \n + { \n + valueQueuePublishers [ i ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS ) ; \n + } \n - valuePublishers [ 0 ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS ) ; \n - valuePublishers [ 1 ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS ) ; \n - valuePublishers [ 2 ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS ) ; \n + for ( int i = 0 ; i < NUM _ PUBLISHERS ; i + + ) \n + { \n + valuePublishers [ i ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS ) ; \n + } \n",Allow the number of publishers to be altered by changing a single variable .,322
code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastRawThroughputTest . java \n + barrier . clearAlert ( ) ; \n + \n - if ( ! running ) \n - { \n - break ; \n - } \n + if ( ! running ) \n + { \n + break ; \n + } \n,Should clear alert before re - using running tests with the Sequencer directly .,322
"code \ src \ main \ com \ lmax \ disruptor \ SequenceBatch . java \n - public SequenceBatch ( final int size ) \n + SequenceBatch ( final int size ) \n code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n + / * * \n + * Create a new { @ link SequenceBatch } that is the minimum of the requested size \n + * and the buffer size . \n + * \n + * @ param size for the batch \n + * @ return the new { @ link SequenceBatch } \n + * / \n + public SequenceBatch newSequenceBatch ( final int size ) \n + { \n + return new SequenceBatch ( Math . min ( size , bufferSize ) ) ; \n + } \n + \n - final int batchSize = sequenceBatch . getSize ( ) ; \n - if ( batchSize > bufferSize ) \n - { \n - final String msg = "" Batch size "" + batchSize + "" is greater than buffer size of "" + bufferSize ; \n - throw new IllegalArgumentException ( msg ) ; \n - } \n - \n - final long sequence = claimStrategy . incrementAndGet ( batchSize , gatingSequences ) ; \n + final long sequence = claimStrategy . incrementAndGet ( sequenceBatch . getSize ( ) , gatingSequences ) ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastBatchThroughputTest . java \n - final SequenceBatch sequenceBatch = new SequenceBatch ( batchSize ) ; \n + final SequenceBatch sequenceBatch = ringBuffer . newSequenceBatch ( batchSize ) ; \n","Move SequenceBatch creation to be a factory method on Sequencer . This allows the batch size to be set to the minimum of the buffer size or the requested size , and avoids the need to check it is less than the buffer size on every call to claim the next batch .",322
code \ src \ main \ com \ lmax \ disruptor \ Sequence . java \n + / * * \n + * Get the current value of the { @ link Sequence } \n + * \n + * @ return the current value . \n + * / \n + / * * \n + * Set the { @ link Sequence } to a value . \n + * \n + * @ param value to which the { @ link Sequence } will be set . \n + * / \n + \n + / * * \n + * Value of the { @ link Sequence } as a String . \n + * \n + * @ return String representation of the sequence . \n + * / \n + public String toString ( ) \n + { \n + return Long . toString ( value . get ( ) ) ; \n + } \n,Javadoc and added a toString ( ) method .,322
code \ src \ main \ com \ lmax \ disruptor \ WorkerPool . java \n + import com . lmax . disruptor . util . Util ; \n - while ( ringBuffer . getCursor ( ) > workSequence . get ( ) ) \n + Sequence [ ] workerSequences = getWorkerSequences ( ) ; \n + while ( ringBuffer . getCursor ( ) > Util . getMinimumSequence ( workerSequences ) ) \n,Wait on all workers to complete in drain method .,322
docs \ Disruptor . docx \n Binary files a / docs / Disruptor . docx and b / docs / Disruptor . docx differ \n,Updated paper for language sweep and added code sample,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - * a { @ link AbstractEntry } in the { @ link RingBuffer } . \n + * an { @ link AbstractEntry } in the { @ link RingBuffer } . \n code \ src \ perf \ com \ lmax \ disruptor \ UniCast1P1CBatchPerfTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 50L ; \n + private static final long ITERATIONS = 1000L * 1000L * 500L ; \n,Up the number of iterations on the batch run to be the same as the other perf tests .,322
code \ src \ main \ com \ lmax \ disruptor \ GroupSequence . java \n + / * * \n + * Set all { @ link Sequence } s in the group to a given value . \n + * \n + * @ param value to set the group of sequences to . \n + * / \n - * Remove a { @ link Sequence } from this aggregate . \n + * Remove the first occurrence of the { @ link Sequence } from this aggregate . \n + * @ return true if the sequence was removed otherwise false . \n - public void remove ( final Sequence sequence ) \n + public boolean remove ( final Sequence sequence ) \n - aggregateSequences . remove ( sequence ) ; \n + return aggregateSequences . remove ( sequence ) ; \n code \ src \ test \ com \ lmax \ disruptor \ GroupSequenceTest . java \n + import static junit . framework . Assert . assertTrue ; \n - groupSequence . remove ( sequenceThree ) ; \n + assertTrue ( groupSequence . remove ( sequenceThree ) ) ; \n,Added the ability to have a dynamic group of sequences that can be used in place of a single sequence . This is useful when event processors can dynamically come and go .,322
code \ src \ main \ com \ lmax \ disruptor \ WaitStrategy . java \n + private volatile int numWaiters = 0 ; \n + + + numWaiters ; \n + - - numWaiters ; \n + + + numWaiters ; \n + - - numWaiters ; \n - lock . lock ( ) ; \n - try \n + if ( 0 ! = numWaiters ) \n - processorNotifyCondition . signalAll ( ) ; \n - } \n - finally \n - { \n - lock . unlock ( ) ; \n + lock . lock ( ) ; \n + try \n + { \n + processorNotifyCondition . signalAll ( ) ; \n + } \n + finally \n + { \n + lock . unlock ( ) ; \n + } \n,Performance optimisation for WaitStrategy . BLOCKING to avoid the lock when publishing if no event processors are waiting .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - WaitStrategy . Option . SLEEPING ) ; \n + WaitStrategy . Option . BLOCKING ) ; \n,Set default wait strategy back to BLOCKING .,322
"code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n - * @ param units for the timeout period . \n + * @ param sourceUnit for the timeout period . \n - public long next ( final long timeout , final TimeUnit units ) throws TimeoutException \n + public long next ( final long timeout , final TimeUnit sourceUnit ) throws TimeoutException \n - waitForCapacity ( 1 , timeout , units ) ; \n + waitForCapacity ( 1 , timeout , sourceUnit ) ; \n - * @ param units for the timeout period . \n + * @ param sourceUnit for the timeout period . \n - public BatchDescriptor next ( final BatchDescriptor batchDescriptor , final long timeout , final TimeUnit units ) throws TimeoutException \n + public BatchDescriptor next ( final BatchDescriptor batchDescriptor , final long timeout , final TimeUnit sourceUnit ) throws TimeoutException \n - waitForCapacity ( batchDescriptor . getSize ( ) , timeout , units ) ; \n + waitForCapacity ( batchDescriptor . getSize ( ) , timeout , sourceUnit ) ; \n code \ src \ main \ com \ lmax \ disruptor \ WaitStrategy . java \n - * @ param units of the timeout value . \n + * @ param sourceUnit of the timeout value . \n - long waitFor ( long sequence , Sequence cursor , Sequence [ ] dependents , SequenceBarrier barrier , long timeout , TimeUnit units ) \n + long waitFor ( long sequence , Sequence cursor , Sequence [ ] dependents , SequenceBarrier barrier , long timeout , TimeUnit sourceUnit ) \n",Naming of TimeUnit parameters to reflect it is the source TimeUnit .,322
code \ src \ main \ com \ lmax \ disruptor \ util \ Util . java \n - / * * \n - * Get the minimum sequence from an array of { @ link com . lmax . disruptor . EventProcessor } s . \n - * \n - * @ param eventProcessors to compare . \n - * @ return the minimum sequence found or Long . MAX _ VALUE if the array is empty . \n - * / \n - public static long getMinimumSequence ( final EventProcessor [ ] eventProcessors ) \n - { \n - long minimum = Long . MAX _ VALUE ; \n - \n - for ( EventProcessor eventProcessor : eventProcessors ) \n - { \n - long sequence = eventProcessor . getSequence ( ) . get ( ) ; \n - minimum = minimum < sequence ? minimum : sequence ; \n - } \n - \n - return minimum ; \n - } \n - \n - \n rename from code \ src \ test \ com \ lmax \ disruptor \ UtilTest . java \n rename to code \ src \ test \ com \ lmax \ disruptor \ util \ UtilTest . java \n - package com . lmax . disruptor ; \n + package com . lmax . disruptor . util ; \n - import com . lmax . disruptor . util . Util ; \n + import com . lmax . disruptor . Sequence ; \n,Tidy up of util class and location .,322
code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastBatchThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 500L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastRawThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorDiamondThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorMultiCastThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorPipelineThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeWorkerPoolThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n code \ src \ perf \ com \ lmax \ disruptor \ ThreePublisherToOneProcessorSequencedThroughputTest . java \n - private static final long ITERATIONS = 1000L * 1000L * 300L ; \n + private static final long ITERATIONS = 1000L * 1000L * 100L ; \n,Drop iteration count to 100 million for per runs . Seems to be sufficient .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - void serialisePublishing ( final long sequence , final Sequence cursor , final long batchSize ) ; \n + void serialisePublishing ( final long sequence , final Sequence cursor , final int batchSize ) ; \n - public void serialisePublishing ( final long sequence , final Sequence cursor , final long batchSize ) \n + public void serialisePublishing ( final long sequence , final Sequence cursor , final int batchSize ) \n - public void serialisePublishing ( final long sequence , final Sequence cursor , final long batchSize ) \n + public void serialisePublishing ( final long sequence , final Sequence cursor , final int batchSize ) \n code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n - private void publish ( final long sequence , final long batchSize ) \n + private void publish ( final long sequence , final int batchSize ) \n",Batch size should be int rather than long .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + import java . util . concurrent . locks . LockSupport ; \n + \n - private static final int RETRIES = 100 ; \n + private static final int RETRIES = 1000 ; \n - int counter = RETRIES ; \n - counter = applyBackPressure ( counter ) ; \n + LockSupport . parkNanos ( 1000L ) ; \n - Thread . yield ( ) ; \n + LockSupport . parkNanos ( 1000L ) ; \n - \n - private int applyBackPressure ( int counter ) \n - { \n - if ( 0 ! = counter ) \n - { \n - - - counter ; \n - Thread . yield ( ) ; \n - } \n - else \n - { \n - try \n - { \n - Thread . sleep ( 1L ) ; \n - } \n - catch ( InterruptedException e ) \n - { \n - / / don ' t care \n - } \n - } \n - \n - return counter ; \n - } \n - Thread . yield ( ) ; \n + LockSupport . parkNanos ( 1000L ) ; \n,Use LockSupport . parkNanos ( ) rather than sleep or yield when the buffer is full to cause back pressure .,322
code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - * Serialise publishing in sequence . \n + * Serialise publishing in sequence and set cursor to latest available sequence . \n + \n + cursor . set ( sequence ) ; \n + cursor . set ( sequence ) ; \n code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n - cursor . set ( sequence ) ; \n,Push setting of cursor on publication down into ClaimStrategy .,322
"code \ src \ perf \ com \ lmax \ disruptor \ ThreePublisherToOneProcessorSequencedThroughputTest . java \n - private final ValueAdditionQueueProcessor queueProcessor = new ValueAdditionQueueProcessor ( blockingQueue , ITERATIONS - 1 ) ; \n + private final ValueAdditionQueueProcessor queueProcessor = \n + new ValueAdditionQueueProcessor ( blockingQueue , ( ( ITERATIONS / NUM _ PUBLISHERS ) * NUM _ PUBLISHERS ) - 1L ) ; \n - valueQueuePublishers [ i ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS / 3 ) ; \n + valueQueuePublishers [ i ] = new ValueQueuePublisher ( cyclicBarrier , blockingQueue , ITERATIONS / NUM _ PUBLISHERS ) ; \n - valuePublishers [ i ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS / 3 ) ; \n + valuePublishers [ i ] = new ValuePublisher ( cyclicBarrier , ringBuffer , ITERATIONS / NUM _ PUBLISHERS ) ; \n - handler . reset ( latch , batchEventProcessor . getSequence ( ) . get ( ) + ITERATIONS ) ; \n + handler . reset ( latch , batchEventProcessor . getSequence ( ) . get ( ) + ( ( ITERATIONS / NUM _ PUBLISHERS ) * NUM _ PUBLISHERS ) ) ; \n",Reworked test to allow number of publishers to be changed via a constant .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + import java . util . concurrent . atomic . AtomicLongArray ; \n - private static final int RETRIES = 1000 ; \n + private final int indexMask ; \n + private final AtomicLongArray pendingPublications ; \n + private final PaddedAtomicLong csLock = new PaddedAtomicLong ( 0L ) ; \n + if ( Integer . bitCount ( bufferSize ) ! = 1 ) \n + { \n + throw new IllegalArgumentException ( "" bufferSize must be a power of 2 "" ) ; \n + } \n + \n + indexMask = bufferSize - 1 ; \n + pendingPublications = new AtomicLongArray ( bufferSize ) ; \n + for ( int i = 0 , size = pendingPublications . length ( ) ; i < size ; i + + ) \n + { \n + pendingPublications . lazySet ( i , Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n + } \n - int counter = RETRIES ; \n - while ( expectedSequence ! = cursor . get ( ) ) \n + if ( expectedSequence = = cursor . get ( ) ) \n - if ( - - counter = = 0 ) \n + cursor . set ( sequence ) ; \n + } \n + else \n + { \n + for ( long i = expectedSequence + 1 ; i < = sequence ; i + + ) \n - counter = RETRIES ; \n - Thread . yield ( ) ; \n + pendingPublications . lazySet ( ( int ) i & indexMask , i ) ; \n - cursor . set ( sequence ) ; \n + if ( 0L = = csLock . get ( ) & & csLock . compareAndSet ( 0L , 1L ) ) \n + { \n + long initialCursor = cursor . get ( ) ; \n + long currentCursor = initialCursor ; \n + \n + while ( currentCursor < claimSequence . get ( ) ) \n + { \n + long nextSequence = currentCursor + 1L ; \n + if ( nextSequence ! = pendingPublications . get ( ( int ) nextSequence & indexMask ) ) \n + { \n + break ; \n + } \n + \n + currentCursor = nextSequence ; \n + } \n + \n + if ( currentCursor > initialCursor ) \n + { \n + cursor . set ( currentCursor ) ; \n + } \n + \n + csLock . lazySet ( 0L ) ; \n + } \n",New multi - thread claim strategy implementation for serialising the publishers .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n + if ( sequence = = claimSequence . get ( ) ) \n + { \n + return ; \n + } \n - if ( 0L = = csLock . get ( ) & & csLock . compareAndSet ( 0L , 1L ) ) \n + if ( csLock . compareAndSet ( 0L , 1L ) ) \n - csLock . lazySet ( 0L ) ; \n + csLock . set ( 0L ) ; \n",Removed optimisation for lazySet on critical section of claim strategy,322
"code \ src \ perf \ com \ lmax \ disruptor \ AbstractPerfTestQueueVsDisruptor . java \n + System . out . println ( "" Completed BlockingQueue run "" + i ) ; \n + \n + System . out . println ( "" Completed Disruptor run "" + i ) ; \n",Added progress reporting to throughput tests in new format .,322
"code \ src \ perf \ com \ lmax \ disruptor \ AbstractPerfTestQueueVsDisruptor . java \n + final int availableProcessors = Runtime . getRuntime ( ) . availableProcessors ( ) ; \n + if ( getRequiredProcessorCount ( ) > availableProcessors ) \n + { \n + System . out . print ( "" * * * Warning * * * : your system has insufficient processors to execute the test efficiently . "" ) ; \n + System . out . println ( "" Processors required = "" + getRequiredProcessorCount ( ) + "" available = "" + availableProcessors ) ; \n + } \n + \n + protected abstract int getRequiredProcessorCount ( ) ; \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastBatchThroughputTest . java \n + \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 2 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastRawThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 2 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToOneProcessorUniCastThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 2 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorDiamondThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 4 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorMultiCastThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 4 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeProcessorPipelineThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 4 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ OnePublisherToThreeWorkerPoolThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 4 ; \n + } \n + \n code \ src \ perf \ com \ lmax \ disruptor \ ThreePublisherToOneProcessorSequencedThroughputTest . java \n + @ Override \n + protected int getRequiredProcessorCount ( ) \n + { \n + return 4 ; \n + } \n + \n",Added code for checking if sufficient processors exist for running the performance tests .,322
"code \ src \ perf \ com \ lmax \ disruptor \ ThrottledOnePublisherToThreeProcessorPipelineLatencyTest . java \n - final boolean runQueueTests = "" true "" . equalsIgnoreCase ( System . getProperty ( "" com . lmax . runQueueTests "" , "" true "" ) ) ; \n + \n + BigDecimal queueMeanLatency [ ] = new BigDecimal [ RUNS ] ; \n + BigDecimal disruptorMeanLatency [ ] = new BigDecimal [ RUNS ] ; \n + \n + if ( "" true "" . equalsIgnoreCase ( System . getProperty ( "" com . lmax . runQueueTests "" , "" true "" ) ) ) \n + { \n + for ( int i = 0 ; i < RUNS ; i + + ) \n + { \n + System . gc ( ) ; \n + histogram . clear ( ) ; \n + \n + runQueuePass ( ) ; \n + \n + assertThat ( Long . valueOf ( histogram . getCount ( ) ) , is ( Long . valueOf ( ITERATIONS ) ) ) ; \n + queueMeanLatency [ i ] = histogram . getMean ( ) ; \n + \n + System . out . format ( "" % s run % d BlockingQueue % s \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) , histogram ) ; \n + dumpHistogram ( System . out ) ; \n + } \n + } \n + else \n + { \n + for ( int i = 0 ; i < RUNS ; i + + ) \n + { \n + queueMeanLatency [ i ] = new BigDecimal ( Long . MAX _ VALUE ) ; \n + } \n + } \n - \n + \n + \n - final BigDecimal disruptorMeanLatency = histogram . getMean ( ) ; \n + disruptorMeanLatency [ i ] = histogram . getMean ( ) ; \n + \n + } \n - if ( runQueueTests ) \n - { \n - histogram . clear ( ) ; \n - runQueuePass ( ) ; \n - assertThat ( Long . valueOf ( histogram . getCount ( ) ) , is ( Long . valueOf ( ITERATIONS ) ) ) ; \n - final BigDecimal queueMeanLatency = histogram . getMean ( ) ; \n - System . out . format ( "" % s run % d Queues % s \ n "" , getClass ( ) . getSimpleName ( ) , Long . valueOf ( i ) , histogram ) ; \n - dumpHistogram ( System . out ) ; \n - \n - assertTrue ( queueMeanLatency . compareTo ( disruptorMeanLatency ) > 0 ) ; \n - } \n + for ( int i = 0 ; i < RUNS ; i + + ) \n + { \n + assertTrue ( queueMeanLatency [ i ] . compareTo ( disruptorMeanLatency [ i ] ) > 0 ) ; \n",Change latency test to be more like new throughput tests .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - for ( long i = expectedSequence + 1 ; i < = sequence ; i + + ) \n + for ( long i = expectedSequence + 1 ; i < sequence ; i + + ) \n - pendingPublications . set ( ( int ) i & indexMask , i ) ; \n + pendingPublications . lazySet ( ( int ) i & indexMask , i ) ; \n + \n + pendingPublications . set ( ( int ) sequence & indexMask , sequence ) ; \n",only memory barrier pending publications at end of batch .,322
"code \ src \ main \ com \ lmax \ disruptor \ ClaimStrategy . java \n - import java . util . concurrent . atomic . AtomicLongArray ; \n - private final int indexMask ; \n - private final AtomicLongArray pendingPublications ; \n - private final PaddedAtomicLong csLock = new PaddedAtomicLong ( 0L ) ; \n - if ( Integer . bitCount ( bufferSize ) ! = 1 ) \n - { \n - throw new IllegalArgumentException ( "" bufferSize must be a power of 2 "" ) ; \n - } \n - \n - indexMask = bufferSize - 1 ; \n - pendingPublications = new AtomicLongArray ( bufferSize ) ; \n - for ( int i = 0 , size = pendingPublications . length ( ) ; i < size ; i + + ) \n - { \n - pendingPublications . lazySet ( i , Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n - } \n - if ( expectedSequence = = cursor . get ( ) ) \n - { \n - cursor . set ( sequence ) ; \n - if ( sequence = = claimSequence . get ( ) ) \n - { \n - return ; \n - } \n - } \n - else \n + while ( expectedSequence ! = cursor . get ( ) ) \n - for ( long i = expectedSequence + 1 ; i < sequence ; i + + ) \n - { \n - pendingPublications . lazySet ( ( int ) i & indexMask , i ) ; \n - } \n - \n - pendingPublications . set ( ( int ) sequence & indexMask , sequence ) ; \n + / / busy spin \n - if ( csLock . compareAndSet ( 0L , 1L ) ) \n - { \n - long initialCursor = cursor . get ( ) ; \n - long currentCursor = initialCursor ; \n - \n - while ( currentCursor < claimSequence . get ( ) ) \n - { \n - long nextSequence = currentCursor + 1L ; \n - if ( nextSequence ! = pendingPublications . get ( ( int ) nextSequence & indexMask ) ) \n - { \n - break ; \n - } \n - \n - currentCursor = nextSequence ; \n - } \n - \n - if ( currentCursor > initialCursor ) \n - { \n - cursor . set ( currentCursor ) ; \n - } \n - \n - csLock . set ( 0L ) ; \n - } \n + cursor . set ( sequence ) ; \n - LockSupport . parkNanos ( 1000L ) ; \n + LockSupport . parkNanos ( 1L ) ; \n - LockSupport . parkNanos ( 1000L ) ; \n + LockSupport . parkNanos ( 1L ) ; \n - LockSupport . parkNanos ( 1000L ) ; \n + LockSupport . parkNanos ( 1L ) ; \n",Revert multi - threaded claim strategy because of race conditions on Apple Macs,322
"code \ src \ main \ com \ lmax \ disruptor \ Sequence . java \n - import com . lmax . disruptor . util . PaddedAtomicLong ; \n + import java . util . concurrent . atomic . AtomicLongFieldUpdater ; \n - private final PaddedAtomicLong value = new PaddedAtomicLong ( Sequencer . INITIAL _ CURSOR _ VALUE ) ; \n + private static final AtomicLongFieldUpdater < Sequence > updater = AtomicLongFieldUpdater . newUpdater ( Sequence . class , "" value "" ) ; \n + \n + private volatile long p1 = 7L , p2 = 7L , p3 = 7L , p4 = 7L , p5 = 7L , p6 = 7L , p7 = 7L , \n + value = Sequencer . INITIAL _ CURSOR _ VALUE , \n + q1 = 7L , q2 = 7L , q3 = 7L , q4 = 7L , q5 = 7L , q6 = 7L , q7 = 7L ; \n - return value . get ( ) ; \n + return value ; \n - this . value . lazySet ( value ) ; \n + updater . lazySet ( this , value ) ; \n - return Long . toString ( value . get ( ) ) ; \n + return Long . toString ( value ) ; \n + } \n + \n + / * * \n + * Here to help make sure false sharing prevention padding is not optimised away . \n + * \n + * @ return sum of padding . \n + * / \n + public long sumPaddingToPreventOptimisation ( ) \n + { \n + return p1 + p2 + p3 + p4 + p5 + p6 + p7 + value + q1 + q2 + q3 + q4 + q5 + q6 + q7 ; \n + } \n + \n + public void setPaddingValue ( final long value ) \n + { \n + p1 = p2 = p3 = p4 = p5 = p6 = p7 = q1 = q2 = q3 = q4 = q5 = q6 = q7 = value ; \n",Removed a layer of indirection for the sequence value .,322
"code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - return new ConsumerTrackingConsumerBarrier < T > ( consumersToTrack ) ; \n + return new ConsumerTrackingConsumerBarrier ( consumersToTrack ) ; \n - final class ConsumerTrackingConsumerBarrier < T extends AbstractEntry > implements ConsumerBarrier < T > \n + private final class ConsumerTrackingConsumerBarrier implements ConsumerBarrier < T > \n - public long p1 , p2 , p3 , p4 , p5 , p6 , p7 ; / / cache line padding \n - private final Consumer [ ] consumers ; \n - public long p8 , p9 , p10 , p11 , p12 , p13 , p14 ; / / cache line padding \n + private final Consumer [ ] consumers ; \n",Syntax cleanup and removal of unnecessary cache line padding .,322
code \ src \ main \ com \ lmax \ disruptor \ RingBuffer . java \n - claimStrategy . setSequence ( sequence + 1L ) ; \n + claimStrategy . setSequence ( sequence ) ; \n,"Set sequence , cursor and claim strategy to be the same value in ForceFillProducerBarrier .",322
code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n - private final Sequence sequence = new Sequence ( RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n + private volatile boolean running = true ; \n + private ExceptionHandler exceptionHandler = new FatalExceptionHandler ( ) ; \n - private ExceptionHandler exceptionHandler = new FatalExceptionHandler ( ) ; \n - private volatile boolean running = true ; \n + private final Sequence sequence = new Sequence ( RingBuffer . INITIAL _ CURSOR _ VALUE ) ; \n - while ( running ) \n + while ( true ) \n - / / Wake up from blocking wait and check if we should continue to run \n + if ( ! running ) \n + { \n + break ; \n + } \n,Don ' t read running flag unless alerted because it is an unnecessary read memory barrier in a tight loop .,322
"code \ src \ test \ com \ lmax \ disruptor \ DependencyBarrierTest . java \n + import java . util . concurrent . CountDownLatch ; \n + import java . util . concurrent . TimeUnit ; \n + \n - final Sequence sequence1 = new Sequence ( 8L ) ; \n - final Sequence sequence2 = new Sequence ( 8L ) ; \n - final Sequence sequence3 = new Sequence ( 8L ) ; \n + final CountDownLatch latch = new CountDownLatch ( 3 ) ; \n + final Sequence sequence1 = new CountDownLatchSequence ( 8L , latch ) ; \n + final Sequence sequence2 = new CountDownLatchSequence ( 8L , latch ) ; \n + final Sequence sequence3 = new CountDownLatchSequence ( 8L , latch ) ; \n - Thread . sleep ( 1000L ) ; \n + latch . await ( 3 , TimeUnit . SECONDS ) ; \n + \n + private final static class CountDownLatchSequence extends Sequence \n + { \n + private final CountDownLatch latch ; \n + \n + private CountDownLatchSequence ( final long initialValue , final CountDownLatch latch ) \n + { \n + super ( initialValue ) ; \n + this . latch = latch ; \n + } \n + \n + @ Override \n + public long get ( ) \n + { \n + latch . countDown ( ) ; \n + return super . get ( ) ; \n + } \n + } \n",Use latch rather than sleep for test .,322
"code \ src \ main \ com \ lmax \ disruptor \ Sequencer . java \n - * number of the slot if there is at least < code > availableCapacity < / code > slots \n + * number of the slot if there is at least < code > requiredCapacity < / code > slots \n - * @ param availableCapacity \n + * @ param requiredCapacity as slots in the data structure \n - * @ throws InsufficientCapacityException \n + * @ throws InsufficientCapacityException when the requiredCapacity is not available \n - public long tryNext ( int availableCapacity ) throws InsufficientCapacityException \n + public long tryNext ( int requiredCapacity ) throws InsufficientCapacityException \n - if ( availableCapacity < 1 ) \n + if ( requiredCapacity < 1 ) \n - throw new IllegalArgumentException ( "" Available capacity must be greater than 0 "" ) ; \n + throw new IllegalArgumentException ( "" Required capacity must be greater than 0 "" ) ; \n - return claimStrategy . checkAndIncrement ( availableCapacity , 1 , gatingSequences ) ; \n + return claimStrategy . checkAndIncrement ( requiredCapacity , 1 , gatingSequences ) ; \n",Rename of availableCapacity to requiredCapacity to reflect that the parameter is a statement of what is required .,322
"code \ build . xml \n + < compilerarg value = "" - XDignore . symbol . file "" / > \n + < arg value = "" - XDignore . symbol . file "" / > \n",Suppressed warning messages for use of com . misc . Unsafe,322
code \ src \ main \ com \ lmax \ disruptor \ BatchEventProcessor . java \n - sequence . set ( nextSequence - 1L ) ; \n + sequence . set ( availableSequence ) ; \n,Small optimisation to writing off the progress sequence .,322
build . gradle \n - apply plugin : ' java ' \n - apply plugin : ' eclipse ' \n - apply plugin : ' idea ' \n - sourceCompatibility = JavaVersion . VERSION _ 1 _ 6 \n - targetCompatibility = JavaVersion . VERSION _ 1 _ 6 \n - \n - eclipse { \n - classpath { \n - / / include ' provided ' dependencies on the classpath \n - plusConfigurations + = configurations . provided \n - \n - downloadSources = true \n - downloadJavadoc = true \n - } \n - } \n - \n - idea { \n - module { \n - / / include ' provided ' dependencies on the classpath \n - scopes . PROVIDED . plus + = configurations . provided \n - } \n - } \n - \n,Cleaning up rxjava - android build . gradle,328
"hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ HystrixCommand . java \n - logger . warn ( "" ExecutionHook . endRunFailure returned an exception that was not an instance of HystrixBadRequestException so will be ignored . "" , decorated ) ; \n + logger . warn ( "" ExecutionHook . onRunError returned an exception that was not an instance of HystrixBadRequestException so will be ignored . "" , decorated ) ; \n - throw e ; \n - logger . warn ( "" Error calling ExecutionHook . endRunFailure "" , hookException ) ; \n + logger . warn ( "" Error calling ExecutionHook . onRunError "" , hookException ) ; \n",Bugfix to HystrixBadRequestException handling - logs were spuriously getting generated when HystrixBadRequestExceptions got thrown,328
rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorMaterialize . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorMergeDelayError . java \n + import rx . plugins . RxJavaPlugins ; \n + \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n + \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorOnErrorFlatMap . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorOnErrorResumeNextViaFunction . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorOnErrorResumeNextViaObservable . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorOnErrorReturn . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorOnExceptionResumeNextViaObservable . java \n + import rx . plugins . RxJavaPlugins ; \n + RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n,"Hooked RxJavaPlugins errorHandler up within all operators that swallow onErrors . \n * Otherwise , the only onErrors visible to plugin are the ones which propagate all the way to SafeSubscriber .",328
rxjava - core \ src \ main \ java \ rx \ internal \ operators \ OperatorMergeDelayError . java \n - import rx . plugins . RxJavaPlugins ; \n - RxJavaPlugins . getInstance ( ) . getErrorHandler ( ) . handleError ( e ) ; \n,Remove call to RxJavaPlugins ErrorHander in mergeDelayError operator - CompositeException is already visible,328
hystrix - contrib \ hystrix - network - auditor - agent \ build . gradle \n - compile ' org . javassist : javassist : 3 . 16 . 1 - GA ' \n + compile ' org . javassist : javassist : 3 . 18 . 1 - GA ' \n,Update Javassist version to 3 . 18 . 1 - GA,328
rxjava - core \ src \ main \ java \ rx \ operators \ OnSubscribeToObservableFuture . java \n + / / don ' t block or propagate CancellationException if already unsubscribed \n + if ( subscriber . isUnsubscribed ( ) ) { \n + return ; \n + } \n + if ( subscriber . isUnsubscribed ( ) ) { \n + / / refuse to emit onError if already unsubscribed \n + return ; \n + } \n,Modify OnSubscribeToObservableFuture to return early if unsubscribe without emitting anything,328
"rxjava - core \ src \ test \ java \ rx \ internal \ operators \ OperatorReduceTest . java \n + import static org . junit . Assert . assertEquals ; \n + @ Test ( timeout = 13000 ) \n + public void testBackpressure ( ) throws InterruptedException { \n + Observable < Integer > source = Observable . from ( 1 , 2 , 3 , 4 , 5 , 6 ) ; \n + Observable < Integer > reduced = source . reduce ( new Func2 < Integer , Integer , Integer > ( ) { \n + @ Override \n + public Integer call ( Integer i1 , Integer i2 ) { \n + return i1 + i2 ; \n + } \n + } ) ; \n + \n + Integer r = reduced . toBlocking ( ) . first ( ) ; \n + assertEquals ( 21 , r . intValue ( ) ) ; \n + } \n + \n","Failing unit test for reduce , showing it does not implement backpressure correctly",328
"rxjava - core \ src \ test \ java \ rx \ internal \ operators \ OperatorReduceTest . java \n - @ Test ( timeout = 13000 ) \n - public void testBackpressure ( ) throws InterruptedException { \n + @ Test \n + public void testBackpressureWithNoInitialValue ( ) throws InterruptedException { \n - Observable < Integer > reduced = source . reduce ( new Func2 < Integer , Integer , Integer > ( ) { \n - @ Override \n - public Integer call ( Integer i1 , Integer i2 ) { \n - return i1 + i2 ; \n - } \n - } ) ; \n + Observable < Integer > reduced = source . reduce ( sum ) ; \n + \n + Integer r = reduced . toBlocking ( ) . first ( ) ; \n + assertEquals ( 21 , r . intValue ( ) ) ; \n + } \n + \n + @ Test \n + public void testBackpressureWithInitialValue ( ) throws InterruptedException { \n + Observable < Integer > source = Observable . from ( 1 , 2 , 3 , 4 , 5 , 6 ) ; \n + Observable < Integer > reduced = source . reduce ( 0 , sum ) ; \n + \n + \n",Added another unit test to OperatorReduce / backpressure,328
"README . md \n - \n + [ ! [ Average time to resolve an issue ] ( http : / / isitmaintained . com / badge / resolution / Netflix / Hystrix . svg ) ] ( http : / / isitmaintained . com / project / Netflix / Hystrix "" Average time to resolve an issue "" ) \n + [ ! [ Percentage of issues still open ] ( http : / / isitmaintained . com / badge / open / Netflix / Hystrix . svg ) ] ( http : / / isitmaintained . com / project / Netflix / Hystrix "" Percentage of issues still open "" ) \n",Add badges from isitmaintained . com \n Good pointer from @ NiteshKant,328
"README . md \n - [ ! [ Average time to resolve an issue ] ( http : / / isitmaintained . com / badge / resolution / Netflix / Hystrix . svg ) ] ( http : / / isitmaintained . com / project / Netflix / Hystrix "" Average time to resolve an issue "" ) \n - [ ! [ Percentage of issues still open ] ( http : / / isitmaintained . com / badge / open / Netflix / Hystrix . svg ) ] ( http : / / isitmaintained . com / project / Netflix / Hystrix "" Percentage of issues still open "" ) \n",Removed badges from isitmaintained . com . \n These don ' t seem to update,328
"CHANGELOG . md \n + # # # Version 1 . 5 . 5 ( [ Maven Central ] ( http : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22com . netflix . hystrix % 22 % 20AND % 20v % 3A % 221 . 5 . 5 % 22 ) , [ Bintray ] ( https : / / bintray . com / netflixoss / maven / Hystrix / 1 . 5 . 5 / ) ) # # # \n + \n + * [ Pull 1323 ] ( https : / / github . com / Netflix / Hystrix / pull / 1323 ) Remove ReactiveSocket modules and change Jenkins release process back to JDK7 \n + \n",Update CHANGELOG with v1 . 5 . 5,328
"CHANGELOG . md \n + # # # Version 1 . 5 . 8 ( [ Maven Central ] ( http : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22com . netflix . hystrix % 22 % 20AND % 20v % 3A % 221 . 5 . 8 % 22 ) , [ Bintray ] ( https : / / bintray . com / netflixoss / maven / Hystrix / 1 . 5 . 8 / ) ) # # # \n + \n + * [ Pull 1419 ] ( https : / / github . com / Netflix / Hystrix / pull / 1419 ) When user has not opted in to letting core / maximum threadpools diverge , ensure dynamic updates to coreSize apply to both \n + * [ Pull 1415 ] ( https : / / github . com / Netflix / Hystrix / pull / 1415 ) Fix spelling mistake in comments . Thanks @ starlight36 ! \n + \n",Add v1 . 5 . 8 to CHANGELOG,328
"CHANGELOG . md \n + # # # Version 1 . 4 . 26 ( [ Maven Central ] ( http : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22com . netflix . hystrix % 22 % 20AND % 20v % 3A % 221 . 4 . 26 % 22 ) , [ Bintray ] ( https : / / bintray . com / netflixoss / maven / Hystrix / 1 . 4 . 26 / ) ) # # # \n + \n + * [ Pull 1169 ] ( https : / / github . com / Netflix / Hystrix / pull / 1169 ) Javanica : Switch hystrix - javanica to use getExecutionException , which returns Exception object even when command is not executed \n + \n",Add v1 . 4 . 26 to CHANGELOG . md,328
hystrix - examples - webapp \ README . md \n - $ . . / gradlew jettyRun \n - > Building > : hystrix - examples - webapp : jettyRun > Running at http : / / localhost : 8989 / hystrix - examples - webapp \n + $ . . / gradlew appRun \n + > Building > : hystrix - examples - webapp : appRun > Running at http : / / localhost : 8989 / hystrix - examples - webapp \n hystrix - examples - webapp \ build . gradle \n - apply plugin : ' jetty ' \n + apply from : ' https : / / raw . github . com / akhikhl / gretty / master / pluginScripts / gretty . plugin ' \n - jettyRun { \n + gretty { \n + servletContainer = ' jetty9 ' \n,Use Gretty for running hystrix - examples - webapp,328
"hystrix - contrib \ hystrix - metrics - event - stream \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ sample \ stream \ HystrixSampleSseServlet . java \n + / / in case stream has not started emitting yet , catch any clients which connect / disconnect before emits start \n + writer . print ( "" ping : \ n \ n "" ) ; \n + / / explicitly check for client disconnect - PrintWriter does not throw exceptions \n + if ( writer . checkError ( ) ) { \n + throw new IOException ( "" io error "" ) ; \n + } \n + writer . flush ( ) ; \n + } catch ( IOException ioe ) { \n + moreDataWillBeSent . set ( false ) ; \n",Fix # 1430 by detecting case when client connect / disconnects before metrics start getting emitted,328
hystrix - dashboard \ build . gradle \n - apply plugin : ' jetty ' \n + apply from : ' https : / / raw . github . com / akhikhl / gretty / master / pluginScripts / gretty . plugin ' \n - jettyRun { \n - httpPort = 7979 \n + gretty { \n + httpPort = 7979 \n + servletContainer = ' jetty9 ' \n,Switch hystrix - dashboard from using Jetty plugin to Gretty,328
hystrix - dashboard \ README . md \n - $ . . / gradlew jettyRun \n - > Building > : hystrix - dashboard : jettyRun > Running at http : / / localhost : 7979 / hystrix - dashboard \n + $ . . / gradlew appRun \n + > Building > : hystrix - dashboard : appRun > Running at http : / / localhost : 7979 / hystrix - dashboard \n,Change hystrix - dashboard README to refer to gretty : appRun instead of jetty : jettyRun,328
"hystrix - contrib \ hystrix - metrics - event - stream \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ sample \ stream \ HystrixSampleSseServlet . java \n - try { \n - writer . print ( "" data : "" + sampleDataAsString + "" \ n \ n "" ) ; \n - / / explicitly check for client disconnect - PrintWriter does not throw exceptions \n - if ( writer . checkError ( ) ) { \n - throw new IOException ( "" io error "" ) ; \n - } \n - writer . flush ( ) ; \n - } catch ( IOException ioe ) { \n + writer . print ( "" data : "" + sampleDataAsString + "" \ n \ n "" ) ; \n + / / explicitly check for client disconnect - PrintWriter does not throw exceptions \n + if ( writer . checkError ( ) ) { \n + writer . flush ( ) ; \n - throw new IOException ( "" io error "" ) ; \n + moreDataWillBeSent . set ( false ) ; \n - } catch ( IOException ioe ) { \n - moreDataWillBeSent . set ( false ) ; \n + System . out . println ( "" Exiting the server thread , current count = "" + getNumberCurrentConnections ( ) ) ; \n",Cleaner implementation of server detecting client disconnection in sampling stream,328
"hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ AbstractCommand . java \n + try { \n + executionHook . onUnsubscribe ( _ cmd ) ; \n + } catch ( Throwable hookEx ) { \n + logger . warn ( "" Error calling HystrixCommandExecutionHook . onUnsubscribe "" , hookEx ) ; \n + } \n + try { \n + executionHook . onUnsubscribe ( _ cmd ) ; \n + } catch ( Throwable hookEx ) { \n + logger . warn ( "" Error calling HystrixCommandExecutionHook . onUnsubscribe "" , hookEx ) ; \n + } \n + @ Override \n + public < T > void onUnsubscribe ( HystrixInvokable < T > commandInstance ) { \n + actual . onUnsubscribe ( commandInstance ) ; \n + } \n + \n hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ strategy \ executionhook \ HystrixCommandExecutionHook . java \n + / * * \n + * Invoked with the command is unsubscribed before a terminal state \n + * \n + * @ param commandInstance The executing HystrixInvokable instance . \n + * \n + * @ since 1 . 5 . 9 \n + * / \n + public < T > void onUnsubscribe ( HystrixInvokable < T > commandInstance ) { \n + / / do nothing by default \n + } \n + \n hystrix - core \ src \ test \ java \ com \ netflix \ hystrix \ TestableExecutionHook . java \n + @ Override \n + public < T > void onUnsubscribe ( HystrixInvokable < T > commandInstance ) { \n + super . onUnsubscribe ( commandInstance ) ; \n + recordHookCall ( executionSequence , "" onUnsubscribe "" ) ; \n + } \n + \n - * DEPRECATED METHODS FOLLOW . The string representation starts with ` ! D ! ` to distinguish \n + * DEPRECATED METHODS FOLLOW . The string representation starts with ` ! ` to distinguish \n",Add ` onUnsubscribe ` hook to command execution and wire in to command flow,328
hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ HystrixThreadPoolProperties . java \n - if ( allowMaximumSizeToDivergeFromCoreSize . get ( ) ) { \n + if ( getAllowMaximumSizeToDivergeFromCoreSize ( ) . get ( ) ) { \n,Use method call instead of value reference so that HystrixThreadPoolProperties may be overridden,328
"hystrix - contrib \ hystrix - metrics - event - stream \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ sample \ stream \ HystrixSampleSseServlet . java \n - writer . print ( "" data : "" + sampleDataAsString + "" \ n \ n "" ) ; \n - / / explicitly check for client disconnect - PrintWriter does not throw exceptions \n - if ( writer . checkError ( ) ) { \n + try { \n + writer . print ( "" data : "" + sampleDataAsString + "" \ n \ n "" ) ; \n + / / explicitly check for client disconnect - PrintWriter does not throw exceptions \n + if ( writer . checkError ( ) ) { \n + moreDataWillBeSent . set ( false ) ; \n + } \n + writer . flush ( ) ; \n + } catch ( Throwable t ) { \n - writer . flush ( ) ; \n - } catch ( InterruptedException e ) { \n + } catch ( Throwable t ) { \n",Add exception - handling to interactions with servlet writers,328
hystrix - contrib \ hystrix - metrics - event - stream \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ sample \ stream \ HystrixSampleSseServlet . java \n - } catch ( Throwable t ) { \n + } catch ( Exception ex ) { \n - } catch ( Throwable t ) { \n + } catch ( Exception ex ) { \n,Switch servlet exception handling from Throwable to Exception,328
hystrix - contrib \ hystrix - servo - metrics - publisher \ build . gradle \n - compileApi ' com . netflix . servo : servo - core : 0 . 7 . 5 ' \n + compileApi ' com . netflix . servo : servo - core : 0 . 10 . 1 ' \n,Upgrade servo from 0 . 7 . 5 to 0 . 10 . 1,328
"hystrix - contrib \ hystrix - javanica \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ javanica \ conf \ HystrixPropertiesManager . java \n + public static final String ALLOW _ MAXIMUM _ SIZE _ TO _ DIVERGE _ FROM _ CORE _ SIZE = "" allowMaximumSizeToDivergeFromCoreSize "" ; \n + . put ( ALLOW _ MAXIMUM _ SIZE _ TO _ DIVERGE _ FROM _ CORE _ SIZE , new PropSetter < HystrixThreadPoolProperties . Setter , String > ( ) { \n + @ Override \n + public void set ( HystrixThreadPoolProperties . Setter setter , String value ) throws IllegalArgumentException { \n + setter . withAllowMaximumSizeToDivergeFromCoreSize ( toBoolean ( value ) ) ; \n + } \n + } ) \n hystrix - contrib \ hystrix - javanica \ src \ test \ java \ com \ netflix \ hystrix \ contrib \ javanica \ test \ common \ configuration \ command \ BasicCommandPropertiesTest . java \n - assertEquals ( 25 , ( int ) properties . maximumSize ( ) . get ( ) ) ; \n + assertEquals ( 35 , ( int ) properties . maximumSize ( ) . get ( ) ) ; \n + assertEquals ( true , properties . getAllowMaximumSizeToDivergeFromCoreSize ( ) . get ( ) ) ; \n - @ HystrixProperty ( name = "" maximumSize "" , value = "" 25 "" ) , \n + @ HystrixProperty ( name = "" maximumSize "" , value = "" 35 "" ) , \n + @ HystrixProperty ( name = "" allowMaximumSizeToDivergeFromCoreSize "" , value = "" true "" ) , \n",Added Javanica support for setting allowMaximumSizeToDivergeFromCoreSize in annotation,328
hystrix - contrib \ hystrix - codahale - metrics - publisher \ src \ main \ java \ com \ netflix \ hystrix \ contrib \ codahalemetricspublisher \ HystrixCodaHaleMetricsPublisherThreadPool . java \n - return properties . maximumSize ( ) . get ( ) ; \n + return properties . actualMaximumSize ( ) ; \n,Fix incorrect return value in CodaHale metrics publisher of threadpool config,328
"CHANGELOG . md \n + # # # Version 1 . 5 . 10 ( [ Maven Central ] ( http : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22com . netflix . hystrix % 22 % 20AND % 20v % 3A % 221 . 5 . 10 % 22 ) , [ Bintray ] ( https : / / bintray . com / netflixoss / maven / Hystrix / 1 . 5 . 10 / ) ) # # # \n + \n + - [ Pull 1489 ] ( https : / / github . com / Netflix / Hystrix / pull / 1489 ) Added rollingMaxConcurrentExecutionCount to CodaHale metrics publisher . Thanks @ LuboVarga ! \n + - [ Pull 1481 ] ( https : / / github . com / Netflix / Hystrix / pull / 1481 ) Add sanity checking to HystrixCommandAspect to debug unreproducible cases . Thanks @ dmgcodevil ! \n + - [ Pull 1482 ] ( https : / / github . com / Netflix / Hystrix / pull / 1482 ) Make it possible to re - use fallback methods in Javanica . ( Addresses # 1446 ) . Thanks @ dmgcodevil ! \n + - [ Pull 1488 ] ( https : / / github . com / Netflix / Hystrix / pull / 1488 ) Fix spelling mistakes in Javanica docs . Thanks @ bltb ! \n + - [ Pull 1475 ] ( https : / / github . com / Netflix / Hystrix / pull / 1475 ) Added example usage of CodaHale metrics publisher . Thanks @ LuboVarga ! \n + - [ Pull 1469 ] ( https : / / github . com / Netflix / Hystrix / pull / 1469 ) Fix possible concurrency bug . Thanks @ petercla ! \n + - [ Pull 1453 ] ( https : / / github . com / Netflix / Hystrix / pull / 1453 ) Add Javanica unit test for NotWrapped checked exception . Thanks @ tbvh ! \n + \n",Add v1 . 5 . 10 to CHANGELOG,328
"hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ AbstractCommand . java \n - / * \n - * Define the action to perform on timeout outside of the TimerListener to it can capture the HystrixRequestContext \n - * of the calling thread which doesn ' t exist on the Timer thread . \n - * / \n - final HystrixContextRunnable timeoutRunnable = new HystrixContextRunnable ( originalCommand . concurrencyStrategy , new Runnable ( ) { \n - \n - @ Override \n - public void run ( ) { \n - child . onError ( new HystrixTimeoutException ( ) ) ; \n - } \n - } ) ; \n + / / capture the HystrixRequestContext upfront so that we can use it in the timeout thread later \n + final HystrixRequestContext hystrixRequestContext = HystrixRequestContext . getContextForCurrentThread ( ) ; \n + final HystrixContextRunnable timeoutRunnable = new HystrixContextRunnable ( originalCommand . concurrencyStrategy , hystrixRequestContext , new Runnable ( ) { \n + \n + @ Override \n + public void run ( ) { \n + child . onError ( new HystrixTimeoutException ( ) ) ; \n + } \n + } ) ; \n + \n + \n hystrix - core \ src \ main \ java \ com \ netflix \ hystrix \ strategy \ concurrency \ HystrixContextRunnable . java \n + this ( concurrencyStrategy , HystrixRequestContext . getContextForCurrentThread ( ) , actual ) ; \n + } \n + \n + public HystrixContextRunnable ( final HystrixConcurrencyStrategy concurrencyStrategy , final HystrixRequestContext hystrixRequestContext , final Runnable actual ) { \n - this . parentThreadState = HystrixRequestContext . getContextForCurrentThread ( ) ; \n + this . parentThreadState = hystrixRequestContext ; \n",Only create the HystrixContextRunnable for running the timeout fallback when the timeout actually occurs ( not eagerly ),328
"CHANGELOG . md \n + # # # Version 1 . 5 . 13 ( [ Maven Central ] ( http : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22com . netflix . hystrix % 22 % 20AND % 20v % 3A % 221 . 5 . 13 % 22 ) , [ Bintray ] ( https : / / bintray . com / netflixoss / maven / Hystrix / 1 . 5 . 13 / ) ) # # # \n + \n + - [ Pull 1621 ] ( https : / / github . com / Netflix / Hystrix / pull / 1621 ) Fixed bug where an unsubscription of a command in half - open state leaves circuit permanently open \n + - [ Pull 1605 ] ( https : / / github . com / Netflix / Hystrix / pull / 1605 ) Change return value on unsubscribe to Observable . empty ( ) . Thanks @ atoulme ! \n + - [ Pull 1615 ] ( https : / / github . com / Netflix / Hystrix / pull / 1615 ) Updated Gradle to version 4 . 0 . Thanks @ wlsc ! \n + - [ Pull 1616 ] ( https : / / github . com / Netflix / Hystrix / pull / 1616 ) Javanica : Wrong hystrix event type for fallback missing . Thanks @ dmgcodevil ! \n + - [ Pull 1606 ] ( https : / / github . com / Netflix / Hystrix / pull / 1606 ) Escape user entered input to avoid HTML injection . This fixes # 1456 . Thanks @ atoulme ! \n + - [ Pull 1595 ] ( https : / / github . com / Netflix / Hystrix / pull / 1595 ) Possibility to add custom root node for command and thread pool metrics . Thanks @ dstoklosa ! \n + - [ Pull 1587 ] ( https : / / github . com / Netflix / Hystrix / pull / 1587 ) Throw IllegalStateException if request cache is not available when clearing . Thanks @ jack - kerouac ! \n + \n - [ Pull 1586 ] ( https : / / github . com / Netflix / Hystrix / pull / 1586 ) Start streams for CodaHale metric consumer , ot get it actually working \n",Add v1 . 5 . 13 to CHANGELOG,328
"build . xml \n - < < < < < < < HEAD \n - = = = = = = = \n - < property name = "" version - base "" value = "" 4 . 10 "" / > \n - < property name = "" version - status "" value = "" "" / > \n - > > > > > > > 4 . 10 \n",Fix for # 333 build . xml is broken after merge,330
"build . xml \n - < exec executable = "" build / Markdown . pl "" failonerror = "" true "" > \n + < exec executable = "" perl "" failonerror = "" true "" > \n + < arg file = "" build / Markdown . pl "" / > \n",fix for # 49 Master now builds on windows .,330
"src \ main \ java \ org \ junit \ rules \ MethodRule . java \n + * \n + * Note that { @ link MethodRule } is now deprecated , you should be using { @ link TestRule } instead . \n src \ main \ java \ org \ junit \ rules \ TestWatcher . java \n - * public MethodRule watchman = new TestWatcher ( ) { \n + * public TestRule watchman = new TestWatcher ( ) { \n src \ main \ java \ org \ junit \ rules \ Timeout . java \n - * public MethodRule globalTimeout = new Timeout ( 20 ) ; \n + * public TestRule globalTimeout = new Timeout ( 20 ) ; \n src \ main \ java \ org \ junit \ rules \ Verifier . java \n - * public MethodRule verifier = new Verifier ( ) { \n + * public TestRule verifier = new Verifier ( ) { \n",Several javadoc referred to MethodRule when they should have referred to TestRule,330
"src \ main \ java \ org \ junit \ rules \ TestWatcher . java \n - * protected void failed ( Description d ) { \n - * watchedLog + = d + & quot ; \ n & quot ; ; \n + * protected void failed ( Throwable e , Description description ) { \n + * watchedLog + = description + & quot ; \ n & quot ; ; \n - * protected void succeeded ( Description d ) { \n - * watchedLog + = d + & quot ; & quot ; + & quot ; success ! \ n & quot ; ; \n + * protected void succeeded ( Description description ) { \n + * watchedLog + = description + & quot ; & quot ; + & quot ; success ! \ n & quot ; ; \n",TestWatcher javadoc was not correct for example method names,330
src \ main \ java \ org \ junit \ rules \ RuleChain . java \n - * public TestRule chain = RuleChain \n + * public RuleChain chain = RuleChain \n src \ main \ java \ org \ junit \ rules \ TestWatcher . java \n - * public TestRule watchman = new TestWatcher ( ) { \n + * public TestWatcher watchman = new TestWatcher ( ) { \n src \ main \ java \ org \ junit \ rules \ Timeout . java \n - * public TestRule globalTimeout = new Timeout ( 20 ) ; \n + * public Timeout globalTimeout = new Timeout ( 20 ) ; \n src \ main \ java \ org \ junit \ rules \ Verifier . java \n - * public TestRule verifier = new Verifier ( ) { \n + * public Verifier verifier = new Verifier ( ) { \n,"Fixes # 427 inconsistent javadoc for test rules \n The examples for some test rules used \n public TestRule chain = RuleChain . . . \n whereas others did not refer to TestRule , they used the class name . \n Changed all of those who refered to TestRule to use the class name .",330
src \ main \ java \ org \ junit \ rules \ Verifier . java \n - public class Verifier implements TestRule { \n + public abstract class Verifier implements TestRule { \n,Fixes # 51 Verifier is abstract to indicate that it should be extended,330
"src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - folder = createTemporaryFolderIn ( parentFolder ) ; \n + folder = createTemporaryFolderIn ( parentFolder ) ; \n + public File newFolder ( String folder ) { \n + return newFolder ( new String [ ] { folder } ) ; \n + } \n + \n + / * * \n + * Returns a new fresh folder with the given name ( s ) under the temporary \n + * folder . \n + * / \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ TempFolderRuleTest . java \n + import java . lang . reflect . Method ; \n - public void testUsingTempFolder ( ) throws IOException { \n + public void testUsingTempFolderStringReflection ( ) throws Exception { \n + / / force usage of folder . newFolder ( String ) , \n + / / check is available and works , to avoid a potential NoSuchMethodError with non - recompiled code . \n + Method method = folder . getClass ( ) . getMethod ( "" newFolder "" , new Class < ? > [ ] { String . class } ) ; \n + createdFiles [ 0 ] = ( File ) method . invoke ( folder , subfolder ) ; \n + new File ( createdFiles [ 0 ] , filename ) . createNewFile ( ) ; \n + \n + File expectedFile = new File ( folder . getRoot ( ) , join ( subfolder , filename ) ) ; \n + \n + assertTrue ( expectedFile . exists ( ) ) ; \n + } \n + \n + @ Test \n + public void testUsingTempFolderString ( ) throws IOException { \n + String subfolder = "" subfolder "" ; \n + String filename = "" a . txt "" ; \n + / / this uses newFolder ( String ) , ensure that a single String works \n - \n + \n - \n + \n",Fixes # 441 fix for issue 283 ( recursive temp folders ) caused incompatibility \n Put back in the method folder . newFolder ( String ) that \n was removed in # 283 . Tests that the method is there using \n reflection .,330
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * & # 064 ; Parameters ( name = & quot ; { index } : fib ( { 0 } ) = { 1 } & quot ; ) \n - * public static Iterable & lt ; Object [ ] & gt ; data ( ) { \n - * return Arrays . asList ( new Object [ ] [ ] { { 0 , 0 } , { 1 , 1 } , { 2 , 1 } , \n + * & # 064 ; Parameters ( name = & quot ; { index } : fib [ { 0 } ] = { 1 } & quot ; ) \n + * public static Iterable & lt ; Object [ ] & gt ; data ( ) { \n + * return Arrays . asList ( new Object [ ] [ ] { { 0 , 0 } , { 1 , 1 } , { 2 , 1 } , \n - * private int fInput ; \n + * private int fInput ; \n - * private int fExpected ; \n + * private int fExpected ; \n - * public FibonacciTest ( int input , int expected ) { \n - * fInput = input ; \n - * fExpected = expected ; \n + * public FibonacciTest ( int input , int expected ) { \n + * fInput = input ; \n + * fExpected = expected ; \n - * & # 064 ; Test \n - * public void test ( ) { \n - * assertEquals ( fExpected , Fibonacci . compute ( fInput ) ) ; \n + * & # 064 ; Test \n + * public void test ( ) { \n + * assertEquals ( fExpected , Fibonacci . compute ( fInput ) ) ; \n - * } \n + * } \n + * \n - * } \n + * } \n","Fixes # 553 , formatted sample code in javadoc",330
presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ CoordinatorModule . java \n + newExporter ( binder ) . export ( StatementResource . class ) . withGeneratedName ( ) ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ server \ protocol \ StatementResource . java \n + import io . airlift . stats . CounterStat ; \n + import org . weakref . jmx . Managed ; \n + import org . weakref . jmx . Nested ; \n + private final CounterStat createQueryRequests = new CounterStat ( ) ; \n + \n + createQueryRequests . update ( 1 ) ; \n + \n + \n + @ Managed \n + @ Nested \n + public CounterStat getCreateQueryRequests ( ) \n + { \n + return createQueryRequests ; \n + } \n,Add counter for POST requests to statement resource \n This counter makes it easier to monitor large spikes in the incoming query rate . \n This counter is incremented prior to potentially expensive operations in SqlQueryManager ( which has its own counters ) .,334
pom . xml \n + \n + < ! - - Always build a jar with the test classes - - > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - jar - plugin < / artifactId > \n + < configuration > \n + < ! - - do not build an empty jar if the project is \n + e . g . a pom project - - > \n + < skipIfEmpty > true < / skipIfEmpty > \n + < archive > \n + < manifest > \n + < addDefaultImplementationEntries > true < / addDefaultImplementationEntries > \n + < addDefaultSpecificationEntries > true < / addDefaultSpecificationEntries > \n + < addClasspath > false < / addClasspath > \n + < / manifest > \n + < manifestEntries > \n + < ! - - This is actually the time when the build was done - - > \n + < Build - Time > $ { git . build . time } < / Build - Time > \n + < Git - Commit - Id > $ { git . commit . id } < / Git - Commit - Id > \n + < Implementation - Version > $ { project . version } - $ { git . commit . id . abbrev } < / Implementation - Version > \n + < / manifestEntries > \n + < / archive > \n + < / configuration > \n + < / plugin > \n,"Change jar version to work with branch based release model \n The previous model involved using git - describe which broke as we \n moved to branch based releases since all of our tags are now on the \n release branches rather than master . \n Even before that , the versions generated used the previous version \n number of the release rather than the current maven version . \n Changed that to now use a combination of maven version and commit id .",334
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ AbstractTestHiveClient . java \n - return new TestingConnectorSession ( new HiveSessionProperties ( getHiveClientConfig ( ) , new OrcFileWriterConfig ( ) , new ParquetFileWriterConfig ( ) ) . getSessionProperties ( ) ) ; \n + return newSession ( new HiveSessionProperties ( getHiveClientConfig ( ) , new OrcFileWriterConfig ( ) , new ParquetFileWriterConfig ( ) ) ) ; \n + } \n + \n + protected ConnectorSession newSession ( HiveSessionProperties hiveSessionProperties ) \n + { \n + return new TestingConnectorSession ( hiveSessionProperties . getSessionProperties ( ) ) ; \n - HiveSessionProperties properties = new HiveSessionProperties ( \n + return newSession ( new HiveSessionProperties ( \n - new OrcFileWriterConfig ( ) , new ParquetFileWriterConfig ( ) ) ; \n - return new TestingConnectorSession ( properties . getSessionProperties ( ) ) ; \n + new OrcFileWriterConfig ( ) , \n + new ParquetFileWriterConfig ( ) ) ) ; \n",Allow custom hive session in ` AbstractTestHiveClient `,334
presto - jdbc \ pom . xml \n + < relocation > \n + < pattern > com . google . api < / pattern > \n + < shadedPattern > $ { shadeBase } . google . api < / shadedPattern > \n + < / relocation > \n + < relocation > \n + < pattern > com . google . auth < / pattern > \n + < shadedPattern > $ { shadeBase } . google . auth < / shadedPattern > \n + < / relocation > \n + < relocation > \n + < pattern > com . google . j2objc < / pattern > \n + < shadedPattern > $ { shadeBase } . j2objc < / shadedPattern > \n + < / relocation > \n + < relocation > \n + < pattern > org . apache . commons < / pattern > \n + < shadedPattern > $ { shadeBase } . apache . commons < / shadedPattern > \n + < / relocation > \n + < relocation > \n + < pattern > org . apache . http < / pattern > \n + < shadedPattern > $ { shadeBase } . apache . http < / shadedPattern > \n + < / relocation > \n + < relocation > \n + < pattern > org . apache . httpcomponents < / pattern > \n + < shadedPattern > $ { shadeBase } . apache . httpcomponents < / shadedPattern > \n + < / relocation > \n,Shade classes in presto - jdbc uber jar \n https : / / github . com / prestodb / presto / pull / 14585 introduced new dependencies that entered \n presto - jdbc uber jar . presto - jdbc shades out all dependencies other than the core jdbc \n classes itself and this PR does the same .,334
"presto - main \ src \ main \ java \ com \ facebook \ presto \ metadata \ MetadataManager . java \n - catalogMetadata . getMetadata ( ) . finishStatisticsCollection ( session . toConnectorSession ( ) , tableHandle . getConnectorHandle ( ) , computedStatistics ) ; \n + catalogMetadata . getMetadata ( ) . finishStatisticsCollection ( session . toConnectorSession ( connectorId ) , tableHandle . getConnectorHandle ( ) , computedStatistics ) ; \n","Fix finishStatisticsCollection to have correct ConnectorSession \n Without this fix , the ConnectionSession was created without any session properties and hence the implementation which tried to use session properties failed .",334
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ resourceGroups \ InternalResourceGroupManager . java \n - import java . util . concurrent . TimeUnit ; \n + import static java . lang . System . currentTimeMillis ; \n + import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n + private final AtomicLong lastSchedulingCycleRunTimeMs = new AtomicLong ( currentTimeMillis ( ) ) ; \n - refreshExecutor . scheduleWithFixedDelay ( this : : refreshAndStartQueries , 1 , 1 , TimeUnit . MILLISECONDS ) ; \n + refreshExecutor . scheduleWithFixedDelay ( ( ) - > { \n + try { \n + refreshAndStartQueries ( ) ; \n + lastSchedulingCycleRunTimeMs . getAndSet ( currentTimeMillis ( ) ) ; \n + } \n + catch ( Throwable t ) { \n + log . error ( t , "" Error while executing refreshAndStartQueries "" ) ; \n + throw t ; \n + } \n + } , 1 , 1 , MILLISECONDS ) ; \n + @ Managed \n + public long getLastSchedulingCycleRuntimeDelayMs ( ) \n + { \n + return currentTimeMillis ( ) - lastSchedulingCycleRunTimeMs . get ( ) ; \n + } \n + \n",Add additional logging to resource group scheduler \n This is needed for an ongoing debugging where in we are seeing queries \n getting stuck and not being moved from the queued state to the running \n state,334
presto - main \ src \ main \ java \ com \ facebook \ presto \ dispatcher \ LocalDispatchQuery . java \n - catch ( Exception ignored ) { \n + catch ( Throwable ignored ) { \n,Check for all Throwables while get query results \n There are situations where in ` AssertionError ` s are thrown in the code and that cannot be caught with ` Exception ` . Changing this to catch ` Throwable `,334
pom . xml \n - < dep . drift . version > 1 . 24 < / dep . drift . version > \n + < dep . drift . version > 1 . 25 < / dep . drift . version > \n,Upgrade drift to 1 . 25 \n 1 . 25 fixes an issue with recursive Optional structs,334
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ AbstractTestHiveClient . java \n - import static com . facebook . presto . hive . TestEncryptionInformationSource . createEncryptionInformation ; \n - encryptionInformationProvider = new HiveEncryptionInformationProvider ( ImmutableList . of ( new TestEncryptionInformationSource ( Optional . of ( createEncryptionInformation ( "" test1 "" ) ) ) ) ) ; \n + encryptionInformationProvider = new HiveEncryptionInformationProvider ( ImmutableList . of ( ) ) ; \n - @ Test \n + / / @ Test \n - @ Test \n + / / @ Test \n",Disable encryption tests temporarily \n The current tests provide an invalid encryption metadata which is causing failures \n as the actual reader code is being landed . Disable the tests for now to unbreak trunk,334
"presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ AbstractTestHiveClient . java \n + @ Test \n + public void testAddColumn ( ) \n + throws Exception \n + { \n + SchemaTableName tableName = temporaryTable ( "" test _ add _ column "" ) ; \n + try { \n + doCreateEmptyTable ( tableName , ORC , CREATE _ TABLE _ COLUMNS ) ; \n + ExtendedHiveMetastore metastoreClient = getMetastoreClient ( ) ; \n + metastoreClient . addColumn ( tableName . getSchemaName ( ) , tableName . getTableName ( ) , "" new _ col "" , HIVE _ LONG , null ) ; \n + Optional < Table > table = metastoreClient . getTable ( tableName . getSchemaName ( ) , tableName . getTableName ( ) ) ; \n + assertTrue ( table . isPresent ( ) ) ; \n + List < Column > columns = table . get ( ) . getDataColumns ( ) ; \n + assertEquals ( columns . get ( columns . size ( ) - 1 ) . getName ( ) , "" new _ col "" ) ; \n + } \n + finally { \n + dropTable ( tableName ) ; \n + } \n + } \n + \n + @ Test \n + public void testDropColumn ( ) \n + throws Exception \n + { \n + SchemaTableName tableName = temporaryTable ( "" test _ drop _ column "" ) ; \n + try { \n + doCreateEmptyTable ( tableName , ORC , CREATE _ TABLE _ COLUMNS ) ; \n + ExtendedHiveMetastore metastoreClient = getMetastoreClient ( ) ; \n + metastoreClient . dropColumn ( tableName . getSchemaName ( ) , tableName . getTableName ( ) , CREATE _ TABLE _ COLUMNS . get ( 0 ) . getName ( ) ) ; \n + Optional < Table > table = metastoreClient . getTable ( tableName . getSchemaName ( ) , tableName . getTableName ( ) ) ; \n + assertTrue ( table . isPresent ( ) ) ; \n + List < Column > columns = table . get ( ) . getDataColumns ( ) ; \n + assertEquals ( columns . get ( 0 ) . getName ( ) , CREATE _ TABLE _ COLUMNS . get ( 1 ) . getName ( ) ) ; \n + assertFalse ( columns . stream ( ) . map ( Column : : getName ) . anyMatch ( colName - > colName . equals ( CREATE _ TABLE _ COLUMNS . get ( 0 ) . getName ( ) ) ) ) ; \n + } \n + finally { \n + dropTable ( tableName ) ; \n + } \n + } \n + \n",Add a test for adding a new column,334
"presto - main \ src \ main \ java \ com \ facebook \ presto \ SystemSessionProperties . java \n - true , \n + featuresConfig . isPushdownSubfieldsEnabled ( ) , \n",Fix subfield pruning to be enabled by featureConfig,334
presto - tests \ src \ test \ java \ com \ facebook \ presto \ tests \ TestDistributedSpilledQueries . java \n + import org . testng . annotations . Test ; \n + @ Test ( timeOut = 4 * 60 * 1000 ) \n + @ Override \n + public void testJoinPredicatePushdown ( ) \n + { \n + super . testJoinPredicatePushdown ( ) ; \n + } \n + \n,Put time limit on ` TestDistributedSpillQueries # testJoinPredicatePushdown ` \n We are seeing this test get stuck multiple times and putting this limit \n will help it fail fast and help us investigate . The normal success runtimes \n for this test are less than 5 seconds - so this is way more buffer than \n needed,334
pull _ request _ template . md \n + Test plan - ( Please fill in how you tested your changes ) \n + \n,"Add "" Test plan "" field to PR template \n Based on the discussion in the TSC meeting of presto on 7 / 7 / 2020 , adding \n a new field called as Test plan to motivate contributors to think better \n about the testing method for their PRs and giving committers an \n opportunity to assess the same and recommend changes / suggestions to the \n same .",334
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ AbstractDwrfEncryptionInformationSource . java \n - fieldToKeyReference = ImmutableMap . of ( DwrfEncryptionMetadata . TABLE _ IDENTIFIER , encryptTable . get ( ) ) ; \n + if ( ! requestedColumns . isPresent ( ) | | ! requestedColumns . get ( ) . isEmpty ( ) ) { \n + fieldToKeyReference = ImmutableMap . of ( DwrfEncryptionMetadata . TABLE _ IDENTIFIER , encryptTable . get ( ) ) ; \n + } \n + else { \n + fieldToKeyReference = ImmutableMap . of ( ) ; \n + } \n presto - hive \ src \ test \ java \ com \ facebook \ presto \ hive \ TestAbstractDwrfEncryptionInformationSource . java \n + @ Test \n + public void testGetReadEncryptionInformationForPartitionedTableWithTableLevelEncryptionAndNoRequestedColumns ( ) \n + { \n + Table table = createTable ( DWRF , Optional . of ( forTable ( "" key1 "" , "" algo "" , "" provider "" ) ) , true ) ; \n + Optional < Map < String , EncryptionInformation > > encryptionInformation = encryptionInformationSource . getReadEncryptionInformation ( \n + SESSION , \n + table , \n + Optional . of ( ImmutableSet . of ( ) ) , \n + ImmutableMap . of ( \n + "" ds = 2020 - 01 - 01 "" , new Partition ( "" dbName "" , "" tableName "" , ImmutableList . of ( "" 2020 - 01 - 01 "" ) , table . getStorage ( ) , table . getDataColumns ( ) , ImmutableMap . of ( ) ) , \n + "" ds = 2020 - 01 - 02 "" , new Partition ( "" dbName "" , "" tableName "" , ImmutableList . of ( "" 2020 - 01 - 02 "" ) , table . getStorage ( ) , table . getDataColumns ( ) , ImmutableMap . of ( ) ) ) ) ; \n + \n + assertTrue ( encryptionInformation . isPresent ( ) ) ; \n + assertEquals ( \n + encryptionInformation . get ( ) , \n + ImmutableMap . of ( \n + "" ds = 2020 - 01 - 01 "" , EncryptionInformation . fromEncryptionMetadata ( DwrfEncryptionMetadata . forPerField ( ImmutableMap . of ( ) , ImmutableMap . of ( TEST _ EXTRA _ METADATA , "" ds = 2020 - 01 - 01 "" ) , "" algo "" , "" provider "" ) ) , \n + "" ds = 2020 - 01 - 02 "" , EncryptionInformation . fromEncryptionMetadata ( DwrfEncryptionMetadata . forPerField ( ImmutableMap . of ( ) , ImmutableMap . of ( TEST _ EXTRA _ METADATA , "" ds = 2020 - 01 - 02 "" ) , "" algo "" , "" provider "" ) ) ) ) ; \n + } \n + \n","Avoid fetching encryption information when no columns requested \n This can happen if the user is only asking for partition columns or something like count ( * ) . As of now , \n if the table has table level encryption key , we will try getting the key metadata for that key where \n as it is not needed . This change will allow users who don ' t have access to the table data to still be able \n to get the partition columns or count ( * ) and bring the implementation at par with column level encryption \n key specification",334
"presto - resource - group - managers \ src \ main \ java \ com \ facebook \ presto \ resourceGroups \ db \ ResourceGroupsDao . java \n + "" id BIGINT NOT NULL AUTO _ INCREMENT , \ n "" + \n + "" PRIMARY KEY ( id ) , \ n "" + \n",Add primary key to selectors table \n This ID primary key will help with easily selecting specific rows and updating them,334
"presto - main \ src \ main \ java \ com \ facebook \ presto \ execution \ resourceGroups \ InternalResourceGroupManager . java \n - return Math . min ( resourceGroup . getQueuedQueries ( ) , resourceGroup . getSoftConcurrencyLimit ( ) - resourceGroup . getRunningQueries ( ) ) ; \n + return Math . max ( Math . min ( resourceGroup . getQueuedQueries ( ) , resourceGroup . getSoftConcurrencyLimit ( ) - resourceGroup . getRunningQueries ( ) ) , 0 ) ; \n","Fix adjusted queue size calculation \n In situations that number of running queries > soft concurrency limit , the adjusted queue size is negative . \n This is incorrect - since if 1 RG gets a good share of resources when the cluster is free and holds onto \n it , in that situation we should not have that 1 RG ' s negative quota impact other users , it just means \n that the adjusted queue size for that RG is 0 - no waiting",334
"src \ jvm \ clojure \ lang \ Compiler . java \n - ' $ ' , "" _ DOLLARSIGN _ "" , \n + ' \ ' ' , "" _ SINGLEQUOTE _ "" , \n + ' "" ' , "" _ DOUBLEQUOTE _ "" , \n","fix munge handling of $ , ' , "" \n clojure . core / munge no longer changes $ to _ DOLLARSIGN _ . Also , ' is now \n munged to _ SINGLEQUOTE _ and "" to _ DOUBLEQUOTE _ . This brings munge in \n line with java . lang . Character / isJavaIdentifierPart . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >",341
"src \ clj \ clojure \ core . clj \n - \n - \n - ( defn zipmap \n - "" Returns a map with the keys mapped to the corresponding vals . "" \n - { : added "" 1 . 0 "" \n - : static true } \n - [ keys vals ] \n - ( loop [ map { } \n - ks ( seq keys ) \n - vs ( seq vals ) ] \n - ( if ( and ks vs ) \n - ( recur ( assoc map ( first ks ) ( first vs ) ) \n - ( next ks ) \n - ( next vs ) ) \n - map ) ) ) \n - \n + ( defn zipmap \n + "" Returns a map with the keys mapped to the corresponding vals . "" \n + { : added "" 1 . 0 "" \n + : static true } \n + [ keys vals ] \n + ( loop [ map ( transient { } ) \n + ks ( seq keys ) \n + vs ( seq vals ) ] \n + ( if ( and ks vs ) \n + ( recur ( assoc ! map ( first ks ) ( first vs ) ) \n + ( next ks ) \n + ( next vs ) ) \n + ( persistent ! map ) ) ) ) \n",CLJ - 1005 : use transient map in zipmap \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,341
"src \ clj \ clojure \ core . clj \n + ( defn ex - message \n + "" Returns the message attached to ex if ex is a Throwable . \n + Otherwise returns nil . "" \n + { : added "" 1 . 10 "" } \n + [ ex ] \n + ( when ( instance ? Throwable ex ) \n + ( . getMessage ^ Throwable ex ) ) ) \n + \n + ( defn ex - cause \n + "" Returns the cause of ex if ex is a Throwable . \n + Otherwise returns nil . "" \n + { : added "" 1 . 10 "" } \n + [ ex ] \n + ( when ( instance ? Throwable ex ) \n + ( . getCause ^ Throwable ex ) ) ) \n + \n","CLJ - 1120 : Add ex - message , ex - cause \n Introduces ex - message and ex - cause functions for dealing with \n ExceptionInfo in a platform - independent manner . Actually implemented \n and documented to return messages / causes of arbitrary Throwables . \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",341
"src \ jvm \ clojure \ lang \ APersistentVector . java \n - final IPersistentVector v ; \n - final int start ; \n - final int end ; \n + public final IPersistentVector v ; \n + public final int start ; \n + public final int end ; \n src \ jvm \ clojure \ lang \ PersistentVector . java \n - static class Node implements Serializable { \n - transient final AtomicReference < Thread > edit ; \n - final Object [ ] array ; \n + public static class Node implements Serializable { \n + transient public final AtomicReference < Thread > edit ; \n + public final Object [ ] array ; \n - Node ( AtomicReference < Thread > edit , Object [ ] array ) { \n + public Node ( AtomicReference < Thread > edit , Object [ ] array ) { \n - final static Node EMPTY _ NODE = new Node ( NOEDIT , new Object [ 32 ] ) ; \n + public final static Node EMPTY _ NODE = new Node ( NOEDIT , new Object [ 32 ] ) ; \n - final int shift ; \n - final Node root ; \n - final Object [ ] tail ; \n + public final int shift ; \n + public final Node root ; \n + public final Object [ ] tail ; \n","Make some PersistentVector ' s and APersistentVector . SubVector ' s internals public \n This commit makes public the following items : \n * PersistentVector . Node , \n * PersistentVector . Node binary ctor , \n * PersistentVector . Node ' s edit and array fields , \n * PersistentVector . EMPTY _ NODE , \n * PersistentVector ' s shift , root and tail fields , \n * APersistentVector . SubVector ' s v , start and end fields . \n Signed - off - by : Rich Hickey < richhickey @ gmail . com >",341
src \ jvm \ clojure \ lang \ APersistentVector . java \n - static class SubVector extends APersistentVector implements IObj { \n + public static class SubVector extends APersistentVector implements IObj { \n,CLJ - 1354 : make APersistentVector . SubVector public \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,341
src \ clj \ clojure \ core . clj \n - ( if ( > kw kv ) \n + ( if ( > = kw kv ) \n - ( if ( < kw kv ) \n + ( if ( < = kw kv ) \n test \ clojure \ test _ clojure \ other _ functions . clj \n - [ 5 10 15 20 25 ] 25 5 \n - { nil 1 false - 1 true 0 } [ true true false nil ] false nil ) ) \n + { nil 1 false - 1 true 0 } [ true true false nil ] false nil ) \n + ( are [ f k coll expected ] ( = expected ( apply f k coll ) ) \n + min - key : x [ { : x 1000 } { : x 1001 } { : x 1002 } { : x 1000 : second true } ] { : x 1000 : second true } \n + max - key : x [ { : x 1000 } { : x 999 } { : x 998 } { : x 1000 : second true } ] { : x 1000 : second true } ) ) \n,"CLJ - 2247 : restore last match semantics of { min , max } - key \n The CLJ - 99 patch ( d10a9d36ef91e1f329528890d6fc70471d78485d ) makes two \n changes to the behaviour of { min , max } - key : \n 1 . it ensures that the key function is only called once on each \n argument ; \n 2 . it causes both functions to return the first match , whereas \n previously they returned the last one . \n This preserves 1 . and reverts 2 . \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",341
"src \ clj \ clojure \ core . clj \n - "" Returns the x for which ( k x ) , a number , is greatest . "" \n + "" Returns the x for which ( k x ) , a number , is greatest . \n + \n + If there are multiple such xs , the last one is returned . "" \n - "" Returns the x for which ( k x ) , a number , is least . "" \n + "" Returns the x for which ( k x ) , a number , is least . \n + \n + If there are multiple such xs , the last one is returned . "" \n","CLJ - 2247 : document "" last match "" semantics of { min , max } - key \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",341
"src \ clj \ clojure \ core . clj \n - ^ { : arglists ' ( [ coll x ] [ coll x & xs ] ) \n + ^ { : arglists ' ( [ ] [ coll ] [ coll x ] [ coll x & xs ] ) \n - ' added ' . ( conj nil item ) returns ( item ) . The ' addition ' may \n - happen at different ' places ' depending on the concrete type . "" \n + ' added ' . ( conj nil item ) returns ( item ) . \n + ( conj coll ) returns coll . ( conj ) returns [ ] . \n + The ' addition ' may happen at different ' places ' depending \n + on the concrete type . "" \n","CLJ - 2169 : add nullary , unary overloads of conj to its : arglists \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",341
"okhttp \ src \ main \ java \ com \ squareup \ okhttp \ internal \ http \ HttpURLConnectionImpl . java \n + import com . squareup . okhttp . internal . Platform ; \n + if ( newValue = = null ) { \n + / / Silently ignore null header values for backwards compatibility with older \n + / / android versions as well as with other URLConnection implementations . \n + / / \n + / / Some implementations send a malformed HTTP header when faced with \n + / / such requests , we respect the spec and ignore the header . \n + Platform . get ( ) . logW ( "" Ignoring header "" + field + "" because its value was null . "" ) ; \n + return ; \n + } \n + \n + if ( value = = null ) { \n + / / Silently ignore null header values for backwards compatibility with older \n + / / android versions as well as with other URLConnection implementations . \n + / / \n + / / Some implementations send a malformed HTTP header when faced with \n + / / such requests , we respect the spec and ignore the header . \n + Platform . get ( ) . logW ( "" Ignoring header "" + field + "" because its value was null . "" ) ; \n + return ; \n + } \n - if ( transportsString = = null ) { \n - throw new NullPointerException ( "" transportsString = = null "" ) ; \n - } \n - \n",Ignore null header values . \n Required for backwards compatibility . Null headers \n throw an RTE ( as they should ) when they ' re set internally \n or directly on the RawHeaders object .,352
okhttp \ src \ main \ java \ com \ squareup \ okhttp \ internal \ spdy \ SpdyConnection . java \n - synchronized ( this ) { \n + synchronized ( SpdyConnection . this ) { \n,Fix bad locking in SpdyConnection \n This caused an assertion error in SpdyStream # setSettings \n where we assert that the lock on the associated \n SpdyConnection is held .,352
"okhttp \ src \ main \ java \ com \ squareup \ okhttp \ Connection . java \n - socket . connect ( route . inetSocketAddress , connectTimeout ) ; \n + Platform . get ( ) . connectSocket ( socket , route . inetSocketAddress , connectTimeout ) ; \n okhttp \ src \ main \ java \ com \ squareup \ okhttp \ internal \ Platform . java \n + import java . net . InetSocketAddress ; \n + public void connectSocket ( Socket socket , InetSocketAddress address , \n + int connectTimeout ) throws IOException { \n + socket . connect ( address , connectTimeout ) ; \n + } \n + \n + @ Override public void connectSocket ( Socket socket , InetSocketAddress address , \n + int connectTimeout ) throws IOException { \n + try { \n + socket . connect ( address , connectTimeout ) ; \n + } catch ( SecurityException se ) { \n + / / Before android 4 . 3 , socket . connect could throw a SecurityException \n + / / if opening a socket resulted in an EACCES error . \n + throw new IOException ( "" Exception in connect "" , se ) ; \n + } \n + } \n + \n + \n",Catch SecurityExceptions from socket connects . \n Versions of android prior to 4 . 3 would throw RTEs \n if the underlying socket threw an EACCES error . \n See change 50144 on the Android Open Source Project .,352
"src \ main \ java \ com \ squareup \ okhttp \ internal \ spdy \ SpdyReader . java \n + if ( numberOfPairs < 0 ) { \n + Logger . getLogger ( getClass ( ) . getName ( ) ) . warning ( "" numberOfPairs < 0 : "" + numberOfPairs ) ; \n + throw ioException ( "" numberOfPairs < 0 "" ) ; \n + } \n","Guard against invalid name value block headers . \n If a badly behaved server sends us a negative number \n of name value blocks , we should throw an IOException and \n not a RTE ( which will be thrown when we try to construct an \n ArrayList with a negative size ) .",352
okhttp \ src \ main \ java \ com \ squareup \ okhttp \ HttpResponseCache . java \n + public long getSize ( ) { \n + return cache . size ( ) ; \n + } \n + \n + public long getMaxSize ( ) { \n + return cache . getMaxSize ( ) ; \n + } \n + \n + public void flush ( ) throws IOException { \n + cache . flush ( ) ; \n + } \n + \n + public void close ( ) throws IOException { \n + cache . close ( ) ; \n + } \n + \n + public File getDirectory ( ) { \n + return cache . getDirectory ( ) ; \n + } \n + \n + public boolean isClosed ( ) { \n + return cache . isClosed ( ) ; \n + } \n + \n,"Allow access to the underlying DiskLruCache . \n This is needed to implement public android APIs \n android . net . HttpResponseCache . { flush , size , maxSize , close } \n as well android . net . HttpResponseCache . install . \n install needs to inspect the underlying DiskLruCache because \n it promises not to install a new cache if the file directory and \n size are the same as the old cache .",352
okhttp \ src \ main \ java \ com \ squareup \ okhttp \ internal \ http \ RouteSelector . java \n - socketHost = uri . getHost ( ) ; \n + socketHost = address . getUriHost ( ) ; \n,"Be consistent about host names in RouteSelector . \n Use the host specified by the address , and not URI . getHost ( ) . \n bug : 18023709 \n Change - Id : I2c39c2ce89049130dc00047c8de6f214159144c0",352
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ provider \ ScheduleDatabase . java \n + TagsColumns . TAG _ ORDER _ IN _ CATEGORY + "" INTEGER , "" \n + TagsColumns . TAG _ COLOR + "" TEXT NOT NULL , "" \n + TagsColumns . TAG _ ABSTRACT + "" TEXT NOT NULL , "" \n - + TagsColumns . TAG _ PHOTO _ URL + "" TEXT , "" \n + "" UNIQUE ( "" + TagsColumns . TAG _ ID + "" ) ON CONFLICT REPLACE ) "" ) ; \n","Fix for crash when clearing data , due to tag table \n Change - Id : I4255b7795a122c99e71db0790244f9f2c6475b9d",354
"android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ testutils \ MatchersHelper . java \n - import android . support . design . internal . NavigationMenuItemView ; \n - import org . hamcrest . Description ; \n - import org . hamcrest . TypeSafeMatcher ; \n - / * * \n - * Returns a matcher that matches { @ link NavigationMenuItemView } s that are checked . \n - * / \n - public static Matcher < View > isNavigationMenuItemViewChecked ( ) { \n - return new TypeSafeMatcher < View > ( ) { \n - @ Override \n - public void describeTo ( Description description ) { \n - description . appendText ( "" is NavigationMenuItemView checked "" ) ; \n - } \n - \n - @ Override \n - public boolean matchesSafely ( View view ) { \n - return view instanceof NavigationMenuItemView & & \n - ( ( NavigationMenuItemView ) view ) . getItemData ( ) . isChecked ( ) ; \n - } \n - } ; \n - } \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ testutils \ NavigationUtils . java \n - import android . support . design . internal . NavigationMenuItemView ; \n + import android . support . v7 . widget . AppCompatCheckedTextView ; \n + import static android . support . test . espresso . matcher . ViewMatchers . isChecked ; \n - onView ( allOf ( isAssignableFrom ( NavigationMenuItemView . class ) , \n + onView ( allOf ( isAssignableFrom ( AppCompatCheckedTextView . class ) , \n - onView ( allOf ( isAssignableFrom ( NavigationMenuItemView . class ) , withText ( \n + onView ( allOf ( isAssignableFrom ( AppCompatCheckedTextView . class ) , withText ( \n - . check ( matches ( MatchersHelper . isNavigationMenuItemViewChecked ( ) ) ) ; \n + . check ( matches ( isChecked ( ) ) ) ; \n - onView ( allOf ( isAssignableFrom ( NavigationMenuItemView . class ) , withText ( \n + onView ( allOf ( isAssignableFrom ( AppCompatCheckedTextView . class ) , withText ( \n - . check ( matches ( not ( MatchersHelper . isNavigationMenuItemViewChecked ( ) ) ) ) ; \n + . check ( matches ( not ( isChecked ( ) ) ) ) ; \n","Fix for navigation view tests , following update of support lib , causing a change in NavigationView implementation \n Change - Id : I7ab31a12a319d33754077d41bd2936cc4fc16124",354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleAllDaysFragment . java \n - mPreConferenceDayView . setAdapter ( new MyScheduleDayAdapter ( getContext ( ) , \n + mPreConferenceDayView . setAdapter ( new MyScheduleDayAdapter ( getActivity ( ) , \n - mMyScheduleSingleDayViews [ i ] . setAdapter ( new MyScheduleDayAdapter ( getContext ( ) , \n + mMyScheduleSingleDayViews [ i ] . setAdapter ( new MyScheduleDayAdapter ( getActivity ( ) , \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleDayAdapter . java \n + import android . content . Intent ; \n + import com . google . samples . apps . iosched . feedback . SessionFeedbackActivity ; \n + \n + mContext . startActivity ( new Intent ( Intent . ACTION _ VIEW , uri ) ) ; \n + \n + Intent feedbackIntent = new Intent ( Intent . ACTION _ VIEW , \n + ScheduleContract . Sessions . buildSessionUri ( item . sessionId ) , \n + mContext , SessionFeedbackActivity . class ) ; \n + mContext . startActivity ( feedbackIntent ) ; \n + \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleModel . java \n - import android . net . Uri ; \n - mContext . startActivity ( new Intent ( Intent . ACTION _ VIEW , Uri . parse ( uriStr ) ) ) ; \n - \n - Intent feedbackIntent = new Intent ( Intent . ACTION _ VIEW , \n - ScheduleContract . Sessions . buildSessionUri ( id ) , \n - mContext , SessionFeedbackActivity . class ) ; \n - mContext . startActivity ( feedbackIntent ) ; \n - \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleSingleDayFragment . java \n - mViewAdapter = new MyScheduleDayAdapter ( getContext ( ) , \n + mViewAdapter = new MyScheduleDayAdapter ( getActivity ( ) , \n",RFR - Moved startActivity from model to view for MySchedule feature \n Change - Id : Id2f24443611ce03faa01cf158c35f9fb119dee82,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ videolibrary \ VideoLibraryFilteredFragment . java \n - startActivity ( i ) ; \n + getActivity ( ) . startActivity ( i ) ; \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ videolibrary \ VideoLibraryFragment . java \n - startActivity ( i ) ; \n + getActivity ( ) . startActivity ( i ) ; \n - startActivity ( i ) ; \n + getActivity ( ) . startActivity ( i ) ; \n,"RFR - Made sure Activities started from Fragment use the Activity context \n This is necessary for UI tests using Intento , which fail on M if we use Fragment . startActivity \n Change - Id : If6ec473146abd4970d9c6e7f7964066787c3486e",354
android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivityTest . java \n - import android . support . test . rule . ActivityTestRule ; \n - import android . test . ActivityInstrumentationTestCase2 ; \n - / * * \n - * A JUnit { @ link Rule @ Rule } to launch your activity under test . This is a replacement for \n - * { @ link ActivityInstrumentationTestCase2 } . \n - * < p / > \n - * Rules are interceptors which are executed for each test method and will run before any of \n - * your setup code in the { @ link Before @ Before } method . \n - * < p / > \n - * { @ link ActivityTestRule } will create and launch of the activity for you and also expose the \n - * activity under test . To get a reference to the activity you can use the { @ link \n - * ActivityTestRule # getActivity ( ) } method . \n - * / \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity _ InteractionsTest . java \n - import android . test . ActivityInstrumentationTestCase2 ; \n - / * * \n - * A JUnit { @ link Rule @ Rule } to launch your activity under test . This is a replacement for \n - * { @ link ActivityInstrumentationTestCase2 } . \n - * < p / > \n - * Rules are interceptors which are executed for each test method and will run before any of \n - * your setup code in the { @ link Before @ Before } method . \n - * < p / > \n - * { @ link ActivityTestRule } will create and launch of the activity for you and also expose the \n - * activity under test . To get a reference to the activity you can use the { @ link \n - * ActivityTestRule # getActivity ( ) } method . \n - * / \n,RFR - Removed outdated doc for ActivityTestRule \n Change - Id : Ia117462b73c2a41e06339e005a0e8a542b3f2ea3,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ BaseActivity . java \n - public final static String PRESENTER _ TAG = "" Presenter "" ; \n - \n",Removed unused tag constant for Presenter \n Change - Id : I628a1fced251f58ad773019c229b2fa184485fb5,354
android \ build . gradle \n - / / Needed to implement the IdlingResource interface on certain async models . \n - compile ' com . android . support . test . espresso : espresso - idling - resource : 2 . 0 ' \n - \n build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 3 . 1 ' \n + classpath ' com . android . tools . build : gradle : 2 . 0 . 0 - beta6 ' \n gradle \ wrapper \ gradle - wrapper . properties \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 2 . 1 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 10 - all . zip \n server \ build . gradle \n - classpath ' com . google . appengine : gradle - appengine - plugin : 1 . 9 . 18 ' \n + classpath ' com . google . appengine : gradle - appengine - plugin : 1 . 9 . 30 ' \n,"Increased gradle plugin version to 2 . 0 \n 1 . Requires higher version of app engine plugin for server \n 2 . Warns about espresso dependency conflict , removed dependency from app \n Bug : # 27918435 \n Change - Id : I8ebc3fee70a4eeb6feaa68ea0e0a3efb1ab8f0a4",354
"android \ src \ main \ res \ values \ attrs . xml \n - < declare - styleable name = "" NavDrawerItemView "" > \n - < attr name = "" iconTints "" format = "" color "" / > \n - < / declare - styleable > \n - \n",Removed unused attribute for nav view \n Change - Id : Ife47616c45dcc852d6a1de97ef28f64f4a8e84a6,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n - private int mViewPagerScrollState = ViewPager . SCROLL _ STATE _ IDLE ; \n - \n - / / Prevent the swipe refresh by returning true here \n - if ( mViewPagerScrollState = = ViewPager . SCROLL _ STATE _ DRAGGING ) { \n - return true ; \n - } \n - \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ widget \ MultiSwipeRefreshLayout . java \n + import android . view . MotionEvent ; \n + \n + private float mStartGestureX ; \n + \n + private float mStartGestureY ; \n + \n + private boolean mHorizontalScrollDetected ; \n + \n + / * * \n + * @ return false if the scrolled horizontal distance is bigger than the vertical one \n + * / \n + @ Override \n + public boolean onInterceptTouchEvent ( MotionEvent event ) { \n + switch ( event . getAction ( ) ) { \n + case MotionEvent . ACTION _ DOWN : \n + mStartGestureX = event . getX ( ) ; \n + mStartGestureY = event . getY ( ) ; \n + mHorizontalScrollDetected = false ; \n + break ; \n + \n + case MotionEvent . ACTION _ MOVE : \n + mHorizontalScrollDetected = Math . abs ( event . getX ( ) - mStartGestureX ) > \n + Math . abs ( event . getY ( ) - mStartGestureY ) ; \n + if ( mHorizontalScrollDetected ) { \n + return false ; \n + } \n + break ; \n + } \n + \n + return super . onInterceptTouchEvent ( event ) ; \n + } \n + \n,Fixed issue of SwipeRefreshLayout interfering with tap swiping in my schedule \n Bug : # 26618331 \n Change - Id : I212f35d603edfa2b97a5ddab66c1b82797d6a982,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ BaseActivity . java \n - return mHeaderViewImpl . getActionBarToolbar ( ) ; \n + if ( mHeaderViewImpl ! = null ) { \n + return mHeaderViewImpl . getActionBarToolbar ( ) ; \n + } else { \n + return null ; \n + } \n - mHeaderViewImpl . registerHideableHeaderView ( hideableHeaderView ) ; \n + if ( mHeaderViewImpl ! = null ) { \n + mHeaderViewImpl . registerHideableHeaderView ( hideableHeaderView ) ; \n + } \n - mHeaderViewImpl . deregisterHideableHeaderView ( hideableHeaderView ) ; \n + if ( mHeaderViewImpl ! = null ) { \n + mHeaderViewImpl . deregisterHideableHeaderView ( hideableHeaderView ) ; \n + } \n,RFR - fix for bug in Header view refactoring \n Change - Id : I58ac8bc1771abce6bde768922a2e61523df0e17c,354
android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ login \ BaseActivity _ InactiveAccountTest . java \n - import android . support . test . filters . FlakyTest ; \n + import android . support . test . filters . SdkSuppress ; \n - @ FlakyTest \n + @ SdkSuppress ( minSdkVersion = 17 ) \n,Replaced annotation for test with required min SDK \n Change - Id : Ie598a89d2239c9b5471e20e91db958c636d36972,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ navigation \ AppNavigationViewAsDrawerImpl . java \n - if ( mNavigationView ! = null ) { \n + if ( mNavigationView ! = null & & item ! = NavigationItemEnum . INVALID ) { \n,Fixed crash when viewing map from session details \n Bug : # 28184579 \n Change - Id : I7d36f62f74a79fa7d267bd27e49e74edc3f7cda0,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ settings \ SettingsUtils . java \n - private static final String CONFERENCE _ YEAR _ PREF _ POSTFIX = "" _ 2015 "" ; \n + private static final String CONFERENCE _ YEAR _ PREF _ POSTFIX = "" _ 2016 "" ; \n android \ src \ main \ res \ xml \ settings _ prefs . xml \n - android : key = "" pref _ attendee _ at _ venue _ 2015 "" \n + android : key = "" pref _ attendee _ at _ venue _ 2016 "" \n - android : key = "" pref _ show _ session _ reminders _ 2015 "" \n + android : key = "" pref _ show _ session _ reminders _ 2016 "" \n - android : key = "" pref _ show _ session _ feedback _ reminders _ 2015 "" \n + android : key = "" pref _ show _ session _ feedback _ reminders _ 2016 "" \n",Updated settings to 2016 \n Bug : # 28184797 \n Change - Id : I74b3091fa68ee6cdb55e7b2d1a62ae6158c4b36e,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ videolibrary \ VideoLibraryFilteredFragment . java \n + radioGroup . clearCheck ( ) ; \n,Fixed selection not showing in filter after viewing video \n Bug : # 28186866 \n Change - Id : I83d824874e492a220ee2afb5246d602e6a48f584,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailFragment . java \n + if ( ! BuildConfig . ENABLE _ MAP _ IN _ NAVIGATION ) { \n + MenuItem map = menu . findItem ( R . id . menu _ map _ room ) ; \n + map . setVisible ( false ) ; \n + } \n,Added check for build config ENABLE _ MAP _ IN _ NAVIGATION to show map icon in session details screen \n Bug : # 28189212 \n Change - Id : Ia814e4cc523e6b50381f02bf31a00118054901e8,354
"android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ mockdata \ SessionsMockCursor . java \n - keynote ? EMPTY : SpeakersMockCursor . FAKE _ SPEAKER } ; \n + keynote ? EMPTY : SpeakersMockCursor . FAKE _ SPEAKER , FAKE _ TAG } ; \n - "" session _ related _ content "" , "" session _ tags "" , "" session _ speaker _ names "" } ; \n + "" session _ related _ content "" , "" session _ tags "" , "" session _ speaker _ names "" , "" session _ main _ tag "" } ; \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailActivity _ LiveSessionTest . java \n + @ Test \n + public void headerImage _ IsVisible ( ) { \n + onView ( withId ( R . id . session _ photo ) ) . check ( matches ( isDisplayed ( ) ) ) ; \n + } \n + \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailActivity _ NotLiveSessionTest . java \n + @ Test \n + public void headerImage _ IsNotVisible ( ) { \n + onView ( withId ( R . id . session _ photo ) ) . check ( matches ( not ( isDisplayed ( ) ) ) ) ; \n + } \n + \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailFragment . java \n - if ( data . hasPhotoUrl ( ) ) { \n + if ( data . shouldShowHeaderImage ( ) ) { \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailModel . java \n - return minutes * 60000 < ( mSessionStart - currentTimeMillis ) ? minutes + 1 : minutes ; \n + return minutes * 60000 < ( mSessionStart - currentTimeMillis ) ? minutes + 1 : minutes ; \n + / * * \n + * Show header image if there is a photo url and either a youTube url or a live stream for an \n + * ongoing session . \n + * / \n + public boolean shouldShowHeaderImage ( ) { \n + return hasPhotoUrl ( ) & & ( ( ! TextUtils . isEmpty ( mYouTubeUrl ) & & ! mYouTubeUrl . equals ( "" null "" ) ) | | \n + ( mHasLiveStream & & isSessionOngoing ( ) ) ) ; \n + } \n + \n",Photo not shown in details screen if no livestream / you tube url . Fixed UI tests . \n Bug : # 28021963 \n Change - Id : I5ec5bde65a69caafce49fe6e1ddc86753c81be66,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ explore \ data \ SessionData . java \n - return mStartDate . before ( now . getTime ( ) ) & & mEndDate . after ( now . getTime ( ) ) ; \n + return mStartDate . before ( now ) & & mEndDate . after ( now ) ; \n android \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ explore \ ExploreIOModelTest . java \n - private static final String FAKE _ SESSION _ TITLE _ 1 = "" TITLE1 "" ; \n + private static final String FAKE _ SESSION _ TITLE _ 1 _ LIVESTREAM = "" TITLE _ LIVESTREAM "" ; \n - private static final String FAKE _ SESSION _ TAGS _ 4 = "" TOPIC _ TAG4 "" ; \n + private static final String FAKE _ SESSION _ TAGS _ 4 = "" TRACK _ TAG4 "" ; \n - new String [ ] { FAKE _ SESSION _ TITLE _ 1 , FAKE _ SESSION _ TITLE _ 2 _ KEYNOTE , FAKE _ SESSION _ TITLE _ 3 , \n + new String [ ] { FAKE _ SESSION _ TITLE _ 1 _ LIVESTREAM , FAKE _ SESSION _ TITLE _ 2 _ KEYNOTE , \n + FAKE _ SESSION _ TITLE _ 3 , \n - is ( FAKE _ SESSION _ TITLE _ 1 ) ) ; \n + is ( FAKE _ SESSION _ TITLE _ 1 _ LIVESTREAM ) ) ; \n - assertThat ( themeGroup1 . getSessions ( ) . get ( 0 ) . getSessionName ( ) , is ( FAKE _ SESSION _ TITLE _ 1 ) ) ; \n + assertThat ( themeGroup1 . getSessions ( ) . get ( 0 ) . getSessionName ( ) , \n + is ( FAKE _ SESSION _ TITLE _ 1 _ LIVESTREAM ) ) ; \n - assertThat ( themeGroup2 . getSessions ( ) . get ( 0 ) . getSessionName ( ) , is ( FAKE _ SESSION _ TITLE _ 1 ) ) ; \n + assertThat ( themeGroup2 . getSessions ( ) . get ( 0 ) . getSessionName ( ) , \n + is ( FAKE _ SESSION _ TITLE _ 1 _ LIVESTREAM ) ) ; \n",Fixed failing unit test & error in time comparaison \n Bug : # 28267835 \n Change - Id : I9f3d2cd56e274a056116cb82add02e8fbf7ce788,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ debug \ DebugFragment . java \n + SettingsUtils . markTosAccepted ( context , false ) ; \n + SettingsUtils . markConductAccepted ( context , false ) ; \n + SettingsUtils . setAttendeeAtVenue ( context , false ) ; \n + SettingsUtils . markAnsweredLocalOrRemote ( context , false ) ; \n + AccountUtils . setActiveAccount ( context , null ) ; \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ welcome \ WelcomeActivity . java \n - } \n - \n - / / Wire up the fragment . \n - FragmentTransaction fragmentTransaction = getFragmentManager ( ) . beginTransaction ( ) ; \n - fragmentTransaction . add ( R . id . welcome _ content , ( Fragment ) mContentFragment ) ; \n - fragmentTransaction . commit ( ) ; \n - \n - final ImageView iv = ( ImageView ) findViewById ( R . id . logo ) ; \n - final AnimatedVectorDrawableCompat logo = \n - AnimatedVectorDrawableCompat . create ( this , R . drawable . avd _ hash _ io _ 16 ) ; \n - if ( iv ! = null & & logo ! = null ) { \n - iv . setImageDrawable ( logo ) ; \n - \n - if ( UIUtils . animationEnabled ( getContentResolver ( ) ) ) { \n - logo . start ( ) ; \n + } else { \n + / / Wire up the fragment . \n + FragmentTransaction fragmentTransaction = getFragmentManager ( ) . beginTransaction ( ) ; \n + fragmentTransaction . add ( R . id . welcome _ content , ( Fragment ) mContentFragment ) ; \n + fragmentTransaction . commit ( ) ; \n + \n + final ImageView iv = ( ImageView ) findViewById ( R . id . logo ) ; \n + final AnimatedVectorDrawableCompat logo = \n + AnimatedVectorDrawableCompat . create ( this , R . drawable . avd _ hash _ io _ 16 ) ; \n + if ( iv ! = null & & logo ! = null ) { \n + iv . setImageDrawable ( logo ) ; \n + \n + if ( UIUtils . animationEnabled ( getContentResolver ( ) ) ) { \n + logo . start ( ) ; \n + } \n + \n",Fixed bug when tapping display WelcomeActivity in debug screen \n Bug : # 27995560 \n Change - Id : Icbd1a6ced9a1c8b92d8131b85a1433fc95581b73,354
"android \ src \ main \ res \ values \ strings . xml \n - < string name = "" navdrawer _ item _ my _ schedule "" > My Schedule < / string > \n + < string name = "" navdrawer _ item _ my _ schedule "" > Schedule < / string > \n - < string name = "" title _ my _ schedule "" > My Schedule < / string > \n + < string name = "" title _ my _ schedule "" > Schedule < / string > \n",Renamed My Schedule to Schedule \n Bug : # 27784781 \n Change - Id : If7751b71d330b591878fa34d1973f69ec7fc383c,354
"android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailActivity _ InScheduleSessionTest . java \n - / / Then the intent to show the explore sessions for the tag is shown \n - intended ( CoreMatchers . allOf ( \n - hasComponent ( ExploreSessionsActivity . class . getName ( ) ) , \n - hasExtra ( ExploreSessionsActivity . EXTRA _ FILTER _ TAG , \n - TagMetadataMockCursor . TAG _ ID _ NAME ) ) ) ; \n - } public void tag _ OnClick _ IntentFired ( ) { \n - / / When clicking on tag \n - onView ( withText ( SessionsMockCursor . FAKE _ TAG ) ) . perform ( scrollTo ( ) ) ; \n - onView ( withText ( SessionsMockCursor . FAKE _ TAG ) ) . perform ( click ( ) ) ; \n - \n",Fixed merge \n Change - Id : Ia4953ca9e3ae4192dbc97d6871de61c9f74750bf,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ session \ SessionDetailFragment . java \n + } else { \n,"Fix for bug in showing "" watch "" live text \n Bug : # 28208316 \n Change - Id : I7c5be95c01c08b5ddb3355dea3ba018995f7e93f",354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ explore \ ExploreIOFragment . java \n + import com . google . samples . apps . iosched . util . AccountUtils ; \n - import static com . google . samples . apps . iosched . settings . ConfMessageCardUtils \n - . ConferencePrefChangeListener ; \n + import static com . google . samples . apps . iosched . settings . ConfMessageCardUtils . ConferencePrefChangeListener ; \n + } else if ( AccountUtils . PREF _ ACTIVE _ ACCOUNT . equals ( key ) ) { \n + fireReloadEvent ( ) ; \n + \n - / / All user actions handled in model \n + switch ( userAction ) { \n + case RELOAD : \n + displayData ( model , ExploreIOQueryEnum . SESSIONS ) ; \n + break ; \n + } \n",Fixed bug for Explore IO not updating itself after changing logged in user \n Bug : # 28361418 \n Change - Id : I95dcc1c30201dcc5dd5574b3eba3945e0214ff1e,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleActivity . java \n + reloadData ( ) ; \n + } \n + \n + private void reloadData ( ) { \n + if ( mPresenter ! = null ) { \n + mPresenter . onUserAction ( MyScheduleModel . MyScheduleUserActionEnum . RELOAD _ DATA , null ) ; \n + } \n",Fix for my schedule screen not updating with user change \n Bug : # 28361418 \n Change - Id : I9e1f961d34d3dd5e971845ba562f9f28c08dd2e0,354
"android \ src \ main \ res \ values - it \ strings . xml \n - < string name = "" social _ io15 _ gplus _ content _ description "" > Vai a Google Plus con l ' hashtag di io16 < / string > \n + < string name = "" social _ io15 _ gplus _ content _ description "" > Vai a Google Plus con l \ ' hashtag di io16 < / string > \n - < string name = "" social _ io15 _ twitter _ content _ description "" > Vai su Twitter con l ' hashtag di io16 < / string > \n + < string name = "" social _ io15 _ twitter _ content _ description "" > Vai su Twitter con l \ ' hashtag di io16 < / string > \n - < string name = "" social _ extended _ gplus _ content _ description "" > Vai su Google Plus con l ' hashtag extended < / string > \n + < string name = "" social _ extended _ gplus _ content _ description "" > Vai su Google Plus con l \ ' hashtag extended < / string > \n - < string name = "" social _ extended _ twitter _ content _ description "" > Vai su Twitter con l ' hashtag extended < / string > \n + < string name = "" social _ extended _ twitter _ content _ description "" > Vai su Twitter con l \ ' hashtag extended < / string > \n",Fix for non escaped apostrophe in italian strings \n Change - Id : Iffb67429afdf1ee08c2e7b19ad4d3daca982b9c6,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ welcome \ WelcomeFragment . java \n + import android . view . accessibility . AccessibilityEvent ; \n + import android . widget . TextView ; \n + import com . google . samples . apps . iosched . R ; \n + @ Override \n + public void onResume ( ) { \n + super . onResume ( ) ; \n + TextView titleTV = ( TextView ) getActivity ( ) . findViewById ( R . id . title ) ; \n + \n + if ( titleTV ! = null ) { \n + / / Set activity to fragment title text view and fire accessibility event so the title \n + / / gets read by talkback service . \n + mActivity . setTitle ( titleTV . getText ( ) ) ; \n + mActivity . getWindow ( ) . getDecorView ( ) \n + . sendAccessibilityEvent ( AccessibilityEvent . TYPE _ WINDOW _ STATE _ CHANGED ) ; \n + } \n + } \n + \n android \ src \ main \ res \ layout \ welcome _ account _ fragment . xml \n + android : id = "" @ + id / title "" \n android \ src \ main \ res \ layout \ welcome _ attending _ fragment . xml \n + android : id = "" @ + id / title "" \n android \ src \ main \ res \ layout \ welcome _ conduct _ fragment . xml \n + android : id = "" @ + id / title "" \n android \ src \ main \ res \ layout \ welcome _ tos _ fragment . xml \n + android : id = "" @ + id / title "" \n android \ src \ main \ res \ values \ styles . xml \n + < ! - - The activity title is set to string used for the welcome title , so to avoid the text \n + being repeated as the user selects the next item , it is removed from accessibility - - > \n + < item name = "" android : importantForAccessibility "" > no < / item > \n",Added title to screens for accessibility in onboarding flow \n Bug : # 28074658 \n Change - Id : Ia9b63b109dff897e1d66ec751b2f7da6d7c4aed8,354
"android \ proguard - project . txt \n - keepattributes InnerClasses , EnclosingMethod \n + # Keep app compat vector animation class \n + - keep class android . support . graphics . drawable . VectorDrawableCompat \n + - keep class android . support . graphics . drawable . VectorDrawableCompat $ * { \n + * ; \n + } \n + \n - keep class com . android . * * \n - keep class com . google . android . * * \n",Fixed issue of proguard removing some classes needed on API21 / 22 for aimation on sessions details screen \n Bug : # 28458469 \n Change - Id : Ia0ca2090cc4ffd81ab802913cc43b336360d8b47,354
android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ login \ BaseActivity _ ActiveAccountSuccessfulLoginTest . java \n + import org . junit . After ; \n + @ After \n + public void cleanUp ( ) { \n + LoginAndAuthProvider . setStubLoginAndAuth ( null ) ; \n + } \n + \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ login \ BaseActivity _ ActiveAccountUnsuccessfulLoginTest . java \n + import org . junit . After ; \n + @ After \n + public void cleanUp ( ) { \n + LoginAndAuthProvider . setStubLoginAndAuth ( null ) ; \n + } \n + \n,Added cleaning up after login tests which were making other tests fail \n Bug : # 28206404 \n Change - Id : I12fa2449ec7400d29910180f29badc0decdd43de,354
"android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ social \ SocialActivityTest . java \n + import android . provider . Settings ; \n + import android . support . test . filters . SdkSuppress ; \n + / * * \n + * The test will fail on API < 17 , due to the looping animation . On API 17 + , the activity checks \n + * the settings for { @ link Settings . Global # ANIMATOR _ DURATION _ SCALE } and doesn ' t run the \n + * animation if it is turned off . \n + * / \n + @ SdkSuppress ( minSdkVersion = 17 ) \n + / * * \n + * The test will fail on API < 17 , due to the looping animation . On API 17 + , the activity checks \n + * the settings for { @ link Settings . Global # ANIMATOR _ DURATION _ SCALE } and doesn ' t run the \n + * animation if it is turned off . \n + * / \n + @ SdkSuppress ( minSdkVersion = 17 ) \n android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ social \ SocialFragment . java \n - import android . annotation . TargetApi ; \n - import android . graphics . drawable . AnimatedVectorDrawable ; \n - import android . os . Build ; \n + import com . google . samples . apps . iosched . social . SocialModel . SocialLinksEnum ; \n - import com . google . samples . apps . iosched . social . SocialModel . SocialLinksEnum ; \n - \n - logo . start ( ) ; \n + if ( UIUtils . animationEnabled ( getActivity ( ) . getContentResolver ( ) ) ) { \n + logo . start ( ) ; \n + } \n","Added check for enabled animation on social screen , amended UI tests to be run on API17 + only \n Bug : # 28369715 \n Change - Id : I1a975adece489890cfd365a0443cf23b1be1dbbc",354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ explore \ SessionsAdapter . java \n - import android . support . v4 . util . Pair ; \n - private \n - SessionViewHolder createSessionViewHolder ( final ViewGroup parent ) { \n + private SessionViewHolder createSessionViewHolder ( final ViewGroup parent ) { \n,Fixed annotation order for method \n Bug : # 28188961 \n Change - Id : I9ee24faade677e3e76cd1655eb4ae97add2e62ac,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ navigation \ AppNavigationViewAsDrawerImpl . java \n - mDrawerLayout . closeDrawer ( GravityCompat . START ) ; \n + / / The navigation menu is accessible from some screens , via swiping , without a drawer \n + / / layout , eg MapActivity when accessed from SessionDetailsActivity . \n + if ( mDrawerLayout ! = null ) { \n + mDrawerLayout . closeDrawer ( GravityCompat . START ) ; \n + } \n",Fixed crash when selecting navigation item from map activity when map was accessed from sessions details \n Bug : # 28619626 \n Change - Id : Id3c5a74be7cdb5470579dd55725e24e1822abe8d,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ BaseActivity . java \n - / * * \n - * Converts an intent and a { @ link Bundle } into a { @ link Bundle } suitable for use as fragment \n - * arguments . \n - * / \n - public static Bundle intentToFragmentArguments ( Intent intent , Bundle extras ) { \n - Bundle arguments = new Bundle ( ) ; \n - if ( intent = = null ) { \n - return arguments ; \n - } \n - \n - final Uri data = intent . getData ( ) ; \n - if ( data ! = null ) { \n - arguments . putParcelable ( "" _ uri "" , data ) ; \n - } \n - \n - if ( extras ! = null ) { \n - arguments . putAll ( intent . getExtras ( ) ) ; \n - } \n - \n - return arguments ; \n - } \n - \n - / * * \n - * Converts a fragment arguments bundle into an intent . \n - * / \n - public static Intent fragmentArgumentsToIntent ( Bundle arguments ) { \n - Intent intent = new Intent ( ) ; \n - if ( arguments = = null ) { \n - return intent ; \n - } \n - \n - final Uri data = arguments . getParcelable ( "" _ uri "" ) ; \n - if ( data ! = null ) { \n - intent . setData ( data ) ; \n - } \n - \n - intent . putExtras ( arguments ) ; \n - intent . removeExtra ( "" _ uri "" ) ; \n - return intent ; \n - } \n - \n - private void promptAddAccount ( ) { \n - Intent intent = new Intent ( Settings . ACTION _ ADD _ ACCOUNT ) ; \n - intent . putExtra ( Settings . EXTRA _ ACCOUNT _ TYPES , new String [ ] { "" com . google "" } ) ; \n - startActivity ( intent ) ; \n - finish ( ) ; \n - } \n - \n",Removed unused methods in BaseActivity \n Change - Id : I9e978c3a603f3e5f9812ffb25ae4dbc9fb330ed5,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ AccountUtils . java \n - public static boolean setActiveAccount ( final Context context , final String accountName ) { \n + public static void setActiveAccount ( final Context context , final String accountName ) { \n - return true ; \n",Changed useless return type to void \n Change - Id : I091ff68a7966e9c7ac137a5341874bc1d2917912,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ explore \ data \ SessionData . java \n - import com . google . samples . apps . iosched . util . TimeUtils ; \n - \n + import com . google . samples . apps . iosched . util . TimeUtils ; \n + \n - if ( mStartDate . before ( now . getTime ( ) ) & & mEndDate . after ( now . getTime ( ) ) ) { \n - return true ; \n - } else { \n - return false ; \n - } \n + return mStartDate . before ( now . getTime ( ) ) & & mEndDate . after ( now . getTime ( ) ) ; \n,Removed useless if statement \n Change - Id : I3c679a971cef48c9a820b5eacd6d9923606dc542,354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ explore \ ExploreIOModel . java \n - * < p / > \n - * The process of loading and reading the data is typically done in the lifecycle of a { @ link \n - * com . google . samples . apps . iosched . framework . PresenterFragmentImpl } . \n,Removed outdated javadoc for Model class \n Change - Id : Ie5c829c845ea9b86d65bb83c414a8d0e11c6c71d,354
build . gradle \n - classpath ' com . android . tools . build : gradle : 2 . 0 . 0 - beta6 ' \n + classpath ' com . android . tools . build : gradle : 2 . 0 . 0 - rc3 ' \n,Updated gradle plugin \n Change - Id : I7a2be67cc90335c60e2494c66e606af38c686fef,354
"android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ login \ StubLoginAndAuth . java \n - h . postDelayed ( r , 50 ) ; \n + h . postDelayed ( r , 0 ) ; \n",Removed the initial delay in the stub login and auth \n Change - Id : I625cb6f0dc88739a087c38429798023543bc5f32,354
"android \ build . gradle \n - buildConfigField ( "" boolean "" , "" ENABLE _ SOCIAL _ IN _ NAVIGATION "" , "" true "" ) \n + buildConfigField ( "" boolean "" , "" ENABLE _ SOCIAL _ IN _ NAVIGATION "" , "" false "" ) \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ navigation \ AppNavigationViewAsDrawerImpl _ LoggedInAttendingTest . java \n - public void social _ WhenClicked _ ActivityDisplayed ( ) { \n - NavigationUtils . clickOnNavigationItemAndCheckActivityIsDisplayed ( \n - R . string . navdrawer _ item _ social , \n - R . string . title _ activity _ new _ social ) ; \n + public void social _ NotDisplayed ( ) { \n + NavigationUtils . checkNavigationItemIsNotDisplayed ( R . string . navdrawer _ item _ social ) ; \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ navigation \ AppNavigationViewAsDrawerImpl _ LoggedInRemoteTest . java \n - public void social _ WhenClicked _ ActivityDisplayed ( ) { \n - NavigationUtils . clickOnNavigationItemAndCheckActivityIsDisplayed ( \n - R . string . navdrawer _ item _ social , \n - R . string . title _ activity _ new _ social ) ; \n + public void social _ NotDisplayed ( ) { \n + NavigationUtils . checkNavigationItemIsNotDisplayed ( R . string . navdrawer _ item _ social ) ; \n android \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ social \ SocialActivityTest . java \n - import com . google . samples . apps . iosched . navigation . NavigationModel ; \n - @ Test \n - public void navigation _ WhenShown _ CorrectItemIsSelected ( ) { \n - NavigationUtils . checkNavigationItemIsSelected ( NavigationModel . NavigationItemEnum . SOCIAL ) ; \n - } \n android \ src \ main \ res \ menu \ drawer _ items . xml \n - < / group > \n - < group \n - android : id = "" @ + id / grp2 "" \n - android : checkableBehavior = "" single "" > \n - android : id = "" @ + id / grp3 "" \n + android : id = "" @ + id / grp2 "" \n",Disabled Social feature \n Bug : # 28077275 \n Change - Id : I40ef0d447c1996fb84b37945c20b60d92a39d110,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ BaseActivity . java \n - private boolean mManualSyncRequest ; \n - \n - mManualSyncRequest = true ; \n - mManualSyncRequest = false ; \n - boolean syncPending = ContentResolver . isSyncPending ( \n - account , ScheduleContract . CONTENT _ AUTHORITY ) ; \n - if ( ! syncActive & & ! syncPending ) { \n - mManualSyncRequest = false ; \n - } \n - onRefreshingStateChanged ( syncActive | | mManualSyncRequest ) ; \n + onRefreshingStateChanged ( syncActive ) ; \n",Fixed problem with swipe refresh progress display after manual sync \n Bug : # 28063216 \n Change - Id : I251f6ddcfd95a56c049ccb56a17703a425e054e0,354
"android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ myschedule \ MyScheduleModel . java \n - import android . content . Intent ; \n - import com . google . samples . apps . iosched . feedback . SessionFeedbackActivity ; \n + import static com . google . samples . apps . iosched . util . LogUtils . LOGE ; \n - mScheduleDataQueryCallback . onModelUpdated ( MyScheduleModel . this , \n - MyScheduleQueryEnum . SCHEDULE ) ; \n + / / mPrefChangeListener is observing as soon as the model is created but \n + / / mScheduleDataQueryCallback is only created when the view has requested \n + / / some data . There is a tiny amount of time when mPrefChangeListener is \n + / / active but mScheduleDataQueryCallback is null . This was observed when \n + / / going to MySchedule screen straight after the welcome flow . \n + if ( mScheduleDataQueryCallback ! = null ) { \n + mScheduleDataQueryCallback . onModelUpdated ( MyScheduleModel . this , \n + MyScheduleQueryEnum . SCHEDULE ) ; \n + } else { \n + LOGE ( TAG , "" sharedpreferences key "" + key + \n + "" changed , but null schedule data query callback , cannot "" + \n + "" inform model is updated "" ) ; \n + } \n","Fix for NPE at first app launch , when opening MySchedule first then going to Settings \n Bug : # 28062577 \n Change - Id : I8980880f1fa34b628c5c8b264da3ee835f677374",354
android \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ AppApplication . java \n - import android . app . Application ; \n + import android . content . Context ; \n + import android . support . multidex . MultiDexApplication ; \n - public class AppApplication extends Application { \n + public class AppApplication extends MultiDexApplication { \n - MultiDex . install ( this ) ; \n + \n + @ Override \n + protected void attachBaseContext ( Context base ) { \n + super . attachBaseContext ( base ) ; \n + MultiDex . install ( this ) ; \n + } \n,Fix for multidex crash on Dalvik \n Change - Id : I78800682b0b52ddeefb44e6ea780e9d3c96dd0d4,354
"presto - main \ src \ main \ java \ com \ facebook \ presto \ memory \ DefaultQueryContext . java \n - verify ( future . isDone ( ) , "" future should be done "" ) ; \n + / / When delta = = 0 and the pool is full the future can still not be done , \n + / / but , for negative deltas it must always be done . \n + if ( delta < 0 ) { \n + verify ( future . isDone ( ) , "" future should be done "" ) ; \n + } \n presto - main \ src \ main \ java \ com \ facebook \ presto \ memory \ LegacyQueryContext . java \n - verify ( future . isDone ( ) , "" future should be done "" ) ; \n + / / When delta = = 0 and the pool is full the future can still not be done , \n + / / but , for negative deltas it must always be done . \n + if ( delta < 0 ) { \n + verify ( future . isDone ( ) , "" future should be done "" ) ; \n + } \n presto - main \ src \ test \ java \ com \ facebook \ presto \ memory \ TestMemoryTracking . java \n + @ Test \n + public void testTrySetZeroBytesFullPool ( ) \n + { \n + LocalMemoryContext localMemoryContext = operatorContext . localUserMemoryContext ( ) ; \n + / / fill up the pool \n + memoryPool . reserve ( new QueryId ( "" test _ query "" ) , "" test "" , memoryPool . getFreeBytes ( ) ) ; \n + / / try to reserve 0 bytes in the full pool \n + assertTrue ( localMemoryContext . trySetBytes ( localMemoryContext . getBytes ( ) ) ) ; \n + } \n + \n","Fix assertion in tryUpdateUserMemory method \n When DefaultQueryContext : : tryUpdateUserMemory ( ) is called with a delta \n of 0 and when the general pool is full , the updateUserMemory call will \n return a future that ' s not done . However , tryUpdateUserMemory was simply \n assuming that for that case the future must be done and asserting on \n that , which causes query failures . This change fixes that . \n It makes sense for updateUserMemory to return a future that ' s not done \n when we reserve 0 bytes and the pool is full , so that the caller knows \n that the pool is full and waits on that future to make the next \n reservation . Therefore , for the delta = = 0 case it ' s not correct to \n simply assume that future returned from updateUserMemory is done .",361
"presto - main \ src \ test \ java \ com \ facebook \ presto \ operator \ TestColumnarPageProcessor . java \n + import org . testng . annotations . BeforeMethod ; \n - private final PageProcessor processor = new ExpressionCompiler ( metadata , new PageFunctionCompiler ( metadata , 0 ) ) \n - . compilePageProcessor ( Optional . empty ( ) , ImmutableList . of ( field ( 0 , types . get ( 0 ) ) , field ( 1 , types . get ( 1 ) ) ) , MAX _ BATCH _ SIZE ) . get ( ) ; \n + private PageProcessor processor ; \n + \n + @ BeforeMethod \n + public void setUp ( ) \n + { \n + processor = new ExpressionCompiler ( metadata , new PageFunctionCompiler ( metadata , 0 ) ) \n + . compilePageProcessor ( Optional . empty ( ) , ImmutableList . of ( field ( 0 , types . get ( 0 ) ) , field ( 1 , types . get ( 1 ) ) ) , MAX _ BATCH _ SIZE ) . get ( ) ; \n + } \n",Fix TestColumnarPageProcessor \n When TestColumnarPageProcessor test methods run concurrently it ' s \n possible to see test failures due to the exception below as multiple \n threads will be sharing the PageProcessor instance ( hence the \n ExpressionProfiler instance ) . This change fixes that by creating a new \n PageProcessor for each test method . \n com . google . common . base . VerifyException : start ( ) is not called \n at com . google . common . base . Verify . verify ( Verify . java : 123 ) \n at com . facebook . presto . sql . gen . ExpressionProfiler . stop ( ExpressionProfiler . java : 59 ),361
pom . xml \n - < dep . airlift . version > 0 . 176 < / dep . airlift . version > \n + < dep . airlift . version > 0 . 177 < / dep . airlift . version > \n,"Update to Airlift 0 . 177 \n Updates to Jetty 9 . 4 . 14 . v20181114 , which includes a fix for HTTP / 2 max \n concurrent streams enforcement .",361
"presto - tests \ src \ main \ java \ com \ facebook \ presto \ tests \ TestingPrestoClient . java \n - import com . facebook . presto . spi . type . TimeZoneKey ; \n - return new MaterializedResultSession ( session ) ; \n + return new MaterializedResultSession ( ) ; \n - private final TimeZoneKey timeZoneKey ; \n - \n - private MaterializedResultSession ( Session session ) \n - { \n - this . timeZoneKey = session . getTimeZoneKey ( ) ; \n - } \n - \n - rows . addAll ( transform ( data . getData ( ) , dataToRow ( timeZoneKey , types . get ( ) ) ) ) ; \n + rows . addAll ( transform ( data . getData ( ) , dataToRow ( types . get ( ) ) ) ) ; \n - private static Function < List < Object > , MaterializedRow > dataToRow ( final TimeZoneKey timeZoneKey , final List < Type > types ) \n + private static Function < List < Object > , MaterializedRow > dataToRow ( final List < Type > types ) \n - row . add ( convertToRowValue ( type , value , timeZoneKey ) ) ; \n + row . add ( convertToRowValue ( type , value ) ) ; \n - private static Object convertToRowValue ( Type type , Object value , TimeZoneKey timeZoneKey ) \n + private static Object convertToRowValue ( Type type , Object value ) \n - . map ( element - > convertToRowValue ( ( ( ArrayType ) type ) . getElementType ( ) , element , timeZoneKey ) ) \n + . map ( element - > convertToRowValue ( ( ( ArrayType ) type ) . getElementType ( ) , element ) ) \n - e - > convertToRowValue ( ( ( MapType ) type ) . getKeyType ( ) , e . getKey ( ) , timeZoneKey ) , \n - e - > convertToRowValue ( ( ( MapType ) type ) . getValueType ( ) , e . getValue ( ) , timeZoneKey ) ) ) ; \n + e - > convertToRowValue ( ( ( MapType ) type ) . getKeyType ( ) , e . getKey ( ) ) , \n + e - > convertToRowValue ( ( ( MapType ) type ) . getValueType ( ) , e . getValue ( ) ) ) ) ; \n",Remove unused parameter from TestingPrestoClient : : convertToRowValue,361
"presto - accumulo \ src \ main \ java \ com \ facebook \ presto \ accumulo \ metadata \ AccumuloTable . java \n - this . external = requireNonNull ( external , "" external is null "" ) ; \n + this . external = external ; \n presto - accumulo \ src \ main \ java \ com \ facebook \ presto \ accumulo \ model \ AccumuloColumnConstraint . java \n - this . indexed = requireNonNull ( indexed , "" indexed is null "" ) ; \n + this . indexed = indexed ; \n presto - accumulo \ src \ main \ java \ com \ facebook \ presto \ accumulo \ model \ AccumuloColumnHandle . java \n - this . indexed = requireNonNull ( indexed , "" indexed is null "" ) ; \n + this . indexed = indexed ; \n presto - accumulo \ src \ main \ java \ com \ facebook \ presto \ accumulo \ model \ AccumuloTableHandle . java \n - this . external = requireNonNull ( external , "" external is null "" ) ; \n + this . external = external ; \n presto - blackhole \ src \ main \ java \ com \ facebook \ presto \ plugin \ blackhole \ BlackHoleSplit . java \n - this . rowsPerPage = requireNonNull ( rowsPerPage , "" rowsPerPage is null "" ) ; \n - this . pagesCount = requireNonNull ( pagesCount , "" pagesCount is null "" ) ; \n - this . fieldsLength = requireNonNull ( fieldsLength , "" fieldsLength is null "" ) ; \n + this . rowsPerPage = rowsPerPage ; \n + this . pagesCount = pagesCount ; \n + this . fieldsLength = fieldsLength ; \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ metastore \ file \ PermissionMetadata . java \n - this . grantOption = requireNonNull ( grantOption , "" grantOption is null "" ) ; \n + this . grantOption = grantOption ; \n presto - main \ src \ main \ java \ com \ facebook \ presto \ sql \ analyzer \ Field . java \n - requireNonNull ( aliased , "" aliased is null "" ) ; \n - requireNonNull ( aliased , "" aliased is null "" ) ; \n",Remove unnecessary null checks \n These null checks are against primitive values .,361
presto - kudu \ src \ main \ java \ com \ facebook \ presto \ kudu \ KuduModule . java \n - import com . google . inject . multibindings . MultibindingsScanner ; \n - install ( MultibindingsScanner . asModule ( ) ) ; \n - \n,Remove installation of MultibindingsScanner \n This module is deprecated and installing it is equivalent to installing \n an empty module .,361
"presto - base - jdbc \ src \ test \ java \ com \ facebook \ presto \ plugin \ jdbc \ TestJdbcClient . java \n - SchemaTableName schemaTableName = new SchemaTableName ( "" example "" , tableName ) ; \n + SchemaTableName schemaTableName = new SchemaTableName ( "" schema _ for _ create _ table _ tests "" , tableName ) ; \n - SchemaTableName schemaTableName = new SchemaTableName ( "" example "" , tableName ) ; \n + SchemaTableName schemaTableName = new SchemaTableName ( "" schema _ for _ create _ table _ tests "" , tableName ) ; \n presto - base - jdbc \ src \ test \ java \ com \ facebook \ presto \ plugin \ jdbc \ TestingDatabase . java \n + connection . createStatement ( ) . execute ( "" CREATE SCHEMA schema _ for _ create _ table _ tests "" ) ; \n","Fix flakiness of TestJdbcClient . testMetadata \n We see that this test occasionally fails with the stack below . Some unit \n tests in TestJdbcClient create tables in the example schema while the \n failing test enumarates the tables in the same schema , and asserts on \n the number of tables . Depending on how these runs are interleaved it ' s \n possible to get more tables than expected . \n This changes fixes that by making sure that tables are created in a \n different schema . \n java . lang . AssertionError : lists don ' t have the same size expected [ 3 ] but found [ 4 ] \n at org . testng . Assert . fail ( Assert . java : 94 ) \n at org . testng . Assert . failNotEquals ( Assert . java : 513 ) \n at org . testng . Assert . assertEqualsImpl ( Assert . java : 135 ) \n at org . testng . Assert . assertEquals ( Assert . java : 116 ) \n at org . testng . Assert . assertEquals ( Assert . java : 389 ) \n at org . testng . Assert . assertEquals ( Assert . java : 556 ) \n at org . testng . Assert . assertEquals ( Assert . java : 533 ) \n at com . facebook . presto . plugin . jdbc . TestJdbcClient . testMetadata ( TestJdbcClient . java : 79 ) \n at sun . reflect . NativeMethodAccessorImpl . invoke0 ( Native Method ) \n at sun . reflect . NativeMethodAccessorImpl . invoke ( NativeMethodAccessorImpl . java : 62 ) \n at sun . reflect . DelegatingMethodAccessorImpl . invoke ( DelegatingMethodAccessorImpl . java : 43 ) \n at java . lang . reflect . Method . invoke ( Method . java : 498 ) \n at org . testng . internal . MethodInvocationHelper . invokeMethod ( MethodInvocationHelper . java : 104 ) \n at org . testng . internal . Invoker . invokeMethod ( Invoker . java : 645 ) \n at org . testng . internal . Invoker . invokeTestMethod ( Invoker . java : 851 ) \n at org . testng . internal . Invoker . invokeTestMethods ( Invoker . java : 1177 ) \n at org . testng . internal . TestMethodWorker . invokeTestMethods ( TestMethodWorker . java : 129 ) \n at org . testng . internal . TestMethodWorker . run ( TestMethodWorker . java : 112 ) \n at java . util . concurrent . ThreadPoolExecutor . runWorker ( ThreadPoolExecutor . java : 1149 ) \n at java . util . concurrent . ThreadPoolExecutor $ Worker . run ( ThreadPoolExecutor . java : 624 ) \n at java . lang . Thread . run ( Thread . java : 748 )",361
"presto - docs \ src \ main \ sphinx \ admin \ properties . rst \n + ` ` query . low - memory - killer . policy ` ` \n + ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ \n + \n + * * * Type : * * ` ` string ` ` \n + * * * Default value : * * ` ` none ` ` \n + \n + The policy used for selecting the query to kill when the cluster is out of memory ( OOM ) . \n + This property can have one of the following values : ` ` none ` ` , ` ` total - reservation ` ` , \n + or ` ` total - reservation - on - blocked - nodes ` ` . ` ` none ` ` disables the cluster OOM killer . \n + The value of ` ` total - reservation ` ` configures a policy that kills the query with the largest \n + memory reservation across the cluster . The value of ` ` total - reservation - on - blocked - nodes ` ` \n + configures a policy that kills the query using the most memory on the workers that are out of memory ( blocked ) . \n + \n",Update properties reference to add oom killer policy,361
src \ clj \ clojure \ core . clj \n - ] \n + name - metadata ( meta name ) ] \n + ~ @ ( when name - metadata \n + ` ( ( . resetMeta ( clojure . lang . Namespace / find ' ~ name ) ~ name - metadata ) ) ) \n,CLJ - 130 : preserve metadata for AOT compiled namespaces \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ Namespace . java \n - if ( ns = = this ) \n + if ( ns = = this | | ( v instanceof Var & & ( ( Var ) v ) . ns = = RT . CLOJURE _ NS ) ) \n,CLJ - 1578 don ' t throw when a core Var replaces another Var to avoid breaking ns reloading \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - String basename = enclosingMethod ! = null ? \n - ( enclosingMethod . objx . name + "" $ "" ) \n - : / / "" clojure . fns . "" + \n - ( munge ( currentNS ( ) . name . name ) + "" $ "" ) ; \n - if ( RT . second ( form ) instanceof Symbol ) \n - name = ( ( Symbol ) RT . second ( form ) ) . name ; \n - String simpleName = name ! = null ? \n - ( munge ( name ) . replace ( "" . "" , "" _ DOT _ "" ) \n - + ( enclosingMethod ! = null ? "" _ _ "" + RT . nextID ( ) : "" "" ) ) \n - : ( "" fn "" \n - + "" _ _ "" + RT . nextID ( ) ) ; \n + \n + String basename = ( enclosingMethod ! = null ? \n + enclosingMethod . objx . name \n + : ( munge ( currentNS ( ) . name . name ) ) ) + "" $ "" ; \n + \n + Symbol nm = null ; \n + \n + if ( RT . second ( form ) instanceof Symbol ) { \n + nm = ( Symbol ) RT . second ( form ) ; \n + name = nm . name + "" _ _ "" + RT . nextID ( ) ; \n + } else { \n + if ( name = = null ) \n + name = "" fn _ _ "" + RT . nextID ( ) ; \n + else if ( enclosingMethod ! = null ) \n + name + = "" _ _ "" + RT . nextID ( ) ; \n + } \n + \n + String simpleName = munge ( name ) . replace ( "" . "" , "" _ DOT _ "" ) ; \n + \n - if ( RT . second ( form ) instanceof Symbol ) \n + if ( nm ! = null ) \n - Symbol nm = ( Symbol ) RT . second ( form ) ; \n",Fix CLJ - 1330 : make top - level named functions classnames don ' t clash with def ' ed function classnames \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - String basename = enclosingMethod ! = null ? \n - ( enclosingMethod . objx . name + "" $ "" ) \n - : / / "" clojure . fns . "" + \n - ( munge ( currentNS ( ) . name . name ) + "" $ "" ) ; \n - if ( RT . second ( form ) instanceof Symbol ) \n - name = ( ( Symbol ) RT . second ( form ) ) . name ; \n - String simpleName = name ! = null ? \n - ( munge ( name ) . replace ( "" . "" , "" _ DOT _ "" ) \n - + ( enclosingMethod ! = null ? "" _ _ "" + RT . nextID ( ) : "" "" ) ) \n - : ( "" fn "" \n - + "" _ _ "" + RT . nextID ( ) ) ; \n + \n + String basename = ( enclosingMethod ! = null ? \n + enclosingMethod . objx . name \n + : ( munge ( currentNS ( ) . name . name ) ) ) + "" $ "" ; \n + \n + Symbol nm = null ; \n + \n + if ( RT . second ( form ) instanceof Symbol ) { \n + nm = ( Symbol ) RT . second ( form ) ; \n + if ( name = = null ) \n + name = nm . name + "" _ _ "" + RT . nextID ( ) ; \n + else \n + name + = "" _ _ "" + nm . name + "" _ _ "" + RT . nextID ( ) ; \n + } else { \n + if ( name = = null ) \n + name = "" fn _ _ "" + RT . nextID ( ) ; \n + else if ( enclosingMethod ! = null ) \n + name + = "" _ _ "" + RT . nextID ( ) ; \n + } \n + \n + String simpleName = munge ( name ) . replace ( "" . "" , "" _ DOT _ "" ) ; \n + \n - if ( RT . second ( form ) instanceof Symbol ) \n + if ( nm ! = null ) \n - Symbol nm = ( Symbol ) RT . second ( form ) ; \n",Fix CLJ - 1330 : make top - level named functions classnames don ' t clash with def ' ed function classnames \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ clj \ clojure \ core . clj \n - new - params [ ] \n + new - params ( with - meta [ ] ( meta params ) ) \n,"don ' t remove meta from arg vector in maybe - destructured , fixes CLJ - 887 \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",368
"src \ clj \ clojure \ core . clj \n + ( defn - already - compiled ? [ lib ] \n + ( let [ path ( subs ( root - resource lib ) 1 ) \n + clj - path ( str path "" . clj "" ) \n + class - path ( str path "" _ _ init . class "" ) \n + loader ( clojure . lang . RT / baseLoader ) \n + compiled - file ( java . io . File . ( str * compile - path * "" / "" class - path ) ) \n + clj - url ( . getResource loader clj - path ) ] \n + ( or ( and ( . exists compiled - file ) \n + ( or ( nil ? clj - url ) \n + ( > ( clojure . lang . RT / lastModified ( - > compiled - file . toURI . toURL ) class - path ) \n + ( clojure . lang . RT / lastModified clj - url clj - path ) ) ) ) \n + ( . getResource loader class - path ) ) ) ) \n + \n - loaded ( contains ? @ * loaded - libs * lib ) \n + loaded ( and ( contains ? @ * loaded - libs * lib ) \n + ( or ( not * compile - files * ) \n + ( already - compiled ? lib ) ) ) \n",CLJ - 1544 force reloading of namespaces during AOT compilation \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ LazyTransformer . java \n - return equals ( o ) ; \n - } \n + if ( this = = o ) \n + return true ; \n + if ( ! ( o instanceof Sequential | | o instanceof List ) ) \n + return false ; \n + ISeq ms = RT . seq ( o ) ; \n + for ( ISeq s = seq ( ) ; s ! = null ; s = s . next ( ) , ms = ms . next ( ) ) \n + { \n + if ( ms = = null | | ! Util . equiv ( s . first ( ) , ms . first ( ) ) ) \n + return false ; \n + } \n + return ms = = null ; } \n - ISeq s = seq ( ) ; \n - if ( s ! = null ) \n - return s . equiv ( o ) ; \n - else \n - return ( o instanceof Sequential | | o instanceof List ) & & RT . seq ( o ) = = null ; \n + if ( this = = o ) \n + return true ; \n + if ( ! ( o instanceof Sequential | | o instanceof List ) ) \n + return false ; \n + ISeq ms = RT . seq ( o ) ; \n + for ( ISeq s = seq ( ) ; s ! = null ; s = s . next ( ) , ms = ms . next ( ) ) \n + { \n + if ( ms = = null | | ! Util . equals ( s . first ( ) , ms . first ( ) ) ) \n + return false ; \n + } \n + return ms = = null ; \n test \ clojure \ test _ clojure \ sequences . clj \n - ( map inc { } ) ( ) ) ) \n + ( map inc { } ) ( ) \n + ( sequence ( map inc ) ( range 10 ) ) ( range 1 11 ) \n + ( range 1 11 ) ( sequence ( map inc ) ( range 10 ) ) ) ) \n",provide working implementations for LazyTransform / equiv and Lazytransform / equals \n Signed - off - by : Rich Hickey < richhickey @ gmail . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - gen . checkCast ( Type . getType ( targetClass ) ) ; \n + gen . checkCast ( getType ( targetClass ) ) ; \n - gen . putField ( Type . getType ( targetClass ) , fieldName , Type . getType ( field . getType ( ) ) ) ; \n + gen . putField ( getType ( targetClass ) , fieldName , Type . getType ( field . getType ( ) ) ) ; \n test \ clojure \ test _ clojure \ java _ interop . clj \n + ( defprotocol p ( f [ _ ] ) ) \n + ( deftype t [ ^ : unsynchronized - mutable x ] p ( f [ _ ] ( set ! ( . x _ ) 1 ) ) ) \n + \n + ( deftest test - set ! \n + ( is ( = 1 ( f ( t . 1 ) ) ) ) ) \n + \n",CLJ - 1226 : fix set ! of instance field expression that refers to a deftype ' s ` this ` \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n + static void consumeWhitespaces ( LineNumberingPushbackReader pushbackReader ) { \n + int ch = LispReader . read1 ( pushbackReader ) ; \n + while ( LispReader . isWhitespace ( ch ) ) \n + ch = LispReader . read1 ( pushbackReader ) ; \n + LispReader . unread ( pushbackReader , ch ) ; \n + } \n + \n + consumeWhitespaces ( pushbackReader ) ; \n + consumeWhitespaces ( pushbackReader ) ; \n",CLJ - 1568 : fix incorrect error locations \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ clj \ clojure \ core \ protocols . clj \n - ( internal - reduce s f val ) ) \n + ( coll - reduce s f val ) ) \n - clojure . lang . ArraySeq \n - ( internal - reduce \n - [ a - seq f val ] \n - ( let [ ^ objects arr ( . array a - seq ) ] \n - ( loop [ i ( . index a - seq ) \n - val val ] \n - ( if ( < i ( alength arr ) ) \n - ( let [ ret ( f val ( aget arr i ) ) ] \n - ( if ( reduced ? ret ) \n - @ ret \n - ( recur ( inc i ) ret ) ) ) \n - val ) ) ) ) \n - \n - ( internal - reduce s f val ) ) \n + ( coll - reduce s f val ) ) \n - ( def arr - impl \n - ' ( internal - reduce \n - [ a - seq f val ] \n - ( let [ arr ( . array a - seq ) ] \n - ( loop [ i ( . index a - seq ) \n - val val ] \n - ( if ( < i ( alength arr ) ) \n - ( let [ ret ( f val ( aget arr i ) ) ] \n - ( if ( reduced ? ret ) \n - @ ret \n - ( recur ( inc i ) ret ) ) ) \n - val ) ) ) ) ) \n - \n - ( defn - emit - array - impls * \n - [ syms ] \n - ( apply \n - concat \n - ( map \n - ( fn [ s ] \n - [ ( symbol ( str "" clojure . lang . ArraySeq $ ArraySeq _ "" s ) ) \n - arr - impl ] ) \n - syms ) ) ) \n - \n - ( defmacro emit - array - impls \n - [ & syms ] \n - ` ( extend - protocol InternalReduce \n - ~ @ ( emit - array - impls * syms ) ) ) \n - \n - ( emit - array - impls int long float double byte char boolean ) \n - \n",cleanup internal - reduce impl \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n + public final boolean shadowsCoreMapping ; \n + final static Method internVar = Method . getMethod ( "" clojure . lang . Var refer ( clojure . lang . Symbol , clojure . lang . Var ) "" ) ; \n - public DefExpr ( String source , int line , int column , Var var , Expr init , Expr meta , boolean initProvided , boolean isDynamic ) { \n + public DefExpr ( String source , int line , int column , Var var , Expr init , Expr meta , boolean initProvided , boolean isDynamic , boolean shadowsCoreMapping ) { \n + this . shadowsCoreMapping = shadowsCoreMapping ; \n + \n + if ( shadowsCoreMapping ) \n + { \n + gen . dup ( ) ; \n + gen . getField ( VAR _ TYPE , "" ns "" , NS _ TYPE ) ; \n + gen . swap ( ) ; \n + gen . dup ( ) ; \n + gen . getField ( VAR _ TYPE , "" sym "" , SYMBOL _ TYPE ) ; \n + gen . swap ( ) ; \n + gen . invokeVirtual ( NS _ TYPE , internVar ) ; \n + } \n + \n + boolean shadowsCoreMapping = false ; \n + shadowsCoreMapping = true ; \n - meta , RT . count ( form ) = = 3 , isDynamic ) ; \n + meta , RT . count ( form ) = = 3 , isDynamic , shadowsCoreMapping ) ; \n",fix AOT bug preventing overriding of clojure . core functions \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ PersistentArrayMap . java \n - if ( array . length > HASHTABLE _ THRESHOLD ) \n + if ( array . length > = HASHTABLE _ THRESHOLD ) \n - if ( array . length > HASHTABLE _ THRESHOLD ) \n + if ( array . length > = HASHTABLE _ THRESHOLD ) \n,PersistentArrayMap ' s assoc doesn ' t respect HASHTABLE _ THRESHOLD \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ PersistentVector . java \n - throw new UnsupportedOperationException ( ) ; \n + Object init ; \n + if ( cnt > 0 ) \n + init = arrayFor ( 0 ) [ 0 ] ; \n + else \n + return f . invoke ( ) ; \n + int step = 0 ; \n + for ( int i = 0 ; i < cnt ; i + = step ) { \n + Object [ ] array = arrayFor ( i ) ; \n + for ( int j = ( i = = 0 ) ? 1 : 0 ; j < array . length ; + + j ) { \n + init = f . invoke ( init , array [ j ] ) ; \n + if ( RT . isReduced ( init ) ) \n + return ( ( IDeref ) init ) . deref ( ) ; \n + } \n + step = array . length ; \n + } \n + return init ; \n test \ clojure \ test _ clojure \ sequences . clj \n - ( : use clojure . test ) ) \n + ( : use clojure . test ) \n + ( : import clojure . lang . IReduce ) ) \n + ( . reduce ^ IReduce avec + ) \n + ( . reduce ^ IReduce avec + 1 ) \n",CLJ - 1619 : Implement no init arity of reduce for PersistentVector \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ DynamicClassLoader . java \n - c = getParent ( ) . loadClass ( name ) ; \n + c = super . loadClass ( name , false ) ; \n",CLJ - 1663 : delegate loadClass to super classloader before delegating to parent classloader \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n + public boolean used = false ; \n + b . used = true ; \n - gen . visitVarInsn ( OBJECT _ TYPE . getOpcode ( Opcodes . ISTORE ) , bi . binding . idx ) ; \n + if ( ! bi . binding . used & & bi . binding . canBeCleared ) \n + gen . pop ( ) ; \n + else \n + gen . visitVarInsn ( OBJECT _ TYPE . getOpcode ( Opcodes . ISTORE ) , bi . binding . idx ) ; \n",CLJ - 1744 : clear unused locals \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - RT . listStar ( Symbol . intern ( "" . invokePrim "" ) , \n - ( ( Symbol ) form . first ( ) ) . withMeta ( RT . map ( RT . TAG _ KEY , Symbol . intern ( primc ) ) ) , \n - form . next ( ) ) ) ; \n + ( ( IObj ) RT . listStar ( Symbol . intern ( "" . invokePrim "" ) , \n + ( ( Symbol ) form . first ( ) ) . withMeta ( RT . map ( RT . TAG _ KEY , Symbol . intern ( primc ) ) ) , \n + form . next ( ) ) ) . withMeta ( ( IPersistentMap ) RT . conj ( RT . meta ( v ) , RT . meta ( form ) ) ) ) ; \n test \ clojure \ test _ clojure \ compilation . clj \n + ( defn ^ { : tag ' long } hinted - primfn [ ^ long x ] x ) \n + ( defn unhinted - primfn [ ^ long x ] x ) \n + ( deftest CLJ - 1533 - primitive - functions - lose - tag \n + ( should - not - reflect # ( Math / abs ( clojure . test - clojure . compilation / hinted - primfn 1 ) ) ) \n + ( should - not - reflect # ( Math / abs ^ long ( clojure . test - clojure . compilation / unhinted - primfn 1 ) ) ) ) \n + \n + \n",CLJ - 1533 inject original var / form meta in constructed . invokePrim call \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ LispReader . java \n - if ( RT . suppressRead ( ) ) \n - return null ; \n - if ( RT . suppressRead ( ) ) { \n - read ( r , true , null , true , opts , pendingForms ) ; \n - return r ; \n - } \n - if ( isPreserveReadCond ( opts ) ) { \n + if ( isPreserveReadCond ( opts ) | | RT . suppressRead ( ) ) { \n test \ clojure \ test _ clojure \ reader . cljc \n - ( is ( thrown - with - msg ? RuntimeException # "" Conditional read not allowed "" ( read - string "" # ? [ : clj : a : default nil ] "" ) ) ) ) ) \n + ( is ( thrown - with - msg ? RuntimeException # "" Conditional read not allowed "" ( read - string "" # ? [ : clj : a : default nil ] "" ) ) ) ) \n + ( testing "" clj - 1698 - regression "" \n + ( let [ opts { : features # { : clj } : read - cond : allow } ] \n + ( is ( = 1 ( read - string opts "" # ? ( : cljs { ' a 1 ' b 2 } : clj 1 ) "" ) ) ) \n + ( is ( = 1 ( read - string opts "" # ? ( : cljs ( let [ { { b : b } : a { d : d } : c } { } ] ) : clj 1 ) "" ) ) ) \n + ( is ( = ' ( def m { } ) ( read - string opts "" ( def m # ? ( : cljs ^ { : a : b } { } : clj ^ { : a : b } { } ) ) "" ) ) ) \n + ( is ( = ' ( def m { } ) ( read - string opts "" ( def m # ? ( : cljs ^ { : a : b } { } : clj ^ { : a : b } { } ) ) "" ) ) ) \n + ( is ( = 1 ( read - string opts "" # ? ( : cljs { : a # _ : b : c } : clj 1 ) "" ) ) ) ) ) ) \n",CLJ - 1698 fix conditional reading bugs \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ clj \ clojure \ core . clj \n - : eof - on eof , return value unless : eofthrow , then throw \n + : eof - on eof , return value unless : eofthrow , then throw . \n + if not specified , will throw \n src \ jvm \ clojure \ lang \ LispReader . java \n - boolean eofIsError = false ; \n + boolean eofIsError = true ; \n - Object eof = ( ( IPersistentMap ) opts ) . containsKey ( OPT _ EOF ) ; \n - if ( EOFTHROW . equals ( eof ) ) \n - eofIsError = true ; \n - else { \n + Object eof = ( ( IPersistentMap ) opts ) . valAt ( OPT _ EOF , EOFTHROW ) ; \n + if ( ! EOFTHROW . equals ( eof ) ) { \n + eofIsError = false ; \n src \ jvm \ clojure \ lang \ RT . java \n - return LispReader . read ( r , true , null , false , opts ) ; \n + return LispReader . read ( r , opts ) ; \n test \ clojure \ test _ clojure \ reader . cljc \n + \n + ( deftest eof - option \n + ( is ( = 23 ( read - string { : eof 23 } "" "" ) ) ) \n + ( is ( = 23 ( read { : eof 23 } ( clojure . lang . LineNumberingPushbackReader . \n + ( java . io . StringReader . "" "" ) ) ) ) ) ) \n",CLJ - 1685 : correctly handle : eof option in read / read - string \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ PersistentList . java \n - for ( int i = argsarray . length - 1 ; i > = 0 ; - - i ) \n + for ( int i = argsarray . length - 1 ; i > = ( ( ArraySeq ) args ) . i ; - - i ) \n test \ clojure \ test _ clojure \ sequences . clj \n + \n + ( deftest CLJ - 1633 \n + ( is ( = ( ( fn [ & args ] ( apply ( fn [ a & b ] ( apply list b ) ) args ) ) 1 2 3 ) ' ( 2 3 ) ) ) ) \n,CLJ - 1633 : fix PersistentList / creator handling of ArraySeqs \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ Compiler . java \n + gen . checkCast ( Type . getType ( protocolOn ) ) ; \n,CLJ - 1790 : emit a cast to the interface during procol callsite emission or the jvm verifier will complain \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - if ( keywordCallsites . count ( ) > 0 ) \n - { \n - Method meth = Method . getMethod ( "" void swapThunk ( int , clojure . lang . ILookupThunk ) "" ) ; \n - \n - GeneratorAdapter gen = new GeneratorAdapter ( ACC _ PUBLIC , \n - meth , \n - null , \n - null , \n - cv ) ; \n - gen . visitCode ( ) ; \n - Label endLabel = gen . newLabel ( ) ; \n - \n - Label [ ] labels = new Label [ keywordCallsites . count ( ) ] ; \n - for ( int i = 0 ; i < keywordCallsites . count ( ) ; i + + ) \n - { \n - labels [ i ] = gen . newLabel ( ) ; \n - } \n - gen . loadArg ( 0 ) ; \n - gen . visitTableSwitchInsn ( 0 , keywordCallsites . count ( ) - 1 , endLabel , labels ) ; \n - \n - for ( int i = 0 ; i < keywordCallsites . count ( ) ; i + + ) \n - { \n - gen . mark ( labels [ i ] ) ; \n - / / gen . loadThis ( ) ; \n - gen . loadArg ( 1 ) ; \n - gen . putStatic ( objtype , thunkNameStatic ( i ) , ILOOKUP _ THUNK _ TYPE ) ; \n - gen . goTo ( endLabel ) ; \n - } \n - \n - gen . mark ( endLabel ) ; \n - \n - gen . returnValue ( ) ; \n - gen . endMethod ( ) ; \n - } \n - \n",CLJ - 1351 remove unused swapThunk method generation \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ Compiler . java \n - lb . idx - = 1 ; \n + if ( lb . isArg ) \n + lb . idx - = 1 ; \n - fm . maxLocal - = 1 ; \n test \ clojure \ test _ clojure \ compilation . clj \n + \n + ( deftest clj - 1809 \n + ( is ( eval ` ( fn [ y # ] \n + ( try \n + ( finally \n + ( let [ z # y # ] ) ) ) ) ) ) ) \n,CLJ - 1809 fix local indexing error in direct linking \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ SeqIterator . java \n - static Object START = new Object ( ) ; \n + static final Object START = new Object ( ) ; \n - seq = this ; \n + seq = START ; \n - seq = this ; \n + seq = START ; \n - if ( seq = = this ) { \n - seq = START ; \n + if ( seq = = START ) { \n + seq = null ; \n,CLJ - 1636 : don ' t use this as a sentinel in SeqIterator \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n + Object mform = form ; \n + form = ( ( IObj ) form ) . withMeta ( RT . meta ( mform ) ) ; \n test \ clojure \ test _ clojure \ compilation . clj \n + \n + ( deftest CLJ - 1586 - lazyseq - literals - preserve - metadata \n + ( should - not - reflect ( eval ( list ' . substring ( with - meta ( concat ' ( identity ) ' ( "" foo "" ) ) { : tag ' String } ) 0 ) ) ) ) \n",CLJ - 1586 : Compiler doesn ' t preserve metadata for lazyseq literals \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ clj \ clojure \ core _ deftype . clj \n - \n - Currently there are no options . \n + \n + Options are expressed as sequential keywords and arguments ( in any order ) . \n + \n + Supported options : \n + : load - ns - if true , importing the record class will cause the \n + namespace in which the record was defined to be loaded . \n + Defaults to false . \n - \n - Currently there are no options . \n + \n + Options are expressed as sequential keywords and arguments ( in any order ) . \n + \n + Supported options : \n + : load - ns - if true , importing the record class will cause the \n + namespace in which the record was defined to be loaded . \n + Defaults to false . \n","CLJ - 1823 : document : load - ns option to deftype / defrecord , see CLJ - 1208 \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",368
src \ clj \ clojure \ core . clj \n - m ) ] \n + m ) \n + mm - name ( with - meta mm - name m ) ] \n - ( def ~ ( with - meta mm - name m ) \n + ( def ~ mm - name \n,CLJ - 1870 : don ' t destroy defmulti metadata on reload \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - return RT . classForName ( sym . name ) ; \n + try { \n + return RT . classForName ( sym . name ) ; \n + } catch ( Exception e ) { \n + if ( e instanceof ClassNotFoundException ) \n + return null ; \n + else \n + return Util . sneakyThrow ( e ) ; \n + } \n test \ clojure \ test _ clojure \ compilation . clj \n - ( is ( nil ? ( resolve ' NonExistentClass . ) ) ) ) ) \n + ( is ( nil ? ( resolve ' NonExistentClass . ) ) ) ) \n + ( testing "" resolve nonexistent class should return nil "" \n + ( is ( nil ? ( resolve ' NonExistentClass . Name ) ) ) ) ) \n",CLJ - 1403 : ns - resolve returns nil if class is not found \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ jvm \ clojure \ lang \ PersistentTreeMap . java \n + public boolean equals ( Object obj ) { \n + try { \n + return super . equals ( obj ) ; \n + } catch ( ClassCastException e ) { \n + return false ; \n + } \n + } \n + \n + public boolean equiv ( Object obj ) { \n + try { \n + return super . equiv ( obj ) ; \n + } catch ( ClassCastException e ) { \n + return false ; \n + } \n + } \n + \n src \ jvm \ clojure \ lang \ PersistentTreeSet . java \n + public boolean equals ( Object obj ) { \n + try { \n + return super . equals ( obj ) ; \n + } catch ( ClassCastException e ) { \n + return false ; \n + } \n + } \n + \n + public boolean equiv ( Object obj ) { \n + try { \n + return super . equiv ( obj ) ; \n + } catch ( ClassCastException e ) { \n + return false ; \n + } \n + } \n + \n test \ clojure \ test _ clojure \ data _ structures . clj \n + ( is ( not = ( sorted - set : a ) ( sorted - set 1 ) ) ) \n + \n,CLJ - 1242 : equals doesn ' t throw on sorted collections \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
src \ clj \ clojure \ core \ specs . clj \n - : prepost ( s / ? map ? ) \n - : body ( s / * any ? ) ) ) \n + : body ( s / alt : prepost + body ( s / cat : prepost map ? \n + : body ( s / + any ? ) ) \n + : body ( s / * any ? ) ) ) ) \n,CLJ - 2144 : conform map fn bodies as : body rather than as : prepost \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ DynamicClassLoader . java \n + void installPackage ( String className ) { \n + int offset = className . lastIndexOf ( ' . ' ) ; \n + if ( offset ! = - 1 ) \n + { \n + String pkgname = className . substring ( 0 , offset ) ; \n + if ( getPackage ( pkgname ) = = null ) \n + definePackage ( pkgname , null , null , null , null , null , null , null ) ; \n + } \n + } \n + \n + installPackage ( name ) ; \n test \ clojure \ test _ clojure \ compilation . clj \n + ( deftest CLJ - 1550 - dcl - package \n + ( let [ pkg ( . getPackage clojure . test _ clojure . compilation . load _ ns . x ) ] \n + ( is ( = "" clojure . test _ clojure . compilation . load _ ns "" ( and pkg ( . getName pkg ) ) ) ) ) ) \n + \n",CLJ - 1550 : define package for class in DynamicClassLoader,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - gen . invokeStatic ( type , m ) ; \n + gen . visitMethodInsn ( INVOKESTATIC , type . getInternalName ( ) , methodName , m . getDescriptor ( ) , c . isInterface ( ) ) ; \n test \ clojure \ test _ clojure \ compilation . clj \n - ( is ( = "" test "" ( compilation . JDK8InterfaceMethods / staticMethod1 "" test "" ) ) ) ) ) \n + ( is ( = "" test "" ( compilation . JDK8InterfaceMethods / staticMethod1 "" test "" ) ) ) \n + ( is ( = 1 ( if ( compilation . JDK8InterfaceMethods / staticMethod2 true ) 1 2 ) ) ) ) ) \n test \ java \ compilation \ JDK8InterfaceMethods . java \n + public static boolean staticMethod2 ( boolean b ) { return b ; } \n",CLJ - 2517 : Backport CLJ - 2284 fix for primitive path \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"src \ jvm \ clojure \ lang \ Compiler . java \n - else if ( v instanceof IPersistentCollection & & ( ( IPersistentCollection ) v ) . count ( ) = = 0 ) \n + else if ( v instanceof IPersistentCollection \n + & & ( ( ( IPersistentCollection ) v ) . count ( ) = = 0 ) \n + & & ( ! ( v instanceof IObj ) | | ( ( IObj ) v ) . meta ( ) = = null ) ) \n test \ clojure \ test _ clojure \ metadata . clj \n + ( testing "" const vars preserve metadata "" \n + ( let [ [ v1 v2 ] ( eval - in - temp - ns \n + ( def ^ : const foo ^ : foo [ ] ) \n + ( def ^ : const bar ^ : foo [ : bar ] ) \n + [ ( meta foo ) ( meta bar ) ] ) ] \n + ( is ( = { : foo true } v1 ) ) \n + ( is ( = { : foo true } v2 ) ) ) ) \n",CLJ - 1187 Support retrieval of metadata from quoted empty literals \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >,368
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 10 _ histogram . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : fixed in 8 . 0 to be backported to 7 . 11 \n + version : "" - 7 . 10 . 99 "" \n + reason : fixed in 7 . 11 \n - do : \n",Update skip after backport ( # 66024 ) \n After backporting # 65707 we can now run it in our backwards \n compatibility tests .,371
"x - pack \ plugin \ ml \ src \ main \ java \ org \ elasticsearch \ xpack \ ml \ utils \ persistence \ ResultsPersisterService . java \n + client , \n + / / Pass the client to work around https : / / bugs . eclipse . org / bugs / show _ bug . cgi ? id = 569557 \n + OriginSettingClient client , \n","Fix eclipse compilation ( # 66047 ) \n Looks like we ' ve hit another "" funny "" eclipse compiler error . I filed \n https : / / bugs . eclipse . org / bugs / show _ bug . cgi ? id = 569557 , but short version \n is that the following code compiles with javac and not eclipse : \n ` ` ` \n package test ; \n import java . util . function . Supplier ; \n public class Test { \n private final Object o = new Object ( ) ; \n private class Inner { \n public Inner ( ) { \n this ( ( ) - > o ) ; \n } \n private Inner ( Supplier < Object > o ) { } \n } \n } \n ` ` ` \n Specifically the outer class ' s ` o ` can ' t be refered to in the lambda . \n This stops us from doing that in ML so eclipse can be happy again .",371
"docs \ reference \ aggregations \ bucket \ variablewidthhistogram - aggregation . asciidoc \n + + + + \n - experimental : : [ "" This functionality is experimental and may be changed or removed completely in a future release . Elastic will take a best effort approach to fix any issues , but experimental features are not subject to the support SLA of official GA features . We ' re evaluating the request and response format for this new aggregation . "" , https : / / github . com / elastic / elasticsearch / issues / 58573 ] \n - \n",Drop experimental from variable width histogram ( # 66055 ) \n Its been several months and we haven ' t bumped into any good reason to \n rework the variable width histogram . So let ' s drop experimental from it ! \n Closes # 58573,371
"server \ src \ test \ java \ org \ elasticsearch \ search \ aggregations \ metrics \ HyperLogLogPlusPlusSparseTests . java \n - ByteSizeValue . ofBytes ( initialBucketCount * 16 ) , \n + ByteSizeValue . ofBytes ( Math . max ( 256 , initialBucketCount * 32 ) ) , \n",Give test a little more space \n In # 64744 I added a randomized test for how much room a part of the \n cardinality use in memory . It ' s bound were a little low . This gives it a \n few more bytes before it falls over so we don ' t see the test fail 1 % or \n 2 % of the time .,371
server \ src \ test \ java \ org \ elasticsearch \ action \ search \ SearchRequestTests . java \n + if ( version . before ( Version . V _ 8 _ 0 _ 0 ) & & searchRequest . source ( ) ! = null ) { \n + / / Versions before 8 . 0 . 0 don ' t support runtime mappings \n + searchRequest . source ( ) . runtimeMappings ( emptyMap ( ) ) ; \n + } \n,Fix buggy test \n In # 64374 I broke a test that serializes ` SearchRequest ` with a random \n version . I ' m unsure how we didn ' t catch this in the PR tests but \n computers are tricky . This fixes the test by removing runtime mappings \n for versions that don ' t support it .,371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 40 _ range . yml \n - - - \n + - skip : \n + version : "" - 7 . 99 . 99 "" \n + reason : Fixed in 8 . 0 . 0 to be backported to 7 . 10 . 0 \n + \n - do : \n",hush bwc tests \n Backport is coming . Please wait .,371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 40 _ range . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : Fixed in 8 . 0 . 0 to be backported to 7 . 10 . 0 \n + version : "" - 7 . 9 . 99 "" \n + reason : Fixed in 7 . 10 . 0 \n - do : \n",Update skip after backport ( # 64369 ) \n Now that # 64214 has landed in 7 . 10 we can run the bwc test including it .,371
"server \ src \ test \ java \ org \ elasticsearch \ common \ LocalTimeOffsetTests . java \n - assertKnownMovesBacktoPreviousDay ( "" Europe / Paris "" , "" 1911 - 03 - 1T00 : 01 : 00 "" ) ; \n","Drop old assertion in test \n Drops an assertion that in 1911 Paris rolled its clocks back past \n midnight . This assertion is so far in the past that it isn ' t \n consistently included in the JDK ' s tzdb . When we upgraded to 15 . 0 . 1 it \n fell out of my tzdb locally . It doesn ' t seem to have happened to CI , \n oddly , but it just doesn ' t seem worth keeping .",371
"build . gradle \n - boolean bwc _ tests _ enabled = false \n - final String bwc _ tests _ disabled _ issue = "" https : / / github . com / elastic / elasticsearch / pull / 64374 "" / * place a PR link here when committing bwc changes * / \n + boolean bwc _ tests _ enabled = true \n + final String bwc _ tests _ disabled _ issue = "" "" / * place a PR link here when committing bwc changes * / \n",Reenable bwc tests after backport ( # 64935 ) \n Now that # 64374 has been backported to 7 . x we can run the bwc tests \n again without wire incompatibilities .,371
"server \ src \ test \ java \ org \ elasticsearch \ search \ aggregations \ bucket \ range \ RangeAggregatorTests . java \n + import java . util . concurrent . TimeUnit ; \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 57651 "" ) \n - iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , milli1 ) ) ) ; \n - iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , milli2 ) ) ) ; \n + iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , TimeUnit . MILLISECONDS . toNanos ( milli1 ) ) ) ) ; \n + iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , TimeUnit . MILLISECONDS . toNanos ( milli2 ) ) ) ) ; \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 57651 "" ) \n - public void testMissingDateWithDateField ( ) throws IOException { \n + public void testMissingDateWithDateNanosField ( ) throws IOException { \n - iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , milli1 ) ) ) ; \n - iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , milli2 ) ) ) ; \n + iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , TimeUnit . MILLISECONDS . toNanos ( milli1 ) ) ) ) ; \n + iw . addDocument ( singleton ( new SortedNumericDocValuesField ( DATE _ FIELD _ NAME , TimeUnit . MILLISECONDS . toNanos ( milli2 ) ) ) ) ; \n",Fix range tests \n Some of the ` range ` agg tests thought that millis were nanos . Oops . \n Closes # 57651,371
"test \ framework \ src \ main \ java \ org \ elasticsearch \ test \ InternalAggregationTestCase . java \n - List < InternalAggregation > internalAggregations = toReduce . subList ( 0 , r ) ; \n + List < InternalAggregation > toPartialReduce = toReduce . subList ( 0 , r ) ; \n + / / Sort aggs so that unmapped come last . This mimicks the behavior of InternalAggregations . reduce ( ) \n + toPartialReduce . sort ( INTERNAL _ AGG _ COMPARATOR ) ; \n - T reduced = ( T ) inputs . get ( 0 ) . reduce ( internalAggregations , context ) ; \n + T reduced = ( T ) toPartialReduce . get ( 0 ) . reduce ( toPartialReduce , context ) ; \n - for ( InternalAggregation internalAggregation : internalAggregations ) { \n + for ( InternalAggregation internalAggregation : toPartialReduce ) { \n","Better mimick real reduction in test \n This changes has ` InternalAggregationTestCase ` performs partial \n reductions to better mimick ` InternalAggregations # reduce ` . In \n particular , this fixes a bug when we ' d attempt a partial reduction of \n aggregations that were entirely unmapped but use a mapped aggregation as \n the "" lead "" of the reduction . This was possible in the test but isn ' t \n possible in production . The reduction "" lead "" is unmapped if all agg \n results being reduced are unmapped . \n Closes # 65118",371
"server \ src \ test \ java \ org \ elasticsearch \ search \ aggregations \ bucket \ filter \ FiltersAggregatorTests . java \n - MappedFieldType ft = new DateFieldMapper . DateFieldType ( "" test "" , Resolution . MILLISECONDS ) ; \n + MappedFieldType ft = new DateFieldMapper . DateFieldType ( \n + "" test "" , \n + true , \n + false , \n + false , \n + DateFieldMapper . DEFAULT _ DATE _ TIME _ FORMATTER , \n + Resolution . MILLISECONDS , \n + null , \n + null \n + ) ; \n",Fix a rare failure in FiltersAggregatorTests \n It reproducibly fails about . 3 % of the time because we configure a field \n to have doc values but don ' t provide them . This configures the field not \n to have doc values .,371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 220 _ filters _ bucket . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : cache fixed in 8 . 0 . 0 to be backported to 7 . 11 . 0 \n + version : "" - 7 . 10 . 99 "" \n + reason : cache fixed in 7 . 11 . 0 \n - do : \n",Update skip after backport of # 66295 ( # 66808 ) \n Now that # 66295 has landed in 7 . 11 we can run the bwc tests it adds \n against that branch .,371
x - pack \ plugin \ runtime - fields \ qa \ core - with - search \ src \ yamlRestTest \ java \ org \ elasticsearch \ xpack \ runtimefields \ test \ search \ CoreTestsWithSearchRuntimeFieldsIT . java \n - / / TODO this is always false ? \n - if ( patterns . length = = 0 & & Regex . isSimpleMatchPattern ( patterns [ 0 ] ) ) { \n + if ( patterns . length = = 1 & & Regex . isSimpleMatchPattern ( patterns [ 0 ] ) ) { \n,Fix optimization in runtime fields tests \n The runtime fields tests tried to skip iterating a ` Map ` ' s keys if we \n only have a single pattern but it was checking that we had ` 0 ` patterns \n instead . Ooops !,371
"x - pack \ plugin \ async - search \ build . gradle \n - tasks . withType ( JavaCompile ) . configureEach { \n - options . compilerArgs < < "" - Xlint : - rawtypes "" \n - } \n - \n","Drop rawtypes warning from async search ( # 68248 ) \n It looks like we don ' t need it and it helps us write code with "" funny "" \n assumptions without realizing it .",371
"x - pack \ plugin \ runtime - fields \ build . gradle \n - tasks . withType ( JavaCompile ) . configureEach { \n - options . compilerArgs < < "" - Xlint : - rawtypes "" \n - } \n - \n - \n x - pack \ plugin \ runtime - fields \ src \ test \ java \ org \ elasticsearch \ xpack \ runtimefields \ query \ AbstractScriptFieldQueryTestCase . java \n - public abstract class AbstractScriptFieldQueryTestCase < T extends AbstractScriptFieldQuery > extends ESTestCase { \n + public abstract class AbstractScriptFieldQueryTestCase < T extends AbstractScriptFieldQuery < ? > > extends ESTestCase { \n",Drop rawtypes error suppression in runtime - fields ( # 68245 ) \n We don ' t need it and it stops the compiler from warning us if we make \n code that is harder to read .,371
"buildSrc \ src \ main \ resources \ checkstyle _ suppressions . xml \n - - > \n - < suppress files = "" client [ / \ \ ] rest - high - level [ / \ \ ] src [ / \ \ ] test [ / \ \ ] java [ / \ \ ] org [ / \ \ ] elasticsearch [ / \ \ ] client [ / \ \ ] documentation [ / \ \ ] CRUDDocumentationIT . java "" id = "" SnippetLength "" / > \n - < suppress files = "" client [ / \ \ ] rest - high - level [ / \ \ ] src [ / \ \ ] test [ / \ \ ] java [ / \ \ ] org [ / \ \ ] elasticsearch [ / \ \ ] client [ / \ \ ] documentation [ / \ \ ] TextStructureClientDocumentationIT . java "" id = "" SnippetLength "" / > \n - < suppress files = "" modules [ / \ \ ] reindex [ / \ \ ] src [ / \ \ ] test [ / \ \ ] java [ / \ \ ] org [ / \ \ ] elasticsearch [ / \ \ ] client [ / \ \ ] documentation [ / \ \ ] ReindexDocumentationIT . java "" id = "" SnippetLength "" / > \n",Drop unused checkstyle suppressions \n These suppressions no longer do anything because the files they point to \n have resolved their line length issues .,371
"x - pack \ plugin \ analytics \ build . gradle \n - tasks . withType ( JavaCompile ) . configureEach { \n - options . compilerArgs < < "" - Xlint : - rawtypes "" \n - } \n - \n x - pack \ plugin \ analytics \ src \ main \ java \ org \ elasticsearch \ xpack \ analytics \ cumulativecardinality \ CumulativeCardinalityPipelineAggregator . java \n - InternalMultiBucketAggregation < ? extends InternalMultiBucketAggregation , ? extends InternalMultiBucketAggregation . InternalBucket > \n - histo = ( InternalMultiBucketAggregation < ? extends InternalMultiBucketAggregation , ? extends \n - InternalMultiBucketAggregation . InternalBucket > ) aggregation ; \n + InternalMultiBucketAggregation < ? , ? > histo = ( InternalMultiBucketAggregation < ? , ? > ) aggregation ; \n x - pack \ plugin \ analytics \ src \ main \ java \ org \ elasticsearch \ xpack \ analytics \ movingPercentiles \ MovingPercentilesPipelineAggregator . java \n - InternalMultiBucketAggregation < ? extends InternalMultiBucketAggregation , ? extends InternalMultiBucketAggregation . InternalBucket > \n - histo = ( InternalMultiBucketAggregation < ? extends InternalMultiBucketAggregation , ? extends \n - InternalMultiBucketAggregation . InternalBucket > ) aggregation ; \n + @ SuppressWarnings ( "" unchecked "" ) \n + InternalMultiBucketAggregation < ? , ? > histo = ( InternalMultiBucketAggregation < ? , ? > ) aggregation ; \n x - pack \ plugin \ analytics \ src \ main \ java \ org \ elasticsearch \ xpack \ analytics \ normalize \ NormalizePipelineAggregator . java \n - @ SuppressWarnings ( "" unchecked "" ) \n - InternalMultiBucketAggregation < InternalMultiBucketAggregation , InternalMultiBucketAggregation . InternalBucket > originalAgg = \n - ( InternalMultiBucketAggregation < InternalMultiBucketAggregation , InternalMultiBucketAggregation . InternalBucket > ) aggregation ; \n + @ SuppressWarnings ( "" unchecked "" ) \n + InternalMultiBucketAggregation < ? , InternalMultiBucketAggregation . InternalBucket > originalAgg = \n + ( InternalMultiBucketAggregation < ? , InternalMultiBucketAggregation . InternalBucket > ) aggregation ; \n",Remove rawtype suppression in analytics ( # 68242 ) \n This removes some of the compiler warnings in the analytics subproject \n and zaps the compiler config required to compile with the warning .,371
"rest - api - spec \ build . gradle \n - ' search . aggregation / 370 _ doc _ count _ field / Test filters agg with doc _ count ' , \n rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 370 _ doc _ count _ field . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n + version : "" - 7 . 12 . 99 "" \n - reason : "" name changed in 8 . 0 . 0 , backporting to 7 . 13 "" \n + reason : "" name changed in 7 . 13 "" \n - do : \n",Update skip after backport ( # 69710 ) \n Now that we ' ve backported # 69377 to 7 . x we can run backwards \n compatibility tests against it .,371
plugins \ repository - azure \ build . gradle \n + if ( isEclipse ) { \n + / * \n + * Eclipse can ' t pick up the shadow dependency so we point it at * something * \n + * so it can compile things . \n + * / \n + api project ( path : ' azure - storage - blob ' ) \n + } \n plugins \ repository - hdfs \ build . gradle \n + if ( isEclipse ) { \n + / * \n + * Eclipse can ' t pick up the shadow dependency so we point it at * something * \n + * so it can compile things . \n + * / \n + api project ( path : ' hadoop - common ' ) \n + } \n,Help eclipse compilation ( # 67403 ) \n Eclipse wasn ' t seeing the special shadow jars we were making for \n repository - azure and repository - hdfs so it wasn ' t able to compile those \n plugins . This points Eclipse at the project that we use to build the \n shadow jar which gets it compiling . The tests don ' t pass because we \n aren ' t pointing at the shadow jars but at least we compile .,371
"modules \ lang - painless \ src \ main \ java \ org \ elasticsearch \ painless \ api \ Augmentation . java \n - public static String [ ] split​ ( Pattern receiver , int limitFactor , CharSequence input , int limit ) { \n + public static String [ ] split ( Pattern receiver , int limitFactor , CharSequence input , int limit ) { \n - public static Stream < String > splitAsStream​ ( Pattern receiver , int limitFactor , CharSequence input ) { \n + public static Stream < String > splitAsStream ( Pattern receiver , int limitFactor , CharSequence input ) { \n modules \ lang - painless \ src \ test \ java \ org \ elasticsearch \ painless \ RegexTests . java \n - import org . elasticsearch . common . settings . Settings ; \n - \n - @ Override \n - protected Settings scriptEngineSettings ( ) { \n - / / Enable regexes just for this test . They are disabled by default . \n - return Settings . builder ( ) \n - . put ( CompilerSettings . REGEX _ ENABLED . getKey ( ) , true ) \n - . build ( ) ; \n - } \n - \n + public void testSplitWithLimit ( ) { \n + assertArrayEquals ( new String [ ] { "" cat "" , "" dog , pig "" } , ( String [ ] ) exec ( "" / , / . split ( ' cat , dog , pig ' , 2 ) "" ) ) ; \n + } \n + \n","Fix painless tests in eclipse ( # 67602 ) \n ` Augmentation . java ` had a zero width space [ 1 ] in two method \n definitions : \n ` ` ` \n public static String [ ] split ( Pattern receiver , int limitFactor , CharSequence input , int limit ) { \n ^ - - - - - - - Right before the ( character \n public static Stream < String > splitAsStream ( Pattern receiver , int limitFactor , CharSequence input ) { \n ^ Right before the ( here too \n ` ` ` \n Sadly , Eclipse and javac treat this character differently . Eclipse seems \n to include it in the method name and javac seems to treat it as regular \n space . This caused all the unit tests for painless to fail to load \n because they couldn ' t find the ` split ` and ` splitAsStream ` \n augmentations . But if you listed all of the methods they looked like \n they were there . If you crack open the line in a hex editor you can see \n it . \n Eclipse is tracking [ 2 ] similar issues . \n [ 1 ] : https : / / en . wikipedia . org / wiki / Zero - width _ space \n [ 2 ] : https : / / bugs . eclipse . org / bugs / show _ bug . cgi ? id = 547601",371
"modules \ lang - painless \ build . gradle \n + if ( isEclipse ) { \n + / * \n + * Eclipse isn ' t quite "" with it "" enough to understand the different \n + * source sets . This adds the dependency to all source sets so it \n + * can compile the doc java files . \n + * / \n + implementation ' com . github . javaparser : javaparser - core : 3 . 18 . 0 ' \n + } \n",Fix painless build in eclipse ( # 68166 ) \n Painless now has a ` doc ` source which has its own dependencies . That ' s \n lovely for everything but Eclipse doesn ' t understand that sort of thing . \n This adds the docs dependencies to the regular build path when building \n with Eclipse .,371
"docs \ reference \ aggregations \ metrics \ top - metrics - aggregation . asciidoc \n - * It can ' t be used on < < binary , binary > > , < < flattened , flattened > > or < < text , text > > fields . \n + * It can ' t be used on < < binary , binary > > , < < flattened , flattened > > , < < ip , ip > > , \n + < < keyword , keyword > > , or < < text , text > > fields . \n + The fields can be < < number , numbers > > , < < keyword , keywords > > , or < < ip , ips > > . \n - { "" s "" : 1 , "" m "" : 3 . 1415 , "" i "" : 1 , "" d "" : "" 2020 - 01 - 01T00 : 12 : 12Z "" } \n + { "" s "" : 1 , "" m "" : 3 . 1415 , "" i "" : 1 , "" d "" : "" 2020 - 01 - 01T00 : 12 : 12Z "" , "" t "" : "" cat "" } \n - { "" s "" : 2 , "" m "" : 1 . 0 , "" i "" : 6 , "" d "" : "" 2020 - 01 - 02T00 : 12 : 12Z "" } \n + { "" s "" : 2 , "" m "" : 1 . 0 , "" i "" : 6 , "" d "" : "" 2020 - 01 - 02T00 : 12 : 12Z "" , "" t "" : "" dog "" } \n - { "" s "" : 3 , "" m "" : 2 . 71828 , "" i "" : - 12 , "" d "" : "" 2019 - 12 - 31T00 : 12 : 12Z "" } \n + { "" s "" : 3 , "" m "" : 2 . 71828 , "" i "" : - 12 , "" d "" : "" 2019 - 12 - 31T00 : 12 : 12Z "" , "" t "" : "" chicken "" } \n - { "" field "" : "" d "" } \n + { "" field "" : "" d "" } , \n + { "" field "" : "" t . keyword "" } \n - "" d "" : "" 2019 - 12 - 31T00 : 12 : 12 . 000Z "" \n + "" d "" : "" 2019 - 12 - 31T00 : 12 : 12 . 000Z "" , \n + "" t . keyword "" : "" chicken "" \n",Docs : Add example fetching keyword in top _ metrics ( # 69135 ) \n Adds an example of fetching a keyword field .,371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 370 _ doc _ count _ field . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : "" fixed in 8 . 0 . 0 to be backported to 7 . 11 . 2 "" \n + version : "" - 7 . 11 . 1 "" \n + reason : "" fixed in 7 . 11 . 2 "" \n - do : \n",Update skip after backport of # 68930 ( # 69233 ),371
"server \ src \ test \ java \ org \ elasticsearch \ search \ aggregations \ bucket \ terms \ LongKeyedBucketOrdsTests . java \n - int owningBucketOrds = scaledRandomIntBetween ( 1 , 10000 ) ; \n - long maxValue = randomLongBetween ( 10000 / owningBucketOrds , 2 ^ ( 16 * 3 ) ) ; \n + int owningBucketOrds = scaledRandomIntBetween ( 2 , 10000 ) ; \n + long maxValue = randomLongBetween ( 10000 / owningBucketOrds , 2 < < ( 16 * 3 ) ) ; \n","Fix test bounds \n Fix a test mistake that I just committed in # 68592 . I a bad set of \n bounds on the randomized values used by the "" short "" set of tests . Mostly \n because I fogot that ` ^ ` isn ' t the exponentiation operator . . . . .",371
"server \ src \ test \ java \ org \ elasticsearch \ search \ aggregations \ bucket \ terms \ TermsAggregatorTests . java \n - public void testManyUniqueTerms ( ) throws Exception { \n + public void testManyTerms ( ) throws Exception { \n + / * \n + * index all of the fields into a single segment so our \n + * test gets accurate counts . We * could * set the shard size \n + * very very high but we want to test the branch of the \n + * aggregation building code that picks the top sorted aggs . \n + * / \n + List < List < ? extends IndexableField > > docs = new ArrayList < > ( ) ; \n - iw . addDocument ( doc ( fieldType , s ) ) ; \n + docs . add ( doc ( fieldType , s ) ) ; \n - iw . addDocument ( doc ( fieldType , s ) ) ; \n + docs . add ( doc ( fieldType , s ) ) ; \n + iw . addDocuments ( docs ) ; \n","Fixup aggs test ( # 69476 ) \n One of the tests that I added in # 68871 worked about 99 . 7 % of the time \n but on some seeds failed to generate the right buckets because on those \n seeds we would collect each segment with its own aggregator and get bad \n counts . This "" bad counts "" problem is known in the terms aggregator - its \n the price we pay for distributed work . But we can work around it either \n by forcing all the docs into a single segment or by collecting all of \n the buckets on the shard . We want to test the code path where don ' t \n collect all buckets on the shard so we opt for the former . \n Closes # 69413",371
rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 370 _ doc _ count _ field . yml \n - skip : \n + features : default _ shards \n - do : \n,Test : Fix filter assertion \n Forces a test to use only a single shard so the assertion about the \n aggregation profiler results are correct . Without this the test fails \n randomly but very rarely . We have to use multiple shards ( seeded random \n 10 % choice ) and we have to land all of the documents on one shard \n ( unseeded random 3 . 2 % ) and that shard has to be the second shard in the \n list ( unseeded random 50 % ) . That works out to about 1 . 6 % chance with an \n appropriate seed - . 16 % without it .,371
"server \ src \ test \ java \ org \ elasticsearch \ rest \ action \ document \ RestIndexActionTests . java \n + import org . elasticsearch . action . index . IndexResponse ; \n + import org . elasticsearch . index . shard . ShardId ; \n + return new IndexResponse ( new ShardId ( "" test "" , "" test "" , 0 ) , "" id "" , 0 , 0 , 0 , true ) ; \n test \ framework \ src \ main \ java \ org \ elasticsearch \ test \ rest \ RestActionTestCase . java \n - import java . util . function . BiConsumer ; \n - AtomicReference < BiConsumer < ActionType < ? > , ActionRequest > > executeVerifier = new AtomicReference < > ( ) ; \n + AtomicReference < BiFunction < ActionType < ? > , ActionRequest , ActionResponse > > executeVerifier = new AtomicReference < > ( ) ; \n - * function should return either a subclass of { @ link ActionResponse } or { @ code null } . \n + * function should return a subclass of { @ link ActionResponse } that is appropriate for the action . \n - public void setExecuteVerifier ( BiConsumer < ActionType < ? > , ActionRequest > verifier ) { \n - executeVerifier . set ( verifier ) ; \n + public < R extends ActionResponse > void setExecuteVerifier ( BiFunction < ActionType < R > , ActionRequest , R > verifier ) { \n + / * \n + * Perform a little generics dance to force the callers to mock \n + * a return type appropriate for the action even though we can ' t \n + * declare such types . We have force the caller to be specific \n + * and then throw away their specificity . Then we case back \n + * to the specific erased type in the method below . \n + * / \n + BiFunction < ? , ? , ? > dropTypeInfo = ( BiFunction < ? , ? , ? > ) verifier ; \n + @ SuppressWarnings ( "" unchecked "" ) \n + BiFunction < ActionType < ? > , ActionRequest , ActionResponse > pasteGenerics = ( BiFunction < \n + ActionType < ? > , \n + ActionRequest , \n + ActionResponse > ) dropTypeInfo ; \n + executeVerifier . set ( pasteGenerics ) ; \n - executeVerifier . get ( ) . accept ( action , request ) ; \n - listener . onResponse ( null ) ; \n + @ SuppressWarnings ( "" unchecked "" ) / / The method signature of setExecuteVerifier forces this case to work \n + Response response = ( Response ) executeVerifier . get ( ) . apply ( action , request ) ; \n + listener . onResponse ( response ) ; \n",Test : Clean up a stray NPE ( # 69566 ) \n When we test the REST actions we assumed that they ' d produce a result \n but one of the mocking / verification mechanisms didn ' t . This forces it to \n produce a result . It uses some generics dancing to force the calling \n code to mock things with the appropriate type even though we don ' t its \n only a compile time guarantee . So long as callers aren ' t rude its safe .,371
"rest - api - spec \ build . gradle \n + ' search . aggregation / 370 _ doc _ count _ field / Test filters agg with doc _ count ' , \n rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 370 _ doc _ count _ field . yml \n - - - \n - skip : \n - version : "" - 7 . 11 . 1 "" \n + version : "" - 7 . 99 . 99 "" \n - reason : "" fixed in 7 . 11 . 2 "" \n + reason : "" name changed in 8 . 0 . 0 , backporting to 7 . 13 "" \n - do : \n",Skip test before backport \n Skip running the a particular filters aggregator test while we backport \n the change that ' ll make it correct .,371
"x - pack \ plugin \ identity - provider \ build . gradle \n - options . compilerArgs < < "" - Xlint : - rawtypes , - unchecked "" \n + options . compilerArgs < < "" - Xlint : - unchecked "" \n x - pack \ plugin \ identity - provider \ src \ main \ java \ org \ elasticsearch \ xpack \ idp \ saml \ idp \ SamlIdPMetadataBuilder . java \n - List < NameIDFormat > formats = new ArrayList ( ) ; \n + List < NameIDFormat > formats = new ArrayList < > ( ) ; \n x - pack \ plugin \ identity - provider \ src \ test \ java \ org \ elasticsearch \ xpack \ idp \ action \ TransportPutSamlServiceProviderActionTests . java \n - ActionListener listener = ( ActionListener ) args [ args . length - 1 ] ; \n + @ SuppressWarnings ( "" unchecked "" ) \n + ActionListener < DocWriteResponse > listener = ( ActionListener < DocWriteResponse > ) args [ args . length - 1 ] ; \n - any ( WriteRequest . RefreshPolicy . class ) , any ( ActionListener . class ) ) ; \n + any ( WriteRequest . RefreshPolicy . class ) , any ( ) ) ; \n - ActionListener < Set < SamlServiceProviderIndex . DocumentSupplier > > listener = ( ActionListener ) args [ args . length - 1 ] ; \n + @ SuppressWarnings ( "" unchecked "" ) \n + ActionListener < Set < SamlServiceProviderIndex . DocumentSupplier > > listener = ( ActionListener < \n + Set < SamlServiceProviderIndex . DocumentSupplier > > ) args [ args . length - 1 ] ; \n - } ) . when ( index ) . findByEntityId ( anyString ( ) , any ( ActionListener . class ) ) ; \n + } ) . when ( index ) . findByEntityId ( anyString ( ) , any ( ) ) ; \n","Drop rawtypes warnings from identityprovider ( # 68249 ) \n We barely used it and it makes it easier for us to write code with \n "" funny "" assumptions . This change mostly makes the assumptions more clear \n without really changing them . \n Co - authored - by : Elastic Machine < elasticmachine @ users . noreply . github . com >",371
server \ src \ main \ java \ org \ elasticsearch \ search \ lookup \ LeafStoredFieldsLookup . java \n + if ( cachedFieldData . isEmpty ( ) ) { \n + / * \n + * This code is in the hot path for things like ScoreScript and \n + * runtime fields but the map is almost always empty . So we \n + * bail early then instead of building the entrySet . \n + * / \n + return ; \n + } \n,Slightly speed up scripts ( # 68478 ) \n This saves a couple of nanoseconds on ever invocation of a painless \n script that uses ` SearchLookup ` . Which is most of the scripts in the hot \n path . This amounts to a 3 . 5 % performance savings for things like script \n scoring and runtime fields . We got this by speeding up a method that the \n async profiler reported as taking 20 % of the time running a script score \n with painless . This drops it to 1 % . You ' d think that ' d result in a 19 % \n speed up . But no such luck .,371
"modules \ lang - painless \ src \ main \ java \ org \ elasticsearch \ painless \ phase \ DefaultSemanticAnalysisPhase . java \n - "" could not compile regex constant [ "" + pattern + "" ] with flags [ "" + flags + "" ] "" , pse ) ) ; \n + "" could not compile regex constant [ "" + pattern + "" ] with flags [ "" + flags + "" ] : "" + pse . getDescription ( ) , pse ) ) ; \n modules \ lang - painless \ src \ test \ java \ org \ elasticsearch \ painless \ RegexTests . java \n - assertEquals ( "" invalid regular expression : could not compile regex constant [ \ \ ujjjj ] with flags [ ] "" , e . getCause ( ) . getMessage ( ) ) ; \n + assertEquals ( \n + "" invalid regular expression : could not compile regex constant [ \ \ ujjjj ] with flags [ ] : Illegal Unicode escape sequence "" , \n + e . getCause ( ) . getMessage ( ) \n + ) ; \n + \n + e = expectThrows ( ScriptException . class , ( ) - > { \n + exec ( "" / ( ? < > . + ) / "" ) ; / / Invalid capture name \n + } ) ; \n + assertEquals ( \n + "" invalid regular expression : could not compile regex constant [ ( ? < > . + ) ] with flags [ ] : "" \n + + "" capturing group name does not start with a Latin letter "" , \n + e . getCause ( ) . getMessage ( ) \n + ) ; \n + \n + / / And make sure the location of the error points to the offset inside the pattern \n + assertScriptStack ( e , \n + "" / ( ? < > . + ) / "" , \n + "" ^ - - - - HERE "" ) ; \n",Painless : improve bad regex pattern syntax error ( # 68520 ) \n Adds extra information about the actual error in the pattern to the \n error painless returns when you specify a bad pattern . This information \n was hiding in the exception that ` Pattern . compile ` throws but isn ' t \n included in its message so we were never showing it to anyone . These \n error message include such gems as : \n * named capturing group < name > does not exist \n * Look - behind group does not have an obvious maximum length \n * Unclosed counted closure \n Now you ' ll get to know what you need to change about your pattern and \n not just where it went wrong !,371
"modules \ lang - painless \ src \ main \ java \ org \ elasticsearch \ painless \ phase \ DefaultConstantFoldingOptimizationPhase . java \n - if ( argNode instanceof ConstantNode = = false ) { \n + IRDConstant constantDecoration = argNode . getDecoration ( IRDConstant . class ) ; \n + if ( constantDecoration = = null ) { \n - . createError ( new IllegalArgumentException ( "" all arguments must be constant but the [ "" + ( i + 1 ) + "" ] argument isn ' t "" ) ) ; \n + . createError ( \n + new IllegalArgumentException ( \n + "" all arguments to [ "" + javaMethod . getName ( ) + "" ] must be constant but the [ "" + ( i + 1 ) + "" ] argument isn ' t "" \n + ) \n + ) ; \n - args [ i ] = ( ( ConstantNode ) argNode ) . getDecorationValue ( IRDConstant . class ) ; \n + args [ i ] = constantDecoration . getValue ( ) ; \n modules \ lang - painless \ src \ test \ java \ org \ elasticsearch \ painless \ BindingsTests . java \n - assertThat ( e . getMessage ( ) , equalTo ( "" all arguments must be constant but the [ 2 ] argument isn ' t "" ) ) ; \n + assertThat ( e . getMessage ( ) , equalTo ( "" all arguments to [ classMul ] must be constant but the [ 2 ] argument isn ' t "" ) ) ; \n - assertThat ( e . getMessage ( ) , equalTo ( "" all arguments must be constant but the [ 1 ] argument isn ' t "" ) ) ; \n + assertThat ( e . getMessage ( ) , equalTo ( "" all arguments to [ instanceMul ] must be constant but the [ 1 ] argument isn ' t "" ) ) ; \n x - pack \ plugin \ src \ test \ resources \ rest - api - spec \ test \ runtime _ fields \ 250 _ grok . yml \n - - - \n - do : \n - catch : / all arguments must be constant but the \ [ 1 \ ] argument isn ' t / \n + catch : / all arguments to \ [ grok \ ] must be constant but the \ [ 1 \ ] argument isn ' t / \n","Painless : improve error message on non - constant ( # 68517 ) \n As of # 68088 painless can have methods where all parameters must be \n constant . This improves the error message when the parameter isn ' t . It ' s \n still not super great , but its better and its what we can easilly give \n at that point in the compiler .",371
"x - pack \ plugin \ runtime - fields \ src \ main \ java \ org \ elasticsearch \ xpack \ runtimefields \ mapper \ AbstractFieldScript . java \n - * In an ideal world we wouldn ' t need the script cache at all \n - * because we have a hard reference to the script . The trouble \n - * is that we compile the scripts a few times when performing \n - * a mapping update . This is unfortunate , but we rely on the \n - * cache to speed this up . \n + * We rely on the script cache in two ways : \n + * 1 . It caches the "" heavy "" part of mappings generated at runtime . \n + * 2 . Mapping updates tend to try to compile the script twice . Not \n + * for any good reason . They just do . \n + * Thus we use the default 100 . \n - * Disable compilation rate limits for scripted fields so we \n + * Disable compilation rate limits for runtime fields so we \n - * many recently . That ' d just be lame . \n + * many recently . That ' d just be lame . We also compile these \n + * scripts during search requests so this could totally be a \n + * source of runaway script compilations . We think folks will \n + * mostly reuse scripts though . \n",Runtime fields : update comments on script context ( # 68526 ) \n We had some super informative comments on the script context \n configuration that we share for all of runtime fields . But they were out \n of date . They assumed that runtime fields can only show up in the \n mapping .,371
"server \ src \ test \ java \ org \ elasticsearch \ common \ breaker \ PreallocatedCircuitBreakerServiceTests . java \n + import org . elasticsearch . common . unit . ByteSizeValue ; \n + import static org . hamcrest . Matchers . lessThanOrEqualTo ; \n + import static org . junit . Assume . assumeThat ; \n - long preallocatedBytes = randomLongBetween ( 1 , realBreaker . getLimit ( ) ) ; \n + long limit = ByteSizeValue . ofMb ( 100 ) . getBytes ( ) ; \n + assumeThat ( limit , lessThanOrEqualTo ( realBreaker . getLimit ( ) ) ) ; \n + long preallocatedBytes = randomLongBetween ( 1 , limit ) ; \n - long delta = randomLongBetween ( Math . max ( - current , - realBreaker . getLimit ( ) / 100 ) , 0 ) ; \n + long delta = randomLongBetween ( - Math . min ( current , limit / 100 ) , 0 ) ; \n - long delta = randomLongBetween ( 0 , realBreaker . getLimit ( ) / 100 ) ; \n + long delta = randomLongBetween ( 0 , limit / 100 ) ; \n","Fix preallocted breaker test failure ( # 67022 ) \n The randomized test for pre - allocated breakers would sometimes attempt \n to consume the entire request breaker and fail . This limits it to 100mb \n and aborts the test if that doesn ' t fit comfortable into the breaker . \n The 100mb limit also fixes another sneaky issue - the randomized values \n for the test used to depend on the size of the request breaker which \n itself depends on the size of the heap . We run the tests with 512m heap \n in gradle but IDEs are kind of the wild west . That made it very \n difficult to reproduce the issue . \n There is still some heap dependent randomization here , sadly . We use \n non - heap dependent randomization to bump the breaker but whether or not \n the breaker trips is dependent on heap size . This is , sadly , kind of \n inevitable because we want to test against a real breaker so we can make \n sure we handle circuit breaking sensibly .",371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 220 _ filters _ bucket . yml \n - - - \n + - skip : \n + version : "" - 7 . 99 . 99 "" \n + reason : cache fixed in 8 . 0 . 0 to be backported to 7 . 11 . 0 \n + \n - do : \n","Update skip before backport of # 67043 \n When I merged # 67043 it had an integration test for the thing it was \n fixing but it still fails in the bwc tests . Yikes ! I should know better \n but life is life . Anyway , this updates the skip to ignore the test for \n now . I ' ll reenable once the backport is in .",371
"rest - api - spec \ src \ main \ resources \ rest - api - spec \ test \ search . aggregation \ 220 _ filters _ bucket . yml \n - - - \n - skip : \n - version : "" - 7 . 99 . 99 "" \n - reason : cache fixed in 8 . 0 . 0 to be backported to 7 . 11 . 0 \n + version : "" - 7 . 10 . 99 "" \n + reason : fixed in 7 . 11 . 0 \n",Update skip after backport of # 67043 ( # 67191 ) \n Now that # 67043 has been backported we can update the skip so the bwc \n tests don ' t complain .,371
"server \ src \ test \ java \ org \ elasticsearch \ common \ breaker \ PreallocatedCircuitBreakerServiceTests . java \n - import org . elasticsearch . common . unit . ByteSizeValue ; \n + import static org . elasticsearch . indices . breaker . HierarchyCircuitBreakerService . REQUEST _ CIRCUIT _ BREAKER _ LIMIT _ SETTING ; \n + import static org . elasticsearch . indices . breaker . HierarchyCircuitBreakerService . USE _ REAL _ MEMORY _ USAGE _ SETTING ; \n - import static org . hamcrest . Matchers . lessThanOrEqualTo ; \n - import static org . junit . Assume . assumeThat ; \n - long limit = ByteSizeValue . ofMb ( 100 ) . getBytes ( ) ; \n - assumeThat ( limit , lessThanOrEqualTo ( realBreaker . getLimit ( ) ) ) ; \n - long preallocatedBytes = randomLongBetween ( 1 , limit ) ; \n + long preallocatedBytes = randomLongBetween ( 1 , ( long ) ( realBreaker . getLimit ( ) * . 8 ) ) ; \n - long delta = randomLongBetween ( - Math . min ( current , limit / 100 ) , 0 ) ; \n + long delta = randomLongBetween ( - Math . min ( current , realBreaker . getLimit ( ) / 100 ) , 0 ) ; \n - long delta = randomLongBetween ( 0 , limit / 100 ) ; \n + long delta = randomLongBetween ( 0 , realBreaker . getLimit ( ) / 100 ) ; \n - Settings . EMPTY , \n + Settings . builder ( ) \n + / / Pin the limit to something that ' ll totally fit in the heap we use for the tests \n + . put ( REQUEST _ CIRCUIT _ BREAKER _ LIMIT _ SETTING . getKey ( ) , "" 100mb "" ) \n + / / Disable the real memory checking because it causes other tests to interfere with this one . \n + . put ( USE _ REAL _ MEMORY _ USAGE _ SETTING . getKey ( ) , false ) \n + . build ( ) , \n","Tighten up preallocated breaker test some more \n In # 67022 we made the preallocated breaker test much more resilient but \n it still seems to fail spuriously from time to time . This should tighten \n it up some . Specifically , we now limit the maximum memory usage to 100mb \n and we disable the real memory breaker . The real memory breaker was \n tripping sometimes based on memory usage in the test process that was \n unrelated to the pre - allocation test . Ironically , the pre - allocation \n test doesn ' t allocate the memory that it tries to pre - allocate . It ' s \n fake . But the real memory breaker was tripping anyway . . . . . \n Closes # 67256",371
"codec - http \ src \ main \ java \ io \ netty \ handler \ codec \ http \ websocketx \ WebSocketClientHandshaker00 . java \n - import io . netty . handler . codec . http . HttpResponseStatus ; \n - final HttpResponseStatus status = new HttpResponseStatus ( 101 , "" WebSocket Protocol Handshake "" ) ; \n - \n - if ( ! response . status ( ) . equals ( status ) ) { \n + if ( response . status ( ) . code ( ) ! = 101 ) { \n","Remove unnecessary instantiation of HttpResponseStatus \n Motivation : \n - In the ` HttpResponseStatus # equals ` checks only status code . No need to create new instance of ` HttpResponseStatus ` for comparison with response status . \n - The RFC says : ` the HTTP version and reason phrase aren ' t important ` [ 1 ] . \n Modifications : \n Use comparison by status code without creating new ` HttpResponseStatus ` . \n Result : \n Less allocations , more clear code . \n [ 1 ] https : / / tools . ietf . org / html / draft - ietf - hybi - thewebsocketprotocol - 00",374
"transport - udt \ src \ main \ java \ io \ netty \ channel \ udt \ nio \ NioUdtMessageConnectorChannel . java \n + import java . io . IOException ; \n + import java . security . AccessController ; \n + import java . security . PrivilegedActionException ; \n + import java . security . PrivilegedExceptionAction ; \n - SocketUtils . bind ( javaChannel ( ) , localAddress ) ; \n + privilegedBind ( javaChannel ( ) , localAddress ) ; \n + \n + private static void privilegedBind ( final SocketChannelUDT socketChannel , final SocketAddress localAddress ) \n + throws IOException { \n + try { \n + AccessController . doPrivileged ( new PrivilegedExceptionAction < Void > ( ) { \n + @ Override \n + public Void run ( ) throws IOException { \n + socketChannel . bind ( localAddress ) ; \n + return null ; \n + } \n + } ) ; \n + } catch ( PrivilegedActionException e ) { \n + throw ( IOException ) e . getCause ( ) ; \n + } \n + } \n",AbstractMethodError with barchart - udt \n Motivation : \n ` SocketChannelUDT ` from barchart - udt does not have the java 7 ` public abstract SocketChannel bind ( SocketAddress local ) ` method . Calling the abstract method ` SocketChannel . bind ( SocketAddress localAddress ) ` for ` SocketChannelUDT ` leads to an ` AbstractMethodError ` runtime error . \n Modifications : \n Make workaround with explicit call of ` SocketChannelUDT . bind ( SocketAddress local ) ` as it done in ` NioUdtByteConnectorChannel ` . \n Result : \n Fixes [ # 6934 ] .,374
"transport - native - epoll \ src \ main \ java \ io \ netty \ channel \ epoll \ EpollEventLoop . java \n + / / Using the intermediate collection to prevent ConcurrentModificationException . \n + / / In the ` close ( ) ` method , the channel is deleted from ` channels ` map . \n",Clarify the appointment of the intermediate collection \n Motivation : \n An intermediate list is creating in the ` EpollEventLoop # closeAll ` to prevent ConcurrentModificationException . But this is not the obvious purpose has no comment . \n Modifications : \n Add comment to clarify the appointment of the intermediate collection . \n Result : \n More clear code .,374
"buffer \ src \ main \ java \ io \ netty \ buffer \ ByteBufUtil . java \n - final int len = seq . length ( ) ; \n - buf . ensureWritable ( utf8MaxBytes ( seq ) ) ; \n - \n - int written = writeUtf8 ( byteBuf , byteBuf . writerIndex , seq , len ) ; \n + byteBuf . ensureWritable ( utf8MaxBytes ( seq ) ) ; \n + int written = writeUtf8 ( byteBuf , byteBuf . writerIndex , seq , seq . length ( ) ) ; \n - buf . ensureWritable ( len ) ; \n - buf . writeBytes ( asciiString . array ( ) , asciiString . arrayOffset ( ) , asciiString . length ( ) ) ; \n + buf . writeBytes ( asciiString . array ( ) , asciiString . arrayOffset ( ) , len ) ; \n + byteBuf . ensureWritable ( len ) ; \n",Avoid a double check ByteBuf # ensureWritable in ByteBufUtil \n Motivation : \n Methods ` ByteBufUtil # writeUtf8 ` and ` ByteBufUtil # writeAscii ` contains a check ` ByteBuf # ensureWritable ` before the calling ` ByteBuf # writeBytes ` . But the ` ByteBuf # writeBytes ` also do a such check inside . \n Modifications : \n Make checks more targeted . \n Result : \n Less redundant method calls .,374
codec - http2 \ src \ main \ java \ io \ netty \ handler \ codec \ http2 \ DefaultHttp2GoAwayFrame . java \n - return super . equals ( o ) & & errorCode = = other . errorCode & & content ( ) . equals ( other . content ( ) ) \n - & & extraStreamIds = = other . extraStreamIds ; \n + return errorCode = = other . errorCode & & extraStreamIds = = other . extraStreamIds & & super . equals ( other ) ; \n - int hash = 237395317 ; \n + int hash = super . hashCode ( ) ; \n - hash = hash * 31 + content ( ) . hashCode ( ) ; \n,Remove double comparing of content out of the DefaultHttp2GoAwayFrame . equals ( ) \n Motivation : \n In ` DefaultHttp2GoAwayFrame . equals ( ) ` a content compared twice : explicitly and in the ` super ` method . \n Modifications : \n Remove explicit content comparision . \n Make ` hashCode ( ) ` consistent with ` equals ( ) ` . \n Result : \n A ` DefaultHttp2GoAwayFrame . equals ( ) ` work faster .,374
"transport \ src \ main \ java \ io \ netty \ channel \ DefaultChannelId . java \n - return this = = obj | | ( obj instanceof DefaultChannelId & & Arrays . equals ( data , ( ( DefaultChannelId ) obj ) . data ) ) ; \n + if ( this = = obj ) { \n + return true ; \n + } \n + if ( ! ( obj instanceof DefaultChannelId ) ) { \n + return false ; \n + } \n + DefaultChannelId other = ( DefaultChannelId ) obj ; \n + return hashCode = = other . hashCode & & Arrays . equals ( data , other . data ) ; \n",Optimize DefaultChannelId . equals \n Motivation : \n A ` DefaultChannelId ` has final ` hashCode ` field calculated in the constructor . We can use it in ` equals ` to the fast return for different objects . \n Modifications : \n Use ` hashCode ` field in ` DefaultChannelId . equals ( ) ` . \n Result : \n Fast ` equals ` on negative scenarios .,374
codec - http2 \ src \ main \ java \ io \ netty \ handler \ codec \ http2 \ Http2StreamChannelId . java \n - return parentId . hashCode ( ) ; \n + return id * 31 + parentId . hashCode ( ) ; \n,Fix hashCode ( ) in Http2StreamChannelId \n Motivation : \n In ` Http2StreamChannelId ` a ` hashCode ( ) ` is not consistent with ` equals ( ) ` . \n Modifications : \n Make a ` Http2StreamChannelId . hashCode ( ) ` consistent with ` equals ( ) ` . \n Result : \n Faster hash map ' s operations where the Http2StreamChannelId as keys .,374
"common \ src \ main \ java \ io \ netty \ util \ internal \ InternalThreadLocalMap . java \n + import io . netty . util . internal . logging . InternalLogger ; \n + import io . netty . util . internal . logging . InternalLoggerFactory ; \n + private static final InternalLogger logger = InternalLoggerFactory . getInstance ( InternalThreadLocalMap . class ) ; \n + \n + private static final int STRING _ BUILDER _ INITIAL _ SIZE ; \n + private static final int STRING _ BUILDER _ MAX _ SIZE ; \n + static { \n + STRING _ BUILDER _ INITIAL _ SIZE = \n + SystemPropertyUtil . getInt ( "" io . netty . threadLocalMap . stringBuilder . initialSize "" , 1024 ) ; \n + logger . debug ( "" - Dio . netty . threadLocalMap . stringBuilder . initialSize : { } "" , STRING _ BUILDER _ INITIAL _ SIZE ) ; \n + \n + STRING _ BUILDER _ MAX _ SIZE = SystemPropertyUtil . getInt ( "" io . netty . threadLocalMap . stringBuilder . maxSize "" , 1024 * 4 ) ; \n + logger . debug ( "" - Dio . netty . threadLocalMap . stringBuilder . maxSize : { } "" , STRING _ BUILDER _ MAX _ SIZE ) ; \n + } \n + \n - final int stringBuilderCapacity = 1024 ; \n - if ( stringBuilder = = null ) { \n - stringBuilder = new StringBuilder ( stringBuilderCapacity ) ; \n - } else { \n - if ( stringBuilder . capacity ( ) > stringBuilderCapacity ) { \n - stringBuilder . setLength ( stringBuilderCapacity ) ; \n - stringBuilder . trimToSize ( ) ; \n - } \n - stringBuilder . setLength ( 0 ) ; \n + StringBuilder sb = stringBuilder ; \n + if ( sb = = null ) { \n + return stringBuilder = new StringBuilder ( STRING _ BUILDER _ INITIAL _ SIZE ) ; \n + } \n + if ( sb . capacity ( ) > STRING _ BUILDER _ MAX _ SIZE ) { \n + sb . setLength ( STRING _ BUILDER _ INITIAL _ SIZE ) ; \n + sb . trimToSize ( ) ; \n - return stringBuilder ; \n + sb . setLength ( 0 ) ; \n + return sb ; \n","Make configurable the initial and max size of InternalThreadLocalMap # stringBuilder \n Motivation : \n In some cases of using an ` InternalThreadLocalMap # stringBuilder ` , the ` StringBuilder ` s size can often exceed the exist limit ( 1024 bytes ) . This can lead to permanent memory reallocation . \n Modifications : \n Add custom properties for the initial capacity and maximum size ( after which the ` StringBuilder ` s capacity will be reduced to the initial capacity ) . \n Result : \n An ` InternalThreadLocalMap # stringBuilder ` s initial and max size is configurable . Fixes [ # 7092 ] .",374
"buffer \ src \ main \ java \ io \ netty \ buffer \ ByteBufOutputStream . java \n + import io . netty . util . CharsetUtil ; \n + \n - buffer . writeByte ( ( byte ) b ) ; \n + buffer . writeByte ( b ) ; \n - write ( v ? ( byte ) 1 : ( byte ) 0 ) ; \n + buffer . writeBoolean ( v ) ; \n - write ( v ) ; \n + buffer . writeByte ( v ) ; \n - int len = s . length ( ) ; \n - for ( int i = 0 ; i < len ; i + + ) { \n - write ( ( byte ) s . charAt ( i ) ) ; \n - } \n + buffer . writeCharSequence ( s , CharsetUtil . US _ ASCII ) ; \n - writeShort ( ( short ) v ) ; \n + buffer . writeChar ( v ) ; \n - writeChar ( s . charAt ( i ) ) ; \n + buffer . writeChar ( s . charAt ( i ) ) ; \n - writeLong ( Double . doubleToLongBits ( v ) ) ; \n + buffer . writeDouble ( v ) ; \n - writeInt ( Float . floatToIntBits ( v ) ) ; \n + buffer . writeFloat ( v ) ; \n","Minor improvements in ByteBufOutputStream \n Motivation : \n In the ` ByteBufOutputStream ` we can use an appropriate methods of ` ByteBuf ` \n to reduce calls of virtual methods and do not copying converting logic . \n Modifications : \n - Use an appropriate methods of ` ByteBuf ` \n - Remove redundant conversions ( int - > byte , int - > char ) . \n - Use ` ByteBuf # writeCharSequence ` in the ` writeBytes ( String ) ' . \n Result : \n Less code duplication . A ` writeBytes ( String ) ` method is faster . \n No unnecessary conversions . More consistent and cleaner code .",374
"buffer \ src \ main \ java \ io \ netty \ buffer \ ByteBufUtil . java \n - * @ param src The source of the data to copy . \n - * @ param dst the destination byte array . \n + * \n + * @ param src the source string to copy \n + * @ param dst the destination buffer \n - * Copies the content of { @ code src } to a { @ link ByteBuf } using { @ link ByteBuf # writeBytes ( byte [ ] , int , int ) } . \n - * @ param src The source of the data to copy . \n - * @ param srcIdx the starting offset of characters to copy . \n - * @ param dst the destination byte array . \n - * @ param dstIdx the starting offset in the destination byte array . \n - * @ param length the number of characters to copy . \n + * Copies the content of { @ code src } to a { @ link ByteBuf } using { @ link ByteBuf # setBytes ( int , byte [ ] , int , int ) } . \n + * Unlike the { @ link # copy ( AsciiString , ByteBuf ) } and { @ link # copy ( AsciiString , int , ByteBuf , int ) } methods , \n + * this method do not increase a { @ code writerIndex } of { @ code dst } buffer . \n + * \n + * @ param src the source string to copy \n + * @ param srcIdx the starting offset of characters to copy \n + * @ param dst the destination buffer \n + * @ param dstIdx the starting offset in the destination buffer \n + * @ param length the number of characters to copy \n - * @ param src The source of the data to copy . \n - * @ param srcIdx the starting offset of characters to copy . \n - * @ param dst the destination byte array . \n - * @ param length the number of characters to copy . \n + * \n + * @ param src the source string to copy \n + * @ param srcIdx the starting offset of characters to copy \n + * @ param dst the destination buffer \n + * @ param length the number of characters to copy \n","Fixes a javadoc for ByteBufUtil # copy method \n Motivation : \n Javadoc of the ` ByteBufUtil # copy ( AsciiString , int , ByteBuf , int , int ) ` is incorrect . \n Modifications : \n Fix it . \n Result : \n The description of the ` # copy ` method is not misleading .",374
"handler \ src \ main \ java \ io \ netty \ handler \ logging \ LoggingHandler . java \n - chStr . length ( ) + 1 + eventName + 2 + arg1Str . length ( ) + 2 + arg2Str . length ( ) ) ; \n + chStr . length ( ) + 1 + eventName . length ( ) + 2 + arg1Str . length ( ) + 2 + arg2Str . length ( ) ) ; \n handler \ src \ test \ java \ io \ netty \ handler \ logging \ LoggingHandlerTest . java \n - verify ( appender ) . doAppend ( argThat ( \n - new RegexLogMatcher ( "" . + CONNECT : 0 . 0 . 0 . 0 / 0 . 0 . 0 . 0 : 80 , 0 . 0 . 0 . 0 / 0 . 0 . 0 . 0 : 81 $ "" ) ) ) ; \n + verify ( appender ) . doAppend ( argThat ( new RegexLogMatcher ( \n + "" ^ \ \ [ id : 0xembedded , L : embedded - R : embedded \ \ ] CONNECT : 0 . 0 . 0 . 0 / 0 . 0 . 0 . 0 : 80 , 0 . 0 . 0 . 0 / 0 . 0 . 0 . 0 : 81 $ "" ) ) ) ; \n",Fixes a LoggingHandler # format method with two arguments \n Motivation : \n Bug in capacity calculation : occurs auto convert to string instead of sum up . \n Modifications : \n Use ` eventName . length ( ) ` in sum . \n Result : \n Less trash in logs .,374
"codec \ src \ main \ java \ io \ netty \ handler \ codec \ compression \ FastLz . java \n - ref = anchor - 1 + 3 ; \n + ref = anchor + ( 3 - 1 ) ; \n common \ src \ main \ java \ io \ netty \ util \ internal \ StringUtil . java \n - int i ; \n - for ( i = 0 ; i < 10 ; i + + ) { \n - BYTE2HEX _ PAD [ i ] = "" 0 "" + i ; \n - BYTE2HEX _ NOPAD [ i ] = String . valueOf ( i ) ; \n - } \n - for ( ; i < 16 ; i + + ) { \n - char c = ( char ) ( ' a ' + i - 10 ) ; \n - BYTE2HEX _ PAD [ i ] = "" 0 "" + c ; \n - BYTE2HEX _ NOPAD [ i ] = String . valueOf ( c ) ; \n - } \n - for ( ; i < BYTE2HEX _ PAD . length ; i + + ) { \n + for ( int i = 0 ; i < BYTE2HEX _ PAD . length ; i + + ) { \n - BYTE2HEX _ PAD [ i ] = str ; \n + BYTE2HEX _ PAD [ i ] = i > 0xf ? str : ( ' 0 ' + str ) ; \n - return c - ' A ' + 0xA ; \n + return c - ( ' A ' - 0xA ) ; \n - return c - ' a ' + 0xA ; \n + return c - ( ' a ' - 0xA ) ; \n","The constants calculation in compile - time \n Motivation : \n Allow pre - computing calculation of the constants for compiler where it could be . \n Similar fix in OpenJDK : [ 1 ] . \n Modifications : \n - Use parentheses . \n - Simplify static initialization of ` BYTE2HEX _ * ` arrays in ` StringUtil ` . \n Result : \n Less bytecode , possible faster calculations at runtime . \n [ 1 ] https : / / bugs . openjdk . java . net / browse / JDK - 4477961",374
"buffer \ src \ main \ java \ io \ netty \ buffer \ AbstractByteBuf . java \n + ensureAccessible ( ) ; \n buffer \ src \ main \ java \ io \ netty \ buffer \ AbstractUnsafeSwappedByteBuf . java \n - wrapped . checkIndex0 ( index , 4 ) ; \n + wrapped . checkIndex ( index , 4 ) ; \n - wrapped . checkIndex0 ( index , 2 ) ; \n + wrapped . checkIndex ( index , 2 ) ; \n - wrapped . checkIndex0 ( index , 2 ) ; \n + wrapped . checkIndex ( index , 2 ) ; \n - wrapped . checkIndex0 ( index , 4 ) ; \n + wrapped . checkIndex ( index , 4 ) ; \n buffer \ src \ main \ java \ io \ netty \ buffer \ UnpooledHeapByteBuf . java \n + import io . netty . util . internal . EmptyArrays ; \n - ensureAccessible ( ) ; \n - array = null ; \n + array = EmptyArrays . EMPTY _ BYTES ; \n",Don ' t check accessible in the # capacity method ( # 7830 ) \n Motivation : \n The ` # ensureAccessible ` method in ` UnpooledHeapByteBuf # capacity ` used \n to prevent NPE if buffer is released and ` array ` is ` null ` . In all \n other implementations of ` ByteBuf ` the accessible is not checked by \n ` capacity ` method . We can assign an empty array to ` array ` \n in the ` deallocate ` and don ' t worry about NPE in the ` # capacity ` . \n This will help reduce the number of repeated calls of the \n ` # ensureAccessible ` in many operations with ` UnpooledHeapByteBuf ` . \n Modifications : \n 1 . Remove ` # ensureAccessible ` call from ` UnpooledHeapByteBuf # capacity ` . \n Use the ` EmptyArrays # EMPTY _ BYTES ` instead of ` null ` in ` # deallocate ` . \n 2 . Fix access checks in ` AbstractUnsafeSwappedByteBuf ` and \n ` AbstractByteBuf # slice ` that relied on ` # ensureAccessible ` \n in ` UnpooledHeapByteBuf # capacity ` . This was found by unit tests . \n Result : \n Less double calls of ` # ensureAccessible ` for ` UnpooledHeapByteBuf ` .,374
"buffer \ src \ main \ java \ io \ netty \ buffer \ ByteBufUtil . java \n - int hashCode = 1 ; \n + int hashCode = EmptyByteBuf . EMPTY _ BYTE _ BUF _ HASH _ CODE ; \n buffer \ src \ main \ java \ io \ netty \ buffer \ EmptyByteBuf . java \n + static final int EMPTY _ BYTE _ BUF _ HASH _ CODE = 1 ; \n - return 0 ; \n + return EMPTY _ BYTE _ BUF _ HASH _ CODE ; \n buffer \ src \ test \ java \ io \ netty \ buffer \ EmptyByteBufTest . java \n + \n + @ Test \n + public void consistentEqualsAndHashCodeWithAbstractBytebuf ( ) { \n + ByteBuf empty = new EmptyByteBuf ( UnpooledByteBufAllocator . DEFAULT ) ; \n + ByteBuf emptyAbstract = new UnpooledHeapByteBuf ( UnpooledByteBufAllocator . DEFAULT , 0 , 0 ) ; \n + assertEquals ( emptyAbstract , empty ) ; \n + assertEquals ( emptyAbstract . hashCode ( ) , empty . hashCode ( ) ) ; \n + assertEquals ( EmptyByteBuf . EMPTY _ BYTE _ BUF _ HASH _ CODE , empty . hashCode ( ) ) ; \n + assertTrue ( emptyAbstract . release ( ) ) ; \n + assertFalse ( empty . release ( ) ) ; \n + } \n","Makes ` EmptyByteBuf # hashCode ` and ` AbstractByteBuf # hashCode ` consistent ( # 7870 ) \n Motivation : \n The ` AbstractByteBuf # equals ` method doesn ' t take into account the \n class of buffer instance . So the two buffers with different classes \n must have the same ` hashCode ` values if ` equals ` method returns ` true ` . \n But ` EmptyByteBuf # hashCode ` is not consistent with ` # hashCode ` \n of the empty ` AbstractByteBuf ` , that is violates the contract and \n can lead to errors . \n Modifications : \n Return ` 1 ` in ` EmptyByteBuf # hashCode ` . \n Result : \n Consistent behavior of ` EmptyByteBuf # hashCode ` and ` AbstractByteBuf # hashCode ` .",374
"codec - http \ src \ main \ java \ io \ netty \ handler \ codec \ http \ cookie \ ClientCookieDecoder . java \n - return cookieBuilder . cookie ( ) ; \n + return cookieBuilder ! = null ? cookieBuilder . cookie ( ) : null ; \n codec - http \ src \ test \ java \ io \ netty \ handler \ codec \ http \ cookie \ ClientCookieDecoderTest . java \n + @ Test \n + public void testDecodingInvalidValuesWithCommaAtStart ( ) { \n + assertNull ( ClientCookieDecoder . STRICT . decode ( "" , "" ) ) ; \n + assertNull ( ClientCookieDecoder . STRICT . decode ( "" , a "" ) ) ; \n + assertNull ( ClientCookieDecoder . STRICT . decode ( "" , a = a "" ) ) ; \n + } \n + \n",Fixes NPE in ClientCookieDecoder \n Motivation : \n NPE in ` ClientCookieDecoder ` if cookie starts with comma . \n Modifications : \n Check ` cookieBuilder ` for ` null ` in the return . \n Result : \n No fails NPE on invalid cookies .,374
"codec - http2 \ src \ main \ java \ io \ netty \ handler \ codec \ http2 \ AbstractHttp2StreamChannel . java \n - private final class Http2StreamChannelConfig extends DefaultChannelConfig { \n + private static final class Http2StreamChannelConfig extends DefaultChannelConfig { \n resolver - dns \ src \ main \ java \ io \ netty \ resolver \ dns \ DnsNameResolver . java \n - private final class AddressedEnvelopeAdapter implements AddressedEnvelope < DnsResponse , InetSocketAddress > { \n + private static final class AddressedEnvelopeAdapter implements AddressedEnvelope < DnsResponse , InetSocketAddress > { \n",Make some inner classes static ( # 9624 ) \n Motivation : \n Classes ` AbstractHttp2StreamChannel . Http2StreamChannelConfig ` \n and ` DnsNameResolver . AddressedEnvelopeAdapter ` may be static : \n it doesn ' t reference its enclosing instance . \n Modification : \n Add ` static ` modifier . \n Result : \n Prevents a possible memory leak and uses less memory per class instance .,374
"codec - http2 \ src \ main \ java \ io \ netty \ handler \ codec \ http2 \ DefaultHttp2UnknownFrame . java \n - return new DefaultHttp2UnknownFrame ( frameType , flags , content ) . stream ( stream ( ) ) ; \n + return new DefaultHttp2UnknownFrame ( frameType , flags , content ) . stream ( stream ) ; \n - return StringUtil . simpleClassName ( this ) + "" ( frameType = "" + frameType ( ) + "" , stream = "" + stream ( ) + \n - "" , flags = "" + flags ( ) + "" , content = "" + contentToString ( ) + ' ) ' ; \n + return StringUtil . simpleClassName ( this ) + "" ( frameType = "" + frameType + "" , stream = "" + stream + \n + "" , flags = "" + flags + "" , content = "" + contentToString ( ) + ' ) ' ; \n - return super . equals ( other ) & & flags ( ) . equals ( other . flags ( ) ) \n - & & frameType ( ) = = other . frameType ( ) & & ( stream ( ) = = null & & other . stream ( ) = = null ) | | \n - stream ( ) . equals ( other . stream ( ) ) ; \n + Http2FrameStream otherStream = other . stream ( ) ; \n + return ( stream = = otherStream | | otherStream ! = null & & otherStream . equals ( stream ) ) \n + & & flags . equals ( other . flags ( ) ) \n + & & frameType = = other . frameType ( ) \n + & & super . equals ( other ) ; \n - hash = hash * 31 + frameType ( ) ; \n - hash = hash * 31 + flags ( ) . hashCode ( ) ; \n - if ( stream ( ) ! = null ) { \n - hash = hash * 31 + stream ( ) . hashCode ( ) ; \n + hash = hash * 31 + frameType ; \n + hash = hash * 31 + flags . hashCode ( ) ; \n + if ( stream ! = null ) { \n + hash = hash * 31 + stream . hashCode ( ) ; \n",Fix possible NPE in DefaultHttp2UnknownFrame # equals ( # 9625 ) \n Motivation : \n ` DefaultHttp2UnknownFrame # equals ` may produce NPE due to \n incorrect comparison of ` stream ` field . \n Modification : \n - Fix the ` stream ` field compare . \n - Cleanup usage of class fields : use direct access instead of getters \n ( because the class is final ) . \n Result : \n No NPE in ` equals ` method .,374
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + / * * \n + * Instantiate a new asynchronous HTTP request for the passed parameters . \n + * \n + * @ param client HttpClient to be used for request , can differ in single requests \n + * @ param contentType MIME body type , for POST and PUT requests , may be null \n + * @ param context Context of Android application , to hold the reference of request \n + * @ param httpContext HttpContext in which the request will be executed \n + * @ param responseHandler ResponseHandler or its subclass to put the response into \n + * @ param uriRequest instance of HttpUriRequest , which means it must be of HttpDelete , \n + * HttpPost , HttpGet , HttpPut , etc . \n + * @ return AsyncHttpRequest ready to be dispatched \n + * / \n + protected AsyncHttpRequest newAsyncHttpRequest ( DefaultHttpClient client , HttpContext httpContext , HttpUriRequest uriRequest , String contentType , ResponseHandlerInterface responseHandler , Context context ) { \n + return new AsyncHttpRequest ( client , httpContext , uriRequest , responseHandler ) ; \n + } \n + \n - AsyncHttpRequest request = new AsyncHttpRequest ( client , httpContext , uriRequest , responseHandler ) ; \n + AsyncHttpRequest request = newAsyncHttpRequest ( client , httpContext , uriRequest , contentType , responseHandler , context ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ SyncHttpClient . java \n - new AsyncHttpRequest ( client , httpContext , uriRequest , responseHandler ) . run ( ) ; \n + newAsyncHttpRequest ( client , httpContext , uriRequest , contentType , responseHandler , context ) . run ( ) ; \n",Allow developers to provide their own implementation for AsyncHttpRequest .,379
"sample \ src \ main \ AndroidManifest . xml \n - < activity android : name = "" . Http401Auth "" / > \n + < activity android : name = "" . Http401AuthSample "" / > \n rename from sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ Http401Auth . java \n rename to sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ Http401AuthSample . java \n + import java . util . Locale ; \n - public class Http401Auth extends GetSample { \n + public class Http401AuthSample extends GetSample { \n - String headerValueLowerCase = headerValue . toLowerCase ( ) ; \n + String headerValueLowerCase = headerValue . toLowerCase ( Locale . US ) ; \n - this . dialogView = LayoutInflater . from ( Http401Auth . this ) . inflate ( R . layout . credentials , null ) ; \n + this . dialogView = LayoutInflater \n + . from ( Http401AuthSample . this ) \n + . inflate ( R . layout . credentials , null , false ) ; \n - AlertDialog . Builder builder = new AlertDialog . Builder ( Http401Auth . this ) ; \n + AlertDialog . Builder builder = new AlertDialog . Builder ( Http401AuthSample . this ) ; \n sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ WaypointsActivity . java \n - new SampleConfig ( R . string . title _ 401 _ unauth , Http401Auth . class ) \n + new SampleConfig ( R . string . title _ 401 _ unauth , Http401AuthSample . class ) \n",Fixed LINT issues + renamed Http401Auth class .,379
"library \ src \ main \ java \ com \ loopj \ android \ http \ SaxAsyncHttpResponseHandler . java \n - } catch ( SAXException | ParserConfigurationException e ) { \n + } catch ( SAXException e ) { \n + Log . e ( LOG _ TAG , "" getResponseData exception "" , e ) ; \n + } catch ( ParserConfigurationException e ) { \n - \n - } \n + } \n",multi - catch statement is not supported in - source 1 . 5 .,379
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + * @ throws java . io . IOException \n - } catch ( Throwable t ) { \n + } catch ( IOException e ) { \n - responseHandler . sendFailureMessage ( 0 , null , null , t ) ; \n + responseHandler . sendFailureMessage ( 0 , null , null , e ) ; \n - t . printStackTrace ( ) ; \n + e . printStackTrace ( ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n - } catch ( Throwable t ) { \n - Log . e ( LOG _ TAG , "" Cannot create temporary file "" , t ) ; \n + } catch ( IOException e ) { \n + Log . e ( LOG _ TAG , "" Cannot create temporary file "" , e ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ MyRedirectHandler . java \n + @ Override \n + @ Override \n library \ src \ main \ java \ com \ loopj \ android \ http \ PersistentCookieStore . java \n + \n + import java . io . IOException ; \n + \n - } catch ( Exception e ) { \n + } catch ( IOException e ) { \n + Log . d ( LOG _ TAG , "" IOException in encodeCookie "" , e ) ; \n - } catch ( Exception exception ) { \n - Log . d ( LOG _ TAG , "" decodeCookie failed "" , exception ) ; \n + } catch ( IOException e ) { \n + Log . d ( LOG _ TAG , "" IOException in decodeCookie "" , e ) ; \n + } catch ( ClassNotFoundException e ) { \n + Log . d ( LOG _ TAG , "" ClassNotFoundException in decodeCookie "" , e ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ SaxAsyncHttpResponseHandler . java \n + * @ param < T > Handler extending { @ link org . xml . sax . helpers . DefaultHandler } \n + * @ return deconstructed response \n + * @ throws java . io . IOException \n","Fix Javadoc , Add @ Override , Stricter exception handling .",379
"sample \ src \ main \ res \ values \ strings . xml \n - < resources > \n + < resources > \n + \n + < string name = "" button _ run "" > Run < / string > \n + < string name = "" label _ headers "" > Headers ( key = val , one per line ) < / string > \n + < string name = "" label _ req _ body "" > Request body < / string > \n + < string name = "" button _ cancel "" > Cancel < / string > \n + \n - < string name = "" button _ run "" > Run < / string > \n - < string name = "" label _ headers "" > Headers ( key = val , one per line ) < / string > \n - < string name = "" label _ req _ body "" > Request body < / string > \n - < string name = "" button _ cancel "" > Cancel < / string > \n","Restructure strings . xml file a bit , new samples added at the end .",379
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpRequest . java \n + * Please note : pre - processing does NOT run on the main thread , and thus \n + * any UI activities that you must perform should be properly dispatched to \n + * the app ' s UI thread . \n + * \n + * Please note : post - processing does NOT run on the main thread , and thus \n + * any UI activities that you must perform should be properly dispatched to \n + * the app ' s UI thread . \n + * \n library \ src \ main \ java \ com \ loopj \ android \ http \ ResponseHandlerInterface . java \n + * Please note : pre - processing does NOT run on the main thread , and thus \n + * any UI activities that you must perform should be properly dispatched to \n + * the app ' s UI thread . \n + * \n + * Please note : post - processing does NOT run on the main thread , and thus \n + * any UI activities that you must perform should be properly dispatched to \n + * the app ' s UI thread . \n + * \n",Add a note about which thread calls pre - and post - processing methods .,379
"library \ src \ main \ java \ com \ loopj \ android \ http \ JsonStreamerEntity . java \n + } else if ( value instanceof JsonValueInterface ) { \n + os . write ( ( ( JsonValueInterface ) value ) . getEscapedJsonValue ( ) ) ; \n new file \n library \ src \ main \ java \ com \ loopj \ android \ http \ JsonValueInterface . java \n + / * \n + Android Asynchronous Http Client \n + Copyright ( c ) 2011 James Smith < james @ loopj . com > \n + http : / / loopj . com \n + \n + Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + you may not use this file except in compliance with the License . \n + You may obtain a copy of the License at \n + \n + http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + \n + Unless required by applicable law or agreed to in writing , software \n + distributed under the License is distributed on an "" AS IS "" BASIS , \n + WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + See the License for the specific language governing permissions and \n + limitations under the License . \n + * / \n + \n + package com . loopj . android . http ; \n + \n + / * * \n + * This interface is used to encapsulate JSON values that are handled entirely \n + * by the app . For example , apps could manage any type of JSON on their own ( and \n + * not rely on { @ link org . json . JSONArray } or { @ link org . json . JSONObject } to \n + * exchange data . \n + * \n + * @ author Noor Dawod < github @ fineswap . com > \n + * / \n + public interface JsonValueInterface { \n + \n + / * * \n + * Returns the escaped , ready - to - be used value of this encapsulated object . \n + * \n + * @ return byte array holding the data to be used ( as - is ) in a JSON object \n + * / \n + byte [ ] getEscapedJsonValue ( ) ; \n + } \n",Introduce an interface for adding arbitrary JSON objects .,379
library \ src \ main \ java \ com \ loopj \ android \ http \ JsonStreamerEntity . java \n + } else if ( value instanceof org . json . JSONObject ) { \n + os . write ( ( ( org . json . JSONObject ) value ) . toString ( ) . getBytes ( ) ) ; \n + } else if ( value instanceof org . json . JSONArray ) { \n + os . write ( ( ( org . json . JSONArray ) value ) . toString ( ) . getBytes ( ) ) ; \n,Check for internal org . json . JSON * classes when sending content .,379
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - if ( responseHandler . getUseSynchronousMode ( ) ) { \n + if ( responseHandler . getUseSynchronousMode ( ) & & ! responseHandler . getUsePoolThread ( ) ) { \n library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n + private boolean usePoolThread ; \n + @ Override \n + public boolean getUsePoolThread ( ) { \n + return usePoolThread ; \n + } \n + \n + @ Override \n + public void setUsePoolThread ( boolean pool ) { \n + / / If pool thread is to be used , there ' s no point in keeping a reference \n + / / to the looper and no need for a handler . \n + if ( pool ) { \n + looper = null ; \n + handler = null ; \n + } \n + \n + usePoolThread = pool ; \n + } \n + \n + / / Do not use the pool ' s thread to run the handler . \n + setUsePoolThread ( false ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ BaseJsonHttpResponseHandler . java \n - if ( ! getUseSynchronousMode ( ) ) { \n + if ( ! getUseSynchronousMode ( ) & & ! getUsePoolThread ( ) ) { \n - if ( ! getUseSynchronousMode ( ) ) { \n + if ( ! getUseSynchronousMode ( ) & & ! getUsePoolThread ( ) ) { \n library \ src \ main \ java \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n - if ( ! getUseSynchronousMode ( ) ) { \n + if ( ! getUseSynchronousMode ( ) & & ! getUsePoolThread ( ) ) { \n - if ( ! getUseSynchronousMode ( ) ) { \n + if ( ! getUseSynchronousMode ( ) & & ! getUsePoolThread ( ) ) { \n library \ src \ main \ java \ com \ loopj \ android \ http \ ResponseHandlerInterface . java \n + / * * \n + * Sets whether the handler should be executed on the pool ' s thread or the \n + * UI thread \n + * \n + * @ param usePoolThread if the ResponseHandler should run on pool ' s thread \n + * / \n + void setUsePoolThread ( boolean usePoolThread ) ; \n + \n + / * * \n + * Returns whether the handler should be executed on the pool ' s thread \n + * or the UI thread \n + * \n + * @ return boolean if the ResponseHandler should run on pool ' s thread \n + * / \n + boolean getUsePoolThread ( ) ; \n + \n","Enable responses to be fired on the same thread which was used in the request . \n This is handy in situations where more work needs to be done on the thread which doesn ' t require UI changes , like for example processing JSON responses , parsing images , etc .",379
"library \ src \ main \ java \ com \ loopj \ android \ http \ BinaryHttpResponseHandler . java \n + status . getStatusCode ( ) , \n + response . getAllHeaders ( ) , \n + null , \n + new HttpResponseException ( \n - response . getAllHeaders ( ) , \n - null , \n - new HttpResponseException ( \n - status . getStatusCode ( ) , \n - "" None , or more than one , Content - Type Header found ! "" \n - ) \n + "" None , or more than one , Content - Type Header found ! "" \n + ) \n + status . getStatusCode ( ) , \n + response . getAllHeaders ( ) , \n + null , \n + new HttpResponseException ( \n - response . getAllHeaders ( ) , \n - null , \n - new HttpResponseException ( \n - status . getStatusCode ( ) , \n - "" Content - Type not allowed ! "" \n - ) \n + "" Content - Type ( "" + contentTypeHeader . getValue ( ) + "" ) not allowed ! "" \n + ) \n","Show response content type which is not allowed . \n Plus , keep 4 - spaces indentation correct .",379
"library \ src \ main \ java \ com \ loopj \ android \ http \ JsonStreamerEntity . java \n - private static final byte [ ] STREAM _ ELAPSED = escape ( "" _ elapsed "" ) ; \n - private final String elapsedField ; \n + private final byte [ ] elapsedField ; \n - this . elapsedField = elapsedField ; \n + this . elapsedField = TextUtils . isEmpty ( elapsedField ) \n + ? null \n + : escape ( elapsedField ) ; \n - OutputStream os = null ! = contentEncoding \n + OutputStream os = contentEncoding ! = null \n - if ( ! TextUtils . isEmpty ( elapsedField ) | | keysProcessed < keysCount ) { \n + if ( elapsedField ! = null | | keysProcessed < keysCount ) { \n - if ( ! TextUtils . isEmpty ( elapsedField ) ) { \n - os . write ( STREAM _ ELAPSED ) ; \n + if ( elapsedField ! = null ) { \n + os . write ( elapsedField ) ; \n",Forgot to use the new field name : ),379
pom . xml \n - < phase > compile < / phase > \n + < phase > test < / phase > \n,Move compilation of Clojure test source to the right phase . \n It was getting compiled before the Java test code was getting compiled . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,393
"build . xml \n - < delete dir = "" $ { test - classes } "" / > \n - < ! - - < javac srcdir = "" $ { jtestsrc } "" destdir = "" $ { test - classes } "" includeJavaRuntime = "" yes "" - - > \n - < ! - - debug = "" true "" source = "" 1 . 5 "" target = "" 1 . 5 "" includeantruntime = "" no "" / > - - > \n + < javac srcdir = "" $ { jtestsrc } "" destdir = "" $ { test - classes } "" includeJavaRuntime = "" yes "" \n + debug = "" true "" source = "" 1 . 5 "" target = "" 1 . 5 "" includeantruntime = "" no "" / > \n",Compile Java test source in the ant build . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,393
rename from src \ jvm \ clojure \ test \ ReflectorTryCatchFixture . java \n rename to test \ java \ clojure \ test \ ReflectorTryCatchFixture . java \n,Move ReflectorTryCatchFixture to the test directory . \n It was getting packaged up in the jar . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,393
"test \ clojure \ test _ clojure \ try _ catch . clj \n + ( defn make - instance [ ] \n + ( ReflectorTryCatchFixture . ) ) \n + \n - ( is ( thrown - with - msg ? ReflectorTryCatchFixture $ Cookies # "" Double "" ( fail 1 . 0 ) ) ) ) \n - \n + ( is ( thrown - with - msg ? ReflectorTryCatchFixture $ Cookies # "" Double "" ( fail 1 . 0 ) ) ) \n + ( is ( thrown - with - msg ? ReflectorTryCatchFixture $ Cookies # "" Wrapped "" \n + ( . failWithCause ( make - instance ) 1 . 0 ) ) ) ) \n test \ java \ clojure \ test \ ReflectorTryCatchFixture . java \n + public void failWithCause ( Double y ) throws Cookies { \n + throw new Cookies ( "" Wrapped "" , new Cookies ( "" Cause "" ) ) ; \n + } \n + \n + public Cookies ( String msg , Throwable cause ) { super ( msg , cause ) ; } \n",Add test for extra unwrapping . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,393
"src \ jvm \ clojure \ lang \ Reflector . java \n - try \n - { \n - Class c = target . getClass ( ) ; \n - List methods = getMethods ( c , args . length , methodName , false ) ; \n - return invokeMatchingMethod ( methodName , methods , target , args ) ; \n - } \n - catch ( Exception e ) \n - { \n - throw Util . sneakyThrow ( getCauseOrElse ( e ) ) ; \n - } \n + Class c = target . getClass ( ) ; \n + List methods = getMethods ( c , args . length , methodName , false ) ; \n + return invokeMatchingMethod ( methodName , methods , target , args ) ; \n - try \n - { \n - return invokeStaticMethod ( c , methodName , args ) ; \n - } \n - catch ( Exception e ) \n - { \n - throw Util . sneakyThrow ( getCauseOrElse ( e ) ) ; \n - } \n + return invokeStaticMethod ( c , methodName , args ) ; \n",Don ' t double unwrap when calling an instance method . \n Signed - off - by : Stuart Halloway < stu @ thinkrelevance . com >,393
"src \ jvm \ clojure \ lang \ Compiler . java \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n - gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n + gen . visitLineNumber ( line , gen . mark ( ) ) ; \n","Mark line number after emitting children . \n Marking the line number before emitting children leads to incorrect line numbers \n when a runtime error occurs . For example , when \n ( foo bar \n baz ) \n is emitted the compiler will visit the line number for the expression , then emit \n the children expressions ( ' bar ' and ' baz ' ) which will mark their own line \n numbers , then come back and emit the invoke bytecode for ' foo ' , but since the \n last line number to be marked was that of ' baz ' , if ' foo ' throws an exception \n the line number of ' baz ' will be reported instead of the line number for the \n expression as a whole . \n This same issue was being manifested with special forms and inlined functions , \n and was especially bad in the case of the threading macro ' - > ' , because it is \n usually spread across several lines , and the line number reported could end up \n being very different than the line actually causing an exception . \n Signed - off - by : Stuart Halloway < stu @ cognitect . com >",393
"modules \ http \ src \ retrofit \ http \ HttpMethodType . java \n + import org . apache . http . protocol . HTTP ; \n - request . setEntity ( new UrlEncodedFormEntity ( paramList ) ) ; \n + / / TODO : Use specified encoding . ( See CallbackResponseHandler et al ) \n + request . setEntity ( new UrlEncodedFormEntity ( paramList , HTTP . UTF _ 8 ) ) ; \n",Fixes failure to transmit interesting unicode characters \n by specifying HTTP . UTF _ 8 in UrlEncodedFormEntity .,411
"http \ src \ main \ java \ retrofit \ http \ HttpRequestBuilder . java \n - import javax . inject . Named ; \n + import javax . inject . Named ; \n + import java . io . UnsupportedEncodingException ; \n + import java . net . URLEncoder ; \n - replacedPath = doReplace ( replacedPath , found . getName ( ) , found . getValue ( ) ) ; \n + String value ; \n + try { \n + value = URLEncoder . encode ( found . getValue ( ) , "" UTF - 8 "" ) ; \n + } catch ( UnsupportedEncodingException e ) { \n + throw new AssertionError ( e ) ; \n + } \n + replacedPath = doReplace ( replacedPath , found . getName ( ) , value ) ; \n http \ src \ test \ java \ retrofit \ http \ HttpRequestBuilderTest . java \n + import java . net . URLEncoder ; \n - public void testRegex ( ) throws Exception { \n + @ Test public void testRegex ( ) throws Exception { \n + @ Test public void testGetWithPathParamAndWhitespaceValue ( ) throws Exception { \n + Method method = \n + MyService . class . getMethod ( "" getWithPathParam "" , String . class , String . class , Callback . class ) ; \n + String expectedId = "" I have spaces buddy "" ; \n + String category = UUID . randomUUID ( ) . toString ( ) ; \n + Object [ ] args = new Object [ ] { expectedId , category , new MyCallback ( ) } ; \n + HttpUriRequest request = build ( method , args ) ; \n + \n + assertThat ( request ) . isInstanceOf ( HttpGet . class ) ; \n + \n + HttpGet put = ( HttpGet ) request ; \n + / / Make sure the url param got translated . \n + final String uri = put . getURI ( ) . toString ( ) ; \n + assertThat ( uri ) . isEqualTo ( API _ URL + "" / foo / "" + URLEncoder . encode ( expectedId , "" UTF - 8 "" ) + "" / bar ? category = "" + category ) ; \n + } \n + \n",Allows spaces to appear in path parameters .,411
android - native \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n android \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n core \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n http \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n io \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n sample - android \ pom . xml \n - < version > 0 . 6 . 0 - SNAPSHOT < / version > \n + < version > 0 . 6 . 0 - rc3 < / version > \n,Publishing 0 . 6 . 0 - rc3,411
android - native \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n android \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n core \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n http \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n io \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n sample - android \ pom . xml \n - < version > 0 . 6 . 0 - rc3 < / version > \n + < version > 0 . 6 . 0 - SNAPSHOT < / version > \n,Restore version 0 . 6 . 0 - SNAPSHOT,411
"picasso \ src \ main \ java \ com \ squareup \ picasso \ Picasso . java \n + private static final String FILE _ URL _ PREFIX = "" file : / / / "" ; \n + if ( path . startsWith ( FILE _ URL _ PREFIX ) ) { \n + return load ( new File ( path . substring ( FILE _ URL _ PREFIX . length ( ) ) ) ) ; \n + } \n picasso \ src \ test \ java \ com \ squareup \ picasso \ PicassoTest . java \n + private static final String FILE _ 1 _ URL = "" file : / / / "" + FILE _ 1 . getPath ( ) ; \n + @ Test public void loadFileUrlIntoImageView ( ) throws Exception { \n + ImageView target = mock ( ImageView . class ) ; \n + \n + Picasso picasso = create ( LOADER _ ANSWER , BITMAP1 _ ANSWER ) ; \n + picasso . load ( FILE _ 1 _ URL ) . into ( target ) ; \n + \n + verifyZeroInteractions ( target ) ; \n + executor . flush ( ) ; \n + verifyZeroInteractions ( loader ) ; \n + verify ( target ) . setImageBitmap ( bitmap1 ) ; \n + } \n + \n + @ Test public void loadFileUrlIntoTarget ( ) throws Exception { \n + Target target = mock ( Target . class ) ; \n + \n + Picasso picasso = create ( LOADER _ ANSWER , BITMAP1 _ ANSWER ) ; \n + picasso . load ( FILE _ 1 _ URL ) . into ( target ) ; \n + \n + verifyZeroInteractions ( target ) ; \n + executor . flush ( ) ; \n + verify ( target ) . onSuccess ( bitmap1 ) ; \n + assertThat ( picasso . targetsToRequests ) . isEmpty ( ) ; \n + } \n + \n","Treats "" file : / / / "" urls as files .",411
"picasso \ src \ main \ java \ com \ squareup \ picasso \ Picasso . java \n + if ( contentResolver = = null ) { \n + throw new IllegalStateException ( \n + "" Cannot handle content : / / urls if built without a ContentResolver : "" \n + + request . path ) ; \n + } \n - throw new IllegalArgumentException ( "" contentResolver may not be null . "" ) ; \n + throw new IllegalArgumentException ( "" ContentResolver may not be null . "" ) ; \n - if ( this . loader ! = null ) { \n - throw new IllegalStateException ( "" contentResolver already set . "" ) ; \n + if ( this . contentResolver ! = null ) { \n + throw new IllegalStateException ( "" ContentResolver already set . "" ) ; \n",Fixes per content : / / review .,411
"retrofit - converters \ wire \ src \ main \ java \ retrofit \ converter \ WireConverter . java \n - throw new IllegalArgumentException ( "" Expected a proto but was : "" + body . mimeType ( ) ) ; \n + throw new ConversionException ( "" Expected a proto but was : "" + body . mimeType ( ) ) ; \n retrofit - converters \ wire \ src \ test \ java \ retrofit \ converter \ WireConverterTest . java \n - } catch ( IllegalArgumentException e ) { \n + } catch ( ConversionException e ) { \n",Unexpected mime type should be a ConversionException .,411
"core \ java \ android \ net \ CaptivePortal . java \n - import android . annotation . IntDef ; \n - import com . android . internal . logging . nano . MetricsProto . MetricsEvent ; \n - \n - / * * @ hide * / \n - @ IntDef ( value = { \n - MetricsEvent . ACTION _ CAPTIVE _ PORTAL _ LOGIN _ ACTIVITY , \n - MetricsEvent . ACTION _ CAPTIVE _ PORTAL _ LOGIN _ RESULT _ DISMISSED , \n - MetricsEvent . ACTION _ CAPTIVE _ PORTAL _ LOGIN _ RESULT _ UNWANTED , \n - MetricsEvent . ACTION _ CAPTIVE _ PORTAL _ LOGIN _ RESULT _ WANTED _ AS _ IS , \n - MetricsEvent . CAPTIVE _ PORTAL _ LOGIN _ ACTIVITY _ SSL _ ERROR , \n - } ) \n - public @ interface EventId { \n - } \n - \n - public void logEvent ( @ EventId int eventId , @ NonNull String packageName ) { \n + public void logEvent ( int eventId , @ NonNull String packageName ) { \n","Remove CaptivePortal deps on @ hide MetricEvents \n The legacy metrics are deprecated , and CaptivePortal is planned to move \n to a connectivity - specific jar which cannot reference MetricsEvents . \n Bug : 171540887 \n Test : m \n Change - Id : I409375de3844a7fedef707cf9e19a106d82a8e3a",414
"core \ java \ android \ app \ SystemServiceRegistry . java \n - import android . net . ConnectivityThread ; \n - return new LowpanManager ( ctx . getOuterContext ( ) , service , \n - ConnectivityThread . getInstanceLooper ( ) ) ; \n + return new LowpanManager ( ctx . getOuterContext ( ) , service ) ; \n lowpan \ java \ android \ net \ lowpan \ LowpanManager . java \n + \n + import com . android . internal . annotations . VisibleForTesting ; \n + import com . android . internal . os . BackgroundThread ; \n + \n - * @ param looper the default Looper to run callbacks on \n + public LowpanManager ( Context context , ILowpanManager service ) { \n + this ( context , service , BackgroundThread . get ( ) . getLooper ( ) ) ; \n + } \n + \n + @ VisibleForTesting \n","Run LowpanManager on BackgroundThread \n The ConnectivityThread class is being separated into a specific \n connectivity JAR ; transport - specific managers like LowpanManager should \n not be sharing the ConnectivityThread . \n As callbacks from ILowpanManager / ILowpanManagerListener already do not \n have any ordering guarantee with ConnectivityManager callbacks , the \n impact of this change should be minimal . \n LowpanManager is unused in AOSP , and not part of the API . \n Bug : 174436414 \n Test : m \n Change - Id : I23483ed7c4a6c5283b365430a3e503a0dd86c2cb",414
"tests \ net \ common \ java \ android \ net \ NetworkProviderTest . kt \n + import com . android . testutils . isDevSdkInRange \n - val provider = createNetworkProvider ( mockContext ) \n - / / ConnectivityManager not required at creation time \n - verifyNoMoreInteractions ( mockContext ) \n + val provider = createNetworkProvider ( mockContext ) \n + / / ConnectivityManager not required at creation time after R \n + if ( ! isDevSdkInRange ( 0 , Build . VERSION _ CODES . R ) ) { \n + verifyNoMoreInteractions ( mockContext ) \n + } \n","Fix testDeclareNetworkRequestUnfulfillable on R \n NetworkProvider does not require ConnectivityService to be started at \n creation time after R , but on R it is queried in the constructor . \n Fixes : 175164957 \n Test : atest FrameworksNetTests \n Change - Id : I435ace581668970a7d88e68f11cb37814edb79ea",414
"new file \n core \ java \ android \ net \ TEST _ MAPPING \n + { \n + "" imports "" : [ \n + { \n + / / Also includes cts / tests / tests / net \n + "" path "" : "" frameworks / base / tests / net "" \n + } , \n + { \n + "" path "" : "" packages / modules / NetworkStack "" \n + } , \n + { \n + "" path "" : "" packages / modules / CaptivePortalLogin "" \n + } , \n + { \n + "" path "" : "" frameworks / base / packages / Tethering "" \n + } , \n + { \n + "" path "" : "" frameworks / opt / net / wifi "" \n + } \n + ] \n + } \n new file \n services \ net \ TEST _ MAPPING \n + { \n + "" imports "" : [ \n + { \n + "" path "" : "" frameworks / base / core / java / android / net "" \n + } \n + ] \n + } \n tests \ net \ TEST _ MAPPING \n + ] , \n + "" imports "" : [ \n + { \n + "" path "" : "" cts / tests / tests / net "" \n + } \n",Add imports to networking test mapping \n Ensure that appropriate networking tests are triggered when submitting \n changes in the frameworks / base directories . \n Change - Id : Ibf8b567fa7721299120b0a6c6836dd770d92a9fc \n Test : treehugger runs TEST _ MAPPING tests,414
"services \ core \ jni \ Android . bp \n - "" com _ android _ server _ connectivity _ Vpn . cpp "" , \n + / / TODO : move the file below to the connectivity APEX \n + "" com _ android _ server _ connectivity _ Vpn . cpp "" , \n",Move VPN JNI to the bottom of srcs \n This is a no - op change in preparation of a bigger topic to create the \n tethering + connectivity APEXes . This change allows the topic to avoid \n merge conflicts between branches . \n Bug : 171540887 \n Test : m \n Merged - In : I3ab497f2133c9020131ca4392f34aedb8da99cc9 \n Change - Id : I3ab497f2133c9020131ca4392f34aedb8da99cc9,414
"services \ core \ java \ com \ android \ server \ SystemServiceManager . java \n + import android . os . Build ; \n + import com . android . internal . os . ClassLoaderFactory ; \n - pathClassLoader = new PathClassLoader ( path , this . getClass ( ) . getClassLoader ( ) ) ; \n + pathClassLoader = ( PathClassLoader ) ClassLoaderFactory . createClassLoader ( \n + path , null / * librarySearchPath * / , null / * libraryPermittedPath * / , \n + this . getClass ( ) . getClassLoader ( ) , Build . VERSION . SDK _ INT , \n + true / * isNamespaceShared * / , null / * classLoaderName * / ) ; \n","Create linker namespace in startServiceFromJar \n Previously the classloader would have no initialized linker namespace , \n so JNI libraries associated with a JAR in an APEX would not be found . \n Use ClassLoaderFactory to ensure that the linker namespace is \n initialized . \n Bug : 172541385 \n Test : manual : boot device with system server JAR using JNI in APEX \n Merged - In : Icc94c70b3e3817aa637c32f1190faa41364e1604 \n Change - Id : Icc94c70b3e3817aa637c32f1190faa41364e1604",414
tests \ net \ common \ java \ android \ net \ OemNetworkPreferencesTest . java \n - import androidx . test . runner . AndroidJUnit4 ; \n + import com . android . testutils . DevSdkIgnoreRunner ; \n - @ RunWith ( AndroidJUnit4 . class ) \n + @ RunWith ( DevSdkIgnoreRunner . class ) \n,Run OemNetworkPreferencesTest with DevSdkIgnoreRunner \n The class - level @ IgnoreUpTo annotation only applies with that runner . \n Change - Id : I065618f2345c1d91de2fa1f2f558e5ed5b066f3e \n Fixes : 174268969 \n Bug : 171505922 \n Test : atest FrameworksNetTests : android . net . OemNetworkPreferencesTest,414
apex \ jobscheduler \ framework \ java \ android \ app \ job \ JobInfo . java \n - } else if ( networkRequest . networkCapabilities . hasCapability ( NET _ CAPABILITY _ NOT _ METERED ) ) { \n + } else if ( networkRequest . hasCapability ( NET _ CAPABILITY _ NOT _ METERED ) ) { \n - } else if ( networkRequest . networkCapabilities . hasCapability ( NET _ CAPABILITY _ NOT _ ROAMING ) ) { \n + } else if ( networkRequest . hasCapability ( NET _ CAPABILITY _ NOT _ ROAMING ) ) { \n - } else if ( networkRequest . networkCapabilities . hasTransport ( TRANSPORT _ CELLULAR ) ) { \n + } else if ( networkRequest . hasTransport ( TRANSPORT _ CELLULAR ) ) { \n - & & mNetworkRequest . networkCapabilities . getNetworkSpecifier ( ) ! = null ) { \n + & & mNetworkRequest . getNetworkSpecifier ( ) ! = null ) { \n,Remove JobInfo usage of NetworkRequest # networkCaps \n NetworkRequest # networkCapabilities is an implementation detail ( not part \n of the NetworkRequest API ) ; NetworkRequest has getters that return the \n same information . \n Bug : 174436414 \n Bug : 142281756 \n Test : m \n Merged - In : I47e7ab1b887b2fe2dddef223bd7c66bdd290fc56 \n Change - Id : I47e7ab1b887b2fe2dddef223bd7c66bdd290fc56,414
"core \ java \ android \ net \ NetworkProvider . java \n - private final ConnectivityManager mCm ; \n + private final Context mContext ; \n - mCm = ConnectivityManager . from ( context ) ; \n - \n + mContext = context ; \n - mCm . declareNetworkRequestUnfulfillable ( request ) ; \n + ConnectivityManager . from ( mContext ) . declareNetworkRequestUnfulfillable ( request ) ; \n tests \ net \ common \ java \ android \ net \ NetworkProviderTest . kt \n + import org . mockito . Mockito . doReturn \n + import org . mockito . Mockito . mock \n + import org . mockito . Mockito . verifyNoMoreInteractions \n - private fun createNetworkProvider ( ) : TestNetworkProvider { \n - return TestNetworkProvider ( context , mHandlerThread . looper ) \n + private fun createNetworkProvider ( ctx : Context = context ) : TestNetworkProvider { \n + return TestNetworkProvider ( ctx , mHandlerThread . looper ) \n - val provider = createNetworkProvider ( ) \n + val mockContext = mock ( Context : : class . java ) \n + val provider = createNetworkProvider ( mockContext ) \n + / / ConnectivityManager not required at creation time \n + verifyNoMoreInteractions ( mockContext ) \n + doReturn ( mCm ) . ` when ` ( mockContext ) . getSystemService ( Context . CONNECTIVITY _ SERVICE ) \n + \n","Do not query CS in NetworkProvider constructor \n ConnectivityService may not be available in a NetworkProvider \n constructor , if it is created ( but still unused ) before \n ConnectivityService starts . \n As ConnectivityManager is only necessary in \n declareNetworkRequestUnfulfillable , which should not be called often , \n just query ConnectivityManager at that point . \n This is necessary for VcnManagementService , which is started before \n ConnectivityService and creates its NetworkProvider in its constructor . \n Fortunately VcnManagementService does not call \n declareNetworkRequestUnfulfillable at this point . \n ConnectivityManager may be migrated to classic service getters that \n cache "" null "" when the service was not available the first time it is \n queried , so no system service must query it before it starts . \n Bug : 171540887 \n Test : atest FrameworksNetTests : NetworkProviderTest \n Change - Id : I8dadcd0e1360a9464192f330493e13aa69dd9fe2",414
"core \ java \ android \ net \ NetworkIdentity . java \n - import static android . net . ConnectivityManager . isNetworkTypeMobile ; \n - import android . util . Slog ; \n - if ( isNetworkTypeMobile ( type ) ) { \n - if ( state . subscriberId = = null ) { \n - if ( state . networkInfo . getState ( ) ! = NetworkInfo . State . DISCONNECTED & & \n - state . networkInfo . getState ( ) ! = NetworkInfo . State . UNKNOWN ) { \n - Slog . w ( TAG , "" Active mobile network without subscriber ! ni = "" \n - + state . networkInfo ) ; \n - } \n - } \n - \n - subscriberId = state . subscriberId ; \n + subscriberId = state . subscriberId ; \n - } else if ( type = = TYPE _ WIFI ) { \n + if ( type = = TYPE _ WIFI ) { \n","Set NetworkIdentity subscriberId on all networks \n Instead of setting NetworkIdentity . subscriberId only on telephony \n networks , set it when provided on any network . At the moment only \n telephony is expected to have a subscriberId in its NetworkState anyway , \n and while there are plans for other network agents ( wifi ) to have a \n subscriberId , it should also be set in that case . \n This allows NetworkIdentity to stop depending on hidden network type \n APIs to determine if the network is mobile . \n Bug : 174436414 \n Test : atest FrameworksNetTests \n Change - Id : I4f09987f8737d1801342eb5d6d7c2b9968b466b0",414
"core \ java \ android \ net \ Ikev2VpnProfile . java \n - import static android . net . PlatformVpnProfile . TYPE _ IKEV2 _ IPSEC _ PSK ; \n - import static android . net . PlatformVpnProfile . TYPE _ IKEV2 _ IPSEC _ RSA ; \n - import static android . net . PlatformVpnProfile . TYPE _ IKEV2 _ IPSEC _ USER _ PASS ; \n - \n + import static com . android . net . module . util . NetworkStackConstants . IPV6 _ MIN _ MTU ; \n - if ( mMaxMtu < LinkProperties . MIN _ MTU _ V6 ) { \n - throw new IllegalArgumentException ( \n - "" Max MTU must be at least "" + LinkProperties . MIN _ MTU _ V6 ) ; \n + if ( mMaxMtu < IPV6 _ MIN _ MTU ) { \n + throw new IllegalArgumentException ( "" Max MTU must be at least "" + IPV6 _ MIN _ MTU ) ; \n - if ( mtu < LinkProperties . MIN _ MTU _ V6 ) { \n - throw new IllegalArgumentException ( \n - "" Max MTU must be at least "" + LinkProperties . MIN _ MTU _ V6 ) ; \n + if ( mtu < IPV6 _ MIN _ MTU ) { \n + throw new IllegalArgumentException ( "" Max MTU must be at least "" + IPV6 _ MIN _ MTU ) ; \n core \ java \ android \ net \ LinkProperties . java \n - / * * @ hide * / \n - public static final int MIN _ MTU _ V6 = 1280 ; \n + private static final int MIN _ MTU _ V6 = 1280 ; \n","Use IPV6 _ MIN _ MTU from NetworkConstants in Ikev2Vpn \n Instead of sharing the constant from LinkProperties , use the already \n defined constant in the NetworkConstants class . \n This allows Ikev2VpnProfile to allow depending on non - public \n LinkProperties APIs , as LinkProperties is planned to move to \n framework - connectivity . \n Bug : 174436414 \n Test : m \n Change - Id : I594bb7e81bc7681799c16eff621a5ffd1b29624c",414
core \ api \ system - current . txt \n + field @ Deprecated public static final int TYPE _ PROXY = 16 ; / / 0x10 \n core \ java \ android \ net \ ConnectivityManager . java \n - @ UnsupportedAppUsage \n + @ SystemApi \n,"Add ConnectivityManager . TYPE _ PROXY to SystemApi \n This follows other TYPE _ * constants like TYPE _ WIFI _ P2P that are \n @ SystemApi or public . \n TYPE _ PROXY has a use - case for the system to set network policies based \n on proxy network templates . Although network types are deprecated , that \n use - case needs to be supported and significant amounts of network \n management would need to be rewritten to stop using network types . \n The constant needs to be API as ConnectivityManager is planned to move \n out of framework . jar , so only its formal API will be available to the \n system server . \n Bug : 174436414 \n Test : m \n Change - Id : I266ed6bc59f5eb72302afe14472c93933733c8f8",414
new file \n packages \ Connectivity \ OWNERS \n + set noparent \n + \n + include platform / frameworks / base : / services / core / java / com / android / server / net / OWNERS \n,"Add OWNERS for packages / Connectivity \n In preparation of future modularization of connectivity classes , a large \n part of frameworks / base / services / net is planned to be moved to \n packages / modules / Connectivity . However moving each class "" manually "" \n to that git project would lose their commit history , and require many \n cross - repository topics . \n To facilitate the work , create frameworks / base / packages / Connectivity , \n which will be used to move the classes at first , before they can all be \n moved together with their history to packages / modules / Connectivity . This \n mirrors the procedure used for NetworkStack , Tethering , \n CaptivePortalLogin , etc . previously . \n The added OWNERS file just imports owners from the previous file \n location . \n Bug : 171540887 \n Test : m \n Change - Id : Ic1c0dbbe8c1f07582c04757ced0ead2fc5b10ca7",414
"core \ java \ android \ net \ NetworkAgent . java \n - / * * \n - * Bundle key for the underlying networks in { @ code EVENT _ UNDERLYING _ NETWORKS _ CHANGED } . \n - * @ hide \n - * / \n - public static final String UNDERLYING _ NETWORKS _ KEY = "" underlyingNetworks "" ; \n - \n services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - final ArrayList < Network > underlying ; \n - try { \n - underlying = ( ( Bundle ) arg . second ) . getParcelableArrayList ( \n - NetworkAgent . UNDERLYING _ NETWORKS _ KEY ) ; \n - } catch ( NullPointerException | ClassCastException e ) { \n - break ; \n - } \n + final List < Network > underlying = ( List < Network > ) arg . second ; \n services \ core \ java \ com \ android \ server \ connectivity \ NetworkAgentInfo . java \n - import android . os . Bundle ; \n - import java . util . ArrayList ; \n - final Bundle args = new Bundle ( ) ; \n - if ( networks instanceof ArrayList < ? > ) { \n - args . putParcelableArrayList ( NetworkAgent . UNDERLYING _ NETWORKS _ KEY , \n - ( ArrayList < Network > ) networks ) ; \n - } else { \n - args . putParcelableArrayList ( NetworkAgent . UNDERLYING _ NETWORKS _ KEY , \n - networks = = null ? null : new ArrayList < > ( networks ) ) ; \n - } \n - new Pair < > ( NetworkAgentInfo . this , args ) ) . sendToTarget ( ) ; \n + new Pair < > ( NetworkAgentInfo . this , networks ) ) . sendToTarget ( ) ; \n","Use network list in UNDERLYING _ NETWORKS _ CHANGED \n The bundle is no longer necessary , as this message is not sent across \n processes : the network list can be sent directly in the message obj \n pair . \n Bug : 173574274 \n Test : atest FrameworksNetTests CtsNetTestCasesLatestSdk \n Change - Id : Iae049a24212ff9df19b29aead20bf4a594f05f99",414
"tests \ net \ common \ Android . bp \n + "" modules - utils - build "" , \n tests \ net \ common \ java \ android \ net \ CaptivePortalDataTest . kt \n + import com . android . modules . utils . build . SdkLevel \n + import com . android . testutils . DevSdkIgnoreRule \n + import org . junit . Rule \n + @ Rule @ JvmField \n + val ignoreRule = DevSdkIgnoreRule ( ) \n + \n - . setVenueFriendlyName ( "" venue friendly name "" ) \n + . apply { \n + if ( SdkLevel . isAtLeastS ( ) ) { \n + setVenueFriendlyName ( "" venue friendly name "" ) \n + } \n + } \n - assertNotEqualsAfterChange { it . setVenueFriendlyName ( "" another friendly name "" ) } \n - assertNotEqualsAfterChange { it . setVenueFriendlyName ( null ) } \n + \n + if ( SdkLevel . isAtLeastS ( ) ) { \n + assertNotEqualsAfterChange { it . setVenueFriendlyName ( "" another friendly name "" ) } \n + assertNotEqualsAfterChange { it . setVenueFriendlyName ( null ) } \n + } \n - @ Test \n + @ Test @ IgnoreUpTo ( Build . VERSION _ CODES . R ) \n",Fix CaptivePortalDataTest on R - \n The new venue friendly name field is not present on R - \n Bug : 162783305 \n Change - Id : I63bd9c61d27c7d3b07826053373c9c5e38666948 \n Test : atest FrameworksNetTests,414
"core \ api \ system - current . txt \n + field public static final String MANAGE _ TEST _ NETWORKS = "" android . permission . MANAGE _ TEST _ NETWORKS "" ; \n core \ api \ test - current . txt \n - method @ RequiresPermission ( anyOf = { "" android . permission . MANAGE _ TEST _ NETWORKS "" , android . Manifest . permission . NETWORK _ STACK } ) public void simulateDataStall ( int , long , @ NonNull android . net . Network , @ NonNull android . os . PersistableBundle ) ; \n + method @ RequiresPermission ( anyOf = { android . Manifest . permission . MANAGE _ TEST _ NETWORKS , android . Manifest . permission . NETWORK _ STACK } ) public void simulateDataStall ( int , long , @ NonNull android . net . Network , @ NonNull android . os . PersistableBundle ) ; \n core \ res \ AndroidManifest . xml \n - < ! - - @ hide Allows apps to create and manage Test Networks . \n + < ! - - @ SystemApi @ hide Allows apps to create and manage Test Networks . \n - - > \n",Add MANAGE _ TEST _ NETWORKS to system API \n The system and particularly mainline modules need to reference the API \n constant so they can verify that callers have the permission . \n Bug : 174436414 \n Test : m \n Merged - In : I9f41f888fbd4b7605d750110b345005a5cba85d1 \n Change - Id : I9f41f888fbd4b7605d750110b345005a5cba85d1,414
"core \ java \ com \ android \ internal \ net \ VpnConfig . java \n - RouteInfo info = new RouteInfo ( new IpPrefix ( route ) , null ) ; \n + RouteInfo info = new RouteInfo ( new IpPrefix ( route ) , null , null , RouteInfo . RTN _ UNICAST ) ; \n","Use API RouteInfo constructor in VpnConfig \n VpnConfig is planned to be outside of the connectivity module , so it \n needs to use its public API and not private symbols . \n Change the RouteInfo constructor to use the equivalent API version . \n Bug : 174436414 \n Test : m \n Change - Id : Iae264e9b50ec6e97ce39bd2bab6f22f5844bf270",414
"core \ java \ android \ app \ admin \ DevicePolicyManager . java \n + import android . text . TextUtils ; \n - StringBuilder hostBuilder = new StringBuilder ( ) ; \n - final String hostSpec = hostBuilder . append ( hostName ) \n - . append ( "" : "" ) . append ( Integer . toString ( port ) ) . toString ( ) ; \n - final String exclSpec ; \n + final List < String > trimmedExclList ; \n - exclSpec = "" "" ; \n + trimmedExclList = Collections . emptyList ( ) ; \n - StringBuilder listBuilder = new StringBuilder ( ) ; \n - boolean firstDomain = true ; \n + trimmedExclList = new ArrayList < > ( exclusionList . size ( ) ) ; \n - if ( ! firstDomain ) { \n - listBuilder = listBuilder . append ( "" , "" ) ; \n - } else { \n - firstDomain = false ; \n - } \n - listBuilder = listBuilder . append ( exclDomain . trim ( ) ) ; \n + trimmedExclList . add ( exclDomain . trim ( ) ) ; \n - exclSpec = listBuilder . toString ( ) ; \n - if ( android . net . Proxy . validate ( hostName , Integer . toString ( port ) , exclSpec ) \n - ! = android . net . Proxy . PROXY _ VALID ) throw new IllegalArgumentException ( ) ; \n + final ProxyInfo info = ProxyInfo . buildDirectProxy ( hostName , port , trimmedExclList ) ; \n + / / The hostSpec is built assuming that there is a specified port and hostname , \n + / / but ProxyInfo . isValid ( ) accepts 0 / empty as unspecified : also reject them . \n + if ( port = = 0 | | TextUtils . isEmpty ( hostName ) | | ! info . isValid ( ) ) { \n + throw new IllegalArgumentException ( ) ; \n + } \n - return new Pair < > ( hostSpec , exclSpec ) ; \n + return new Pair < > ( hostName + "" : "" + port , TextUtils . join ( "" , "" , trimmedExclList ) ) ; \n","Remove hidden API usage of Proxy . validate \n Proxy is planned to move to the connectivity module , so framework \n classes like DevicePolicyManager cannot depend on its private symbols . \n Replace usage of ProxyInfo . validate by the equivalent isValid method on \n ProxyInfo . \n Bug : 174436414 \n Test : atest DevicePolicyManagerTest # testGetProxyParameters \n Change - Id : I6da49a34c9893d07ef7cbee6a7386c9258839467",414
"core \ java \ android \ net \ metrics \ IpConnectivityLog . java \n - return log ( network . netId , transports , data ) ; \n + return log ( network . getNetId ( ) , transports , data ) ; \n","Remove usage of hidden . netId in IpConnectivityLog \n Use the Network # getNetId API instead . \n IpConnectivityLog is planned to be outside of the connectivity module , \n so it cannot use hidden symbols implemented in the module . \n Bug : 174436414 \n Test : m \n Change - Id : I947a32612c59b53f22fe1c38706de8919ca5043a",414
core \ java \ android \ net \ vcn \ VcnGatewayConnectionConfig . java \n - import static android . net . NetworkCapabilities . NetCapability ; \n - \n - public boolean hasExposedCapability ( @ NetCapability int capability ) { \n + public boolean hasExposedCapability ( int capability ) { \n - public boolean requiresUnderlyingCapability ( @ NetCapability int capability ) { \n + public boolean requiresUnderlyingCapability ( int capability ) { \n - public Builder addExposedCapability ( @ NetCapability int exposedCapability ) { \n + public Builder addExposedCapability ( int exposedCapability ) { \n - public Builder removeExposedCapability ( @ NetCapability int exposedCapability ) { \n + public Builder removeExposedCapability ( int exposedCapability ) { \n - public Builder addRequiredUnderlyingCapability ( @ NetCapability int underlyingCapability ) { \n + public Builder addRequiredUnderlyingCapability ( int underlyingCapability ) { \n - public Builder removeRequiredUnderlyingCapability ( @ NetCapability int underlyingCapability ) { \n + public Builder removeRequiredUnderlyingCapability ( int underlyingCapability ) { \n,"Remove usage of NetCapability \n The NetCapability annotation is internal to NetworkCapabilities . IntDef \n annotations cannot be part of the API as per API guidelines , so the \n NetCapability annotation cannot be used from outside of the connectivity \n module , once it is built . \n Bug : 174436414 \n Test : m \n Change - Id : I1d6d87432d1e3af8a20169b18ceffa0c1130a836",414
core \ java \ android \ text \ format \ Formatter . java \n - import android . net . NetworkUtils ; \n + import com . android . net . module . util . Inet4AddressUtils ; \n + \n - return NetworkUtils . intToInetAddress ( ipv4Address ) . getHostAddress ( ) ; \n + return Inet4AddressUtils . intToInet4AddressHTL ( ipv4Address ) . getHostAddress ( ) ; \n,"Remove usage of hidden NetworkUtils from Formatter \n Use the Inet4AddressUtils common utility instead . \n NetworkUtils is moving to the connectivity module , so its hidden symbols \n are not accessible from the framework . Use the Inet4AddressUtils utility \n instead . \n NetworkUtils . intToInetAddress is also deprecated . \n Bug : 174436414 \n Test : m \n Change - Id : Ia4f4de2f23b2e2be056f78cc30259814f9a4dc91",414
"tests \ net \ common \ java \ android \ net \ CaptivePortalDataTest . kt \n - assertParcelSane ( data , fieldCount = 8 ) \n + val fieldCount = if ( SdkLevel . isAtLeastS ( ) ) 8 else 7 \n + assertParcelSane ( data , fieldCount ) \n","Fix CaptivePortalDataTest # testParcelUnparcel on R \n CaptivePortalData only has 7 fields on R , not 8 . \n Bug : 177290955 \n Change - Id : I156738d07821fee43420d8af14c4bce36dd0e4a4 \n Test : atest CtsNetTestCasesLatestSdk : CaptivePortalDataTest on R",414
services \ core \ java \ com \ android \ server \ TestNetworkService . java \n - import android . net . NetworkStack ; \n + import com . android . net . module . util . PermissionUtils ; \n - NetworkStack . checkNetworkStackPermission ( mContext ) ; \n + PermissionUtils . enforceNetworkStackPermission ( mContext ) ; \n,Replace checkNetworkStackPermission in TestNetworkService \n Use the underlying PermissionUtils directly instead . \n Bug : 178352309 \n Change - Id : I840a7b7d53531604a214b73f1f518b2ebb10e71e \n Test : atest FrameworksNetTests,414
"packages \ Connectivity \ service \ Android . bp \n + "" modules - utils - os "" , \n packages \ Connectivity \ service \ jarjar - rules . txt \n - rule com . android . net . module . util . * * com . android . connectivity . util . @ 1 \n + rule com . android . net . module . util . * * com . android . connectivity . net - utils . @ 1 \n + rule com . android . modules . utils . * * com . android . connectivity . modules - utils . @ 1 \n","Add modules - utils - os to service - connectivity \n service - connectivity needs the library so that module utilities are statically \n linked , not picked up from the framework jar as hidden symbols . \n Bug : 170598012 \n Change - Id : I1045b3784a4bdb902f44d848ccddb304986631c3 \n Test : m",414
"core \ java \ android \ os \ INetworkManagementService . aidl \n - import android . net . UidRange ; \n rename from core \ java \ android \ net \ UidRange . aidl \n rename to packages \ Connectivity \ framework \ src \ android \ net \ UidRange . aidl \n rename from core \ java \ android \ net \ UidRange . java \n rename to packages \ Connectivity \ framework \ src \ android \ net \ UidRange . java \n - import static android . os . UserHandle . PER _ USER _ RANGE ; \n - \n + / * * Returns whether the UidRange contains the specified UID . * / \n - * @ return { @ code true } if this range contains every UID contained by the { @ param other } range . \n + * @ return { @ code true } if this range contains every UID contained by the { @ code other } range . \n - new Creator < UidRange > ( ) { \n - @ Override \n - public UidRange createFromParcel ( Parcel in ) { \n - int start = in . readInt ( ) ; \n - int stop = in . readInt ( ) ; \n + new Creator < UidRange > ( ) { \n + @ Override \n + public UidRange createFromParcel ( Parcel in ) { \n + int start = in . readInt ( ) ; \n + int stop = in . readInt ( ) ; \n - return new UidRange ( start , stop ) ; \n - } \n - @ Override \n - public UidRange [ ] newArray ( int size ) { \n - return new UidRange [ size ] ; \n - } \n + return new UidRange ( start , stop ) ; \n + } \n + @ Override \n + public UidRange [ ] newArray ( int size ) { \n + return new UidRange [ size ] ; \n + } \n","Move UidRange to connectivity \n UidRange is a data class that is an implementation detail of \n Connectivity . Move it to the connectivity boundary . \n Remaining usages of UidRange outside of Connectivity ( in VPN ) should be \n migrated to other classes , like Range < Integer > or UidRangeParcel . \n Bug : 181512874 \n Test : m \n Change - Id : I6f2e3685ad1c07171dd90480d1e546329de8732d",414
rename from core \ java \ android \ net \ IOnSetOemNetworkPreferenceListener . aidl \n rename to packages \ Connectivity \ framework \ src \ android \ net \ IOnSetOemNetworkPreferenceListener . aidl \n,"Move OemNetworkPreferences aidl to connectivity \n Move the IOnSetOemNetworkPreferenceListener aidl definition to \n framework - connectivity . \n The interface is an internal implementation detail of \n framework - connectivity , so it should be built inside the jar . \n Bug : 181512874 \n Test : m \n Change - Id : I898049b50fc620ee629587a9303f058e0a6d0272",414
packages \ Connectivity \ framework \ src \ android \ net \ ConnectivityManager . java \n - public static final int TETHERING _ WIFI = TetheringManager . TETHERING _ WIFI ; \n + public static final int TETHERING _ WIFI = 0 ; \n - public static final int TETHERING _ USB = TetheringManager . TETHERING _ USB ; \n + public static final int TETHERING _ USB = 1 ; \n - public static final int TETHERING _ BLUETOOTH = TetheringManager . TETHERING _ BLUETOOTH ; \n + public static final int TETHERING _ BLUETOOTH = 2 ; \n - public static final int TETHER _ ERROR _ NO _ ERROR = TetheringManager . TETHER _ ERROR _ NO _ ERROR ; \n + public static final int TETHER _ ERROR _ NO _ ERROR = 0 ; \n - public static final int TETHER _ ERROR _ PROVISION _ FAILED = \n - TetheringManager . TETHER _ ERROR _ PROVISIONING _ FAILED ; \n + public static final int TETHER _ ERROR _ PROVISION _ FAILED = 11 ; \n - public static final int TETHER _ ERROR _ ENTITLEMENT _ UNKONWN = \n - TetheringManager . TETHER _ ERROR _ ENTITLEMENT _ UNKNOWN ; \n + public static final int TETHER _ ERROR _ ENTITLEMENT _ UNKONWN = 13 ; \n,"Do not depend on Tethering stubs in CM consts \n Tethering API stubs depend on connectivity stubs for classes like \n MacAddress or LinkAddress , so connectivity stubs cannot depend on \n Tethering stubs or there would be a circular dependency . \n This means ConnectivityManager API surface cannot reference Tethering \n API constants . Instead , use the literal in ConnectivityManager . \n This means that both ConnectivityManager and TetheringManager specify \n the constant value . An alternative considered was to have \n TetheringManager depend on the ConnectivityManager constants , but \n considering that ConnectivityManager only has some of the constants , \n this would be more confusing . Breaking the constants by mistake is \n unlikely as their values are part of the API surface , so will always be \n in sync . \n Bug : 171540887 \n Test : m \n Change - Id : I16b6e1912fffc5ff8b3b392901d2357ffd213c72",414
"core \ java \ android \ net \ VpnService . java \n - mRoutes . add ( new RouteInfo ( new IpPrefix ( address , prefixLength ) , null ) ) ; \n + mRoutes . add ( new RouteInfo ( new IpPrefix ( address , prefixLength ) , null , null , \n + RouteInfo . RTN _ UNICAST ) ) ; \n","Use RouteInfo API constructor in VpnService \n Instead of using the RouteInfo ( destination , gateway ) constructor which \n is private API , use the RouteInfo ( destination , gateway , iface , type ) \n constructor which is system API . \n This separates the VpnService better from internal implementations , and \n is necessary to move RouteInfo to the connectivity module . \n Bug : 174436414 \n Test : m \n Change - Id : Idc98b2258f3c78bdba40b5fcb97769b5ad99d016",414
"core \ api \ current . txt \n + public final class Proxy { \n + ctor public Proxy ( ) ; \n + method @ Deprecated public static String getDefaultHost ( ) ; \n + method @ Deprecated public static int getDefaultPort ( ) ; \n + method @ Deprecated public static String getHost ( android . content . Context ) ; \n + method @ Deprecated public static int getPort ( android . content . Context ) ; \n + field @ Deprecated public static final String EXTRA _ PROXY _ INFO = "" android . intent . extra . PROXY _ INFO "" ; \n + field public static final String PROXY _ CHANGE _ ACTION = "" android . intent . action . PROXY _ CHANGE "" ; \n + } \n + \n core \ api \ module - lib - current . txt \n + public final class Proxy { \n + method public static void setHttpProxyConfiguration ( @ Nullable android . net . ProxyInfo ) ; \n + } \n + \n rename from packages \ Connectivity \ framework \ src \ android \ net \ PacProxySelector . java \n rename to core \ java \ android \ net \ PacProxySelector . java \n rename from packages \ Connectivity \ framework \ src \ android \ net \ Proxy . java \n rename to core \ java \ android \ net \ Proxy . java \n packages \ Connectivity \ framework \ api \ current . txt \n - public final class Proxy { \n - ctor public Proxy ( ) ; \n - method @ Deprecated public static String getDefaultHost ( ) ; \n - method @ Deprecated public static int getDefaultPort ( ) ; \n - method @ Deprecated public static String getHost ( android . content . Context ) ; \n - method @ Deprecated public static int getPort ( android . content . Context ) ; \n - field @ Deprecated public static final String EXTRA _ PROXY _ INFO = "" android . intent . extra . PROXY _ INFO "" ; \n - field public static final String PROXY _ CHANGE _ ACTION = "" android . intent . action . PROXY _ CHANGE "" ; \n - } \n - \n packages \ Connectivity \ framework \ api \ module - lib - current . txt \n - public final class Proxy { \n - method public static void setHttpProxyConfiguration ( @ Nullable android . net . ProxyInfo ) ; \n - } \n - \n","Move Proxy , PacProxySelector out of Connectivity \n PacProxySelector is tied to IProxyService , which does not have a formal \n API . \n Proxy is the interface with ConnectivityService , and all its methods are \n public or module API . \n Bug : 171540887 \n Test : m \n Change - Id : I8ceba961a81661c3e11d8179955b594d3cab6ff7",414
"packages \ Connectivity \ framework \ src \ android \ net \ NetworkUtils . java \n - @ UnsupportedAppUsage ( maxTargetSdk = Build . VERSION _ CODES . R , trackingBug = 170729553 ) \n + @ UnsupportedAppUsage ( maxTargetSdk = Build . VERSION _ CODES . R , trackingBug = 170729553 , \n + publicAlternatives = "" Use { @ link android . net . VpnService # protect } instead . "" ) \n",Add public alternative for protectFromVpn \n The method is called directly by VpnService # protect . \n Bug : 171540887 \n Test : m \n Change - Id : I7cbb1ef1301dcf8d27b2cc39c0431a0156fe3442,414
"tests \ net \ java \ com \ android \ server \ ConnectivityServiceTest . java \n + / / Broadcasts can take a long time to be delivered . The test will not wait for that long unless \n + / / there is a failure , so use a long timeout . \n + private static final int BROADCAST _ TIMEOUT _ MS = 30 _ 000 ; \n - return expectBroadcast ( TIMEOUT _ MS ) ; \n + return expectBroadcast ( BROADCAST _ TIMEOUT _ MS ) ; \n","Extend timeout for receiving broadcasts \n The test is currently flaky as broadcasts can take a long time \n to be delivered , often more than 500ms . \n Extend the timeout for broadcasts to 30s . \n Historically the test would wait for broadcasts for at most 500ms , \n but not verify that they were received before proceeding . This was \n fixed recently by adding an assertion , but the assertion needs to \n give enough time for the broadcast to be received . \n Bug : 173331190 \n Change - Id : I0760f3418c635aa4d68de5aefdb7120a9d3e930b \n Test : atest FrameworksNetTests",414
services \ core \ java \ com \ android \ server \ connectivity \ PacManager . java \n - synchronized boolean setCurrentProxyScriptUrl ( ProxyInfo proxy ) { \n + public synchronized boolean setCurrentProxyScriptUrl ( ProxyInfo proxy ) { \n,"Set setCurrentProxyScriptUrl as public \n PacManager is part of services . jar , while ProxyManager is in \n service - connectivity . jar . setCurrentProxyScriptUrl cannot be \n package - private and called across jars . \n As part of modularization of service - connectivity . jar , the \n PacManager interface will then be formally defined . \n Bug : 171540887 \n Test : Splitting service - connectivity , ProxyManager can reference the \n method \n Change - Id : Ie41a5b569a119f305bf647e55a65febbde459352",414
services \ core \ java \ com \ android \ server \ connectivity \ PacManager . java \n - synchronized boolean setCurrentProxyScriptUrl ( ProxyInfo proxy ) { \n + public synchronized boolean setCurrentProxyScriptUrl ( ProxyInfo proxy ) { \n,"Revert ^ 2 "" Set setCurrentProxyScriptUrl as public "" \n PacManager is part of services . jar , while ProxyManager is in \n service - connectivity . jar . setCurrentProxyScriptUrl cannot be \n package - private and called across jars . \n As part of modularization of service - connectivity . jar , the \n PacManager interface will then be formally defined . \n This rolls forward the change . The original topic was reverted because \n of a bad merged - in clause ; this is fixed and re - verified in this topic . \n Bug : 171540887 \n Test : Splitting service - connectivity , ProxyManager can reference the \n method \n Change - Id : I1007be6c0101c4582bade182f9bc8dcfc4a1b303",414
"core \ api \ module - lib - current . txt \n + public class ConnectivityManager { \n + method @ RequiresPermission ( anyOf = { android . Manifest . permission . MANAGE _ TEST _ NETWORKS , android . Manifest . permission . NETWORK _ STACK } ) public void simulateDataStall ( int , long , @ NonNull android . net . Network , @ NonNull android . os . PersistableBundle ) ; \n + } \n + \n + public final class NetworkCapabilities implements android . os . Parcelable { \n + field public static final int TRANSPORT _ TEST = 7 ; / / 0x7 \n + } \n + \n core \ api \ test - current . txt \n - public class ConnectivityManager { \n - method @ RequiresPermission ( anyOf = { android . Manifest . permission . MANAGE _ TEST _ NETWORKS , android . Manifest . permission . NETWORK _ STACK } ) public void simulateDataStall ( int , long , @ NonNull android . net . Network , @ NonNull android . os . PersistableBundle ) ; \n - } \n - \n - public final class NetworkCapabilities implements android . os . Parcelable { \n - method public int [ ] getCapabilities ( ) ; \n - field public static final int TRANSPORT _ TEST = 7 ; / / 0x7 \n - } \n - \n core \ java \ android \ net \ ConnectivityManager . java \n - import android . annotation . TestApi ; \n + * < p > This method should only be used for tests . \n + * \n - @ TestApi \n + @ SystemApi ( client = SystemApi . Client . MODULE _ LIBRARIES ) \n core \ java \ android \ net \ NetworkCapabilities . java \n - import android . annotation . TestApi ; \n - @ TestApi \n - @ TestApi \n + @ SystemApi ( client = SystemApi . Client . MODULE _ LIBRARIES ) \n","Mark connectivity test utilities as module API \n The API surface is planned to move to the Connectivity module , meaning \n that it will be maintained across multiple Android releases . \n This is incompatible with TestApi semantics , which are designed to be \n removable across releases . Effectively the APIs become SystemApi , so \n mark them as such considering that TestApi is not supported by modules . \n Remove the NetworkCapabilities . getCapabilities test API that is not \n essential for tests , and mark other APIs as module API . \n Test : m \n Bug : 174436414 \n Change - Id : Ic04551a9874b3d756cf5e6c77ceabfc7c85d52a6",414
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ ui \ MusicPlayerActivity . java \n + import android . content . res . TypedArray ; \n - mToolbar . setLogo ( R . drawable . ic _ launcher ) ; \n + mToolbar . setBackgroundColor ( getToolbarBackground ( ) ) ; \n + private int getToolbarBackground ( ) { \n + TypedArray ta = getTheme ( ) . obtainStyledAttributes ( new int [ ] { \n + android . R . attr . colorPrimary \n + } ) ; \n + int defaultColor = getResources ( ) . getColor ( android . R . color . background _ dark ) ; \n + int color = ta . getColor ( 0 , defaultColor ) ; \n + ta . recycle ( ) ; \n + return color ; \n + } \n + \n mobile \ src \ main \ res \ drawable - hdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - hdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - hdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - mdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - mdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - mdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xhdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xxhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xxhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xxhdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xxxhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xxxhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xxxhdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ values \ strings . xml \n - - > \n - < string name = "" app _ name "" > uAmp < / string > \n + < string name = "" app _ name "" > Universal Music Player < / string > \n",Change logo and colors \n Bug : 18725616 \n Change - Id : Ic178cd5f5d873e7acb17117eb89d0d7f1004dfc8,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MediaNotificationManager . java \n + import com . example . android . uamp . ui . MusicPlayerActivity ; \n - private PendingIntent mPauseIntent , mPlayIntent , mPreviousIntent , mNextIntent ; \n + private PendingIntent mPauseIntent , mPlayIntent , mPreviousIntent , mNextIntent , mContentIntent ; \n + Intent openUI = new Intent ( mService , MusicPlayerActivity . class ) ; \n + openUI . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; \n + mContentIntent = PendingIntent . getActivity ( mService , 100 , openUI , \n + PendingIntent . FLAG _ CANCEL _ CURRENT ) ; \n + . setContentIntent ( mContentIntent ) \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ ui \ MusicPlayerActivity . java \n - if ( intent . getAction ( ) . equals ( MediaStore . INTENT _ ACTION _ MEDIA _ PLAY _ FROM _ SEARCH ) & & \n - intent . hasExtra ( EXTRA _ PLAY _ QUERY ) ) { \n + if ( intent . getAction ( ) ! = null \n + & & intent . getAction ( ) . equals ( MediaStore . INTENT _ ACTION _ MEDIA _ PLAY _ FROM _ SEARCH ) \n + & & intent . hasExtra ( EXTRA _ PLAY _ QUERY ) ) { \n",Launch UI when notification is clicked . \n Bug : 18792655 \n Change - Id : I76e88d39ec16ed8e20c80f3275e413eb0e3dc4b2,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MediaNotificationManager . java \n + mService . startForeground ( NOTIFICATION _ ID , mNotificationBuilder . build ( ) ) ; \n + mNotificationManager . notify ( NOTIFICATION _ ID , mNotificationBuilder . build ( ) ) ; \n - mService . startForeground ( NOTIFICATION _ ID , mNotificationBuilder . build ( ) ) ; \n",Allow notification to be dismissed when paused \n Bug : 18792132 \n Change - Id : If6ab2c32b5d4228b8aee8a0917111ea5a28052bd,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ ui \ PlaybackControlsFragment . java \n - private ImageButton mSkipNext ; \n - private ImageButton mSkipPrevious ; \n - mSkipPrevious = ( ImageButton ) rootView . findViewById ( R . id . skip _ previous ) ; \n - mSkipPrevious . setEnabled ( false ) ; \n - mSkipPrevious . setOnClickListener ( mButtonListener ) ; \n - \n - mSkipNext = ( ImageButton ) rootView . findViewById ( R . id . skip _ next ) ; \n - mSkipNext . setEnabled ( false ) ; \n - mSkipNext . setOnClickListener ( mButtonListener ) ; \n - \n - \n - mSkipPrevious . setEnabled ( ( state . getActions ( ) & PlaybackState . ACTION _ SKIP _ TO _ PREVIOUS ) ! = 0 ) ; \n - mSkipNext . setEnabled ( ( state . getActions ( ) & PlaybackState . ACTION _ SKIP _ TO _ NEXT ) ! = 0 ) ; \n - \n - case R . id . skip _ previous : \n - LogHelper . d ( TAG , "" Start button pressed , in state "" + state ) ; \n - skipToPrevious ( ) ; \n - break ; \n - case R . id . skip _ next : \n - skipToNext ( ) ; \n - break ; \n - \n - private void skipToPrevious ( ) { \n - MediaController controller = getActivity ( ) . getMediaController ( ) ; \n - if ( controller ! = null ) { \n - controller . getTransportControls ( ) . skipToPrevious ( ) ; \n - } \n - } \n - \n - private void skipToNext ( ) { \n - MediaController controller = getActivity ( ) . getMediaController ( ) ; \n - if ( controller ! = null ) { \n - controller . getTransportControls ( ) . skipToNext ( ) ; \n - } \n - } \n",Removed unused variables . \n Change - Id : I5c0c0366ab0adfe0b9b5ad59aa28eca2af76cfb3,415
"mobile \ src \ main \ res \ layout \ fragment _ playback _ controls . xml \n - android : contentDescription = "" @ string / currently _ playing _ song "" / > \n + android : contentDescription = "" @ string / currently _ playing _ song "" \n + android : textAppearance = "" ? android : attr / textAppearanceMedium "" \n + android : textColor = "" ? android : attr / textColorPrimary "" / > \n - android : contentDescription = "" @ string / currently _ playing _ artist "" / > \n + android : contentDescription = "" @ string / currently _ playing _ artist "" \n + android : textAppearance = "" ? android : attr / textAppearanceSmall "" \n + android : textColor = "" ? android : attr / textColorSecondary "" / > \n mobile \ src \ main \ res \ layout \ media _ list _ item . xml \n - android : textAppearance = "" ? android : attr / textAppearanceMedium "" / > \n + android : textAppearance = "" ? android : attr / textAppearanceMedium "" \n + android : textColor = "" ? android : attr / textColorPrimary "" / > \n - android : textAppearance = "" ? android : attr / textAppearanceSmall "" / > \n + android : textAppearance = "" ? android : attr / textAppearanceSmall "" \n + android : textColor = "" ? android : attr / textColorSecondary "" / > \n",Change list labels to conform to material \n Bug : 19003039 \n Change - Id : Iaeb995573aeb7ab38d433aa6e1ddec2b4c6e73ba,415
"mobile \ src \ main \ res \ layout \ include _ toolbar . xml \n - android : layout _ height = "" wrap _ content "" \n + android : layout _ height = "" ? attr / actionBarSize "" \n - android : minHeight = "" ? attr / actionBarSize "" \n",Make the toolbar smaller on landscape mode \n Bug : 18961860 \n Change - Id : I4f9da246bcaef4eda204541d5eab16def5a01cf8,415
mobile \ src \ main \ java \ com \ example \ android \ uamp \ MediaNotificationManager . java \n - openUI . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; \n + openUI . setFlags ( Intent . FLAG _ ACTIVITY _ SINGLE _ TOP ) ; \n,"Open existing activity when clicking on notification \n The notification content pending intent now uses the SINGLE _ TOP flag instead of \n NEW _ TASK . Then , if the app UI is visible as a top activity of an existing task , \n the task will be brough up but kept to its existing browsing state . \n Bug : 19003796 \n Change - Id : Ic067d0f15cb6b8b67fcfc791d935b7c70ba7c7b9",415
mobile \ src \ main \ java \ com \ example \ android \ uamp \ MediaNotificationManager . java \n - updateNotificationMetadata ( ) ; \n + updateNotification ( ) ; \n - updateNotificationPlaybackState ( ) ; \n + updateNotification ( ) ; \n - updateNotificationMetadata ( ) ; \n + updateNotification ( ) ; \n - private void updateNotificationMetadata ( ) { \n + private void updateNotification ( ) { \n - updatePlayPauseAction ( ) ; \n - \n,"Fixes incorrect action setting in notification . \n MediaSession changes metadata before it sets the playback state with the \n supported actions . MediaNotificationManager controller callback was not \n updating notification actions in onplaybackstatechanged , only on \n onmetadatachanged . But since onmetadatachanged was called before the new \n playbackstate was set with supported actions , the notification actions \n didn ' t get properly set . \n Bug : 19003613 \n Change - Id : Ie4acf22f188e487b416bd6b46cc3d5dde8c154bf",415
"new file \n docs \ cast _ styled _ receiver \ style . css \n + . background { \n + background - image : linear - gradient ( # 000000 , # 250900 ) ; \n + } \n + \n + . logo { \n + / * max 1280x400 , padding - top : 25 % * / \n + background - image : url ( uamp _ cast _ logo . png ) ; \n + background - size : auto 30 % ; \n + } \n + \n + . progressBar { \n + background - color : # FF5A26 ; \n + } \n + \n + . splash { \n + / * max 1280x400 , padding - top : 25 % * / \n + background - image : url ( uamp _ cast _ splash . png ) ; \n + } \n + \n + . watermark { \n + background - image : url ( uamp _ cast _ watermark . png ) ; \n + background - size : auto 57px ; \n + } \n new file \n docs \ cast _ styled _ receiver \ uamp _ cast _ logo . png \n Binary files / dev / null and b / docs / cast _ styled _ receiver / uamp _ cast _ logo . png differ \n new file \n docs \ cast _ styled _ receiver \ uamp _ cast _ splash . png \n Binary files / dev / null and b / docs / cast _ styled _ receiver / uamp _ cast _ splash . png differ \n new file \n docs \ cast _ styled _ receiver \ uamp _ cast _ watermark . png \n Binary files / dev / null and b / docs / cast _ styled _ receiver / uamp _ cast _ watermark . png differ \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" cast _ application _ id "" > C326D7BC < / string > < ! - - use CC1AD845 for default receiver - - > \n + < string name = "" cast _ application _ id "" > 6FB2BA68 < / string > < ! - - use CC1AD845 for default receiver - - > \n","Add Cast styled media receiver assets \n Added proper style CSS , logo , splash and watermark . \n Bug : 18965267 \n Change - Id : I0d91473eb07c1113caac64eb49a1cb89e2252204",415
mobile \ src \ main \ res \ drawable - hdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - hdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - hdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - mdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - mdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - mdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xhdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xxhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xxhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xxhdpi / ic _ launcher . png differ \n mobile \ src \ main \ res \ drawable - xxxhdpi \ ic _ launcher . png \n Binary files a / mobile / src / main / res / drawable - xxxhdpi / ic _ launcher . png and b / mobile / src / main / res / drawable - xxxhdpi / ic _ launcher . png differ \n,Add new material icon . \n Bug : 19300865 \n Change - Id : Icc325742c55193fb49223a13c56f97674c85def3,415
"new file \n . google \ packaging . yaml \n + # GOOGLE SAMPLE PACKAGING DATA \n + # \n + # This file is used by Google as part of our samples packaging process . \n + # End users may safely ignore this file . It has no relevance to other systems . \n + - - - \n + status : PUBLISHED \n + technologies : [ Android , Android Auto , ChromeCast , Google Cast , Android Wear ] \n + categories : [ Getting Started , Media , UI ] \n + languages : [ Java ] \n + solutions : [ Mobile ] \n + \n + github : googlesamples / android - UniversalMusicPlayer \n + \n + level : INTERMEDIATE \n + \n + icon : screenshots / icon - web . png \n + \n + api _ refs : \n + - android : android . media . session . MediaSession \n + - android : android . media . session . MediaSession . Callback \n + - android : android . media . session . MediaController \n + - android : android . service . media . MediaBrowserService \n + - android : android . media . browse . MediaBrowser \n + - android : android . app . Notification . MediaStyle \n + \n + license : apache2 - android \n new file \n screenshots \ icon - web . png \n Binary files / dev / null and b / screenshots / icon - web . png differ \n",Add metadata to be imported from Android Studio \n Bug : 20071371 \n Change - Id : Icdf9fc6d9ff6e425c104fad1872a77ada9f29092,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ AlbumArtCache . java \n - public static final AlbumArtCache getInstance ( ) { \n + public static AlbumArtCache getInstance ( ) { \n - Bitmap [ ] bitmaps = null ; \n + Bitmap [ ] bitmaps ; \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ MediaNotificationManager . java \n - public static final String ACTION _ STOP _ CASTING = "" com . exmaple . android . uamp . stop _ cast "" ; \n + public static final String ACTION _ STOP _ CASTING = "" com . example . android . uamp . stop _ cast "" ; \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ MusicService . java \n - / / Current local media player state \n - \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ model \ MutableMediaMetadata . java \n - if ( this = = o ) return true ; \n - if ( o = = null | | o . getClass ( ) ! = MutableMediaMetadata . class ) return false ; \n + if ( this = = o ) { \n + return true ; \n + } \n + if ( o = = null | | o . getClass ( ) ! = MutableMediaMetadata . class ) { \n + return false ; \n + } \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ utils \ QueueHelper . java \n - LogHelper . e ( TAG , "" Unrecognized category type : "" , categoryType , "" for mediaId "" , mediaId ) ; \n + LogHelper . e ( TAG , "" Unrecognized category type : "" , categoryType , "" for media "" , mediaId ) ; \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ utils \ ResourceHelper . java \n - * Generic reusable network methods . \n + * Generic reusable methods to handle resources . \n",Fix minor lint issues . \n Change - Id : Ie427363d149070ad8d7062b484b516dd5a05a6d1,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MusicService . java \n + import android . text . TextUtils ; \n - mPlayingQueue = QueueHelper . getPlayingQueueFromSearch ( query , mMusicProvider ) ; \n + if ( TextUtils . isEmpty ( query ) ) { \n + / / A generic search like "" Play music "" sends an empty query \n + / / and it ' s expected that we start playing something . What will be played depends \n + / / on the app : favorite playlist , "" I ' m feeling lucky "" , most recent , etc . \n + mPlayingQueue = QueueHelper . getRandomQueue ( mMusicProvider ) ; \n + } else { \n + mPlayingQueue = QueueHelper . getPlayingQueueFromSearch ( query , mMusicProvider ) ; \n + } \n + \n - / / start playing from the beginning of the queue \n + / / immediately start playing from the beginning of the search results \n + } else { \n + / / if nothing was found , we need to warn the user and stop playing \n + handleStopRequest ( getString ( R . string . no _ search _ results ) ) ; \n mobile \ src \ main \ res \ values \ strings . xml \n + < string name = "" no _ search _ results "" > No search results . < / string > \n",Handle no results voice search . \n Bug : 19946854 \n Change - Id : I7daaf8be9a9d5a7c8f50e2454d8ad9cef64e5c1a,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ ui \ MusicPlayerActivity . java \n + import android . app . ActivityManager ; \n + import android . graphics . BitmapFactory ; \n + import com . example . android . uamp . utils . ResourceHelper ; \n + / / Since our app icon has the same color as colorPrimary , our entry in the Recents Apps \n + / / list gets weird . We need to change either the icon or the color of the TaskDescription . \n + ActivityManager . TaskDescription taskDesc = new ActivityManager . TaskDescription ( \n + getTitle ( ) . toString ( ) , \n + BitmapFactory . decodeResource ( getResources ( ) , R . drawable . ic _ launcher _ white ) , \n + ResourceHelper . getThemeColor ( this , R . attr . colorPrimary , android . R . color . darker _ gray ) ) ; \n + setTaskDescription ( taskDesc ) ; \n + \n new file \n mobile \ src \ main \ res \ drawable - hdpi \ ic _ launcher _ white . png \n Binary files / dev / null and b / mobile / src / main / res / drawable - hdpi / ic _ launcher _ white . png differ \n new file \n mobile \ src \ main \ res \ drawable - mdpi \ ic _ launcher _ white . png \n Binary files / dev / null and b / mobile / src / main / res / drawable - mdpi / ic _ launcher _ white . png differ \n new file \n mobile \ src \ main \ res \ drawable - xhdpi \ ic _ launcher _ white . png \n Binary files / dev / null and b / mobile / src / main / res / drawable - xhdpi / ic _ launcher _ white . png differ \n new file \n mobile \ src \ main \ res \ drawable - xxhdpi \ ic _ launcher _ white . png \n Binary files / dev / null and b / mobile / src / main / res / drawable - xxhdpi / ic _ launcher _ white . png differ \n new file \n mobile \ src \ main \ res \ drawable - xxxhdpi \ ic _ launcher _ white . png \n Binary files / dev / null and b / mobile / src / main / res / drawable - xxxhdpi / ic _ launcher _ white . png differ \n",Set custom TaskDescription \n Bug : 19268720 \n Change - Id : Ic782de65538f9b85caf45cc02e6ba0b4cec342ba,415
screenshots \ image1 . png \n Binary files a / screenshots / image1 . png and b / screenshots / image1 . png differ \n screenshots \ image2 . png \n Binary files a / screenshots / image2 . png and b / screenshots / image2 . png differ \n screenshots \ image3 . png \n Binary files a / screenshots / image3 . png and b / screenshots / image3 . png differ \n,Resize screenshots . \n Change - Id : I9fcce0dc918a98b84c2f7fa4b32210f48193fdf7,415
"new file \n mobile \ libs \ licenses \ CastCompanionLibrary - debug . aar . LICENSE \n + Copyright 2014 Google Inc . \n + \n + Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + you may not use this file except in compliance with the License . \n + You may obtain a copy of the License at \n + \n + http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + \n + Unless required by applicable law or agreed to in writing , software \n + distributed under the License is distributed on an "" AS IS "" BASIS , \n + WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + See the License for the specific language governing permissions and \n + limitations under the License . \n + \n new file \n mobile \ libs \ licenses \ gradle . LICENSE \n + Copyright 2007 - 2011 the original author or authors \n + \n + Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + you may not use this file except in compliance with the License . \n + You may obtain a copy of the License at \n + \n + http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + \n + Unless required by applicable law or agreed to in writing , software \n + distributed under the License is distributed on an "" AS IS "" BASIS , \n + WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + See the License for the specific language governing permissions and \n + limitations under the License . \n + \n",Add licenses for open source libraries . \n Bug : 19619800 \n Change - Id : I4b6db840ece67c027e40cf5b5d8b4634a710950b \n ( cherry picked from commit 1fbd92fe04a5a37905dc0764ce062b227df5f520 ),415
"mobile \ src \ main \ res \ xml \ allowed _ media _ browser _ callers . xml \n - - > \n + < signing _ certificate name = "" Android Auto "" release = "" false "" \n + package = "" com . google . android . projection . gearhead "" > \n + MIIEqDCCA5CgAwIBAgIJANWFuGx90071MA0GCSqGSIb3DQEBBAUAMIGUMQswCQYD \n + VQQGEwJVUzETMBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4g \n + VmlldzEQMA4GA1UEChMHQW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UE \n + AxMHQW5kcm9pZDEiMCAGCSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbTAe \n + Fw0wODA0MTUyMzM2NTZaFw0zNTA5MDEyMzM2NTZaMIGUMQswCQYDVQQGEwJVUzET \n + MBEGA1UECBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEQMA4G \n + A1UEChMHQW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9p \n + ZDEiMCAGCSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbTCCASAwDQYJKoZI \n + hvcNAQEBBQADggENADCCAQgCggEBANbOLggKv + IxTdGNs8 / TGFy0PTP6DHThvbbR \n + 24kT9ixcOd9W + EaBPWW + wPPKQmsHxajtWjmQwWfna8mZuSeJS48LIgAZlKkpFeVy \n + xW0qMBujb8X8ETrWy550NaFtI6t9 + u7hZeTfHwqNvacKhp1RbE6dBRGWynwMVX8X \n + W8N1 + UjFaq6GCJukT4qmpN2afb8sCjUigq0GuMwYXrFVee74bQgLHWGJwPmvmLHC \n + 69EH6kWr22ijx4OKXlSIx2xT1AsSHee70w5iDBiK4aph27yH3TxkXy9V89TDdexA \n + cKk / cVHYNnDBapcavl7y0RiQ4biu8ymM8Ga / nmzhRKya6G0cGw8CAQOjgfwwgfkw \n + HQYDVR0OBBYEFI0cxb6VTEM8YYY6FbBMvAPyT + CyMIHJBgNVHSMEgcEwgb6AFI0c \n + xb6VTEM8YYY6FbBMvAPyT + CyoYGapIGXMIGUMQswCQYDVQQGEwJVUzETMBEGA1UE \n + CBMKQ2FsaWZvcm5pYTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEQMA4GA1UEChMH \n + QW5kcm9pZDEQMA4GA1UECxMHQW5kcm9pZDEQMA4GA1UEAxMHQW5kcm9pZDEiMCAG \n + CSqGSIb3DQEJARYTYW5kcm9pZEBhbmRyb2lkLmNvbYIJANWFuGx90071MAwGA1Ud \n + EwQFMAMBAf8wDQYJKoZIhvcNAQEEBQADggEBABnTDPEF + 3iSP0wNfdIjIz1AlnrP \n + zgAIHVvXxunW7SBrDhEglQZBbKJEk5kT0mtKoOD1JMrSu1xuTKEBahWRbqHsXcla \n + XjoBADb0kkjVEJu / Lh5hgYZnOjvlba8Ld7HCKePCVePoTJBdI4fvugnL8TsgK05a \n + IskyY0hKI9L8KfqfGTl1lzOv2KoWD0KWwtAWPoGChZxmQ + nBli + gwYMzM1vAkP + a \n + ayLe0a1EQimlOalO762r0GXO0ks + UeXde2Z4e + 8S / pf7pITEI / tP + MxJTALw9QUW \n + Ev9lKTk + jkbqxbsh8nfBUapfKqYn0eidpwq2AzVp3juYl7 / / fKnaPhJD9gs = \n + < / signing _ certificate > \n",Add new debug certificate . \n Bug : 19621186 \n Change - Id : I0610b56e02afdd098c24ed3cbac3cd2aa62d1a9f,415
"README . md \n - on Android phones , tablets , Android Auto , Android Wear and Cast devices . \n + on Android phones , tablets , Android Auto , Android Wear , Android TV and Google Cast devices . \n + ! [ Android TV ] ( screenshots / android _ tv . png "" Running on an Android TV "" ) \n new file \n screenshots \ android _ tv . png \n Binary files / dev / null and b / screenshots / android _ tv . png differ \n",Add Android TV screenshot \n Bug : 21668210 \n Change - Id : I419f4565dbecc25ec5e178b40d10a461b9a38e24,415
". google \ packaging . yaml \n - - - \n - technologies : [ Android , Android Auto , ChromeCast , Google Cast , Android Wear ] \n + technologies : [ Android , Android Auto , ChromeCast , Google Cast , Android Wear , Android TV ] \n",Add AndroidTV to packaging . yaml \n Change - Id : Icb34d40d7c0c68167f8512be03f218144ef73243,415
"mobile \ src \ main \ res \ layout \ activity _ full _ player . xml \n - < ! - - android . support . v7 . widget . Toolbar \n - android : id = "" @ + id / toolbar "" \n - android : layout _ height = "" wrap _ content "" \n - android : layout _ width = "" match _ parent "" \n - android : minHeight = "" ? attr / actionBarSize "" \n - android : background = "" @ drawable / actionbar _ bg _ gradient _ light "" \n - app : theme = "" @ style / ThemeOverlay . AppCompat . Dark . ActionBar "" \n - app : popupTheme = "" @ style / ThemeOverlay . AppCompat . Light "" / - - > \n mobile \ src \ main \ res \ layout \ include _ drawerlist . xml \n + android : elevation = "" 16dp "" \n mobile \ src \ main \ res \ layout \ include _ toolbar . xml \n + android : elevation = "" 4dp "" \n",Add proper elevation to UI elements . \n Bug : 19301153 \n Change - Id : I14979ba2339ba5bb47c6a89901b1bfc08075343e,415
"mobile \ src \ main \ AndroidManifest . xml \n + < ! - - \n + ( OPTIONAL ) use this meta data to override the theme from which Android Auto will \n + look for colors . If you don ' t set this , Android Auto will look \n + for color attributes in your application theme . \n + - - > \n + < meta - data \n + android : name = "" com . google . android . gms . car . application . theme "" \n + android : resource = "" @ style / CarTheme "" / > \n + \n mobile \ src \ main \ res \ values \ styles . xml \n - < ! - - colorPrimary is used for Notification icon and bottom facet bar icons \n - and overflow actions - - > \n + < item name = "" colorPrimaryDark "" > # ffbf360c < / item > \n + < item name = "" colorAccent "" > # ffff5722 < / item > \n + < / style > \n - < ! - - colorPrimaryDark is used for background - - > \n + \n + < style name = "" CarTheme "" parent = "" UAmpAppTheme "" > \n + < ! - - colorPrimaryDark is currently used in Android Auto for : \n + - App background \n + - Drawer right side ( "" more "" custom actions ) background \n + - Notification icon badge tinting \n + - Overview “now playing” icon tinting \n + - - > \n - < ! - - colorAccent is sparingly used for accents , like floating action button highlight , \n - progress on playbar - - > \n - < item name = "" colorAccent "" > # ffff5722 < / item > \n + < ! - - colorAccent is used in Android Auto for : \n + - Spinner \n + - progress bar \n + - floating action button background ( Play / Pause in media apps ) \n + - - > \n + < item name = "" colorAccent "" > @ color / bt _ accent < / item > \n",Add custom car theme and adapt to new Auto guidelines \n Bug : 19500175 \n Change - Id : I8be6bd631b97e50066df2be7200b3813e2596251,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ PackageValidator . java \n + * \n + * If you add a new valid caller to allowed _ media _ browser _ callers . xml and you don ' t know \n + * its signature , this class will print to logcat ( INFO level ) a message with the proper base64 \n + * version of the caller certificate that has not been validated . You can copy from logcat and \n + * paste into allowed _ media _ browser _ callers . xml . Spaces and newlines are ignored . \n mobile \ src \ main \ res \ xml \ allowed _ media _ browser _ callers . xml \n - - > \n + < ! - - \n + If you add a new signing _ certificate to allowed _ callers and you don ' t know its signature , \n + PackageValidator by default will print to logcat ( INFO level ) a message with the proper base64 \n + version of the caller ' s certificate that has not been validated . You can copy from logcat and \n + paste it here . \n + \n + Spaces and newlines are ignored . \n + - - > \n",Add instructions on how to add new allowed caller \n Bug : 23006118 \n Change - Id : If4a32a5a11c8704dface29fbe735d5e0ba95f243,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MusicService . java \n + / * * \n + * Handle free and contextual searches . \n + * \n + * All voice searches on Android Auto are sent to this method through a connected \n + * { @ link android . media . session . MediaController } . \n + * < p > \n + * Threads and async handling : \n + * In a real world application , searching should run in another thread . \n + * \n + * Since this method runs on the main thread , most apps with non - trivial metadata \n + * should defer the actual search to another thread ( for example , by using \n + * an { @ link android . os . AsyncTask } ) . \n + * \n + * Since our media metadata is very small , it is entirely loaded into \n + * memory during the { @ link MusicProvider } initialization , and searching is an \n + * O ( n ) operation on a very small in - memory dataset . We only use an AsyncTask to wait \n + * if the { @ link MusicProvider } has not yet been initialized . \n + * * / \n - / / Voice searches may occur before the media catalog has been \n - / / prepared . We only handle the search after the musicProvider is ready . \n",Update onPlayFromSearch javadoc with async info . \n Bug : 22374913 \n Change - Id : I6113506cd8b794dc09680b43080a89a893e52b31,415
"build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 2 . 3 ' \n + classpath ' com . android . tools . build : gradle : 1 . 3 . 0 ' \n mobile \ build . gradle \n - compileSdkVersion 22 \n - buildToolsVersion "" 22 . 0 . 1 "" \n + compileSdkVersion 23 \n + buildToolsVersion "" 23 . 0 . 1 "" \n - targetSdkVersion 22 \n + targetSdkVersion 23 \n - buildTypes { \n - release { \n - minifyEnabled false \n - proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' \n - } \n - } \n + buildTypes { \n + release { \n + minifyEnabled false \n + proguardFiles getDefaultProguardFile ( ' proguard - android . txt ' ) , ' proguard - rules . pro ' \n + } \n + } \n - compile ' com . google . android . gms : play - services - cast : 7 . 5 . 0 ' \n + compile ' com . google . android . gms : play - services - cast : 7 . 8 . 0 ' \n - compile ' com . android . support : support - v4 : 22 . 2 . 0 ' \n - compile ' com . android . support : appcompat - v7 : 22 . 2 . 0 ' \n - compile ' com . android . support : cardview - v7 : 22 . 2 . 0 ' \n - compile ' com . android . support : mediarouter - v7 : 22 . 2 . 0 ' \n - compile ' com . android . support : leanback - v17 : 22 . 2 . 0 ' \n + compile ' com . android . support : support - v4 : 23 . 0 . 1 ' \n + compile ' com . android . support : appcompat - v7 : 23 . 0 . 1 ' \n + compile ' com . android . support : cardview - v7 : 23 . 0 . 1 ' \n + compile ' com . android . support : mediarouter - v7 : 23 . 0 . 1 ' \n + compile ' com . android . support : leanback - v17 : 23 . 0 . 1 ' \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ ui \ ActionBarCastActivity . java \n + import android . support . v4 . view . GravityCompat ; \n - import android . view . Gravity ; \n - if ( mDrawerLayout ! = null & & mDrawerLayout . isDrawerOpen ( Gravity . START ) ) { \n + if ( mDrawerLayout ! = null & & mDrawerLayout . isDrawerOpen ( GravityCompat . START ) ) { \n",Update build dependencies . \n Bug : 24141272 \n Change - Id : I555facf90f92aee0ec8ff416f0aa761dbffa3d67,415
"mobile \ src \ main \ res \ layout \ activity _ player . xml \n - - > \n + xmlns : android . support . v7 . cardview = "" http : / / schemas . android . com / apk / res - auto "" \n - android : layout _ alignParentBottom = "" true "" / > \n + android : layout _ alignParentBottom = "" true "" \n + android . support . v7 . cardview : cardElevation = "" 8dp "" / > \n",Add proper elevation to playbackcontrols \n Bug : 19300863 \n Change - Id : Idcf8dcef4e2d2df671227c4f2a0506f749fd9dfe,415
screenshots \ android _ auto . png \n Binary files a / screenshots / android _ auto . png and b / screenshots / android _ auto . png differ \n screenshots \ android _ wear _ 1 . png \n Binary files a / screenshots / android _ wear _ 1 . png and b / screenshots / android _ wear _ 1 . png differ \n screenshots \ android _ wear _ 2 . png \n Binary files a / screenshots / android _ wear _ 2 . png and b / screenshots / android _ wear _ 2 . png differ \n screenshots \ phone . png \n Binary files a / screenshots / phone . png and b / screenshots / phone . png differ \n screenshots \ phone _ cast _ dialog . png \n Binary files a / screenshots / phone _ cast _ dialog . png and b / screenshots / phone _ cast _ dialog . png differ \n screenshots \ phone _ fullscreen _ player . png \n Binary files a / screenshots / phone _ fullscreen _ player . png and b / screenshots / phone _ fullscreen _ player . png differ \n screenshots \ phone _ lockscreen . png \n Binary files a / screenshots / phone _ lockscreen . png and b / screenshots / phone _ lockscreen . png differ \n,Update screenshots . \n Change - Id : I22b574434b6a71db28c38e2bce778dc0e99e495c,415
"mobile \ src \ main \ res \ values \ styles . xml \n - < ! - - colorPrimary is used for Notification icon and bottom facet bar icons \n - and overflow actions - - > \n + < ! - - colorPrimary is used for : \n + - Phone : Action bar ( App bar ) \n + - Auto : Notification icon and bottom facet bar icons and overflow actions \n + - - > \n - < ! - - colorPrimaryDark is used for background - - > \n - < item name = "" colorPrimaryDark "" > # ffbf360c < / item > \n + < ! - - colorPrimaryDark is used for : \n + - Phone : Status bar and contextual app bars \n + - Auto : background when there is no album art \n + - - > \n + < item name = "" colorPrimaryDark "" > # ffD84315 < / item > \n - < ! - - colorAccent is sparingly used for accents , like floating action button highlight , \n - progress on playbar - - > \n + < ! - - colorAccent is used for : \n + - Phone : Accents on UI controls , like checkbox and text fields \n + - Auto : Accents like floating action button highlight , progress on playbar \n + - - > \n",Change status bar color to a lighter one . \n Bug : 19301157 \n Change - Id : I85f8015229c85146ab4f96a31268f9cf9d283e28,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MusicService . java \n - mMusicProvider . retrieveMediaAsync ( null ) ; \n + / / To make the app more responsive , fetch and cache catalog information now . \n + / / This can help improve the response time in the method \n + / / { @ link # onLoadChildren ( String , Result < List < MediaItem > > ) onLoadChildren ( ) } . \n + mMusicProvider . retrieveMediaAsync ( null / * Callback * / ) ; \n - / / To make the app more responsive , fetch and cache catalog information now . \n - / / This can help improve the response time in the method \n - / / { @ link # onLoadChildren ( String , Result < List < MediaItem > > ) onLoadChildren ( ) } . \n - mMusicProvider . retrieveMediaAsync ( null / * Callback * / ) ; \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ model \ MusicProvider . java \n - / / Nothing to do , execute callback immediately \n - callback . onMusicCatalogReady ( true ) ; \n + if ( callback ! = null ) { \n + / / Nothing to do , execute callback immediately \n + callback . onMusicCatalogReady ( true ) ; \n + } \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ playback \ PlaybackManager . java \n + mQueueManager . updateMetadata ( ) ; \n",Fix minor playback issues \n Change - Id : Ie00e351ba0f054ab7f3bd98dee676f1b7982bcf1,415
mobile \ src \ androidTest \ java \ com \ example \ android \ uamp \ model \ MusicProviderTest . java \n + import android . support . test . runner . AndroidJUnit4 ; \n + import org . junit . runner . RunWith ; \n + / * * \n + * Android instrumentation unit tests for { @ link MusicProvider } and related classes . \n + * / \n + @ RunWith ( AndroidJUnit4 . class ) \n mobile \ src \ androidTest \ java \ com \ example \ android \ uamp \ playback \ PlaybackManagerTest . java \n + import android . support . test . runner . AndroidJUnit4 ; \n + import org . junit . runner . RunWith ; \n + / * * \n + * Android instrumentation unit tests for { @ link PlaybackManager } and related classes . \n + * / \n + @ RunWith ( AndroidJUnit4 . class ) \n - public void setUp ( ) throws Exception { \n + public void setUpMusicProvider ( ) throws Exception { \n mobile \ src \ androidTest \ java \ com \ example \ android \ uamp \ playback \ QueueManagerTest . java \n + / * * \n + * Android instrumentation unit tests for { @ link QueueManager } and related classes . \n + * / \n mobile \ src \ test \ java \ com \ example \ android \ uamp \ utils \ MediaIDHelperTest . java \n + import org . junit . runner . RunWith ; \n + import org . junit . runners . JUnit4 ; \n + / * * \n + * Unit tests for the { @ link MediaIDHelper } class . Exercises the helper methods that \n + * do MediaID to MusicID conversion and hierarchy ( categories ) extraction . \n + * / \n + @ RunWith ( JUnit4 . class ) \n,Address late comments on legit / 16742 \n Change - Id : I6498d97499a8c479f2d0a9fe59db37919af80e1d,415
README . md \n - - - - - - - - - - - - - - \n - - Android SDK v21 \n + - Android SDK v17 \n - - - - - - - - - - - - - - - \n,update minsdk on README \n Change - Id : I7b97968fce07ee31f3e299d3ea3d5f2b144aeafc,415
"build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 3 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 1 . 0 ' \n gradle \ wrapper \ gradle - wrapper . properties \n - # Mon Dec 08 10 : 01 : 44 PST 2014 \n + # Thu Jun 02 15 : 18 : 55 PDT 2016 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 2 . 1 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 10 - all . zip \n mobile \ build . gradle \n - buildToolsVersion "" 23 . 0 . 2 "" \n + buildToolsVersion "" 23 . 0 . 3 "" \n - compile ' com . google . android . gms : play - services - cast : 8 . 4 . 0 ' \n + compile ' com . google . android . gms : play - services - cast : 9 . 0 . 0 ' \n - compile ' com . android . support : appcompat - v7 : 23 . 2 . 0 ' \n - compile ' com . android . support : cardview - v7 : 23 . 2 . 0 ' \n - compile ' com . android . support : mediarouter - v7 : 23 . 2 . 0 ' \n - compile ' com . android . support : leanback - v17 : 23 . 2 . 0 ' \n - compile ' com . google . android . libraries . cast . companionlibrary : ccl : 2 . 8 . 1 ' \n - compile ' com . android . support : design : 23 . 2 . 0 ' \n + compile ' com . android . support : appcompat - v7 : 23 . 4 . 0 ' \n + compile ' com . android . support : cardview - v7 : 23 . 4 . 0 ' \n + compile ' com . android . support : mediarouter - v7 : 23 . 4 . 0 ' \n + compile ' com . android . support : leanback - v17 : 23 . 4 . 0 ' \n + compile ' com . google . android . libraries . cast . companionlibrary : ccl : 2 . 8 . 4 ' \n + compile ' com . android . support : design : 23 . 4 . 0 ' \n - androidTestCompile ' com . android . support : support - annotations : 23 . 2 . 0 ' \n + androidTestCompile ' com . android . support : support - annotations : 23 . 4 . 0 ' \n","Update gradle and dependencies . \n Upgrade gradle , gradle plugin , buildToolsVersion , Cast , CCL and support \n libraries . \n Change - Id : I5fad3a4eed57a9b48df3e9b4fc7f3eb47bf55816",415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ playback \ PlaybackManager . java \n - mQueueManager . setQueueFromSearch ( query , extras ) ; \n - handlePlayRequest ( ) ; \n - mQueueManager . updateMetadata ( ) ; \n + boolean successSearch = mQueueManager . setQueueFromSearch ( query , extras ) ; \n + if ( successSearch ) { \n + handlePlayRequest ( ) ; \n + mQueueManager . updateMetadata ( ) ; \n + } else { \n + updatePlaybackState ( "" Could not find music "" ) ; \n + } \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ playback \ QueueManager . java \n - public void setQueueFromSearch ( String query , Bundle extras ) { \n - setCurrentQueue ( mResources . getString ( R . string . search _ queue _ title ) , \n - QueueHelper . getPlayingQueueFromSearch ( query , extras , mMusicProvider ) ) ; \n + public boolean setQueueFromSearch ( String query , Bundle extras ) { \n + List < MediaSessionCompat . QueueItem > queue = \n + QueueHelper . getPlayingQueueFromSearch ( query , extras , mMusicProvider ) ; \n + setCurrentQueue ( mResources . getString ( R . string . search _ queue _ title ) , queue ) ; \n + return queue ! = null & & ! queue . isEmpty ( ) ; \n",Show message if voice search is unsucessful \n Fixes # 83 \n Change - Id : Idbbf3acac196528b616c551123a3a18897b02228,415
"mobile \ src \ main \ java \ com \ example \ android \ uamp \ MusicService . java \n - result . sendResult ( mMusicProvider . getChildren ( parentMediaId , getResources ( ) ) ) ; \n + if ( mMusicProvider . isInitialized ( ) ) { \n + / / if music library is ready , return immediately \n + result . sendResult ( mMusicProvider . getChildren ( parentMediaId , getResources ( ) ) ) ; \n + } else { \n + / / otherwise , only return results when the music library is retrieved \n + result . detach ( ) ; \n + mMusicProvider . retrieveMediaAsync ( new MusicProvider . Callback ( ) { \n + @ Override \n + public void onMusicCatalogReady ( boolean success ) { \n + result . sendResult ( mMusicProvider . getChildren ( parentMediaId , getResources ( ) ) ) ; \n + } \n + } ) ; \n + } \n mobile \ src \ main \ java \ com \ example \ android \ uamp \ model \ MusicProvider . java \n + public boolean isInitialized ( ) { \n + return mCurrentState = = State . INITIALIZED ; \n + } \n + \n",Wait for music initialization on onLoadChildren \n Fixes # 66 \n Change - Id : I8e52959af7683e257bcf2520f1316814250fe346,415
mobile \ build . gradle \n - compile ' com . android . support : support - v4 : 23 . 1 . 1 ' \n,Remove unneeded dependency \n Change - Id : I19a6d308294c872931bedd0907960b0d8bf9f170,415
mobile \ src \ main \ java \ com \ example \ android \ uamp \ playback \ PlaybackManager . java \n + mQueueManager . updateMetadata ( ) ; \n + mQueueManager . updateMetadata ( ) ; \n,Update metadata on onPlayFromSearch \n Bug : 27326251 \n Change - Id : Ia3e50a92a212485ecb73e1b7b28b9a6671a943e7,415
"android \ src \ main \ res \ values \ strings . xml \n - Copyright 2015 Google Inc . All rights reserved . \n + Copyright 2016 Google Inc . All rights reserved . \n - < ! - - Accessibility description for the GPlus icon in the "" # io15 "" box . - - > \n + < ! - - Accessibility description for the GPlus icon in the "" # io16 "" box . - - > \n - < ! - - Accessibility description for the Twitter icon in the "" # io15 "" box . - - > \n + < ! - - Accessibility description for the Twitter icon in the "" # io16 "" box . - - > \n - < ! - - Accessibility description for the GPlus icon in the "" # io15 extended "" box . - - > \n + < ! - - Accessibility description for the GPlus icon in the "" # io16 extended "" box . - - > \n - < ! - - Accessibility description for the Twitter icon in the "" # io15 extended "" box . - - > \n + < ! - - Accessibility description for the Twitter icon in the "" # io16 extended "" box . - - > \n - < ! - - Accessibility description for the GPlus icon in the "" # io15 request "" box . - - > \n + < ! - - Accessibility description for the GPlus icon in the "" # io16 request "" box . - - > \n - < ! - - Accessibility description for the Twitter icon in the "" # io15 extended "" box . - - > \n + < ! - - Accessibility description for the Twitter icon in the "" # io16 extended "" box . - - > \n - < string name = "" io15 _ logo _ not _ clickable "" > IO16logo not clickable < / string > \n + < string name = "" io15 _ logo _ not _ clickable "" > IO16 logo not clickable < / string > \n - < ! - - Accessibility description for the IO15 extended logo that is not a link . - - > \n + < ! - - Accessibility description for the IO16 extended logo that is not a link . - - > \n",Fixed a minor issue on en - US strings . \n Change - Id : I040b08368736fe7ee2af9d75837b2a18016d38a7,415
"android \ src \ main \ res \ values - pt \ conduct _ text . xml \n - < string name = "" welcome _ conduct _ text "" > < b > Sejam excelentes uns com os outros . < / b > \ nQueremos que a I / O seja uma ótima experiência para todos , sem distinção de identidade ou expressão de gênero , orientação sexual , habilidades diferentes , neurodiversidade , aparência física , dimensões corporais , etnia , nacionalidade , idade ou crença religiosa . Trate todos com respeito . Participe reconhecendo que todos merecem estar aqui – e cada um de nós tem o direito de desfrutar dessa experiência sem receio de assédio , discriminação , ou condescendência , explícita ou por meio de agressões leves . \ n \ n < b > Se você vir ou ouvir algo , manifeste - se . < / b > \ nO assédio não será tolerado e você tem autonomia para intervir educadamente se você ou outras pessoas forem desrespeitadas . A pessoa que está causando o incômodo pode não perceber o que está fazendo e os participantes são encorajados a educadamente chamar a sua atenção quanto ao comportamento indevido . \ n \ n < b > Pratique dizer Sim e . < / b > \ nDesenvolvam as ideias uns dos outros . Todos beneficiamos quando criamos em conjunto . < / string > \n + < string name = "" welcome _ conduct _ text "" > < b > Sejam excelentes uns com os outros . < / b > \ nQueremos que o I / O seja uma ótima experiência para todos , sem distinção de identidade ou expressão de gênero , orientação sexual , habilidades diferentes , neurodiversidade , aparência física , dimensões corporais , etnia , nacionalidade , idade ou crença religiosa . Trate todos com respeito . Participe reconhecendo que todos merecem estar aqui – e cada um de nós tem o direito de desfrutar dessa experiência sem receio de assédio , discriminação , ou condescendência , explícita ou por meio de agressões leves . \ n \ n < b > Se você ver ou ouvir algo , manifeste - se . < / b > \ nO assédio não será tolerado e você tem autonomia para intervir educadamente se você ou outras pessoas forem desrespeitadas . A pessoa que está causando o incômodo pode não perceber o que está fazendo e os participantes são encorajados a educadamente chamar a sua atenção quanto ao comportamento indevido . \ n \ n < b > Pratique dizendo \ "" Sim , e . . . \ "" para os outros . < / b > \ nDesenvolvam as ideias uns dos outros . Todos beneficiamos quando criamos em conjunto . < / string > \n",Fix the conduct text for pt - BR \n Change - Id : I0d2af856767e96561cbe5a8c13c8b6180eb39a9b,415
Libraries \ LogBox \ Data \ parseLogBoxLog . js \n - const isOldComponentStackFormat = / \ s { 4 } in / . test ( consoleArgument ) ; \n - const isNewComponentStackFormat = / \ s { 4 } at / . test ( consoleArgument ) ; \n + const isOldComponentStackFormat = / { 4 } in / . test ( consoleArgument ) ; \n + const isNewComponentStackFormat = / { 4 } at / . test ( consoleArgument ) ; \n,Clean up eager component stack regexes \n Summary : \n Clean up from a previous diff . \n Changelog : [ Internal ] \n Reviewed By : motiz88 \n Differential Revision : D23475250 \n fbshipit - source - id : 3f390134e684bbe95b584dc01b8272a29cecc0af,422
IntegrationTests \ GlobalEvalWithSourceUrlTest . js \n - const parsedStack = parseErrorStack ( error ) ; \n + const parsedStack = parseErrorStack ( error ? . stack ) ; \n Libraries \ Core \ Devtools \ _ _ tests _ _ \ parseErrorStack - test . js \n - const stack = parseErrorStack ( getFakeError ( ) ) ; \n + const stack = parseErrorStack ( getFakeError ( ) . stack ) ; \n - const stack = parseErrorStack ( getWrappedError ( ) ) ; \n + const stack = parseErrorStack ( getWrappedError ( ) . stack ) ; \n - expect ( parseErrorStack ( { } ) ) . toEqual ( [ ] ) ; \n + expect ( parseErrorStack ( undefined ) ) . toEqual ( [ ] ) ; \n Libraries \ Core \ Devtools \ parseErrorStack . js \n - function parseErrorStack ( e : ExtendedError ) : Array < StackFrame > { \n - if ( ! e | | ! e . stack ) { \n + function parseErrorStack ( errorStack ? : string ) : Array < StackFrame > { \n + if ( errorStack = = null ) { \n - const stack = Array . isArray ( e . stack ) \n - ? e . stack \n + const parsedStack = Array . isArray ( errorStack ) \n + ? errorStack \n - ? convertHermesStack ( parseHermesStack ( e . stack ) ) \n - : stacktraceParser . parse ( e . stack ) . map ( frame = > ( { \n + ? convertHermesStack ( parseHermesStack ( errorStack ) ) \n + : stacktraceParser . parse ( errorStack ) . map ( frame = > ( { \n - return stack ; \n + return parsedStack ; \n Libraries \ Core \ ExceptionsManager . js \n - const stack = parseErrorStack ( e ) ; \n + const stack = parseErrorStack ( e ? . stack ) ; \n Libraries \ LogBox \ Data \ LogBoxData . js \n - / / TODO : Use Error . captureStackTrace on Hermes \n - const stack = parseErrorStack ( errorForStackTrace ) ; \n + const stack = parseErrorStack ( errorForStackTrace ? . stack ) ; \n,"Only pass Error . stack to parseErrorStack \n Summary : \n I want to be able parse error stacks in contexts where I have a call stack string but no error object . \n This diff changes parseErrorStack to only accept the stack , instead of a whole error object . \n Changelog : [ Internal ] \n Reviewed By : motiz88 \n Differential Revision : D22752048 \n fbshipit - source - id : b4b1cd58802eefe736130d48a82bc091241a11ee",422
"Libraries \ Modal \ _ _ tests _ _ \ Modal - test . js \n - it ( ' should shallow render as < Component > when mocked ' , ( ) = > { \n + it ( ' should shallow render as < Modal > when mocked ' , ( ) = > { \n Libraries \ Modal \ _ _ tests _ _ \ _ _ snapshots _ _ \ Modal - test . js . snap \n - exports [ ` < Modal / > should shallow render as < Component > when mocked 1 ` ] = ` \n - < Component \n + exports [ ` < Modal / > should shallow render as < Modal > when mocked 1 ` ] = ` \n + < Modal \n - < / Component > \n + < / Modal > \n jest \ mockComponent . js \n + const name = \n + RealComponent . displayName | | \n + RealComponent . name | | \n + ( RealComponent . render / / handle React . forwardRef \n + ? RealComponent . render . displayName | | RealComponent . render . name \n + : ' Unknown ' ) ; \n + \n + const nameWithoutPrefix = name . replace ( / ^ ( RCT | RK ) / , ' ' ) ; \n + \n - const name = \n - RealComponent . displayName | | \n - RealComponent . name | | \n - ( RealComponent . render / / handle React . forwardRef \n - ? RealComponent . render . displayName | | RealComponent . render . name \n - : ' Unknown ' ) ; \n - \n - return React . createElement ( \n - name . replace ( / ^ ( RCT | RK ) / , ' ' ) , \n - props , \n - this . props . children , \n - ) ; \n + return React . createElement ( nameWithoutPrefix , props , this . props . children ) ; \n + Component . displayName = nameWithoutPrefix ; \n + \n",Correctly mock all components by setting the displayName \n Summary : \n In the next react sync we removed the ` displayName ` from forwardRef and useMemo components ( [ PR here ] ( https : / / github . com / facebook / react / pull / 18495 ) ) . \n This means we need to manually add the displayName in the mock . \n Changelog : [ General ] [ Fixed ] Fix test renderer mocks to use the displayName more often . \n Reviewed By : TheSavior \n Differential Revision : D22775470 \n fbshipit - source - id : 1390dc325e34f7ccea32bbdf1c6a8f6efea3a080,422
"Libraries \ Components \ TextInput \ TextInput . js \n - const { useEffect , useRef , useState } = React ; \n + const { useLayoutEffect , useRef , useState } = React ; \n - useEffect ( ( ) = > { \n + useLayoutEffect ( ( ) = > { \n - useEffect ( ( ) = > { \n + useLayoutEffect ( ( ) = > { \n + \n + if ( TextInputState . currentlyFocusedInput ( ) = = = inputRefValue ) { \n + nullthrows ( inputRefValue ) . blur ( ) ; \n + } \n - useEffect ( ( ) = > { \n - / / When unmounting we need to blur the input \n - return ( ) = > { \n - if ( isFocused ( ) ) { \n - nullthrows ( inputRef . current ) . blur ( ) ; \n - } \n - } ; \n - } , [ inputRef ] ) ; \n - \n","Switch TextInput to useLayoutEffect \n Summary : \n This diff fixes an issue in ` TextInput ` where ` TextInputState . currentlyFocusedInputRef ` could maintain a ref to a view that no longer exists . This issue was exposed when upgrading React , where cleanups for passive effects are deferred . This change means that ` inputRef . current ` would no longer reference the host view * to be * destroyed ; it would be null because the view was * already destroyed * . \n There are two fixes here that would independently fix the bug and fix the issue better together . \n First , we convert ` useEffect ` to ` useLayoutEffect ` . ` useLayoutEffect ` is intended to fire synchronously after all host view mutations , and the cleanup function is intended to fire synchronously before the host view is destroyed , similar to the behavior assumed before . This change is now the correct function to use semantically . However , if we made this change without the second then any change in the order the effects fire would surface the same bug . \n So second , move the ` inputRefValue ) . blur ( ) ` call to the same effect as unregistering . This is because we currently require the ` blur ` effect to be called to null out ` currentlyFocusedInputRef ` in addition to calling ` unregisterInput ` . That makes the semantic ordering of effects in ` TextInput ` meaningful . Instead , when a TextInput is unregistered we should always ` blur ` to clear the ` currentlyFocusedInputRef ` , which will prevent dispatching events to a view that doesn ' t exist . If we made this change without the first then there ' s would be a race condition between calling blur on a TextInput and when that TextInput has been unregistered . \n Changelog : [ Internal ] \n Reviewed By : JoshuaGross \n Differential Revision : D23035358 \n fbshipit - source - id : ab686b8046d85e2becd8b879b0b4b7e69e672754",422
"package . json \n + "" devDependencies "" : { \n + "" react "" : "" 16 . 13 . 1 "" \n + } , \n","Add react back to dev dependencies for RNTester \n Summary : \n This is a partial revert of D23165627 ( https : / / github . com / facebook / react - native / commit / f3930a93d5cf5f19058b0bfe453c7b9324eb8552 ) which broke RNTester testing internally . \n Changelog : [ Internal ] \n Reviewed By : mdvacca , cpojer \n Differential Revision : D23267175 \n fbshipit - source - id : d0d7010d00cf65497731dd973094fe334215044b",422
"packages \ rn - tester \ android \ app \ build . gradle \n - * / / Enable react - native - codegen during build time . \n - * enableCodegen : true , \n + * / / Enable Fabric at build time and runtime . \n + * enableFabric : true , \n - enableCodegen : System . getenv ( ' USE _ CODEGEN ' ) , \n + enableFabric : ( System . getenv ( ' USE _ FABRIC ' ) ? : ' 0 ' ) . toBoolean ( ) , \n + / * * \n + * Build and enable Fabric in RN Tester app . \n + * / \n + def enableFabric = project . ext . react . enableFabric \n + \n - \n + dexOptions { \n + javaMaxHeapSize "" 4g "" \n + } \n - fabric { \n - / / TODO T71370706 - Create a different dimension to build fabric \n - dimension "" vm "" \n - } \n + buildConfigField ( "" boolean "" , "" ENABLE _ FABRIC "" , "" $ enableFabric "" ) \n - fabricDebugImplementation { } \n - fabricReleaseImplementation { } \n - fabricDebugImplementation files ( hermesPath + "" hermes - debug . aar "" ) \n - fabricReleaseImplementation files ( hermesPath + "" hermes - release . aar "" ) \n + \n + react { \n + enableCodegen = System . getenv ( "" USE _ CODEGEN "" ) ? : false \n + jsRootDir = file ( "" $ rootDir / packages / rn - tester "" ) \n + reactNativeRootDir = file ( "" $ rootDir "" ) \n + useJavaGenerator = System . getenv ( "" USE _ CODEGEN _ JAVAPOET "" ) ? : false \n + } \n packages \ rn - tester \ android \ app \ src \ main \ java \ com \ facebook \ react \ uiapp \ RNTesterApplication . java \n - import static com . facebook . react . uiapp . BuildConfig . FLAVOR ; \n + import static com . facebook . react . uiapp . BuildConfig . ENABLE _ FABRIC ; \n - static final boolean IS _ FABRIC _ ENABLED = FLAVOR . contains ( "" fabric "" ) ; \n + static final boolean IS _ FABRIC _ ENABLED = ENABLE _ FABRIC ; \n",Re - add changes to RNTester \n Summary : \n D23034761 ( https : / / github . com / facebook / react - native / commit / 63992c0b96ec45e4dfb37eaea8535c06833ab298 ) had a bad rebase and we lost some changes from the past week . \n Changelog : [ Internal ] \n Reviewed By : mdvacca \n Differential Revision : D23249804 \n fbshipit - source - id : 7433e1b7673bb6ec8c10fd33a34e94b0998b06d6,422
"Libraries \ Utilities \ ReactNativeTestTools . js \n - const ShallowRenderer = require ( ' react - test - renderer / shallow ' ) ; \n + const ShallowRenderer = require ( ' react - shallow - renderer ' ) ; \n jest \ renderer . js \n - const ShallowRenderer = require ( ' react - test - renderer / shallow ' ) ; \n + \n + const ShallowRenderer = require ( ' react - shallow - renderer ' ) ; \n package . json \n + "" react - shallow - renderer "" : "" 16 . 13 . 1 "" , \n yarn . lock \n + react - shallow - renderer @ 16 . 13 . 1 : \n + version "" 16 . 13 . 1 "" \n + resolved "" https : / / registry . yarnpkg . com / react - shallow - renderer / - / react - shallow - renderer - 16 . 13 . 1 . tgz # 4cfd6dc0f05a8d4d261ff7a80e9b88f15491a00a "" \n + integrity sha512 - hLmExm5 / ZnjodLgm / 4oxYw4i7fL6LLPhbO9mF / 4tmaZUurtLrp2aSeDHZmRk0SVCHXPz0VaEbb3Dqi5J7odz7Q = = \n + dependencies : \n + object - assign "" ^ 4 . 1 . 1 "" \n + react - is "" ^ 16 . 12 . 0 "" \n + \n",Switch to react - shallow - renderer \n Summary : \n Replace react - test - renderer / shallow with react - shallow - renderer . \n We should follow up with teams to remove these tests because they will no longer be supported . I would have just removed them but test like ` BillingReauthorizeCreditCardContainer - test ` seem important . \n Changelog : [ Internal ] \n Reviewed By : cpojer \n Differential Revision : D22225642 \n fbshipit - source - id : a6bd559311422cb14576a574165ed7dc0279919d,422
"spring - test \ src \ main \ java \ org \ springframework \ test \ web \ reactive \ server \ DefaultWebTestClientBuilder . java \n - @ Deprecated \n spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ client \ DefaultWebClientBuilder . java \n - @ Deprecated \n - Assert . notNull ( strategies , "" ExchangeStrategies must not be null "" ) ; \n - @ SuppressWarnings ( "" deprecation "" ) \n",Polishing ( follow - up on acfeb7 ),435
src \ docs \ asciidoc \ core \ core - beans . adoc \n - = = = = \n,Remove mismatched marker in core - beans . adoc \n Closes gh - 24132,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ util \ UriUtils . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n + import java . util . List ; \n + import org . springframework . util . LinkedMultiValueMap ; \n + import org . springframework . util . MultiValueMap ; \n - \n + / * * \n + * Encode the query parameters from the given { @ code MultiValueMap } with UTF - 8 . \n + * < p > This can be used with { @ link UriComponentsBuilder # queryParams ( MultiValueMap ) } \n + * when building a URI from an already encoded template . \n + * < pre class = "" code "" > \n + * MultiValueMap & lt ; String , String & gt ; params = new LinkedMultiValueMap < > ( 2 ) ; \n + * / / add to params . . . \n + * \n + * ServletUriComponentsBuilder . fromCurrentRequest ( ) \n + * . queryParams ( UriUtils . encodeQueryParams ( params ) ) \n + * . build ( true ) \n + * . toUriString ( ) ; \n + * < / pre > \n + * @ param params the parameters to encode \n + * @ return a new { @ code MultiValueMap } with the encoded names and values \n + * @ since 5 . 2 . 3 \n + * / \n + public static MultiValueMap < String , String > encodeQueryParams ( MultiValueMap < String , String > params ) { \n + Charset charset = StandardCharsets . UTF _ 8 ; \n + MultiValueMap < String , String > result = new LinkedMultiValueMap < > ( params . size ( ) ) ; \n + for ( Map . Entry < String , List < String > > entry : params . entrySet ( ) ) { \n + for ( String value : entry . getValue ( ) ) { \n + result . add ( encodeQueryParam ( entry . getKey ( ) , charset ) , encodeQueryParam ( value , charset ) ) ; \n + } \n + } \n + return result ; \n + } \n + \n",Add UriUtils . encodeQueryParams \n Closes gh - 24043,435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ BodyExtractors . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n - private static Mono < Void > consumeAndCancel ( ReactiveHttpInputMessage message ) { \n - return message . getBody ( ) \n - . map ( buffer - > { \n - DataBufferUtils . release ( buffer ) ; \n - throw new ReadCancellationException ( ) ; \n - } ) \n - . onErrorResume ( ReadCancellationException . class , ex - > Mono . empty ( ) ) \n - . then ( ) ; \n - } \n - \n - @ SuppressWarnings ( "" serial "" ) \n - private static class ReadCancellationException extends RuntimeException { \n + private static Flux < DataBuffer > consumeAndCancel ( ReactiveHttpInputMessage message ) { \n + return message . getBody ( ) . takeWhile ( buffer - > { \n + DataBufferUtils . release ( buffer ) ; \n + return false ; \n + } ) ; \n",Replace ReadCancellationException with takeWhile \n Closes gh - 24125,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ codec \ xml \ Jaxb2XmlDecoder . java \n + import org . springframework . http . MediaType ; \n - super ( MimeTypeUtils . APPLICATION _ XML , MimeTypeUtils . TEXT _ XML ) ; \n + super ( MimeTypeUtils . APPLICATION _ XML , MimeTypeUtils . TEXT _ XML , new MediaType ( "" application "" , "" * + xml "" ) ) ; \n spring - web \ src \ main \ java \ org \ springframework \ http \ codec \ xml \ XmlEventDecoder . java \n + import org . springframework . http . MediaType ; \n - super ( MimeTypeUtils . APPLICATION _ XML , MimeTypeUtils . TEXT _ XML ) ; \n + super ( MimeTypeUtils . APPLICATION _ XML , MimeTypeUtils . TEXT _ XML , new MediaType ( "" application "" , "" * + xml "" ) ) ; \n","Add "" application / * + xml "" to XML decoders \n Closes gh - 24164",435
"spring - web \ src \ main \ java \ org \ springframework \ http \ ContentDisposition . java \n - charset = Charset . forName ( value . substring ( 0 , idx1 ) ) ; \n + charset = Charset . forName ( value . substring ( 0 , idx1 ) . trim ( ) ) ; \n spring - web \ src \ test \ java \ org \ springframework \ http \ ContentDispositionTests . java \n + @ Test / / gh - 24112 \n + public void parseEncodedFilenameWithPaddedCharset ( ) { \n + assertThat ( parse ( "" attachment ; filename * = UTF - 8 ' ' some - file . zip "" ) ) \n + . isEqualTo ( ContentDisposition . builder ( "" attachment "" ) \n + . filename ( "" some - file . zip "" , StandardCharsets . UTF _ 8 ) \n + . build ( ) ) ; \n + } \n + \n",ContentDisposition trims charset in filename \n Closes gh - 24112,435
"src \ docs \ asciidoc \ web \ webmvc . adoc \n - In order to support < < mvc - ann - async , asynchronous requests > > this filter must be mapped \n - with ` DispatcherType . ASYNC ` so that the filter can delay and successfully generate the an \n - ETag to the end of the last async dispatch . If using Spring Framework ' s \n - ` AbstractAnnotationConfigDispatcherServletInitializer ` ( see < < mvc - container - config > > ) \n - all filters are automatically registered for all dispatch types . However if registering \n - the filter via web . xml or in Spring Boot via a ` FilterRegistrationBean ` be sure to include \n - ` DispatcherType . ASYNC ` . \n + In order to support < < mvc - ann - async , asynchronous requests > > and error dispatches this \n + filter should be mapped with ` DispatcherType . ASYNC ` and also ` DispatcherType . ERROR ` . \n + If using Spring Framework ' s ` AbstractAnnotationConfigDispatcherServletInitializer ` \n + ( see < < mvc - container - config > > ) all filters are automatically registered for all dispatch \n + types . However if registering the filter via web . xml or in Spring Boot via a \n + ` FilterRegistrationBean ` be sure to include ` DispatcherType . ASYNC ` and \n + ` DispatcherType . ERROR ` in addition to ` DispatcherType . REQUEST ` . \n",Fix copy - and - paste error in docs,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ FormHttpMessageConverter . java \n + import org . springframework . util . CollectionUtils ; \n - formData . forEach ( ( name , values ) - > \n + formData . forEach ( ( name , values ) - > { \n + if ( name = = null ) { \n + Assert . isTrue ( CollectionUtils . isEmpty ( values ) , "" Null name in form data : "" + formData ) ; \n + return ; \n + } \n - } ) ) ; \n + } ) ; \n + } ) ; \n",Reject null form data names \n . . . or skip if there are no values either . \n Closes gh - 22372,435
"spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ client \ jetty \ JettyWebSocketClient . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n + import java . util . concurrent . TimeUnit ; \n - future . get ( ) ; \n + future . get ( this . client . getConnectTimeout ( ) + 2000 , TimeUnit . MILLISECONDS ) ; \n",Avoid indefinite wait in JettyWebSocketClient \n Closes gh - 23994,435
"spring - test \ src \ main \ java \ org \ springframework \ mock \ web \ MockAsyncContext . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n - private long timeout = 10 * 1000L ; / / 10 seconds is Tomcat ' s default \n + private long timeout = 10 * 1000L ; \n spring - web \ src \ test \ java \ org \ springframework \ mock \ web \ test \ MockAsyncContext . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n - private long timeout = 10 * 1000L ; / / 10 seconds is Tomcat ' s default \n + private long timeout = 10 * 1000L ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ config \ annotation \ AsyncSupportConfigurer . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n - * implementation is used , e . g . 10 seconds on Tomcat with Servlet 3 . \n + * implementation is used . \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ RequestMappingHandlerAdapter . java \n - * implementation is used , e . g . 10 seconds on Tomcat with Servlet 3 . \n + * implementation is used . \n spring - webmvc \ src \ main \ resources \ org \ springframework \ web \ servlet \ config \ spring - mvc . xsd \n - the default timeout of the underlying implementation is used , e . g . 10 seconds on Tomcat with Servlet 3 . \n + the default timeout of the underlying implementation is used . \n src \ docs \ asciidoc \ web \ webmvc . adoc \n - on the underlying Servlet container ( for example , 10 seconds on Tomcat ) . \n + on the underlying Servlet container . \n",Remove mentions of Tomcat async request timeout value \n Close gh - 24030,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ server \ reactive \ AbstractListenerWriteProcessor . java \n + / * Indicates "" onComplete "" was received during the ( last ) write . * / \n + / * * \n + * Indicates we ' re waiting for one last isReady - onWritePossible cycle \n + * after "" onComplete "" because some Servlet containers expect this to take \n + * place prior to calling AsyncContext . complete ( ) . \n + * See https : / / github . com / eclipse - ee4j / servlet - api / issues / 273 \n + * / \n + private volatile boolean readyToCompleteAfterLastWrite ; \n + \n - processor . changeStateToComplete ( this ) ; \n + processor . readyToCompleteAfterLastWrite = true ; \n + processor . changeStateToReceived ( this ) ; \n - if ( processor . changeState ( this , WRITING ) ) { \n + if ( processor . readyToCompleteAfterLastWrite ) { \n + processor . changeStateToComplete ( RECEIVED ) ; \n + } \n + else if ( processor . changeState ( this , WRITING ) ) { \n - processor . changeStateToComplete ( REQUESTED ) ; \n + processor . readyToCompleteAfterLastWrite = true ; \n + processor . changeStateToReceived ( REQUESTED ) ; \n",Extra isReady - onWritePossible after last write \n Closes gh - 24050,435
"spring - web \ src \ test \ java \ org \ springframework \ http \ codec \ json \ Jackson2TokenizerTests . java \n - StepVerifier . create ( decode ( source , false , maxInMemorySize - 1 ) ) \n - . expectError ( DataBufferLimitException . class ) ; \n + StepVerifier . create ( decode ( source , false , maxInMemorySize - 2 ) ) \n + . verifyError ( DataBufferLimitException . class ) ; \n",Add missing verify ( ) in Jackson2TokenizerTests \n Closes gh - 24056,435
"spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ server \ support \ WebSocketHttpRequestHandler . java \n - this . wsHandler = new ExceptionWebSocketHandlerDecorator ( new LoggingWebSocketHandlerDecorator ( wsHandler ) ) ; \n + this . wsHandler = decorate ( wsHandler ) ; \n + / * * \n + * Decorate the { @ code WebSocketHandler } passed into the constructor . \n + * < p > By default , { @ link LoggingWebSocketHandlerDecorator } and \n + * { @ link ExceptionWebSocketHandlerDecorator } are added . \n + * @ since 5 . 2 . 2 \n + * / \n + protected WebSocketHandler decorate ( WebSocketHandler handler ) { \n + return new ExceptionWebSocketHandlerDecorator ( new LoggingWebSocketHandlerDecorator ( handler ) ) ; \n + } \n + \n",Protected method to decorate WebSocketHandler \n See gh - 24075,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ simp \ SimpMessagingTemplate . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n + Assert . isTrue ( ! user . contains ( "" % 2F "" ) , "" Invalid sequence \ "" % 2F \ "" in user name : "" + user ) ; \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ simp \ user \ DefaultUserDestinationResolver . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n + Assert . isTrue ( user = = null | | ! user . contains ( "" % 2F "" ) , "" Invalid sequence \ "" % 2F \ "" in user name : "" + user ) ; \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ simp \ SimpMessagingTemplateTests . java \n + import static org . assertj . core . api . Assertions . assertThatIllegalArgumentException ; \n + @ Test / / gh - 23836 \n + public void convertAndSendToUserWithInvalidSequence ( ) { \n + assertThatIllegalArgumentException ( ) . isThrownBy ( ( ) - > \n + this . messagingTemplate . convertAndSendToUser ( "" joe % 2F "" , "" / queue / foo "" , "" data "" ) ) ; \n + } \n + \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ simp \ user \ DefaultUserDestinationResolverTests . java \n + import static org . assertj . core . api . Assertions . assertThatIllegalArgumentException ; \n + @ Test / / gh - 23836 \n + public void handleSubscribeInvalidUserName ( ) { \n + TestPrincipal user = new TestPrincipal ( "" joe % 2F "" ) ; \n + String sourceDestination = "" / user / queue / foo "" ; \n + \n + Message < ? > message = createMessage ( SimpMessageType . SUBSCRIBE , user , "" 123 "" , sourceDestination ) ; \n + assertThatIllegalArgumentException ( ) . isThrownBy ( ( ) - > this . resolver . resolveDestination ( message ) ) ; \n + } \n + \n","Reject user names with "" % 2F "" in STOMP \n Closes gh - 23836",435
"spring - web \ src \ main \ java \ org \ springframework \ http \ client \ MultipartBodyBuilder . java \n - * Builder for the body of a multipart request , producing \n - * { @ code MultiValueMap < String , HttpEntity > } , which can be provided to the \n - * { @ code WebClient } through the { @ code body } method . \n + * Prepare the body of a multipart request , resulting in a \n + * { @ code MultiValueMap < String , HttpEntity > } . Parts may be concrete values or \n + * via asynchronous types such as Reactor { @ code Mono } , { @ code Flux } , and \n + * others registered in the \n + * { @ link org . springframework . core . ReactiveAdapterRegistry ReactiveAdapterRegistry } . \n - * Examples : \n + * < p > This builder is intended for use with the reactive \n + * { @ link org . springframework . web . reactive . function . client . WebClient WebClient } . \n + * For multipart requests with the { @ code RestTemplate } , simply create and \n + * populate a { @ code MultiValueMap < String , HttpEntity > } as shown in the Javadoc for \n + * { @ link org . springframework . http . converter . FormHttpMessageConverter FormHttpMessageConverter } \n + * and in the \n + * < a href = "" https : / / docs . spring . io / spring / docs / current / spring - framework - reference / integration . html # rest - template - multipart "" > reference docs < / a > . \n + * \n + * < p > Below are examples of using this builder : \n",MultipartBodyBuilder Javadoc update \n Closes gh - 24031,435
"spring - test \ src \ main \ java \ org \ springframework \ test \ web \ servlet \ request \ MockHttpServletRequestBuilder . java \n + if ( ! ObjectUtils . isEmpty ( this . content ) & & \n + ! this . headers . containsKey ( HttpHeaders . CONTENT _ LENGTH ) & & \n + ! this . headers . containsKey ( HttpHeaders . TRANSFER _ ENCODING ) ) { \n + \n + request . addHeader ( HttpHeaders . CONTENT _ LENGTH , this . content . length ) ; \n + } \n + \n spring - test \ src \ test \ java \ org \ springframework \ test \ web \ servlet \ request \ MockHttpServletRequestBuilderTests . java \n + assertThat ( request . getContentLength ( ) ) . isEqualTo ( body . length ) ; \n",MockHttpServletRequestBuilder sets content - length \n Closes gh - 23978,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ handler \ AbstractHandlerMapping . java \n + import org . springframework . web . context . request . async . WebAsyncManager ; \n + import org . springframework . web . context . request . async . WebAsyncUtils ; \n + / / Consistent with CorsFilter , ignore ASYNC dispatches \n + WebAsyncManager asyncManager = WebAsyncUtils . getAsyncManager ( request ) ; \n + if ( asyncManager . hasConcurrentResult ( ) ) { \n + return true ; \n + } \n + \n",CorsInterceptor skips async dispatch \n Closes gh - 24223,435
"spring - webflux \ src \ test \ java \ org \ springframework \ web \ reactive \ result \ method \ annotation \ RequestMappingMessageConversionIntegrationTests . java \n + import org . junit . jupiter . api . Disabled ; \n + @ Disabled \n + @ ParameterizedHttpServerTest / / gh - 23791 \n + public void personCreateViaDefaultMethodWithGenerics ( HttpServer httpServer ) throws Exception { \n + startServer ( httpServer ) ; \n + ResponseEntity < String > entity = performPost ( "" / 23791 "" , JSON , new Person ( "" Robert "" ) , null , String . class ) ; \n + \n + assertThat ( entity . getStatusCode ( ) ) . isEqualTo ( HttpStatus . OK ) ; \n + assertThat ( entity . getBody ( ) ) . isEqualTo ( "" Person "" ) ; \n + } \n + \n + \n + private interface Controller23791 < E > { \n + \n + @ PostMapping ( "" / 23791 "" ) \n + default Mono < String > test ( @ RequestBody Mono < E > body ) { \n + return body . map ( value - > value . getClass ( ) . getSimpleName ( ) ) ; \n + } \n + } \n + \n + @ RestController \n + private static class ConcreteController23791 implements Controller23791 < Person > { \n + } \n + \n",Add failing test to be fixed \n See gh - 23791,435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ client \ ClientRequest . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2019 the original author or authors . \n - * The prefix is based on the value of the attribute { @ link # LOG _ ID _ ATTRIBUTE } \n - * along with some extra formatting so that the prefix can be conveniently \n - * prepended with no further formatting no separators required . \n + * The prefix is based on the value of the attribute { @ link # LOG _ ID _ ATTRIBUTE \n + * LOG _ ID _ ATTRIBUTE } surrounded with "" [ "" and "" ] "" . \n - * { @ link # LOG _ ID _ ATTRIBUTE } is not set . \n + * { @ link # LOG _ ID _ ATTRIBUTE LOG _ ID _ ATTRIBUTE } is not set . \n spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ client \ ClientResponse . java \n - * Return a log message prefix to use to correlate messages for this response . \n - * The prefix is based on the { @ linkplain ClientRequest # logPrefix ( ) client \n - * log prefix } , which itself is based on the value of the request attribute \n - * { @ link ClientRequest # LOG _ ID _ ATTRIBUTE } along with some extra formatting \n - * so that the prefix can be conveniently prepended with no further \n - * formatting no separators required . \n + * Return a log message prefix to use to correlate messages for this exchange . \n + * The prefix is based on { @ linkplain ClientRequest # logPrefix ( ) } , which \n + * itself is based on the value of the { @ link ClientRequest # LOG _ ID _ ATTRIBUTE \n + * LOG _ ID _ ATTRIBUTE } request attribute , further surrounded with "" [ "" and "" ] "" . \n - * { @ link ClientRequest # LOG _ ID _ ATTRIBUTE } was not set . \n + * { @ link ClientRequest # LOG _ ID _ ATTRIBUTE LOG _ ID _ ATTRIBUTE } is not set . \n",Polishing logPrefix Javadoc in ClientRequest | Response \n Closes gh - 23791,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ context \ request \ async \ WebAsyncManager . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + / * \n + * Whether the concurrentResult is an error . If such errors remain unhandled , some \n + * Servlet containers will call AsyncListener # onError at the end , after the ASYNC \n + * and / or the ERROR dispatch ( Boot ' s case ) , and we need to ignore those . \n + * / \n + private volatile boolean errorHandlingInProgress ; \n + \n - if ( logger . isDebugEnabled ( ) ) { \n - logger . debug ( "" Async request error for "" + formatRequestUri ( ) + "" : "" + ex ) ; \n + if ( ! this . errorHandlingInProgress ) { \n + if ( logger . isDebugEnabled ( ) ) { \n + logger . debug ( "" Async request error for "" + formatRequestUri ( ) + "" : "" + ex ) ; \n + } \n + Object result = interceptorChain . triggerAfterError ( this . asyncWebRequest , callable , ex ) ; \n + result = ( result ! = CallableProcessingInterceptor . RESULT _ NONE ? result : ex ) ; \n + setConcurrentResultAndDispatch ( result ) ; \n - Object result = interceptorChain . triggerAfterError ( this . asyncWebRequest , callable , ex ) ; \n - result = ( result ! = CallableProcessingInterceptor . RESULT _ NONE ? result : ex ) ; \n - setConcurrentResultAndDispatch ( result ) ; \n + this . errorHandlingInProgress = ( result instanceof Throwable ) ; \n - try { \n - if ( ! interceptorChain . triggerAfterError ( this . asyncWebRequest , deferredResult , ex ) ) { \n - return ; \n + if ( ! this . errorHandlingInProgress ) { \n + try { \n + if ( ! interceptorChain . triggerAfterError ( this . asyncWebRequest , deferredResult , ex ) ) { \n + return ; \n + } \n + deferredResult . setErrorResult ( ex ) ; \n + } \n + catch ( Throwable interceptorEx ) { \n + setConcurrentResultAndDispatch ( interceptorEx ) ; \n - deferredResult . setErrorResult ( ex ) ; \n - } \n - catch ( Throwable interceptorEx ) { \n - setConcurrentResultAndDispatch ( interceptorEx ) ; \n + this . errorHandlingInProgress = false ; \n",Improve error handling in WebAsyncManager \n See gh - 24835,435
"spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ sockjs \ transport \ session \ AbstractSockJsSession . java \n - if ( ! isClosed ( ) ) { \n - this . handler . handleMessage ( this , new TextMessage ( messages [ i ] ) ) ; \n - } \n - else { \n - List < String > undelivered = getUndelivered ( messages , i ) ; \n - if ( undelivered . isEmpty ( ) ) { \n - return ; \n - } \n - throw new SockJsMessageDeliveryException ( this . id , undelivered , "" Session closed "" ) ; \n + if ( isClosed ( ) ) { \n + logUndeliveredMessages ( i , messages ) ; \n + return ; \n + this . handler . handleMessage ( this , new TextMessage ( messages [ i ] ) ) ; \n + if ( isClosed ( ) ) { \n + if ( logger . isTraceEnabled ( ) ) { \n + logger . trace ( "" Failed to handle message ' "" + messages [ i ] + "" ' "" , ex ) ; \n + } \n + logUndeliveredMessages ( i , messages ) ; \n + return ; \n + } \n + private void logUndeliveredMessages ( int index , String [ ] messages ) { \n + List < String > undelivered = getUndelivered ( messages , index ) ; \n + if ( logger . isTraceEnabled ( ) & & ! undelivered . isEmpty ( ) ) { \n + logger . trace ( "" Dropped inbound message ( s ) due to closed session : "" + undelivered ) ; \n + } \n + } \n + \n",Error handling improvement in AbstractSockJsSession \n Closes gh - 24986,435
spring - web \ src \ main \ java \ org \ springframework \ http \ server \ reactive \ WriteResultPublisher . java \n + if ( State . SUBSCRIBED . equals ( publisher . state . get ( ) ) ) { \n + publisher . state . get ( ) . publishComplete ( publisher ) ; \n + } \n + if ( State . SUBSCRIBED . equals ( publisher . state . get ( ) ) ) { \n + publisher . state . get ( ) . publishComplete ( publisher ) ; \n + } \n,Fix race condition in WriteResultPublisher \n Closes gh - 24989,435
"spring - websocket \ src \ test \ java \ org \ springframework \ web \ socket \ sockjs \ transport \ session \ SockJsSessionTests . java \n - import org . springframework . web . socket . sockjs . SockJsMessageDeliveryException ; \n - \n - assertThatExceptionOfType ( SockJsMessageDeliveryException . class ) \n - . isThrownBy ( ( ) - > session . delegateMessages ( msg1 , msg2 , msg3 ) ) \n - . satisfies ( ex - > assertThat ( ex . getUndeliveredMessages ( ) ) . containsExactly ( msg3 ) ) ; \n + session . delegateMessages ( msg1 , msg2 , msg3 ) ; \n",Fix failing test \n See gh - 24986,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR2 "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor Dysprosium snapshots \n spring - web \ src \ test \ java \ org \ springframework \ http \ server \ reactive \ ErrorHandlerIntegrationTests . java \n + import org . junit . Assume ; \n + import org . junit . jupiter . api . Assumptions ; \n + import org . springframework . web . testfixture . http . server . reactive . bootstrap . ReactorHttpServer ; \n + \n + / * Temporarily necessary for https : / / github . com / reactor / reactor - netty / issues / 948 * / \n + Assumptions . assumeFalse ( httpServer instanceof ReactorHttpServer ) ; \n + \n",Upgrade to Dysprosium snapshots \n See gh - 24349,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ config \ annotation \ ViewControllerRegistry . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + * < p > < strong > Note : < / strong > If an { @ code @ RequestMapping } method is mapped \n + * to a URL for any HTTP method then a view controller cannot handle the \n + * same URL . For this reason it is recommended to avoid splitting URL \n + * handling across an annotated controller and a view controller . \n src \ docs \ asciidoc \ web \ webmvc . adoc \n - - - - \n + If an ` @ RequestMapping ` method is mapped to a URL for any HTTP method then a view \n + controller cannot be used to handle the same URL . This is because a match by URL to an \n + annotated controller is considered a strong enough indication of endpoint ownership so \n + that a 405 ( METHOD _ NOT _ ALLOWED ) , a 415 ( UNSUPPORTED _ MEDIA _ TYPE ) , or similar response can \n + be sent to the client to help with debugging . For this reason it is recommended to avoid \n + splitting URL handling across an annotated controller and a view controller . \n + \n",Warning against split URL handling in docs \n Closes gh - 24304,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ simp \ stomp \ StompDecoder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + skipEol ( byteBuffer ) ; \n + if ( ! byteBuffer . hasRemaining ( ) ) { \n + break ; \n + } \n - skipLeadingEol ( byteBuffer ) ; \n + skipEol ( byteBuffer ) ; \n - * Those are STOMP heartbeat frames . \n + * STOMP , section 2 . 1 says : "" The NULL octet can be optionally followed by \n + * multiple EOLs . "" \n - protected void skipLeadingEol ( ByteBuffer byteBuffer ) { \n + protected void skipEol ( ByteBuffer byteBuffer ) { \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ simp \ stomp \ StompDecoderTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - import java . io . UnsupportedEncodingException ; \n - public void decodeFrame ( ) throws UnsupportedEncodingException { \n + public void decodeFrame ( ) { \n + @ Test / / gh - 23713 \n + public void decodeFramesWithExtraNewLines ( ) { \n + String frame1 = "" SEND \ ndestination : test \ n \ nbody \ 0 \ n \ n \ n "" ; \n + ByteBuffer buffer = ByteBuffer . wrap ( ( frame1 ) . getBytes ( ) ) ; \n + \n + final List < Message < byte [ ] > > messages = decoder . decode ( buffer ) ; \n + \n + assertThat ( messages . size ( ) ) . isEqualTo ( 1 ) ; \n + assertThat ( StompHeaderAccessor . wrap ( messages . get ( 0 ) ) . getCommand ( ) ) . isEqualTo ( StompCommand . SEND ) ; \n + } \n + \n - / / SPR - 13111 \n - \n - @ Test \n + @ Test / / SPR - 13111 \n",Fix issue with new line handling in StompDecoder \n Closes gh - 23713,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ server \ adapter \ HttpWebHandlerAdapter . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - private String formatRequest ( ServerHttpRequest request ) { \n + / * * \n + * Format the request for logging purposes including HTTP method and URL . \n + * < p > By default this prints the HTTP method , the URL path , and the query . \n + * @ param request the request to format \n + * @ return the String to display , never empty or @ code null } \n + * / \n + protected String formatRequest ( ServerHttpRequest request ) { \n",HttpWebHandlerAdapter # formatRequest is protected \n Closes gh - 24352,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ codec \ ServerSentEventHttpMessageReader . java \n - . map ( lines - > buildEvent ( lines , valueType , shouldWrap , hints ) ) ; \n + . concatMap ( lines - > { \n + Object event = buildEvent ( lines , valueType , shouldWrap , hints ) ; \n + return ( event ! = null ? Mono . just ( event ) : Mono . empty ( ) ) ; \n + } ) ; \n - Object decodedData = data ! = null ? decodeData ( data . toString ( ) , valueType , hints ) : null ; \n + Object decodedData = ( data ! = null ? decodeData ( data . toString ( ) , valueType , hints ) : null ) ; \n - return decodedData ; \n + return ( decodedData ) ; \n spring - web \ src \ test \ java \ org \ springframework \ http \ codec \ ServerSentEventHttpMessageReaderTests . java \n + @ Test / / gh - 24389 \n + void readPojoWithCommentOnly ( ) { \n + MockServerHttpRequest request = MockServerHttpRequest . post ( "" / "" ) \n + . body ( Flux . just ( stringBuffer ( "" : ping \ n "" ) , stringBuffer ( "" \ n "" ) ) ) ; \n + \n + Flux < Object > data = this . reader . read ( \n + ResolvableType . forType ( String . class ) , request , Collections . emptyMap ( ) ) ; \n + \n + StepVerifier . create ( data ) . expectComplete ( ) . verify ( ) ; \n + } \n + \n",Avoid NPE on comment SSE event \n Closes gh - 24389,435
spring - web \ src \ main \ java \ org \ springframework \ web \ util \ HierarchicalUriComponents . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - if ( b < 0 ) { \n - b + = 256 ; \n - } \n - if ( b < 0 ) { \n - b + = 256 ; \n - } \n,Remove no - op code in URI encoding \n Closes gh - 24413,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ client \ reactive \ ReactorResourceFactory . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - private Supplier < ConnectionProvider > connectionProviderSupplier = ( ) - > ConnectionProvider . elastic ( "" webflux "" ) ; \n + private Supplier < ConnectionProvider > connectionProviderSupplier = ( ) - > ConnectionProvider . fixed ( "" webflux "" , 500 ) ; \n","Update default value in ReactorResourceFactory \n We used ConnectionProvider # elastic only to customize the name . Now that \n Reactor Netty ' s TcpResources itself uses fixed 500 by default , we \n update to have the same value which would apply when global resources \n are not used . \n Closes gh - 24424",435
"spring - web \ src \ main \ java \ org \ springframework \ http \ server \ reactive \ ReactorServerHttpRequest . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import java . util . concurrent . atomic . AtomicLong ; \n + private static final AtomicLong logPrefixIndex = new AtomicLong ( 0 ) ; \n + \n + \n - return this . request instanceof Connection ? \n - ( ( Connection ) this . request ) . channel ( ) . id ( ) . asShortText ( ) : null ; \n + if ( this . request instanceof Connection ) { \n + return ( ( Connection ) this . request ) . channel ( ) . id ( ) . asShortText ( ) + \n + "" - "" + logPrefixIndex . incrementAndGet ( ) ; \n + } \n + return null ; \n",Append unique number to WebFlux server log prefix \n Closes gh - 22039,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ util \ UriComponentsBuilder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - resetSchemeSpecificPart ( ) ; \n + if ( host ! = null ) { \n + resetSchemeSpecificPart ( ) ; \n + } \n - resetSchemeSpecificPart ( ) ; \n + if ( port > - 1 ) { \n + resetSchemeSpecificPart ( ) ; \n + } \n - resetSchemeSpecificPart ( ) ; \n + if ( port ! = null ) { \n + resetSchemeSpecificPart ( ) ; \n + } \n + resetSchemeSpecificPart ( ) ; \n - resetSchemeSpecificPart ( ) ; \n + resetSchemeSpecificPart ( ) ; \n - resetSchemeSpecificPart ( ) ; \n + resetSchemeSpecificPart ( ) ; \n spring - web \ src \ test \ java \ org \ springframework \ web \ util \ UriComponentsBuilderTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + @ Test / / gh - 24444 \n + public void opaqueUriDoesNotResetOnNullInput ( ) throws URISyntaxException { \n + URI uri = new URI ( "" urn : ietf : wg : oauth : 2 . 0 : oob "" ) ; \n + UriComponents result = UriComponentsBuilder . fromUri ( uri ) \n + . host ( null ) \n + . port ( - 1 ) \n + . port ( null ) \n + . queryParams ( null ) \n + . replaceQuery ( null ) \n + . query ( null ) \n + . build ( ) ; \n + \n + assertThat ( result . toUri ( ) ) . isEqualTo ( uri ) ; \n + } \n + \n",Only non - null input resets scheme specific part \n Closes gh - 24444,435
src \ docs \ asciidoc \ rsocket . adoc \n - - - - \n - . encoders ( encoders - > encoders . add ( new Jackson2CborEncoder ) ) \n - . decoders ( decoders - > decoders . add ( new Jackson2CborDecoder ) ) \n + . encoders ( encoders - > encoders . add ( new Jackson2CborEncoder ( ) ) ) \n + . decoders ( decoders - > decoders . add ( new Jackson2CborDecoder ( ) ) ) \n,Fix typo in RSocket reference \n See gh - 24245,435
"spring - orm \ src \ test \ java \ org \ springframework \ orm \ jpa \ support \ OpenEntityManagerInViewTests . java \n + import java . util . concurrent . CountDownLatch ; \n + import java . util . concurrent . TimeUnit ; \n + private final TestTaskExecutor taskExecutor = new TestTaskExecutor ( ) ; \n + \n - asyncManager . setTaskExecutor ( new SyncTaskExecutor ( ) ) ; \n + asyncManager . setTaskExecutor ( this . taskExecutor ) ; \n + this . taskExecutor . await ( ) ; \n + assertThat ( asyncManager . getConcurrentResult ( ) ) . as ( "" Concurrent result "" ) . isEqualTo ( "" anything "" ) ; \n + \n - asyncManager . setTaskExecutor ( new SyncTaskExecutor ( ) ) ; \n + asyncManager . setTaskExecutor ( this . taskExecutor ) ; \n + this . taskExecutor . await ( ) ; \n + assertThat ( asyncManager . getConcurrentResult ( ) ) . as ( "" Concurrent result "" ) . isEqualTo ( "" anything "" ) ; \n + \n - asyncManager . setTaskExecutor ( new SyncTaskExecutor ( ) ) ; \n + asyncManager . setTaskExecutor ( this . taskExecutor ) ; \n + this . taskExecutor . await ( ) ; \n + assertThat ( asyncManager . getConcurrentResult ( ) ) . as ( "" Concurrent result "" ) . isEqualTo ( "" anything "" ) ; \n + \n - asyncManager . setTaskExecutor ( new SyncTaskExecutor ( ) ) ; \n + asyncManager . setTaskExecutor ( this . taskExecutor ) ; \n + this . taskExecutor . await ( ) ; \n + assertThat ( asyncManager . getConcurrentResult ( ) ) . as ( "" Concurrent result "" ) . isEqualTo ( "" anything "" ) ; \n + \n - private static class SyncTaskExecutor extends SimpleAsyncTaskExecutor { \n + private static class TestTaskExecutor extends SimpleAsyncTaskExecutor { \n + \n + private final CountDownLatch latch = new CountDownLatch ( 1 ) ; \n - task . run ( ) ; \n + Runnable decoratedTask = ( ) - > { \n + try { \n + task . run ( ) ; \n + } \n + finally { \n + latch . countDown ( ) ; \n + } \n + } ; \n + super . execute ( decoratedTask , startTimeout ) ; \n + } \n + \n + void await ( ) throws InterruptedException { \n + this . latch . await ( 5 , TimeUnit . SECONDS ) ; \n + \n",Fix faulty tests \n The tests were doing Callable async request processing in the main \n thread which was already bound ( via HandlerInterceptor # preProcess ) . \n This leads to an ISE from TransactionSynchronizationManager # bindResource \n but it went unnoticed because there is no Servlet container and no \n async dispatch to continue processing . \n See gh - 24835,435
spring - core \ src \ main \ java \ org \ springframework \ util \ DigestUtils . java \n - * Copyright 2002 - 2016 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - * Calculate the MD5 digest of the given stream . \n + * Calculate the MD5 digest of the given stream . This method does \n + * < strong > not < / strong > close the input stream . \n + * This method does < strong > not < / strong > close the input stream . \n - * inputStream to the given { @ link StringBuilder } . \n + * inputStream to the given { @ link StringBuilder } . This method does \n + * < strong > not < / strong > close the input stream . \n,Update DigestUtils Javadoc with regards to InputStream \n Closes gh - 24534,435
spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ result \ method \ RequestMappingInfoHandlerMapping . java \n + import reactor . core . publisher . Mono ; \n + \n + import org . springframework . web . reactive . result . condition . ProducesRequestCondition ; \n + @ Override \n + public Mono < HandlerMethod > getHandlerInternal ( ServerWebExchange exchange ) { \n + exchange . getAttributes ( ) . remove ( HandlerMapping . PRODUCIBLE _ MEDIA _ TYPES _ ATTRIBUTE ) ; \n + return super . getHandlerInternal ( exchange ) \n + . doOnTerminate ( ( ) - > ProducesRequestCondition . clearMediaTypesAttribute ( exchange ) ) ; \n + } \n + \n spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ result \ method \ annotation \ RequestMappingHandlerMapping . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - import reactor . core . publisher . Mono ; \n - \n - import org . springframework . web . reactive . result . condition . ProducesRequestCondition ; \n - import org . springframework . web . server . ServerWebExchange ; \n - @ Override \n - public Mono < HandlerMethod > getHandlerInternal ( ServerWebExchange exchange ) { \n - return super . getHandlerInternal ( exchange ) \n - . doOnTerminate ( ( ) - > ProducesRequestCondition . clearMediaTypesAttribute ( exchange ) ) ; \n - } \n - \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ RequestMappingInfoHandlerMapping . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import org . springframework . web . servlet . mvc . condition . ProducesRequestCondition ; \n + @ Override \n + protected HandlerMethod getHandlerInternal ( HttpServletRequest request ) throws Exception { \n + request . removeAttribute ( PRODUCIBLE _ MEDIA _ TYPES _ ATTRIBUTE ) ; \n + try { \n + return super . getHandlerInternal ( request ) ; \n + } \n + finally { \n + ProducesRequestCondition . clearMediaTypesAttribute ( request ) ; \n + } \n + } \n + \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ RequestMappingHandlerMapping . java \n - import org . springframework . web . servlet . mvc . condition . ProducesRequestCondition ; \n - @ Override \n - protected HandlerMethod getHandlerInternal ( HttpServletRequest request ) throws Exception { \n - try { \n - return super . getHandlerInternal ( request ) ; \n - } \n - finally { \n - ProducesRequestCondition . clearMediaTypesAttribute ( request ) ; \n - } \n - } \n - \n,"Remove producible request attribute before mapping \n The attribute was previously removed only before exception resolution \n in the DispatcherServlet in order to allow error rendering to make an \n independent choice on content negotation . \n However , Boot rendering happens later in an ERROR dispatch which could \n also be a nested dispatch on some servers . So the attribute must also \n generally be removed prior to mapping . \n We also move the methods where this is done to the base \n RequestMappingInfoHandlerMapping class which also deals with the \n produces condition and where the producible attribute is added in the \n first place . \n Closes gh - 24466",435
"spring - test \ src \ main \ java \ org \ springframework \ test \ web \ servlet \ request \ MockHttpServletRequestBuilder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - this ( httpMethod . name ( ) , UriComponentsBuilder . fromUriString ( url ) . buildAndExpand ( vars ) . encode ( ) . toUri ( ) ) ; \n + this ( httpMethod . name ( ) , initUri ( url , vars ) ) ; \n + } \n + \n + private static URI initUri ( String url , Object [ ] vars ) { \n + Assert . notNull ( url , "" ' url ' must not be null "" ) ; \n + Assert . isTrue ( url . startsWith ( "" / "" ) | | url . startsWith ( "" http : / / "" ) | | url . startsWith ( "" https : / / "" ) , "" "" + \n + "" ' url ' should start with a path or be a complete HTTP URL : "" + url ) ; \n + return UriComponentsBuilder . fromUriString ( url ) . buildAndExpand ( vars ) . encode ( ) . toUri ( ) ; \n spring - test \ src \ test \ java \ org \ springframework \ test \ web \ servlet \ request \ MockHttpServletRequestBuilderTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import static org . assertj . core . api . Assertions . assertThatIllegalArgumentException ; \n - assertThat ( request . getRequestURL ( ) . toString ( ) ) . isEqualTo ( "" https : / / java . sun . com : 8080 / javase / 6 / docs / api / java / util / BitSet . html "" ) ; \n + assertThat ( request . getRequestURL ( ) . toString ( ) ) \n + . isEqualTo ( "" https : / / java . sun . com : 8080 / javase / 6 / docs / api / java / util / BitSet . html "" ) ; \n + @ Test / / gh - 24556 \n + public void requestUriWithoutScheme ( ) { \n + assertThatIllegalArgumentException ( ) . isThrownBy ( ( ) - > MockMvcRequestBuilders . get ( "" localhost : 8080 / path "" ) ) \n + . withMessage ( "" ' url ' should start with a path or be a complete HTTP URL : localhost : 8080 / path "" ) ; \n + } \n + \n",Improve checks on URI string in MockMvc request builder \n Closes gh - 24556,435
"src \ docs \ asciidoc \ web \ webflux . adoc \n - Servlet 4 containers are required to support HTTP / 2 , and Spring Framework 5 is compatible \n - with Servlet API 4 . From a programming model perspective , there is nothing specific that \n - applications need to do . However , there are considerations related to server configuration . \n - For more details , see the \n + HTTP / 2 is supported with Reactor Netty , Tomcat , Jetty , and Undertow . However , there are \n + considerations related to server configuration . For more details , see the \n - \n - Currently , Spring WebFlux does not support HTTP / 2 with Netty . There is also no support for \n - pushing resources programmatically to the client . \n",Update WebFlux section on HTTP / 2 \n Closes gh - 24558,435
"spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ xml \ XmlBeanDefinitionReader . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - try { \n - InputStream inputStream = encodedResource . getResource ( ) . getInputStream ( ) ; \n - try { \n - InputSource inputSource = new InputSource ( inputStream ) ; \n - if ( encodedResource . getEncoding ( ) ! = null ) { \n - inputSource . setEncoding ( encodedResource . getEncoding ( ) ) ; \n - } \n - return doLoadBeanDefinitions ( inputSource , encodedResource . getResource ( ) ) ; \n - } \n - finally { \n - inputStream . close ( ) ; \n + \n + try ( InputStream inputStream = encodedResource . getResource ( ) . getInputStream ( ) ) { \n + InputSource inputSource = new InputSource ( inputStream ) ; \n + if ( encodedResource . getEncoding ( ) ! = null ) { \n + inputSource . setEncoding ( encodedResource . getEncoding ( ) ) ; \n + return doLoadBeanDefinitions ( inputSource , encodedResource . getResource ( ) ) ; \n",Use try - with - resource in XmlBeanDefinitionReader \n Closes gh - 24492,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR5 "" \n - maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor Dysprosium snapshots \n",Upgrade to Reactor Dysprosium - SR5 \n Closes gh - 24355,435
spring - core \ src \ test \ java \ org \ springframework \ core \ SpringCoreBlockHoundIntegrationTests . java \n + import org . junit . jupiter . api . condition . DisabledForJreRange ; \n + import reactor . core . scheduler . ReactorBlockHoundIntegration ; \n + import static org . junit . jupiter . api . condition . JRE . JAVA _ 14 ; \n + @ DisabledForJreRange ( min = JAVA _ 14 ) \n - BlockHound . install ( ) ; \n + BlockHound . builder ( ) \n + . with ( new ReactorBlockHoundIntegration ( ) ) / / Reactor non - blocking thread predicate \n + . with ( new ReactiveAdapterRegistry . SpringCoreBlockHoundIntegration ( ) ) \n + . install ( ) ; \n,Refine BlockHound support \n - disable for Java 14 / 15 for now until BlockHound support \n - targeted installation of required integrations only,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ client \ RestClientException . java \n - * Copyright 2002 - 2012 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import org . springframework . http . client . ClientHttpResponse ; \n - * Base class for exceptions thrown by { @ link RestTemplate } whenever it encounters \n - * client - side HTTP errors . \n + * Base class for exceptions thrown by { @ link RestTemplate } in case a request \n + * fails because of a server error response , as determined via \n + * { @ link ResponseErrorHandler # hasError ( ClientHttpResponse ) } , failure to decode \n + * the response , or a low level I / O error . \n",Improve RestClientException Javadoc \n Closes gh - 24288,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ RequestMappingHandlerAdapter . java \n - Class < ? > handlerType = handlerMethod . getBeanType ( ) ; \n - SessionAttributesHandler sessionAttrHandler = this . sessionAttributesHandlerCache . get ( handlerType ) ; \n - if ( sessionAttrHandler = = null ) { \n - synchronized ( this . sessionAttributesHandlerCache ) { \n - sessionAttrHandler = this . sessionAttributesHandlerCache . computeIfAbsent ( handlerType , type - > new SessionAttributesHandler ( type , this . sessionAttributeStore ) ) ; \n - } \n - } \n - return sessionAttrHandler ; \n + return this . sessionAttributesHandlerCache . computeIfAbsent ( \n + handlerMethod . getBeanType ( ) , \n + type - > new SessionAttributesHandler ( type , this . sessionAttributeStore ) ) ; \n","Remove synchronized block \n As per the Javadoc of ConcurrentHashMap its computeIfAbsent \n implementation is atomic and hence already synchronized internally , \n so we can remove the surrounding synchronization block . \n See gh - 24470",435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ result \ method \ RequestMappingInfo . java \n + private final int hashCode ; \n + \n + \n + this . hashCode = calculateHashCode ( \n + this . patternsCondition , this . methodsCondition , this . paramsCondition , this . headersCondition , \n + this . consumesCondition , this . producesCondition , this . customConditionHolder ) ; \n - return ( this . patternsCondition . hashCode ( ) * 31 + / / primary differentiation \n - this . methodsCondition . hashCode ( ) + this . paramsCondition . hashCode ( ) + \n - this . headersCondition . hashCode ( ) + this . consumesCondition . hashCode ( ) + \n - this . producesCondition . hashCode ( ) + this . customConditionHolder . hashCode ( ) ) ; \n + return this . hashCode ; \n + } \n + \n + private static int calculateHashCode ( \n + PatternsRequestCondition patterns , RequestMethodsRequestCondition methods , \n + ParamsRequestCondition params , HeadersRequestCondition headers , \n + ConsumesRequestCondition consumes , ProducesRequestCondition produces , \n + RequestConditionHolder custom ) { \n + \n + return patterns . hashCode ( ) * 31 + methods . hashCode ( ) + params . hashCode ( ) + \n + headers . hashCode ( ) + consumes . hashCode ( ) + produces . hashCode ( ) + custom . hashCode ( ) ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ RequestMappingInfo . java \n - \n + private final int hashCode ; \n + \n + \n + this . hashCode = calculateHashCode ( \n + this . patternsCondition , this . methodsCondition , this . paramsCondition , this . headersCondition , \n + this . consumesCondition , this . producesCondition , this . customConditionHolder ) ; \n - \n - return ( this . patternsCondition . hashCode ( ) * 31 + / / primary differentiation \n - this . methodsCondition . hashCode ( ) + this . paramsCondition . hashCode ( ) + \n - this . headersCondition . hashCode ( ) + this . consumesCondition . hashCode ( ) + \n - this . producesCondition . hashCode ( ) + this . customConditionHolder . hashCode ( ) ) ; \n + return this . hashCode ; \n + } \n + \n + private static int calculateHashCode ( \n + PatternsRequestCondition patterns , RequestMethodsRequestCondition methods , \n + ParamsRequestCondition params , HeadersRequestCondition headers , \n + ConsumesRequestCondition consumes , ProducesRequestCondition produces , \n + RequestConditionHolder custom ) { \n + \n + return patterns . hashCode ( ) * 31 + methods . hashCode ( ) + params . hashCode ( ) + \n + headers . hashCode ( ) + consumes . hashCode ( ) + produces . hashCode ( ) + custom . hashCode ( ) ; \n",Pre - calculated RequestMappingInfo hashcode \n See gh - 25143,435
"spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ sockjs \ transport \ session \ AbstractSockJsSession . java \n - if ( isClosed ( ) ) { \n - throw new SockJsMessageDeliveryException ( this . id , getUndelivered ( messages , i ) , "" Session closed "" ) ; \n + if ( ! isClosed ( ) ) { \n + this . handler . handleMessage ( this , new TextMessage ( messages [ i ] ) ) ; \n + } \n + else { \n + List < String > undelivered = getUndelivered ( messages , i ) ; \n + if ( undelivered . isEmpty ( ) ) { \n + return ; \n + } \n + throw new SockJsMessageDeliveryException ( this . id , undelivered , "" Session closed "" ) ; \n - this . handler . handleMessage ( this , new TextMessage ( messages [ i ] ) ) ; \n spring - websocket \ src \ test \ java \ org \ springframework \ web \ socket \ sockjs \ transport \ session \ SockJsSessionTests . java \n - public void delegateMessagesWithErrorAndConnectionClosing ( ) throws Exception { \n + public void delegateMessagesWithError ( ) throws Exception { \n + @ Test / / gh - 23828 \n + public void delegateMessagesEmptyAfterConnectionClosed ( ) throws Exception { \n + \n + TestSockJsSession session = new TestSockJsSession ( "" 1 "" , this . sockJsConfig , \n + new ExceptionWebSocketHandlerDecorator ( this . webSocketHandler ) , Collections . emptyMap ( ) ) ; \n + \n + session . delegateConnectionEstablished ( ) ; \n + session . close ( CloseStatus . NORMAL ) ; \n + session . delegateMessages ( "" "" , "" "" , "" \ n "" ) ; \n + \n + / / No exception for empty messages \n + \n + verify ( this . webSocketHandler ) . afterConnectionEstablished ( session ) ; \n + verify ( this . webSocketHandler ) . afterConnectionClosed ( session , CloseStatus . NORMAL ) ; \n + verifyNoMoreInteractions ( this . webSocketHandler ) ; \n + } \n + \n",Do not raise exception for undelivered empty messages \n Closes gh - 23828,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR5 "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor \n",Switch to Reactor Dysprosium snapshots \n See gh - 24725,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ tcp \ reactor \ ReactorNettyTcpClient . java \n + @ SuppressWarnings ( "" deprecation "" ) \n",Suppress deprecation warning \n See gh - 24725,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ server \ reactive \ TomcatHttpHandlerAdapter . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import javax . servlet . ServletInputStream ; \n + ServletInputStream inputStream = ( ( ServletRequest ) getNativeRequest ( ) ) . getInputStream ( ) ; \n + if ( ! ( inputStream instanceof CoyoteInputStream ) ) { \n + / / It ' s possible InputStream can be wrapped , preventing use of CoyoteInputStream \n + return super . readFromInputStream ( ) ; \n + } \n - ServletRequest request = getNativeRequest ( ) ; \n - int read = ( ( CoyoteInputStream ) request . getInputStream ( ) ) . read ( byteBuffer ) ; \n + int read = ( ( CoyoteInputStream ) inputStream ) . read ( byteBuffer ) ; \n",Avoid ClassCastException in TomcatHttpHandlerAdapter \n Closes gh - 24707,435
spring - web \ src \ main \ java \ org \ springframework \ http \ ResponseCookie . java \n - if ( lenient ) { \n + if ( lenient & & ! StringUtils . isEmpty ( domain ) ) { \n,Avoid NPE in ResponseCookie on null domain \n See gh - 24663,435
"spring - webflux \ src \ test \ java \ org \ springframework \ web \ reactive \ socket \ AbstractWebSocketIntegrationTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - import java . net . URISyntaxException ; \n - protected URI getUrl ( String path ) throws URISyntaxException { \n - return new URI ( "" ws : / / localhost : "" + this . port + path ) ; \n + protected URI getUrl ( String path ) { \n + return URI . create ( "" ws : / / localhost : "" + this . port + path ) ; \n spring - webflux \ src \ test \ java \ org \ springframework \ web \ reactive \ socket \ WebSocketIntegrationTests . java \n + import reactor . util . retry . Retry ; \n + import org . springframework . web . testfixture . http . server . reactive . bootstrap . TomcatHttpServer ; \n + if ( server instanceof TomcatHttpServer ) { \n + Mono . fromRunnable ( this : : testEcho ) \n + . retryWhen ( Retry . max ( 3 ) . filter ( ex - > ex instanceof IllegalStateException ) ) \n + . block ( ) ; \n + } \n + else { \n + testEcho ( ) ; \n + } \n + } \n + \n + private void testEcho ( ) { \n - \n - \n - assertThat ( output . collectList ( ) . block ( TIMEOUT ) ) . isEqualTo ( input . collectList ( ) . block ( TIMEOUT ) ) ; \n + assertThat ( output . isTerminated ( ) ) . isTrue ( ) ; \n + assertThat ( output . collectList ( ) . block ( ) ) . isEqualTo ( input . collectList ( ) . block ( ) ) ; \n",Add retry for flaky test ( suspected Tomcat issue ),435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ annotation \ support \ MessagingRSocket . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - buffers . subscribe ( DataBufferUtils : : release ) ; \n + firstPayload . release ( ) ; \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ rsocket \ RSocketBufferLeakTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import io . rsocket . exceptions . ApplicationErrorException ; \n + @ Test / / gh - 24741 \n + void noSuchRouteOnChannelInteraction ( ) { \n + Flux < String > input = Flux . just ( "" foo "" , "" bar "" , "" baz "" ) ; \n + Flux < String > result = requester . route ( "" no - such - route "" ) . data ( input ) . retrieveFlux ( String . class ) ; \n + StepVerifier . create ( result ) . expectError ( ApplicationErrorException . class ) . verify ( Duration . ofSeconds ( 5 ) ) ; \n + } \n + \n",MessagingRSocket correctly handles unconsumed input \n Closes gh - 24741,435
spring - context \ src \ main \ java \ org \ springframework \ jmx \ export \ annotation \ ManagedAttribute . java \n - * Copyright 2002 - 2015 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import javax . management . Descriptor ; \n + \n + / * * \n + * Set the default value for the attribute in a JMX { @ link Descriptor } . \n + * / \n + / * * \n + * Set the description for the attribute a JMX { @ link Descriptor } . \n + * / \n + / * * \n + * Set the currency time limit field in a JMX { @ link Descriptor } . \n + * / \n + / * * \n + * Set the persistPolicy field in a JMX { @ link Descriptor } . \n + * / \n + / * * \n + * Set the persistPeriod field in a JMX { @ link Descriptor } . \n + * / \n,Add Javadoc to ManagedAttribute \n Closes : gh - 24742,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR6 "" \n - maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor \n",Upgrade to Reactor Dysprosium - SR6 \n Closes gh - 24725,435
"src \ docs \ asciidoc \ web \ webflux . adoc \n - values . In WebFlux , the ` ServerCodecConfigurer ` provides a \n - < < webflux - config - message - codecs , single place > > from where to set all codecs , through the \n - ` maxInMemorySize ` property for default codecs . On the client side , the limit can be changed \n - in < < web - reactive . adoc # webflux - client - builder - maxinmemorysize , WebClient . Builder > > . \n + values . On the server side , ` ServerCodecConfigurer ` provides a single place from where to \n + set all codecs , see < < webflux - config - message - codecs > > . On the client side , the limit for \n + all codecs can be changed in \n + < < web - reactive . adoc # webflux - client - builder - maxinmemorysize , WebClient . Builder > > . \n - / / . . . \n + configurer . defaultCodecs ( ) . maxInMemorySize ( 512 * 1024 ) ; \n - - - - \n",Add snippet for maxInMemorySize config \n See gh - 23961,435
"spring - core \ src \ main \ java \ org \ springframework \ core \ io \ AbstractResource . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - * This implementation reads the entire InputStream to calculate the \n - * content length . Subclasses will almost always be able to provide \n - * a more optimal version of this , e . g . checking a File length . \n + * This method reads the entire InputStream to determine the content length . \n + * < p > For a custom sub - class of { @ code InputStreamResource } , we strongly \n + * recommend overriding this method with a more optimal implementation , e . g . \n + * checking File length , or possibly simply returning - 1 if the stream can \n + * only be read once . \n",Update Javadoc of InputStreamResource # contentLength \n Closes gh - 20990,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ annotation \ ResponseStatusExceptionResolver . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - * < p > The default implementation delegates to { @ link # applyStatusAndReason } \n - * with the status code and reason from the exception . \n + * < p > The default implementation applies the headers from \n + * { @ link ResponseStatusException # getResponseHeaders ( ) } and delegates to \n + * { @ link # applyStatusAndReason } with the status code and reason from the \n + * exception . \n + ex . getResponseHeaders ( ) . forEach ( ( name , values ) - > { \n + if ( response . getHeader ( name ) = = null ) { \n + values . forEach ( value - > response . addHeader ( name , value ) ) ; \n + } \n + } ) ; \n + \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ annotation \ ResponseStatusExceptionResolverTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import java . util . Arrays ; \n + import org . springframework . http . HttpHeaders ; \n + import org . springframework . http . HttpMethod ; \n + import org . springframework . web . server . MethodNotAllowedException ; \n + @ Test \n + void responseStatusExceptionWithHeaders ( ) { \n + Exception ex = new MethodNotAllowedException ( \n + HttpMethod . GET , Arrays . asList ( HttpMethod . POST , HttpMethod . PUT ) ) ; \n + \n + ModelAndView mav = exceptionResolver . resolveException ( request , response , null , ex ) ; \n + \n + assertResolved ( mav , 405 , "" Request method ' GET ' not supported "" ) ; \n + assertThat ( response . getHeader ( HttpHeaders . ALLOW ) ) . isEqualTo ( "" POST , PUT "" ) ; \n + } \n",Headers support in ResponseStatusExceptionResolver \n Closes gh - 24944,435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ socket \ client \ ReactorNettyWebSocketClient . java \n + @ SuppressWarnings ( "" deprecation "" ) \n",Suppress deprecated Reactor Netty call \n See gh - 24892,435
spring - web \ src \ main \ java \ org \ springframework \ http \ HttpHeaders . java \n + * @ throws IllegalArgumentException if parsing fails \n + * @ throws IllegalArgumentException if parsing fails \n + * @ throws IllegalArgumentException if parsing fails \n,Document IAE in HttpHeaders methods that parse ETags \n See gh - 24950,435
spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ rsocket \ DefaultRSocketRequesterBuilderTests . java \n + @ Override \n + public ByteBufAllocator alloc ( ) { \n + return ByteBufAllocator . DEFAULT ; \n + } \n + \n,Adapt test to changes in RSocket Java \n See gh - 24934,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ server \ MethodNotAllowedException . java \n - import java . util . HashSet ; \n + import java . util . LinkedHashSet ; \n - this . httpMethods = Collections . unmodifiableSet ( new HashSet < > ( supportedMethods ) ) ; \n + this . httpMethods = Collections . unmodifiableSet ( new LinkedHashSet < > ( supportedMethods ) ) ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ annotation \ ResponseStatusExceptionResolver . java \n - ex . getResponseHeaders ( ) . forEach ( ( name , values ) - > { \n - if ( response . getHeader ( name ) = = null ) { \n - values . forEach ( value - > response . addHeader ( name , value ) ) ; \n - } \n - } ) ; \n + ex . getResponseHeaders ( ) . forEach ( ( name , values ) - > \n + values . forEach ( value - > response . addHeader ( name , value ) ) ) ; \n",Consistent ordering in MethodNotAllowedException \n This caused random failures in a newly added test . Also remove defensive \n check in ResponseStatusExceptionResolver . \n See gh - 24944,435
"spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ messaging \ StompSubProtocolHandler . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + if ( ! session . isOpen ( ) ) { \n + logger . trace ( "" Dropped inbound WebSocket message due to closed session "" ) ; \n + return ; \n + } \n",Ignore missing STOMP decoder if session closed \n Closes gh - 24842,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR7 "" \n - maven { url "" https : / / repo . spring . io / snapshot "" } \n",Upgrade to Reactor Dysprosium - SR7 \n Closes gh - 24892,435
"build . gradle \n - mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 - RC7 - SNAPSHOT "" \n + mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 - RC7 "" \n - maven { url "" https : / / oss . jfrog . org / artifactory / oss - snapshot - local "" } / / RSocket \n",Upgrade to RSocket 1 . 0 . 0 - RC7 \n Closes gh - 24934,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ ResponseBodyEmitterReturnValueHandler . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import java . nio . charset . StandardCharsets ; \n + import java . util . ArrayList ; \n + import org . springframework . http . converter . StringHttpMessageConverter ; \n + private final List < HttpMessageConverter < ? > > sseMessageConverters ; \n + \n + this . sseMessageConverters = initSseConverters ( messageConverters ) ; \n + this . sseMessageConverters = initSseConverters ( messageConverters ) ; \n + private static List < HttpMessageConverter < ? > > initSseConverters ( List < HttpMessageConverter < ? > > converters ) { \n + for ( HttpMessageConverter < ? > converter : converters ) { \n + if ( converter . canWrite ( String . class , MediaType . TEXT _ PLAIN ) ) { \n + return converters ; \n + } \n + } \n + List < HttpMessageConverter < ? > > result = new ArrayList < > ( converters . size ( ) + 1 ) ; \n + result . add ( new StringHttpMessageConverter ( StandardCharsets . UTF _ 8 ) ) ; \n + result . addAll ( converters ) ; \n + return result ; \n + } \n + \n - for ( HttpMessageConverter < ? > converter : ResponseBodyEmitterReturnValueHandler . this . messageConverters ) { \n + for ( HttpMessageConverter < ? > converter : ResponseBodyEmitterReturnValueHandler . this . sseMessageConverters ) { \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ ResponseBodyEmitterReturnValueHandlerTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - import java . util . Arrays ; \n - import org . springframework . http . converter . StringHttpMessageConverter ; \n - List < HttpMessageConverter < ? > > converters = Arrays . asList ( \n - new StringHttpMessageConverter ( ) , new MappingJackson2HttpMessageConverter ( ) ) ; \n + List < HttpMessageConverter < ? > > converters = \n + Collections . singletonList ( new MappingJackson2HttpMessageConverter ( ) ) ; \n",Insert StringMessageConverter for SSE \n Closes gh - 24465,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ json \ Jackson2ObjectMapperBuilder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import java . util . function . Function ; \n + import com . fasterxml . jackson . databind . introspect . AnnotationIntrospectorPair ; \n + / * * \n + * Alternative to { @ link # annotationIntrospector ( AnnotationIntrospector ) } \n + * that allows combining with rather than replacing the currently set \n + * introspector , e . g . via \n + * { @ link AnnotationIntrospectorPair # pair ( AnnotationIntrospector , AnnotationIntrospector ) } . \n + * @ param pairingFunction a function to apply to the currently set \n + * introspector ( possibly { @ code null } ) ; the result of the function becomes \n + * the new introspector . \n + * @ since 5 . 2 . 4 \n + * / \n + public Jackson2ObjectMapperBuilder annotationIntrospector ( \n + Function < AnnotationIntrospector , AnnotationIntrospector > pairingFunction ) { \n + \n + this . annotationIntrospector = pairingFunction . apply ( this . annotationIntrospector ) ; \n + return this ; \n + } \n + \n spring - web \ src \ test \ java \ org \ springframework \ http \ converter \ json \ Jackson2ObjectMapperBuilderTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import com . fasterxml . jackson . databind . AnnotationIntrospector ; \n + import com . fasterxml . jackson . databind . introspect . AnnotationIntrospectorPair ; \n - NopAnnotationIntrospector annotationIntrospector = NopAnnotationIntrospector . instance ; \n + NopAnnotationIntrospector introspector = NopAnnotationIntrospector . instance ; \n - . annotationIntrospector ( annotationIntrospector ) \n + . annotationIntrospector ( introspector ) \n + . annotationIntrospector ( current - > AnnotationIntrospector . pair ( current , introspector ) ) \n - assertThat ( mapper . getSerializationConfig ( ) . getAnnotationIntrospector ( ) ) . isSameAs ( annotationIntrospector ) ; \n - assertThat ( mapper . getDeserializationConfig ( ) . getAnnotationIntrospector ( ) ) . isSameAs ( annotationIntrospector ) ; \n + AnnotationIntrospectorPair pair1 = \n + ( AnnotationIntrospectorPair ) mapper . getSerializationConfig ( ) . getAnnotationIntrospector ( ) ; \n + AnnotationIntrospectorPair pair2 = \n + ( AnnotationIntrospectorPair ) mapper . getDeserializationConfig ( ) . getAnnotationIntrospector ( ) ; \n + \n + assertThat ( pair1 . allIntrospectors ( ) ) . containsExactly ( introspector , introspector ) ; \n + assertThat ( pair2 . allIntrospectors ( ) ) . containsExactly ( introspector , introspector ) ; \n",Option to pair AnnotationIntrospector instances \n Closes gh - 22830,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ json \ Jackson2ObjectMapperBuilder . java \n - private JsonInclude . Include serializationInclusion ; \n + private JsonInclude . Value serializationInclusion ; \n - public Jackson2ObjectMapperBuilder serializationInclusion ( JsonInclude . Include serializationInclusion ) { \n + public Jackson2ObjectMapperBuilder serializationInclusion ( JsonInclude . Include inclusion ) { \n + return serializationInclusion ( JsonInclude . Value . construct ( inclusion , inclusion ) ) ; \n + } \n + \n + / * * \n + * Set a custom inclusion strategy for serialization . \n + * @ since 5 . 3 \n + * @ see com . fasterxml . jackson . annotation . JsonInclude . Value \n + * / \n + public Jackson2ObjectMapperBuilder serializationInclusion ( JsonInclude . Value serializationInclusion ) { \n - objectMapper . setSerializationInclusion ( this . serializationInclusion ) ; \n + objectMapper . setDefaultPropertyInclusion ( this . serializationInclusion ) ; \n",Allow use of JsonInclude . Value \n Closes gh - 24824,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ json \ Jackson2ObjectMapperBuilder . java \n + import java . util . function . Consumer ; \n + @ Nullable \n + private Consumer < ObjectMapper > configurer ; \n + \n + / * * \n + * An option to apply additional customizations directly to the \n + * { @ code ObjectMapper } instances at the end , after all other config \n + * properties of the builder have been applied . \n + * @ param configurer a configurer to apply ; if invoked multiple times , all \n + * configurers are applied in the same order . \n + * @ since 5 . 3 \n + * / \n + public Jackson2ObjectMapperBuilder postConfigurer ( Consumer < ObjectMapper > configurer ) { \n + this . configurer = ( this . configurer ! = null ? this . configurer . andThen ( configurer ) : configurer ) ; \n + return this ; \n + } \n + \n + \n + if ( this . configurer ! = null ) { \n + this . configurer . accept ( objectMapper ) ; \n + } \n spring - web \ src \ test \ java \ org \ springframework \ http \ converter \ json \ Jackson2ObjectMapperBuilderTests . java \n + import com . fasterxml . jackson . databind . introspect . JacksonAnnotationIntrospector ; \n + @ Test / / gh - 23017 \n + public void postConfigurer ( ) { \n + \n + JacksonAnnotationIntrospector introspector1 = new JacksonAnnotationIntrospector ( ) ; \n + JacksonAnnotationIntrospector introspector2 = new JacksonAnnotationIntrospector ( ) ; \n + \n + ObjectMapper mapper = Jackson2ObjectMapperBuilder . json ( ) \n + . postConfigurer ( m - > m . setAnnotationIntrospectors ( introspector1 , introspector2 ) ) \n + . build ( ) ; \n + \n + assertThat ( mapper . getSerializationConfig ( ) . getAnnotationIntrospector ( ) ) . isSameAs ( introspector1 ) ; \n + assertThat ( mapper . getDeserializationConfig ( ) . getAnnotationIntrospector ( ) ) . isSameAs ( introspector2 ) ; \n + } \n + \n",Option for advanced ObjectMapper customization \n Closes gh - 23017,435
"spring - context \ src \ main \ java \ org \ springframework \ validation \ DataBinder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + private boolean directFieldAccess = false ; \n + \n - this . bindingResult = createBeanPropertyBindingResult ( ) ; \n + this . directFieldAccess = false ; \n - this . bindingResult = createDirectFieldBindingResult ( ) ; \n + this . directFieldAccess = true ; \n - initBeanPropertyAccess ( ) ; \n + this . bindingResult = ( this . directFieldAccess ? \n + createDirectFieldBindingResult ( ) : createBeanPropertyBindingResult ( ) ) ; \n spring - context \ src \ test \ java \ org \ springframework \ validation \ DataBinderTests . java \n + } \n + @ Test / / gh - 24347 \n + public void overrideBindingResultType ( ) { \n + TestBean testBean = new TestBean ( ) ; \n + DataBinder binder = new DataBinder ( testBean , "" testBean "" ) ; \n + binder . initDirectFieldAccess ( ) ; \n + binder . initBeanPropertyAccess ( ) ; \n + assertThat ( binder . getBindingResult ( ) ) . isInstanceOf ( BeanPropertyBindingResult . class ) ; \n + \n",Defer decision on BindingResult type until access \n Closes gh - 24347,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ client \ HttpComponentsClientHttpRequestFactory . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import java . util . function . BiFunction ; \n + @ Nullable \n + private BiFunction < HttpMethod , URI , HttpContext > httpContextFactory ; \n + \n + / * * \n + * Configure a factory to pre - create the { @ link HttpContext } for each request . \n + * < p > This may be useful for example in mutual TLS authentication where a \n + * different { @ code RestTemplate } for each client certificate such that \n + * all calls made through a given { @ code RestTemplate } instance as associated \n + * for the same client identity . { @ link HttpClientContext # setUserToken ( Object ) } \n + * can be used to specify a fixed user token for all requests . \n + * @ param httpContextFactory the context factory to use \n + * @ since 5 . 2 . 7 \n + * / \n + public void setHttpContextFactory ( BiFunction < HttpMethod , URI , HttpContext > httpContextFactory ) { \n + this . httpContextFactory = httpContextFactory ; \n + } \n - return null ; \n + return ( this . httpContextFactory ! = null ? this . httpContextFactory . apply ( httpMethod , uri ) : null ) ; \n",Simplify creation of HttpContext for Apache HttpClient \n Closes gh - 25066,435
"spring - test \ src \ main \ java \ org \ springframework \ mock \ http \ server \ reactive \ MockServerHttpRequest . java \n + Assert . notNull ( method , "" HttpMethod is required . If testing a custom HTTP method , "" + \n + "" please use the variant that accepts a String based HTTP method . "" ) ; \n spring - web \ src \ testFixtures \ java \ org \ springframework \ web \ testfixture \ http \ server \ reactive \ MockServerHttpRequest . java \n + Assert . notNull ( method , "" HttpMethod is required . If testing a custom HTTP method , "" + \n + "" please use the variant that accepts a String based HTTP method . "" ) ; \n",Add error message to MockServerHttpRequest \n Closes gh - 25109,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ server \ reactive \ WriteResultPublisher . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + if ( State . SUBSCRIBED . equals ( publisher . state . get ( ) ) ) { \n + publisher . state . get ( ) . publishError ( publisher , ex ) ; \n + } \n + if ( State . SUBSCRIBED . equals ( publisher . state . get ( ) ) ) { \n + publisher . state . get ( ) . publishError ( publisher , ex ) ; \n + } \n",Fix race condition in WriteResultPublisher \n between subscription and error from the Publish \n Closes gh - 25096,435
spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ result \ method \ RequestMappingInfo . java \n + private static final RequestConditionHolder EMPTY _ CUSTOM = new RequestConditionHolder ( null ) ; \n + \n - this . customConditionHolder = new RequestConditionHolder ( custom ) ; \n + this . customConditionHolder = ( custom ! = null ? new RequestConditionHolder ( custom ) : EMPTY _ CUSTOM ) ; \n spring - webflux \ src \ test \ java \ org \ springframework \ web \ reactive \ result \ condition \ RequestMappingInfoTests . java \n + assertThat ( info . getCustomCondition ( ) ) . isSameAs ( anotherInfo . getCustomCondition ( ) ) ; \n + assertThat ( info . getCustomCondition ( ) ) . isSameAs ( result . getCustomCondition ( ) ) ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ RequestMappingInfo . java \n + private static final RequestConditionHolder EMPTY _ CUSTOM = new RequestConditionHolder ( null ) ; \n + \n + \n - this . customConditionHolder = new RequestConditionHolder ( custom ) ; \n + this . customConditionHolder = ( custom ! = null ? new RequestConditionHolder ( custom ) : EMPTY _ CUSTOM ) ; \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ method \ RequestMappingInfoTests . java \n + assertThat ( info . getCustomCondition ( ) ) . isSameAs ( anotherInfo . getCustomCondition ( ) ) ; \n + assertThat ( info . getCustomCondition ( ) ) . isSameAs ( result . getCustomCondition ( ) ) ; \n,Also use constant for custom mapping condition \n See gh - 25143,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ accept \ ContentNegotiationManagerFactoryBean . java \n - * in 5 . 2 . x it is necessary to set it to { @ code false } . In 5 . 3 { @ code false } \n - * becomes the default , and use of this property is longer be necessary . \n + * in 5 . 2 . x it is necessary to set it to { @ code false } . In 5 . 3 the default \n + * changes to { @ code false } and use of this property becomes unnecessary . \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ config \ annotation \ PathMatchConfigurer . java \n - * necessary to set it to { @ code false } . In 5 . 3 { @ code false } becomes the \n - * default , and use of this property is longer be necessary . \n + * necessary to set it to { @ code false } . In 5 . 3 the default changes to \n + * { @ code false } and use of this property becomes unnecessary . \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ RequestMappingHandlerMapping . java \n - * in 5 . 2 . x it is necessary to set it to { @ code false } . In 5 . 3 { @ code false } \n - * becomes the default , and use of this property is longer be necessary . \n + * in 5 . 2 . x it is necessary to set it to { @ code false } . In 5 . 3 the default \n + * changes to { @ code false } and use of this property becomes unnecessary . \n","Fix typo \n See gh - 23915 , gh - 25018",435
"spring - web \ src \ main \ java \ org \ springframework \ web \ method \ annotation \ ModelFactory . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + import org . apache . commons . logging . Log ; \n + import org . apache . commons . logging . LogFactory ; \n + \n + private static final Log logger = LogFactory . getLog ( ModelFactory . class ) ; \n + \n + \n - if ( ! modelMethod . isVoid ( ) ) { \n - String returnValueName = getNameForReturnValue ( returnValue , modelMethod . getReturnType ( ) ) ; \n - if ( ! ann . binding ( ) ) { \n - container . setBindingDisabled ( returnValueName ) ; \n - } \n - if ( ! container . containsAttribute ( returnValueName ) ) { \n - container . addAttribute ( returnValueName , returnValue ) ; \n + if ( modelMethod . isVoid ( ) ) { \n + if ( StringUtils . hasText ( ann . value ( ) ) ) { \n + if ( logger . isDebugEnabled ( ) ) { \n + logger . debug ( "" Name in @ ModelAttribute is ignored because method returns void : "" + \n + modelMethod . getShortLogMessage ( ) ) ; \n + } \n + continue ; \n + } \n + \n + String returnValueName = getNameForReturnValue ( returnValue , modelMethod . getReturnType ( ) ) ; \n + if ( ! ann . binding ( ) ) { \n + container . setBindingDisabled ( returnValueName ) ; \n + } \n + if ( ! container . containsAttribute ( returnValueName ) ) { \n + container . addAttribute ( returnValueName , returnValue ) ; \n",Log message for unused @ ModelAttribute name \n Closes gh - 23877,435
"spring - core \ src \ main \ java \ org \ springframework \ core \ io \ buffer \ DataBufferUtils . java \n - import io . netty . util . IllegalReferenceCountException ; \n - catch ( IllegalReferenceCountException ex ) { \n + catch ( IllegalStateException ex ) { \n + / / Avoid dependency on Netty : IllegalReferenceCountException \n - logger . debug ( "" RefCount already at 0 "" , ex ) ; \n + logger . debug ( "" Failed to release PooledDataBuffer "" , ex ) ; \n",Avoid dependency on netty - common in DataBufferUtils \n See : gh - 22594,435
"spring - core \ src \ main \ java \ org \ springframework \ core \ io \ buffer \ DataBufferUtils . java \n - import io . netty . util . IllegalReferenceCountException ; \n - catch ( IllegalReferenceCountException ex ) { \n + catch ( IllegalStateException ex ) { \n + / / Avoid dependency on Netty : IllegalReferenceCountException \n - logger . debug ( "" RefCount already at 0 "" , ex ) ; \n + logger . debug ( "" Failed to release PooledDataBuffer "" , ex ) ; \n",Avoid dependency on netty - common in DataBufferUtils \n See : gh - 22594,435
"spring - web \ src \ main \ java \ org \ springframework \ http \ client \ reactive \ ReactorClientHttpConnector . java \n + @ SuppressWarnings ( "" deprecation "" ) \n - return HttpClient . create ( provider ) . runOn ( resources ) ; \n + return HttpClient . create ( provider ) . tcpConfiguration ( tcpClient - > tcpClient . runOn ( resources ) ) ; \n",Restore use of tcpConfiguration method \n The method wasn ' t available at first but has been added since to allow \n being compatible with both Reactor Netty 0 . 9 and 1 . 0 . \n See gh - 25085,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ tcp \ reactor \ ReactorNettyTcpClient . java \n - import reactor . core . publisher . FluxIdentityProcessor ; \n - import reactor . core . publisher . Processors ; \n - FluxIdentityProcessor < Void > completion = Processors . more ( ) . multicastNoBackpressure ( ) ; \n + MonoProcessor < Void > completion = MonoProcessor . create ( ) ; \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ tcp \ reactor \ ReactorNettyTcpConnection . java \n - import reactor . core . publisher . FluxIdentityProcessor ; \n + import reactor . core . publisher . MonoProcessor ; \n - private final FluxIdentityProcessor < Void > closeProcessor ; \n + private final MonoProcessor < Void > closeProcessor ; \n - ReactorNettyCodec < P > codec , FluxIdentityProcessor < Void > closeProcessor ) { \n + ReactorNettyCodec < P > codec , MonoProcessor < Void > closeProcessor ) { \n",Use MonoProcessor instead of FluxIdentityProcessor \n We just need to signal completion when close ( ) is called . MonoProcessor \n should suffice and we can avoid a hard dependency on Reactor 3 . 4 . \n See gh - 25085,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ function \ support \ RouterFunctionMapping . java \n + import org . springframework . web . util . pattern . PathPatternParser ; \n + / / gh - 23236 will ensure the configured parser is used to parse patterns \n + / / For now this helps to signal to the DispatcherServlet the need to initialize the RequestPath \n + setPatternParser ( new PathPatternParser ( ) ) ; \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ ServletAnnotationControllerHandlerMethodTests . java \n + import javax . servlet . ServletException ; \n + import org . junit . jupiter . api . Test ; \n + \n + import org . springframework . web . context . support . GenericWebApplicationContext ; \n + import org . springframework . web . servlet . DispatcherServlet ; \n + import org . springframework . web . servlet . function . RouterFunction ; \n + import org . springframework . web . servlet . function . RouterFunctions ; \n + import org . springframework . web . servlet . function . ServerResponse ; \n - @ SuppressWarnings ( "" unused "" ) \n - \n + @ Test \n + void routerFunction ( ) throws ServletException , IOException { \n + GenericWebApplicationContext wac = new GenericWebApplicationContext ( ) ; \n + wac . registerBean ( RouterFunction . class , ( ) - > \n + RouterFunctions . route ( ) \n + . GET ( "" / foo "" , request - > ServerResponse . ok ( ) . body ( "" foo - body "" ) ) \n + . build ( ) ) ; \n + wac . refresh ( ) ; \n + \n + DispatcherServlet servlet = new DispatcherServlet ( ) ; \n + servlet . setApplicationContext ( wac ) ; \n + servlet . init ( new MockServletConfig ( ) ) ; \n + \n + MockHttpServletRequest request = new MockHttpServletRequest ( "" GET "" , "" / foo "" ) ; \n + MockHttpServletResponse response = new MockHttpServletResponse ( ) ; \n + servlet . service ( request , response ) ; \n + \n + assertThat ( response . getStatus ( ) ) . isEqualTo ( 200 ) ; \n + assertThat ( response . getContentAsString ( ) ) . isEqualTo ( "" foo - body "" ) ; \n + } \n",Set PathPatternParser in RouterFunctionMapping \n See gh - 24945,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : 2020 . 0 . 0 - SNAPSHOT "" \n + mavenBom "" io . projectreactor : reactor - bom : 2020 . 0 . 0 - M1 "" \n - maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor \n + maven { url "" https : / / repo . spring . io / milestone "" } / / Reactor \n",Upgrade to Reactor 2020 . 0 . 0 - M1 \n See gh - 25085,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ util \ pattern \ PathPattern . java \n - return ( this . score > 0 | | this . patternString . indexOf ( ' ? ' ) ! = - 1 ) ; \n + return ( this . score > 0 | | this . catchAll | | this . patternString . indexOf ( ' ? ' ) ! = - 1 ) ; \n spring - web \ src \ test \ java \ org \ springframework \ web \ util \ pattern \ PathPatternTests . java \n - assertThat ( parser . parse ( "" / foo / * * "" ) . hasPatternSyntax ( ) ) . isFalse ( ) ; \n - assertThat ( parser . parse ( "" / foo / { * elem } "" ) . hasPatternSyntax ( ) ) . isFalse ( ) ; \n + assertThat ( parser . parse ( "" / foo / * * "" ) . hasPatternSyntax ( ) ) . isTrue ( ) ; \n + assertThat ( parser . parse ( "" / foo / { * elem } "" ) . hasPatternSyntax ( ) ) . isTrue ( ) ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ condition \ PathPatternsRequestCondition . java \n - if ( pattern . hasPatternSyntax ( ) ) { \n + if ( ! pattern . hasPatternSyntax ( ) ) { \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ condition \ PatternsRequestCondition . java \n - if ( this . pathMatcher . isPattern ( pattern ) ) { \n + if ( ! this . pathMatcher . isPattern ( pattern ) ) { \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ condition \ PathPatternsRequestConditionTests . java \n + @ Test \n + void getDirectUrls ( ) { \n + PathPatternsRequestCondition condition = createCondition ( "" / something "" , "" / else / * * "" ) ; \n + assertThat ( condition . getDirectPaths ( ) ) . containsExactly ( "" / something "" ) ; \n + } \n + \n spring - webmvc \ src \ test \ java \ org \ springframework \ web \ servlet \ mvc \ condition \ PatternsRequestConditionTests . java \n + @ Test \n + void getDirectUrls ( ) { \n + PatternsRequestCondition condition = new PatternsRequestCondition ( "" / something "" , "" / else / * * "" ) ; \n + assertThat ( condition . getDirectPaths ( ) ) . containsExactly ( "" / something "" ) ; \n + } \n + \n","Direct matches by URL path work again \n This commit fixes a recent regression as a result of 5225a5741197a7e2123437709c2468e4537b0469 \n with the determination of non - pattern vs pattern URLs . That in turn affects the ability to perform \n direct matches by URL path . \n There is also a fix in PathPattern to recognize "" catch - all "" patterns as pattern syntax . \n See gh - 24945",435
"spring - core \ src \ main \ java \ org \ springframework \ core \ io \ buffer \ DataBufferUtils . java \n - logger . debug ( "" Failed to release PooledDataBuffer "" , ex ) ; \n + logger . debug ( "" Failed to release PooledDataBuffer : "" + dataBuffer , ex ) ; \n spring - web \ src \ main \ java \ org \ springframework \ http \ codec \ multipart \ PartHttpMessageWriter . java \n + import org . springframework . core . io . buffer . DataBufferUtils ; \n - . doOnDiscard ( PooledDataBuffer . class , PooledDataBuffer : : release ) ; \n + . doOnDiscard ( PooledDataBuffer . class , DataBufferUtils : : release ) ; \n",Replace explicit use of PooledDataBuffer . release ( ),435
"spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ AbstractHttpMessageConverter . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - if ( contentType = = null | | contentType . isWildcardType ( ) | | contentType . isWildcardSubtype ( ) ) { \n + if ( contentType = = null | | ! contentType . isConcrete ( ) ) { \n spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ StringHttpMessageConverter . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - protected void addDefaultHeaders ( HttpHeaders headers , String s , @ Nullable MediaType mediaType ) throws IOException { \n + protected void addDefaultHeaders ( HttpHeaders headers , String s , @ Nullable MediaType type ) throws IOException { \n - if ( mediaType ! = null & & mediaType . isCompatibleWith ( MediaType . APPLICATION _ JSON ) ) { \n + if ( type ! = null & & type . isConcrete ( ) & & type . isCompatibleWith ( MediaType . APPLICATION _ JSON ) ) { \n - headers . setContentType ( mediaType ) ; \n + headers . setContentType ( type ) ; \n - super . addDefaultHeaders ( headers , s , mediaType ) ; \n + super . addDefaultHeaders ( headers , s , type ) ; \n spring - web \ src \ test \ java \ org \ springframework \ http \ converter \ StringHttpMessageConverterTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + @ Test / / gh - 24283 \n + public void writeWithWildCardMediaType ( ) throws IOException { \n + String body = "" Hello World "" ; \n + this . converter . write ( body , MediaType . ALL , this . outputMessage ) ; \n + \n + HttpHeaders headers = this . outputMessage . getHeaders ( ) ; \n + assertThat ( this . outputMessage . getBodyAsString ( StandardCharsets . US _ ASCII ) ) . isEqualTo ( body ) ; \n + assertThat ( headers . getContentType ( ) ) . isEqualTo ( new MediaType ( "" text "" , "" plain "" , StandardCharsets . ISO _ 8859 _ 1 ) ) ; \n + assertThat ( headers . getContentLength ( ) ) . isEqualTo ( body . getBytes ( ) . length ) ; \n + assertThat ( headers . getAcceptCharset ( ) . isEmpty ( ) ) . isTrue ( ) ; \n + } \n + \n",Concrete MediaType check in StringHttpMessageConverter \n Closes gh - 23287,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : Dysprosium - SR8 "" \n + mavenBom "" io . projectreactor : reactor - bom : Dysprosium - BUILD - SNAPSHOT "" \n + maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor \n spring - web \ src \ main \ java \ org \ springframework \ http \ client \ reactive \ ReactorClientHttpResponse . java \n - import org . springframework . lang . Nullable ; \n - private final NettyDataBufferFactory bufferFactory ; \n - \n - @ Nullable \n - private final String logPrefix ; \n + private final NettyDataBufferFactory bufferFactory ; \n - / / 0 - not subscribed , 1 - subscribed , 2 - cancelled , 3 - cancelled via connector ( before subscribe ) \n + / / 0 - not subscribed , 1 - subscribed , 2 - cancelled via connector ( before subscribe ) \n + private final String logPrefix ; \n + \n - / / https : / / github . com / reactor / reactor - netty / issues / 503 \n - / / FluxReceive rejects multiple subscribers , but not after a cancel ( ) . \n - / / Subsequent subscribers after cancel ( ) will not be rejected , but will hang instead . \n - / / So we need to reject once in cancelled state . \n - throw new IllegalStateException ( \n - "" The client response body can only be consumed once . "" ) ; \n - } \n - else if ( this . state . get ( ) = = 3 ) { \n - . doOnCancel ( ( ) - > this . state . compareAndSet ( 1 , 2 ) ) \n - if ( mayHaveBody ( method ) & & this . state . compareAndSet ( 0 , 3 ) ) { \n + if ( mayHaveBody ( method ) & & this . state . compareAndSet ( 0 , 2 ) ) { \n",Switch to Reactor Dysprosium snapshots \n See gh - 25376,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ simp \ broker \ DefaultSubscriptionRegistry . java \n - this . cacheSize . incrementAndGet ( ) ; \n + / / Update queue first , so that cacheSize < = queue . size ( \n + this . cacheSize . incrementAndGet ( ) ; \n - this . destinationCache . remove ( this . cacheEvictionPolicy . poll ( ) ) ; \n + / / Remove ( vs poll ) : we expect an element \n + String head = this . cacheEvictionPolicy . remove ( ) ; \n + this . destinationCache . remove ( head ) ; \n",Update eviction queue before size \n See gh - 25298,435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ client \ DefaultClientResponse . java \n + import org . springframework . core . io . buffer . DataBuffer ; \n + private final BodyExtractor . Context bodyExtractorContext ; \n + \n + this . bodyExtractorContext = new BodyExtractor . Context ( ) { \n + @ Override \n + public List < HttpMessageReader < ? > > messageReaders ( ) { \n + return strategies . messageReaders ( ) ; \n + } \n + \n + @ Override \n + public Optional < ServerHttpResponse > serverResponse ( ) { \n + return Optional . empty ( ) ; \n + } \n + \n + @ Override \n + public Map < String , Object > hints ( ) { \n + return Hints . from ( Hints . LOG _ PREFIX _ HINT , logPrefix ) ; \n + } \n + } ; \n - T result = extractor . extract ( this . response , new BodyExtractor . Context ( ) { \n - @ Override \n - public List < HttpMessageReader < ? > > messageReaders ( ) { \n - return strategies . messageReaders ( ) ; \n - } \n - \n - @ Override \n - public Optional < ServerHttpResponse > serverResponse ( ) { \n - return Optional . empty ( ) ; \n - } \n - \n - @ Override \n - public Map < String , Object > hints ( ) { \n - return Hints . from ( Hints . LOG _ PREFIX _ HINT , logPrefix ) ; \n - } \n - } ) ; \n + T result = extractor . extract ( this . response , this . bodyExtractorContext ) ; \n + @ SuppressWarnings ( "" unchecked "" ) \n - return body ( BodyExtractors . toFlux ( elementClass ) ) ; \n + return elementClass . equals ( DataBuffer . class ) ? \n + ( Flux < T > ) body ( BodyExtractors . toDataBuffers ( ) ) : body ( BodyExtractors . toFlux ( elementClass ) ) ; \n spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ function \ server \ DefaultServerRequest . java \n + import org . springframework . core . io . buffer . DataBuffer ; \n + @ SuppressWarnings ( "" unchecked "" ) \n - Flux < T > flux = body ( BodyExtractors . toFlux ( elementClass ) ) ; \n + Flux < T > flux = ( elementClass . equals ( DataBuffer . class ) ? \n + ( Flux < T > ) request ( ) . getBody ( ) : body ( BodyExtractors . toFlux ( elementClass ) ) ) ; \n",Shortcut handling of bodyToFlux ( DataBuffer . class ) \n Given that the body is a Flux < DataBuffer > there probably could be a \n Flux < DataBuffer > body ( ) ; \n At least bodyToFlux ( DataBuffer . class ) which is used when mutating and \n is a common case should not incur overhead . \n See gh - 24680,435
"spring - tx \ src \ main \ java \ org \ springframework \ transaction \ reactive \ TransactionalOperator . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - * < p > Transactional Publishers should avoid Subscription cancellation . \n - * Cancelling initiates asynchronous transaction cleanup that does not allow for \n - * synchronization on completion . \n + * < p > < strong > Note : < / strong > Transactional Publishers should avoid Subscription \n + * cancellation . See the \n + * < a href = "" https : / / docs . spring . io / spring / docs / current / spring - framework - reference / data - access . html # tx - prog - operator - cancel "" > Cancel Signals < / a > \n + * section of the Spring Framework reference for more details . \n src \ docs \ asciidoc \ data - access . adoc \n - - - - \n + Note that there are special considerations for the returned ` Publisher ` with regards to \n + Reactive Streams cancellation signals . See the < < tx - prog - operator - cancel > > section under \n + "" Using the TransactionOperator "" for more details . \n + \n + \n - - - - \n + [ [ tx - prog - operator - cancel ] ] \n + = = = = = Cancel Signals \n + \n + In Reactive Streams , a ` Subscriber ` can cancel its ` Subscription ` and terminate its \n + ` Publisher ` . Operators in Project Reactor , as well as in other libraries , such as ` next ( ) ` , \n + ` take ( long ) ` , ` timeout ( Duration ) ` , and others can issue cancellations . There is no way to \n + know the reason for the cancellation , whether it is due to an error or a simply lack of \n + interest to consume further , and in version 5 . 2 the ` TransactionalOperator ` defaults to \n + committing the transaction on cancel . In version 5 . 3 this behavior will change and \n + transactions will be roll back on cancel to create a reliable and deterministic outcome . \n + As a result it is important to consider the operators used downstream from a transaction \n + ` Publisher ` . In particular in the case of a ` Flux ` or other multi - value ` Publisher ` , \n + the full output must be consumed to allow the transaction to complete . \n + \n + \n",Document behavior on reactive tx cancellation \n Closes gh - 25091,435
"build . gradle \n - mavenBom "" io . projectreactor : reactor - bom : 2020 . 0 . 0 - M1 "" \n + mavenBom "" io . projectreactor : reactor - bom : 2020 . 0 . 0 - SNAPSHOT "" \n - maven { url "" https : / / repo . spring . io / milestone "" } / / Reactor \n + maven { url "" https : / / repo . spring . io / snapshot "" } / / Reactor \n spring - web \ src \ main \ java \ org \ springframework \ http \ client \ reactive \ ReactorClientHttpResponse . java \n - / / 0 - not subscribed , 1 - subscribed , 2 - cancelled , 3 - cancelled via connector ( before subscribe ) \n + / / 0 - not subscribed , 1 - subscribed , 2 - cancelled via connector ( before subscribe ) \n - / / https : / / github . com / reactor / reactor - netty / issues / 503 \n - / / FluxReceive rejects multiple subscribers , but not after a cancel ( ) . \n - / / Subsequent subscribers after cancel ( ) will not be rejected , but will hang instead . \n - / / So we need to reject once in cancelled state . \n - throw new IllegalStateException ( \n - "" The client response body can only be consumed once . "" ) ; \n - } \n - else if ( this . state . get ( ) = = 3 ) { \n - . doOnCancel ( ( ) - > this . state . compareAndSet ( 1 , 2 ) ) \n - if ( mayHaveBody ( method ) & & this . state . compareAndSet ( 0 , 3 ) ) { \n + if ( mayHaveBody ( method ) & & this . state . compareAndSet ( 0 , 2 ) ) { \n",Switch to Reactor 2020 . 0 . 0 snapshots \n See gh - 25373,435
"build . gradle \n - mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 "" \n + mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 1 "" \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ rsocket \ DefaultRSocketRequesterBuilderTests . java \n - given ( this . transport . connect ( anyInt ( ) ) ) . willReturn ( Mono . just ( this . connection ) ) ; \n + given ( this . transport . connect ( ) ) . willReturn ( Mono . just ( this . connection ) ) ; \n - verify ( this . transport ) . connect ( anyInt ( ) ) ; \n + verify ( this . transport ) . connect ( ) ; \n",Upgrade to RSocket 1 . 0 . 1,435
"spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ socket \ WebSocketMessage . java \n + @ Nullable \n + private final Object nativeMessage ; \n + \n + this ( type , payload , null ) ; \n + } \n + \n + / * * \n + * Constructor for an inbound message with access to the underlying message . \n + * @ param type the type of WebSocket message \n + * @ param payload the message content \n + * @ param nativeMessage the message from the API of the underlying WebSocket \n + * library , if applicable . \n + * @ since 5 . 3 \n + * / \n + public WebSocketMessage ( Type type , DataBuffer payload , @ Nullable Object nativeMessage ) { \n + this . nativeMessage = nativeMessage ; \n - \n + / * * \n + * Return the message from the API of the underlying WebSocket library . This \n + * is applicable for inbound messages only and when the underlying message \n + * has additional fields other than the content . Currently this is the case \n + * for Reactor Netty only . \n + * @ param < T > the type to cast the underlying message to \n + * @ return the underlying message , or { @ code null } \n + * @ since 5 . 3 \n + * / \n + @ Nullable \n + @ SuppressWarnings ( "" unchecked "" ) \n + public < T > T getNativeMessage ( ) { \n + return ( T ) this . nativeMessage ; \n + } \n + \n spring - webflux \ src \ main \ java \ org \ springframework \ web \ reactive \ socket \ adapter \ NettyWebSocketSessionSupport . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - return new WebSocketMessage ( messageTypes . get ( frame . getClass ( ) ) , payload ) ; \n + return new WebSocketMessage ( messageTypes . get ( frame . getClass ( ) ) , payload , frame ) ; \n",Provide access to Netty ' s WebSocketFrame \n Closes gh - 25099,435
"spring - test \ src \ main \ java \ org \ springframework \ test \ web \ client \ AbstractRequestExpectationManager . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + this . requestFailures . clear ( ) ; \n spring - test \ src \ test \ java \ org \ springframework \ test \ web \ client \ MockRestServiceServerTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + @ Test / / gh - 24486 \n + public void resetClearsRequestFailures ( ) { \n + MockRestServiceServer server = MockRestServiceServer . bindTo ( this . restTemplate ) . build ( ) ; \n + server . expect ( once ( ) , requestTo ( "" / remoteurl "" ) ) . andRespond ( withSuccess ( ) ) ; \n + this . restTemplate . postForEntity ( "" / remoteurl "" , null , String . class ) ; \n + server . verify ( ) ; \n + \n + assertThatExceptionOfType ( AssertionError . class ) \n + . isThrownBy ( ( ) - > this . restTemplate . postForEntity ( "" / remoteurl "" , null , String . class ) ) \n + . withMessageStartingWith ( "" No further requests expected "" ) ; \n + \n + server . reset ( ) ; \n + \n + server . expect ( once ( ) , requestTo ( "" / remoteurl "" ) ) . andRespond ( withSuccess ( ) ) ; \n + this . restTemplate . postForEntity ( "" / remoteurl "" , null , String . class ) ; \n + server . verify ( ) ; \n + } \n + \n - assertThatExceptionOfType ( AssertionError . class ) . isThrownBy ( ( ) - > \n - this . restTemplate . postForEntity ( "" / remoteurl "" , null , String . class ) ) \n - . withMessageStartingWith ( "" No further requests expected "" ) ; \n + assertThatExceptionOfType ( AssertionError . class ) \n + . isThrownBy ( ( ) - > this . restTemplate . postForEntity ( "" / remoteurl "" , null , String . class ) ) \n + . withMessageStartingWith ( "" No further requests expected "" ) ; \n - assertThatExceptionOfType ( AssertionError . class ) . isThrownBy ( \n - server : : verify ) \n - . withMessageStartingWith ( "" Some requests did not execute successfully "" ) ; \n + assertThatExceptionOfType ( AssertionError . class ) \n + . isThrownBy ( server : : verify ) \n + . withMessageStartingWith ( "" Some requests did not execute successfully "" ) ; \n",MockRestServiceServer clears failed requests map \n Closes gh - 24486,435
"spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ MetadataEncoder . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - private static final Pattern VARS _ PATTERN = Pattern . compile ( "" \ \ { ( [ ^ / ] + ? ) } "" ) ; \n + private static final Pattern VARS _ PATTERN = Pattern . compile ( "" \ \ { ( . + ? ) } "" ) ; \n + matcher . appendTail ( sb ) ; \n spring - messaging \ src \ test \ java \ org \ springframework \ messaging \ rsocket \ MetadataEncoderTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - . route ( "" a . { b } . { c } "" , "" BBB "" , "" C . C . C "" ) \n + . route ( "" a . { b } . { c } . d "" , "" BBB "" , "" C . C . C "" ) \n - assertThat ( dumpString ( buffer ) ) . isEqualTo ( "" a . BBB . C % 2EC % 2EC "" ) ; \n + assertThat ( dumpString ( buffer ) ) . isEqualTo ( "" a . BBB . C % 2EC % 2EC . d "" ) ; \n",MetadataEncoder expands vars correctly \n Closes gh - 24656,435
spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ function \ DefaultServerRequest . java \n - this . requestPath = ServletRequestPathUtils . getParsedRequestPath ( servletRequest ) ; \n + / / DispatcherServlet parses the path but for other scenarios ( e . g . tests ) we might need to \n + \n + this . requestPath = ( ServletRequestPathUtils . hasParsedRequestPath ( servletRequest ) ? \n + ServletRequestPathUtils . getParsedRequestPath ( servletRequest ) : \n + ServletRequestPathUtils . parseAndCache ( servletRequest ) ) ; \n,DefaultServerRequest parses the path if necessary \n Closes gh - 25353,435
"build . gradle \n - mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 1 "" \n + mavenBom "" io . rsocket : rsocket - bom : 1 . 1 . 0 - SNAPSHOT "" \n + maven { url "" https : / / oss . jfrog . org / artifactory / oss - snapshot - local "" } / / RSocket \n",Upgrade to RSocket 1 . 1 . 0 snapshots \n See gh - 25331,435
spring - core \ src \ main \ java \ org \ springframework \ util \ CommonsLogWriter . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - char ch = buffer [ offset + i ] ; \n - if ( ch = = ' \ n ' & & this . buffer . length ( ) > 0 ) { \n - logger . debug ( this . buffer . toString ( ) ) ; \n - this . buffer . setLength ( 0 ) ; \n - } \n - else { \n - this . buffer . append ( ch ) ; \n - } \n + write ( buffer [ offset + i ] ) ; \n,Minor refactoring in CommonsLogWriter \n Closes gh - 24495,435
spring - core \ src \ main \ java \ org \ springframework \ util \ ConcurrentReferenceHashMap . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - return ( result = = Boolean . TRUE ) ; \n + return ( Boolean . TRUE . equals ( result ) ) ; \n - return ( result = = Boolean . TRUE ) ; \n + return ( Boolean . TRUE . equals ( result ) ) ; \n,Minor polishing in ConcurrentReferenceHashMap \n Closes gh - 24494,435
"spring - context \ src \ main \ java \ org \ springframework \ scheduling \ concurrent \ ExecutorConfigurationSupport . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - private int awaitTerminationSeconds = 0 ; \n + private long awaitTerminationMillis = 0 ; \n - this . awaitTerminationSeconds = awaitTerminationSeconds ; \n + this . awaitTerminationMillis = awaitTerminationSeconds * 1000 ; \n + / * * \n + * Variant of { @ link # setAwaitTerminationSeconds } with millisecond precision . \n + * @ since 5 . 2 . 4 \n + * @ see java . util . concurrent . ExecutorService # shutdown ( ) \n + * @ see java . util . concurrent . ExecutorService # awaitTermination \n + * / \n + public void setAwaitTerminationMillis ( long awaitTerminationMillis ) { \n + this . awaitTerminationMillis = awaitTerminationMillis ; \n + } \n + \n + \n - if ( this . awaitTerminationSeconds > 0 ) { \n + if ( this . awaitTerminationMillis > 0 ) { \n - if ( ! executor . awaitTermination ( this . awaitTerminationSeconds , TimeUnit . SECONDS ) ) { \n + if ( ! executor . awaitTermination ( this . awaitTerminationMillis , TimeUnit . MILLISECONDS ) ) { \n",Expose awaitTerminationMillis presion \n Closes gh - 24496,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ server \ handler \ ExceptionHandlingWebHandler . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - return Mono . error ( ex ) . checkpoint ( description + "" [ ExceptionHandlingWebHandler ] "" ) . cast ( Void . class ) ; \n + return Mono . < Void > error ( ex ) . checkpoint ( description + "" [ ExceptionHandlingWebHandler ] "" ) ; \n spring - web \ src \ main \ java \ org \ springframework \ web \ server \ session \ InMemoryWebSessionStore . java \n - return Mono . fromSupplier ( ( ) - > new InMemoryWebSession ( now ) ) \n - . subscribeOn ( Schedulers . boundedElastic ( ) ) \n - . cast ( WebSession . class ) ; \n + return Mono . < WebSession > fromSupplier ( ( ) - > new InMemoryWebSession ( now ) ) \n + . subscribeOn ( Schedulers . boundedElastic ( ) ) ; \n",Polishing : remove use of cast where avoidable,435
"spring - core \ src \ main \ java \ org \ springframework \ core \ ReactiveAdapterRegistry . java \n + * < p > < strong > Note : < / strong > As of Spring Framework 5 . 3 , support for RxJava 1 . x \n + * is deprecated in favor of RxJava 2 and 3 . \n + * \n - / / RxJava1 \n + / / RxJava1 ( deprecated ) \n src \ docs \ asciidoc \ web - reactive . adoc \n - has built - in support for RxJava and ` CompletableFuture ` , but you can register others , too . \n + has built - in support for RxJava 2 / 3 , RxJava 1 ( via RxJava Reactive Streams bridge ) , and \n + ` CompletableFuture ` , but you can register others , too . \n + \n + [ NOTE ] \n + = = = = \n + As of Spring Framework 5 . 3 , support for RxJava 1 is deprecated . \n + = = = = \n + \n",Deprecate support for RxJava 1 . x \n Closes gh - 19628,435
"src \ docs \ asciidoc \ core \ core - validation . adoc \n - Setting and getting properties is done by using the ` setPropertyValue ` , \n - ` setPropertyValues ` , ` getPropertyValue ` , and ` getPropertyValues ` methods which come \n - with a couple of overloaded variants . Springs javadoc describes them in more detail . \n - The JavaBeans specification has conventions for indicating properties of an \n - object . The following table shows some examples of these conventions : \n + Setting and getting properties is done through the ` setPropertyValue ` and \n + ` getPropertyValue ` overloaded method variants of ` BeanWrapper ` . See their Javadoc for \n + details . The below table shows some examples of these conventions : \n",Correct documentation error in section on BeanWrapper \n Closes gh - 24510,435
"spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ mvc \ method \ annotation \ RequestMappingHandlerMapping . java \n - * { @ link ContentNegotiationManager } ) . For further context , please read issue \n + * { @ link org . springframework . web . accept . ContentNegotiationManagerFactoryBean \n + * ContentNegotiationManagerFactoryBean } ) . For further context , please read issue \n spring - webmvc \ src \ main \ resources \ org \ springframework \ web \ servlet \ config \ spring - mvc . xsd \n - The default value is true . \n + \n + In 5 . 2 . 4 , suffix pattern matching was deprecated in order to discourage use of path \n + extensions for request mapping and for content negotiation ( see deprecation notes on \n + org . springframework . web . servlet . mvc . method . annotation . RequestMappingHandlerMapping and on \n + org . springframework . web . accept . ContentNegotiationManagerFactoryBean and \n + also see https : / / github . com / spring - projects / spring - framework / issues / 24179 . \n + \n + The default value is true but in 5 . 3 it changes to false . \n + \n + In 5 . 2 . 4 , suffix pattern matching was deprecated in order to discourage use of path \n + extensions for request mapping and for content negotiation ( see deprecation notes on \n + org . springframework . web . servlet . mvc . method . annotation . RequestMappingHandlerMapping and on \n + org . springframework . web . accept . ContentNegotiationManagerFactoryBean and \n + also see https : / / github . com / spring - projects / spring - framework / issues / 24179 . \n + \n",Add deprecation notes to the WebMvc config schema \n Closes gh - 23915,435
"build . gradle \n - mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 - RC7 "" \n + mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 "" \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ MetadataEncoder . java \n - import io . rsocket . metadata . CompositeMetadataFlyweight ; \n - import io . rsocket . metadata . TaggingMetadataFlyweight ; \n + @ SuppressWarnings ( "" deprecation "" ) \n - CompositeMetadataFlyweight . encodeAndAddMetadata ( composite , this . allocator , \n + io . rsocket . metadata . CompositeMetadataFlyweight . encodeAndAddMetadata ( composite , this . allocator , \n - CompositeMetadataFlyweight . encodeAndAddMetadata ( \n + io . rsocket . metadata . CompositeMetadataFlyweight . encodeAndAddMetadata ( \n + @ SuppressWarnings ( "" deprecation "" ) \n - return TaggingMetadataFlyweight . createRoutingMetadata ( \n + return io . rsocket . metadata . TaggingMetadataFlyweight . createRoutingMetadata ( \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ annotation \ support \ MessagingRSocket . java \n - import io . rsocket . AbstractRSocket ; \n - class MessagingRSocket extends AbstractRSocket { \n + class MessagingRSocket implements RSocket { \n",Upgrade to RSocket 1 . 0 . 0 \n Closes gh - 25053,435
"build . gradle \n - mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 - RC7 "" \n + mavenBom "" io . rsocket : rsocket - bom : 1 . 0 . 0 "" \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ MetadataEncoder . java \n - import io . rsocket . metadata . CompositeMetadataFlyweight ; \n - import io . rsocket . metadata . TaggingMetadataFlyweight ; \n + @ SuppressWarnings ( "" deprecation "" ) \n - CompositeMetadataFlyweight . encodeAndAddMetadata ( composite , this . allocator , \n + io . rsocket . metadata . CompositeMetadataFlyweight . encodeAndAddMetadata ( composite , this . allocator , \n - CompositeMetadataFlyweight . encodeAndAddMetadata ( \n + io . rsocket . metadata . CompositeMetadataFlyweight . encodeAndAddMetadata ( \n + @ SuppressWarnings ( "" deprecation "" ) \n - return TaggingMetadataFlyweight . createRoutingMetadata ( \n + return io . rsocket . metadata . TaggingMetadataFlyweight . createRoutingMetadata ( \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ rsocket \ annotation \ support \ MessagingRSocket . java \n - import io . rsocket . AbstractRSocket ; \n - class MessagingRSocket extends AbstractRSocket { \n + class MessagingRSocket implements RSocket { \n",Upgrade to RSocket 1 . 0 . 0 \n Closes gh - 25053,435
"spring - web \ src \ main \ java \ org \ springframework \ web \ method \ annotation \ ExceptionHandlerMethodResolver . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - method = resolveMethodByExceptionType ( cause . getClass ( ) ) ; \n + method = resolveMethodByThrowable ( cause ) ; \n spring - web \ src \ test \ java \ org \ springframework \ web \ method \ annotation \ ExceptionHandlerMethodResolverTests . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + @ Test \n + public void resolveMethodExceptionCause ( ) { \n + ExceptionHandlerMethodResolver resolver = new ExceptionHandlerMethodResolver ( ExceptionController . class ) ; \n + \n + SocketException bindException = new BindException ( ) ; \n + bindException . initCause ( new FileNotFoundException ( ) ) ; \n + \n + Exception exception = new Exception ( new Exception ( new Exception ( bindException ) ) ) ; \n + \n + assertThat ( resolver . resolveMethod ( exception ) . getName ( ) ) . isEqualTo ( "" handleSocketException "" ) ; \n + } \n + \n",@ ExceptionHandler resolves nested exceptions \n See gh - 23380,435
"src \ com \ bumptech \ photos \ cache \ SizedBitmapCache . java \n - import com . bumptech . photos . util . Log ; \n + private static final int MAX _ PER _ SIZE = 5 ; \n - available . add ( bitmap ) ; \n - Log . d ( "" SBC : added bitmap sizeKey = "" + sizeKey + "" available = "" + available . size ( ) ) ; \n + if ( available . size ( ) < MAX _ PER _ SIZE ) { \n + available . add ( bitmap ) ; \n + } \n - Log . d ( "" SBC : removed bitmap sizeKey = "" + sizeKey + "" available = "" + ( available . size ( ) - 1 ) ) ; \n",Add a max # of bitmaps per size to store \n Also remove some logging,447
"src \ com \ bumptech \ photos \ resize \ PhotoStreamResizer . java \n + public PhotoStreamResizer ( Handler mainHandler ) { \n + this ( mainHandler , null ) ; \n + } \n + \n + \n + \n + \n - if ( CAN _ RECYCLE ) { \n + if ( CAN _ RECYCLE & & bitmapCache ! = null ) { \n",Allow PSR to not use recycled bitmaps \n Increases the standalone utility of the class,447
"src \ com \ bumptech \ photos \ PhotoManager . java \n + private enum ResizeType { \n + CENTER _ CROP , \n + FIT _ CENTER , \n + APPROXIMATE , \n + AS _ IS \n + } \n + \n - final String key = getKey ( path ) ; \n + final String key = getKey ( path , 0 , 0 , ResizeType . AS _ IS ) ; \n - final String key = getKey ( path , width , height ) ; \n + final String key = getKey ( path , width , height , ResizeType . APPROXIMATE ) ; \n - final String key = getKey ( path , width , height ) ; \n + final String key = getKey ( path , width , height , ResizeType . CENTER _ CROP ) ; \n - final String key = getKey ( path , width , height ) ; \n + final String key = getKey ( path , width , height , ResizeType . FIT _ CENTER ) ; \n - private static String getKey ( String path ) { \n - return getKey ( path , 0 , 0 ) ; \n - } \n - \n - private static String getKey ( String path , int width , int height ) { \n - return path + width + "" _ "" + height ; \n + private static String getKey ( String path , int width , int height , ResizeType type ) { \n + return path + width + "" _ "" + height + type . name ( ) ; \n",Allow caching of same photo in different types \n Adds an enum to be appended onto keys so that keys \n identify not just the size but also the type of \n type .,447
src \ com \ bumptech \ photos \ PhotoManager . java \n - backgroundHandler . removeCallbacksAndMessages ( token ) ; \n + if ( token ! = null ) { \n + backgroundHandler . removeCallbacksAndMessages ( token ) ; \n + } \n,Don ' t remove all queued items if token = = null,447
src \ com \ bumptech \ photos \ cache \ SizedBitmapCache . java \n - private static final int MAX _ PER _ SIZE = 5 ; \n + private static final int MAX _ PER _ SIZE = 8 ; \n,Increase # of each bitmap type to keep around,447
"src \ com \ bumptech \ photos \ PhotoManager . java \n - private Map < Bitmap , Integer > bitmapReferenceCounter = new HashMap < Bitmap , Integer > ( ) ; \n + private Map < Integer , Integer > bitmapReferenceCounter = new HashMap < Integer , Integer > ( ) ; \n - if ( ! b . isMutable ( ) ) return ; \n - \n - Integer currentCount = bitmapReferenceCounter . get ( b ) ; \n + Integer currentCount = bitmapReferenceCounter . get ( b . hashCode ( ) ) ; \n - bitmapReferenceCounter . put ( b , currentCount + 1 ) ; \n + bitmapReferenceCounter . put ( b . hashCode ( ) , currentCount + 1 ) ; \n - Integer currentCount = bitmapReferenceCounter . get ( b ) - 1 ; \n + Integer currentCount = bitmapReferenceCounter . get ( b . hashCode ( ) ) - 1 ; \n + Log . d ( "" PhotoManager : releaseBitmap currentCount = "" + ( currentCount ) ) ; \n - bitmapReferenceCounter . remove ( b ) ; \n + bitmapReferenceCounter . remove ( b . hashCode ( ) ) ; \n - bitmapReferenceCounter . put ( b , currentCount ) ; \n + bitmapReferenceCounter . put ( b . hashCode ( ) , currentCount ) ; \n","Track bitmaps using hashcode , not the object \n Prevents us from accidently leaking bitmaps if \n we fail to call acquire and release in the correct \n order .",447
"src \ com \ bumptech \ photos \ cache \ PhotoDiskCache . java \n - } else { \n - Log . d ( "" DLRU : not found key = "" + key ) ; \n - } \n - DiskLruCache . Snapshot snapshot2 = cache . get ( safeKey ) ; \n + DiskLruCache . Snapshot snapshot2 = cache . get ( safeKey ) ; \n - if ( snapshot2 ! = null ) { \n - result2 = snapshot2 . getInputStream ( VALUE _ COUNT - 1 ) ; \n + if ( snapshot2 ! = null ) { \n + result2 = snapshot2 . getInputStream ( VALUE _ COUNT - 1 ) ; \n + } else { \n + Log . d ( "" DLRU : second snapshot not found key = "" + key ) ; \n + } \n - Log . d ( "" DLRU : not found key = "" + key ) ; \n + Log . d ( "" DLRU : first snapshot not found key = "" + key ) ; \n - \n",Only fetch missing entries in disk cache once,447
"src \ com \ bumptech \ photos \ PhotoManager . java \n - postJob ( putToDiskCache , token ) ; \n + postJob ( putToDiskCache , null ) ; \n","Don ' t cancel disk cache puts \n No point in doing the same work repeatedly , might \n as well eagerly incur the cost of putting to the \n disk cache and avoid having to resize again later .",447
"src \ com \ bumptech \ photos \ view \ ThumbAssetPresenter . java \n + import android . graphics . drawable . Drawable ; \n + import android . widget . ImageView ; \n + import com . bumptech . photos . view . assetpath . AssetPathConverter ; \n + import com . bumptech . photos . view . loader . ImageLoader ; \n + \n + public ThumbAssetPresenter ( ImageView imageView , AssetPathConverter < T > converter , ImageLoader fullLoader , ImageLoader thumbLoader ) { \n + this ( new AssetPresenter < T > ( imageView , converter , fullLoader ) , new AssetPresenter < T > ( imageView , converter , thumbLoader ) ) ; \n + } \n + \n + public void setOnFullSetCallback ( ImageSetCallback cb ) { \n + fullPresenter . setOnImageSetCallback ( cb ) ; \n + } \n + \n + public void setOnThumbSetCallback ( ImageSetCallback cb ) { \n + thumbPresenter . setOnImageSetCallback ( cb ) ; \n + } \n + \n + public void setPlaceholderDrawable ( Drawable placeholderDrawable ) { \n + fullPresenter . setPlaceholderDrawable ( placeholderDrawable ) ; \n + } \n + \n",Add more helper methods to thumb asset presenter,447
"src \ com \ bumptech \ photos \ PhotoManager . java \n + import android . os . Build ; \n + public static final boolean CAN _ RECYCLE = Build . VERSION . SDK _ INT > = 11 ; \n + \n - this . resizer = new PhotoStreamResizer ( mainHandler , bitmapCache ) ; \n + this . resizer = new PhotoStreamResizer ( mainHandler , CAN _ RECYCLE ? bitmapCache : null ) ; \n + if ( ! CAN _ RECYCLE ) return ; \n + \n + if ( ! CAN _ RECYCLE ) return ; \n + \n - Log . d ( "" PhotoManager : releaseBitmap currentCount = "" + ( currentCount ) ) ; \n src \ com \ bumptech \ photos \ resize \ PhotoStreamResizer . java \n - import android . os . Build ; \n - private static final boolean CAN _ RECYCLE = Build . VERSION . SDK _ INT > = 11 ; \n - if ( CAN _ RECYCLE & & bitmapCache ! = null ) { \n + if ( bitmapCache ! = null ) { \n",Don ' t try to track or recycle bitmaps if < 3 . 0,447
"src \ com \ bumptech \ photos \ PhotoManager . java \n - import com . bumptech . photos . resize . PhotoStreamResizer ; \n + import com . bumptech . photos . resize . ResizeJobGenerator ; \n - private PhotoStreamResizer resizer ; \n + private ResizeJobGenerator resizer ; \n - this . resizer = new PhotoStreamResizer ( mainHandler , CAN _ RECYCLE ? bitmapCache : null ) ; \n + this . resizer = new ResizeJobGenerator ( mainHandler , CAN _ RECYCLE ? bitmapCache : null ) ; \n rename from src \ com \ bumptech \ photos \ resize \ PhotoStreamResizer . java \n rename to src \ com \ bumptech \ photos \ resize \ ResizeJobGenerator . java \n - public class PhotoStreamResizer { \n + public class ResizeJobGenerator { \n - public PhotoStreamResizer ( Handler mainHandler ) { \n + public ResizeJobGenerator ( Handler mainHandler ) { \n - public PhotoStreamResizer ( Handler mainHandler , SizedBitmapCache bitmapCache ) { \n + public ResizeJobGenerator ( Handler mainHandler , SizedBitmapCache bitmapCache ) { \n",Rename stream resizer to match what it now does,447
src \ com \ bumptech \ photos \ PhotoManager . java \n + public void rejectBitmap ( Bitmap b ) { \n + if ( ! CAN _ RECYCLE ) return ; \n + \n + Integer currentCount = bitmapReferenceCounter . get ( b . hashCode ( ) ) ; \n + if ( currentCount = = null | | currentCount = = 0 ) { \n + bitmapReferenceCounter . remove ( b . hashCode ( ) ) ; \n + bitmapCache . put ( b ) ; \n + } \n + } \n + \n src \ com \ bumptech \ photos \ view \ loader \ PhotoManagerLoader . java \n - if ( isUsed ) { \n + if ( isUsed ) { \n + } else { \n + photoManager . rejectBitmap ( image ) ; \n,Add a way to queue bitmaps that are never aquired,447
src \ com \ bumptech \ photos \ cache \ LruPhotoCache . java \n - if ( evicted & & photoRemovedListener ! = null ) { \n + if ( photoRemovedListener ! = null ) { \n,"Fix losing track of bitmaps when they are replaced \n If the bitmap in the cache were replaced , rather \n than being evicted , the listener would not be \n notified and we would leak a reference .",447
"src \ com \ bumptech \ photos \ resize \ ResizeJobGenerator . java \n - return new SimpleStreamResizeRunnable ( callback ) { \n + return new StreamResizeRunnable ( callback ) { \n + \n + @ Override \n + public Bitmap getRecycledBitmap ( ) { \n + return bitmapCache . get ( width , height ) ; \n + } \n - return Utils . centerCrop ( streamed , width , height ) ; \n + return Utils . centerCrop ( recycled , streamed , width , height ) ; \n src \ com \ bumptech \ photos \ resize \ Utils . java \n + return centerCrop ( null , toCrop , width , height ) ; \n + } \n + \n + public static Bitmap centerCrop ( Bitmap recycled , Bitmap toCrop , int width , int height ) { \n - Bitmap result = Bitmap . createBitmap ( width , height , toCrop . getConfig ( ) ) ; \n + Bitmap result = recycled ! = null ? recycled : Bitmap . createBitmap ( width , height , toCrop . getConfig ( ) ) ; \n",Use recycled bitmaps when performing a center crop,447
"src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n + private boolean loadedFromCache = false ; \n + loadedFromCache = true ; \n + loadedFromCache = false ; \n + \n - private void fetchImage ( String path , T model , final int loadCount ) { \n - imageToken = imageLoader . fetchImage ( path , model , width , height , new ImageLoader . ImageReadyCallback ( ) { \n + private void fetchImage ( final String path , T model , final int loadCount ) { \n + imageToken = imageLoader . fetchImage ( path , model , width , height , new ImageLoader . ImageReadyCallback ( ) { \n - imageSetCallback . onImageSet ( imageView , false ) ; \n + imageSetCallback . onImageSet ( imageView , loadedFromCache ) ; \n",Pass in correct value if image comes from cache,447
src \ com \ bumptech \ photos \ view \ loader \ PhotoManagerLoader . java \n + if ( acquired ! = null ) { \n + photoManager . releaseBitmap ( acquired ) ; \n + acquired = null ; \n + } \n,"Release bitmaps when we request a new one \n Maximizes potential for recycling , each loader now \n only needs to hold on to at most one bitmap at a \n time . Before it would hold on to the old bitmap \n and request a new one , using twice the memory",447
src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n - imageToken = null ; \n - pathToken = null ; \n + imageLoader . clear ( ) ; \n src \ com \ bumptech \ photos \ view \ loader \ ImageLoader . java \n + public void clear ( ) ; \n src \ com \ bumptech \ photos \ view \ loader \ PhotoManagerLoader . java \n + @ Override \n + public void clear ( ) { \n + if ( acquired ! = null ) { \n + photoManager . releaseBitmap ( acquired ) ; \n + acquired = null ; \n + } \n + } \n + \n,"Add a clear method to image loader \n Also don ' t cancel load tasks . We incur the gc \n penalty early on , so though cancelling might save \n some cpu work , it causes more gcing and worse \n performance early on because we toss the allocated \n bitmap rather than storing and reusing it .",447
"src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n + import android . os . Handler ; \n + import android . os . SystemClock ; \n - import com . bumptech . photos . util . Log ; \n - private Object pathToken ; \n - private Object imageToken ; \n + private static final String PENDING _ LOAD _ TOKEN = "" pending _ load "" ; \n + private static final int PENDING _ LOAD _ DELAY = 20 ; / / 60 fps = 1000 / 60 = 16 . 67 ms \n + \n + private Object pathToken ; \n + private Object imageToken ; \n + \n + private Handler handler = new Handler ( ) ; \n + \n - private boolean setLayoutListener = false ; \n - \n - Log . d ( "" AP : getDimens run width = "" + width + "" height = "" + height ) ; \n - if ( width = = 0 | | height = = 0 ) { \n - if ( ! setLayoutListener ) { \n - imageView . getViewTreeObserver ( ) . addOnGlobalLayoutListener ( new SizeObserver ( imageView , ImagePresenter . this ) ) ; \n - setLayoutListener = true ; \n - } \n - } else if ( pendingLoad ! = null ) { \n - imageView . post ( pendingLoad ) ; \n + if ( width ! = 0 & & height ! = 0 ) { \n + postPendingLoad ( ) ; \n + imageView . getViewTreeObserver ( ) . addOnGlobalLayoutListener ( new SizeObserver ( imageView , ImagePresenter . this ) ) ; \n + pendingLoad = null ; \n + private void postPendingLoad ( ) { \n + if ( pendingLoad = = null ) return ; \n + \n + / / If an image view is actively changing sizes , we want to delay our resize job until \n + / / the size has stabilized so that the image we load will match the final size , rather than some \n + / / size part way through the change . One example of this is as part of an animation where a view is \n + / / expanding or shrinking \n + handler . removeCallbacksAndMessages ( PENDING _ LOAD _ TOKEN ) ; \n + handler . postAtTime ( pendingLoad , PENDING _ LOAD _ TOKEN , SystemClock . uptimeMillis ( ) + PENDING _ LOAD _ DELAY ) ; \n + } \n + \n",Delay image fetch until view size is stable \n Fixes a case where we load an image for a view \n part way through a property animation so when \n the animation finishes the loaded image only fits \n in part of the view .,447
src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n - imageView . setImageBitmap ( null ) ; \n + resetPlaceHolder ( ) ; \n,Reset to a placeholder when clearing a presenter,447
src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n - if ( placeholderDrawable = = null | | ! canSetPlaceholder ( ) ) return ; \n + if ( ! canSetPlaceholder ( ) ) return ; \n,Reset to blank if no placeholder is set,447
src \ com \ bumptech \ photos \ view \ ImagePresenter . java \n - private static final int PENDING _ LOAD _ DELAY = 20 ; / / 60 fps = 1000 / 60 = 16 . 67 ms \n + private static final int PENDING _ LOAD _ DELAY = 100 ; / / 60 fps = 1000 / 60 = 16 . 67 ms \n + if ( imageView . getWidth ( ) = = width & & imageView . getHeight ( ) = = height ) return ; \n + \n,Increase the odds of letting an animation finish,447
"library \ src \ com \ bumptech \ photos \ presenter \ ImagePresenter . java \n - if ( model = = null | | model . equals ( currentModel ) ) return ; \n + if ( model = = null ) { \n + clear ( ) ; \n + } else if ( ! model . equals ( currentModel ) ) { \n + loadedFromCache = true ; \n + final int loadCount = + + currentCount ; \n + currentModel = model ; \n + isImageSet = false ; \n + \n + sizeDeterminer . getSize ( new SizeDeterminer . SizeReadyCallback ( ) { \n + @ Override \n + public void onSizeReady ( int width , int height ) { \n + fetchPath ( model , width , height , loadCount ) ; \n + } \n + } ) ; \n - loadedFromCache = true ; \n - final int loadCount = + + currentCount ; \n - currentModel = model ; \n - isImageSet = false ; \n + loadedFromCache = false ; \n - sizeDeterminer . getSize ( new SizeDeterminer . SizeReadyCallback ( ) { \n - @ Override \n - public void onSizeReady ( int width , int height ) { \n - fetchPath ( model , width , height , loadCount ) ; \n + if ( ! isImageSet ( ) ) { \n + resetPlaceHolder ( ) ; \n - } ) ; \n - \n - loadedFromCache = false ; \n - \n - if ( ! isImageSet ( ) ) { \n - resetPlaceHolder ( ) ; \n",Clear image presenter when get a null model \n Resets the placeholder and cancels old load . \n Probably makes more sense than doing nothing \n and allowing the old load to complete,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - try { \n - diskCache = DiskLruCacheWrapper . get ( getPhotoCacheDir ( context ) , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n - } catch ( IOException e ) { \n - / / this is probably a corrupt or full sd card , so default to not using a disk cache \n - e . printStackTrace ( ) ; \n - diskCache = new DiskCacheAdapter ( ) ; \n + File cacheDir = getPhotoCacheDir ( context ) ; \n + if ( cacheDir ! = null ) { \n + try { \n + diskCache = DiskLruCacheWrapper . get ( cacheDir , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n + } catch ( IOException e ) { \n + / / this is probably a corrupt or full sd card , so default to not using a disk cache \n + e . printStackTrace ( ) ; \n + } \n + \n + diskCache = new DiskCacheAdapter ( ) ; \n",Fix exception when disk cache dir is null,447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - public void rejectBitmap ( Bitmap b ) { \n + public void rejectBitmap ( final Bitmap b ) { \n - bitmapCache . put ( b ) ; \n + / / can only put or take from bitmap cache on one thread \n + bgHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapCache . put ( b ) ; \n + } \n + } ) ; \n - public void releaseBitmap ( Bitmap b ) { \n + public void releaseBitmap ( final Bitmap b ) { \n - bitmapCache . put ( b ) ; \n + / / can only put or take from bitmap cache on one thread \n + bgHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapCache . put ( b ) ; \n + } \n + } ) ; \n,Only touch bitmap cache on one thread \n avoid extra locking,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - InputStream is1 = getFromDiskCache ( key ) ; \n + final boolean isInDiskCache ; \n + InputStream is1 = null ; \n - if ( is1 ! = null ) { \n - is2 = getFromDiskCache ( key ) ; \n + if ( useDiskCache ) { \n + is1 = getFromDiskCache ( key ) ; \n + is2 = null ; \n + if ( is1 ! = null ) { \n + is2 = getFromDiskCache ( key ) ; \n + } \n + \n + isInDiskCache = is1 ! = null & & is2 ! = null ; \n + } else { \n + isInDiskCache = false ; \n - final boolean isInDiskCache = is1 ! = null & & is2 ! = null ; \n - Bitmap result = null ; \n - try { \n - if ( isInDiskCache & & useDiskCache ) { \n - result = resizer . loadAsIs ( is1 , is2 ) ; \n - } else { \n - result = resizeIfNotFound ( ) ; \n - } \n - } catch ( Exception e ) { \n - cb . onLoadFailed ( e ) ; \n + final Bitmap result ; \n + if ( isInDiskCache ) { \n + result = resizer . loadAsIs ( is1 , is2 ) ; \n + } else { \n + result = resizeIfNotFound ( ) ; \n - if ( ! isInDiskCache & & useDiskCache ) { \n + if ( useDiskCache & & ! isInDiskCache ) { \n",Don ' t check disk cache if not using disk cache,447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - bgHandler . post ( new Runnable ( ) { \n + bgHandler . postAtFrontOfQueue ( new Runnable ( ) { \n,Increase odds of recycled bitmaps being available \n Occasionally loads seemd to be happening before \n the corresponding loader ' s release of its previous \n bitmaps which lead to lots more allocing then \n we expected,447
library \ src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n - to . inPreferQualityOverSpeed = from . inPreferQualityOverSpeed ; \n + if ( Build . VERSION . SDK _ INT > = 10 ) \n + to . inPreferQualityOverSpeed = from . inPreferQualityOverSpeed ; \n,Fix an Option only available in 10 + \n We support 9 + . . .,447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - try { \n - if ( isInDiskCache ) { \n + if ( isInDiskCache ) { \n + try { \n - } else { \n + } catch ( Exception e ) { \n + e . printStackTrace ( ) ; \n + } \n + } \n + \n + if ( result = = null ) { \n + try { \n + } catch ( Exception e ) { \n + e . printStackTrace ( ) ; \n + cb . onLoadFailed ( e ) ; \n - } catch ( Exception e ) { \n - cb . onLoadFailed ( e ) ; \n,Try to resize if disk cache load fails \n In case is corrupt for whatever reason we don ' t \n crash or give up entirely,447
library \ src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n - final BitmapFactory . Options decodeBitmapOptions = getDefaultOptions ( ) ; \n + final BitmapFactory . Options decodeBitmapOptions = getOptions ( ) ; \n - final BitmapFactory . Options decodeBitmapOptions = getDefaultOptions ( recycle ) ; \n + final BitmapFactory . Options decodeBitmapOptions = getOptions ( recycle ) ; \n - final BitmapFactory . Options decodeBitmapOptions = getDefaultOptions ( recycle ) ; \n + final BitmapFactory . Options decodeBitmapOptions = getOptions ( recycle ) ; \n - final BitmapFactory . Options decodeBoundsOptions = getDefaultOptions ( ) ; \n + final BitmapFactory . Options decodeBoundsOptions = getOptions ( ) ; \n - final BitmapFactory . Options decodeBoundsOptions = getDefaultOptions ( ) ; \n + final BitmapFactory . Options decodeBoundsOptions = getOptions ( ) ; \n - private BitmapFactory . Options getDefaultOptions ( Bitmap recycle ) { \n + private BitmapFactory . Options getOptions ( ) { \n + return getOptions ( null ) ; \n + } \n + \n + private BitmapFactory . Options getOptions ( Bitmap recycle ) { \n,Actually use options passed to image resizer \n Accidently were always using default b / c of a \n naming collision,447
library \ src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n + if ( streamed = = null ) return null ; \n + \n + \n + if ( streamed = = null ) return null ; \n + \n,Fix NPEs if a load fails to return an image for \n whatever reason,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - final int key = getKey ( path , 0 , 0 , ResizeType . AS _ IS ) ; \n + final int key = getKey ( path , - 1 , - 1 , ResizeType . AS _ IS ) ; \n",Fix key for AS _ IS images being 0 . . .,447
library \ src \ com \ bumptech \ photos \ resize \ cache \ PhotoDiskCache . java \n - edit . commit ( ) ; \n - } catch ( IOException e ) { \n + if ( cache . isClosed ( ) ) { \n + edit . abort ( ) ; \n + } else { \n + edit . commit ( ) ; \n + } \n + } catch ( Exception e ) { \n,Be more paranoid about catching disk cache excepts \n Some weird race conditions around image saving \n and cache opening / closing .,447
library \ src \ com \ bumptech \ photos \ resize \ cache \ PhotoDiskCache . java \n - if ( cache . isClosed ( ) ) { \n - edit . abort ( ) ; \n - } else { \n + if ( ! cache . isClosed ( ) ) { \n - } catch ( IOException e1 ) { \n + } catch ( Exception e1 ) { \n,Abort can throw same illegal state as commit \n So don ' t try to abort if disk cache is closed and \n catch all errors in error handeling code so we \n don ' t cause a crash trying to abort a failed \n commit,447
"library \ src \ com \ bumptech \ photos \ resize \ cache \ disk \ DiskCache . java \n - public void open ( ) { \n + public synchronized void open ( ) { \n - public void close ( ) { \n + public synchronized void close ( ) { \n - public void put ( String key , final Bitmap bitmap ) { \n + public synchronized void put ( String key , final Bitmap bitmap ) { \n - public String get ( String key ) { \n + public synchronized String get ( String key ) { \n - public void remove ( String key ) { \n + public synchronized void remove ( String key ) { \n - private void delete ( String safeKey ) { \n + private synchronized void delete ( String safeKey ) { \n","Be more paranoid about threading in disk cache \n This is not really a solution , but in case \n open and close overlap because of actions on \n background threads started by two different \n image managers , this will at least let state \n be consistent . Needs more work to avoid this \n problem .",447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + import com . bumptech . photos . util . Log ; \n - final String cachePath ; \n + String cachePath = null ; \n + \n + Boolean isExternalStorageRemoveable = null ; \n + if ( Build . VERSION . SDK _ INT > = 9 ) { \n + isExternalStorageRemoveable = Environment . isExternalStorageRemovable ( ) ; \n + } \n + \n - ! Environment . isExternalStorageRemovable ( ) ) { \n - cachePath = context . getExternalCacheDir ( ) . getPath ( ) ; \n - } else { \n - cachePath = context . getCacheDir ( ) . getPath ( ) ; \n + ( isExternalStorageRemoveable ! = null & & ! isExternalStorageRemoveable ) ) { \n + / / seems like this can still be null even if the above are true \n + final File externalCacheDir = context . getExternalCacheDir ( ) ; \n + if ( externalCacheDir ! = null ) { \n + cachePath = externalCacheDir . getPath ( ) ; \n + } else { \n + Log . e ( "" IM : external cache dir is null "" ) ; \n + } \n - File result = new File ( cachePath + File . separatorChar + cacheName ) ; \n - if ( ! result . exists ( ) ) { \n - result . mkdir ( ) ; \n + if ( cachePath = = null ) { \n + final File internalCacheDir = context . getCacheDir ( ) ; \n + if ( internalCacheDir ! = null ) { \n + cachePath = internalCacheDir . getPath ( ) ; \n + } else { \n + Log . e ( "" IM : internal cache dir is null "" ) ; \n + } \n + } \n + \n + if ( cachePath ! = null ) { \n + File result = new File ( cachePath + File . separatorChar + cacheName ) ; \n + if ( ! result . exists ( ) ) { \n + result . mkdir ( ) ; \n + } \n + return result ; \n + } else { \n + Log . d ( "" IM : default disk cache dir is null "" ) ; \n + return null ; \n - return result ; \n","Handle cache dirs being null + build version check \n Apparently either get cache dir method can return \n null in some circumstances . If one does , try the \n other , if both do , return null . The image manager \n will just not use a disk cache if the cache \n dir is null . Environment . \n isExternalStorageRemovable is api 9 + and we \n support 8 , so add a check before using it .",447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - acquireBitmap ( finalResult ) ; \n + acquireBitmap ( bitmap ) ; \n,Don ' acquire bitmap for memory cache when not used,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n - Bitmap result = recycled ! = null ? recycled : Bitmap . createBitmap ( width , height , toCrop . getConfig ( ) ) ; \n + final Bitmap result ; \n + if ( recycled ! = null ) { \n + result = recycled ; \n + } else { \n + result = Bitmap . createBitmap ( width , height , toCrop . getConfig ( ) = = null ? \n + Bitmap . Config . ARGB _ 8888 : toCrop . getConfig ( ) ) ; \n + } ; \n",Avoid NPE when bitmap ' s config is null . . .,447
"library \ src \ com \ bumptech \ photos \ presenter \ ImagePresenter . java \n + private boolean manualDimensSet = false ; \n - imageView . post ( getDimens ) ; \n + if ( ! manualDimensSet ) { \n + imageView . post ( getDimens ) ; \n + } \n + } \n + \n + public void setDimens ( int width , int height ) { \n + manualDimensSet = true ; \n + this . width = width ; \n + this . height = height ; \n library \ src \ com \ bumptech \ photos \ presenter \ ThumbImagePresenter . java \n + public void setDimens ( int width , int height ) { \n + fullPresenter . setDimens ( width , height ) ; \n + thumbPresenter . setDimens ( width , height ) ; \n + } \n + \n",Add method to manually set dimens on presenters,447
src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n - toCrop . recycle ( ) ; \n - toCrop . recycle ( ) ; \n - toShrink . recycle ( ) ; \n - toShrink . recycle ( ) ; \n,remove recycle calls \n Sometimes the recycled bitmap is actually returned \n and displayed - > an exception,447
library \ src \ com \ bumptech \ glide \ util \ Log . java \n + public static boolean DEBUG = false ; \n + \n + if ( ! DEBUG ) return ; \n + \n + if ( ! DEBUG ) return ; \n + \n + if ( ! DEBUG ) return ; \n + \n,Don ' t log verbosely unless explicitly enabled,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - import java . lang . ref . WeakReference ; \n - private final WeakReference < StreamLoader > slRef ; \n - private final WeakReference < Transformation > tRef ; \n - private final WeakReference < Downsampler > dRef ; \n - private final WeakReference < LoadedCallback > cbRef ; \n + private final StreamLoader streamLoader ; \n + private final Transformation transformation ; \n + private final Downsampler downsampler ; \n + private final LoadedCallback cb ; \n - slRef = new WeakReference < StreamLoader > ( sl ) ; \n - tRef = new WeakReference < Transformation > ( t ) ; \n - dRef = new WeakReference < Downsampler > ( d ) ; \n - cbRef = new WeakReference < LoadedCallback > ( cb ) ; \n + this . streamLoader = sl ; \n + this . transformation = t ; \n + this . downsampler = d ; \n + this . cb = cb ; \n - final StreamLoader streamLoader = slRef . get ( ) ; \n - final StreamLoader streamLoader = slRef . get ( ) ; \n - if ( streamLoader = = null ) { \n - return ; \n - } \n - final Downsampler downsampler = dRef . get ( ) ; \n - final Transformation transformation = tRef . get ( ) ; \n - if ( downsampler ! = null & & transformation ! = null ) { \n - final Bitmap result = resizeIfNotFound ( is , downsampler , transformation ) ; \n - finishResize ( result , false ) ; \n - } \n + final Bitmap result = resizeIfNotFound ( is , downsampler , transformation ) ; \n + finishResize ( result , false ) ; \n - final LoadedCallback cb = cbRef . get ( ) ; \n - if ( cb ! = null ) { \n - bitmapReferenceCounter . markPending ( result ) ; \n - cb . onLoadCompleted ( result ) ; \n - } \n + bitmapReferenceCounter . markPending ( result ) ; \n + cb . onLoadCompleted ( result ) ; \n - final LoadedCallback cb = cbRef . get ( ) ; \n - if ( cb ! = null ) { \n - cb . onLoadFailed ( e ) ; \n - } \n + cb . onLoadFailed ( e ) ; \n",Revert to holding strong references during loads \n This fixes a bug where a load may silently fail to \n complete if the user passes in a target and does \n not retain a reference to the target for the \n duration of the load .,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - \n library \ src \ com \ bumptech \ glide \ loader \ image \ ImageManagerLoader . java \n - ( downsampler = = Downsampler . NONE & & width = = WRAP _ CONTENT & & height = = WRAP _ CONTENT ) ; \n + ( downsampler = = Downsampler . NONE & & ( width = = WRAP _ CONTENT | | height = = WRAP _ CONTENT ) ) ; \n library \ src \ com \ bumptech \ glide \ resize \ load \ Transformation . java \n + if ( outWidth < = 0 | | outHeight < = 0 ) { \n + throw new IllegalArgumentException ( "" Cannot center crop image to width = "" + outWidth + "" and height = "" \n + + outHeight ) ; \n + } \n + if ( outWidth < = 0 | | outHeight < = 0 ) { \n + throw new IllegalArgumentException ( "" Cannot fit center image to within width = "" + outWidth + "" or height = "" \n + + outHeight ) ; \n + } \n library \ tests \ src \ com \ bumptech \ glide \ GlideTest . java \n + public void testCanHandleWrapContentMatchParent ( ) { \n + imageView . setLayoutParams ( new ViewGroup . LayoutParams ( ViewGroup . LayoutParams . WRAP _ CONTENT , \n + ViewGroup . LayoutParams . MATCH _ PARENT ) ) ; \n + Glide . load ( "" fake "" ) . into ( imageView ) ; \n + \n + assertNotNull ( getImagePresenterFromView ( ) ) ; \n + } \n + \n","Allow match _ parent / wrap _ content view dimensions \n By default if the view has wrap _ content for either \n the width or the height ( or both ) , we will load \n the image in at the original size . Trying to apply \n either FitCenter or CenterCrop to the load will \n still result in an exception since we would need \n concrete sizes to transform the image .",447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - acquireBitmap ( bitmap ) ; \n - memoryCache . put ( key , bitmap ) ; \n + synchronized ( memoryCache ) { \n + if ( ! memoryCache . contains ( key ) ) { \n + acquireBitmap ( bitmap ) ; \n + memoryCache . put ( key , bitmap ) ; \n + } \n + } \n library \ src \ com \ bumptech \ photos \ resize \ cache \ LruPhotoCache . java \n - public void put ( int key , Bitmap bitmap ) { \n + public synchronized void put ( int key , Bitmap bitmap ) { \n - public Bitmap get ( int key ) { \n + public synchronized Bitmap get ( int key ) { \n - public void remove ( int key ) { \n + public synchronized void remove ( int key ) { \n + public synchronized boolean contains ( int key ) { \n + return photoCache . get ( key ) ! = null ; \n + } \n + \n",Fix race causing two loads to use same bitmap,447
library \ src \ com \ bumptech \ photos \ resize \ cache \ SizedBitmapCache . java \n + import java . util . ArrayDeque ; \n - import java . util . LinkedList ; \n - Queue < Bitmap > available ; \n - available = availableBitmaps . get ( sizeKey ) ; \n + Queue < Bitmap > available = availableBitmaps . get ( sizeKey ) ; \n - available = new LinkedList < Bitmap > ( ) ; \n + available = new ArrayDeque < Bitmap > ( ) ; \n - available . add ( bitmap ) ; \n + available . offer ( bitmap ) ; \n - final Queue < Bitmap > available ; \n + final Queue < Bitmap > available = availableBitmaps . get ( sizeKey ) ; \n - available = availableBitmaps . get ( sizeKey ) ; \n - \n - if ( available = = null | | available . size ( ) = = 0 ) { \n + if ( available = = null ) { \n - return available . remove ( ) ; \n + return available . poll ( ) ; \n,Use a dequeue instead of linked list in sbc,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + \n + / * * \n + * An internal method notifying the tracker that this bitmap is referenced but not necessarily used \n + * by an external object . These bitmaps will not be recycled if their references drop to 0 unless they are \n + * first accepted or are rejected before or after their references drop to 0 . This is used because the memory cache \n + * can force a bitmap to be removed b / c of size constraints while a callback referencing that bitmap is still \n + * on the queue of the main thread waiting to be called . If the bitmap were not marked and the memory cache released \n + * the bitmap before the callback was called on the main thread , then the bitmap would be placed in the queue to be \n + * recycled once by the memory cache and then again by the object owning the callback . \n + * \n + * @ param b The bitmap to mark \n + * / \n + private void markBitmapPending ( final Bitmap b ) { \n + if ( bitmapTracker = = null ) return ; \n + \n + bitmapTracker . markPending ( b ) ; \n + markBitmapPending ( bitmap ) ; \n",Fix race causing bitmaps to be recycled 2 + times,447
"library \ src \ com \ bumptech \ glide \ resize \ bitmap _ recycle \ LruBitmapPool . java \n + / / BitmapFactory . decodeStream can sometimes return bitmaps with null configs , which can ' t generally be \n + / / reused \n + if ( bitmap . getConfig ( ) = = null ) { \n + return false ; \n + } \n + \n",Don ' t pool bitmaps with null configs \n They will cause an IllegalArgumentException in \n some cases if passed in to decodeStream as \n inBitmap .,447
library \ src \ com \ bumptech \ photos \ resize \ cache \ disk \ Journal . java \n - private static int MAX _ LINES = 10000 ; \n + private static final int MAX _ LINES = 10000 ; \n - return file . getName ( ) ! = journalFile . getName ( ) ; \n + return ! file . getName ( ) . equals ( journalFile . getName ( ) ) ; \n - } else if ( arg1 > arg1 ) { \n + } else if ( arg1 > arg2 ) { \n,Fix some typos / bugs in disk cache journal,447
library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ ConcurrentBitmapPool . java \n + final boolean result ; \n - available . offer ( bitmap ) ; \n + result = available . size ( ) < maxPerSize ; \n + if ( result ) { \n + available . offer ( bitmap ) ; \n + } \n,Fix not limiting # of recycled bitmaps per size,447
"library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ BitmapPool . java \n - public void put ( Bitmap bitmap ) ; \n + public boolean put ( Bitmap bitmap ) ; \n library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ BitmapPoolAdapter . java \n - public void put ( Bitmap bitmap ) { } \n + public boolean put ( Bitmap bitmap ) { \n + return false ; \n + } \n library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ ConcurrentBitmapPool . java \n - public void put ( Bitmap bitmap ) { \n + public boolean put ( Bitmap bitmap ) { \n + \n + return result ; \n library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ ConcurrentBitmapReferenceCounter . java \n - import java . util . Map ; \n - private final Map < Integer , InnerTracker > counter ; \n + private final ConcurrentHashMap < Integer , InnerTracker > counter ; \n - counter = new ConcurrentHashMap < Integer , InnerTracker > ( bitmapsPerSize * 6 , 0 . 75f , 4 ) ; \n + counter = new ConcurrentHashMap < Integer , InnerTracker > ( bitmapsPerSize * 12 ) ; \n - counter . put ( toInit . hashCode ( ) , pool . get ( ) ) ; \n + final InnerTracker ifAbsent = pool . get ( ) ; \n + final InnerTracker old = counter . putIfAbsent ( toInit . hashCode ( ) , ifAbsent ) ; \n + if ( old ! = null ) { \n + pool . release ( ifAbsent ) ; \n + } \n - counter . remove ( bitmap . hashCode ( ) ) ; \n - pool . release ( tracker ) ; \n - target . put ( bitmap ) ; \n + if ( ! target . put ( bitmap ) ) { \n + counter . remove ( bitmap . hashCode ( ) ) ; \n + pool . release ( tracker ) ; \n + } \n",Try to remove and add less from reference counter,447
library \ src \ com \ bumptech \ photos \ resize \ bitmap _ recycle \ ConcurrentBitmapPool . java \n - import java . util . ArrayDeque ; \n + import java . util . LinkedList ; \n - available = new ArrayDeque < Bitmap > ( maxPerSize ) ; \n + available = new LinkedList < Bitmap > ( ) ; \n,Don ' t use ArrayDequeue since its api 9 +,447
"Makefile \n - setup : \n + jar : \n + cd library & & ant jar \n + \n + glide - minus - volley : \n + cd library & & ant glide - minus - volley \n - update - ant : setup \n - android update project - - path . . - - library glide / library \n library \ build . xml \n - < project name = "" photos "" default = "" help "" > \n + < project name = "" glide "" default = "" help "" > \n new file \n library \ custom _ rules . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" UTF - 8 "" ? > \n + < project name = "" glide - rules "" default = "" help "" > \n + < target name = "" jar "" depends = "" - compile "" > \n + < jar destfile = "" bin / glide . jar "" \n + basedir = "" bin / classes "" > \n + < zipgroupfileset dir = "" libs "" includes = "" * . jar "" / > \n + < / jar > \n + < / target > \n + < target name = "" glide - minus - volley "" depends = "" - compile "" > \n + < jar destfile = "" bin / glide - minus - volley . jar "" \n + basedir = "" bin / classes "" > \n + < zipgroupfileset dir = "" libs "" includes = "" disklrucache * . jar "" / > \n + < / jar > \n + < / target > \n + < / project > \n library \ project . properties \n - android . library = true \n + \n + # https : / / code . google . com / p / android / issues / detail ? id = 40487 \n + renderscript . opt . level = O0 \n","Add rules to build glide as a . jar \n Makes glide not a library project by default , \n although all that is really needed to use it \n as a library project is to just add \n android . library = true to project . properties again",447
"library \ src \ com \ bumptech \ glide \ Glide . java \n + if ( model = = null ) { \n + throw new IllegalArgumentException ( "" Model can ' t be null "" ) ; \n + } \n + if ( modelLoaderFactory = = null ) { \n + throw new IllegalArgumentException ( "" Missing ModelLoader factory for model = "" + model ) ; \n + } \n + if ( model = = null ) { \n + throw new IllegalArgumentException ( "" Model can ' t be null "" ) ; \n + } \n + if ( modelLoader = = null ) { \n + throw new IllegalArgumentException ( "" ModelLoader can ' t be null "" ) ; \n + } \n",Throw if key glide request arguments are null,447
library \ src \ com \ bumptech \ glide \ resize \ ImageResizer . java \n - private static final int TEMP _ BYTES _ SIZE = 16 * 1024 ; / / 16kb \n - private static final int MARK _ POSITION = 1024 * 1024 ; / / 1mb \n + private static final int TEMP _ BYTES _ SIZE = 32 * 1024 ; / / 32kb \n + private static final int MARK _ POSITION = TEMP _ BYTES _ SIZE ; / / 1024 * 1024 ; / / 1mb \n,"Fix mark position causing gcs \n if mark position > bytes size , the input stream \n will eventually allocate a new buffer up to the \n mark position . This prevents those extra \n allocations .",447
library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n - if ( loadCount ! = currentCount ) return false ; \n + if ( loadCount ! = currentCount | | id = = null | | streamOpener = = null ) return false ; \n,Stop load in ImagePresenter if id or opener = null,447
library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - bitmapReferenceCounter . rejectBitmap ( b ) ; \n + bgHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapReferenceCounter . rejectBitmap ( b ) ; \n + } \n + } ) ; \n - public void acquireBitmap ( Bitmap b ) { \n - bitmapReferenceCounter . acquireBitmap ( b ) ; \n + public void acquireBitmap ( final Bitmap b ) { \n + bgHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapReferenceCounter . acquireBitmap ( b ) ; \n + } \n + } ) ; \n - bitmapReferenceCounter . releaseBitmap ( b ) ; \n + bgHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapReferenceCounter . releaseBitmap ( b ) ; \n + } \n + } ) ; \n,do bitmap ref management on a bg thread \n Reduces the number of locks the main thread needs \n to acquire and the amount of time they need to be \n held ( as well as the contention for said locks ),447
"library \ src \ com \ bumptech \ glide \ resize \ ImageResizer . java \n + bis . clearMark ( ) ; \n library \ src \ com \ bumptech \ glide \ resize \ RecyclableBufferedInputStream . java \n - if ( markpos = = 0 & & marklimit > localBuf . length ) { \n + / / Added count ! = 0 so that we do not immediately double the buffer size before reading any data when \n + / / marklimit > localBuf . length . Instead , we will double the buffer size only after reading the initial localBuf \n + / / worth of data without finding what we ' re looking for in the stream . This allows us to set a relatively small \n + / / initial buffer size and a large marklimit for safety without causing an allocation each time read is called . \n + if ( markpos = = 0 & & marklimit > localBuf . length & & count ! = 0 ) { \n + public synchronized void clearMark ( ) { \n + markpos = - 1 ; \n + marklimit = 0 ; \n + } \n + \n","Fix extra allocations when marklimit > buffer size \n BufferedInputStream would double the buffer size \n each time it read from the input stream if \n mark limit > buffer size , including the first time \n before any data is read . This change prevents the \n buffer size from being increased until after at \n least one buffer worth of data is read . In turn \n this reduces gcs with a large mark limit relative \n to the buffer size .",447
"library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n + import com . bumptech . glide . util . Log ; \n - private ExceptionHandler < T > exceptionHandler ; \n + private ExceptionHandler < T > exceptionHandler = new ExceptionHandler < T > ( ) { \n + @ Override \n + public void onImageLoadException ( Exception e , T model , boolean isCurrent ) { \n + if ( e ! = null ) { \n + e . printStackTrace ( ) ; \n + } else { \n + Log . e ( "" IP : onImageLoadException model = "" + model ) ; \n + } \n + } \n + \n + @ Override \n + public void onModelStreamLoadException ( Exception e , T model , boolean isCurrent ) { \n + if ( e ! = null ) { \n + e . printStackTrace ( ) ; \n + } else { \n + Log . e ( "" IP : onModelStreamLoadException model = "" + model ) ; \n + } \n + } \n + } ; \n + \n",Add a default exception handler to log exceptions \n previously they were caught silently,447
library \ src \ com \ bumptech \ glide \ resize \ ImageResizer . java \n - private static final int TEMP _ BYTES _ SIZE = 32 * 1024 ; / / 32kb \n - private static final int MARK _ POSITION = TEMP _ BYTES _ SIZE ; / / 1024 * 1024 ; / / 1mb \n + private static final int TEMP _ BYTES _ SIZE = 16 * 1024 ; / / 16kb \n + private static final int MARK _ POSITION = 1024 * 1024 ; / / 1mb \n,Update mark limit and buffer size in ImageResizer,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n + private ModelStreamLoader < T > modelStreamLoader = null ; \n + this . modelStreamLoader = modelStreamLoader ; \n + if ( modelStreamLoader = = null ) { \n + throw new IllegalArgumentException ( "" You must set a ModelStreamLoader for model class = "" + \n + model . getClass ( ) ) ; \n + } \n - * @ param model The model to loa , must not be null \n + * @ param model The model to load , must not be null \n",Throw an exception if model stream loader not set,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - diskCache = DiskLruCacheWrapper . get ( getPhotoCacheDir ( context ) , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n + try { \n + diskCache = DiskLruCacheWrapper . get ( getPhotoCacheDir ( context ) , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n + } catch ( IOException e ) { \n + / / this is probably a corrupt or full sd card , so default to not using a disk cache \n + e . printStackTrace ( ) ; \n + diskCache = new DiskCacheAdapter ( ) ; \n + } \n library \ src \ com \ bumptech \ glide \ resize \ cache \ DiskLruCacheWrapper . java \n - public static DiskLruCacheWrapper get ( File directory , int maxSize ) { \n + public synchronized static DiskCache get ( File directory , int maxSize ) throws IOException { \n - try { \n - WRAPPER = new DiskLruCacheWrapper ( getDiskLruCache ( directory , maxSize ) ) ; \n - } catch ( IOException e ) { \n - throw new RuntimeException ( e ) ; \n - } \n + WRAPPER = new DiskLruCacheWrapper ( getDiskLruCache ( directory , maxSize ) ) ; \n samples \ flickr \ src \ com \ bumptech \ flickr \ FlickrSearchActivity . java \n + import com . bumptech . glide . resize . cache . DiskCache ; \n + import com . bumptech . glide . resize . cache . DiskCacheAdapter ; \n + import java . io . IOException ; \n - private File cacheDir ; \n - cacheDir = ImageManager . getPhotoCacheDir ( this , cacheName ) ; \n - if ( ! cacheDir . exists ( ) ) { \n - cacheDir . mkdir ( ) ; \n + File cacheDir = ImageManager . getPhotoCacheDir ( this , cacheName ) ; \n + \n + DiskCache diskCache ; \n + try { \n + diskCache = DiskLruCacheWrapper . get ( cacheDir , 50 * 1024 * 1024 ) ; \n + } catch ( IOException e ) { \n + e . printStackTrace ( ) ; \n + diskCache = new DiskCacheAdapter ( ) ; \n - . setDiskCache ( DiskLruCacheWrapper . get ( ImageManager . getPhotoCacheDir ( this ) , 50 * 1024 * 1024 ) ) \n + . setDiskCache ( diskCache ) \n",Allow DiskLruCacheWrapper to throw IOException \n Allows us to log and monitor the exception as well \n as forcing us to handle the default case,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - public void onStreamReady ( InputStream is ) { \n - try { \n - final Bitmap result = resizeIfNotFound ( is ) ; \n - finishResize ( result , false ) ; \n - } catch ( Exception e ) { \n - cb . onLoadFailed ( e ) ; \n - } \n + public void onStreamReady ( final InputStream is ) { \n + future = executor . submit ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + try { \n + final Bitmap result = resizeIfNotFound ( is ) ; \n + finishResize ( result , false ) ; \n + } catch ( Exception e ) { \n + cb . onLoadFailed ( e ) ; \n + } \n + } \n + } ) ; \n","Run resize tasks in our thread pool \n Previously would have run them on whatever thread \n the callback was called on , which may have been \n some external library ' s thread .",447
"new file \n library \ src \ com \ bumptech \ glide \ loader \ model \ BaseModelLoader . java \n + package com . bumptech . glide . loader . model ; \n + \n + import com . bumptech . glide . loader . stream . StreamLoader ; \n + \n + / * * \n + * A base class that handles canceling any existing { @ link StreamLoader } when \n + * cleared \n + * / \n + public abstract class BaseModelLoader < T > implements ModelLoader < T > { \n + private StreamLoader current ; \n + \n + @ Override \n + public final StreamLoader getStreamOpener ( T model , int width , int height ) { \n + current = buildStreamOpener ( model , width , height ) ; \n + return current ; \n + } \n + \n + protected abstract StreamLoader buildStreamOpener ( T model , int width , int height ) ; \n + \n + @ Override \n + public void clear ( ) { \n + if ( current ! = null ) { \n + current . cancel ( ) ; \n + current = null ; \n + } \n + } \n + } \n",Add a BaseModelLoader \n Allows us to remove the repetitive \n ModelLoader . close ( ) - > StreamOpener . cancel ( ),447
library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n + modelLoader . clear ( ) ; \n + imageLoader . clear ( ) ; \n library \ src \ com \ bumptech \ glide \ resize \ loader \ ImageManagerLoader . java \n - clear ( ) ; \n,Clear loaders before load in ImagePresenter \n Allows us not to call clear before new loads in \n all of the loaders,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n + private static final int DEFAULT _ BITMAP _ COMPRESS _ QUALITY = 90 ; \n + private final int bitmapCompressQuality ; \n + private int bitmapCompressQuality = DEFAULT _ BITMAP _ COMPRESS _ QUALITY ; \n + * @ see { @ link Bitmap # compress ( android . graphics . Bitmap . CompressFormat , int , java . io . OutputStream ) } \n + * \n + / * * \n + * Set the compression quality for Bitmaps when writing them out to the disk cache . \n + * \n + * @ see { @ link Bitmap # compress ( android . graphics . Bitmap . CompressFormat , int , java . io . OutputStream ) } \n + * @ see { @ link # setBitmapCompressFormat ( android . graphics . Bitmap . CompressFormat ) } \n + * \n + * @ param quality Hint for compression in range 0 - 100 with 0 being lowest and 100 being highest quality . Will \n + * only be applied for certain lossy compression formats \n + * @ return This Builder \n + * / \n + public Builder setBitmapCompressQuality ( int quality ) { \n + if ( quality < 0 ) { \n + throw new IllegalArgumentException ( "" Bitmap compression quality must be > = 0 "" ) ; \n + } \n + this . bitmapCompressQuality = quality ; \n + return this ; \n + } \n + \n + bitmapCompressQuality = builder . bitmapCompressQuality ; \n - result . compress ( bitmapCompressFormat , 100 , os ) ; \n + result . compress ( bitmapCompressFormat , bitmapCompressQuality , os ) ; \n",Make compression quality to diskcache configurable \n Also decrease the default from 100 to 90 .,447
library \ src \ com \ bumptech \ glide \ Glide . java \n - if ( model = = URL . class ) { \n + if ( model instanceof URL ) { \n - } else if ( model = = File . class ) { \n + } else if ( model instanceof File ) { \n,Use instanceof not class comparison \n Also fixes bug where we were comparing objects \n to classes,447
library \ src \ com \ bumptech \ glide \ Glide . java \n - builder . setModelLoader ( modelLoader ) ; \n - presenter = builder . build ( ) ; \n + presenter = builder . setModelLoader ( modelLoader ) . build ( ) ; \n,Always set default model loader in Glide . load,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n + import com . bumptech . glide . loader . model . StringLoader ; \n + } else if ( model instanceof String ) { \n + return ( ModelLoader < T > ) new StringLoader ( context , GLIDE . getRequestQueue ( context ) ) ; \n new file \n library \ src \ com \ bumptech \ glide \ loader \ model \ StringLoader . java \n + package com . bumptech . glide . loader . model ; \n + \n + import android . content . Context ; \n + import android . net . Uri ; \n + import com . android . volley . RequestQueue ; \n + import com . bumptech . glide . loader . stream . FileStreamLoader ; \n + import com . bumptech . glide . loader . stream . StreamLoader ; \n + import com . bumptech . glide . util . Log ; \n + \n + import java . io . File ; \n + \n + / * * \n + * A model loader for handling certain string models . Handles paths , urls , and any uri string with a scheme handled by \n + * { @ link android . content . ContentResolver # openInputStream ( android . net . Uri ) } . \n + * / \n + public class StringLoader extends BaseModelLoader < String > { \n + \n + private final UriLoader uriLoader ; \n + \n + public StringLoader ( Context context , RequestQueue requestQueue ) { \n + uriLoader = new UriLoader ( context , requestQueue ) ; \n + } \n + \n + @ Override \n + protected StreamLoader buildStreamOpener ( String model , int width , int height ) { \n + final File file = new File ( model ) ; \n + if ( file . exists ( ) & & ! file . isDirectory ( ) ) { \n + Log . d ( "" TEST : string loader have file exists and not dir "" ) ; \n + return new FileStreamLoader ( model ) ; \n + } else { \n + final Uri uri = Uri . parse ( model ) ; \n + Log . d ( "" TEST : string loader parsed uri to : "" + uri ) ; \n + return uriLoader . buildStreamOpener ( uri , width , height ) ; \n + } \n + } \n + \n + @ Override \n + public String getId ( String model ) { \n + return model ; \n + } \n + } \n",Add default loader for Strings for Glide . load,447
"library \ src \ com \ bumptech \ glide \ loader \ model \ StringLoader . java \n - import com . bumptech . glide . util . Log ; \n - protected StreamLoader buildStreamOpener ( String model , int width , int height ) { \n - final File file = new File ( model ) ; \n - if ( file . exists ( ) & & ! file . isDirectory ( ) ) { \n - Log . d ( "" TEST : string loader have file exists and not dir "" ) ; \n - return new FileStreamLoader ( model ) ; \n - } else { \n - final Uri uri = Uri . parse ( model ) ; \n - Log . d ( "" TEST : string loader parsed uri to : "" + uri ) ; \n - return uriLoader . buildStreamOpener ( uri , width , height ) ; \n - } \n + protected StreamLoader buildStreamOpener ( final String model , final int width , final int height ) { \n + return new StreamLoader ( ) { \n + StreamLoader subStreamLoader = null ; \n + @ Override \n + public void loadStream ( StreamReadyCallback cb ) { \n + final File file = new File ( model ) ; \n + if ( file . exists ( ) & & ! file . isDirectory ( ) ) { \n + subStreamLoader = new FileStreamLoader ( model ) ; \n + } else { \n + final Uri uri = Uri . parse ( model ) ; \n + subStreamLoader = uriLoader . buildStreamOpener ( uri , width , height ) ; \n + } \n + \n + subStreamLoader . loadStream ( cb ) ; \n + } \n + \n + @ Override \n + public void cancel ( ) { \n + if ( subStreamLoader ! = null ) { \n + subStreamLoader . cancel ( ) ; \n + } \n + } \n + } ; \n",Check if strings are paths on background thread,447
library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n - if ( layoutParams . width > 0 & & layoutParams . height > 0 ) { \n + if ( layoutParams ! = null & & layoutParams . width > 0 & & layoutParams . height > 0 ) { \n,Fix an NPE if layout params not yet set in view \n Can occur if you call new View ( Context ) .,447
library \ src \ com \ bumptech \ glide \ Glide . java \n - if ( presenter = = null ) { \n - builder . setImageLoader ( imageLoader ) ; \n - } \n + builder . setImageLoader ( imageLoader ) ; \n,"Remove a null check in Glide . resizeWith \n Its not any more work to just pass through to the \n builder , so we might as well ( even if we don ' t \n use the builder ) .",447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - return ( ModelLoader < T > ) new FileLoader ( ) ; \n + return ( ModelLoader < T > ) new FileLoader ( context ) ; \n library \ src \ com \ bumptech \ glide \ loader \ model \ FileLoader . java \n - import com . bumptech . glide . loader . stream . FileStreamLoader ; \n + import android . content . Context ; \n + import android . net . Uri ; \n + import com . bumptech . glide . loader . stream . LocalUriLoader ; \n + private final Context context ; \n + \n + public FileLoader ( Context context ) { \n + this . context = context ; \n + } \n - return new FileStreamLoader ( model ) ; \n + return new LocalUriLoader ( context , Uri . fromFile ( model ) ) ; \n library \ src \ com \ bumptech \ glide \ loader \ stream \ LocalUriLoader . java \n - * Opens an input stream for a uri pointing to a local asset \n + * Opens an input stream for a uri pointing to a local asset . Only certain uris are supported \n",Base FileLoader on UriLoader \n removes some duplicated code .,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - return ( ModelLoader < T > ) new StringLoader ( context , new UrlLoader ( GLIDE . getRequestQueue ( context ) ) ) ; \n + return ( ModelLoader < T > ) new StringLoader ( new UriLoader ( context , new UrlLoader ( GLIDE . getRequestQueue ( context ) ) ) ) ; \n library \ src \ com \ bumptech \ glide \ loader \ model \ StringLoader . java \n - import android . content . Context ; \n - import android . webkit . URLUtil ; \n - import java . net . URL ; \n - private final UriLoader uriLoader ; \n + private final ModelLoader < Uri > uriLoader ; \n - public StringLoader ( Context context , ModelLoader < URL > urlLoader ) { \n - uriLoader = new UriLoader ( context , urlLoader ) ; \n + public StringLoader ( ModelLoader < Uri > uriLoader ) { \n + this . uriLoader = uriLoader ; \n - final Uri uri ; \n - if ( ! URLUtil . isValidUrl ( model ) ) { \n + Uri uri = Uri . parse ( model ) ; \n + \n + final String scheme = uri . getScheme ( ) ; \n + if ( scheme = = null ) { \n - } else { \n - uri = Uri . parse ( model ) ; \n - return uriLoader . buildStreamOpener ( uri , width , height ) ; \n + return uriLoader . getStreamOpener ( uri , width , height ) ; \n",Simplify StringLoader to take UriLoader \n eliminates the weird dependency on UrlLoader in \n StringLoader,447
library \ src \ com \ bumptech \ glide \ Glide . java \n + import android . graphics . drawable . Drawable ; \n + / * * \n + * Sets a drawable to display while an image is loading \n + * \n + * @ param drawable The drawable to use as a placeholder \n + * @ return This Request \n + * / \n + public Request < T > setPlaceholderDrawable ( Drawable drawable ) { \n + builder . setPlaceholderDrawable ( drawable ) ; \n + return this ; \n + } \n + \n + / * * \n + * @ see # setPlaceholderDrawable ( android . graphics . drawable . Drawable ) \n + * \n + * @ param resourceId The id of the resource to use as a placeholder \n + * @ return This Request \n + * / \n + public Request < T > setPlaceholderResource ( int resourceId ) { \n + builder . setPlaceholderResource ( resourceId ) ; \n + return this ; \n + } \n + \n,Add methods to set placeholders in Glide . load,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - * Resizes models using { @ link ImageManager # centerCrop ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n + * Resize models using { @ link ImageManager # centerCrop ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n - * Resizes models using { @ link ImageManager # fitCenter ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n + * Resize models using { @ link ImageManager # fitCenter ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n - * Resizes models using { @ link ImageManager # getImageApproximate ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n + * Resize models using { @ link ImageManager # getImageApproximate ( String , com . bumptech . glide . loader . stream . StreamLoader , int , int , com . bumptech . glide . resize . LoadedCallback ) } \n + * < p > \n + * Note - If an existing ImagePresenter already exists for this view it will not be replaced . This means you \n + * can set options once and only once the first time load and begin is called for any given view . For \n + * example , if you call load and begin for a view with centerCrop the first time and then load a second time \n + * for the same view but with fitCenter , the image will still be resized with centerCrop . If you need \n + * to change options you can call < code > imageView . setTag ( R . id . image _ presenter _ id , null ) < / code > prior to \n + * calling this method , but it is inefficient to do so , particularly in lists . \n + * < / p > \n + * \n + * \n - * \n - * If a Request is completed with replaceAndBuild ( ) , then an ImagePresenter will be created but the image \n - * load will not actually be started until some subsequent Request is completed with { @ link # begin ( ) } \n",Update some of comments for Glide . load,447
"library \ src \ com \ bumptech \ glide \ loader \ stream \ VolleyStreamLoader . java \n - current = requestQueue . add ( new Request < ByteArrayInputStream > ( Request . Method . GET , url , new Response . ErrorListener ( ) { \n + current = requestQueue . add ( new Request < Void > ( Request . Method . GET , url , new Response . ErrorListener ( ) { \n - protected Response < ByteArrayInputStream > parseNetworkResponse ( NetworkResponse response ) { \n - / / this may be less than ideal , since we can ' t downsample the image as it is read , \n - / / but we don ' t have a choice if we want to use Volley \n - return Response . success ( new ByteArrayInputStream ( response . data ) , getCacheEntry ( ) ) ; \n + protected Response < Void > parseNetworkResponse ( NetworkResponse response ) { \n + / / We actually are going to do the parsing in the callback , so we we ' re going to call it here where it \n + / / will be executed on a background thread . \n + cb . onStreamReady ( new ByteArrayInputStream ( response . data ) ) ; \n + return Response . success ( null , getCacheEntry ( ) ) ; \n - protected void deliverResponse ( ByteArrayInputStream response ) { \n - cb . onStreamReady ( response ) ; \n - } \n + protected void deliverResponse ( Void response ) { } \n - if ( current ! = null ) { \n - current . cancel ( ) ; \n + final Request local = current ; \n + if ( local ! = null ) { \n + local . cancel ( ) ; \n","Call cb in background in VolleyStreamLoader \n This means our code in the cb will run on a \n background thread . Though all we do is post to a \n thread pool , this change means we don ' t need to \n acquire that lock on the main thread .",447
samples \ flickr \ src \ com \ bumptech \ flickr \ FlickrSearchActivity . java \n + . setBitmapCompressQuality ( 70 ) \n + \n,Increase Bitmap compression in flickr sample \n Increases # of images that will fit into cache,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - bitmapReferenceCounter . initBitmap ( result ) ; \n - putInMemoryCache ( key , result ) ; \n + final boolean addedToMemoryCache = putInMemoryCache ( key , result ) ; \n + bgHandler . postAtFrontOfQueue ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + bitmapReferenceCounter . initBitmap ( result ) ; \n + if ( addedToMemoryCache ) { \n + bitmapReferenceCounter . acquireBitmap ( result ) ; \n + bitmapReferenceCounter . markPending ( result ) ; \n + } \n + } \n + } ) ; \n + \n - private void putInMemoryCache ( int key , Bitmap bitmap ) { \n + private boolean putInMemoryCache ( int key , Bitmap bitmap ) { \n - if ( ! inCache ) { \n - acquireBitmap ( bitmap ) ; \n - bitmapReferenceCounter . markPending ( bitmap ) ; \n - } \n + return ! inCache ; \n",Mildly reduce # of posts to bg thread per resize,447
"samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Api . java \n + import com . android . volley . DefaultRetryPolicy ; \n - requestQueue . add ( new StringRequest ( Request . Method . GET , getSearchUrl ( text ) , new Response . Listener < String > ( ) { \n + StringRequest request = new StringRequest ( Request . Method . GET , getSearchUrl ( text ) , new Response . Listener < String > ( ) { \n - JSONObject searchResults = new JSONObject ( response . substring ( 14 , response . length ( ) - 1 ) ) ; \n + JSONObject searchResults = new JSONObject ( response . substring ( 14 , response . length ( ) - 1 ) ) ; \n - } ) ) ; \n + } ) ; \n + request . setRetryPolicy ( new DefaultRetryPolicy ( DefaultRetryPolicy . DEFAULT _ TIMEOUT _ MS , 3 , DefaultRetryPolicy . DEFAULT _ BACKOFF _ MULT ) ) ; \n + requestQueue . add ( request ) ; \n",Add retries to flickr search in sample project,447
"samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Api . java \n - private static final String PHOTO _ URL = "" http : / / farm % s . staticflickr . com / % s / % s _ % s _ % s . jpg "" ; \n + / / incomplete size independent url for photos that can be cached per photo \n + private static final String CACHEABLE _ PHOTO _ URL = "" http : / / farm % s . staticflickr . com / % s / % s _ % s _ "" ; \n + public static String getCacheableUrl ( Photo photo ) { \n + return String . format ( CACHEABLE _ PHOTO _ URL , photo . farm , photo . server , photo . id , photo . secret ) ; \n + } \n + \n - return String . format ( PHOTO _ URL , photo . farm , photo . server , photo . id , photo . secret , sizeKey ) ; \n + return photo . getPartialUrl ( ) + sizeKey + "" . jpg "" ; \n samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Photo . java \n + private String partialUrl = null ; \n + public String getPartialUrl ( ) { \n + if ( partialUrl = = null ) { \n + partialUrl = Api . getCacheableUrl ( this ) ; \n + } \n + return partialUrl ; \n + } \n + \n",Cache inefficient Url creation per photo \n String . format is rather terrible,447
Makefile \n - echo android . library = true > > library / volley / project . properties \n + cd library / volley & & ant jar \n + cp library / volley / bin / volley . jar library / libs \n + \n + update - ant : setup \n library \ build . gradle \n - compile project ( ' volley ' ) \n + compile files ( ' libs / volley . jar ' ) \n - \n - } \n + } \n library \ project . properties \n - android . library . reference . 1 = volley \n library \ tests \ project . properties \n - android . library . reference . 1 = . . / . . / library \n + \n,Compile volley as a jar and not a library project,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - import java . io . IOException ; \n - public Builder setDefaultMemoryCacheSize ( int maxSize ) { \n - if ( memoryCache ! = null ) { \n - throw new IllegalArgumentException ( "" Can ' t set a default memory cache after setting a custom one "" ) ; \n - } \n - \n - memoryCache = new LruPhotoCache ( maxSize ) ; \n - return this ; \n - } \n - \n - public Builder setDefaultDiskCacheOptions ( File dir ) { \n - setDefaultDiskCacheOptions ( dir , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n - return this ; \n - } \n - \n - public Builder setDefaultDiskCacheOptions ( int size ) { \n - setDefaultDiskCacheOptions ( getPhotoCacheDir ( context ) , size ) ; \n - return this ; \n - } \n - \n - public Builder setDefaultDiskCacheOptions ( File dir , int size ) { \n - if ( size < = 0 ) { \n - throw new IllegalArgumentException ( "" Size must be > = 0 "" ) ; \n - } \n - \n - if ( diskCache ! = null ) { \n - throw new IllegalArgumentException ( "" Can ' t set disk cache twice "" ) ; \n - } \n - \n - try { \n - diskCache = DiskLruCacheWrapper . get ( dir , size ) ; \n - } catch ( IOException e ) { \n - e . printStackTrace ( ) ; \n - disableDiskCache ( ) ; \n - } \n - return this ; \n - } \n - setDefaultMemoryCacheSize ( LruPhotoCache . getMaxCacheSize ( context ) ) ; \n + memoryCache = new LruPhotoCache ( LruPhotoCache . getMaxCacheSize ( context ) ) ; \n - setDefaultDiskCacheOptions ( getPhotoCacheDir ( context ) , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n + diskCache = DiskLruCacheWrapper . get ( getPhotoCacheDir ( context ) , DEFAULT _ DISK _ CACHE _ SIZE ) ; \n samples \ flickr \ src \ com \ bumptech \ flickr \ FlickrSearchActivity . java \n + import com . bumptech . photos . resize . cache . DiskLruCacheWrapper ; \n + import com . bumptech . photos . resize . cache . LruPhotoCache ; \n - . setDefaultDiskCacheOptions ( 50 * 1024 * 1024 ) \n + . setMemoryCache ( new LruPhotoCache ( 1234 ) ) \n + . setDiskCache ( DiskLruCacheWrapper . get ( ImageManager . getPhotoCacheDir ( this ) , 50 * 1024 * 1024 ) ) \n",Remove set default options in ImageManager \n Simpler interface if people just set instances of \n default disk / memory cache that they create,447
"library \ src \ com \ bumptech \ photos \ resize \ cache \ DiskLruCacheWrapper . java \n + private static DiskLruCacheWrapper WRAPPER = null ; \n - public static DiskLruCacheWrapper get ( File directory , int maxSize ) throws IOException { \n - return new DiskLruCacheWrapper ( getDiskLruCache ( directory , maxSize ) ) ; \n + public static DiskLruCacheWrapper get ( File directory , int maxSize ) { \n + if ( WRAPPER = = null ) { \n + try { \n + WRAPPER = new DiskLruCacheWrapper ( getDiskLruCache ( directory , maxSize ) ) ; \n + } catch ( IOException e ) { \n + throw new RuntimeException ( e ) ; \n + } \n + } \n + return WRAPPER ; \n","Make DiskLruCacheWrapper a singleton \n Makes it more apparent that options can only bet \n set once , rather than each time a new wrapper is \n created",447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + import android . app . ActivityManager ; \n + private static final float MEMORY _ SIZE _ RATIO = 1f / 10f ; \n + / * \n + * Can only call after context is created ( ie in onCreate or later . . . ) \n + * / \n + public static int getMaxCacheSize ( Context context ) { \n + final ActivityManager activityManager = ( ActivityManager ) context . getSystemService ( Context . ACTIVITY _ SERVICE ) ; \n + return Math . round ( MEMORY _ SIZE _ RATIO * activityManager . getMemoryClass ( ) * 1024 * 1024 ) ; \n + } \n - memoryCache = new LruPhotoCache ( LruPhotoCache . getMaxCacheSize ( context ) ) ; \n + memoryCache = new LruPhotoCache ( getMaxCacheSize ( context ) ) ; \n library \ src \ com \ bumptech \ photos \ resize \ cache \ LruPhotoCache . java \n - import android . app . ActivityManager ; \n - import android . content . Context ; \n - private static final float SIZE _ RATIO = 1f / 10f ; \n - / * \n - Can only call after context is created ( ie in onCreate or later . . . ) \n - * / \n - public static int getMaxCacheSize ( Context context ) { \n - final ActivityManager activityManager = ( ActivityManager ) context . getSystemService ( Context . ACTIVITY _ SERVICE ) ; \n - return Math . round ( SIZE _ RATIO * activityManager . getMemoryClass ( ) * 1024 * 1024 ) ; \n - } \n - \n,"Move getMaxCacheSize to ImaageManager \n Similar method to getPhotoCache , so might as well \n be in the same place",447
"library \ src \ com \ bumptech \ glide \ resize \ bitmap _ recycle \ SerialBitmapReferenceCounter . java \n + import java . util . WeakHashMap ; \n - private final Map < Bitmap , InnerTracker > counter = new HashMap < Bitmap , InnerTracker > ( ) ; \n + private final Map < Bitmap , InnerTracker > counter = new WeakHashMap < Bitmap , InnerTracker > ( ) ; \n",Fix a memory leak when bitmaps not released,447
library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n - if ( relevant & & canSetPlaceholder ( ) ) { \n + if ( relevant & & canSetPlaceholder ( ) & & errorDrawable ! = null ) { \n,Don ' t set a null error drawable,447
"library \ src \ com \ bumptech \ glide \ loader \ model \ ResourceLoader . java \n - import com . bumptech . glide . loader . stream . LocalUriLoader ; \n - return new ResourceLoader ( context ) ; \n + return new ResourceLoader ( context , factories . buildModelLoader ( Uri . class , context ) ) ; \n + private final ModelLoader < Uri > uriLoader ; \n - public ResourceLoader ( Context context ) { \n + public ResourceLoader ( Context context , ModelLoader < Uri > uriLoader ) { \n + this . uriLoader = uriLoader ; \n - return new LocalUriLoader ( context , uri ) ; \n + return uriLoader . getStreamLoader ( uri , width , height ) ; \n library \ tests \ src \ com \ bumptech \ glide \ loader \ ResourceLoaderTest . java \n + import android . content . Context ; \n + import com . bumptech . glide . loader . model . ModelLoader ; \n + import com . bumptech . glide . loader . model . UriLoader ; \n + import java . net . URL ; \n - ResourceLoader resourceLoader = new ResourceLoader ( getInstrumentation ( ) . getContext ( ) ) ; \n + final Context context = getInstrumentation ( ) . getContext ( ) ; \n + ResourceLoader resourceLoader = new ResourceLoader ( context , new UriLoader ( context , new ModelLoader < URL > ( ) { \n + @ Override \n + public StreamLoader getStreamLoader ( URL model , int width , int height ) { \n + return null ; \n + } \n + \n + @ Override \n + public String getId ( URL model ) { \n + return null ; \n + } \n + } ) ) ; \n",Allow arbitrary uri loader in resource loader \n Lets us use factory for uris rather than relying \n on our specific implementation,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - if ( ! current . equals ( previous ) ) { \n + if ( ! current . isIdenticalTo ( previous ) ) { \n - @ Override \n - public boolean equals ( Object o ) { \n - if ( this = = o ) return true ; \n - if ( o = = null | | getClass ( ) ! = o . getClass ( ) ) return false ; \n - \n - Metadata metadata = ( Metadata ) o ; \n - \n + / / we don ' t want to change behavior in sets / maps , just be able to compare properties \n + public boolean isIdenticalTo ( Metadata metadata ) { \n + if ( metadata = = null ) return false ; \n - \n - @ Override \n - public int hashCode ( ) { \n - int result = modelClass . hashCode ( ) ; \n - result = 31 * result + modelLoaderClass . hashCode ( ) ; \n - result = 31 * result + animationId ; \n - result = 31 * result + placeholderId ; \n - result = 31 * result + errorId ; \n - result = 31 * result + downsamplerId . hashCode ( ) ; \n - result = 31 * result + transformationId . hashCode ( ) ; \n - return result ; \n - } \n",Don ' t override equals / hashcode in metadata,447
library \ src \ com \ bumptech \ glide \ Glide . java \n - return cancel ( GLIDE . getImageViewTarget ( imageView ) ) ; \n + final Target target = GLIDE . getImageViewTarget ( imageView ) ; \n + return target ! = null & & cancel ( target ) ; \n,Handle image views that aren ' t targets in cancel,447
"library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n + \n + if ( id = = null | | sl = = null ) { \n + Log . i ( "" ImagePresenter got null model id or stream loader model = "" + model + "" id = "" + id + "" stream loader = "" + sl ) ; \n + clear ( ) ; \n + return ; \n + } \n + \n","Allow ModelLoaders to return null values \n This allows models to sometimes , but not always , \n have an associated image . If a ModelLoader returns \n null , we will assume there is no image associated \n with that particular model instance and show \n the placeholder .",447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - public < T > ModelLoader < T > buildModelLoader ( Class < T > clazz , Context context ) { \n - return loaderFactory . buildModelLoader ( clazz , context ) ; \n + public static < T > ModelLoader < T > buildModelLoader ( Class < T > clazz , Context context ) { \n + return GLIDE . loaderFactory . buildModelLoader ( clazz , context ) ; \n samples \ flickr \ src \ com \ bumptech \ glide \ samples \ flickr \ FlickrPhotoGrid . java \n - . setModelLoader ( Glide . get ( ) . buildModelLoader ( Photo . class , context ) ) \n + . setModelLoader ( Glide . buildModelLoader ( Photo . class , context ) ) \n","Make buildModelLoader a static method on Glide \n It ' s not a setter , so it might as well have the \n slightly simpler static syntax .",447
"library \ custom _ rules . xml \n + < xmlproperty file = "" AndroidManifest . xml "" prefix = "" mymanifest "" collapseAttributes = "" true "" / > \n + \n - < jar destfile = "" bin / glide . jar "" \n + < jar destfile = "" bin / glide - $ { mymanifest . manifest . android : versionName } . jar "" \n - < jar destfile = "" bin / glide - minus - volley . jar "" \n + < jar destfile = "" bin / glide - minus - volley - $ { mymanifest . manifest . android : versionName } . jar "" \n",Add version name to Glide jars in ant,447
"library \ AndroidManifest . xml \n - android : versionCode = "" 1 "" \n - android : versionName = "" 1 . 0 "" > \n + android : versionCode = "" 2 "" \n + android : versionName = "" 2 . 0 . 0 "" > \n",Bump version to 2 . 0 . 0,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + public void pause ( ) { \n + if ( diskCache ! = null ) { \n + diskCache . stop ( ) ; \n + } \n + } \n + \n + public void resume ( ) { \n + if ( diskCache ! = null ) { \n + diskCache . start ( ) ; \n + } \n + } \n + \n library \ src \ com \ bumptech \ photos \ resize \ cache \ PhotoDiskCache . java \n + private final File directory ; \n + private final long maxSize ; \n + private final int appVersion ; \n + this . directory = directory ; \n + this . maxSize = maxSize ; \n + this . appVersion = appVersion ; \n + start ( ) ; \n + } \n + \n + public void start ( ) { \n + if ( cache ! = null & & ! cache . isClosed ( ) ) return ; \n + \n + public void stop ( ) { \n + if ( cache = = null ) return ; \n + \n + try { \n + cache . close ( ) ; \n + } catch ( IOException e ) { \n + e . printStackTrace ( ) ; \n + } \n + } \n + \n + if ( cache . isClosed ( ) ) { \n + Log . d ( "" DLRU : put while cache is closed ! "" ) ; \n + return ; \n + } \n + \n + if ( cache . isClosed ( ) ) { \n + Log . d ( "" DLRU : get while cache is closed key = "" + key ) ; \n + return null ; \n + } \n - Log . d ( "" DLRU : IOException ? key = "" + key ) ; \n",Add start / stop to disk cache \n If you open an already open disk cache you corrupt \n the journal which wipes the cache . This is an \n effort to avoid that behavior .,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + \n + / * * \n + * The maximum number of recycled bitmaps of any requested size to keep around . Only used if recycleBitmaps \n + * is true . A higher number means loads are more likely to be able to reuse a bitmap but also that this object \n + * will use more memory . Increase this if there are few varieties of bitmaps that will be scrolled rapidly ( ie \n + * a GridView of images with lots of columns ) , and decrease it if there are a lot of different sizes of bitmaps \n + * and limited memory is available . \n + * \n + * Defaults to 20 \n + * / \n + public int maxPerSize = 0 ; \n - bitmapCache = new SizedBitmapCache ( ) ; \n + bitmapCache = new SizedBitmapCache ( options . maxPerSize ) ; \n library \ src \ com \ bumptech \ photos \ resize \ cache \ SizedBitmapCache . java \n - private static final int MAX _ PER _ SIZE = 20 ; \n + private static final int DEFAULT _ MAX _ PER _ SIZE = 20 ; \n + private final int maxPerSize ; \n + \n + public SizedBitmapCache ( int maxPerSize ) { \n + this . maxPerSize = maxPerSize = = 0 ? DEFAULT _ MAX _ PER _ SIZE : maxPerSize ; \n + } \n - if ( available . size ( ) < MAX _ PER _ SIZE ) { \n + if ( available . size ( ) < maxPerSize ) { \n",Add an option to set max # of recycled bitmaps,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + if ( ! isInDiskCache & & useDiskCache ) { \n + putInDiskCache ( key , result ) ; \n + } \n + \n + \n - / / this is time consuming so do it after posting the result \n - if ( ! isInDiskCache & & useDiskCache ) { \n - putInDiskCache ( key , result ) ; \n - } \n",Fix a bitmap recycling issue \n Doesn ' t really speed anything up past the first \n load anyway . . .,447
"library \ src \ com \ bumptech \ photos \ resize \ HandlerExecutor . java \n - import android . os . SystemClock ; \n - private final Object token ; \n - token = hashCode ( ) ; \n - token = hashCode ( ) ; \n - worker . postAtTime ( runnable , token , SystemClock . uptimeMillis ( ) ) ; \n + worker . postAtFrontOfQueue ( runnable ) ; \n",Change handler executor to post at front of queue \n Better performance when scrolling,447
"samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Downloader . java \n + System . setProperty ( "" http . keepAlive "" , "" false "" ) ; \n + urlConnection . setDoInput ( true ) ; \n + urlConnection . setDoOutput ( false ) ; \n + urlConnection . setUseCaches ( false ) ; \n + urlConnection . setRequestProperty ( "" Connection "" , "" close "" ) ; \n + \n + urlConnection . connect ( ) ; \n",Random changes to make HttpUrlConn faster . . .,447
samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Api . java \n + import java . util . HashSet ; \n + import java . util . Set ; \n + private Set < String > downloadedFilesNames = new HashSet < String > ( ) ; \n - if ( out . exists ( ) ) { \n - cb . onDownloadComplete ( out . getPath ( ) ) ; \n + final String path = out . getPath ( ) ; \n + if ( downloadedFilesNames . contains ( path ) ) { \n + cb . onDownloadComplete ( path ) ; \n + downloadedFilesNames . add ( path ) ; \n - } \n + } \n samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Downloader . java \n + if ( output . exists ( ) ) { \n + mainHandler . post ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + cb . onDownloadReady ( output . getPath ( ) ) ; \n + } \n + } ) ; \n + return ; \n + } \n,Doing lots of io on ui thread is bad \n who knew . . .,447
"samples \ flickr \ src \ com \ bumptech \ flickr \ FlickrPathLoader . java \n - flickrApi . downloadPhoto ( model , width , height , cacheDir , new Api . PhotoCallback ( ) { \n + flickrApi . downloadPhoto ( model , cacheDir , new Api . PhotoCallback ( ) { \n samples \ flickr \ src \ com \ bumptech \ flickr \ FlickrSearchActivity . java \n - flickerApi = new Api ( ) ; \n + final Resources res = getResources ( ) ; \n + flickerApi = new Api ( res . getDimensionPixelSize ( R . dimen . large _ photo _ side ) ) ; \n - final Resources res = getResources ( ) ; \n samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Api . java \n + private final String sizeKey ; \n - public Api ( ) { \n + public Api ( int maxPhotoSize ) { \n + this . sizeKey = getSizeKey ( maxPhotoSize , maxPhotoSize ) ; \n - private static String getPhotoUrl ( Photo photo , int width , int height ) { \n - String sizeKey = getSizeKey ( width , height ) ; \n + private static String getPhotoUrl ( Photo photo , String sizeKey ) { \n - public void downloadPhoto ( Photo photo , int width , int height , File cacheDir , final PhotoCallback cb ) { \n - File out = new File ( cacheDir . getPath ( ) + File . separator + photo . id + photo . secret + width + height ) ; \n + public void downloadPhoto ( Photo photo , File cacheDir , final PhotoCallback cb ) { \n + File out = new File ( cacheDir . getPath ( ) + File . separator + photo . id + photo . secret + sizeKey ) ; \n - downloader . download ( getPhotoUrl ( photo , width , height ) , out , new Downloader . DiskCallback ( ) { \n + downloader . download ( getPhotoUrl ( photo , sizeKey ) , out , new Downloader . DiskCallback ( ) { \n","Only download photo needed by largest page \n This way we only download one image and resize it \n three times , rather than downloading ( up to ) three \n images and then resizing each one once .",447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - String path = null ; \n + Bitmap result = null ; \n - path = diskCache . get ( String . valueOf ( key ) ) ; \n + result = loadFromDiskCache ( ) ; \n - if ( cancelled ) return ; \n - \n - try { \n - if ( path ! = null ) { \n - finishResize ( resizer . loadAsIs ( path ) , true ) ; \n - } else { \n + if ( result = = null ) { \n + try { \n + } catch ( Exception e ) { \n + cb . onLoadFailed ( e ) ; \n + } \n + } else { \n + finishResize ( result , true ) ; \n + } \n + } \n + \n + private Bitmap loadFromDiskCache ( ) { \n + final String path = diskCache . get ( String . valueOf ( key ) ) ; \n + \n + Bitmap result = null ; \n + if ( path ! = null ) { \n + try { \n + result = resizer . loadAsIs ( path ) ; \n + } catch ( FileNotFoundException e ) { \n + e . printStackTrace ( ) ; \n + } \n + if ( result = = null ) { \n + diskCache . delete ( String . valueOf ( key ) ) ; \n - } catch ( Exception e ) { \n - cb . onLoadFailed ( e ) ; \n + return result ; \n library \ src \ com \ bumptech \ photos \ resize \ cache \ DiskCache . java \n - \n + public void delete ( String key ) ; \n library \ src \ com \ bumptech \ photos \ resize \ cache \ DiskCacheAdapter . java \n + \n + @ Override \n + public void delete ( String key ) { } \n library \ src \ com \ bumptech \ photos \ resize \ cache \ disk \ AndroidDiskCache . java \n - public void remove ( String key ) { \n - delete ( sha1Hash ( key ) ) ; \n + @ Override \n + public void delete ( String key ) { \n + remove ( sha1Hash ( key ) ) ; \n - private void delete ( String safeKey ) { \n + private void remove ( String safeKey ) { \n",Delete from disk cache if we fail to load a photo,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n - import static android . os . Process . THREAD _ PRIORITY _ BACKGROUND ; \n - \n - HandlerThread bgThread = new HandlerThread ( "" bg _ thread "" , THREAD _ PRIORITY _ BACKGROUND ) ; \n + HandlerThread bgThread = new HandlerThread ( "" bg _ thread "" ) ; \n",Revert running IM thread with bg priority \n Makes image loading too slow .,447
library \ src \ com \ bumptech \ photos \ resize \ ImageManager . java \n + private boolean shutdown = false ; \n + shutdown = true ; \n + if ( shutdown ) return null ; \n + \n,"Don ' t post jobs to threads after IM shuts down \n If we do , the bg thread might be dead which will \n cause an exception when we post to the bg handler .",447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - Bitmap . Config config = bitmap . getConfig ( ) ; \n - bitmap . compress ( config = = null | | config = = Bitmap . Config . ARGB _ 8888 | | config = = Bitmap . Config . ARGB _ 4444 \n - ? Bitmap . CompressFormat . PNG : Bitmap . CompressFormat . JPEG , bitmapCompressQuality , os ) ; \n + final Bitmap . Config config = bitmap . getConfig ( ) ; \n + final Bitmap . CompressFormat format ; \n + if ( config = = null | | config = = Bitmap . Config . ARGB _ 4444 | | config = = Bitmap . Config . ARGB _ 8888 ) { \n + format = Bitmap . CompressFormat . PNG ; \n + } else { \n + format = Bitmap . CompressFormat . JPEG ; \n + } \n + bitmap . compress ( format , bitmapCompressQuality , os ) ; \n",Remove ternary from logic to get compress format,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - if ( tag ! = null & & tag instanceof ImageViewTarget ) { \n + if ( tag instanceof ImageViewTarget ) { \n + if ( tag ! = null ) { \n + Log . d ( "" Replacing existing tag = "" + tag + "" on view = "" + imageView + "" with an ImageViewTarge "" ) ; \n + } \n + ImagePresenter < T > result = target . getImagePresenter ( ) ; \n + \n - ImagePresenter < T > result = target . getImagePresenter ( ) ; \n + if ( previous ! = null & & result = = null ) { \n + previous = null ; \n + } \n library \ src \ com \ bumptech \ glide \ presenter \ target \ ImageViewTarget . java \n - * A target wrapping an ImageView that makes use of { @ link ImageView # setTag ( Object ) } to store and retrieve \n - * ImagePresenters . Also obtains the runtime dimensions of the ImageView . \n + * A target wrapping an ImageView . Obtains the runtime dimensions of the ImageView . \n - / * * \n - * TODO : use { @ link View # setTag ( int , Object ) } when we can do so and still create \n - * a jar \n - * / \n library \ tests \ src \ com \ bumptech \ glide \ GlideTest . java \n + public void testClearingTagReplacesPresenter ( ) { \n + Glide . load ( "" a "" ) . into ( imageView ) ; \n + assertNotNull ( imageView . getTag ( ) ) ; \n + imageView . setTag ( null ) ; \n + Glide . load ( "" b "" ) . into ( imageView ) ; \n + } \n + \n",Don ' t throw an exception if a tag is replaced,447
"README . md \n - Glide is an image loading library for Android that wraps image loading , resizing , memory and disk caching , and bitmap recycling into one simple and easy to use interace . \n + Glide is an image loading library for Android that wraps image loading , resizing , memory and disk caching , and bitmap recycling into one simple and easy to use interface . \n - Who Shouldn ' t Use Glide ? \n + Who shouldn ' t use Glide ? \n - - - - - - - - - - - - - - - - - - - - - - - - \n - Glide is also focused primarily on loading images from the sdcard efficiently and does not currently include code to download images from a URL ( though that code does exist in the sample project ) . \n - \n - Who Should Use Glide ? \n + Who should use Glide ? \n - - - - - - - - - - - - - - - - - - - - - \n - How Do I Use Glide ? \n + How do I use Glide ? \n - - - - - - - - - - - - - - - - - - - \n - For more examples see the sample flickr app . \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - Glide is an Androlid library project so its fairly straightforward to add it . Either add this repo as a submodule or otherwise check out this repository in your project and then follow the steps in the Android docs to add it as a library project : http : / / developer . android . com / tools / projects / projects - cmdline . html # ReferencingLibraryProject \n + Glide is an Android library project so its fairly straightforward to add it . Either add this repo as a submodule or otherwise check out this repository in your project and then follow the steps in the Android docs to add it as a library project : http : / / developer . android . com / tools / projects / projects - cmdline . html # ReferencingLibraryProject \n + Great , but how do I actually use Glide in my code ? \n + - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n + For more concrete examples see the wiki for tutorials and / or the sample flickr app . \n + \n - - - - - - \n",Update and fix some typos in read me,447
"library \ src \ com \ bumptech \ photos \ resize \ ImageResizer . java \n - if ( is ! = null ) { \n + if ( is ! = null ) { \n - \n - \n - / / shrinks to the given width , shrinking the height to maintain the original image proportions \n - \n - / * * \n + / * * \n - } \n - \n - \n - \n - \n + } \n",Code cleanup ( spacing / old comments etc ),447
"library \ src \ com \ bumptech \ glide \ resize \ RecyclableBufferedInputStream . java \n + \n + public static class InvalidMarkException extends RuntimeException { \n + public InvalidMarkException ( String detailMessage ) { \n + super ( detailMessage ) ; \n + } \n + } \n + \n - throw new IOException ( "" Mark has been invalidated . "" ) ; \n + throw new InvalidMarkException ( "" Mark has been invalidated "" ) ; \n",Throw a particular exception if mark is invalid \n Will make logging easier,447
"samples \ flickr \ src \ com \ bumptech \ flickr \ api \ Api . java \n + import java . util . Collections ; \n - put ( 500 , "" - "" ) ; \n - put ( Integer . MAX _ VALUE , "" o "" ) ; \n + \n + private static final List < Integer > SORTED _ SIZE _ KEYS = new ArrayList < Integer > ( EDGE _ TO _ SIZE _ KEY . size ( ) ) ; \n + static { \n + SORTED _ SIZE _ KEYS . addAll ( EDGE _ TO _ SIZE _ KEY . keySet ( ) ) ; \n + Collections . sort ( SORTED _ SIZE _ KEYS ) ; \n + } \n - final int largestEdge = width > height ? width : height ; \n + final int largestEdge = Math . max ( width , height ) ; \n - final String result = EDGE _ TO _ SIZE _ KEY . get ( Integer . MAX _ VALUE ) ; \n - for ( int edge : EDGE _ TO _ SIZE _ KEY . keySet ( ) ) { \n + String result = EDGE _ TO _ SIZE _ KEY . get ( SORTED _ SIZE _ KEYS . get ( SORTED _ SIZE _ KEYS . size ( ) - 1 ) ) ; \n + for ( int edge : SORTED _ SIZE _ KEYS ) { \n - return EDGE _ TO _ SIZE _ KEY . get ( edge ) ; \n + result = EDGE _ TO _ SIZE _ KEY . get ( edge ) ; \n + break ; \n",Fix flickr api return url for incorrect image size \n HashMap . keySet is not ordered : (,447
"library \ src \ com \ bumptech \ glide \ resize \ ImageManager . java \n - private final Bitmap . CompressFormat bitmapCompressFormat ; \n + @ Deprecated \n + \n + * < p > \n + * Note - this call will now be ignored , ARGB _ 8888 bitmaps will be saved as PNGs , and all other formats \n + * will be saved as jpegs . \n + * < / p > \n + * \n + @ Deprecated \n + * < Note > \n + * This will only apply to bitmaps saved to the disk cache as JPEGs ( bitmaps with the RGB _ 565 config ) \n + * < / Note > \n + * \n - bitmapCompressFormat = builder . bitmapCompressFormat ; \n library \ src \ com \ bumptech \ glide \ resize \ load \ ImageResizer . java \n + @ Deprecated \n + @ Deprecated \n",Add some deprecation warnings and comments \n Goal will be to include a more accurate api that \n allows you to set only options Glide / the image \n resizer will actually pay attention to in the \n future .,447
"library \ src \ com \ bumptech \ glide \ Glide . java \n - import java . lang . ref . WeakReference ; \n - private final WeakHashMap < ImageView , WeakReference < ImageViewTarget > > imageViewToTarget = \n - new WeakHashMap < ImageView , WeakReference < ImageViewTarget > > ( ) ; \n - final WeakReference < ImageViewTarget > ref = imageViewToTarget . get ( imageView ) ; \n - return ref ! = null ? ref . get ( ) : null ; \n + Object tag = imageView . getTag ( ) ; \n + final ImageViewTarget result ; \n + if ( tag ! = null & & tag instanceof ImageViewTarget ) { \n + result = ( ImageViewTarget ) tag ; \n + } else { \n + result = null ; \n + } \n + return result ; \n - imageViewToTarget . put ( imageView , new WeakReference < ImageViewTarget > ( result ) ) ; \n + imageView . setTag ( result ) ; \n library \ src \ com \ bumptech \ glide \ presenter \ target \ ImageViewTarget . java \n + private ImagePresenter imagePresenter ; \n - imageView . setTag ( imagePresenter ) ; \n + this . imagePresenter = imagePresenter ; \n - Object tag = imageView . getTag ( ) ; \n - ImagePresenter result = null ; \n - if ( tag instanceof ImagePresenter ) { \n - result = ( ImagePresenter ) tag ; \n - } \n - return result ; \n + return imagePresenter ; \n library \ tests \ src \ com \ bumptech \ glide \ GlideTest . java \n + import com . bumptech . glide . presenter . target . ImageViewTarget ; \n - return ( ImagePresenter ) imageView . getTag ( ) ; \n + return ( ( ImageViewTarget ) imageView . getTag ( ) ) . getImagePresenter ( ) ; \n",Set target as tag instead of ImagePresenter \n allows us to remove an uneccessary map,447
"library \ src \ com \ bumptech \ glide \ presenter \ ImagePresenter . java \n + private boolean isErrorSet = false ; \n + \n + isErrorSet = false ; \n - if ( ! isImageSet ) { \n + if ( ! isImageSet & & ! isErrorSet ) { \n + isErrorSet = false ; \n + isErrorSet = true ; \n library \ tests \ src \ com \ bumptech \ glide \ ImagePresenterTest . java \n + import android . graphics . drawable . Drawable ; \n + import com . bumptech . glide . loader . image . ImageLoader ; \n + import com . bumptech . glide . loader . image . ImageManagerLoader ; \n + import com . bumptech . glide . loader . model . ModelLoader ; \n + import com . bumptech . glide . loader . stream . StreamLoader ; \n + import com . bumptech . glide . resize . load . Transformation ; \n + \n + public void testErrorPlaceholderIsSetOnException ( ) { \n + Drawable errorDrawable = new ColorDrawable ( Color . RED ) ; \n + ImagePresenter < Object > imagePresenter = new ImagePresenter . Builder < Object > ( ) \n + . setImageView ( imageView ) \n + . setModelLoader ( new ModelLoader < Object > ( ) { \n + @ Override \n + public StreamLoader getStreamLoader ( Object model , int width , int height ) { \n + return new StreamLoader ( ) { \n + @ Override \n + public void loadStream ( StreamReadyCallback cb ) { \n + } \n + \n + @ Override \n + public void cancel ( ) { \n + } \n + } ; \n + } \n + \n + @ Override \n + public String getId ( Object model ) { \n + return model . toString ( ) ; \n + } \n + } ) \n + . setImageLoader ( new ImageLoader ( ) { \n + @ Override \n + public Object fetchImage ( String id , StreamLoader streamLoader , Transformation transformation , int width , int height , ImageReadyCallback cb ) { \n + cb . onException ( new Exception ( "" Test "" ) ) ; \n + return null ; \n + } \n + \n + @ Override \n + public void clear ( ) { } \n + } ) \n + . setErrorDrawable ( errorDrawable ) \n + . build ( ) ; \n + \n + assertNull ( imageView . getDrawable ( ) ) ; \n + imagePresenter . setModel ( new Object ( ) ) ; \n + assertEquals ( errorDrawable , imageView . getDrawable ( ) ) ; \n + } \n",Fix error replaced with standard placeholder \n Only occurs when exception occurs synchronously,447
kotlin - native \ konan \ konan . properties \n - clangFlags . linux _ mipsel32 = - cc1 - emit - obj - disable - llvm - optzns - x ir - target - cpu targetCpu . linux _ mipsel32 \n + clangFlags . linux _ mipsel32 = - cc1 - emit - obj - disable - llvm - optzns - x ir - target - cpu $ targetCpu . linux _ mipsel32 \n - clangFlags . android _ x86 = - cc1 - target - cpu targetCpu . android _ x86 - emit - obj - disable - llvm - passes - x ir - femulated - tls - mrelocation - model pic \n + clangFlags . android _ x86 = - cc1 - target - cpu $ targetCpu . android _ x86 - emit - obj - disable - llvm - passes - x ir - femulated - tls - mrelocation - model pic \n,[ konan . properties ] Add missing sigil,458
"kotlin - native \ konan \ konan . properties \n - - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle - - no - threads \n + - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle \n - - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle - - no - threads \n + - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle \n - - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle - - no - threads \n + - - defsym _ _ cxa _ demangle = Konan _ cxa _ demangle \n kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ Linker . kt \n - private val linker = "" $ absoluteLlvmHome / bin / ld . lld "" \n + \n + / / TODO : Control via properties . \n + val ( linker , linkerSpecificFlags ) = when { \n + HostManager . hostIsMac - > "" $ absoluteLlvmHome / bin / ld . lld "" to listOf ( "" - - no - threads "" ) \n + else - > "" $ absoluteTargetToolchain / bin / ld . gold "" to emptyList ( ) \n + } \n + "" - - build - id "" \n + "" - - eh - frame - hdr "" \n + "" - dynamic - linker "" \n + linkerSpecificFlags . forEach { + it } \n + dynamicLinker \n + "" - o "" \n + executable \n","Use gold linker instead of lld on Windows and Linux \n lld is doing something wrong for linux _ arm32 _ hfp and linux _ arm64 targets , so we fallback to gold linker on Linux and Windows . \n See KT - 41725 and KT - 42446",458
"kotlin - native \ konan \ konan . properties \n + # targetSysRoot relative \n + crtFilesLocation . linux _ x64 = usr / lib \n + # targetSysRoot relative \n + crtFilesLocation . linux _ arm32 _ hfp = usr / lib \n + # targetSysRoot relative \n + crtFilesLocation . linux _ arm64 = usr / lib \n + # targetSysRoot relative \n + crtFilesLocation . linux _ mips32 = usr / lib \n + # targetSysRoot relative \n + crtFilesLocation . linux _ mipsel32 = usr / lib \n kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ Configurables . kt \n + val crtFilesLocation get ( ) = targetString ( "" crtFilesLocation "" ) ! ! \n kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ Linker . kt \n - val crtPrefix = when ( val bitness = configurables . target . architecture . bitness ) { \n - 32 - > "" usr / lib "" \n - 64 - > "" usr / lib64 "" \n - else - > error ( "" Unexpected target bitness : $ bitness "" ) \n - } \n + val crtPrefix = "" $ absoluteTargetSysRoot / $ crtFilesLocation "" \n + "" - - sysroot = $ { absoluteTargetSysRoot } "" \n + dynamicLinker \n + "" - o "" \n + executable \n - if ( ! dynamic ) + "" $ absoluteTargetSysRoot / $ crtPrefix / crt1 . o "" \n - + "" $ absoluteTargetSysRoot / $ crtPrefix / crti . o "" \n + if ( ! dynamic ) + "" $ crtPrefix / crt1 . o "" \n + + "" $ crtPrefix / crti . o "" \n + if ( dynamic ) "" $ libGcc / crtbeginS . o "" else "" $ libGcc / crtbegin . o "" \n + "" - L $ libGcc "" \n + linkerKonanFlags \n + linkerGccFlags \n + if ( dynamic ) "" $ libGcc / crtendS . o "" else "" $ libGcc / crtend . o "" \n - + "" $ absoluteTargetSysRoot / $ crtPrefix / crtn . o "" \n + + "" $ crtPrefix / crtn . o "" \n + libraries \n + linkerArgs \n",Move crt * files location to konan . properties,458
"kotlin - native \ backend . native \ cli . bc \ src \ org \ jetbrains \ kotlin \ cli \ bc \ K2Native . kt \n + putIfNotNull ( OVERRIDE _ KONAN _ PROPERTIES , parseOverrideKonanProperties ( arguments , configuration ) ) \n + private fun parseOverrideKonanProperties ( \n + arguments : K2NativeCompilerArguments , \n + configuration : CompilerConfiguration \n + ) : Map < String , String > ? = \n + arguments . overrideKonanProperties ? . mapNotNull { \n + val keyValueSeparatorIndex = it . indexOf ( ' = ' ) \n + if ( keyValueSeparatorIndex > 0 ) { \n + it . substringBefore ( ' = ' ) to it . substringAfter ( ' = ' ) \n + } else { \n + configuration . report ( \n + ERROR , \n + "" incorrect property format : expected ' < key > = < value > ' , got ' $ it ' "" \n + ) \n + null \n + } \n + } ? . toMap ( ) \n + \n + \n kotlin - native \ backend . native \ cli . bc \ src \ org \ jetbrains \ kotlin \ cli \ bc \ K2NativeCompilerArguments . kt \n + / / We use ` ; ` as delimiter because properties may contain comma - separated values . \n + / / For example , target cpu features . \n + @ Argument ( \n + value = "" - Xoverride - konan - properties "" , \n + valueDescription = "" key1 = value1 ; key2 = value2 ; . . . "" , \n + description = "" Override konan . properties . values "" , \n + delimiter = "" ; "" \n + ) \n + var overrideKonanProperties : Array < String > ? = null \n + \n kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ KonanConfig . kt \n - configuration . get ( KonanConfigKeys . RUNTIME _ FILE ) \n + configuration . get ( KonanConfigKeys . RUNTIME _ FILE ) , \n + configuration . get ( KonanConfigKeys . OVERRIDE _ KONAN _ PROPERTIES ) \n kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ KonanConfigurationKeys . kt \n + val OVERRIDE _ KONAN _ PROPERTIES : CompilerConfigurationKey < Map < String , String > > \n + = CompilerConfigurationKey . create ( "" override konan . properties values "" ) \n","[ KT - 40670 ] Allow override konan . properties \n It is painful to edit konan . properties just to override some value ( e . g . compiler flags or LLVM location ) , especially if it is needed only in a single project . Thus ` - Xoverride - konan - properties ` is added .",458
"kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ OptimizationPipeline . kt \n - \n + context . log { \n + "" "" "" \n + Running LLVM optimizations with the following parameters : \n + target _ triple : $ { config . targetTriple } \n + cpu _ model : $ { config . cpuModel } \n + cpu _ features : $ { config . cpuFeatures } \n + optimization _ level : $ { config . optimizationLevel . value } \n + size _ level : $ { config . sizeLevel . value } \n + inline _ threshold : $ { config . customInlineThreshold ? : "" default "" } \n + "" "" "" . trimIndent ( ) \n + } \n",[ LLVM ] [ Optimizations ] Add verbose output \n Verbose output allows to observe ` - Xoverride - konan - properties ` changes .,458
kotlin - native \ build - tools \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ KotlinNativeTest . kt \n - writeText ( it . stdErr ) \n + appendText ( it . stdErr ) \n,[ Tests ] fix compilation . log contents \n Do not override stdout because we want to check output of both streams .,458
"kotlin - native \ backend . native \ tests \ build . gradle \n + task override _ konan _ properties0 ( type : KonanDriverTest ) { \n + \n + def overrides = PlatformInfo . isWindows ( ) \n + ? ' - Xoverride - konan - properties = "" llvmInlineThreshold = 76 "" ' \n + : ' - Xoverride - konan - properties = llvmInlineThreshold = 76 ' \n + flags = [ \n + "" - opt "" , \n + "" - Xverbose - phases = BitcodeOptimization "" , \n + overrides \n + ] \n + compilerMessages = true \n + source = "" link / ir _ providers / hello . kt "" \n + def messages = \n + "" inline _ threshold : 76 \ n "" + \n + "" hello \ n "" \n + goldValue = PlatformInfo . isWindows ( ) ? messages . replaceAll ( ' \ \ / ' , ' \ \ \ \ ' ) : messages \n + outputChecker = { out - > \n + goldValue . split ( "" \ n "" ) \n + . collect { line - > out . contains ( line ) } \n + . every { it = = true } \n + } \n + } \n + \n",Add a test for - Xoverride - konan - properties \n Add a trivial test that checks that ` - Xoverride - konan - properties ` overrides corresponding properties of LLVM optimization pipeline .,458
"kotlin - native \ HACKING . md \n - or pass an absolute to your own distribution . \n + or pass an absolute to your own distribution . \n + # # # # Example . Using LLVM from an absolute path . \n + Assuming LLVM distribution is installed at ` / usr ` path , one can specify a path to it \n + with the ` - Xoverride - konan - properties ` option : \n + ` ` ` \n + konanc main . kt - Xoverride - konan - properties = llvmHome . linux _ x64 = / usr \n + ` ` ` \n + \n - By default , compiler takes options for Clang from [ konan . properties ] ( konan / konan . properties ) file \n - by combining ` clangFlags . < TARGET > ` and ` clang < Noopt / Opt / Debug > Flags . < TARGET > ` properties . \n - To override this behaviour , one can specify flag ` - Xoverride - clang - options = < arg1 , . . . , argN > ` . \n + Compiler takes options for Clang from [ konan . properties ] ( konan / konan . properties ) file \n + by combining ` clangFlags . < TARGET > ` and ` clang < Noopt / Opt / Debug > Flags . < TARGET > ` properties . \n + Use ` - Xoverride - konan - properties = < key _ 1 = value _ 1 ; . . . ; key _ n = value _ n > ` flag to override default values . \n - 2 . ` - c ` should be passed because Kotlin / Native calls linker by itself . \n - \n + 2 . ` - cc1 - emit - obj ` should be passed because Kotlin / Native calls linker by itself . \n + 3 . Use ` clang - cc1 - help ` to see a list of available options . \n + \n - \n - konanc main . kt - Xdisable - phases = BitcodeOptimization - Xoverride - clang - options = - c , - O2 \n + CLANG _ FLAGS = "" clangFlags . macos _ x64 = - cc1 - emit - obj ; clangNooptFlags . macos _ x64 = - O2 "" \n + konanc main . kt - Xdisable - phases = BitcodeOptimization - Xoverride - konan - properties = "" $ CLANG _ FLAGS "" \n",Mention ` - Xoverride - konan - properties ` in HACKING . md,458
"kotlin - native \ backend . native \ tests \ build . gradle \n + createInterop ( "" objcKt43517 "" ) { \n + it . defFile ' framework / kt43517 / kt43517 . def ' \n + } \n + \n + frameworkTest ( "" testKt43517Framework "" ) { \n + framework ( ' Kt43517 ' ) { \n + sources = [ ' framework / kt43517 ' ] \n + library = ' objcKt43517 ' \n + } \n + swiftSources = [ ' framework / kt43517 / ' ] \n + } \n new file \n kotlin - native \ backend . native \ tests \ framework \ kt43517 \ kt43517 . def \n + - - - \n + enum E { \n + A , B , C \n + } ; \n + \n + struct S { \n + int i ; \n + float f ; \n + } ; \n + \n + struct S globalS = { . i = 3 , . f = 3 . 14f } ; \n + \n + enum E createEnum ( ) { \n + return A ; \n + } \n new file \n kotlin - native \ backend . native \ tests \ framework \ kt43517 \ kt43517 . kt \n + import kt43517 . * \n + \n + fun produceEnum ( ) : E = \n + createEnum ( ) \n + \n + fun compareEnums ( e1 : E , e2 : E ) : Boolean = \n + e1 = = e2 \n + \n + fun getFirstField ( s : S ) : Int = \n + s . i \n + \n + fun getGlobalS ( ) : S = \n + globalS \n new file \n kotlin - native \ backend . native \ tests \ framework \ kt43517 \ kt43517 . swift \n + import Foundation \n + import Kt43517 \n + \n + func testKt43517 ( ) throws { \n + try assertEquals ( \n + actual : Kt43517Kt . compareEnums ( e1 : Kt43517Kt . produceEnum ( ) , e2 : Kt43517Kt . produceEnum ( ) ) , \n + expected : true \n + ) \n + try assertEquals ( \n + actual : Kt43517Kt . getFirstField ( s : Kt43517Kt . getGlobalS ( ) ) , \n + expected : 3 \n + ) \n + } \n + \n + class Kt43517Tests : TestProvider { \n + var tests : [ TestCase ] = [ ] \n + \n + init ( ) { \n + providers . append ( self ) \n + tests = [ \n + TestCase ( name : "" Kt43517 "" , method : withAutorelease ( testKt43517 ) ) , \n + ] \n + } \n + } \n",Add test for KT - 43517 and KT - 43530,458
"new file \n kotlin - native \ licenses \ third _ party \ zlib _ license . txt \n + zlib . h - - interface of the ' zlib ' general purpose compression library \n + version 1 . 2 . 11 , January 15th , 2017 \n + \n + Copyright ( C ) 1995 - 2017 Jean - loup Gailly and Mark Adler \n + \n + This software is provided ' as - is ' , without any express or implied \n + warranty . In no event will the authors be held liable for any damages \n + arising from the use of this software . \n + \n + Permission is granted to anyone to use this software for any purpose , \n + including commercial applications , and to alter it and redistribute it \n + freely , subject to the following restrictions : \n + \n + 1 . The origin of this software must not be misrepresented ; you must not \n + claim that you wrote the original software . If you use this software \n + in a product , an acknowledgment in the product documentation would be \n + appreciated but is not required . \n + 2 . Altered source versions must be plainly marked as such , and must not be \n + misrepresented as being the original software . \n + 3 . This notice may not be removed or altered from any source distribution . \n + \n + Jean - loup Gailly Mark Adler \n + jloup @ gzip . org madler @ alumni . caltech . edu \n",Add license for zlib \n We need to use a glibc - 2 . 25 - based because ` target - sysroot - 1 - linux - glibc - arm64 ` is using one . \n zzzz,458
new file \n kotlin - native \ platformLibs \ src \ platform \ tvos \ _ StoreKit _ SwiftUI . def . disabled \n + language = Objective - C \n + package = platform . _ StoreKit _ SwiftUI \n + \n + modules = _ StoreKit _ SwiftUI \n + compilerOpts = - framework _ StoreKit _ SwiftUI \n + linkerOpts = - framework _ StoreKit _ SwiftUI \n + # Disabled : Unavailable \n,[ Xcode 12 . 2 ] Updated tvos frameworks,458
new file \n kotlin - native \ platformLibs \ src \ platform \ watchos \ _ StoreKit _ SwiftUI . def . disabled \n + language = Objective - C \n + package = platform . _ StoreKit _ SwiftUI \n + \n + modules = _ StoreKit _ SwiftUI \n + compilerOpts = - framework _ StoreKit _ SwiftUI \n + linkerOpts = - framework _ StoreKit _ SwiftUI \n + # Disabled : Unavailable \n,[ Xcode 12 . 2 ] Updated watchos frameworks,458
"libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ dsl \ KotlinTargetContainerWithNativeShortcuts . kt \n - val simulator = watchosX86 ( "" $ { namePrefix } X86 "" ) \n + val simulator = watchosX64 ( "" $ { namePrefix } X64 "" ) \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ targets \ native \ internal \ KotlinNativePlatformDependencies . kt \n - * watchosMain [ commonized targets : watchosX86 , watchosArm32 , watchosArm64 ] \n + * watchosMain [ commonized targets : watchosX64 , watchosArm32 , watchosArm64 ] \n - * watchosX86Main watchosDeviceMain [ commonized targets : watchosArm32 , watchosArm64 ] \n + * watchosX64Main watchosDeviceMain [ commonized targets : watchosArm32 , watchosArm64 ] \n - * Thus , it has three commonized targets : watchosX86 , watchosArm32 and watchosArm64 . \n + * Thus , it has three commonized targets : watchosX64 , watchosArm32 and watchosArm64 . \n - * produced as a result of commonization of the three targets : watchosX86 , watchosArm32 and watchosArm64 . \n + * produced as a result of commonization of the three targets : watchosX64 , watchosArm32 and watchosArm64 . \n",[ KT - 43276 ] Fix ` watchos ` target shortcut .,458
"build . gradle . kts \n - extra [ "" versions . kotlin - native "" ] = "" 1 . 4 . 30 - dev - 17200 "" \n + extra [ "" versions . kotlin - native "" ] = "" 1 . 4 . 30 - dev - 17395 "" \n",Bump to native version version with watchos _ x64 enabled,458
"kotlin - native \ konan \ konan . properties \n - gccToolchain . mingw _ x64 = target - gcc - toolchain - 3 - linux - x86 - 64 \n - gccToolchain . macos _ x64 = target - gcc - toolchain - 3 - linux - x86 - 64 \n + gccToolchain . linux _ arm32 _ hfp = target - gcc - toolchain - 3 - linux - x86 - 64 \n + \n + gccToolchain . linux _ arm64 = target - gcc - toolchain - 3 - linux - x86 - 64 \n + \n + gccToolchain . linux _ mips32 = target - gcc - toolchain - 3 - linux - x86 - 64 \n + \n + gccToolchain . linux _ mipsel32 = target - gcc - toolchain - 3 - linux - x86 - 64 \n + \n kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ Configurables . kt \n - val gccToolchain get ( ) = hostString ( "" gccToolchain "" ) \n + val gccToolchain get ( ) = targetString ( "" gccToolchain "" ) \n","[ konan . properties ] Make gccToolchain a target property \n Previously , we used the same gccToolchain for all linux - based targets . It is dangerous because sysroot and toolchain might be incompatible . Since c82b843e we moved to unified and reproducible way to build toolchains , so we have a separate gccToolchain for each target .",458
"kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ ClangArgs . kt \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - isysroot "" , absoluteTargetSysRoot , \n + "" - - sysroot = $ absoluteTargetSysRoot "" , \n",[ ClangArgs ] use - - sysroot for all targets \n Change ` - isysroot ` to ` - - sysroot ` because it is the same thing on darwin targets .,458
"kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ ClangArgs . kt \n - \n + val hasCustomSysroot = configurables is ZephyrConfigurables \n + | | configurables is WasmConfigurables \n + | | configurables is AndroidConfigurables \n + if ( ! hasCustomSysroot ) { \n + when ( configurables ) { \n + / / isysroot and sysroot on darwin are _ almost _ synonyms . \n + / / The first one parses SDKSettings . json while second one is not . \n + is AppleConfigurables - > add ( listOf ( "" - isysroot "" , absoluteTargetSysRoot ) ) \n + else - > add ( listOf ( "" - - sysroot = $ absoluteTargetSysRoot "" ) ) \n + } \n + \n + } \n - KonanTarget . LINUX _ X64 - > listOf ( \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - ) \n + KonanTarget . LINUX _ X64 - > listOf ( ) \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , "" - Xclang "" , \n - "" - flto - visibility - public - std "" \n + "" - Xclang "" , "" - flto - visibility - public - std "" \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n - "" - - sysroot = $ absoluteTargetSysRoot "" , \n",[ ClangArgs ] Move sysroot setting to single place,458
"kotlin - native \ konan \ konan . properties \n - - Xclang - flto - visibility - public - std - Wl , - - dynamicbase \ \n + - Wl , - - dynamicbase \ \n - Wl , - Bstatic , - - whole - archive - lwinpthread - Wl , - - no - whole - archive , - Bdynamic \ \n - Wl , - - defsym , _ _ cxa _ demangle = Konan _ cxa _ demangle \n - - Xclang - flto - visibility - public - std - Wl , - - dynamicbase \ \n + - Wl , - - dynamicbase \ \n - Wl , - Bstatic , - - whole - archive - lwinpthread - Wl , - - no - whole - archive , - Bdynamic \ \n - Wl , - - defsym , _ _ _ cxa _ demangle = _ Konan _ cxa _ demangle \n kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ ClangArgs . kt \n - KonanTarget . LINUX _ X64 - > listOf ( ) \n + KonanTarget . LINUX _ X64 - > emptyList ( ) \n - KonanTarget . MINGW _ X64 , KonanTarget . MINGW _ X86 - > listOf ( \n - "" - Xclang "" , "" - flto - visibility - public - std "" \n - ) \n + KonanTarget . MINGW _ X64 , KonanTarget . MINGW _ X86 - > emptyList ( ) \n",[ MinGW ] remove obsolete flag \n See https : / / github . com / msys2 / MINGW - packages / issues / 5321,458
kotlin - native \ konan \ konan . properties \n - gccToolchain . linux _ x64 = target - gcc - toolchain - 3 - linux - x86 - 64 \n - targetToolchain . linux _ x64 = target - gcc - toolchain - 3 - linux - x86 - 64 / x86 _ 64 - unknown - linux - gnu \n + gccToolchain . linux _ x64 = x86 _ 64 - unknown - linux - gnu - gcc - 8 . 3 . 0 - glibc - 2 . 19 - kernel - 4 . 9 \n + targetToolchain . linux _ x64 = $ gccToolchain . linux _ x64 / x86 _ 64 - unknown - linux - gnu \n - target - gcc - toolchain - 3 - linux - x86 - 64 \ \n + x86 _ 64 - unknown - linux - gnu - gcc - 8 . 3 . 0 - glibc - 2 . 19 - kernel - 4 . 9 \ \n - target - gcc - toolchain - 3 - linux - x86 - 64 \n + x86 _ 64 - unknown - linux - gnu - gcc - 8 . 3 . 0 - glibc - 2 . 19 - kernel - 4 . 9 \n - target - gcc - toolchain - 3 - linux - x86 - 64 \n + x86 _ 64 - unknown - linux - gnu - gcc - 8 . 3 . 0 - glibc - 2 . 19 - kernel - 4 . 9 \n - targetSysRoot . linux _ x64 = target - gcc - toolchain - 3 - linux - x86 - 64 / x86 _ 64 - unknown - linux - gnu / sysroot \n + targetSysRoot . linux _ x64 = $ gccToolchain . linux _ x64 / x86 _ 64 - unknown - linux - gnu / sysroot \n - libGcc . linux _ x64 = . . / . . / lib / gcc / x86 _ 64 - unknown - linux - gnu / 4 . 8 . 5 \n + libGcc . linux _ x64 = . . / . . / lib / gcc / x86 _ 64 - unknown - linux - gnu / 8 . 3 . 0 \n,[ linux _ x64 ] Update toolchain \n Use the one built from c82b843e,458
"kotlin - native \ build - tools \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ ExecutorService . kt \n - return when ( testTarget ) { \n + return if ( project . hasProperty ( "" remote "" ) ) { \n + sshExecutor ( project ) \n + } else when ( testTarget ) { \n - else - > { \n - if ( project . hasProperty ( "" remote "" ) ) sshExecutor ( project ) \n - else localExecutorService ( project ) \n - } \n + else - > localExecutorService ( project ) \n",Fix running tests on remote Raspberry Pi .,458
kotlin - native \ backend . native \ tests \ build . gradle \n - ( project . testTarget = = ' linux _ mipsel32 ' ) \n + ( project . testTarget = = ' linux _ mipsel32 ' ) | | \n + ( project . testTarget = = ' linux _ arm32 _ hfp ' ) | | \n + ( project . testTarget = = ' linux _ arm64 ' ) \n,Fix tests on qemu - arm and qemu - aarch64,458
"kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ llvm \ BinaryInterface . kt \n - fun IrFunction . computeSymbolName ( ) = with ( KonanBinaryInterface ) { symbolName } \n + fun IrFunction . computeSymbolName ( ) = with ( KonanBinaryInterface ) { symbolName } . replaceSpecialSymbols ( ) \n - fun IrField . computeSymbolName ( ) = with ( KonanBinaryInterface ) { symbolName } \n + fun IrField . computeSymbolName ( ) = with ( KonanBinaryInterface ) { symbolName } . replaceSpecialSymbols ( ) \n - fun IrClass . computeTypeInfoSymbolName ( ) = with ( KonanBinaryInterface ) { typeInfoSymbolName } \n + fun IrClass . computeTypeInfoSymbolName ( ) = with ( KonanBinaryInterface ) { typeInfoSymbolName } . replaceSpecialSymbols ( ) \n + \n + private fun String . replaceSpecialSymbols ( ) = \n + / / ' @ ' is used for symbol versioning in GCC : https : / / gcc . gnu . org / wiki / SymbolVersioning . \n + this . replace ( "" @ "" , "" _ _ at _ _ "" ) \n",Replace ' @ ' with ' _ ' in binary symbol names . \n ' @ ' symbol is used for symbol versioning in GCC \n which leads to compilation errors in case of compiler caches usage .,458
kotlin - native \ konan \ konan . properties \n + executableRelocationMode . linux _ mips32 = static \n,Fix compilation of executable for linux _ mips32,458
kotlin - native \ build - tools \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ MPPTools . kt \n - . takeIf { useCache & & PlatformInfo . isMac ( ) } / / TODO : remove target condition when we have cache support for other targets . \n + . takeIf { useCache & & ! PlatformInfo . isWindows ( ) } / / TODO : remove target condition when we have cache support for other targets . \n,Use caches for linux _ x64 compile - only benchmarks,458
"build . gradle . kts \n - extra [ "" versions . kotlin - native "" ] = "" 1 . 4 . 30 - dev - 17395 "" \n + extra [ "" versions . kotlin - native "" ] = "" 1 . 5 - dev - 17775 "" \n",Bump Native version . \n The new one has ` cacheableTargets ` property \n in konan . properties that is now required \n for native caches support in Gradle .,458
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ native \ NativePlatformLibsIT . kt \n - buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind = static "" ) { \n + buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind . ios _ x64 = static "" ) { \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ resources \ testProject \ native - cocoapods - multiple \ kotlin - library \ gradle . properties \n - kotlin . native . cacheKind = none \n + kotlin . native . cacheKind . ios _ x64 = none \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ resources \ testProject \ native - cocoapods - multiple \ second - library \ gradle . properties \n - kotlin . native . cacheKind = none \n + kotlin . native . cacheKind . ios _ x64 = none \n",Use target - specific cache control in tests,458
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ native \ NativePlatformLibsIT . kt \n - / / Currently we can generate caches only for macos _ x64 and ios _ x64 . \n - Assume . assumeTrue ( HostManager . hostIsMac ) \n + / / There are no cacheable targets on MinGW for now . \n + Assume . assumeFalse ( HostManager . hostIsMingw ) \n - with ( platformLibrariesProject ( "" iosX64 "" ) ) { \n - / / Build Mac libraries without caches . \n - buildWithLightDist ( "" tasks "" ) { \n - assertSuccessful ( ) \n - assertContains ( "" Generate platform libraries for ios _ x64 "" ) \n - } \n + fun buildPlatformLibrariesWithoutAndWithCaches ( target : KonanTarget ) { \n + with ( platformLibrariesProject ( target . presetName ) ) { \n + val targetName = target . name \n + / / Build libraries without caches . \n + buildWithLightDist ( "" tasks "" ) { \n + assertSuccessful ( ) \n + assertContains ( "" Generate platform libraries for $ targetName "" ) \n + } \n - / / Change cache kind and check that platform libraries generator was executed . \n - buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind . ios _ x64 = static "" ) { \n - assertSuccessful ( ) \n - assertContains ( "" Precompile platform libraries for ios _ x64 ( precompilation : static ) "" ) \n + / / Change cache kind and check that platform libraries generator was executed . \n + buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind . $ targetName = static "" ) { \n + assertSuccessful ( ) \n + assertContains ( "" Precompile platform libraries for $ targetName ( precompilation : static ) "" ) \n + } \n + when { \n + HostManager . hostIsMac - > buildPlatformLibrariesWithoutAndWithCaches ( KonanTarget . IOS _ X64 ) \n + HostManager . hostIsLinux - > buildPlatformLibrariesWithoutAndWithCaches ( KonanTarget . LINUX _ X64 ) \n + } \n",Test caches for linux _ x64 on Linux host .,458
"libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ kotlin \ org \ jetbrains \ kotlin \ gradle \ native \ NativePlatformLibsIT . kt \n - with ( platformLibrariesProject ( target . presetName ) ) { \n - val targetName = target . name \n + val presetName = target . presetName \n + val targetName = target . name \n + with ( platformLibrariesProject ( presetName ) ) { \n - buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind . $ targetName = static "" ) { \n + buildWithLightDist ( "" tasks "" , "" - Pkotlin . native . cacheKind . $ presetName = static "" ) { \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ resources \ testProject \ native - cocoapods - multiple \ kotlin - library \ gradle . properties \n - kotlin . native . cacheKind . ios _ x64 = none \n + kotlin . native . cacheKind . iosX64 = none \n libraries \ tools \ kotlin - gradle - plugin - integration - tests \ src \ test \ resources \ testProject \ native - cocoapods - multiple \ second - library \ gradle . properties \n - kotlin . native . cacheKind . ios _ x64 = none \n + kotlin . native . cacheKind . iosX64 = none \n libraries \ tools \ kotlin - gradle - plugin \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ gradle \ plugin \ KotlinProperties . kt \n + import org . jetbrains . kotlin . konan . target . presetName \n - property ( "" kotlin . native . cacheKind . $ { target . name } "" ) ? . let { NativeCacheKind . byCompilerArgument ( it ) } \n + property ( "" kotlin . native . cacheKind . $ { target . presetName } "" ) ? . let { NativeCacheKind . byCompilerArgument ( it ) } \n",Use camelCase for cacheKind control property \n Because it is more intuitive for end - users .,458
"native \ utils \ src \ org \ jetbrains \ kotlin \ konan \ target \ HostManager . kt \n + MACOS _ ARM64 , \n native \ utils \ src \ org \ jetbrains \ kotlin \ konan \ target \ KonanTarget . kt \n + object MACOS _ ARM64 : KonanTarget ( "" macos _ arm64 "" , Family . OSX , Architecture . ARM64 ) \n - MACOS _ X64 , \n + MACOS _ X64 , MACOS _ ARM64 , \n",Support for macos _ arm64 target in backend,458
kotlin - native \ platformLibs \ src \ platform \ osx \ Hypervisor . def \n - depends = darwin posix \n + depends = darwin osx posix \n kotlin - native \ platformLibs \ src \ platform \ osx \ darwin . def \n + sys / _ types / _ os _ inline . h \ \n - compilerOpts = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - D _ DARWIN _ NO _ 64 _ BIT _ INODE - DSYSCTL _ DEF _ ENABLED \n + compilerOpts . macos _ x64 = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - D _ DARWIN _ NO _ 64 _ BIT _ INODE - DSYSCTL _ DEF _ ENABLED \n + compilerOpts . macos _ arm64 = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - DSYSCTL _ DEF _ ENABLED \n kotlin - native \ platformLibs \ src \ platform \ osx \ osx . def \n + \n - emmintrin . h eti . h expat . h \ \n + eti . h expat . h \ \n - mmintrin . h monitor . h \ \n + monitor . h \ \n - xmmintrin . h \ \n + headers . macos _ x64 = \ \n + emmintrin . h \ \n + mmintrin . h \ \n + xmmintrin . h \n + headers . macos _ arm64 = \ \n + arm64 / hv / hv _ kern _ types . h \n kotlin - native \ platformLibs \ src \ platform \ osx \ posix . def \n - compilerOpts = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - D _ DARWIN _ NO _ 64 _ BIT _ INODE - D _ DARWIN _ C _ SOURCE \n + compilerOpts . macos _ x64 = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - D _ DARWIN _ NO _ 64 _ BIT _ INODE - D _ DARWIN _ C _ SOURCE \n + compilerOpts . macos _ arm64 = - D _ XOPEN _ SOURCE - DSHARED _ LIBBIND - D _ DARWIN _ C _ SOURCE \n kotlin - native \ platformLibs \ src \ platform \ osx \ set _ depends . sh \n - . . / . . / . . / . . / dist / bin / run _ konan defFileDependencies - target macos _ x64 * . def \n + . . / . . / . . / . . / dist / bin / run _ konan defFileDependencies - target macos _ x64 - target macos _ arm64 * . def \n,Platform libs for macos _ arm64 \n ( cherry picked from commit abaa99d6cc993ec30b4b8342078b69cf9e4ee6ef ),458
"kotlin - native \ backend . native \ tests \ build . gradle \n + createInterop ( "" kt43502 "" ) { \n + it . defFile ' interop / kt43502 / kt43502 . def ' \n + it . headers "" $ projectDir / interop / kt43502 / kt43502 . h "" \n + / / Note : also hardcoded in def file . \n + final String libDir = "" $ buildDir / kt43502 / "" \n + / / Construct library that contains actual symbol definition . \n + it . getByTarget ( target . name ) . doFirst { \n + UtilsKt . buildStaticLibrary ( \n + project , \n + [ file ( "" $ projectDir / interop / kt43502 / kt43502 . c "" ) ] , \n + file ( "" $ libDir / kt43502 . a "" ) , \n + file ( "" $ libDir / kt43502 . objs "" ) , \n + ) \n + } \n + } \n + \n + dynamicTest ( "" interop _ kt43502 "" ) { \n + disabled = ( project . testTarget = = ' wasm32 ' ) / / No interop for wasm yet . \n + interop = "" kt43502 "" \n + source = "" interop / kt43502 / main . kt "" \n + cSource = "" $ projectDir / interop / kt43502 / main . c "" \n + goldValue = "" null \ n "" \n + } \n + \n new file \n kotlin - native \ backend . native \ tests \ interop \ kt43502 \ kt43502 . c \n + char * * externPtr = 0 ; \n new file \n kotlin - native \ backend . native \ tests \ interop \ kt43502 \ kt43502 . def \n + libraryPaths = backend . native / tests / build / kt43502 \n + staticLibraries = kt43502 . a \n new file \n kotlin - native \ backend . native \ tests \ interop \ kt43502 \ kt43502 . h \n + extern char * * externPtr ; \n new file \n kotlin - native \ backend . native \ tests \ interop \ kt43502 \ main . c \n + # include "" libinterop _ kt43502 _ api . h "" \n + \n + int main ( ) { \n + libinterop _ kt43502 _ symbols ( ) - > kotlin . root . printExternPtr ( ) ; \n + } \n new file \n kotlin - native \ backend . native \ tests \ interop \ kt43502 \ main . kt \n + import kt43502 . * \n + \n + fun printExternPtr ( ) { \n + println ( externPtr ) \n + } \n",Add a test - case for KT - 43502,458
"kotlin - native \ shared \ src \ main \ kotlin \ org \ jetbrains \ kotlin \ konan \ target \ ClangArgs . kt \n + / / PIC is not required on Windows ( and Clang will fail with ` error : unsupported option ' - fPIC ' ` ) \n + if ( configurables ! is MingwConfigurables ) { \n + / / ` - fPIC ` allows us to avoid some problems when producing dynamic library . \n + / / See KT - 43502 . \n + add ( listOf ( "" - fPIC "" ) ) \n + } \n",Fix KT - 43502 by adding - fPIC,458
"kotlin - native \ backend . native \ tests \ build . gradle \n - it . getByTarget ( target . name ) . doFirst { \n - UtilsKt . buildStaticLibrary ( \n - project , \n - [ file ( "" $ projectDir / interop / kt43502 / kt43502 . c "" ) ] , \n - file ( "" $ libDir / kt43502 . a "" ) , \n - file ( "" $ libDir / kt43502 . objs "" ) , \n - ) \n + it . getByTarget ( target . name ) . configure { \n + doFirst { \n + UtilsKt . buildStaticLibrary ( \n + project , \n + [ file ( "" $ projectDir / interop / kt43502 / kt43502 . c "" ) ] , \n + file ( "" $ libDir / kt43502 . a "" ) , \n + file ( "" $ libDir / kt43502 . objs "" ) , \n + ) \n + } \n",Adapt fix for KT - 43502 to lazy task configuration,458
kotlin - native \ konan \ konan . properties \n - linker . mingw _ x64 - linux _ arm32 _ hfp = $ targetToolchain . mingw _ x64 - linux _ arm32 _ hfp / bin / ld \n + linker . mingw _ x64 - linux _ arm32 _ hfp = $ targetToolchain . mingw _ x64 - linux _ arm32 _ hfp / bin / ld . gold \n,Fix mingw - linux _ arm32 _ hfp cross - compilation \n Use gold linker instead of default one since the latter doesn ' t support elf .,458
kotlin - native \ backend . native \ compiler \ ir \ backend . native \ src \ org \ jetbrains \ kotlin \ backend \ konan \ Linker . kt \n - import org . jetbrains . kotlin . konan . target . CompilerOutputKind \n - import org . jetbrains . kotlin . konan . target . Family \n - import org . jetbrains . kotlin . konan . target . LinkerOutputKind \n - import org . jetbrains . kotlin . konan . target . supportsMimallocAllocator \n + import org . jetbrains . kotlin . konan . target . * \n - kotlin . native . cacheKind = none \n + kotlin . native . cacheKind . $ { target . presetName } = none \n,Mention new per - target cache setting in error message .,458
gradle . properties \n - version = 5 . 3 . 2 - SNAPSHOT \n + version = 5 . 3 . 3 - SNAPSHOT \n,Next development version ( v5 . 3 . 3 - SNAPSHOT ),471
gradle . properties \n - version = 5 . 3 . 1 - SNAPSHOT \n + version = 5 . 3 . 2 - SNAPSHOT \n,Next development version ( v5 . 3 . 2 - SNAPSHOT ),471
pom . xml \n - < revision > 2 . 2 . 12 . BUILD - SNAPSHOT < / revision > \n + < revision > 2 . 2 . 13 . BUILD - SNAPSHOT < / revision > \n,Next development version ( v2 . 2 . 13 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 5 . 3 . 0 - SNAPSHOT \n + version = 5 . 3 . 1 - SNAPSHOT \n,Next development version ( v5 . 3 . 1 - SNAPSHOT ),471
pom . xml \n - < revision > 2 . 1 . 18 . BUILD - SNAPSHOT < / revision > \n + < revision > 2 . 1 . 19 . BUILD - SNAPSHOT < / revision > \n,Next development version ( v2 . 1 . 19 . BUILD - SNAPSHOT ),471
pom . xml \n - < revision > 2 . 2 . 11 . BUILD - SNAPSHOT < / revision > \n + < revision > 2 . 2 . 12 . BUILD - SNAPSHOT < / revision > \n,Next development version ( v2 . 2 . 12 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 3 . 5 . BUILD - SNAPSHOT \n + version = 2 . 3 . 6 . BUILD - SNAPSHOT \n,Next development version ( v2 . 3 . 6 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 3 . 7 . BUILD - SNAPSHOT \n + version = 2 . 3 . 8 . BUILD - SNAPSHOT \n,Next development version ( v2 . 3 . 8 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 4 . 1 - SNAPSHOT \n + version = 2 . 4 . 2 - SNAPSHOT \n,Next development version ( v2 . 4 . 2 - SNAPSHOT ),471
gradle . properties \n - version = 2 . 3 . 6 . BUILD - SNAPSHOT \n + version = 2 . 3 . 7 . BUILD - SNAPSHOT \n,Next development version ( v2 . 3 . 7 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 4 . 0 - SNAPSHOT \n + version = 2 . 4 . 1 - SNAPSHOT \n,Next development version ( v2 . 4 . 1 - SNAPSHOT ),471
pom . xml \n - < revision > 2 . 2 . 13 . BUILD - SNAPSHOT < / revision > \n + < revision > 2 . 2 . 14 . BUILD - SNAPSHOT < / revision > \n,Next development version ( v2 . 2 . 14 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 3 . 8 . BUILD - SNAPSHOT \n + version = 2 . 3 . 9 . BUILD - SNAPSHOT \n,Next development version ( v2 . 3 . 9 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 4 . 2 - SNAPSHOT \n + version = 2 . 4 . 3 - SNAPSHOT \n,Next development version ( v2 . 4 . 3 - SNAPSHOT ),471
gradle . properties \n - version = 5 . 3 . 4 - SNAPSHOT \n + version = 5 . 3 . 5 - SNAPSHOT \n,Next development version ( v5 . 3 . 5 - SNAPSHOT ),471
gradle . properties \n - version = 2 . 3 . 9 . BUILD - SNAPSHOT \n + version = 2 . 3 . 10 . BUILD - SNAPSHOT \n,Next development version ( v2 . 3 . 10 . BUILD - SNAPSHOT ),471
gradle . properties \n - version = 2 . 4 . 3 - SNAPSHOT \n + version = 2 . 4 . 4 - SNAPSHOT \n,Next development version ( v2 . 4 . 4 - SNAPSHOT ),471
gradle . properties \n - version = 5 . 3 . 3 - SNAPSHOT \n + version = 5 . 3 . 4 - SNAPSHOT \n,Next development version ( v5 . 3 . 4 - SNAPSHOT ),471
doc \ ReleaseNotes4 . 9 . html \n - @ Rule \n + @ ClassRule \n doc \ ReleaseNotes4 . 9 . txt \n - @ Rule \n + @ ClassRule \n src \ main \ java \ org \ junit \ ClassRule . java \n - * & # 064 ; Rule \n + * & # 064 ; ClassRule \n - } \n + } \n,Fixes # 254 : replaced @ Rule by @ ClassRule,472
doc \ ReleaseNotes4 . 9 . html \n - @ Rule \n + @ ClassRule \n doc \ ReleaseNotes4 . 9 . txt \n - @ Rule \n + @ ClassRule \n src \ main \ java \ org \ junit \ ClassRule . java \n - * & # 064 ; Rule \n + * & # 064 ; ClassRule \n - } \n + } \n,Fixes # 254 : replaced @ Rule by @ ClassRule,472
"acknowledgements . txt \n - Stefan Birkner : Fixed Rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n + Stefan Birkner : Fixed Rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n + \n + 2011 Jul 22 \n + Andreas Köhler , Stefan Birkner : Fixed wrong documentation of Parameterized ( github # 89 ) . \n src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * Fibonacci , \n",fixed issue # 89 ( wrong JavaDoc of Parameterized ),472
"acknowledgements . txt \n + 2011 Jul 22 \n + Andreas Köhler , Stefan Birkner : Fixed wrong documentation of Parameterized ( github # 89 ) . \n + \n src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * Fibonacci , \n",fixed issue # 89 ( wrong JavaDoc of Parameterized ),472
"acknowledgements . txt \n + \n + 2011 Jul 28 \n + electrickery , Stefan Birkner : Fixed typo in JavaDoc ( github # 134 ) . \n src \ main \ java \ org \ junit \ Assert . java \n - * < code > assertEquals ( double expected , double actual , double epsilon ) < / code > \n + * < code > assertEquals ( double expected , double actual , double delta ) < / code > \n - * < code > assertEquals ( String message , double expected , double actual , double epsilon ) < / code > \n + * < code > assertEquals ( String message , double expected , double actual , double delta ) < / code > \n",fixed issue # 134 ( wrong JavaDoc of Assert ),472
"acknowledgements . txt \n + 2011 Jul 28 \n + electrickery , Stefan Birkner : Fixed typo in JavaDoc ( github # 134 ) . \n + \n src \ main \ java \ org \ junit \ Assert . java \n - * < code > assertEquals ( double expected , double actual , double epsilon ) < / code > \n + * < code > assertEquals ( double expected , double actual , double delta ) < / code > \n - * < code > assertEquals ( String message , double expected , double actual , double epsilon ) < / code > \n + * < code > assertEquals ( String message , double expected , double actual , double delta ) < / code > \n",fixed issue # 134 ( wrong JavaDoc of Assert ),472
rename from src \ main \ java \ org \ junit \ rules \ RuleFieldValidator . java \n rename to src \ main \ java \ org \ junit \ internal \ runners \ rules \ RuleFieldValidator . java \n - package org . junit . rules ; \n + package org . junit . internal . runners . rules ; \n + import org . junit . rules . MethodRule ; \n + import org . junit . rules . TestRule ; \n src \ main \ java \ org \ junit \ runners \ BlockJUnit4ClassRunner . java \n - import static org . junit . rules . RuleFieldValidator . RULE _ VALIDATOR ; \n + import static org . junit . internal . runners . rules . RuleFieldValidator . RULE _ VALIDATOR ; \n src \ main \ java \ org \ junit \ runners \ ParentRunner . java \n - import static org . junit . rules . RuleFieldValidator . CLASS _ RULE _ VALIDATOR ; \n + import static org . junit . internal . runners . rules . RuleFieldValidator . CLASS _ RULE _ VALIDATOR ; \n src \ test \ java \ org \ junit \ tests \ experimental \ rules \ RuleFieldValidatorTest . java \n - import static org . junit . rules . RuleFieldValidator . CLASS _ RULE _ VALIDATOR ; \n - import static org . junit . rules . RuleFieldValidator . RULE _ VALIDATOR ; \n + import static org . junit . internal . runners . rules . RuleFieldValidator . CLASS _ RULE _ VALIDATOR ; \n + import static org . junit . internal . runners . rules . RuleFieldValidator . RULE _ VALIDATOR ; \n,moved RuleFieldValidator from org . junit . rules to org . junit . internal . runners . rules,472
"src \ main \ java \ org \ junit \ runners \ model \ TestClass . java \n + import static java . lang . reflect . Modifier . isPublic ; \n - for ( FrameworkField each : getAnnotatedFields ( annotationClass ) ) { \n + for ( FrameworkField field : getAnnotatedFields ( annotationClass ) ) { \n + assertFieldIsPublic ( field ) ; \n - Object fieldValue = each . get ( test ) ; \n + Object fieldValue = field . get ( test ) ; \n - "" How did getFields return a field we couldn ' t access ? "" ) ; \n + "" How did getFields return a field we couldn ' t access ? "" , e ) ; \n + \n + public void assertFieldIsPublic ( FrameworkField frameworkField ) { \n + Field field = frameworkField . getField ( ) ; \n + int modifiers = field . getModifiers ( ) ; \n + if ( ! isPublic ( modifiers ) ) \n + throw new IllegalArgumentException ( \n + "" The "" + field . getType ( ) . getSimpleName ( ) + "" ' "" + field . getName ( ) + "" ' is not public . "" ) ; \n + } \n src \ test \ java \ org \ junit \ tests \ running \ classes \ TestClassTest . java \n + import static org . hamcrest . CoreMatchers . equalTo ; \n + import org . junit . rules . ExpectedException ; \n + @ Rule \n + public ExpectedException expectedException = ExpectedException . none ( ) ; \n + \n + public static class TestWithProtectedTestRule { \n + @ Rule \n + protected TestRule x ; \n + \n + @ Test \n + public void test ( ) { \n + } \n + } \n + \n + \n + @ Test \n + public void shouldThrowExcpetionWithHelpfulMessageForProtectedFields ( ) { \n + expectedException . expectMessage ( equalTo ( "" The TestRule ' x ' is not public . "" ) ) ; \n + TestClass testClass = new TestClass ( TestWithProtectedTestRule . class ) ; \n + testClass . getAnnotatedFieldValues ( testClass , Rule . class , TestRule . class ) ; \n + } \n",Throw exception with helpful message if annotated field is not public ( fixes issue # 260 ) .,472
"src \ main \ java \ org \ junit \ runners \ ParentRunner . java \n - import org . junit . runners . model . FrameworkField ; \n - List < TestRule > results = new ArrayList < TestRule > ( ) ; \n - for ( FrameworkField field : classRuleFields ( ) ) \n - results . add ( getClassRule ( field ) ) ; \n - return results ; \n - } \n - \n - private TestRule getClassRule ( final FrameworkField field ) { \n - try { \n - return ( TestRule ) field . get ( null ) ; \n - } catch ( IllegalAccessException e ) { \n - throw new RuntimeException ( \n - "" How did getAnnotatedFields return a field we couldn ' t access ? "" ) ; \n - } \n - } \n - \n - / * * \n - * @ return list of { @ link FrameworkField } s annotated with { @ link Rule } \n - * / \n - protected List < FrameworkField > classRuleFields ( ) { \n - return fTestClass . getAnnotatedFields ( ClassRule . class ) ; \n + return fTestClass . getAnnotatedFieldValues ( null , ClassRule . class , TestRule . class ) ; \n src \ test \ java \ org \ junit \ tests \ running \ classes \ ParentRunnerTest . java \n + import static org . hamcrest . CoreMatchers . equalTo ; \n + import static org . hamcrest . CoreMatchers . is ; \n + import org . junit . ClassRule ; \n + import org . junit . rules . TestRule ; \n + \n + @ Test \n + public void shouldFailWithHelpfulMessageForProtectedClassRule ( ) throws Exception { \n + JUnitCore junitCore = new JUnitCore ( ) ; \n + Request request = Request . aClass ( TestWithProtectedClassRule . class ) ; \n + Result result = junitCore . run ( request ) ; \n + assertThat ( result . getFailureCount ( ) , is ( 1 ) ) ; \n + assertThat ( result . getFailures ( ) . get ( 0 ) . getMessage ( ) , is ( equalTo ( "" The TestRule ' x ' is not public . "" ) ) ) ; \n + } \n + \n + public static class TestWithProtectedClassRule { \n + @ ClassRule \n + protected TestRule x ; \n + \n + @ Test \n + public void test ( ) { \n + } \n + } \n",Using TetClass . getAnnotatedFieldValues in order to get classRule fields ( fixes issue # 258,472
"src \ main \ java \ org \ junit \ runners \ model \ TestClass . java \n + import static java . lang . reflect . Modifier . isStatic ; \n + \n + import java . lang . reflect . Modifier ; \n + boolean fieldsMustBeStatic = test = = null ; \n + if ( fieldsMustBeStatic ) { \n + assertFieldIsStatic ( field ) ; \n + } \n - public void assertFieldIsPublic ( FrameworkField frameworkField ) { \n + private void assertFieldIsPublic ( FrameworkField frameworkField ) { \n + \n + private void assertFieldIsStatic ( FrameworkField frameworkField ) { \n + Field field = frameworkField . getField ( ) ; \n + int modifiers = field . getModifiers ( ) ; \n + if ( ! isStatic ( modifiers ) ) \n + throw new IllegalArgumentException ( \n + "" The "" + field . getType ( ) . getSimpleName ( ) + "" ' "" + field . getName ( ) + "" ' is not static . "" ) ; \n + } \n src \ test \ java \ org \ junit \ tests \ running \ classes \ ParentRunnerTest . java \n - protected TestRule x ; \n + protected static TestRule x ; \n + \n + @ Test \n + public void test ( ) { \n + } \n + } \n + \n + @ Test \n + public void shouldFailWithHelpfulMessageForNonStaticClassRule ( ) throws Exception { \n + JUnitCore junitCore = new JUnitCore ( ) ; \n + Request request = Request . aClass ( TestWithNonStaticClassRule . class ) ; \n + Result result = junitCore . run ( request ) ; \n + assertThat ( result . getFailureCount ( ) , is ( 1 ) ) ; \n + assertThat ( result . getFailures ( ) . get ( 0 ) . getMessage ( ) , is ( equalTo ( "" The TestRule ' x ' is not static . "" ) ) ) ; \n + } \n + \n + public static class TestWithNonStaticClassRule { \n + @ ClassRule \n + public TestRule x ; \n src \ test \ java \ org \ junit \ tests \ running \ classes \ TestClassTest . java \n + import org . junit . ClassRule ; \n + \n + @ Test \n + public void shouldThrowExcpetionWithHelpfulMessageForNonStaticFields ( ) { \n + expectedException . expectMessage ( equalTo ( "" The TestRule ' x ' is not static . "" ) ) ; \n + TestClass testClass = new TestClass ( TestWithNonStaticClassRule . class ) ; \n + testClass . getAnnotatedFieldValues ( null , ClassRule . class , TestRule . class ) ; \n + } \n + \n + public static class TestWithNonStaticClassRule { \n + @ ClassRule \n + public TestRule x ; \n + \n + @ Test \n + public void test ( ) { \n + } \n + } \n",TestClass . getAnnotatedFieldValues ( . . . ) throws exception with helpful message for non static fields ( fixes issue # 257 ) .,472
acknowledgements . txt \n - Stefan Birkner : Fixed JavaDoc links . \n + Stefan Birkner : Fixed JavaDoc links . \n,"Fixed bugs # 257 , # 258 , # 260 )",472
"acknowledgements . txt \n - Stefan Birkner : Fixed wrong docomentation of ClassRule ( github # 254 ) . \n + Stefan Birkner : Fixed wrong documentation of ClassRule ( github # 254 ) . \n + \n + 2011 Jul 09 \n + Stefan Birkner : Fixed rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n","Fixed bugs # 257 , # 258 , # 260 )",472
"acknowledgements . txt \n + digulla @ github , Stefan Birkner : Removed useless code ( github # 289 ) . \n src \ main \ java \ org \ junit \ internal \ runners \ statements \ RunAfters . java \n - errors . clear ( ) ; \n",fixed issue # 289 ( removed useless code ),472
src \ test \ java \ junit \ tests \ framework \ TestListenerTest . java \n + fErrorCount = 0 ; \n,Fixes gh - 225 ( initialize error count ),472
"src \ main \ java \ junit \ framework \ AssertionFailedError . java \n - super ( message ) ; \n + super ( defaultString ( message ) ) ; \n + } \n + \n + private static String defaultString ( String message ) { \n + return message = = null ? "" "" : message ; \n src \ test \ java \ junit \ tests \ framework \ AllTests . java \n + suite . addTestSuite ( AssertionFailedErrorTest . class ) ; \n new file \n src \ test \ java \ junit \ tests \ framework \ AssertionFailedErrorTest . java \n + package junit . tests . framework ; \n + \n + import junit . framework . AssertionFailedError ; \n + import junit . framework . TestCase ; \n + \n + public class AssertionFailedErrorTest extends TestCase { \n + private static final String ARBITRARY _ MESSAGE = "" arbitrary message "" ; \n + \n + public void testCreateErrorWithoutMessage ( ) throws Exception { \n + AssertionFailedError error = new AssertionFailedError ( ) ; \n + assertNull ( error . getMessage ( ) ) ; \n + } \n + \n + public void testCreateErrorWithMessage ( ) throws Exception { \n + AssertionFailedError error = new AssertionFailedError ( ARBITRARY _ MESSAGE ) ; \n + assertEquals ( ARBITRARY _ MESSAGE , error . getMessage ( ) ) ; \n + } \n + \n + public void testCreateErrorWithoutMessageInsteadOfNull ( ) throws Exception { \n + AssertionFailedError error = new AssertionFailedError ( null ) ; \n + assertEquals ( "" "" , error . getMessage ( ) ) ; \n + } \n + } \n",Fixed gh - 318 ( Empty message instead of null ),472
src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n - public void handleAssertionErrors ( ) { \n + public ExpectedException handleAssertionErrors ( ) { \n + return this ; \n - public void handleAssumptionViolatedExceptions ( ) { \n + public ExpectedException handleAssumptionViolatedExceptions ( ) { \n + return this ; \n,"the two handle . . . methods are returning the rule \n The two methods handleAssertionError ( ) and \n handleAssumptionViolatedExceptions ( ) are returning the rule . \n Now you can write \n @ Rule \n public ExpectedException thrown = none ( ) . handleAssertionError ( ) ; \n or \n @ Rule \n public ExpectedException thrown = none ( ) . handleAssumptionViolatedExceptions ( ) \n Thank you David , for this suggestion .",472
src \ main \ java \ org \ junit \ runner \ JUnitCore . java \n - private RunNotifier fNotifier ; \n - \n - / * * \n - * Create a new < code > JUnitCore < / code > to run tests . \n - * / \n - public JUnitCore ( ) { \n - fNotifier = new RunNotifier ( ) ; \n - } \n + private final RunNotifier fNotifier = new RunNotifier ( ) ; \n,"Removed explicit constructor of JUnitCore \n The constructor was used to create the RunNotifier . Now the \n initial value of the RunNotifier is provided in its declaration . \n Additionally added the final modifiert to the RunNotifier in \n order to make it clear , that it never changes .",472
"src \ main \ java \ org \ junit \ runner \ Description . java \n + private static final Pattern METHOD _ AND _ CLASS _ NAME _ PATTERN = Pattern \n + . compile ( "" ( . * ) \ \ ( ( . * ) \ \ ) "" ) ; \n + \n - if ( name . length ( ) = = 0 ) \n - throw new IllegalArgumentException ( "" name must have non - zero length "" ) ; \n - \n - private Description ( final String displayName , Annotation . . . annotations ) { \n + private Description ( String displayName , Annotation . . . annotations ) { \n + if ( ( displayName = = null ) | | ( displayName . length ( ) = = 0 ) ) \n + throw new IllegalArgumentException ( \n + "" The display name must not be empty . "" ) ; \n - Matcher matcher = methodStringMatcher ( ) ; \n - return matcher . matches ( ) \n - ? matcher . group ( 2 ) \n - : toString ( ) ; \n + return methodAndClassNamePatternGroupOrDefault ( 2 , toString ( ) ) ; \n - return parseMethod ( ) ; \n - } \n - \n - private String parseMethod ( ) { \n - Matcher matcher = methodStringMatcher ( ) ; \n - if ( matcher . matches ( ) ) \n - return matcher . group ( 1 ) ; \n - return null ; \n + return methodAndClassNamePatternGroupOrDefault ( 1 , null ) ; \n - private Matcher methodStringMatcher ( ) { \n - return Pattern . compile ( "" ( . * ) \ \ ( ( . * ) \ \ ) "" ) . matcher ( toString ( ) ) ; \n + private String methodAndClassNamePatternGroupOrDefault ( int group , \n + String defaultString ) { \n + Matcher matcher = METHOD _ AND _ CLASS _ NAME _ PATTERN . matcher ( toString ( ) ) ; \n + return matcher . matches ( ) ? matcher . group ( group ) : defaultString ; \n src \ test \ java \ org \ junit \ tests \ experimental \ max \ DescriptionTest . java \n - \n + \n + @ Test ( expected = IllegalArgumentException . class ) \n + public void createSuiteDescription _ whenNull ( ) { \n + Description . createSuiteDescription ( ( String ) null ) ; \n + } \n",Improved Description class . \n A few modifications to improve the readability of the code : \n * extracted METHOD _ AND _ CLASS _ NAME _ PATTERN constant \n * extracted methodAndClassNamePatternGroupOrDefault ( . . . ) \n * merged getMethodName ( ) and parseMethod ( ) \n * moved validation of display name to constructor \n * throw IllegalArgumentException if display name is null,472
"acknowledgements . txt \n + 2011 Jul 09 \n + Stefan Birkner : Fixed rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n",added Nigel Charman as reporter of bugs github # 257 and gihub # 258 .,472
"acknowledgements . txt \n + 2011 Jul 09 \n + Stefan Birkner : Fixed rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n",added Nigel Charman as reporter of bugs github # 257 and gihub # 258 .,472
"acknowledgements . txt \n + 2011 Jul 09 \n + Stefan Birkner : Fixed rules bugs ( github # 257 , gihub # 258 , github # 260 ) . \n",added Nigel Charman as reporter of bugs github # 257 and gihub # 258 .,472
acknowledgements . txt \n + 2011 Jul 09 \n + Nigel Charman : Reported rules bugs github # 257 and gihub # 258 . \n + \n,added Nigel Charman as reporter of bugs github # 257 and gihub # 258 .,472
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * & # 064 ; Parameters ( name = & quot ; fib ( { 0 } ) = { 1 } & quot ; ) \n + * & # 064 ; Parameters ( name = & quot ; { index } : fib ( { 0 } ) = { 1 } & quot ; ) \n - * names like < code > fib ( 3 ) = 2 < / code > . If you don ' t use the name parameter , then \n - * the current parameter index is used as name . \n + * names like < code > [ 1 : fib ( 3 ) = 2 ] < / code > . If you don ' t use the name parameter , \n + * then the current parameter index is used as name . \n",Use the same name as in the test . Fix documentation .,472
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - import static java . text . MessageFormat . format ; \n - \n - return format ( finalPattern , parameters ) ; \n + return MessageFormat . format ( finalPattern , parameters ) ; \n - String message = format ( "" { 0 } . { 1 } ( ) must return an Iterable of arrays . "" , \n + String message = MessageFormat . format ( \n + "" { 0 } . { 1 } ( ) must return an Iterable of arrays . "" , \n",Don ' t use static import for MessageFormat . format,472
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * Default value is "" [ { index } ] "" for compatibility with previous JUnit \n + * Default value is "" { index } "" for compatibility with previous JUnit \n - String name ( ) default "" [ { index } ] "" ; \n + String name ( ) default "" { index } "" ; \n - return MessageFormat . format ( finalPattern , parameters ) ; \n + String name = MessageFormat . format ( finalPattern , parameters ) ; \n + return "" [ "" + name + "" ] "" ; \n src \ test \ java \ org \ junit \ tests \ running \ classes \ ParameterizedTestTest . java \n - @ Parameters ( name = "" [ { index } : fib ( { 0 } ) = { 1 } ] "" ) \n + @ Parameters ( name = "" { index } : fib ( { 0 } ) = { 1 } "" ) \n",The runner adds the square brackets to the name .,472
src \ main \ java \ junit \ runner \ BaseTestRunner . java \n - } catch ( IOException e ) { \n + } catch ( IOException ignored ) { \n + } finally { \n,Always close stream in readPreferences ( ) . Fixes # 729 .,472
src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n - if ( fMatcherBuilder . expectsThrowable ( ) ) { \n + if ( isAnyExceptionExpected ( ) ) { \n - if ( fMatcherBuilder . expectsThrowable ( ) ) { \n + if ( isAnyExceptionExpected ( ) ) { \n + private boolean isAnyExceptionExpected ( ) { \n + return fMatcherBuilder . expectsThrowable ( ) ; \n + } \n + \n,Extract isAnyExceptionExpected ( ) . \n Improve readability and avoid duplicate code .,472
src \ main \ java \ org \ junit \ experimental \ categories \ IncludeCategories . java \n - * Creates an { @ link IncludesAny } { @ link CategoryFilter } given an array of classes used as \n - * { @ link Category } values . \n + * Creates a { @ link Filter } which is only passed by tests that are \n + * categorized with any of the specified categories . \n,Rewrite JavaDoc of IncludeCategories . createFilter ( Class < ? > . . . ) . \n Remove internal details of the created filter and describe its behaviour instead .,472
src \ main \ java \ org \ junit \ internal \ runners \ JUnit38ClassRunner . java \n - * @ param test \n - * @ return \n + * @ param test the TestCase . \n,Clean up JavaDoc of JUnit38ClassRunner . getAnnotations ( . . . ) . \n Remove empty return and add description of the parameter .,472
src \ main \ java \ org \ junit \ experimental \ categories \ ExcludeCategories . java \n - * Creates an { @ link ExcludesAny } { @ link CategoryFilter } given an array of classes used as \n - * { @ link Category } values . \n + * Creates a { @ link Filter } which is only passed by tests that are \n + * not categorized with any of the specified categories . \n,Rewrite JavaDoc of ExcludeCategories . createFilter ( Class < ? > . . . ) . \n Remove internal details of the created filter and describe its behaviour instead .,472
src \ main \ java \ org \ junit \ runner \ notification \ RunNotifier . java \n - import java . util . Collection ; \n - * { @ link # fireTestFinished ( Description ) } if you invoke { @ link # fireTestStarted ( Description ) } \n + * this method if you invoke { @ link # fireTestStarted ( Description ) } \n,Simplify JavaDoc of RunNotifier . fireTestFinished ( . . . ) .,472
"src \ main \ java \ org \ junit \ runner \ JUnitCore . java \n - runMainAndExit ( new RealSystem ( ) , args ) ; \n - } \n - \n - / * * \n - * Runs main and exits \n - * / \n - private static void runMainAndExit ( JUnitSystem system , String . . . args ) { \n - Result result = new JUnitCore ( ) . runMain ( system , args ) ; \n + Result result = new JUnitCore ( ) . runMain ( new RealSystem ( ) , args ) ; \n",Merge main ( . . . ) and runMainAndExit ( . . . ) . \n Commit 917a88fad06ce108a596a8fdb4607b1a2fbb3f3e changed the \n visibility of runMainAndExit from public to private . The method \n is only called by main and therefore runMainAndExit is not needed \n anymore .,472
src \ main \ java \ org \ junit \ experimental \ runners \ Enclosed . java \n - * \n - * @ see org . junit . tests . manipulation . SortableTest \n,Remove JavaDoc reference to test class . \n The test class is no available by JavaDoc .,472
deleted file \n . cvsignore \n - bin \n - junit4 . 1 \n - junit * - SNAPSHOT - * \n - target \n - reports \n - buildfile \n - java . hprof . txt \n - junit4 . 5 - RC1 \n - junit4 . * \n - * . ser \n deleted file \n build \ . cvsignore \n - Changes \n - java . hprof . txt \n - historical _ javadoc \n - compare _ with _ 44 . sh \n,"Delete . cvsignore files , because we ' re using Git now .",472
. settings \ org . eclipse . jdt . core . prefs \n - org . eclipse . jdt . core . formatter . tabulation . char = tab \n + org . eclipse . jdt . core . formatter . tabulation . char = space \n,Indent with spaces ( not tabs ) .,472
new file \n CONTRIBUTING . md \n + We love pull requests . Here is a quick guide : \n + 1 . You need to have ` ant ` and a JDK ( at least version 1 . 5 ) installed . \n + 2 . Fork the repo . \n + 3 . Ensure that you have a clean state by running ` ant test ` . \n + 4 . Add your change together with a test . ( Tests are not needed for refactorings and documentation changes . ) \n + 5 . Format your code : Import the JUnit project in Eclipse and use its formatter or apply the rules in the ` CODING _ STYLE ` file manually . \n + 6 . Run ` ant test ` again and ensure all tests are passing . \n + 7 . Push to your fork and submit a pull request . \n + \n + Now you are waiting on us . We review your pull request and at least leave some comments . \n,Add contributing guidelines . \n Hopefully this is helpful to new contributors . Github displays these guidelines when a new issue or pull request is created ( https : / / github . com / blog / 1184 - contributing - guidelines ) .,472
. settings \ org . eclipse . jdt . core . prefs \n - org . eclipse . jdt . core . formatter . insert _ space _ before _ assignment _ operator = do not insert \n + org . eclipse . jdt . core . formatter . insert _ space _ before _ assignment _ operator = insert \n,Insert space before assigment operator according to CODING _ STYLE .,472
rename from src \ test \ java \ org \ junit \ tests \ running \ classes \ TestClassTest . java \n rename to src \ test \ java \ org \ junit \ runners \ model \ TestClassTest . java \n - package org . junit . tests . running . classes ; \n + package org . junit . runners . model ; \n - import org . junit . runners . model . FrameworkField ; \n - import org . junit . runners . model . FrameworkMethod ; \n - import org . junit . runners . model . TestClass ; \n src \ test \ java \ org \ junit \ tests \ AllTests . java \n + import org . junit . runners . model . TestClassTest ; \n - import org . junit . tests . running . classes . TestClassTest ; \n,Move TestClassTest to package org . junit . runners . model . \n It is common to add tests to the same package as the class under test .,472
new file \n . travis . yml \n + language : java \n + jdk : \n + - oraclejdk7 \n + - openjdk7 \n + - openjdk6 \n,Add support for Travis CI ( http : / / travis - ci . org ) . \n Simple CI for branches of JUnit forks . Now everybody can easily use CI for own branches . Pull requests are automatically build by the CI and the build result is visible on Github .,472
"src \ main \ java \ org \ junit \ runners \ model \ FrameworkField . java \n + if ( field = = null ) { \n + throw new NullPointerException ( \n + "" FrameworkField cannot be created without an underlying field . "" ) ; \n + } \n src \ main \ java \ org \ junit \ runners \ model \ FrameworkMethod . java \n + if ( method = = null ) { \n + throw new NullPointerException ( \n + "" FrameworkMethod cannot be created without an underlying method . "" ) ; \n + } \n new file \n src \ test \ java \ org \ junit \ runners \ model \ FrameworkFieldTest . java \n + package org . junit . runners . model ; \n + \n + import static org . junit . rules . ExpectedException . none ; \n + import org . junit . Rule ; \n + import org . junit . Test ; \n + import org . junit . rules . ExpectedException ; \n + \n + public class FrameworkFieldTest { \n + @ Rule \n + public final ExpectedException thrown = none ( ) ; \n + \n + @ Test \n + public void cannotBeCreatedWithoutUnderlyingField ( ) { \n + thrown . expect ( NullPointerException . class ) ; \n + thrown . expectMessage ( "" FrameworkField cannot be created without an underlying field . "" ) ; \n + new FrameworkField ( null ) ; \n + } \n + } \n new file \n src \ test \ java \ org \ junit \ runners \ model \ FrameworkMethodTest . java \n + package org . junit . runners . model ; \n + \n + import static org . junit . rules . ExpectedException . none ; \n + import org . junit . Rule ; \n + import org . junit . Test ; \n + import org . junit . rules . ExpectedException ; \n + \n + public class FrameworkMethodTest { \n + @ Rule \n + public final ExpectedException thrown = none ( ) ; \n + \n + @ Test \n + public void cannotBeCreatedWithoutUnderlyingField ( ) { \n + thrown . expect ( NullPointerException . class ) ; \n + thrown . expectMessage ( "" FrameworkMethod cannot be created without an underlying method . "" ) ; \n + new FrameworkMethod ( null ) ; \n + } \n + } \n src \ test \ java \ org \ junit \ tests \ AllTests . java \n + import org . junit . runners . model . FrameworkFieldTest ; \n + import org . junit . runners . model . FrameworkMethodTest ; \n + FrameworkFieldTest . class , \n + FrameworkMethodTest . class , \n","Prevent creation of FrameworkMethod or FrameworkField without underlying member . \n The classes are relying on an underlying member . Fail early , because this makes it easier to find mistakes .",472
"src \ main \ java \ org \ junit \ runners \ model \ FrameworkField . java \n + \n + @ Override \n + public String toString ( ) { \n + return fField . toString ( ) ; \n + } \n src \ main \ java \ org \ junit \ runners \ model \ FrameworkMethod . java \n + \n + @ Override \n + public String toString ( ) { \n + return fMethod . toString ( ) ; \n + } \n src \ test \ java \ org \ junit \ runners \ model \ FrameworkFieldTest . java \n + import static org . junit . Assert . assertTrue ; \n + \n + import java . lang . reflect . Field ; \n + \n + \n + @ Test \n + public void hasToStringWhichPrintsFieldName ( ) throws Exception { \n + Field field = ClassWithDummyField . class . getField ( "" dummyField "" ) ; \n + FrameworkField frameworkField = new FrameworkField ( field ) ; \n + assertTrue ( frameworkField . toString ( ) . contains ( "" dummyField "" ) ) ; \n + } \n + \n + private static class ClassWithDummyField { \n + @ SuppressWarnings ( "" unused "" ) \n + public final int dummyField = 0 ; \n + } \n src \ test \ java \ org \ junit \ runners \ model \ FrameworkMethodTest . java \n + import static org . junit . Assert . assertTrue ; \n + \n + import java . lang . reflect . Method ; \n + \n + \n + @ Test \n + public void hasToStringWhichPrintsMethodName ( ) throws Exception { \n + Method method = ClassWithDummyMethod . class . getMethod ( "" dummyMethod "" ) ; \n + FrameworkMethod frameworkMethod = new FrameworkMethod ( method ) ; \n + assertTrue ( frameworkMethod . toString ( ) . contains ( "" dummyMethod "" ) ) ; \n + } \n + \n + private static class ClassWithDummyMethod { \n + @ SuppressWarnings ( "" unused "" ) \n + public void dummyMethod ( ) { \n + } \n + } \n",Override toString ( ) with meaningful implementation . \n The new implementation provides more useful information .,472
src \ main \ java \ org \ junit \ runners \ model \ FrameworkMethod . java \n - final Method fMethod ; \n + private final Method fMethod ; \n,Change visibility of field fMethod to private . \n There is a getter method for this field . Users should use this method .,472
"src \ main \ java \ org \ junit \ Test . java \n - * < / pre > < / p > \n + * < / pre > \n + * If the exception ' s message or one of its properties should be verified , the \n + * { @ link org . junit . rules . ExpectedException ExpectedException } rule can be used . Further \n + * information about exception testing can be found at the \n + * < a href = "" https : / / github . com / junit - team / junit / wiki / Exception - testing "" > JUnit Wiki < / a > . \n - * and only if an exception of the specified class is thrown by the method . \n + * and only if an exception of the specified class is thrown by the method . If the Throwable ' s \n + * message or one of its properties should be verified , the \n + * { @ link org . junit . rules . ExpectedException ExpectedException } rule can be used instead . \n",Add reference to ExpectedException . Fixes # 806 . \n The ExpectedException can be used for better exception testing . The \n reference should guide the reader to its documentation .,472
pom . xml \n - - > \n - < version > 1 . 4 < / version > \n + < version > 1 . 5 < / version > \n,Update Maven GPG plugin from 1 . 4 to 1 . 5 . \n Just to keep up - to - date . Release notes : http : / / jira . codehaus . org / browse / MGPG / fixforversion / 17635,472
src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - * test class constructor by < code > Parameterized < / code > \n + * test class constructor by < code > Parameterized < / code > . The method has to \n + * be public and static . \n,Mention required modifiers of @ Parameters method . Fixes # 809 .,472
pom . xml \n - - > \n - < version > 2 . 16 < / version > \n + < version > 2 . 17 < / version > \n - < version > 2 . 16 < / version > \n + < version > 2 . 17 < / version > \n,Update Surefire plugin from 2 . 16 to 2 . 17 . \n Keep the plugin up - to - date . \n Plugin changes : http : / / jira . codehaus . org / browse / SUREFIRE / fixforversion / 19536,472
CONTRIBUTING . md \n - 1 . You need to have ` ant ` and a JDK ( at least version 1 . 5 ) installed . \n + 1 . You need to have Maven and a JDK ( at least version 1 . 5 ) installed . \n - 3 . Ensure that you have a clean state by running ` ant test ` . \n + 3 . Ensure that you have a clean state by running ` mvn verify ` . \n - 6 . Run ` ant test ` again and ensure all tests are passing . \n + 6 . Run ` mvn verify ` again and ensure all tests are passing . \n,Tell the people to use Maven instead of Ant . \n Part of the migration from Ant to Maven .,472
"pom . xml \n + < profile > \n + < id > restrict - doclint < / id > \n + < ! - - doclint is only supported by JDK 8 - - > \n + < activation > \n + < jdk > [ 1 . 8 , < / jdk > \n + < / activation > \n + < build > \n + < plugins > \n + < plugin > \n + < artifactId > maven - compiler - plugin < / artifactId > \n + < configuration > \n + < compilerArgs > \n + < arg > - Xlint : unchecked < / arg > \n + < arg > - Xdoclint : accessibility , reference , syntax < / arg > \n + < / compilerArgs > \n + < / configuration > \n + < / plugin > \n + < plugin > \n + < artifactId > maven - javadoc - plugin < / artifactId > \n + < configuration > \n + < additionalparam > - Xdoclint : accessibility - Xdoclint : reference < / additionalparam > \n + < / configuration > \n + < / plugin > \n + < / plugins > \n + < / build > \n + < / profile > \n","Disable doclint for all groups but accessibility and reference . \n With JDK 8 , doclint has been added to Javac and Javadoc . It is enabled \n by default but it is too strict for JUnit . The only groups that don ' t \n report issues are accessibility , reference and syntax . But syntax has \n to be disabled for Javadoc because the Hamcrest classes are reporting \n syntax issues . \n Additionally doclint is disabled for JDK < 8 , because the - Xdoclint \n argument causes a failing build in JDKs before JDK 8 .",472
. travis . yml \n + script : mvn verify javadoc : javadoc \n - oraclejdk7 \n - oraclejdk8 \n,Verify javadoc on Travis CI . \n The build should fail for Javadoc issues .,472
pom . xml \n - - > \n - < version > 1 . 1 . 1 < / version > \n + < version > 1 . 3 . 1 < / version > \n - - > \n - < version > 1 . 3 . 8 < / version > \n + < version > 1 . 4 . 1 < / version > \n - - > \n - < version > 2 . 5 . 1 < / version > \n + < version > 3 . 1 < / version > \n - - > \n - < version > 2 . 2 < / version > \n + < version > 2 . 2 . 1 < / version > \n - < version > 2 . 9 < / version > \n + < version > 2 . 10 < / version > \n - < version > 2 . 3 < / version > \n + < version > 2 . 4 < / version > \n,Update plugins to current versions . \n com . google . code . maven - replacer - plugin : maven - replacer - plugin 1 . 3 . 8 - > 1 . 4 . 1 \n maven - changes - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 9 - > 2 . 10 \n maven - compiler - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 5 . 1 - > 3 . 1 \n maven - enforcer - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 . 1 . 1 - > 1 . 3 . 1 \n maven - jxr - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 3 - > 2 . 4 \n maven - source - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 2 - > 2 . 2 . 1,472
pom . xml \n - < compilerArgument > - Xlint : unchecked < / compilerArgument > \n + < compilerArgs > \n + < arg > - Xlint : unchecked < / arg > \n + < / compilerArgs > \n,Use compilerArgs instead of compilerArguments . \n The parameter compilerArguments is deprecated .,472
"src \ main \ java \ org \ junit \ runners \ model \ FrameworkMethod . java \n - import java . lang . reflect . Modifier ; \n - if ( ! Modifier . isPublic ( getDeclaringClass ( ) . getModifiers ( ) ) ) { \n - errors . add ( new Exception ( "" Class "" + getDeclaringClass ( ) . getName ( ) + "" should be public "" ) ) ; \n - } \n src \ test \ java \ org \ junit \ tests \ AllTests . java \n - import org . junit . tests . validation . InaccessibleBaseClassTest ; \n - InaccessibleBaseClassTest . class , \n deleted file \n src \ test \ java \ org \ junit \ tests \ validation \ InaccessibleBaseClassTest . java \n - package org . junit . tests . validation ; \n - \n - import org . junit . Test ; \n - import org . junit . runners . BlockJUnit4ClassRunner ; \n - import org . junit . runners . model . InitializationError ; \n - import org . junit . tests . validation . anotherpackage . Sub ; \n - \n - public class InaccessibleBaseClassTest { \n - @ Test ( expected = InitializationError . class ) \n - public void inaccessibleBaseClassIsCaughtAtValidation ( ) throws InitializationError { \n - new BlockJUnit4ClassRunner ( Sub . class ) ; \n - } \n - } \n","Don ' t verify the visibility of a method ' s declaring class . \n I would not expect FrameworkMethod . validatePublicVoid ( . . . ) to test \n visibility of the declaring class . Since the last commit the runner \n itself verifies that a test class is public . Hence we can safely remove \n this validation from FrameworkMethod . \n This fixes # 749 ( JUnit cannot be build with JDK 8 ) , too .",472
. travis . yml \n - oraclejdk7 \n + - oraclejdk8 \n - openjdk7 \n - openjdk6 \n,"Build JUnit with JDK 8 on Travis . \n We can now build JUnit with JDK 8 , because # 749 is fixed .",472
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n - import org . junit . runners . model . InitializationError ; \n - throws InitializationError , \n - Exception { \n + throws Exception { \n",Remove redundant exception from method signature . \n A more general exception is already part of the signature .,472
"src \ main \ java \ org \ junit \ internal \ requests \ ClassRequest . java \n - private final Class < ? > testClass ; \n + \n + / * \n + * We have to use the f prefix , because IntelliJ ' s JUnit4IdeaTestRunner uses \n + * reflection to access this field . See \n + * https : / / github . com / junit - team / junit / issues / 960 \n + * / \n + private final Class < ? > fTestClass ; \n - this . testClass = testClass ; \n + this . fTestClass = testClass ; \n - runner = new AllDefaultPossibilitiesBuilder ( canUseSuiteMethod ) . safeRunnerForClass ( testClass ) ; \n + runner = new AllDefaultPossibilitiesBuilder ( canUseSuiteMethod ) . safeRunnerForClass ( fTestClass ) ; \n src \ main \ java \ org \ junit \ internal \ requests \ FilterRequest . java \n - private final Filter filter ; \n + / * \n + * We have to use the f prefix , because IntelliJ ' s JUnit4IdeaTestRunner uses \n + * reflection to access this field . See \n + * https : / / github . com / junit - team / junit / issues / 960 \n + * / \n + private final Filter fFilter ; \n - this . filter = filter ; \n + this . fFilter = filter ; \n - filter . apply ( runner ) ; \n + fFilter . apply ( runner ) ; \n - . format ( "" No tests found matching % s from % s "" , filter \n + . format ( "" No tests found matching % s from % s "" , fFilter \n","Restore field names with f prefix . Fixes # 960 . \n The prefix has been removed by df00d5eced3a7737b88de0f6f9e3673f0cf88f88 , \n because we changed the coding style . Unfortunately IntelliJ IDEA reads \n ClassRequest . fTestClass and FilterRequest . fFilter via reflection . ( See \n http : / / grepcode . com / file / repository . grepcode . com / java / ext / com . jetbrains / intellij - idea / 13 . 0 . 0 / com / intellij / junit4 / JUnit4IdeaTestRunner . java / ) This makes it impossible to \n start tests by using IntelliJ IDEA . \n There is already an issue at JetBrains : \n [ IDEA - 127349 ] ( http : / / youtrack . jetbrains . com / issue / IDEA - 127349 ) We can \n revert the fix when this ticket is solved and most users are using an \n IntelliJ version with the fix .",472
"pom . xml \n - < jdk > [ 1 . 8 , < / jdk > \n + < jdk > [ 1 . 8 , ) < / jdk > \n",Fix version range for restict - doclint . Fixes # 965 . \n Non - inclusive version ranges must be terminated by a closing parantheses according to the [ Maven documentation ] ( http : / / docs . codehaus . org / display / MAVEN / Dependency + Mediation + and + Conflict + Resolution # DependencyMediationandConflictResolution - DependencyVersionRanges ) .,472
src \ test \ java \ org \ junit \ tests \ internal \ runners \ statements \ FailOnTimeoutTest . java \n - / / TODO Fix this . See https : / / github . com / junit - team / junit / issues / 963 \n - @ Ignore \n + private static final int DURATION _ THAT _ EXCEEDS _ TIMEOUT = Integer . MAX _ VALUE ; \n - evaluateWithWaitDuration ( TIMEOUT + 50 ) ; \n + evaluateWithWaitDuration ( DURATION _ THAT _ EXCEEDS _ TIMEOUT ) ; \n - evaluateWithWaitDuration ( TIMEOUT + 50 ) ; \n + evaluateWithWaitDuration ( DURATION _ THAT _ EXCEEDS _ TIMEOUT ) ; \n - evaluateWithWaitDuration ( TIMEOUT + 50 ) ; \n + evaluateWithWaitDuration ( DURATION _ THAT _ EXCEEDS _ TIMEOUT ) ; \n - evaluateWithWaitDuration ( TIMEOUT + 50 ) ; \n + evaluateWithWaitDuration ( DURATION _ THAT _ EXCEEDS _ TIMEOUT ) ; \n - evaluateWithWaitDuration ( TIMEOUT + 50 ) ; \n + evaluateWithWaitDuration ( DURATION _ THAT _ EXCEEDS _ TIMEOUT ) ; \n,Increase running time of statement . Fixes # 963 . \n The time between starting the statement and calling the future is \n arbitrary . Now the execution time of the statement is very very long . \n This ensures that the statement is not already finished when the \n future is called .,472
src \ main \ java \ org \ junit \ experimental \ categories \ Categories . java \n - if ( ! canHaveCategorizedChildren ( description ) ) { \n + if ( canHaveCategorizedChildren ( description ) ) { \n + for ( Description each : description . getChildren ( ) ) { \n + assertNoCategorizedDescendentsOfUncategorizeableParents ( each ) ; \n + } \n + } else { \n - for ( Description each : description . getChildren ( ) ) { \n - assertNoCategorizedDescendentsOfUncategorizeableParents ( each ) ; \n - } \n,"Avoid repeated checks . \n The only check is ` assertNoDescendantsHaveCategoryAnnotations ` . It \n checks all descendants . Hence further calls of \n ` assertNoCategorizedDescendentsOfUncategorizeableParents ` for each \n child are redundant , because it has already been checked .",472
src \ test \ java \ org \ junit \ tests \ internal \ runners \ statements \ FailOnTimeoutTest . java \n - private static final int DURATION _ THAT _ EXCEEDS _ TIMEOUT = Integer . MAX _ VALUE ; \n + private static final int DURATION _ THAT _ EXCEEDS _ TIMEOUT = 60 * 60 * 1000 ; / / 1 hour \n - } \n + } \n,Use a smaller DURATION _ THAT _ EXCEEDS _ TIMEOUT value . \n Integer . MAX _ VALUE might cause problems in some implementations .,472
"pom . xml \n + < destDir > javadoc / latest < / destDir > \n src \ site \ xdoc \ index . xml \n - < li > < a href = "" . / apidocs / "" > JavaDocs < / a > < / li > \n + < li > < a href = "" javadoc / latest / index . html "" > JavaDocs < / a > < / li > \n","Restore folder ` javadoc / latest ` for Javadoc . \n This folder has been used for many years . There are links to Javadoc at \n that folder ( e . g . http : / / stackoverflow . com / questions / 156503 / how - do - you - assert - that - a - certain - exception - is - thrown - in - junit - 4 - tests / 2935935 # 2935935 ) . \n Restoring the folder ` javadoc / latest ` will hopefully restore the \n Javadoc pages in Google Search , too .",472
pom . xml \n - - > \n - < version > 3 . 1 < / version > \n + < version > 3 . 2 < / version > \n - < version > 1 . 11 < / version > \n + < version > 1 . 13 < / version > \n - - > \n - < version > 2 . 17 < / version > \n + < version > 2 . 18 < / version > \n - - > \n - < version > 2 . 2 . 1 < / version > \n + < version > 2 . 4 < / version > \n - - > \n - < version > 2 . 9 . 1 < / version > \n + < version > 2 . 10 . 1 < / version > \n - < version > 2 . 5 < / version > \n + < version > 2 . 5 . 1 < / version > \n - < version > 3 . 3 < / version > \n + < version > 3 . 4 < / version > \n - < version > 2 . 4 < / version > \n + < version > 2 . 5 < / version > \n - < version > 2 . 9 . 1 < / version > \n + < version > 2 . 10 . 1 < / version > \n - < version > 2 . 17 < / version > \n + < version > 2 . 18 < / version > \n,Update plugins to current versions . \n maven - compiler - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 . 1 - > 3 . 2 \n maven - jar - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 4 - > 2 . 5 \n maven - javadoc - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 9 . 1 - > 2 . 10 . 1 \n maven - release - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 5 - > 2 . 5 . 1 \n maven - site - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 . 3 - > 3 . 4 \n maven - source - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 2 . 1 - > 2 . 4 \n maven - surefire - plugin . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2 . 17 - > 2 . 18 \n org . codehaus . mojo : animal - sniffer - maven - plugin . . . . . . . . . . 1 . 11 - > 1 . 13,472
"src \ test \ java \ org \ junit \ tests \ running \ classes \ ParameterizedTestTest . java \n + import static org . junit . Assert . fail ; \n - public void count ( ) { \n + public void countsRuns ( ) { \n - assertEquals ( 6 , result . getFailureCount ( ) ) ; \n + @ RunWith ( Parameterized . class ) \n + public static class ThreeFailures { \n + @ Parameters \n + public static Collection < Integer > data ( ) { \n + return Arrays . asList ( 1 , 2 , 3 ) ; \n + } \n + \n + @ Parameter ( 0 ) \n + public int unused ; \n + \n + @ Test \n + public void testSomething ( ) { \n + fail ( ) ; \n + } \n + } \n + \n + @ Test \n + public void countsFailures ( ) throws Exception { \n + Result result = JUnitCore . runClasses ( ThreeFailures . class ) ; \n + assertEquals ( 3 , result . getFailureCount ( ) ) ; \n + } \n + \n",Separate tests for failure and run count . \n A test should only test a single thing .,472
"src \ test \ java \ org \ junit \ tests \ running \ classes \ ParameterizedTestTest . java \n - public void countWithParameterizedField ( ) { \n + public void providesDataByAnnotatedFields ( ) { \n - @ Test \n - public void failuresNamedCorrectlyWithParameterizedField ( ) { \n - Result result = JUnitCore . runClasses ( FibonacciWithParameterizedFieldTest . class ) ; \n - assertEquals ( String \n - . format ( "" test [ 1 ] ( % s ) "" , FibonacciWithParameterizedFieldTest . class . getName ( ) ) , result \n - . getFailures ( ) . get ( 0 ) . getTestHeader ( ) ) ; \n - } \n - \n - @ Test \n - public void countBeforeRunWithParameterizedField ( ) throws Exception { \n - Runner runner = Request . aClass ( FibonacciWithParameterizedFieldTest . class ) . getRunner ( ) ; \n - assertEquals ( 7 , runner . testCount ( ) ) ; \n - } \n - \n - @ Test \n - public void plansNamedCorrectlyWithParameterizedField ( ) throws Exception { \n - Runner runner = Request . aClass ( FibonacciWithParameterizedFieldTest . class ) . getRunner ( ) ; \n - Description description = runner . getDescription ( ) ; \n - assertEquals ( "" [ 0 ] "" , description . getChildren ( ) . get ( 0 ) . getDisplayName ( ) ) ; \n - } \n - \n","Remove some tests . \n We don ' t have to test the test and failure naming for tests with \n @ Parameter annotation again , because it is not different from the test \n that sets the parameters via constructor .",472
"src \ main \ java \ org \ junit \ runners \ parameterized \ BlockJUnit4ClassRunnerWithParameters . java \n + private enum InjectionType { \n + CONSTRUCTOR , FIELD \n + } \n + \n - if ( fieldsAreAnnotated ( ) ) { \n - return createTestUsingFieldInjection ( ) ; \n - } else { \n - return createTestUsingConstructorInjection ( ) ; \n + InjectionType injectionType = getInjectionType ( ) ; \n + switch ( injectionType ) { \n + case CONSTRUCTOR : \n + return createTestUsingConstructorInjection ( ) ; \n + case FIELD : \n + return createTestUsingFieldInjection ( ) ; \n + default : \n + throw new IllegalStateException ( "" The injection type "" \n + + injectionType + "" is not supported . "" ) ; \n - if ( fieldsAreAnnotated ( ) ) { \n + if ( getInjectionType ( ) ! = InjectionType . CONSTRUCTOR ) { \n - if ( fieldsAreAnnotated ( ) ) { \n + if ( getInjectionType ( ) = = InjectionType . FIELD ) { \n + private InjectionType getInjectionType ( ) { \n + if ( fieldsAreAnnotated ( ) ) { \n + return InjectionType . FIELD ; \n + } else { \n + return InjectionType . CONSTRUCTOR ; \n + } \n + } \n + \n",Make injection type explicit . \n Makes it easier to understand the code .,472
src \ test \ java \ org \ junit \ tests \ experimental \ AssumptionTest . java \n - public void assumeNotNullSingleNullThrowsException ( ) { \n + public void assumeNotNullThrowsExceptionForNullArray ( ) { \n,Improve test method name . \n Replace ` assumeNotNullSingleNullThrowsException ` by \n ` assumeNotNullThrowsExceptionForNullArray ` because it is more clear .,472
"src \ main \ java \ org \ junit \ runners \ parameterized \ BlockJUnit4ClassRunnerWithParameters . java \n + } catch ( IllegalAccessException e ) { \n + IllegalAccessException wrappedException = new IllegalAccessException ( \n + "" Cannot set parameter ' "" + field . getName ( ) \n + + "" ' . Ensure that the field ' "" + field . getName ( ) \n + + "" ' is public . "" ) ; \n + wrappedException . initCause ( e ) ; \n + throw wrappedException ; \n + "" : Trying to set "" + field . getName ( ) \n src \ test \ java \ org \ junit \ runners \ parameterized \ BlockJUnit4ClassRunnerWithParametersTest . java \n + import static org . hamcrest . CoreMatchers . instanceOf ; \n + import static org . junit . rules . ExpectedException . none ; \n + import java . util . Collections ; \n + import org . junit . Rule ; \n + import org . junit . rules . ExpectedException ; \n + @ Rule \n + public final ExpectedException thrown = none ( ) ; \n + \n + \n + @ RunWith ( Parameterized . class ) \n + public static class ClassWithPrivateParameter { \n + @ Parameterized . Parameter \n + private String parameter ; \n + \n + @ Test \n + public void dummyTest ( ) { \n + } \n + } \n + \n + @ Test \n + public void providesHelpfulMessageIfParameterFieldCannotBeSet ( ) \n + throws Exception { \n + TestWithParameters testWithParameters = new TestWithParameters ( \n + "" dummy name "" , \n + new TestClass ( ClassWithPrivateParameter . class ) , \n + Collections . < Object > singletonList ( "" dummy parameter "" ) ) ; \n + BlockJUnit4ClassRunnerWithParameters runner = new BlockJUnit4ClassRunnerWithParameters ( \n + testWithParameters ) ; \n + \n + thrown . expect ( IllegalAccessException . class ) ; \n + thrown . expectCause ( instanceOf ( IllegalAccessException . class ) ) ; \n + thrown . expectMessage ( "" Cannot set parameter ' parameter ' . Ensure that the field ' parameter ' is public . "" ) ; \n + \n + runner . createTest ( ) ; \n + } \n","Provide helpful message if parameter cannot be set . \n For private @ Parameter fields is users get an exception like \n "" java . lang . IllegalAccessException : Class . . . can not access a member \n of class X with modifiers private "" The new message "" Cannot set \n parameter ' parameter ' . Ensure that the the field ' parameter ' is \n public . "" tells the user what they should do . \n The reason for adding this feature is the Stackoverflow question \n https : / / stackoverflow . com / questions / 44522046 / reflection - exception - in - parameterized - junit - test - using - array - parameter / 44522988",472
. travis . yml \n - openjdk - 6 - jdk \n - - oraclejdk7 \n - oraclejdk8 \n - openjdk7 \n - openjdk6 \n,Don ' t build with Oracle JDK 7 on Travis anymore \n Travis switched from Ubuntu Precise images to Ubuntu Trusty images . The \n Trusty images don ' t have installed Oracle JDK 7 . See \n travis - ci / travis - ci # 7884 We still build JUnit 4 with OpenJDK 7 . \n Therefore it is fine to not build it with Oracle JDK 7 .,472
"src \ test \ java \ org \ junit \ tests \ running \ classes \ ParameterizedTestTest . java \n - import static org . junit . Assume . assumeTrue ; \n + import static org . junit . Assume . assumeFalse ; \n - import java . util . ArrayList ; \n - import org . junit . runner . notification . RunListener ; \n - public static class ParameterizedAssumtionViolation { \n - static boolean condition ; \n + public static class AssumptionInParametersMethod { \n + static boolean assumptionFails ; \n - assumeTrue ( condition ) ; \n + assumeFalse ( assumptionFails ) ; \n - public ParameterizedAssumtionViolation ( String parameter ) { \n + public AssumptionInParametersMethod ( String parameter ) { \n - public void assumtionViolationInParameters ( ) { \n - ParameterizedAssumtionViolation . condition = true ; \n - Result successResult = JUnitCore . runClasses ( ParameterizedAssumtionViolation . class ) ; \n - assertTrue ( successResult . wasSuccessful ( ) ) ; \n - assertEquals ( 2 , successResult . getRunCount ( ) ) ; \n - \n - ParameterizedAssumtionViolation . condition = false ; \n - JUnitCore core = new JUnitCore ( ) ; \n - final List < Failure > assumptionFailures = new ArrayList < Failure > ( ) ; \n - core . addListener ( new RunListener ( ) { \n - @ Override \n - public void testAssumptionFailure ( Failure failure ) { \n - assumptionFailures . add ( failure ) ; \n - } \n - } ) ; \n - Result failureResult = core . run ( ParameterizedAssumtionViolation . class ) ; \n - assertTrue ( failureResult . wasSuccessful ( ) ) ; \n - assertEquals ( 0 , failureResult . getRunCount ( ) ) ; \n - assertEquals ( 0 , failureResult . getIgnoreCount ( ) ) ; \n - assertEquals ( 1 , assumptionFailures . size ( ) ) ; \n + public void testsAreExecutedWhenAssumptionInParametersMethodDoesNotFail ( ) { \n + AssumptionInParametersMethod . assumptionFails = false ; \n + Result result = JUnitCore . runClasses ( AssumptionInParametersMethod . class ) ; \n + assertTrue ( result . wasSuccessful ( ) ) ; \n + assertEquals ( 0 , result . getAssumptionFailureCount ( ) ) ; \n + assertEquals ( 0 , result . getIgnoreCount ( ) ) ; \n + assertEquals ( 2 , result . getRunCount ( ) ) ; \n + } \n + \n + @ Test \n + public void testsAreNotExecutedWhenAssumptionInParametersMethodFails ( ) { \n + AssumptionInParametersMethod . assumptionFails = true ; \n + Result result = JUnitCore . runClasses ( AssumptionInParametersMethod . class ) ; \n + assertTrue ( result . wasSuccessful ( ) ) ; \n + assertEquals ( 1 , result . getAssumptionFailureCount ( ) ) ; \n + assertEquals ( 0 , result . getIgnoreCount ( ) ) ; \n + assertEquals ( 0 , result . getRunCount ( ) ) ; \n",Improve test for assumption in Parameters method \n Improve readability by using more descriptive names . Split single test \n into two so that the two parts can fail independently . This makes it \n easier to find mistakes .,472
"src \ main \ java \ org \ junit \ runners \ Parameterized . java \n + import org . junit . runner . Result ; \n + * < h3 > Avoid creating parameters < / h3 > \n + * < p > With { @ link org . junit . Assume assumptions } you can dynamically skip tests . \n + * Assumptions are also supported by the < code > & # 064 ; Parameters < / code > method . \n + * Creating parameters is stopped when the assumption fails and none of the \n + * tests in the test class is executed . JUnit reports a \n + * { @ link Result # getAssumptionFailureCount ( ) single assumption failure } for the \n + * whole test class in this case . \n + * < pre > \n + * & # 064 ; Parameters \n + * public static Iterable & lt ; ? extends Object & gt ; data ( ) { \n + * String os = System . getProperty ( "" os . name "" ) . toLowerCase ( ) \n + * Assume . assumeTrue ( os . contains ( "" win "" ) ) ; \n + * return Arrays . asList ( & quot ; first test & quot ; , & quot ; second test & quot ; ) ; \n + * } \n + * < / pre > \n",Add assumption support to Javadoc of Parameterized \n Since 7111b9621997f6c660687b8ac04003398343ee3a we support assumptions in \n @ Parameters methods . This commit adds a description of this feature to \n the Javadoc of the Parameterized runner so that people can discover the \n new feature more easily .,472
src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - protected boolean tryDelete ( ) { \n + private boolean tryDelete ( ) { \n,"Set visibility of method "" tryDelete "" to private \n Ensure that we can change the methods signature in the future . This is \n only possible if no JUnit user can override it . Private methods cannot \n be overridden .",472
"doc \ ReleaseNotes4 . 12 . md \n + A specified timeout of 0 will be interpreted as not set , however tests still launch from separate threads . This can be useful for disabling timeouts in environments where they are dynamically set based on some property . \n + \n",Add description for pull request # 876 \n We missed to add it before we released JUnit 4 . 12 . I think it may be \n still helpful when someone reads the old release notes .,472
"src \ test \ java \ org \ junit \ rules \ ErrorCollectorTest . java \n - hasSingleFailure ( ) } , \n + allOf ( hasSingleFailure ( ) , hasNoAssumptionFailure ( ) ) } , \n - hasSingleFailure ( ) } , \n + allOf ( hasSingleFailure ( ) , hasNoAssumptionFailure ( ) ) } , \n - hasSingleFailure ( ) } , \n + allOf ( hasSingleFailure ( ) , hasNoAssumptionFailure ( ) ) } , \n",Improve tests with AssumptionViolatedExceptions \n The expectations that the test are failing and not being skipped is now \n explicit .,472
"src \ test \ java \ org \ junit \ rules \ EventCollector . java \n - class EventCollector extends RunListener { \n + public class EventCollector extends RunListener { \n - static Matcher < EventCollector > hasSingleFailureWithMessage ( String message ) { \n + public static Matcher < EventCollector > hasSingleFailureWithMessage ( String message ) { \n src \ test \ java \ org \ junit \ runner \ RequestTest . java \n + import static org . junit . rules . EventCollector . hasSingleFailureWithMessage ; \n + import org . junit . rules . EventCollector ; \n + import org . junit . runners . model . InitializationError ; \n + import org . junit . runners . model . RunnerBuilder ; \n + \n + @ Test \n + public void reportsInitializationErrorThrownWhileCreatingSuite ( ) { \n + EventCollector collector = new EventCollector ( ) ; \n + JUnitCore core = new JUnitCore ( ) ; \n + core . addListener ( collector ) ; \n + \n + core . run ( new FailingComputer ( ) , FooTest . class , BarTest . class ) ; \n + \n + assertThat ( collector , hasSingleFailureWithMessage ( "" cannot create suite "" ) ) ; \n + } \n + \n + private static class FailingComputer extends Computer { \n + @ Override \n + public Runner getSuite ( RunnerBuilder builder , Class < ? > [ ] classes ) \n + throws InitializationError { \n + throw new InitializationError ( "" cannot create suite "" ) ; \n + } \n + } \n + \n + private static class FooTest { \n + } \n + \n + private static class BarTest { \n + } \n",Add test for handling InitializationError \n The code was changed by commit 0804ef4cd09b0e94783a9882c60914e22fca5108 \n but unfortunately the test was not part of the commit . The test is based \n on Philip Graf ' s test in pull request # 1065 . \n Co - authored - by : Philip Graf < git @ acanda . ch >,472
". travis . yml \n - openjdk - 6 - jdk \n + - oraclejdk9 \n - oraclejdk8 \n - openjdk7 \n - openjdk6 \n pom . xml \n + < profile > \n + < id > java9 < / id > \n + < activation > \n + < jdk > [ 1 . 9 , ) < / jdk > \n + < / activation > \n + < properties > \n + < ! - - JDK 9 minimal source and target versions are 1 . 6 - - > \n + < jdkVersion > 1 . 6 < / jdkVersion > \n + < / properties > \n + < / profile > \n",Support building JUnit on JDK 9 \n Developers with a current JDK 9 on their machines are currently not able \n to easily build JUnit . This commit makes it possible to develop with \n JDK 9 and ensures that JUnit can be build with JDK 0 .,472
"src \ main \ java \ org \ junit \ internal \ Throwables . java \n + "" jdk . internal . reflect . "" , \n",Identify reflection package jdk . internal . reflect \n JDK 9 uses classes from the package jdk . internal . reflect instead of \n sun . reflect .,472
"src \ test \ java \ org \ junit \ runners \ model \ TestClassTest . java \n - } \n + } \n - TestClass tc = new TestClass ( MethodsAnnotated . class ) ; \n - List < FrameworkMethod > annotatedMethods = tc . getAnnotatedMethods ( ) ; \n - assertThat ( "" Wrong number of annotated methods . "" , \n - annotatedMethods . size ( ) , is ( 3 ) ) ; \n - assertThat ( "" First annotated method is wrong . "" , annotatedMethods \n - . iterator ( ) . next ( ) . getName ( ) , is ( "" methodA "" ) ) ; \n + TestClass tc = new TestClass ( MethodsAnnotated . class ) ; \n + List < FrameworkMethod > annotatedMethods = tc . getAnnotatedMethods ( ) ; \n + assertThat ( "" Wrong number of annotated methods . "" , \n + annotatedMethods . size ( ) , is ( 3 ) ) ; \n + assertThat ( "" First annotated method is wrong . "" , annotatedMethods \n + . iterator ( ) . next ( ) . getName ( ) , is ( "" methodA "" ) ) ; \n - TestClass tc = new TestClass ( MethodsAnnotated . class ) ; \n - List < String > values = tc . getAnnotatedMethodValues ( \n - new MethodsAnnotated ( ) , Ignore . class , String . class ) ; \n - assertThat ( values , hasItem ( "" jupiter "" ) ) ; \n - assertThat ( values . size ( ) , is ( 1 ) ) ; \n + TestClass tc = new TestClass ( MethodsAnnotated . class ) ; \n + List < String > values = tc . getAnnotatedMethodValues ( \n + new MethodsAnnotated ( ) , Ignore . class , String . class ) ; \n + assertThat ( values , hasItem ( "" jupiter "" ) ) ; \n + assertThat ( values . size ( ) , is ( 1 ) ) ; \n",Replace tabs with spaces \n Use same coding style within TestClassTest .,472
src \ test \ java \ org \ junit \ rules \ ErrorCollectorTest . java \n + import org . hamcrest . Matchers ; \n - hasSingleFailureWithMessage ( allOf ( \n + hasSingleFailureWithMessage ( Matchers . < String > allOf ( \n - hasSingleFailureWithMessage ( allOf ( \n + hasSingleFailureWithMessage ( Matchers . < String > allOf ( \n,Add explicit type parameters for JDK 5 \n The code did not compile with JDK 5 before .,472
"src \ test \ java \ org \ junit \ runners \ model \ TestClassTest . java \n - import static org . hamcrest . CoreMatchers . hasItem ; \n - import static org . hamcrest . CoreMatchers . is ; \n - import static org . hamcrest . CoreMatchers . nullValue ; \n + import static org . hamcrest . Matchers . * ; \n + import java . util . ArrayList ; \n + \n + public int methodWithoutAnnotation ( ) { \n + return 0 ; \n + } \n - assertThat ( "" Wrong number of annotated methods . "" , \n - annotatedMethods . size ( ) , is ( 3 ) ) ; \n + @ Test \n + public void getAnnotatedMethodsDoesNotReturnMethodWithoutAnnotation ( ) { \n + TestClass tc = new TestClass ( MethodsAnnotated . class ) ; \n + List < FrameworkMethod > annotatedMethods = tc . getAnnotatedMethods ( ) ; \n + List < String > methodNames = extractNames ( annotatedMethods ) ; \n + assertThat ( methodNames , not ( hasItem ( "" methodWithoutAnnotation "" ) ) ) ; \n + } \n + \n + private List < String > extractNames ( List < FrameworkMethod > methods ) { \n + List < String > names = new ArrayList < String > ( ) ; \n + for ( FrameworkMethod method : methods ) { \n + names . add ( method . getName ( ) ) ; \n + } \n + return names ; \n + } \n + \n",Test that not annotated methods are ignored \n Make the test less fragile . The number of annotated methods varies \n because Java 9 introduces new annotations for some methods of Object .,472
"src \ test \ java \ org \ junit \ runners \ model \ TestClassTest . java \n - assertThat ( "" First annotated method is wrong . "" , annotatedMethods \n - . iterator ( ) . next ( ) . getName ( ) , is ( "" methodA "" ) ) ; \n + List < String > methodNames = extractNames ( annotatedMethods ) ; \n + assertThat ( methodNames . indexOf ( "" methodA "" ) , \n + lessThan ( methodNames . indexOf ( "" methodB "" ) ) ) ; \n",Compare order of methods explicitly \n Make the test providesAnnotatedMethodsSortedByName less fragile . ( Before \n the test failed on JDK 9 because Java 9 introduces new annotations for \n some methods of Object . ),472
"src \ main \ java \ org \ junit \ rules \ ExpectedException . java \n + * < p > It is recommended to set the { @ link org . junit . Rule # order ( ) order } of the \n + * { @ code ExpectedException } to { @ code Integer . MAX _ VALUE } if it is used together \n + * with another rule that handles exceptions , e . g . { @ link ErrorCollector } . \n + * Otherwise failing tests may be successful . \n + * < pre > & # 064 ; Rule ( order = Integer . MAX _ VALUE ) \n + * public ExpectedException thrown = ExpectedException . none ( ) ; < / pre > \n + * \n src \ test \ java \ org \ junit \ rules \ ExpectedExceptionTest . java \n - + "" - an instance of java . lang . IllegalArgumentException "" ) } \n + + "" - an instance of java . lang . IllegalArgumentException "" ) } , \n + { \n + ErrorCollectorShouldFailAlthoughExpectedExceptionDoesNot . class , \n + hasSingleFailureWithMessage ( ARBITRARY _ MESSAGE ) } \n + \n + public static class ErrorCollectorShouldFailAlthoughExpectedExceptionDoesNot { \n + \n + @ Rule \n + public ErrorCollector collector = new ErrorCollector ( ) ; \n + \n + @ Rule ( order = Integer . MAX _ VALUE ) \n + public ExpectedException thrown = ExpectedException . none ( ) ; \n + \n + @ Test \n + public void test ( ) { \n + collector . addError ( new AssertionError ( ARBITRARY _ MESSAGE ) ) ; \n + thrown . expect ( Exception . class ) ; \n + throw new RuntimeException ( ) ; \n + } \n + } \n",Recommend to set order for ExpectedException \n A test that should fail because of ErrorCollector may not fail when this \n test throws an exception that is expected by ExpectedException . \n Fixes # 1466 .,472
. travis . yml \n + install : \n + # Download dependencies with JDK 8 because Mave Central supports \n + # TLS 1 . 2 only but OpenJDK 6 does not . \n + - export ORIGINAL _ JAVA _ HOME = $ JAVA _ HOME \n + - jdk _ switcher use oraclejdk8 \n + - . / mvnw test - DskipTests \n + # Delete all files created with JDK 8 \n + - . / mvnw clean \n + # Restore desired JDK \n + - export JAVA _ HOME = $ ORIGINAL _ JAVA _ HOME \n + # Run original install command but without GPG signing \n + - . / mvnw install - DskipTests \n,"Download dependencies with JDK 8 \n As of June 18th 2018 , Maven Central supports TLS 1 . 2 only . Therefore we \n cannot install dependencies with JDK 6 anymore . As a workaround we \n switch in each build temporarily to JDK 8 for downloading the \n dependencies . Afterwards we restore the desired JDK and build System \n Rules with it .",472
"src \ site \ xdoc \ index . xml \n - < a href = "" https : / / junit - toolbox . googlecode . com / "" > JUnit Toolbox < / a > - Provides runners for parallel testing , a < code > PoolingWait < / code > class to ease asynchronous testing , and a < code > WildcardPatternSuite < / code > which allow you to specify wildcard patterns instead of explicitly listing all classes when you create a suite class . < / li > \n + < a href = "" https : / / github . com / MichaelTamm / junit - toolbox "" > JUnit Toolbox < / a > - Provides runners for parallel testing , a < code > PoolingWait < / code > class to ease asynchronous testing , and a < code > WildcardPatternSuite < / code > which allow you to specify wildcard patterns instead of explicitly listing all classes when you create a suite class . < / li > \n",Fix link to JUnit Toolbox \n This project moved from Google Code to GitHub . \n Fixes # 1540 .,472
"doc \ ReleaseNotes4 . 7 . md \n - } ; \n + } \n - } ; \n + } \n doc \ ReleaseNotes4 . 9 . md \n - } ; \n + } \n - } ; \n + } \n src \ test \ java \ org \ junit \ rules \ ClassRulesTest . java \n - ; \n - \n - \n - ; \n src \ test \ java \ org \ junit \ rules \ ExternalResourceRuleTest . java \n - ; \n - \n - \n - ; \n src \ test \ java \ org \ junit \ rules \ MethodRulesTest . java \n - } ; \n + } \n src \ test \ java \ org \ junit \ rules \ TestRuleTest . java \n - \n - ; \n - \n - ; \n - \n - ; \n - \n - ; \n - \n - ; \n src \ test \ java \ org \ junit \ runner \ notification \ RunNotifierTest . java \n - ThreadSafeListener listener = new ThreadSafeListener ( ) ; ; \n + ThreadSafeListener listener = new ThreadSafeListener ( ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ WithAutoGeneratedDataPoints . java \n - private enum ENUM { VALUE , OTHER _ VALUE , THIRD _ VALUE } ; \n + private enum ENUM { VALUE , OTHER _ VALUE , THIRD _ VALUE } \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ WithExtendedParameterSources . java \n - ; \n - \n - ; \n - \n src \ test \ java \ org \ junit \ tests \ validation \ BadlyFormedClassesTest . java \n - ; \n - \n - ; \n - \n",Delete unnecessary semicolons \n These semicolons are the source of distracting warnings in the IDE .,472
"src \ test \ java \ org \ junit \ rules \ TestRuleTest . java \n - public static class MethodBeforesAndAfters { \n + public static class BeforesAndAftersAreEnclosedByRule { \n - public void methodBeforesAndAfters ( ) { \n - MethodBeforesAndAfters . watchedLog = "" "" ; \n - JUnitCore . runClasses ( MethodBeforesAndAfters . class ) ; \n - assertThat ( MethodBeforesAndAfters . watchedLog , is ( "" starting before test after succeeded finished "" ) ) ; \n + public void beforesAndAftersAreEnclosedByRule ( ) { \n + BeforesAndAftersAreEnclosedByRule . watchedLog = "" "" ; \n + JUnitCore . runClasses ( BeforesAndAftersAreEnclosedByRule . class ) ; \n + assertThat ( BeforesAndAftersAreEnclosedByRule . watchedLog , is ( "" starting before test after succeeded finished "" ) ) ; \n","Improve expressiveness of test name \n The test name "" beforesAndAftersAreEnclosedByRule "" reflects the purpose \n of the test better than "" methodBeforesAndAfters "" .",472
"src \ test \ java \ org \ junit \ rules \ TemporaryFolderUsageTest . java \n + \n + @ Test \n + public void newFolderWithGivenFolderThrowsIOExceptionWhenFolderCannotBeCreated ( ) throws IOException { \n + tempFolder . create ( ) ; \n + assertTrue ( "" Could not make folder "" + tempFolder . getRoot ( ) + "" read only . "" , \n + tempFolder . getRoot ( ) . setReadOnly ( ) ) ; \n + \n + thrown . expect ( IOException . class ) ; \n + thrown . expectMessage ( "" could not create a folder with the path ' level1 ' "" ) ; \n + tempFolder . newFolder ( "" level1 "" ) ; \n + } \n",Check that newFolder fails for read only parent,472
"src \ main \ java \ org \ junit \ rules \ TemporaryFolder . java \n - throw new IOException ( \n - "" could not create a folder with the path \ ' "" + relativePath . getPath ( ) + "" \ ' "" ) ; \n + if ( file . exists ( ) ) { \n + throw new IOException ( \n + "" a file with the path \ ' "" + relativePath . getPath ( ) + "" \ ' exists "" ) ; \n + } else { \n + throw new IOException ( \n + "" could not create a folder with the path \ ' "" + relativePath . getPath ( ) + "" \ ' "" ) ; \n + } \n src \ test \ java \ org \ junit \ rules \ TemporaryFolderUsageTest . java \n - thrown . expectMessage ( "" could not create a folder with the path ' level1 ' "" ) ; \n + thrown . expectMessage ( "" a file with the path ' level1 ' exists "" ) ; \n","Improve message if file exists instead of folder \n When TemporaryFolder ( String path ) or TemporaryFolder ( String . . . paths ) is \n called with a path that matches the path of an existing file then an \n IOException with a message like "" a file with path < path > exists "" is \n thrown .",472
"src \ main \ java \ org \ junit \ runners \ model \ FrameworkField . java \n - return isStatic ( ) & & otherMember . getName ( ) . equals ( getName ( ) ) ; \n + return otherMember . getName ( ) . equals ( getName ( ) ) ; \n src \ main \ java \ org \ junit \ runners \ model \ FrameworkMember . java \n - / * * \n - * Check if this member is shadowed by any of the given members . If it \n - * is , the other member is removed . \n - * \n - * @ return member that should be used , or { @ code null } if no member should be used . \n - * / \n - final T handlePossibleShadowedMember ( List < T > members ) { \n + T handlePossibleBridgeMethod ( List < T > members ) { \n - return self ( ) ; \n - } \n - \n - @ SuppressWarnings ( "" unchecked "" ) \n - private T self ( ) { \n src \ main \ java \ org \ junit \ runners \ model \ TestClass . java \n - T memberToAdd = member . handlePossibleShadowedMember ( members ) ; \n + T memberToAdd = member . handlePossibleBridgeMethod ( members ) ; \n src \ test \ java \ org \ junit \ runners \ model \ TestClassTest . java \n - public void fieldsOnSubclassesDoNotShadowSuperclasses ( ) { \n + public void fieldsOnSubclassesShadowSuperclasses ( ) { \n - Rule . class ) . size ( ) , is ( 2 ) ) ; \n + Rule . class ) . size ( ) , is ( 1 ) ) ; \n src \ test \ java \ org \ junit \ tests \ running \ methods \ AnnotationTest . java \n - public void testFieldsNeverTreatedAsShadowed ( ) throws Exception { \n + public void testFieldsShadowFieldsFromParent ( ) throws Exception { \n - "" super . rule . before ( ) sub . rule . before ( ) "" \n + "" sub . rule . before ( ) "" \n + "" Test "" \n - + "" sub . rule . after ( ) super . rule . after ( ) "" , \n + + "" sub . rule . after ( ) "" , \n",Restore that fields shadow fields from super class \n This commit restores the shadowing behaviour of JUnit 4 . 12 . Some users \n of JUnit 4 have tests that rely on this behaviour . Their tests would \n fail with JUnit 4 . 13 . \n This commit finally reverts 39b8a92d24e6c81e4fc614cdf13003ce17bbc166 . \n Some parts have already been reverted by \n ed6813d3bbe2da4d67892f73e641fa80ab4d126e .,472
src \ main \ java \ org \ junit \ Assert . java \n - * @ see org . hamcrest . MatcherAssert \n + * @ deprecated use { @ code org . hamcrest . MatcherAssert . assertThat ( ) } \n + @ Deprecated \n - * @ see org . hamcrest . MatcherAssert \n + * @ deprecated use { @ code org . hamcrest . MatcherAssert . assertThat ( ) } \n + @ Deprecated \n,"Deprecate Assert # assertThat \n The method "" assertThat "" is used for writing assertions with Hamcrest . \n Hamcrest is an independent assertion library and contains an own \n "" assertThat "" method in the class "" org . hamcrest . MatcherAssert "" . It is \n available both in the old Hamcrest 1 . 3 release and in the current \n Hamcrest 2 . 1 . Therefore the JUnit team recommends to use Hamcrest ' s own \n "" assertThat "" directly .",472
. travis . yml \n + dist : trusty \n + \n,Run tests on Ubuntu Trusty \n Trusty has support for OpenJDK 6 and other old JDKs .,472
"src \ main \ java \ org \ junit \ Test . java \n - * The < code > Test < / code > annotation supports two optional parameters . \n - * The first , < code > expected < / code > , declares that a test method should throw \n + * The < code > Test < / code > annotation supports two optional parameters for \n + * exception testing and for limiting test execution time . \n + * \n + * < h3 > Exception Testing < / h3 > \n + * < p > \n + * The parameter < code > expected < / code > declares that a test method should throw \n + * \n + * < h3 > Timeout < / h3 > \n - * The second optional parameter , < code > timeout < / code > , causes a test to fail if it takes \n + * The parameter < code > timeout < / code > causes a test to fail if it takes \n",Add sub headlines to class Javadoc \n Structure the Javadoc .,472
src \ main \ java \ org \ junit \ Test . java \n - * & # 064 ; Test ( < b > expected = IndexOutOfBoundsException . class < / b > ) public void outOfBounds ( ) { \n + * & # 064 ; Test ( < b > expected = IndexOutOfBoundsException . class < / b > ) \n + * public void outOfBounds ( ) { \n - * & # 064 ; Test ( < b > timeout = 100 < / b > ) public void infinity ( ) { \n + * & # 064 ; Test ( < b > timeout = 100 < / b > ) \n + * public void infinity ( ) { \n - * & # 064 ; Test ( < b > timeout = 100 < / b > ) public void sleep100 ( ) { \n + * & # 064 ; Test ( < b > timeout = 100 < / b > ) \n + * public void sleep100 ( ) { \n,Use separate line for annotation in Javadoc \n Align coding style of the examples .,472
"src \ main \ java \ org \ junit \ Test . java \n + import org . junit . function . ThrowingRunnable ; \n + \n - * If the exception ' s message or one of its properties should be verified , the \n - * { @ link org . junit . rules . ExpectedException ExpectedException } rule can be used . Further \n + * \n + * Using the parameter < code > expected < / code > for exception testing comes with \n + * some limitations : only the exception ' s type can be checked and it is not \n + * possible to precisely specify the code that throws the exception . Therefore \n + * JUnit 4 has improved its support for exception testing with \n + * { @ link Assert # assertThrows ( Class , ThrowingRunnable ) } and the \n + * { @ link org . junit . rules . ExpectedException ExpectedException } rule . \n + * With < code > assertThrows < / code > the code that throws the exception can be \n + * precisely specified . If the exception ' s message or one of its properties \n + * should be verified , the < code > ExpectedException < / code > rule can be used . Further \n",Add a link to assertThrows in exception testing \n Provide information about alternatives to the expected parameter which \n can be used to overcome the limitations of expected . \n This is an improvement for JUnit 4 . 13 to the fix for # 806 \n ( 84dcb64cf07eba08fd7ef4de3a6aaf21f4944157 ) .,472
doc \ ReleaseNotes4 . 13 . md \n + # # # [ Pull request # 1150 : ] ( https : / / github . com / junit - team / junit4 / pull / 1150 ) Deprecate ` Assert # assertThat ` \n + \n + The method ` assertThat ` is used for writing assertions with Hamcrest . Hamcrest is an independent assertion library and contains an own ` assertThat ` method in the class ` org . hamcrest . MatcherAssert ` . It is available both in the old Hamcrest 1 . 3 release and in the current Hamcrest 2 . 1 . Therefore the JUnit team recommends to use Hamcrest ' s own ` assertThat ` directly . \n + \n,"Add "" Deprecate Assert # assertThat "" \n We forgot to add this changes to the release notes . \n Fixes # 1645 .",472
". travis . settings . xml \n + < mirrors xmlns = "" http : / / maven . apache . org / SETTINGS / 1 . 1 . 0 "" > \n + < mirror > \n + < mirrorOf > central < / mirrorOf > \n + < name > GCS Maven Central mirror < / name > \n + < url > https : / / maven - central . storage - download . googleapis . com / maven2 / < / url > \n + < id > google - maven - central < / id > \n + < / mirror > \n + < / mirrors > \n","Use Google ' s Maven Central mirror \n We are using Maven 3 . 1 . 1 which by default uses HTTP instead of HTTPS for \n resolving artifacts from Maven Central . Maven Central recently \n discontinued HTTP support . Therefore the build on Travis started \n failing . By using an HTTPS mirror of Maven Central the build on Travis \n will work again . \n I chose Google ' s mirror because Travis uses this mirror by default , too . \n I did not upgrade to a new version of Maven because there is no newer \n version with Java 5 support and it should be possible to build JUnit 4 \n with Java 5 so that we can easily ensure that it works with Java 5 .",472
src \ test \ java \ org \ junit \ internal \ runners \ statements \ FailOnTimeoutTest . java \n - run ( failAfter50Ms ( new InfiniteLoop ( ) ) ) ) ; \n + run ( failAfter50Ms ( new RunForASecond ( ) ) ) ) ; \n - run ( failAfter50Ms ( new InfiniteLoop ( ) ) ) ) ; \n + run ( failAfter50Ms ( new RunForASecond ( ) ) ) ) ; \n - statement . delegate = new InfiniteLoop ( ) ; \n + statement . delegate = new RunForASecond ( ) ; \n - statement . delegate = new InfiniteLoop ( ) ; \n + statement . delegate = new RunForASecond ( ) ; \n - run ( failAfter50Ms ( new InfiniteLoop ( ) ) ) ) ; \n + run ( failAfter50Ms ( new RunForASecond ( ) ) ) ) ; \n - InfiniteLoop infiniteLoop = new InfiniteLoop ( ) ; \n + RunForASecond runForASecond = new RunForASecond ( ) ; \n - run ( failAfter50Ms ( infiniteLoop ) ) ) ; \n + run ( failAfter50Ms ( runForASecond ) ) ) ; \n - infiniteLoop . stillExecuting . set ( false ) ; \n + runForASecond . stillExecuting . set ( false ) ; \n - infiniteLoop . stillExecuting . get ( ) ) ; \n + runForASecond . stillExecuting . get ( ) ) ; \n - private static final class InfiniteLoop extends Statement { \n + private static final class RunForASecond extends Statement { \n - while ( true ) { \n + long timeout = currentTimeMillis ( ) + 1000L ; \n + while ( currentTimeMillis ( ) < timeout ) { \n,Replace InfiniteLoop with RunForASecond \n RunForASecond finally stops and therefore avoids that we create \n background threads that run forever .,472
"src \ test \ java \ org \ junit \ internal \ runners \ statements \ FailOnTimeoutTest . java \n - public void throwsTestTimedOutException ( ) { \n - assertThrows ( \n - TestTimedOutException . class , \n - run ( failAfter50Ms ( new RunForASecond ( ) ) ) ) ; \n - } \n - \n - @ Test \n - public void throwExceptionWithNiceMessageOnTimeout ( ) { \n + public void throwsTestTimedOutExceptionWithMeaningfulMessage ( ) { \n - Exception . class , \n + TestTimedOutException . class , \n",Merge test for exception type and message \n IMO this is conceptually one assert because the message and the \n exception type are strongly coupled .,472
"src \ test \ java \ org \ junit \ internal \ runners \ statements \ FailOnTimeoutTest . java \n + import static java . lang . Thread . interrupted ; \n + import java . util . concurrent . CountDownLatch ; \n - / / RunForASecond can be interrupted because it uses Thread . sleep which \n - / / can be interrupted . \n + / / RunForASecond can be interrupted because it checks the Thread ' s \n + / / interrupted flag . \n - sleep ( 20 ) ; / / time to interrupt the thread \n - runForASecond . stillExecuting . set ( false ) ; \n - sleep ( 20 ) ; / / time to increment the count \n - assertFalse ( \n - "" Thread has not been stopped . "" , \n - runForASecond . stillExecuting . get ( ) ) ; \n + / / Thread is explicitly stopped if it finishes faster than its \n + / / pre - defined execution time of one second . \n + boolean stopped = runForASecond . finished . await ( 50 , MILLISECONDS ) ; \n + assertTrue ( "" Thread has not been stopped . "" , stopped ) ; \n - Statement delegate ; \n + volatile Statement delegate ; \n - final AtomicBoolean stillExecuting = new AtomicBoolean ( ) ; \n + final CountDownLatch finished = new CountDownLatch ( 1 ) ; \n - while ( currentTimeMillis ( ) < timeout ) { \n - sleep ( 10 ) ; / / sleep in order to enable interrupting thread \n - stillExecuting . set ( true ) ; \n + while ( ! interrupted ( ) & & currentTimeMillis ( ) < timeout ) { \n + finished . countDown ( ) ; \n",Improve check that thread is stopped \n The new code is hopefully easier to understand because it makes it \n explicit that it checks that the statement is stopped within a period \n of time that is close to the timeout .,472
"flexbox \ src \ main \ java \ com \ google \ android \ flexbox \ FlexboxLayout . java \n + import java . util . Arrays ; \n - / / TODO : Move the object allocation to other methods instead of onMeasure \n - mChildrenFrozen = new boolean [ getChildCount ( ) ] ; \n + if ( mChildrenFrozen = = null | | mChildrenFrozen . length < getChildCount ( ) ) { \n + mChildrenFrozen = new boolean [ getChildCount ( ) ] ; \n + } \n + \n + Arrays . fill ( mChildrenFrozen , false ) ; \n",Suppress the creation of the boolean array in the every onMeasure method \n to reduce the frequency of GC . \n Change - Id : If96c13d4931d4416eff74cb0c945553e648db49e,494
flexbox \ src \ main \ java \ com \ google \ android \ flexbox \ FlexboxLayout . java \n + private static final int MAX _ SIZE = Integer . MAX _ VALUE & ViewCompat . MEASURED _ SIZE _ MASK ; \n + \n - public int maxWidth = Integer . MAX _ VALUE ; \n + public int maxWidth = MAX _ SIZE ; \n - public int maxHeight = Integer . MAX _ VALUE ; \n + public int maxHeight = MAX _ SIZE ; \n - Integer . MAX _ VALUE ) ; \n + MAX _ SIZE ) ; \n - Integer . MAX _ VALUE ) ; \n + MAX _ SIZE ) ; \n,Set the default values for layout _ maxWidth / layout _ maxHeight as the value \n masked by ViewCompat . MEASURED _ SIZE _ MASK since the view size can ' t be beyond \n that value and otherwise Android Studio warns in the MeasureSpec . makeMeasureSpec \n if there is a possibility an argument is passed beyond the value is passed . \n Change - Id : I4eb552c57d4f25a2ed3063c2e572385b74539adf,494
README . md \n + * layout _ minWidth / layout _ minHeight \n + * These attributes impose minimum size constraints for the children of FlexboxLayout . \n + A child view won ' t be shrank less than the value of these attributes ( varies based on the \n + ` flexDirection ` attribute as to which attribute imposes the size constraint along the \n + main axis ) regardless of the ` layout _ flexShrink ` attribute . \n + \n + * layout _ maxWidth / layout _ maxHeight \n + * These attributes impose maximum size constraints for the children of FlexboxLayout . \n + A child view won ' t be expanded more than the value of these attributes ( varies based on the \n + ` flexDirection ` attribute as to which attribute imposes the size constraint along the \n + main axis ) regardless of the ` layout _ flexGrow ` attribute . \n + \n - ( 4 ) min - width and min - height can ' t be specified \n - * Which isn ' t implemented just yet . \n - \n,Update README \n To mention layout _ minWidth / layout _ minHeight and \n layout _ maxWidth / layout _ maxHeight \n Change - Id : Ia281e7e546a31bb8ff68ea8932fc8360e2809dc8,494
README . md \n - compile ' com . google . android : flexbox : 0 . 1 . 3 ' \n + compile ' com . google . android : flexbox : 0 . 2 . 0 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 1 . 3 ' \n + mavenVersion = ' 0 . 2 . 0 ' \n,Bump version to 0 . 2 . 0 \n Change - Id : I1b1950ba952a6c2ad22bffe426e2a6ebcb84abb6,494
"flexbox \ src \ androidTest \ java \ com \ google \ android \ flexbox \ test \ FlexboxAndroidTest . java \n + @ Test \n + @ FlakyTest ( tolerance = TOLERANCE ) \n + public void testEmptyChildren ( ) throws Throwable { \n + final FlexboxTestActivity activity = mActivityRule . getActivity ( ) ; \n + mActivityRule . runOnUiThread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + activity . setContentView ( R . layout . activity _ empty _ children ) ; \n + } \n + } ) ; \n + FlexboxLayout flexboxLayout = ( FlexboxLayout ) activity . findViewById ( R . id . flexbox _ layout ) ; \n + \n + assertThat ( flexboxLayout . getChildCount ( ) , is ( 0 ) ) ; \n + } \n + \n new file \n flexbox \ src \ androidTest \ res \ layout \ activity _ empty _ children . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" utf - 8 "" ? > < ! - - \n + Copyright 2016 Google Inc . All rights reserved . \n + \n + Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + you may not use this file except in compliance with the License . \n + You may obtain a copy of the License at \n + \n + http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + \n + Unless required by applicable law or agreed to in writing , software \n + distributed under the License is distributed on an "" AS IS "" BASIS , \n + WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + See the License for the specific language governing permissions and \n + limitations under the License . \n + - - > \n + < com . google . android . flexbox . FlexboxLayout xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + xmlns : app = "" http : / / schemas . android . com / apk / res - auto "" \n + android : id = "" @ + id / flexbox _ layout "" \n + android : layout _ width = "" 320dp "" \n + android : layout _ height = "" 320dp "" \n + app : flexWrap = "" wrap "" > \n + \n + < / com . google . android . flexbox . FlexboxLayout > \n flexbox \ src \ main \ java \ com \ google \ android \ flexbox \ FlexboxLayout . java \n + if ( mOrderCache = = null ) { \n + mOrderCache = new SparseIntArray ( childCount ) ; \n + } \n",Fixes NPE when FlexboxLayout doesn ' t have any children .,494
README . md \n - compile ' com . google . android : flexbox : 0 . 2 . 0 ' \n + compile ' com . google . android : flexbox : 0 . 2 . 1 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 2 . 0 ' \n + mavenVersion = ' 0 . 2 . 1 ' \n,Bump version to 0 . 2 . 1,494
app \ src \ main \ java \ com \ google \ android \ apps \ flexbox \ SettingsActivity . java \n + import com . google . android . apps . flexbox . validators . DimensionInputValidator ; \n - import com . google . android . apps . flexbox . validators . DimensionInputValidator ; \n - import com . google . android . apps . flexbox . validators . NonNegativeIntegerInputValidator ; \n + import com . google . android . apps . flexbox . validators . NonNegativeDecimalInputValidator ; \n - InputValidator validator = new NonNegativeIntegerInputValidator ( ) ; \n + InputValidator validator = new NonNegativeDecimalInputValidator ( ) ; \n - InputValidator validator = new NonNegativeIntegerInputValidator ( ) ; \n + InputValidator validator = new NonNegativeDecimalInputValidator ( ) ; \n,Fix the build error . \n Change - Id : I8c1af10ca178eac86c7719c2fbd336b852615c1c,494
"README . md \n - You have two options to install the library . You can choose either of : \n + Add the following dependency to your ` build . gradle ` file . \n - ( 1 ) Add the following dependency to your ` build . gradle ` file \n - ( 2 ) Use the GitHub source and include that as a module dependency by following steps \n - * Clone this library , parallel to your own application project : \n - ` ` ` \n - git clone https : / / github . com / google / FlexboxLayout \n - ` ` ` \n - \n - * In the root of your application ' s project , edit the ` settings . gradle ` and add the following lines : \n - ` ` ` \n - include ' : FlexboxLayout ' \n - project ( ' : FlexboxLayout ' ) . projectDir = new File ( ' . . / FlexboxLayout / ' ) \n - ` ` ` \n - \n - * In your application ' s main module , edit your ` build . gradle ` to add a new dependency : \n - . . . \n - compile project ( ' : FlexboxLayout ' ) \n - } \n + compile ' com . google . android : flexbox : 0 . 1 . 0 ' \n + } \n build . gradle \n - buildToolsVersion = "" 23 . 0 . 2 "" \n + buildToolsVersion = "" 23 . 0 . 3 "" \n library \ build . gradle \n - versionName "" 1 . 0 "" \n + versionName "" 0 . 1 . 0 "" \n",Update the build tools version . \n Remove the description to install the library from source . \n Change - Id : I60bd354008b5e6f10071584d751aa379cfc75853,494
rename from app \ src \ main \ res \ values - w600dp \ dimens . xml \n rename to app \ src \ main \ res \ values - w720dp \ dimens . xml \n,Move the resource file for w600 to w720 .,494
new file \n assets \ flexbox - visual . png \n Binary files / dev / null and b / assets / flexbox - visual . png differ \n,Add a image to explain the Flexbox visually for Wiki . \n Change - Id : Iada30e7caad5719a669567d029291b36f96acbf7,494
"circle . yml \n + MAX _ RETRY : 4 \n - . / gradlew build assembleAndroidTest \n - - if [ - n "" $ GCLOUD _ SERVICE _ KEY "" ] ; then echo "" y "" | / tmp / google - cloud - sdk / bin / gcloud beta test android run - - type instrumentation - - app app / build / outputs / apk / app - debug . apk - - test flexbox / build / outputs / apk / flexbox - debug - androidTest - unaligned . apk - - device - ids hammerhead , flounder , condor _ umts - - os - version - ids 19 , 21 , 23 - - locales en , ar _ SS - - orientations portrait , landscape - - results - bucket $ { GCLOUD _ TEST _ BUCKET _ LIBRARY } - - timeout 180s ; fi \n + - > \n + if [ - n "" $ GCLOUD _ SERVICE _ KEY "" ] ; then set + e ; \n + counter = 0 ; \n + result = 1 ; \n + while [ $ result ! = 0 - a $ counter - lt $ MAX _ RETRY ] ; do \n + / tmp / google - cloud - sdk / bin / gcloud beta test android run - - type instrumentation - - app app / build / outputs / apk / app - debug . apk - - test flexbox / build / outputs / apk / flexbox - debug - androidTest - unaligned . apk - - device - ids hammerhead , flounder , condor _ umts - - os - version - ids 19 , 21 , 23 - - locales en - - orientations portrait , landscape - - results - bucket $ { GCLOUD _ TEST _ BUCKET _ LIBRARY } - - timeout 180s ; \n + result = $ ? ; \n + let counter = counter + 1 ; \n + done \n + exit $ result ; \n + fi \n - if [ - n "" $ GCLOUD _ SERVICE _ KEY "" ] ; then / tmp / google - cloud - sdk / bin / gsutil - m cp - r - U ` / tmp / google - cloud - sdk / bin / gsutil ls gs : / / $ { GCLOUD _ TEST _ BUCKET _ LIBRARY } | tail - 1 ` $ CIRCLE _ ARTIFACTS / | true ; fi \n",Retry the flaky instrumentation tests using the Cloud Test Lab,494
README . md \n - compile ' com . google . android : flexbox : 0 . 1 . 2 ' \n + compile ' com . google . android : flexbox : 0 . 1 . 3 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 1 . 2 ' \n + mavenVersion = ' 0 . 1 . 3 ' \n,Bump the version to 0 . 1 . 3,494
. gitignore \n + . vscode / \n,Add . vscode / to . gitignore \n Change - Id : Iff326f1cb2a5b8c5e34f1ff258eb24afff46124a,494
"flexbox \ src \ androidTest \ java \ com \ google \ android \ flexbox \ test \ FlexboxAndroidTest . java \n - / / order : 1 , index 3 \n + / / order : 0 , index 3 \n + @ Test \n + @ FlakyTest ( tolerance = TOLERANCE ) \n + public void testOrderAttribute _ addViewInMiddle ( ) throws Throwable { \n + final FlexboxTestActivity activity = mActivityRule . getActivity ( ) ; \n + mActivityRule . runOnUiThread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + activity . setContentView ( R . layout . activity _ order _ test ) ; \n + FlexboxLayout flexboxLayout = ( FlexboxLayout ) activity \n + . findViewById ( R . id . flexbox _ layout ) ; \n + TextView fifth = createTextView ( activity , String . valueOf ( 5 ) , 0 ) ; \n + / / Add the new TextView in the middle of the indices \n + flexboxLayout . addView ( fifth , 2 ) ; \n + } \n + } ) ; \n + FlexboxLayout flexboxLayout = ( FlexboxLayout ) activity . findViewById ( R . id . flexbox _ layout ) ; \n + InstrumentationRegistry . getInstrumentation ( ) . waitForIdleSync ( ) ; \n + \n + assertNotNull ( flexboxLayout ) ; \n + assertThat ( flexboxLayout . getChildCount ( ) , is ( 5 ) ) ; \n + / / order : - 1 , index 1 \n + assertThat ( ( ( TextView ) flexboxLayout . getReorderedChildAt ( 0 ) ) . getText ( ) . toString ( ) , \n + is ( String . valueOf ( 2 ) ) ) ; \n + / / order : 0 , index 2 \n + assertThat ( ( ( TextView ) flexboxLayout . getReorderedChildAt ( 1 ) ) . getText ( ) . toString ( ) , \n + is ( String . valueOf ( 5 ) ) ) ; \n + / / order : 0 , index 3 \n + assertThat ( ( ( TextView ) flexboxLayout . getReorderedChildAt ( 2 ) ) . getText ( ) . toString ( ) , \n + is ( String . valueOf ( 3 ) ) ) ; \n + / / order : 0 , index 4 \n + assertThat ( ( ( TextView ) flexboxLayout . getReorderedChildAt ( 3 ) ) . getText ( ) . toString ( ) , \n + is ( String . valueOf ( 4 ) ) ) ; \n + / / order : 2 , index 0 \n + assertThat ( ( ( TextView ) flexboxLayout . getReorderedChildAt ( 4 ) ) . getText ( ) . toString ( ) , \n + is ( String . valueOf ( 1 ) ) ) ; \n + } \n + \n",Adds a test case for the order attributes where a new view is added in the \n middle of the existing views .,494
"app \ src \ main \ java \ com \ google \ android \ apps \ flexbox \ FlexItem . java \n + import android . support . v4 . view . MarginLayoutParamsCompat ; \n - lp . setMarginStart ( startMargin ) ; \n - lp . setMarginEnd ( endMargin ) ; \n + MarginLayoutParamsCompat . setMarginStart ( lp , startMargin ) ; \n + MarginLayoutParamsCompat . setMarginEnd ( lp , endMargin ) ; \n - flexItem . startMargin = lp . getMarginStart ( ) ; \n - flexItem . endMargin = lp . getMarginEnd ( ) ; \n + flexItem . startMargin = MarginLayoutParamsCompat . getMarginStart ( lp ) ; \n + flexItem . endMargin = MarginLayoutParamsCompat . getMarginEnd ( lp ) ; \n app \ src \ main \ res \ layout \ fragment _ flex _ item _ edit . xml \n - < ! - - TODO Prepare style for API level less thatn 21 - - > \n - style = "" ? android : attr / buttonBarNegativeButtonStyle "" \n + style = "" ? android : attr / buttonBarStyle "" \n - < ! - - TODO Prepare style for API level less thatn 21 - - > \n - style = "" ? android : attr / buttonBarPositiveButtonStyle "" \n + style = "" ? android : attr / buttonBarStyle "" \n - < / ScrollView > \n + < / ScrollView > \n flexbox \ src \ main \ java \ com \ google \ android \ libraries \ flexbox \ FlexboxLayout . java \n - int paddingStart = getPaddingStart ( ) ; \n - int paddingEnd = getPaddingEnd ( ) ; \n + int paddingStart = ViewCompat . getPaddingStart ( this ) ; \n + int paddingEnd = ViewCompat . getPaddingEnd ( this ) ; \n - paddingAlongMainAxis = getPaddingStart ( ) + getPaddingEnd ( ) ; \n + paddingAlongMainAxis = getPaddingLeft ( ) + getPaddingRight ( ) ; \n - flexLine . mainSize + = child . getMeasuredWidth ( ) + lp . getMarginStart ( ) \n - + lp . getMarginEnd ( ) ; \n + flexLine . mainSize + = child . getMeasuredWidth ( ) + lp . leftMargin + lp . rightMargin ; \n - flexLine . mainSize + = child . getMeasuredWidth ( ) + lp . getMarginStart ( ) \n - + lp . getMarginEnd ( ) ; \n + flexLine . mainSize + = child . getMeasuredWidth ( ) + lp . leftMargin + lp . rightMargin ; \n",Fixes the lint errors . \n Change - Id : I88827701e5a5c5bd0c00f9963401838ae639f425,494
flexbox \ src \ main \ java \ com \ google \ android \ flexbox \ FlexboxLayout . java \n - calculatedMaxHeight = getSumOfCrossSize ( ) ; \n + calculatedMaxHeight = getSumOfCrossSize ( ) + getPaddingTop ( ) + getPaddingBottom ( ) ; \n - calculatedMaxWidth = getSumOfCrossSize ( ) ; \n + calculatedMaxWidth = getSumOfCrossSize ( ) + getPaddingLeft ( ) + getPaddingRight ( ) ; \n,Fix the issue paddings are not taken into account along the cross axis . \n Change - Id : Ic55c0be6323dcb3bac68d7b8c30caf2e4578bbaf,494
"new file \n circle . yml \n + machine : \n + java : \n + version : oraclejdk8 \n + \n + dependencies : \n + pre : \n + - echo y | android update sdk - - no - ui - - all - - filter "" build - tools - 23 . 0 . 3 "" \n + cache _ directories : \n + - ~ / . android \n + override : \n + - . / gradlew dependencies \n + \n + test : \n + override : \n + # TODO : Enable connectedAndroidTest \n + - . / gradlew build \n",Preparation for circle ci . \n Change - Id : Ie91c41555312e6ffcf5a8ef56fec0aa890778a27,494
README . md \n - compile ' com . google . android : flexbox : 0 . 1 . 0 ' \n + compile ' com . google . android : flexbox : 0 . 1 . 1 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 1 . 0 ' \n + mavenVersion = ' 0 . 1 . 1 ' \n,Bump maven version to 0 . 1 . 1 \n Change - Id : I0fe63000ce7535703bc5d2fd103becfa2f04bbc2,494
flexbox \ maven . gradle \n + \n + task sourcesJar ( type : Jar ) { \n + from android . sourceSets . main . java . srcDirs \n + classifier = ' sources ' \n + } \n + \n + artifacts { \n + archives sourcesJar \n + } \n,Add sources . jar as part of the build artifacts . \n Change - Id : Idb5aca9981678da486eef5215f58704123e3fa4e,494
README . md \n + # # Flexbox Playground demo app \n + The ` app ` module works as a playground demo app for trying various values for the supported attributes . \n + You can install it by \n + ` ` ` \n + . / gradlew installDebug ` \n + ` ` ` \n + \n,Adds description for the demo app in the README \n Change - Id : Ia4c7519316ec399ae12ef615f8f2950d2435fbaf,494
README . md \n - compile ' com . google . android : flexbox : 0 . 2 . 2 ' \n + compile ' com . google . android : flexbox : 0 . 2 . 3 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 2 . 2 ' \n + mavenVersion = ' 0 . 2 . 3 ' \n,Bump the version to 0 . 2 . 3 . \n Change - Id : Ieb5f9bf3d3f32faf090e91ec9015bd1dc10ba46f,494
README . md \n - compile ' com . google . android : flexbox : 0 . 2 . 1 ' \n + compile ' com . google . android : flexbox : 0 . 2 . 2 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 2 . 1 ' \n + mavenVersion = ' 0 . 2 . 2 ' \n,Bump version to 0 . 2 . 2,494
README . md \n - compile ' com . google . android : flexbox : 0 . 1 . 1 ' \n + compile ' com . google . android : flexbox : 0 . 1 . 2 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 0 . 1 . 1 ' \n + mavenVersion = ' 0 . 1 . 2 ' \n,Bump version to 0 . 1 . 2 \n Change - Id : I397a83d3fa2dc268705df8855b0c567fca3f2fc4,494
README . md \n + [ ! [ Circle CI ] ( https : / / circleci . com / gh / google / flexbox - layout . svg ? style = shield & circle - token = 2a42716dfffab73d73c5ce7ed7b3ee620cfa137b ) \n + ! [ Download ] ( https : / / api . bintray . com / packages / google / flexbox - layout / flexbox / images / download . svg ) ] ( https : / / bintray . com / google / flexbox - layout / flexbox / _ latestVersion ) \n + \n,Add status badge for Circl CI and the latest bintray version \n Change - Id : Ib026699ca64de15a7152be3d82218802f270fc84,494
new file \n assets \ fluid - grid \ nexus9 - full - width . png \n Binary files / dev / null and b / assets / fluid - grid / nexus9 - full - width . png differ \n new file \n assets \ fluid - grid \ nexus9 - half . png \n Binary files / dev / null and b / assets / fluid - grid / nexus9 - half . png differ \n new file \n assets \ fluid - grid \ nexus9 - one - fourth . png \n Binary files / dev / null and b / assets / fluid - grid / nexus9 - one - fourth . png differ \n new file \n assets \ fluid - grid \ nexus9 - three - fourth . png \n Binary files / dev / null and b / assets / fluid - grid / nexus9 - three - fourth . png differ \n,Add screenshots for the demo for WiKi \n Change - Id : I33e54f1bd47ac0e1adf9335c040f9fd81b6506a1,494
"mobile \ src \ main \ AndroidManifest . xml \n - android : theme = "" @ style / AppTheme . SessionDetails "" / > \n + android : theme = "" @ style / AppTheme . SessionDetails "" \n + android : parentActivityName = "" . ui . MainActivity "" / > \n - android : theme = "" @ style / AppTheme . Speaker "" / > \n + android : theme = "" @ style / AppTheme . Speaker "" \n + android : parentActivityName = "" . ui . MainActivity "" / > \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailFragment . kt \n + import android . support . v4 . app . NavUtils \n - requireActivity ( ) . finishAfterTransition ( ) \n + NavUtils . navigateUpFromSameTask ( requireActivity ( ) ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ speaker \ SpeakerFragment . kt \n + import android . support . v4 . app . NavUtils \n - requireActivity ( ) . finishAfterTransition ( ) \n + NavUtils . navigateUpFromSameTask ( requireActivity ( ) ) \n",Fix the behavior of the up button . \n The up button should navigate to the parent Activity . \n Bug : 78920974 \n Change - Id : Ia79e81eda23ab9c9d76f278012b727015756f457,494
"new file \n kokoro \ build . sh \n + # ! / bin / bash \n + \n + # Fail on any error . \n + set - e \n + # Display commands to stderr . \n + set - x \n + \n + cd git / iosched \n + \n + . / gradlew build \n new file \n kokoro \ continuous . cfg \n + # Format : / / devtools / kokoro / config / proto / build . proto \n + \n + # Location of the continuous bash script . \n + build _ file : "" iosched / kokoro / continuous . sh "" \n new file \n kokoro \ continuous . sh \n + # ! / bin / bash \n + \n + # Fail on any error . \n + set - e \n + # Display commands to stderr . \n + set - x \n + \n + pwd \n + find . \n + git / iosched / kokoro / build . sh \n new file \n kokoro \ presubmit . cfg \n + # Format : / / devtools / kokoro / config / proto / build . proto \n + \n + # Location of the continuous bash script . \n + build _ file : "" iosched / kokoro / presubmit . sh "" \n new file \n kokoro \ presubmit . sh \n + # ! / bin / bash \n + \n + # Fail on any error . \n + set - e \n + # Display commands to stderr . \n + set - x \n + \n + pwd \n + find . \n + git / iosched / kokoro / build . sh \n","Add configurations for kokoro . \n These files are for the internal only purpose , so don ' t have to be \n published externally on GitHub ( Not bad if we do so because they are not confidential ) . \n So when publishing iosched to GitHub , it ' s better to exlucde this directory . \n Change - Id : Iac5d2e1586ed7556ffa1f8c6701d2e7a869ee605",494
"tv \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ tv \ ui \ schedule \ TestSessionDataSource . kt \n + \n + override fun getSession ( sessionId : String ) : Session { \n + TODO ( "" This is just to unbreak the build "" ) \n + } \n + \n",This is just to unbreak the build caused by this \n https : / / devrel - review . git . corp . google . com / c / apps / iosched / + / 72244 / 12 \n Change - Id : I1b8dc85d491c32bd2647fcd5045ad39c921e2db0,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ reservation \ SwapReservationViewModel . kt \n - override fun onReplaceClicked ( ) { \n + override fun onSwapClicked ( ) { \n - fun onReplaceClicked ( ) \n + fun onSwapClicked ( ) \n mobile \ src \ main \ res \ layout \ dialog _ swap _ reservation . xml \n - android : onClick = "" @ { ( ) - > viewModel . onReplaceClicked ( ) } "" \n - android : text = "" @ string / replace "" / > \n + android : onClick = "" @ { ( ) - > viewModel . onSwapClicked ( ) } "" \n + android : text = "" @ string / swap "" / > \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" swap _ reservation _ title "" translation _ description = "" The title of the dialog when the user is about to change their reservation from one session to another . "" > Replace session ? < / string > \n + < string name = "" swap _ reservation _ title "" translation _ description = "" The title of the dialog when the user is about to change their reservation from one session to another . "" > Swap reservation ? < / string > \n - < string name = "" replace "" translation _ description = "" The label of the button to replace the reservation with another . "" > Replace < / string > \n + < string name = "" swap "" translation _ description = "" The label of the button to swap the reservation with another . "" > Swap < / string > \n",Change the title of the swap dialog \n Bug : 77496267 \n Change - Id : I8ce69b25ca3765f3ae4cf004b1af3dd44c0e37fb,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ ConferenceDataDownloader . kt \n - const val URL = "" https : / / firebasestorage . googleapis . com / v0 / b / iosched - playground . appspot . com / o / "" + \n - "" conference _ data . json ? alt = media & token = 0c0a7ce8 - f582 - 4ab2 - a66e - 29f335680399 "" \n + const val URL = "" https : / / firebasestorage . googleapis . com / v0 / b / io2018 - festivus / o / "" + \n + "" conference _ data _ 2016 . json ? alt = media & token = 12c2ffb4 - 5149 - 4a1d - a379 - 456a8dbea369 "" \n shared \ src \ main \ resources \ conference _ data . json \n - "" id "" : "" _ _ keynote _ _ "" , \n + "" id "" : "" keynote "" , \n shared \ src \ test \ resources \ test _ conference _ data1 . json \n - "" id "" : "" _ _ keynote _ _ "" , \n + "" id "" : "" keynote "" , \n","Remove the underscores from the prefix and the suffix for the id for the \n keynote . \n It turned out Firestore doesn ' t accept a document with id that starts \n and ends with "" _ "" . \n As a result , the document that represents UserEvent for the keynote wasn ' t stored in Firestore \n including its starred state . \n Confirmed that the document in Firestore and the star state in the emulator worked \n After I manually replaced the "" _ _ keynote _ _ "" with "" keynote "" . \n The copy of the JSON seems to be placed at according to the comment in ConferenceDataDownloader \n "" https : / / firebasestorage . googleapis . com / v0 / b / iosched - playground . appspot . com / o / "" + \n "" conference _ data . json ? alt = media & token = 0c0a7ce8 - f582 - 4ab2 - a66e - 29f335680399 "" \n It needs to be also replaced . \n Bug : 75013503 \n Change - Id : I04a582b42fec0dfddeb91a558d2688ef29d268b6",494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ login \ datasources \ FirestoreRegisteredUserDataSource . kt \n - val isRegistered : Boolean ? = snapshot ? . get ( REGISTERED _ KEY ) as ? Boolean \n + if ( snapshot = = null | | ! snapshot . exists ( ) ) { \n + / / When the account signs in for the first time , the document doesn ' t exist \n + Timber . d ( "" Document for snapshot $ userId doesn ' t exist "" ) \n + result . postValue ( Result . Success ( false ) ) \n + return @ execute \n + } \n + val isRegistered : Boolean ? = snapshot . get ( REGISTERED _ KEY ) as ? Boolean \n",Fixes NPE when the firestore document doesn ' t exist for the account \n signs in for the first time . \n Test : Manual \n Delete the document under / users / < uid > before launching the app \n Launch the app \n Sign in with the account which has the deleted uid \n Bug : 76176266 \n Change - Id : If40e9f72349405cc56e595a9611fdefc28471e35,494
"mobile \ src \ main \ res \ layout \ dialog _ signin . xml \n - android : layout _ marginBottom = "" @ dimen / margin _ small "" \n - android : layout _ marginEnd = "" @ dimen / margin _ normal "" \n - android : layout _ marginStart = "" @ dimen / margin _ normal "" \n + android : layout _ marginBottom = "" @ dimen / spacing _ normal "" \n + android : paddingHorizontal = "" @ dimen / margin _ normal "" \n - android : layout _ marginEnd = "" @ dimen / margin _ normal "" \n - android : layout _ marginStart = "" @ dimen / margin _ normal "" \n - android : layout _ marginTop = "" @ dimen / margin _ small "" \n + android : paddingHorizontal = "" @ dimen / margin _ normal "" \n + android : layout _ marginTop = "" @ dimen / spacing _ normal "" \n - android : layout _ marginStart = "" @ dimen / margin _ small "" \n + android : layout _ marginStart = "" @ dimen / spacing _ normal "" \n mobile \ src \ main \ res \ values \ colors . xml \n - < color name = "" indigo _ transparent "" > # dd3c54fe < / color > < ! - - 20 % black - - > \n + < color name = "" indigo _ transparent "" > # e54768fd < / color > < ! - - 90 % indigo - - > \n mobile \ src \ main \ res \ values \ dimens . xml \n - - > \n - < dimen name = "" margin _ small "" > 8dp < / dimen > \n + < dimen name = "" padding _ borderless _ button "" > 24dp < / dimen > \n mobile \ src \ main \ res \ values \ styles . xml \n - < item name = "" android : textColor "" > @ color / indigo < / item > \n + < item name = "" android : textColor "" > ? colorPrimary < / item > \n - < item name = "" android : paddingVertical "" tools : ignore = "" NewApi "" > @ dimen / margin _ normal < / item > \n + < item name = "" android : paddingVertical "" tools : ignore = "" NewApi "" > @ dimen / padding _ borderless _ button < / item > \n",Fixes styling of the dialog . \n This is a follow up to address Nick ' s comment on the previous \n CL ( legit / 76004 ) \n Change - Id : Ied4ca77628783322bd8364d43dc595cffbc617c5,494
"mobile \ src \ main \ res \ layout \ dialog _ signin . xml \n - android : paddingHorizontal = "" @ dimen / margin _ normal "" \n - android : layout _ marginTop = "" @ dimen / margin _ normal "" \n + android : layout _ marginTop = "" @ dimen / margin _ large "" \n + android : paddingHorizontal = "" @ dimen / margin _ large "" \n - android : paddingHorizontal = "" @ dimen / margin _ normal "" \n + android : paddingHorizontal = "" @ dimen / margin _ large "" \n - android : layout _ marginStart = "" @ dimen / margin _ normal "" \n + android : layout _ marginStart = "" @ dimen / margin _ large "" \n - android : layout _ marginEnd = "" @ dimen / margin _ normal "" \n + android : layout _ marginEnd = "" @ dimen / margin _ large "" \n mobile \ src \ main \ res \ values \ dimens . xml \n + < dimen name = "" margin _ large "" > 32dp < / dimen > \n",Fix the margins of the dialog same as the source of truth . \n Change - Id : I0bf30b812b8cf0cc9aa8353ff32ae499998c08aa,494
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n + bottomSheetBehavior . skipCollapsed = true \n,Fix the filter BottomSheet hides part of the FAB when the app first \n launched \n Bug : 77159693 \n Change - Id : Ibd860a339668878fb81da84261b32c2ed25f0236,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ firestore \ entity \ UserEvent . kt \n + SWAP _ SUCCEEDED - > null \n + SWAP _ WAITLISTED - > null \n - return requestResultError ( ) = = RESERVE _ DENIED _ CUTOFF \n + val e = requestResultError ( ) \n + return e = = RESERVE _ DENIED _ CUTOFF | | e = = SWAP _ DENIED _ CUTOFF \n - return requestResultError ( ) = = RESERVE _ DENIED _ CLASH \n + val e = requestResultError ( ) \n + return e = = RESERVE _ DENIED _ CLASH | | e = = SWAP _ DENIED _ CLASH \n - return requestResultError ( ) = = RESERVE _ DENIED _ UNKNOWN \n + val e = requestResultError ( ) \n + return e = = RESERVE _ DENIED _ UNKNOWN | | e = = SWAP _ DENIED _ UNKNOWN \n - return requestResultError ( ) = = CANCEL _ DENIED _ CUTOFF \n + val e = requestResultError ( ) \n + return e = = CANCEL _ DENIED _ CUTOFF | | e = = SWAP _ DENIED _ CUTOFF \n - \n shared \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ CompareOldAndNewUserEventsTest . kt \n + @ Test \n + fun compareOldAndNew _ sameId _ errorMessageClashBySwap ( ) { \n + \n + val result = generateErrorResult ( ReservationRequestStatus . SWAP _ DENIED _ CLASH ) \n + \n + assertThat ( result , ` is ` ( equalTo ( UserEventMessage . RESERVATION _ DENIED _ CLASH ) ) ) \n + } \n + \n + @ Test \n + fun compareOldAndNew _ sameId _ errorMessageCutoffBySwap ( ) { \n + \n + val result = generateErrorResult ( ReservationRequestStatus . SWAP _ DENIED _ CUTOFF ) \n + \n + assertThat ( result , ` is ` ( equalTo ( UserEventMessage . RESERVATION _ DENIED _ CUTOFF ) ) ) \n + } \n + \n + @ Test \n + fun compareOldAndNew _ sameId _ errorMessageUnknownBySwap ( ) { \n + \n + val result = generateErrorResult ( ReservationRequestStatus . SWAP _ DENIED _ UNKNOWN ) \n + \n + assertThat ( result , ` is ` ( equalTo ( UserEventMessage . RESERVATION _ DENIED _ UNKNOWN ) ) ) \n + } \n + \n",Show a correct error message when a swap request failed . \n Bug : 77301837 \n Change - Id : I16ab52660b0087f8bdea2ef4cecc8f49d5e1e8c3,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ DefaultSessionAndUserEventRepository . kt \n - Timber . d ( "" EventRepository : Received "" + \n - "" $ { userEvents ? . userEvents ? . size ? : 0 } user events changes "" ) \n + / / Not update the result when userEvents is null , otherwise the count of the \n + / / filtered result in the use case is going to be 0 , that results blur when \n + / / the pinned item switch is toggled . \n + userEvents ? : return @ execute \n + \n + Timber . d ( \n + "" "" "" EventRepository : Received $ { userEvents . userEvents . size } \n + | user events changes "" "" "" . trimMargin ( ) \n + ) \n - it . id = = userEvents ? . userEventsMessage ? . sessionId \n + it . id = = userEvents . userEventsMessage ? . sessionId \n - userMessage = userEvents ? . userEventsMessage , \n + userMessage = userEvents . userEventsMessage , \n","Fix the blur when toggling the pinned events switch \n When getObservableUserEvents is called , the MediatorLiveData is updated \n with UserEventsResult is null , that results in the 0 user sessions in \n the LoadUserSessionsByDayUseCase , that ends in a lot of diffs in the adapter . \n Bug : 78138872 \n Change - Id : Id146392784d594efcfc2526eb05f6b2856b6a343",494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleViewModel . kt \n + fun onSignInRequired ( ) { \n + _ navigateToSignInDialogAction . value = Event ( Unit ) \n + } \n + \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ filters \ ScheduleFilterFragment . kt \n + import com . google . samples . apps . iosched . ui . schedule . filters . EventFilter . MyEventsFilter \n - @ BindingAdapter ( "" animateOnClick "" ) \n - fun animateOnClick ( filter : EventFilterView , listener : View . OnClickListener ) { \n + @ BindingAdapter ( "" eventFilter "" , "" viewModel "" , requireAll = true ) \n + fun setClickListenerForFilter ( \n + filter : EventFilterView , \n + eventFilter : EventFilter , \n + viewModel : ScheduleViewModel \n + ) { \n - filter . animateChecked ( ! filter . isChecked ) \n - listener . onClick ( filter ) \n + if ( eventFilter is MyEventsFilter & & ! viewModel . isSignedIn ( ) ) { \n + viewModel . onSignInRequired ( ) \n + } else { \n + val checked = ! filter . isChecked \n + filter . animateChecked ( checked ) \n + viewModel . toggleFilter ( eventFilter , checked ) \n + } \n mobile \ src \ main \ res \ layout \ item _ event _ filter . xml \n - app : animateOnClick = "" @ { ( ) - > viewModel . toggleFilter ( eventFilter , ! filterLabel . checked ) } "" \n + app : eventFilter = "" @ { eventFilter } "" \n + app : viewModel = "" @ { viewModel } "" \n","Kick off the sign in flow when "" MyEventFilter "" is about to be toggled \n and the user isn ' t signed in . \n Bug : 78175828 \n Change - Id : I917d604aa0907850a3ecebd364b6a4704fde10e2",494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailDataBindingAdapters . kt \n + import com . google . samples . apps . iosched . shared . model . SessionType \n + import com . google . samples . apps . iosched . shared . model . SessionType . APP _ REVIEW \n + import com . google . samples . apps . iosched . shared . model . SessionType . SESSION \n + import com . google . samples . apps . iosched . shared . model . SessionType . UNKNOWN \n + @ Suppress ( "" unused "" ) \n + @ BindingAdapter ( "" eventType "" ) \n + fun headerLogoImage ( imageView : ImageView , eventType : SessionType ? ) { \n + val resId = when ( eventType ) { \n + AFTER _ HOURS - > R . drawable . event _ header _ afterhours \n + APP _ REVIEW - > R . drawable . event _ header _ office _ hours \n + CODELAB - > R . drawable . event _ header _ codelabs \n + OFFICE _ HOURS - > R . drawable . event _ header _ office _ hours \n + SANDBOX - > R . drawable . event _ header _ sandbox \n + SESSION - > R . drawable . event _ header _ sessions \n + UNKNOWN - > R . drawable . event _ header _ sessions \n + else - > R . drawable . event _ header _ sessions \n + } \n + imageView . setImageDrawable ( imageView . context . getDrawable ( resId ) ) \n + } \n + \n mobile \ src \ main \ res \ layout \ item _ session _ info . xml \n + < ImageView \n + android : id = "" @ + id / detail _ event _ type _ logo "" \n + android : layout _ width = "" wrap _ content "" \n + android : layout _ height = "" wrap _ content "" \n + android : layout _ marginEnd = "" @ dimen / event _ logo _ end _ margin "" \n + android : layout _ marginTop = "" @ dimen / event _ logo _ top _ margin "" \n + android : importantForAccessibility = "" no "" \n + app : eventType = "" @ { viewModel . session . type } "" \n + app : layout _ constraintEnd _ toEndOf = "" @ + id / detail _ image "" \n + app : layout _ constraintTop _ toTopOf = "" @ + id / detail _ image "" / > \n + \n",Display images as a logo for session detail . \n Bug : 78193985 \n Change - Id : If054589ee3c7a6236d3437cc301577b4bf4f4df4,494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ util \ NetworkUtils . kt \n + import android . content . Context . CONNECTIVITY _ SERVICE \n - import androidx . content . systemService \n - val connectivityManager : ConnectivityManager = context . systemService ( ) \n + val connectivityManager = context . getSystemService ( CONNECTIVITY _ SERVICE ) as ConnectivityManager \n,Fix the crash on Lollipop . \n T getSystemService ( Class < T > serviceClass ) is ' t available in Lollipop \n Bug : 78249538 \n Change - Id : Ib26ad58b69c1dd97198466d1ee97b40adc83e696,494
"mobile \ src \ main \ res \ values - land \ strings . xml \n - < string name = "" session _ detail _ header _ aspect "" translatable = "" false "" > H , 6 : 1 < / string > \n + < string name = "" session _ detail _ header _ aspect "" translatable = "" false "" > H , 3 : 1 < / string > \n",Fix the misalignment for the logo for the session detail and \n the speaker detail . \n Bug : 78257021 \n Change - Id : Ifd0e73911d3db028024ffd722102588fff9b8937,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ day \ ScheduleTimeHeadersDecoration . kt \n - \n + import timber . log . Timber \n - val view = parent [ i ] \n + val view = parent . getChildAt ( i ) \n + if ( view = = null ) { \n + / / This should not be null , but observed null at times . \n + / / Guard against it to avoid crash and log the state . \n + Timber . w ( \n + "" "" "" View is null . Index : $ i , childCount : $ { parent . childCount } , \n + | RecyclerView . State : $ state "" "" "" . trimMargin ( ) \n + ) \n + continue \n + } \n",Guard against crash . \n Couldn ' t reproduce the issue and there seems no issues in the code . \n This CL guards against it if the parent . getChildAt ( i ) returns \n null instead of letting it crash . \n Bug : 74114902 \n Change - Id : Id64985a4acb5733bb8cd49cc96eb3d05776611f4,494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ schedule \ UserSessionMatcher . kt \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n + @ Synchronized \n,Fixes the crash when tapping the filters quickly \n Bug : 78272949 \n Change - Id : Ic896eada8c011704ca2b0fd70f0d4ed9619290b6,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ DefaultSessionAndUserEventRepository . kt \n - sessionsByDayResult . postValue ( Result . Success ( \n + sessionsByDayResult . value = Result . Success ( \n - userSessionCount = allSessions . size ) \n - ) ) \n + userSessionCount = allSessions . size ) ) \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ FirestoreUserEventDataSource . kt \n - import java . util . UUID \n + import java . util . * \n - result . postValue ( null ) / / Post a value in case there are no changes to the data on start \n + / / Set a value in case there are no changes to the data on start \n + / / This needs to be set to avoid that the upper layer LiveData detects the old data as a \n + / / new data . \n + / / When addSource was called in DefaultSessionAndUserEventRepository # getObservableUserEvents , \n + / / the old data was considered as a new data even though it ' s for another user ' s data \n + result . value = null \n","Set the default null value for the observableUserEvents by setting it . \n Every time getObservableUserEvents is called , MediatorLiveData . removeSource \n and MediatorLiveData . addSource is called in DefaultSessionAndUserEventRepository . \n When addSource is called MediatorLiveData considers the old value as new \n data coming in ( even if the data is for another user ) . \n This CL is to prevent that by setting the null default value by setValue \n Bug : 78444538 \n Change - Id : I3ef96d26e51c166f556f2d3779e123b37efd7006",494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ day \ ScheduleDayAdapter . kt \n - import com . google . android . flexbox . FlexboxLayoutManager \n + import com . google . samples . apps . iosched . widget . UnscrollableFlexboxLayoutManager \n - tags . recycledViewPool = tagViewPool \n - ( tags . layoutManager as ? FlexboxLayoutManager ) ? . let { \n - it . recycleChildrenOnDetach = true \n + tags . apply { \n + recycledViewPool = tagViewPool \n + / / Use a customized FlexboxLayoutManager so that swiping the tags are doesn ' t \n + / / trigger pull to refresh behavior . \n + layoutManager = UnscrollableFlexboxLayoutManager ( parent . context ) . apply { \n + recycleChildrenOnDetach = true \n + } \n new file \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ widget \ UnscrollableFlexboxLayoutManager . kt \n + / * \n + * Copyright 2018 Google LLC \n + * \n + * Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + * you may not use this file except in compliance with the License . \n + * You may obtain a copy of the License at \n + * \n + * https : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + * \n + * Unless required by applicable law or agreed to in writing , software \n + * distributed under the License is distributed on an "" AS IS "" BASIS , \n + * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + * See the License for the specific language governing permissions and \n + * limitations under the License . \n + * / \n + \n + package com . google . samples . apps . iosched . widget \n + \n + import android . content . Context \n + import com . google . android . flexbox . FlexboxLayoutManager \n + \n + class UnscrollableFlexboxLayoutManager ( context : Context ) : FlexboxLayoutManager ( context ) { \n + override fun canScrollVertically ( ) : Boolean = false \n + override fun canScrollHorizontally ( ) : Boolean = false \n + } \n mobile \ src \ main \ res \ layout \ item _ session . xml \n - app : flexDirection = "" row "" \n - app : flexWrap = "" wrap "" \n - app : layoutManager = "" com . google . android . flexbox . FlexboxLayoutManager "" \n",Fix glitchy scrolling on the schedule . \n FlexboxLayoutManager is considered as scrollable vertically by default \n ( when the direction is row ) . \n So swiping the tags caused the pull to refresh behavior . \n This CL replaces the layoutManager with a customized \n FlexboxLayoutManager that doesn ' t scroll . \n Bug : 78458122 \n Change - Id : I702485c5876814d809f6d2cf79bd004061edb040,494
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleViewModel . kt \n - loadSessionsResult . addSource ( loadSelectedFiltersResult ) { \n + loadSessionsResult . addSource ( loadEventFiltersResult ) { \n,Fix the initial loading progressbar \n Bug : 78601641 \n Change - Id : I5c20ab2bcc88c5037b6ca8e47a9c08d808962057,494
"mobile \ src \ main \ res \ layout \ dialog _ schedule _ hints . xml \n - app : layout _ constraintTop _ toTopOf = "" parent "" / > \n + app : layout _ constraintTop _ toTopOf = "" parent "" \n + app : layout _ constrainedWidth = "" true "" / > \n",Fix the margins of the schedule hint title \n Bug : 78662130 \n Change - Id : I5b9690daddcead2fc58a2e02cb3dae9609a81b34,494
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n - scheduleViewModel . userHasInteracted = true \n + / / Guard against a crash . \n + / / Rarely observed the method was called before the ViewModel was initialized . \n + if ( : : scheduleViewModel . isInitialized ) { \n + scheduleViewModel . userHasInteracted = true \n + } \n,Fix a crash onUserInteraction is called before the ViewModel is \n initialized . \n Bug : 78675101 \n Change - Id : I6d0bb107dd94ecdc05e55cad7a9a846afe9de8da,494
"mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n - android : layout _ width = "" 0dp "" \n + android : layout _ width = "" wrap _ content "" \n - app : layout _ constraintWidth _ default = "" wrap "" \n + app : layout _ constrainedWidth = "" true "" \n","Replace the deperecated version of wrap _ content in ConstraintLayout \n There was a error in the Logcat : \n 04 - 26 17 : 37 : 49 . 666 6987 - 6987 / com . google . samples . apps . iosched E / ConstraintLayout : \n layout _ constraintWidth _ default = "" wrap "" is deprecated . \n Use layout _ width = "" WRAP _ CONTENT "" and layout _ constrainedWidth = "" true "" instead . \n Change - Id : If5b92c272c6c8c08a38237c14fc2e4a8369e4adc",494
build . gradle \n - compileSdkVersion = ' android - P ' \n + compileSdkVersion = 28 \n - targetSdkVersion = 27 \n + targetSdkVersion = 28 \n - compileWearSdkVersion = ' android - P ' \n + compileWearSdkVersion = 28 \n - targetWearSdkVersion = 27 \n + targetWearSdkVersion = 28 \n,Update the sdkVersion to 28 . \n Change - Id : I4ea5bd75c9c4d7633303f7dd60ba67b4ca36d3bc,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ model \ Session . kt \n - AFTER _ HOURS ; \n + AFTER _ HOURS , \n + UNKNOWN ; \n - return when ( typeTag ? . id ) { \n + return when ( typeTag ? . tag ) { \n - else - > SESSION \n + Tag . TYPE _ SESSIONS - > SESSION \n + else - > UNKNOWN \n shared \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ shared \ model \ SessionTest . kt \n + import com . google . samples . apps . iosched . shared . model . SessionType . CODELAB \n + import com . google . samples . apps . iosched . shared . model . SessionType . SESSION \n + import org . hamcrest . CoreMatchers \n + import org . hamcrest . MatcherAssert \n + @ Test \n + fun testType _ sessions ( ) { \n + MatcherAssert . assertThat ( TestData . session0 . type , CoreMatchers . ` is ` ( SESSION ) ) \n + } \n + \n + @ Test \n + fun testType _ codelabs ( ) { \n + MatcherAssert . assertThat ( TestData . session1 . type , CoreMatchers . ` is ` ( CODELAB ) ) \n + } \n + \n",Fix the issue type Session . type is not set correctly \n All the events were marked as SESSION as its type . \n Bug : 77779244 \n Change - Id : I1fe9693f58738b708958ce0b4dfc8b5484150422,494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ sessions \ LoadUserSessionsByDayUseCase . kt \n + . sortedBy { it . session . startTime } \n,Sort sessions by start time to make sure sessions are ordered by its \n start time . \n Bug : 77784506 \n Change - Id : I8f0ec5b9ced3f62f042d50ffcbaf556ac0d28afe,494
"README . md \n - implementation ' com . google . android : flexbox : 1 . 1 . 0 - beta1 ' \n + implementation ' com . google . android : flexbox : 1 . 1 . 0 ' \n build . gradle \n - androidGradlePluginVersion = "" 3 . 2 . 0 - beta04 "" \n + androidGradlePluginVersion = "" 3 . 2 . 0 "" \n demo - playground \ src \ main \ res \ menu \ menu _ main . xml \n - - > \n + xmlns : app = "" http : / / schemas . android . com / apk / res - auto "" \n - android : showAsAction = "" never "" / > \n + app : showAsAction = "" never "" / > \n flexbox \ src \ androidTest \ java \ com \ google \ android \ flexbox \ test \ TestViewHolder . kt \n + import androidx . recyclerview . widget . RecyclerView \n - internal class TestViewHolder ( itemView : View ) : androidx . recyclerview . widget . RecyclerView . ViewHolder ( itemView ) { \n + internal class TestViewHolder ( itemView : View ) : RecyclerView . ViewHolder ( itemView ) { \n flexbox \ src \ main \ java \ com \ google \ android \ flexbox \ FlexboxLayoutManager . java \n + import androidx . annotation . NonNull ; \n",Merge the androidx into master . \n Now Android Studio 3 . 2 and the androidx 1 . 0 . 0 versions are stable . \n Merging the androidx features to the master is ready .,494
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleUiHintsDialogFragment . kt \n + private lateinit var viewModel : ScheduleUiHintsDialogViewModel \n + \n - \n + viewModel = viewModelProvider ( viewModelFactory ) \n - \n - val viewModel : ScheduleUiHintsDialogViewModel = viewModelProvider ( viewModelFactory ) \n,Fix the crash for the schedule hints dialog . \n Bug : 77867442 \n Change - Id : Id38589949381038a4fb348184736556bffef22f1,494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ UserEventsMessageGenerator . kt \n - val changedId : String = change . document . data [ FirestoreUserEventDataSource . ID ] as String \n + val changedId : String = change . document . data [ FirestoreUserEventDataSource . ID ] \n + as ? String ? : return null \n,Fix the TypeCastException \n In some cases id of the UserEvent is stored as null . \n As a result TypeCastException happend in UserEventsMessageGenerator \n kotlin . TypeCastException : null cannot be cast to non - null type kotlin . String \ \n at com . google . samples . apps . iosched . shared . data . userevent . UserEventsMessageGeneratorKt . generateReservationChangeMsg ( UserEventsMessageGenerator . kt : 51 ) \ \n at com . google . samples . apps . iosched . shared . data . userevent . FirestoreUserEventDataSource $ registerListenerForEvents $ eventsListener $ 1 $ 1 . invoke ( FirestoreUserEventDataSource . kt : 148 ) \ \n at com . google . samples . apps . iosched . shared . data . userevent . FirestoreUserEventDataSource $ registerListenerForEvents $ eventsListener $ 1 $ 1 . invoke ( FirestoreUserEventDataSource . kt : 48 ) \ \n at com . google . samples . apps . iosched . shared . domain . internal . TaskSchedulerKt $ sam $ Runnable $ 353598ab . run ( TaskScheduler . kt ) \ \n at java . util . concurrent . ThreadPoolExecutor . runWorker ( ThreadPoolExecutor . java : 1133 ) \ \n at java . util . concurrent . ThreadPoolExecutor $ Worker . run ( ThreadPoolExecutor . java : 607 ) \ \n at java . lang . Thread . run ( Thread . java : 762 ) \ \n Couldn ' t always reproduce the case where id is ' t stored in the \n UserEvent . \n But this change should be harmless anyway . \n Bug : 77865259 \n Change - Id : I09655d7a7d8c5ccfbd3a875311d818774be688b3,494
"mobile \ src \ main \ res \ layout \ fragment _ speaker . xml \n - tools : text = "" Twitter / Github "" / > \n + tools : text = "" Twitter / GitHub "" / > \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" swap _ reservation _ content "" translation _ description = "" The content of the dialog when the user is about to change their reservation from one session to another . "" > You already have a reservation / waitlist for \ "" % 1 $ s \ "" ? . Only one reservation per time block is allowed . Would you like to swap for \ "" % 2 $ s \ "" ? < / string > \n + < string name = "" swap _ reservation _ content "" translation _ description = "" The content of the dialog when the user is about to change their reservation from one session to another . "" > You already have a reservation / waitlist for \ "" % 1 $ s \ "" . Only one reservation per time block is allowed . Would you like to swap for \ "" % 2 $ s \ "" ? < / string > \n - < string name = "" speaker _ link _ github "" translation _ description = "" The label for a link to a speaker ' s Github profile "" > Github < / string > \n + < string name = "" speaker _ link _ github "" translation _ description = "" The label for a link to a speaker ' s GitHub profile "" > GitHub < / string > \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ model \ Speaker . kt \n - * Full URL of the speaker ' s Github profile . \n + * Full URL of the speaker ' s GitHub profile . \n","Minor strings fixes \n - Replace Github with GitHub \n - Remove unneeded "" ? "" from the sentence in the swap dialog \n Change - Id : I80522e0916b6253f998c7d085987ae89695f749f",494
README . md \n + \n,"Update README \n This is to notify the build server that iosched is under \n active development . \n Context : \n I enabled the build in the build server , but looks like projects that \n are considered as not actively developed are going to be disabled \n automatically . \n Change - Id : I4a7c4c376c4bbb57bbcb54163a912d9d2ac0b237",494
"mobile \ src \ main \ res \ values \ strings . xml \n + < string name = "" overview "" translation _ description = "" The title for the overview screen where user can see all the sessions they plan to attend . "" > Overview < / string > \n",Add Overview as a string resource to make it translation pipeline \n Change - Id : I7cdb04f26b9f0686686c48712248401806edb9ec,494
"README . md \n - The app also displays a map of the venue and shows informational pages to guide \n - attendees during the conference . \n + Other features include a Map of the venue , informational pages to \n + guide attendees during the conference in Info , and time - relevant information \n + during the conference in Home . \n - Android Studio . A canary or stable version > = 3 . 2 of Android Studio is \n + Android Studio . A canary or stable version > = 3 . 4 of Android Studio is \n - [ here ] ( https : / / developer . android . com / studio / archive ) . \n + [ here ] ( https : / / developer . android . com / studio / ) . \n - The 2018 version of the app constitutes a comprehensive rewrite . The \n + The 2019 version of the app is built on top of the last year ' s app . The \n + We used [ Navigation component ] ( https : / / developer . android . com / guide / navigation ) \n + to simplify into a single Activity app . \n + \n + We used [ Room ] ( https : / / developer . android . com / jetpack / androidx / releases / room ) \n + for Full Text Search using [ Fts4 ] ( https : / / developer . android . com / reference / androidx / room / Fts4 ) \n + to search for a session , speaker , or codelab . \n + \n schedule . png \n Binary files a / schedule . png and b / schedule . png differ \n",Update the README for 2019 \n Change - Id : I4118eaf5d2f6b1fdc76a112bda6ea74bfb46bfc0,494
build . gradle \n - androidGradlePluginVersion = ' 3 . 3 . 0 ' \n + androidGradlePluginVersion = ' 3 . 3 . 1 ' \n,Update the AGP version to 3 . 3 . 1 \n Change - Id : I0d4bfe44165f2b89b1bbc3c61501a5379b0c0a2e,494
build . gradle \n - androidGradlePluginVersion = ' 3 . 3 . 1 ' \n + androidGradlePluginVersion = ' 3 . 3 . 0 ' \n,"Revert "" Update the AGP version to 3 . 3 . 1 "" \n This reverts commit cbe19e6a3ef6d43d68491ae6b2449d635c4dd1ea . \n There was a regression that data binding in session detail didn ' t work . \n Bug : 125356139 \n Change - Id : If8d3d9e5572527bb2c3d4aff63d6579bbcf312d4",494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ feed \ FeedFragment . kt \n + super . onCreateView ( inflater , container , savedInstanceState ) \n + super . onViewCreated ( view , savedInstanceState ) \n",Fix the bug toolbar doesn ' t open in Feed \n OnViewCreated in the MainNavigationFragment wasn ' t called . \n Bug : 128241436 \n Change - Id : I1e6aedb318c05f1b00d633735d710a2c183e75b2,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ MainActivity . kt \n - import androidx . drawerlayout . widget . DrawerLayout . DrawerListener \n - class MainActivity : DaggerAppCompatActivity ( ) , NavigationHost , DrawerListener { \n + class MainActivity : DaggerAppCompatActivity ( ) , NavigationHost { \n - private var pendingNavId = NAV _ ID _ NONE \n - drawer . addDrawerListener ( this ) \n - menu . findItem ( R . id . navigation _ explore _ ar ) . isVisible = exploreArFeatureEnabled \n - setNavigationItemSelectedListener { \n - closeDrawer ( ) \n - navigateWhenDrawerClosed ( it . itemId ) \n - true \n + menu . findItem ( R . id . navigation _ explore _ ar ) . apply { \n + / / Handle launching new activities , otherwise assume the destination is handled \n + / / by the nav graph . We want to launch a new Activity for only the AR menu \n + isVisible = exploreArFeatureEnabled \n + setOnMenuItemClickListener { \n + openExploreAr ( ) \n + closeDrawer ( ) \n + true \n + } \n - private fun navigateWhenDrawerClosed ( navId : Int ) { \n - if ( drawer . isDrawerVisible ( navigation ) ) { \n - / / Replacing the fragment while the drawer is animating causes jank , so instead save the \n - / / id and we ' ll replace it later . \n - pendingNavId = navId \n - } else { \n - navigateTo ( navId ) \n - } \n - } \n - \n - / / Handle launching new activities , otherwise assume the destination is handled by the nav \n - / / graph . \n - if ( navId = = R . id . navigation _ explore _ ar ) { \n - startActivity ( \n - Intent ( \n - this , \n - InstallOrLaunchArFeatureActivity : : class . java \n - ) \n - ) \n - return \n - } \n - \n - / / - - DrawerListener overrides \n - \n - override fun onDrawerClosed ( drawerView : View ) { \n - if ( drawerView = = navigation & & pendingNavId ! = NAV _ ID _ NONE ) { \n - navigateTo ( pendingNavId ) \n - pendingNavId = NAV _ ID _ NONE \n - } \n + private fun openExploreAr ( ) { \n + startActivity ( \n + Intent ( \n + this , \n + InstallOrLaunchArFeatureActivity : : class . java \n + ) \n + ) \n - \n - override fun onDrawerOpened ( drawerView : View ) { } \n - \n - override fun onDrawerStateChanged ( newState : Int ) { } \n - \n - override fun onDrawerSlide ( drawerView : View , slideOffset : Float ) { } \n",Fix Explore AR menu doesn ' t trigger launching an Activity \n setupWithNavController overrides the setNavigationItemSelectedListener \n for the NavigationView . So a callback set by us wasn ' t invoked . \n Bug : 128871867 \n Change - Id : Iaca5f13babb10fb7870af3ecba16f65a399f7b9b,494
"ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n - import android . os . Bundle \n + import android . widget . Toast \n + import com . google . ar . core . ArCoreApk \n + import com . google . ar . core . ArCoreApk . InstallStatus . INSTALLED \n + import com . google . ar . core . ArCoreApk . InstallStatus . INSTALL _ REQUESTED \n + import com . google . ar . core . exceptions . UnavailableUserDeclinedInstallationException \n - override fun onCreate ( savedInstanceState : Bundle ? ) { \n - super . onCreate ( savedInstanceState ) \n - val arWebView = ArWebView ( this ) \n - setContentView ( arWebView ) \n + private var userRequestedInstall = true \n - / / TODO : Load the actual AR feature \n - arWebView . loadUrl ( "" https : / / www . google . com "" ) \n + override fun onResume ( ) { \n + super . onResume ( ) \n + try { \n + when ( ArCoreApk . getInstance ( ) . requestInstall ( this , userRequestedInstall ) ) { \n + INSTALLED - > { \n + val arWebView = ArWebView ( this ) \n + setContentView ( arWebView ) \n + / / TODO : Load the actual AR feature \n + arWebView . loadUrl ( "" https : / / www . google . com "" ) \n + } \n + INSTALL _ REQUESTED - > { \n + userRequestedInstall = false \n + return \n + } \n + else - > return \n + } \n + } catch ( e : UnavailableUserDeclinedInstallationException ) { \n + Toast . makeText ( this , getString ( R . string . need _ to _ install _ ar _ core ) , Toast . LENGTH _ LONG ) \n + . show ( ) \n + } \n ar \ src \ main \ res \ values \ strings . xml \n + < string name = "" need _ to _ install _ ar _ core "" translation _ description = "" The message to tell the user that they need to install the latest ARCore to launch this feature "" > You need to install the latest version of ARCore to proceed < / string > \n",Implement installation flow of ARCore \n Bug : 128880489 \n Change - Id : Ie2621f64ccd8447d915f7888a3e43d87dd2862d6,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ fcm \ FcmTokenUpdater . kt \n + import com . google . samples . apps . iosched . shared . domain . internal . DefaultScheduler \n - firestore \n - . document2019 ( ) \n - . collection ( USERS _ COLLECTION ) \n - . document ( userId ) \n - . collection ( FCM _ IDS _ COLLECTION ) \n - . document ( token . take ( TOKEN _ ID _ LENGTH ) ) \n - . set ( tokenInfo , SetOptions . merge ( ) ) . addOnCompleteListener { \n - if ( it . isSuccessful ) { \n - Timber . d ( "" FCM ID token successfully uploaded for user $ userId \ "" "" ) \n - } else { \n - Timber . e ( "" FCM ID token : Error uploading for user $ userId "" ) \n + / / All Firestore operations are started from the main thread \n + / / to avoid concurrency issues . \n + DefaultScheduler . postToMainThread { \n + firestore \n + . document2019 ( ) \n + . collection ( USERS _ COLLECTION ) \n + . document ( userId ) \n + . collection ( FCM _ IDS _ COLLECTION ) \n + . document ( token . take ( TOKEN _ ID _ LENGTH ) ) \n + . set ( tokenInfo , SetOptions . merge ( ) ) . addOnCompleteListener { \n + if ( it . isSuccessful ) { \n + Timber . d ( "" FCM ID token successfully uploaded for user $ userId \ "" "" ) \n + } else { \n + Timber . e ( "" FCM ID token : Error uploading for user $ userId "" ) \n + } \n - } \n + } \n",Makes firestore call on the main thread to avoid concurrency issues \n Cherry - pick from adssched . legit / 95664 \n Bug : 124096834 \n Change - Id : I7e9e571574d92d9cb8305f56c95af8aa7599afef,494
"build . gradle \n - leakCanaryVersion = "" 1 . 5 . 4 "" \n mobile \ build . gradle \n - implementation project ( "" : shared "" ) \n + implementation project ( ' : shared ' ) \n - \n - implementation fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) \n + implementation fileTree ( include : [ ' * . jar ' ] , dir : ' libs ' ) \n - / / Utils \n - / / Leak Canary \n - debugImplementation "" com . squareup . leakcanary : leakcanary - android : $ leakCanaryVersion "" \n - stagingImplementation "" com . squareup . leakcanary : leakcanary - android - no - op : $ leakCanaryVersion "" \n - releaseImplementation "" com . squareup . leakcanary : leakcanary - android - no - op : $ leakCanaryVersion "" \n - \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ fcm \ FcmTokenUpdater . kt \n - } \n - \n - / / Write server timestamp to / users / < userId > / lastUsage \n - \n - val lastUsage = mapOf ( \n - USER _ LAST _ USAGE _ KEY to FieldValue . serverTimestamp ( ) \n - ) \n - \n - firestore \n - . document2019 ( ) \n - . collection ( USERS _ COLLECTION ) \n - . document ( userId ) \n - . set ( lastUsage , SetOptions . merge ( ) ) . addOnCompleteListener { \n - if ( it . isSuccessful ) { \n - Timber . d ( "" Last usage timestamp successfully uploaded for user $ userId \ "" "" ) \n - } else { \n - Timber . e ( "" Last usage timestamp : Error uploading for user $ userId "" ) \n - } \n - private const val USER _ LAST _ USAGE _ KEY = "" lastUsage "" \n",Removes LeakCanary and an extra call to firestore \n Cherry pick from adssched . legit / 95285 \n Let ' s file a separate bug if we can enable LeakCanary again \n Bug : 124096834 \n Change - Id : I6cf51da8b5c2721f3d4f22b7465ae7f59a44850f,494
"mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" download _ ar _ dialog _ message "" translation _ description = "" Message for a dialog asking the user whether to download the Augmented Reality module when they are on a metered network . "" > We need to download the Augmented Reality module from the Play Store before you can launch . This device is currently connected to a metered network which may charge you for any data transferred . \ n \ nDo you wish to proceed ? < / string > \n + < string name = "" download _ ar _ dialog _ message "" translation _ description = "" Message for a dialog asking the user whether to download the Augmented Reality module when they are on a metered network . "" > We need to download the Augmented Reality module from the Play Store before you can launch . This device is currently connected to a metered network which may charge you for any data transferred . \ n \ nDo you wish to proceed ? \ n \ nNote that the AR mode is for an on - site experience . < / string > \n",Add a message to the dialog when the user is about to download the AR module with a metered network . \n That AR mode is for an on - site experience . \n Bug : 128656798 \n Change - Id : I8dbad4ac6a906480c827f93bcd697ee314bae032,494
"ar \ build . gradle \n + consumerProguardFiles ' consumer - proguard - rules . pro ' \n - implementation ( name : ' arwebview - android ' , ext : ' aar ' ) \n + implementation ( name : ' arwebview ' , ext : ' aar ' ) \n + implementation "" com . google . android . gms : play - services - vision : $ rootProject . googlePlayServicesVisionVersion "" \n rename from ar \ proguard - rules . pro \n rename to ar \ consumer - proguard - rules . pro \n + \n + - keep class com . google . ar . web . * * { * ; } \n + - dontwarn com . google . ar . web . * * \n new file \n ar \ src \ main \ assets \ images . imgdb \n Binary files / dev / null and b / ar / src / main / assets / images . imgdb differ \n ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n - arWebView . loadUrl ( "" https : / / www . google . com "" ) \n + arWebView . loadUrl ( "" https : / / ia - signpost - test . appspot . com "" ) \n build . gradle \n - arcoreVersion = ' 1 . 2 . 0 ' \n + arcoreVersion = ' 1 . 7 . 0 ' \n + googlePlayServicesVisionVersion = ' 17 . 0 . 2 ' \n",Updates dependencies and assets for the AR module \n - Update to the latest ArWebView \n - Update the version of arcore to 1 . 7 . 0 \n - Add the google play services vision \n - Place the image database as the asset of the AR module \n Bug : 126293505 \n Change - Id : I24a7d2a84ea3e45a8da25e6024601870ae6392ab,494
"mobile \ src \ main \ AndroidManifest . xml \n - < ! - - This activity alias lets us change the main entry point without breaking launcher \n - shortcuts . DO NOT change its android : name attribute . - - > \n - < activity - alias \n - android : name = "" . Launcher "" \n - android : label = "" @ string / app _ name "" \n - android : targetActivity = "" . ui . LauncherActivity "" > \n - < intent - filter > \n - < action android : name = "" android . intent . action . MAIN "" / > \n - < category android : name = "" android . intent . category . LAUNCHER "" / > \n - < / intent - filter > \n - < / activity - alias > \n - \n",Remove activity - alias to avoid duplicate launcher icons . \n activity - alias can ' t work with launcher icons for Instant App and \n looks like we don ' t have to have it . \n Bug : 129374382 \n Change - Id : I5f8b3c7c32d511707bebf68e66f77bd839692708,494
"ar \ src \ main \ AndroidManifest . xml \n - dist : title = "" @ string / feature _ explore _ ar "" > \n + dist : title = "" @ string / feature _ explore _ io "" > \n - < meta - data android : name = "" com . google . ar . core "" android : value = "" required "" / > \n + < meta - data android : name = "" com . google . ar . core "" android : value = "" optional "" / > \n mobile \ src \ main \ AndroidManifest . xml \n - - > \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n + < meta - data android : name = "" com . google . ar . core "" android : value = "" optional "" / > \n + \n + < meta - data tools : replace = "" android : value "" \n + android : name = "" com . google . ar . core . min _ apk _ version "" \n + android : value = "" 190128000 "" / > \n + \n mobile \ src \ main \ res \ menu \ navigation . xml \n - android : title = "" @ string / title _ explore _ ar "" \n - app : contentDescription = "" @ string / title _ explore _ ar "" / > \n + android : title = "" @ string / title _ explore _ io "" \n + app : contentDescription = "" @ string / title _ explore _ io "" / > \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" title _ explore _ ar "" translation _ description = "" The title for the Augmented reality exploration screen where the user can explore the I / O venue in AR . "" > Explore AR < / string > \n + < string name = "" title _ explore _ io "" translation _ description = "" The title for the Augmented reality exploration screen where the user can explore the I / O venue in AR . "" > Explore I / O < / string > \n shared \ src \ main \ res \ values \ strings . xml \n - < string name = "" feature _ explore _ ar "" translation _ description = "" The feature module name for exploring AR "" > Explore AR < / string > \n + < string name = "" feature _ explore _ io "" translation _ description = "" The feature module name for exploring I / O venue in Augmented Readlity "" > Explore I / O < / string > \n",Add missing configurations for AR \n - ARCore settings in manifest \n - Change the name in the menu \n Bug : 126293505 \n Change - Id : I291612c53ca3b4c44abcab4659187c5eced66836,494
"ar \ src \ main \ AndroidManifest . xml \n + < uses - permission android : name = "" android . permission . WRITE _ EXTERNAL _ STORAGE "" / > \n",Add WRITE _ EXTERNAL _ STORAGE for AR module \n To save the a photo in the AR scene as user visible media . \n Runtime permission should be handled by the AR library . \n Bug : 126293505 \n Change - Id : I85042521107f16ce3e887263b8480cc2474ead19,494
"build . gradle \n - versionName = ' 7 . 0 . 5 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70050 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 6 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70060 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 6 \n Change - Id : I7cbfdfc580fea520ad53f4f695846b6e90426431,494
"ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n - webView . webViewClient = ArWebViewClient ( pinnedSessionsJson , canSignedInUserDemoAr ) \n - webView . settings . mediaPlaybackRequiresUserGesture = false \n + webView . apply { \n + webViewClient = ArWebViewClient ( pinnedSessionsJson , canSignedInUserDemoAr ) \n + settings . apply { \n + mediaPlaybackRequiresUserGesture = false \n + domStorageEnabled = true \n + databaseEnabled = true \n + } \n + } \n",Enable local storage \n Additional request from AR team to enable local storage \n Bug : 130595329 \n Change - Id : Ia0348e5c74b455e65bc41368f7a6dc47ed1c6d2d,494
"mobile \ src \ main \ res \ layout \ fragment _ onboarding _ welcome _ pre . xml \n - android : text = "" @ string / onboarding _ welcome _ google _ io _ during "" \n + android : text = "" @ string / onboarding _ welcome _ google _ io _ pre "" \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" onboarding _ date _ location "" translation _ description = "" The date and the place of Google I / O 2019 . "" > May 7–9 , \ n2019 Mountain View , CA < / string > \n + < string name = "" onboarding _ date _ location "" translation _ description = "" The date and the place of Google I / O 2019 . "" > May 7–9 , 2019 \ nMountain View , CA < / string > \n",Fix the texts in onboarding \n Bug : 130564141 \n Change - Id : Id457c0b2284e7cbc3a6bf7b5eb93b03435db81ad,494
"ar \ src \ main \ AndroidManifest . xml \n - - > \n - xmlns : dist = "" http : / / schemas . android . com / apk / distribution "" \n - < dist : module \n - dist : onDemand = "" true "" \n - dist : title = "" @ string / feature _ explore _ io "" > \n - < dist : fusing dist : include = "" true "" / > \n - < / dist : module > \n - \n - android : theme = "" @ style / AppTheme . Fullscreen "" / > \n + android : theme = "" @ style / AppTheme . NoActionBar . BlackStatusBar "" / > \n ar \ src \ main \ res \ values \ styles . xml \n - - > \n - < style name = "" AppTheme . Fullscreen "" parent = "" @ style / Theme . AppCompat . Light . NoActionBar "" > \n - < item name = "" android : windowNoTitle "" > true < / item > \n - < item name = "" android : windowActionBar "" > false < / item > \n - < item name = "" android : windowFullscreen "" > true < / item > \n - < item name = "" android : windowContentOverlay "" > @ null < / item > \n + < style name = "" AppTheme . NoActionBar . BlackStatusBar "" parent = "" @ style / Theme . AppCompat . NoActionBar "" > \n + < item name = "" android : statusBarColor "" > @ color / black < / item > \n",Change the theme for ArActivity to show the black status bar \n Also removes the unused dist attributes from AndroidManifest \n Bug : 129715316 \n Change - Id : Icbc12d9022f8ef85b074ea763a285a18b6689816,494
"build . gradle \n - versionName = ' 7 . 0 . 6 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70060 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 7 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70070 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump the version to 7 . 0 . 7 \n Change - Id : If92f134e650849429819ccf64cab0b8eb99e6091,494
shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n - < value > true < / value > \n + < value > false < / value > \n,Hide map from the initial release \n Bug : 130472981 \n Bug : 130687363 \n Change - Id : I4b0bd0a348d9439926feb45ed1ddf88e36541a2b,494
"build . gradle \n - instantAppsVersion = ' 1 . 1 . 0 ' \n mobile \ build . gradle \n - implementation "" com . google . android . instantapps : instantapps : $ rootProject . instantAppsVersion "" \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ FirebaseAnalyticsHelper . kt \n - import com . google . android . instantapps . InstantApps \n - private val FA _ DEPLOYMENT _ TYPE = "" app _ type "" \n - \n - private val STATUS _ INSTALLED = "" installed "" \n - private val STATUS _ INSTANT = "" instant "" \n - val isInstant = InstantApps . isInstantApp ( context ) \n - val deploymentType = if ( isInstant ) STATUS _ INSTANT else STATUS _ INSTALLED \n - firebaseAnalytics . setUserProperty ( FA _ DEPLOYMENT _ TYPE , deploymentType ) \n - \n - Timber . d ( "" Analytics initialized , $ FA _ DEPLOYMENT _ TYPE : $ deploymentType "" ) \n + Timber . d ( "" Analytics initialized "" ) \n","Revert "" Add deployment type tracking "" \n This reverts commit f611e11df333723a7252867d4707c5fad5eea389 . \n Reason for revert : We are not enabling Instant App this year \n Change - Id : I0214b75628c004d1b25146d8afa3e3314b3535da",494
ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n + override fun onDestroy ( ) { \n + arWebView . webView . destroy ( ) \n + super . onDestroy ( ) \n + } \n + \n,Destroys ArWebView ' s webview on activity destroy . \n Change - Id : I4bfae0e16974c7462984ec991bd66b1a6c2dd187,494
"mobile \ src \ main \ res \ layout \ item _ feed _ announcement . xml \n + android : autoLink = "" web "" \n",Enable URL link in announcements in Home \n Bug : 130744082 \n Change - Id : I61b85eaa7c118eb05ff6ad0040ffb8967e77b3ff,494
"mobile \ src \ main \ AndroidManifest . xml \n - < ! - - URL handling and instant app auto - verification . - - > \n - < intent - filter android : autoVerify = "" true "" > \n - < action android : name = "" android . intent . action . VIEW "" / > \n - < category android : name = "" android . intent . category . BROWSABLE "" / > \n - < category android : name = "" android . intent . category . DEFAULT "" / > \n - < data android : scheme = "" http "" / > \n - < data android : scheme = "" https "" / > \n - < data android : host = "" events . google . com "" / > \n - < data android : path = "" / io "" / > \n - < data android : path = "" / io / "" / > \n - < data android : path = "" / io / schedule "" / > \n - < data android : path = "" / io / schedule / "" / > \n - < / intent - filter > \n - < meta - data \n - android : name = "" default - url "" \n - android : value = "" https : / / events . google . com / io "" / > \n",Remove intent - filter for handling URLs matching I / O site \n Because we ' re not enabling Instant App this year . \n Bug : 130772665 \n Change - Id : I44ff7eec8c9578786228182341622a67a8b7abe9,494
"mobile \ src \ main \ res \ layout \ item _ feed _ announcement . xml \n - android : layout _ margin = "" @ dimen / margin _ normal "" > \n + android : layout _ marginBottom = "" @ dimen / margin _ small "" \n + android : layout _ marginEnd = "" @ dimen / margin _ normal "" \n + android : layout _ marginStart = "" @ dimen / margin _ normal "" \n + android : layout _ marginTop = "" @ dimen / margin _ small "" > \n",Tweak the vertical margin for announcements to make it similar to mock \n Change - Id : I7c71c3564be0a2384a112ab08265c1f63ac3c0d5,494
"build . gradle \n - versionName = ' 7 . 0 . 7 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70070 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 8 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70080 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump the version to 7 . 0 . 8 \n Change - Id : I61379b2622fee59ff8e923b0f07124833ed631b9,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ agenda \ AgendaRepository . kt \n - title = "" Office Hours & App Review "" , \n + title = "" Office Hours & App Reviews "" , \n - title = "" Badge & device pick - up "" , \n + title = "" Badge pick - up "" , \n - title = "" Badge & device pick - up "" , \n + title = "" Badge pick - up "" , \n",Fix agenda texts \n Bug : 130967376 \n Change - Id : I95b851f7cc5b7379a96721b868023d15fa88085b,494
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ db \ AppDatabase . kt \n - return Room . databaseBuilder ( context , AppDatabase : : class . java , databaseName ) . build ( ) \n + / / Since Room is only used for FTS , destructive migration is enough because the tables \n + / / are cleared every time the app launches . \n + / / https : / / medium . com / androiddevelopers / understanding - migrations - with - room - f01e04b07929 \n + return Room . databaseBuilder ( context , AppDatabase : : class . java , databaseName ) \n + . fallbackToDestructiveMigration ( ) \n + . build ( ) \n",Add Room migration path \n Room is only used for FTS . destructive migration path is enough . \n Change - Id : Id54688b29f93eb9e85166571632e7b2f0a8d42ed,494
"build . gradle \n - versionName = ' 7 . 0 . 8 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70080 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 9 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70090 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump the version to 7 . 0 . 9 \n Change - Id : I639c56f102de4061ef6eb89b4b343fc08dbf984a,494
"build . gradle \n - versionName = ' 7 . 0 . 9 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70090 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 10 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70100 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 10 \n Change - Id : I7d57160111ac3ece11866cd2707c28f25d3698c6,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailFragment . kt \n - import com . google . android . material . bottomappbar . BottomAppBar \n - val menu = requireActivity ( ) . findViewById < BottomAppBar > ( \n - R . id . session _ detail _ bottom _ app _ bar \n - ) . menu \n + val menu = binding . sessionDetailBottomAppBar . menu \n - analyticsHelper . sendScreenView ( "" Session Details : $ sessionTitle "" , requireActivity ( ) ) \n + activity ? . let { activity - > \n + analyticsHelper . sendScreenView ( "" Session Details : $ sessionTitle "" , activity ) \n + } \n","Mitigate the crash in session detail \n Couldn ' t reliably reproduce , but Activity doesn ' t seem to be needed \n in onActivityCreated \n Bug : 131120613 \n Change - Id : I9e5603d3f2357533d5366c795a167f5466e7f67b",494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ sessions \ NotificationAlarmUpdater . kt \n + import com . google . samples . apps . iosched . shared . domain . internal . DefaultScheduler \n - is Success - > cancelAllSessions ( sessions . data ) \n + is Success - > DefaultScheduler . execute { \n + cancelAllSessions ( sessions . data ) \n + } \n,"Cancel the alarms in a worker thread . \n Cancelling alarms doesn ' t have to be in the main thread , which led to \n UI freeze with a low - end device . \n Bug : 131121336 \n Change - Id : I11ea2371cd5314398cafd6c71047f3e6d0a3d9a8",494
"build . gradle \n - versionName = ' 7 . 0 . 10 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70100 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 11 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70110 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump the version to 7 . 0 . 11 \n Change - Id : I11c4736007fec15431d9cf2a76e7b943a7a55192,494
ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n + import android . view . WindowManager \n + window . addFlags ( WindowManager . LayoutParams . FLAG _ KEEP _ SCREEN _ ON ) \n + window . clearFlags ( WindowManager . LayoutParams . FLAG _ KEEP _ SCREEN _ ON ) \n - val arWebView : ArWebView \n + arWebView : ArWebView \n,Add FLAG _ KEEP _ SCREEN _ ON for the ArActivity \n To keep the sceen on while the ArActivity is visible \n Bug : 130569160 \n Change - Id : I6201bfdf15d22acb53a09f52b8b1d33bc06883e3,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ feed \ FeedSessionsViewBinder . kt \n - val timeZoneId : ZoneId = ZoneId . systemDefault ( ) \n + val timeZoneId : ZoneId = ZoneId . systemDefault ( ) , \n + val isLoading : Boolean \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ feed \ FeedViewModel . kt \n - . let { it . subList ( 0 , Math . min ( MAX _ SESSIONS , it . size ) ) } \n - \n + . let { it . subList ( 0 , Math . min ( MAX _ SESSIONS , it . size ) ) } , \n + isLoading = sessions is Result . Loading \n mobile \ src \ main \ res \ layout \ item _ feed _ sessions _ container . xml \n + < ProgressBar \n + android : id = "" @ + id / loading "" \n + android : layout _ width = "" wrap _ content "" \n + android : layout _ height = "" wrap _ content "" \n + android : indeterminate = "" true "" \n + android : indeterminateTint = "" ? attr / colorControlLight "" \n + app : layout _ constraintBottom _ toTopOf = "" @ + id / actionButton "" \n + app : layout _ constraintEnd _ toEndOf = "" parent "" \n + app : layout _ constraintStart _ toStartOf = "" parent "" \n + app : layout _ constraintTop _ toBottomOf = "" @ + id / title "" \n + app : goneUnless = "" @ { sessionContainerState . isLoading } "" / > \n + \n",Add a loading progress bar for sessions in Home \n Bug : 131132671 \n Change - Id : I735d71721e8a67fc3de192c6c4da59dedb0f83a9,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchFragment . kt \n + requestFocus ( ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchViewModel . kt \n + import androidx . lifecycle . MediatorLiveData \n - val searchResults : LiveData < List < SearchResult > > \n - val isEmpty : LiveData < Boolean > \n + private val _ searchResults = MediatorLiveData < List < SearchResult > > ( ) \n + val searchResults : LiveData < List < SearchResult > > = _ searchResults \n + \n + private val _ isEmpty = MediatorLiveData < Boolean > ( ) \n + val isEmpty : LiveData < Boolean > = _ isEmpty \n - searchResults = loadSearchResults . map { \n - val result = it as ? Result . Success ? : return @ map emptyList < SearchResult > ( ) \n - result . data . map { searched - > \n + _ searchResults . addSource ( loadSearchResults ) { \n + val result = ( it as ? Result . Success ) ? . data ? : emptyList ( ) \n + _ searchResults . value = result . map { searched - > \n - / / This may not be unique , but to navigate to the meaningful page , \n + / / This may not be unique , but to navigate to a meaningful page , \n - \n - isEmpty = loadSearchResults . map { \n - it . successOr ( null ) . isNullOrEmpty ( ) \n + _ isEmpty . addSource ( loadSearchResults ) { \n + _ isEmpty . value = it . successOr ( null ) . isNullOrEmpty ( ) \n + onQueryCleared ( ) \n + \n + private fun onQueryCleared ( ) { \n + _ searchResults . value = emptyList ( ) \n + / / Explicitly set false to not show the "" No results "" state \n + _ isEmpty . value = false \n + } \n",Fix the search feature \n - Focus the SearchView when SearchFragment is opened \n - Clear the search results when query is cleared or length becomes < 2 \n Bug : 131384542 \n Bug : 131372508 \n Change - Id : Ib9db8daea13f067ca22853aa5d6d309721656128,494
shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n - < value > false < / value > \n + < value > true < / value > \n,Enable map by default \n Change - Id : Icdcd35d35af7c601c2759f8e87f7d5876f6479dd,494
"build . gradle \n - versionName = ' 7 . 0 . 12 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70120 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 13 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70130 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 13 \n Change - Id : I4f8dee8c67ebfc26010625f912bb736191df3b3f,494
mobile \ proguard - rules . pro \n - dontwarn com . crashlytics . * * \n - - keep class com . firebase . ui . auth . * * { * ; } \n + - keep class com . firebase . ui . auth . * * { * ; } \n + \n + # Firebase Functions \n + - keep class org . json . * * { * ; } \n,Fixes the crash in the schedule screen with a release binary . \n Verified with a self - signed release binary \n Bug : 129992163 \n Change - Id : I247f7413ed3f901f83f4e283c627bfd8d8704cb9,494
"kokoro \ build . sh \n + \n + \n + # For Firebase Test Lab \n + SERVICE _ ACCOUNT _ KEY = $ { KOKORO _ GFILE _ DIR } / events - dev - 62d2e - 072ce72b3067 . json \n + gcloud config set project events - dev - 62d2e \n + gcloud auth activate - service - account firebasetestlabforkokoro @ events - dev - 62d2e . iam . gserviceaccount . com - - key - file $ { SERVICE _ ACCOUNT _ KEY } \n + \n + . / gradlew mobile : assembleAndroidTest \n + . / gradlew mobile : assembleStaging \n + gcloud firebase test android run \ \n + - - type instrumentation \ \n + - - app mobile / build / outputs / apk / staging / mobile - staging . apk \ \n + - - test mobile / build / outputs / apk / androidTest / staging / mobile - staging - androidTest . apk \ \n + - - device - ids blueline \ \n + - - os - version - ids 28 \ \n + - - locales en \ \n + - - timeout 120 \n kokoro \ continuous . cfg \n + # Extra input files / directories for the build \n + gfile _ resources : "" / x20 / teams / iosched - android / keys "" \n + \n kokoro \ presubmit . cfg \n + \n + # Extra input files / directories for the build \n + gfile _ resources : "" / x20 / teams / iosched - android / keys "" \n + \n",Include instrumented tests as part of CI \n Bug : 132345602 \n Change - Id : I319cbbbdde587996945590fd3d76909fa4dc50c3,494
"kokoro \ build . sh \n - gcloud firebase test android run \ \n - - - type instrumentation \ \n - - - app mobile / build / outputs / apk / staging / mobile - staging . apk \ \n - - - test mobile / build / outputs / apk / androidTest / staging / mobile - staging - androidTest . apk \ \n - - - device - ids blueline \ \n - - - os - version - ids 28 \ \n - - - locales en \ \n - - - timeout 120 \n + \n + MAX _ RETRY = 3 \n + run _ firebase _ test _ lab ( ) { \n + # # Retry can be done by passing the - - num - flaky - test - attempts to gcloud , but gcloud SDK in the \n + # # kokoro server doesn ' t support it yet . \n + \n + set + e # To not exit on an error to retry flaky tests \n + local counter = 0 \n + local result = 1 \n + while [ $ result ! = 0 - a $ counter - lt $ MAX _ RETRY ] ; do \n + gcloud firebase test android run \ \n + - - type instrumentation \ \n + - - app mobile / build / outputs / apk / staging / mobile - staging . apk \ \n + - - test mobile / build / outputs / apk / androidTest / staging / mobile - staging - androidTest . apk \ \n + - - device - ids hammerhead , walleye , blueline \ \n + - - os - version - ids 21 , 26 , 28 , Q - beta - 3 \ \n + - - locales en \ \n + - - timeout 60 \n + result = $ ? ; \n + let counter = counter + 1 \n + done \n + return $ result \n + } \n + \n + run _ firebase _ test _ lab \n + exit $ ? \n",Improve the instrumented tests \n - Increase the API level coverage \n - Retry the tests if it ' s flaky \n Change - Id : I4298096d944e0666c2282d62e7b922f035fc22ee,494
mobile \ src \ androidTest \ java \ com \ google \ samples \ apps \ iosched \ tests \ ui \ InfoTest . kt \n - . check ( matches ( withText ( R . string . info _ title ) ) ) \n + . check ( matches ( withText ( R . string . title _ info ) ) ) \n,Fix the instrumented tests \n Change - Id : I8688e4f0e25167a1ebbe41287802666b44032a88,494
"ar \ src \ main \ AndroidManifest . xml \n - < meta - data android : name = "" com . google . ar . core "" android : value = "" optional "" / > \n - \n","Remove arcore metadata from the AR module \n The arcore metadata is defined in the AndroidManifest in mobile , too . \n The error seems to be complaining missing com . google . ar . core . min _ apk _ version \n - - - - - - - - - - - - - - - - - - - - - - \n The ARCore dependency minimum version code \n com . google . ar . core . min _ apk _ version is missing from the the \n AndroidManifest . xml file although the meta - data tag com . google . ar . core has been specified \n - - - - - - - - - - - - - - - - - - - - - - \n Bug : 130026975 \n Change - Id : Ib502e743383fbfd1a6111bc0f25977317b23a8c3",494
"build . gradle \n - versionName = ' 7 . 0 . 0 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70000 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 1 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70010 / / XYYZZM ; M = Module ( tv , mobile ) \n",Version bump for trying new upload \n Bug : 130026975 \n Change - Id : I486f820c82ed47ada5769a5dc125722deaad9583,494
build . gradle \n - compileSdkVersion = ' android - Q ' \n + compileSdkVersion = 29 \n - targetSdkVersion = 28 \n + targetSdkVersion = 29 \n,Update the API level to 29 \n Change - Id : I7a98d278589cd1e1381f1334415b76a724d2091e,494
"build . gradle \n - androidGradlePluginVersion = ' 3 . 3 . 2 ' \n + androidGradlePluginVersion = ' 3 . 4 . 1 ' \n gradle \ wrapper \ gradle - wrapper . properties \n - # Thu Jan 24 17 : 21 : 12 JST 2019 \n + # Tue Jun 18 14 : 47 : 10 JST 2019 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 4 . 10 . 3 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 5 . 1 . 1 - all . zip \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ codelabs \ CodelabsAdapter . kt \n + import android . annotation . SuppressLint \n + @ SuppressLint ( "" DiffUtilEquals "" ) \n + / / Workaround of https : / / issuetracker . google . com / issues / 122928037 \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailAdapter . kt \n + import android . annotation . SuppressLint \n + @ SuppressLint ( "" DiffUtilEquals "" ) \n + / / Workaround of https : / / issuetracker . google . com / issues / 122928037 \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ speaker \ SpeakerAdapter . kt \n + import android . annotation . SuppressLint \n + @ SuppressLint ( "" DiffUtilEquals "" ) \n + / / Workaround of https : / / issuetracker . google . com / issues / 122928037 \n",Update AGP to 3 . 4 . 1 \n Change - Id : Ibd97ddf2b0f91b0f4fa35826fe4a00daa6a97167,494
"ar \ build . gradle \n - implementation ( name : ' arwebview ' , ext : ' aar ' ) \n ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n + import android . webkit . WebViewClient \n - import com . google . ar . web . webview . ArWebView \n - private lateinit var arWebView : ArWebView \n + private lateinit var arWebView : WebView \n - arWebView = ArWebView ( this ) \n + arWebView = WebView ( this ) \n - webView . apply { \n - webViewClient = \n - ArWebViewClient ( pinnedSessionsJson , canSignedInUserDemoAr , arWebView ) \n - settings . apply { \n - mediaPlaybackRequiresUserGesture = false \n - domStorageEnabled = true \n - databaseEnabled = true \n - } \n + webViewClient = \n + ArWebViewClient ( pinnedSessionsJson , canSignedInUserDemoAr ) \n + settings . apply { \n + mediaPlaybackRequiresUserGesture = false \n + domStorageEnabled = true \n + databaseEnabled = true \n - arWebView . webView . reload ( ) \n + arWebView . reload ( ) \n - "" window . app . addIntroOverlay ( ) ; "" \n - arWebView . webView . evaluateJavascript ( addOverlayScript ) { } \n + "" window . app . addIntroOverlay ( ) ; "" \n + arWebView . evaluateJavascript ( addOverlayScript ) { } \n - arWebView . webView . destroy ( ) \n + arWebView . destroy ( ) \n - val canDemoAr : Boolean , \n - arWebView : ArWebView \n - ) : ArWebView . ArWebViewDefaultWebViewClient ( arWebView ) { \n + val canDemoAr : Boolean \n + ) : WebViewClient ( ) { \n - "" window . app . sendIOAppUserAgenda ( ' $ json ' ) ; "" \n + "" window . app . sendIOAppUserAgenda ( ' $ json ' ) ; "" \n - "" window . app . setDebugUser ( ) "" \n + "" window . app . setDebugUser ( ) "" \n shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n - < value > true < / value > \n + < value > false < / value > \n",Remove ArWebView to prepare for the open source release \n Change - Id : Ie59277e6ced2c2fbf753cbb7d1fd4bdb38214c0b,494
"kokoro \ build . sh \n + # # TODO : Add os - version 29 once it ' s available \n - - type instrumentation \ \n - - app mobile / build / outputs / apk / staging / mobile - staging . apk \ \n - - test mobile / build / outputs / apk / androidTest / staging / mobile - staging - androidTest . apk \ \n - - device - ids hammerhead , walleye , blueline \ \n - - - os - version - ids 21 , 26 , 28 , Q - beta - 3 \ \n + - - os - version - ids 21 , 26 , 28 \ \n - - locales en \ \n - - timeout 60 \n",Run the instrumentation tests on API level 29 \n Change - Id : I923dbf0933bbaf77a9e51dc80ad752d3aa4fa939,494
"mobile \ src \ main \ res \ layout \ include _ schedule _ appbar . xml \n - app : layout _ scrollFlags = "" scroll | snap "" \n + app : layout _ scrollFlags = "" scroll | snap | enterAlways "" \n",Make the toolbar in schedule behave as enter _ always . \n Otherwise it ' s not possible show the toolbar in the middle of the \n scroll . \n Change - Id : Iacc0d0bbc312648c11e039158c90ac208a645d6d,494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ users \ ReservationActionUseCase . kt \n - result . removeSource ( updateResult ) \n - result . addSource ( updateResult ) { \n - result . postValue ( updateResult . value ) \n + DefaultScheduler . postToMainThread { \n + / / Posting this block to main thread because MediatorLiveData # addSource needs \n + / / to be called in the main thread since LiveData # observeForever is called \n + result . removeSource ( updateResult ) \n + result . addSource ( updateResult ) { \n + result . postValue ( updateResult . value ) \n + } \n,Fix the warning when reserving a seat \n The warning happened because following error was returned \n Error ( exception = java . lang . IllegalStateException : \n Cannot invoke observeForever on a background thread ) \n The change of this CL is to make sure MediatorLiveData # addSource \n is called in the main thread since LiveData # observeForever is \n called inside of addSource \n Bug : 129930504 \n Change - Id : I87f9c22e9a1beb411145774fa9324ff63c729790,494
"build . gradle \n - versionName = ' 7 . 0 . 1 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70010 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 2 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70020 / / XYYZZM ; M = Module ( tv , mobile ) \n","Bump version to 7 . 0 . 2 \n We are going to bump the version on Tuesday , too . \n But wanted to update the app in Dogfood Manager on Monday \n Change - Id : Ia0f8b04f950dbe37af321d9be3312e4b759c1770",494
"build . gradle \n - versionName = ' 7 . 0 . 13 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70130 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 14 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70140 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump the version to 7 . 0 . 14 \n Change - Id : Ib31724aaf614e25e08def6709ae2260377cc704b,494
"mobile \ src \ main \ res \ layout \ fragment _ schedule . xml \n - style = "" @ style / Widget . IOSched . EmptyResults "" \n + android : drawablePadding = "" @ dimen / spacing _ normal "" \n + android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n + android : gravity = "" center "" \n + tools : text = "" @ string / schedule _ filters _ empty "" \n mobile \ src \ main \ res \ layout \ fragment _ search . xml \n - style = "" @ style / Widget . IOSched . EmptyResults "" \n + android : layout _ gravity = "" center "" \n + android : drawablePadding = "" @ dimen / spacing _ normal "" \n + android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n + android : gravity = "" center "" \n mobile \ src \ main \ res \ layout \ item _ feed _ announcements _ placeholder . xml \n - style = "" @ style / Widget . IOSched . EmptyResults "" \n + android : drawablePadding = "" @ dimen / spacing _ normal "" \n + android : drawableTop = "" @ drawable / no _ items _ found _ 204 "" \n + android : gravity = "" center "" \n mobile \ src \ main \ res \ values \ styles . xml \n - < ! - - Misc - - > \n - < style name = "" Widget . IOSched . EmptyResults "" > \n - < item name = "" android : drawablePadding "" > @ dimen / margin _ normal < / item > \n - < item name = "" android : drawableTop "" > @ drawable / no _ items _ found _ 204 < / item > \n - < item name = "" android : gravity "" > center _ horizontal < / item > \n - < item name = "" android : textAppearance "" > ? android : textAppearanceMedium < / item > \n - < / style > \n","Revert "" Consolidate style for empty results views "" \n This reverts commit 9b554cb496b127315dae9e03b1390a3b2d2637b9 . \n Reason for revert : Noticed this broke the empty result view in the search result . \n Change - Id : Id67d1a349cf2053d670990c81b68888509496421",494
"build . gradle \n - versionName = ' 7 . 0 . 14 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70140 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 15 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70150 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 15 \n Change - Id : Id30197e62bab70ca71dd0e2f8ad157544d30bfa7,494
"README . md \n - < img align = "" center "" src = "" schedule . png "" alt = "" Schedule screenshot "" height = "" 640 "" width = "" 360 "" > \n + < img align = "" center "" src = "" schedule . png "" alt = "" Schedule screenshot "" height = "" 640 "" width = "" 320 "" > \n",Update README \n Update the aspect ratio of the screenshot,494
"README . md \n - For a simpler fork of the app , check out the [ Android Dev Summit App in the adssched branch ] ( https : / / github . com / google / iosched / tree / adssched ) . In this variant some features are removed , such as reservations and the map screen , and new features are added : notifications , Instant App support and more modern dependencies . \n + For a simpler fork of the app , check out the [ Android Dev Summit App in the adssched branch ] ( https : / / github . com / google / iosched / tree / adssched ) . In this variant some features are removed , such as reservations and the map screen , and Instant App support is added . \n",Update the README about adssched \n Update the description about adssched,494
"build . gradle \n - versionName = ' 7 . 0 . 2 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70020 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 3 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70030 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 3 \n Change - Id : Ia0004ba27bb9db97359002e0e9cec9d39156f9a6,494
"build . gradle \n - versionName = ' 7 . 0 . 3 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70030 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 4 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70040 / / XYYZZM ; M = Module ( tv , mobile ) \n",Update the version to 7 . 0 . 4 \n Change - Id : If856a5c83e6ed14e28bc72ddc65fc4e566149f91,494
"build . gradle \n - firebaseAuthVersion = ' 16 . 1 . 0 ' \n - firebaseConfigVersion = ' 16 . 1 . 2 ' \n - firebaseCoreVersion = ' 16 . 0 . 6 ' \n - firebaseFirestoreVersion = ' 17 . 1 . 4 ' \n - firebaseFunctionsVersion = ' 16 . 3 . 0 ' \n - firebaseMessagingVersion = ' 17 . 3 . 4 ' \n + firebaseAuthVersion = ' 18 . 1 . 0 ' \n + firebaseConfigVersion = ' 18 . 0 . 0 ' \n + firebaseCoreVersion = ' 17 . 0 . 1 ' \n + firebaseFirestoreVersion = ' 20 . 2 . 0 ' \n + firebaseFunctionsVersion = ' 18 . 1 . 0 ' \n + firebaseMessagingVersion = ' 19 . 0 . 1 ' \n - kotlinVersion = ' 1 . 3 . 20 ' \n + kotlinVersion = ' 1 . 3 . 41 ' \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ wifi \ WifiInstaller . kt \n - clipboardManager . primaryClip = clip \n + clipboardManager . setPrimaryClip ( clip ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ widget \ CollapsibleCard . kt \n - text = HtmlCompat . fromHtml ( cardDescription , HtmlCompat . FROM _ HTML _ MODE _ COMPACT ) \n + if ( cardDescription ! = null ) { \n + text = HtmlCompat . fromHtml ( cardDescription , HtmlCompat . FROM _ HTML _ MODE _ COMPACT ) \n + } \n - constructor ( superState : Parcelable ) : super ( superState ) \n + constructor ( superState : Parcelable ? ) : super ( superState ) \n shared \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ ConferenceDataJsonParserTest . kt \n - val inputStream = this . javaClass . classLoader . getResource ( FILENAME ) \n - . openStream ( ) \n + val inputStream = this . javaClass . classLoader ? . getResource ( FILENAME ) \n + ? . openStream ( ) \n - val data = ConferenceDataJsonParser . parseConferenceData ( inputStream ) \n + val data = ConferenceDataJsonParser . parseConferenceData ( inputStream ! ! ) \n - val inputStream = this . javaClass . classLoader . getResource ( MALFORMED _ FILENAME ) \n - . openStream ( ) \n + val inputStream = this . javaClass . classLoader ? . getResource ( MALFORMED _ FILENAME ) \n + ? . openStream ( ) \n - ConferenceDataJsonParser . parseConferenceData ( inputStream ) \n + ConferenceDataJsonParser . parseConferenceData ( inputStream ! ! ) \n",Update library versions \n Change - Id : I0cfa5717f6330947988a6b7c6eb6820d15efcbca,494
README . md \n - implementation ' com . google . android : flexbox : 1 . 1 . 0 ' \n + implementation ' com . google . android : flexbox : 1 . 1 . 1 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 1 . 1 . 0 ' \n + mavenVersion = ' 1 . 1 . 1 ' \n,Version bump for 1 . 1 . 1 release ( # 510 ),494
ar \ src \ main \ assets \ images . imgdb \n Binary files a / ar / src / main / assets / images . imgdb and b / ar / src / main / assets / images . imgdb differ \n,Update imgdb to the latest \n The previous imgdb was not using the final physical sinage design \n Bug : 130272444 \n Change - Id : I4251df2af46934670781a234ecd8e0d63f622019,494
"build . gradle \n - versionName = ' 7 . 0 . 4 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n - versionCodeBase = 70040 / / XYYZZM ; M = Module ( tv , mobile ) \n + versionName = ' 7 . 0 . 5 ' / / X . Y . Z ; X = Major , Y = minor , Z = Patch level \n + versionCodeBase = 70050 / / XYYZZM ; M = Module ( tv , mobile ) \n",Bump version to 7 . 0 . 5 \n Change - Id : Iaca47c41f912bc99fb9f39903787591d36874dd1,494
shared \ src \ main \ res \ xml \ remote _ config _ defaults . xml \n - < value > io2018 < / value > \n + < value > io2019 < / value > \n,Update the default remote config value WiFi SSID for 2019 \n Passoword is same as last year . \n Bug : 129980769 \n Change - Id : I9c2c2ab5c96dd6828c2c8b9ddc8ceab204324e87,494
"mobile \ src \ main \ res \ layout \ fading _ snackbar _ layout . xml \n - style = "" ? borderlessButtonStyle "" \n + style = "" @ style / Widget . IOSched . SnackbarBorderlessAction "" \n mobile \ src \ main \ res \ values - night \ colors . xml \n + < color name = "" color _ on _ snackbar _ action "" > @ color / color _ primary < / color > \n + \n mobile \ src \ main \ res \ values \ colors . xml \n + < color name = "" color _ on _ snackbar _ action "" > # 64b5f6 < / color > \n + \n mobile \ src \ main \ res \ values \ styles . xml \n + < style name = "" Widget . IOSched . SnackbarBorderlessAction "" parent = "" @ style / Widget . IOSched . BorderlessButton "" > \n + < item name = "" android : textColor "" > @ color / color _ on _ snackbar _ action < / item > \n + < / style > \n + \n",Fixes the action color on snackbar action \n Bug : 130288536 \n Change - Id : I3014ac9cee8d39e7162675cd854e511d5999530f,494
"build . gradle \n - playCoreVersion = "" 1 . 4 . 0 "" \n mobile \ build . gradle \n - implementation "" com . google . android . play : core : $ rootProject . playCoreVersion "" \n",Remove unused playcore library \n Change - Id : Id90d569563b45622feab64f04f55dd4efb5ae5ac,494
"build . gradle \n - androidGradlePluginVersion = "" 3 . 5 . 0 "" \n + androidGradlePluginVersion = "" 3 . 5 . 2 "" \n - androidxRecyclerViewVersion = "" 1 . 0 . 0 "" \n + androidxRecyclerViewVersion = "" 1 . 1 . 0 "" \n",Update the library versions ( # 517 ) \n - AGP to 3 . 5 . 2 \n - RecyclerView to 1 . 1 . 0,494
"README . md \n - implementation ' com . google . android : flexbox : 1 . 1 . 1 ' \n + implementation ' com . google . android : flexbox : 2 . 0 . 0 ' \n + * * Note that the default values for ` alignItems ` and ` alignContent ` for ` FlexboxLayout ` have been changed from ` stretch ` to ` flex _ start ` starting from 2 . 0 . 0 , it may break the existing apps . \n + Please make sure to set ` stretch ` explicitly if you want to apply the behavior of ` stretch ` . * * \n + \n + \n - * stretch ( default ) \n - * flex _ start \n + * flex _ start ( default ) \n + * stretch \n - * stretch ( default ) \n - * flex _ start \n + * flex _ start ( default ) \n + * stretch \n + ( 5 ) Default values for ` alignItems ` and ` alignContent ` are set to ` flex _ start ` instead of ` stretch ` . \n + * Setting ` stretch ` for the ` alignItems ` is expensive because the children of ` FlexboxLayout ` are calculated more than twice . The difference is more obvious when the layout hierarchy is deeply nested . \n + \n flexbox \ constants . gradle \n - mavenVersion = ' 1 . 1 . 1 ' \n + mavenVersion = ' 2 . 0 . 0 ' \n",Preparation for 2 . 0 . 0 ( # 518 ) \n Update README,494
build . gradle \n - androidGradlePluginVersion = ' 3 . 3 . 1 ' \n + androidGradlePluginVersion = ' 3 . 3 . 2 ' \n,Update AGP version to 3 . 3 . 2 \n Change - Id : I63f68a8e5c5acd59a61ff04c6169db1ca613c8ef,494
ar \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ar \ ArActivity . kt \n + private lateinit var arWebView : ArWebView \n + \n - val arWebView = ArWebView ( this ) \n + arWebView = ArWebView ( this ) \n + override fun onRestart ( ) { \n + super . onRestart ( ) \n + arWebView . webView . reload ( ) \n + } \n + \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ MainActivity . kt \n + addFlags ( Intent . FLAG _ ACTIVITY _ SINGLE _ TOP ) \n,Reload the ArWebView when the application is stopped \n Already tested by Iker with the code \n Bug : 130383378 \n Change - Id : Idc26aec16cc17e8f2be76727dc1a5d950d29affb,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ info \ InfoFragment . kt \n + import androidx . core . view . updatePaddingRelative \n + import com . google . samples . apps . iosched . util . doOnApplyWindowInsets \n + binding . viewpager . doOnApplyWindowInsets { v , insets , padding - > \n + v . updatePaddingRelative ( bottom = padding . bottom + insets . systemWindowInsetBottom ) \n + } \n",Fix the bottom padding in info screen \n Bug : 130399571 \n Change - Id : I798ebc5b21c6182c0c9de1fd14bded9dab970249,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ info \ InfoFragment . kt \n - R . string . travel _ title \n + R . string . travel _ title , \n + R . string . faq _ title \n - { TravelFragment ( ) } \n - / / TODO : Not adding FaqFragment because it uses NestedScrollView , opening Info page takes \n - / / noticeable amount of time . \n + { TravelFragment ( ) } , \n + { FaqFragment ( ) } \n + / / TODO : Track the InfoPage performance b / 130335745 \n","Make the FAQ tab in Info screen visible . \n The performance issue hasn ' t been fixed , but tracking in a different \n issue \n Bug : 129981789 \n Change - Id : Id19258aae89e7928219642c1b3ca8b7467773ded",494
README . md \n - implementation ' com . google . android : flexbox : 2 . 0 . 0 ' \n + implementation ' com . google . android : flexbox : 2 . 0 . 1 ' \n flexbox \ constants . gradle \n - mavenVersion = ' 2 . 0 . 0 ' \n + mavenVersion = ' 2 . 0 . 1 ' \n,Prepare for 2 . 0 . 1 release ( # 533 ),494
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ agenda \ LoadAgendaUseCase . kt \n - . filter { isInConferenceTime ( it ) } \n + . filter { isInAndPreConferenceTime ( it ) } \n - private fun isInConferenceTime ( block : Block ) : Boolean { \n + private fun isInAndPreConferenceTime ( block : Block ) : Boolean { \n - val start = TimeUtils . ConferenceDays . first ( ) . start . minusHours ( PRE _ BONUS _ HOURS ) \n + val start = \n + / / Start day minus one day to show the day0 badge pick - up time \n + TimeUtils . ConferenceDays . first ( ) . start . minusDays ( 1 ) . minusHours ( PRE _ BONUS _ HOURS ) \n,Fix the issue day0 badge pick - up doesn ' t show up \n Bug : 149575686 \n Change - Id : I852a0ad8cb9e59e76d3c62e0e7229767f41cd195,494
"kokoro \ build . sh \n - echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" build - tools ; 29 . 0 . 2 "" \n + echo "" Installing build - tools . . . "" \n + echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" build - tools ; 29 . 0 . 2 "" > / dev / null \n - echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" ndk ; 20 . 0 . 5594570 "" \n + echo "" Installing NDK that matches the current version of AGP . . . "" \n + echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" ndk ; 20 . 0 . 5594570 "" > / dev / null \n",Suppress the output of installing additional dependencies \n Because it takes majority of the log and make it hard to see it . \n Change - Id : I62c1e53487374fdbafca65a4d11d1c9e4172d3e3,494
". circleci \ config . yml \n - gcloud firebase test android run - - type instrumentation - - app demo - playground / build / outputs / apk / debug / demo - playground - debug . apk - - test flexbox / build / outputs / apk / androidTest / debug / flexbox - debug - androidTest . apk - - device - ids hammerhead , sailfish - - os - version - ids 19 , 21 , 23 , 24 , 25 , 26 - - locales en - - orientations portrait , landscape - - results - bucket $ { GCLOUD _ TEST _ BUCKET _ LIBRARY } - - timeout 180s ; \n + gcloud firebase test android run \ \n + - - type instrumentation \ \n + - - app demo - playground / build / outputs / apk / debug / demo - playground - debug . apk \ \n + - - test flexbox / build / outputs / apk / androidTest / debug / flexbox - debug - androidTest . apk \ \n + - - device - ids hammerhead , sailfish \ \n + - - os - version - ids 19 , 21 , 23 , 24 , 25 , 26 \ \n + - - locales en - - orientations portrait , landscape \ \n + - - results - bucket android - devrel - ci - flexbox \ \n + - - timeout 180s ; \n",Test for enabling CI again ( # 555 ),494
flexbox \ src \ androidTest \ java \ com \ google \ android \ flexbox \ FlexboxHelperTest . kt \n + import androidx . core . widget . CompoundButtonCompat \n - val drawableMinWidth = view1 . buttonDrawable ! ! . minimumWidth \n + val drawableMinWidth = CompoundButtonCompat . getButtonDrawable ( view1 ) ! ! . minimumWidth \n,Change the getButtonDrawable method to use the compat version of its counterpart . ( # 529 ) \n The method doesn ' t exist in API level 21 .,494
"buildSrc \ src \ main \ java \ Libs . kt \n - const val DAGGER _ ANDROID = "" com . google . dagger : dagger - android : "" \n + const val DAGGER _ ANDROID = "" com . google . dagger : dagger - android "" \n",Remove the unneeded trailing colon \n Change - Id : Ibf93ad91d8c82edec3408ec864f9ee1a2d47b11d,494
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionFeedbackFragment . kt \n - viewModel . userSession . observe ( viewLifecycleOwner , Observer { userSession - > \n + viewModel . userSession . observe ( this , Observer { userSession - > \n",Fix the crash in the session feedback dialog \n Bug : 151287941 \n Change - Id : I42ee26ff2d9eca54a4a5167d9c6fa605cb998aaf,494
"core \ api \ system - current . txt \n + field public static final String NAMESPACE _ OTA = "" ota "" ; \n core \ java \ android \ provider \ DeviceConfig . java \n + / * * \n + * Namespace for ota related features . \n + * \n + * @ hide \n + * / \n + @ SystemApi \n + public static final String NAMESPACE _ OTA = "" ota "" ; \n + \n",Add namespace in DeviceConfig to support ota teams ' s features \n One sample usage is to toggle between server based or HAL based \n implementation for resume on reboot . \n Bug : 172780686 \n Test : adb shell device _ config put ota server _ based _ ror _ enabled true； \n Check the value in system server code \n Change - Id : Ia9d3cae788e9316850ce1fc417c12b5fc109b1a3,504
"core \ java \ android \ os \ OWNERS \n - per - file IRecoverySystem . aidl = rvrolyk @ google . com , zhaojiac @ google . com \n - per - file RecoverySystem . java = rvrolyk @ google . com , zhaojiac @ google . com \n + per - file * Recovery * = file : / services / core / java / com / android / server / recoverysystem / OWNERS \n",Update the owner of recovery systems \n Use the same owner file from the services . \n Test : build \n Change - Id : I976c90c2fd16efe20ca3b944c6e45c30550e3226,504
"core \ java \ android \ os \ OWNERS \n + \n + # RecoverySystem \n + per - file IRecoverySystem . aidl = rvrolyk @ google . com , zhaojiac @ google . com \n + per - file RecoverySystem . java = rvrolyk @ google . com , zhaojiac @ google . com \n new file \n services \ core \ java \ com \ android \ server \ recoverysystem \ OWNERS \n + rvrolyk @ google . com \n + zhaojiac @ google . com \n",Add OTA team as the owner of recovery systems \n The RecoverySystem mostly handles OTA update and interactions with \n the recovery mode . Add the ota team as the owner . \n Test : build \n Change - Id : I81bae46d919ea70f04729d34b62d4a569541d914,504
services \ core \ java \ com \ android \ server \ locksettings \ OWNERS \n + rubinxu @ google . com \n,Update the OWNERS file for locksettings \n Add rubinxu @ as the owner of reboot escrow related functionalities . \n Test : build \n Change - Id : Iadafb92c7c43c5002c15e843445931388440e0ba,504
new file \n services \ tests \ servicestests \ src \ com \ android \ server \ recoverysystem \ OWNERS \n + include / services / core / java / com / android / server / recoverysystem / OWNERS \n,Update the owner file for recovery system tests \n The owner file covers unit tests for recovery system . \n Test : build \n Change - Id : Icab312759d376095566077e3dd0fdc878566712b,504
keystore \ java \ android \ security \ keystore2 \ AndroidKeyStoreLoadStoreParameter . java \n - class AndroidKeyStoreLoadStoreParameter implements KeyStore . LoadStoreParameter { \n + public class AndroidKeyStoreLoadStoreParameter implements KeyStore . LoadStoreParameter { \n - AndroidKeyStoreLoadStoreParameter ( int namespace ) { \n + public AndroidKeyStoreLoadStoreParameter ( int namespace ) { \n,Make AndroidKeyStoreLoadStoreParameter public \n So other packages can load the keystore with namespace . \n Test : build \n Change - Id : I7de3e51df438b794adb3793a189396999bdd1b88,504
"services \ core \ java \ com \ android \ server \ recoverysystem \ RecoverySystemService . java \n + import android . util . ArrayMap ; \n + import android . util . ArraySet ; \n - import java . util . HashMap ; \n - import java . util . HashSet ; \n - import java . util . Map ; \n - import java . util . Set ; \n - private final Map < String , IntentSender > mCallerPendingRequest = new HashMap < > ( ) ; \n + private final ArrayMap < String , IntentSender > mCallerPendingRequest = new ArrayMap < > ( ) ; \n - private final Set < String > mCallerPreparedForReboot = new HashSet < > ( ) ; \n + private final ArraySet < String > mCallerPreparedForReboot = new ArraySet < > ( ) ; \n - @ interface ResumeOnRebootActionsOnRequest { } \n + private @ interface ResumeOnRebootActionsOnRequest { } \n - @ interface ResumeOnRebootActionsOnClear { } \n + private @ interface ResumeOnRebootActionsOnClear { } \n - throw new SecurityException ( "" Caller or self must have "" \n - + android . Manifest . permission . RECOVERY + "" or "" \n - + android . Manifest . permission . REBOOT + "" for resume on reboot . "" ) ; \n + throw new SecurityException ( "" Caller must have "" + android . Manifest . permission . RECOVERY \n + + "" or "" + android . Manifest . permission . REBOOT + "" for resume on reboot . "" ) ; \n + if ( mCallerPendingRequest . isEmpty ( ) ) { \n + Slog . w ( TAG , "" onPreparedForReboot called but no client has requested . "" ) ; \n + } \n + \n - for ( Map . Entry < String , IntentSender > entry : mCallerPendingRequest . entrySet ( ) ) { \n - sendPreparedForRebootIntentIfNeeded ( entry . getValue ( ) ) ; \n - mCallerPreparedForReboot . add ( entry . getKey ( ) ) ; \n + for ( int i = 0 ; i < mCallerPendingRequest . size ( ) ; i + + ) { \n + sendPreparedForRebootIntentIfNeeded ( mCallerPendingRequest . valueAt ( i ) ) ; \n + mCallerPreparedForReboot . add ( mCallerPendingRequest . keyAt ( i ) ) ; \n - public synchronized boolean isLskfCaptured ( String packageName ) { \n + public boolean isLskfCaptured ( String packageName ) { \n - if ( ! mCallerPreparedForReboot . contains ( packageName ) ) { \n - Slog . i ( TAG , "" Reboot requested before prepare completed for caller "" + packageName ) ; \n + boolean captured ; \n + synchronized ( this ) { \n + captured = mCallerPreparedForReboot . contains ( packageName ) ; \n + } \n + \n + if ( ! captured ) { \n + Slog . i ( TAG , "" Reboot requested before prepare completed for caller "" \n + + packageName ) ; \n",Clean up the multi - client ror code \n Address some comments on the 1st cl . \n Bug : 170664917 \n Test : aest FrameworksServicesTests : RecoverySystemServiceTest \n Change - Id : I0a509454f5d86a56373f2126d1ef8bdf028cecdb,504
services \ core \ java \ com \ android \ server \ locksettings \ RebootEscrowManager . java \n + \n + / / Clear the old key in keystore . A new key will be generated by new RoR requests . \n + mKeyStoreManager . clearKeyStoreEncryptionKey ( ) ; \n + \n - } finally { \n - / / Clear the old key in keystore . A new key will be generated by new RoR requests . \n - mKeyStoreManager . clearKeyStoreEncryptionKey ( ) ; \n,"Do not remove the k _ k until all users are unlocked \n The key in keystore is used to encrypt the escrow data . We need to \n iterate over all users before deleting it from key store . Otherwise , \n the RoR for the 2nd user will fail . \n Bug : 172780686 \n Test : atest CtsAppSecurityHostTestCases : ResumeOnRebootHostTest # resumeOnReboot _ TwoUsers _ BothUserUnlock _ Success \n Change - Id : I82d94195fe5716d42e363604be5ead3eb3e300fd",504
"services \ core \ java \ com \ android \ server \ locksettings \ RebootEscrowProviderServerBasedImpl . java \n + import android . provider . DeviceConfig ; \n - private static final long SERVICE _ TIME _ OUT _ IN _ SECONDS = 10 ; \n + private static final long DEFAULT _ SERVICE _ TIMEOUT _ IN _ SECONDS = 10 ; \n - private static final long SERVER _ BLOB _ LIFETIME _ IN _ MILLIS = 600 _ 1000 ; \n + private static final long DEFAULT _ SERVER _ BLOB _ LIFETIME _ IN _ MILLIS = 600 _ 1000 ; \n + \n + long getServiceTimeoutInSeconds ( ) { \n + return DeviceConfig . getLong ( DeviceConfig . NAMESPACE _ OTA , \n + "" server _ based _ service _ timeout _ in _ seconds "" , \n + DEFAULT _ SERVICE _ TIMEOUT _ IN _ SECONDS ) ; \n + } \n + \n + long getServerBlobLifetimeInMillis ( ) { \n + return DeviceConfig . getLong ( DeviceConfig . NAMESPACE _ OTA , \n + "" server _ based _ server _ blob _ lifetime _ in _ millis "" , \n + DEFAULT _ SERVER _ BLOB _ LIFETIME _ IN _ MILLIS ) ; \n + } \n - serviceConnection . bindToService ( SERVICE _ TIME _ OUT _ IN _ SECONDS ) ; \n + serviceConnection . bindToService ( mInjector . getServiceTimeoutInSeconds ( ) ) ; \n - SERVICE _ TIME _ OUT _ IN _ SECONDS ) ; \n + mInjector . getServiceTimeoutInSeconds ( ) ) ; \n - serviceConnection . bindToService ( SERVICE _ TIME _ OUT _ IN _ SECONDS ) ; \n + serviceConnection . bindToService ( mInjector . getServiceTimeoutInSeconds ( ) ) ; \n - SERVER _ BLOB _ LIFETIME _ IN _ MILLIS , SERVICE _ TIME _ OUT _ IN _ SECONDS ) ; \n + mInjector . getServerBlobLifetimeInMillis ( ) , mInjector . getServiceTimeoutInSeconds ( ) ) ; \n",Make the service timeout and blob lifetime configurable \n Add two parameter under DeviceConfig to support server - based RoR . \n 1 . server _ based _ service _ timeout _ in _ seconds \n 2 . server _ based _ server _ blob _ lifetime _ in _ millis \n Bug : 172780686 \n Test : treehugger \n Change - Id : I45054e681da348a7b6ac0a9dc3ec9264faa422d5,504
"services \ core \ java \ com \ android \ server \ locksettings \ RebootEscrowManager . java \n - FrameworkStatsLog . write ( FrameworkStatsLog . REBOOT _ ESCROW _ RECOVERY _ REPORTED , success ) ; \n + / / TODO ( b / 179105110 ) design error code ; and report the true value for other fields . \n + FrameworkStatsLog . write ( FrameworkStatsLog . REBOOT _ ESCROW _ RECOVERY _ REPORTED , 0 , 1 , 1 , \n + - 1 , 0 ) ; \n",Make the new RoR atoms compile \n Make the code compile with the new atom definition . The reporting \n of true values will be done in follow up cls . \n Bug : 179105110 \n Test : build \n Change - Id : I65baf117afdd3e80e323b7beac92d408ac440114 \n ( cherry picked from commit 9d4bcd6c3ea7f1b9b6d4d343c8740a88a49e2452 ),504
services \ core \ java \ com \ android \ server \ locksettings \ OWNERS \n + xunchang @ google . com \n,Add xunchang to owner \n For changes about reboot escrow . \n Test : build \n Change - Id : I45542dbb0833437441b55807528f886d817de1aa,504
services \ core \ java \ com \ android \ server \ locksettings \ RebootEscrowProviderServerBasedImpl . java \n - private static final long DEFAULT _ SERVER _ BLOB _ LIFETIME _ IN _ MILLIS = 600 _ 1000 ; \n + private static final long DEFAULT _ SERVER _ BLOB _ LIFETIME _ IN _ MILLIS = 600 _ 000 ; \n,Fix a typo for the server blob timeout \n Suppose to be 600s instead of 6001s . \n Test : build \n Change - Id : I3dde6ad5cc63b080054c7eb61a8c45401bb72346,504
services \ core \ java \ com \ android \ server \ locksettings \ ResumeOnRebootServiceProvider . java \n + mBinder = null ; \n,"Reset binder during unbinding \n On some rare case , we may encounter a DeadObjectException on wrap ( ) \n when a new test app is installed . This happens because we reuse the \n binder from the previous bindToService ( ) call . Always reset the \n binder to make sure this doesn ' t happen . \n Bug : 172780686 \n Test : run storeRebootEscrowKey twice \n Change - Id : I36150ef39f870e38a5f1b4bd814465d70f8dbf85",504
"services \ core \ java \ com \ android \ server \ locksettings \ LockSettingsShellCommand . java \n + pw . println ( "" "" ) ; \n + "" provider . "" ) ; \n",Fix format of helper msg \n Test : TH \n Change - Id : I19ecbe0605418485ab1f444dd4508d7755520648,504
"core \ java \ android \ os \ RecoverySystem . java \n + import android . app . KeyguardManager ; \n - * and ready to apply the OTA . This API is expected to handle requests from multiple clients \n - * simultaneously , e . g . from ota and mainline . \n + * and ready to apply the OTA . < p > \n - * < p > The behavior of multi - client Resume on Reboot works as follows \n + * < p > If the device doesn ' t setup a lock screen , i . e . by checking \n + * { @ link KeyguardManager # isKeyguardSecure ( ) } , this API call will fail and throw an exception . \n + * Callers are expected to use { @ link PowerManager # reboot ( String ) } directly without going \n + * through the RoR flow . < p > \n + * \n + * < p > This API is expected to handle requests from multiple clients simultaneously , e . g . \n + * from ota and mainline . The behavior of multi - client Resume on Reboot works as follows \n + \n + KeyguardManager keyguardManager = context . getSystemService ( KeyguardManager . class ) ; \n + if ( keyguardManager = = null | | ! keyguardManager . isDeviceSecure ( ) ) { \n + throw new IOException ( "" Failed to request LSKF because the device doesn ' t have a "" \n + + "" lock screen . "" ) ; \n + } \n + \n","Throw an exception in RoR api on no - pin case \n If the device doesn ' t have a pin , the current RoR preparation will \n go through ; but the lskf capture event won ' t happen . In order not \n to confuse the caller , throw an exception instead in the no - pin \n case . \n Bug : 170664917 \n Test : remove pin , request RoR with adb shell \n Change - Id : Ib04c629234b71e3f6cb36bdfe47759a715a69146",504
build . gradle \n - kotlinVersion = ' 1 . 2 . 21 ' \n + kotlinVersion = ' 1 . 2 . 30 ' \n,Update Kotlin from 1 . 2 . 21 to 1 . 2 . 30 . \n Bug : 72096328 \n Test : Kokoro \n Change - Id : I9ccc63ee220f3960c60ce9284f0e9897e4a9d3ce,506
"build . gradle \n - ext . kotlin _ version = ' 1 . 1 . 51 ' \n + ext { \n + / / SDK and tools \n + compileSdkVersion = 27 \n + minSdkVersion = 15 \n + targetSdkVersion = 27 \n + \n + / / App dependencies \n + constraintLayoutVersion = ' 1 . 0 . 2 ' \n + espressoVersion = ' 3 . 0 . 1 ' \n + gradleVersion = ' 3 . 0 . 1 ' \n + junitVersion = ' 4 . 12 ' \n + kotlinVersion = ' 1 . 2 . 10 ' \n + runnerVersion = ' 1 . 0 . 1 ' \n + supportLibraryVersion = ' 27 . 0 . 2 ' \n + } \n - classpath ' com . android . tools . build : gradle : 3 . 0 . 1 ' \n - classpath "" org . jetbrains . kotlin : kotlin - gradle - plugin : $ kotlin _ version "" \n + classpath "" com . android . tools . build : gradle : $ gradleVersion "" \n + classpath "" org . jetbrains . kotlin : kotlin - gradle - plugin : $ kotlinVersion "" \n mobile \ build . gradle \n - compileSdkVersion 26 \n + compileSdkVersion rootProject . compileSdkVersion \n - minSdkVersion 15 \n - targetSdkVersion 26 \n + minSdkVersion rootProject . minSdkVersion \n + targetSdkVersion rootProject . targetSdkVersion \n - implementation "" org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ kotlin _ version "" \n - implementation ' com . android . support : appcompat - v7 : 26 . 1 . 0 ' \n - implementation ' com . android . support . constraint : constraint - layout : 1 . 0 . 2 ' \n - testImplementation ' junit : junit : 4 . 12 ' \n - androidTestImplementation ' com . android . support . test : runner : 1 . 0 . 1 ' \n - androidTestImplementation ' com . android . support . test . espresso : espresso - core : 3 . 0 . 1 ' \n + implementation "" com . android . support : appcompat - v7 : $ rootProject . supportLibraryVersion "" \n + implementation "" com . android . support . constraint : constraint - layout : $ rootProject . constraintLayoutVersion "" \n + implementation "" org . jetbrains . kotlin : kotlin - stdlib - jre7 : $ rootProject . kotlinVersion "" \n + \n + androidTestImplementation "" com . android . support . test . espresso : espresso - core : $ rootProject . espressoVersion "" \n + androidTestImplementation "" com . android . support . test : runner : $ rootProject . runnerVersion "" \n + testImplementation "" junit : junit : $ rootProject . junitVersion "" \n",Update library versions and reorganize Gradle files \n Bug : 71910463 \n Change - Id : Ibe22689d959332696dfcdc41230feda8e205abc4,506
build . gradle \n - kotlinVersion = ' 1 . 2 . 10 ' \n + kotlinVersion = ' 1 . 2 . 20 ' \n,Update Kotlin to 1 . 2 . 20 . \n Bug : 72096328 \n Test : Manual \n Change - Id : I10d6e8fcc534af08486cea608d46ed88f09fadc7,506
build . gradle \n + archLifecycleVersion = ' 1 . 1 . 0 ' \n + dataBindingCompilerVersion = ' 3 . 0 . 1 ' \n + designLibraryVersion = ' 27 . 0 . 2 ' \n - kotlinVersion = ' 1 . 2 . 20 ' \n + kotlinVersion = ' 1 . 2 . 21 ' \n - designLibraryVersion = ' 27 . 0 . 2 ' \n - archLifecycleVersion = ' 1 . 0 . 0 ' \n - dataBindingCompilerVersion = ' 3 . 0 . 1 ' \n,Update dependencies and alphabetize variables \n Bug : 72096328 \n Test : N / A \n Change - Id : I589996bd3adf5b9898b31eff60d5aa525669067c,506
". idea \ copyright \ iosched . xml \n - < option name = "" notice "" value = "" Copyright 2018 Google LLC & # 10 ; & # 10 ; Licensed under the Apache License , Version 2 . 0 ( the & quot ; License & quot ; ) ; & # 10 ; you may not use this file except in compliance with the License . & # 10 ; You may obtain a copy of the License at & # 10 ; & # 10 ; https : / / www . apache . org / licenses / LICENSE - 2 . 0 & # 10 ; & # 10 ; Unless required by applicable law or agreed to in writing , software & # 10 ; distributed under the License is distributed on an & quot ; AS IS & quot ; BASIS , & # 10 ; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . & # 10 ; See the License for the specific language governing permissions and & # 10 ; limitations under the License . "" / > \n + < option name = "" notice "" value = "" Copyright & amp ; # 36 ; today . year Google LLC & # 10 ; & # 10 ; Licensed under the Apache License , Version 2 . 0 ( the & quot ; License & quot ; ) ; & # 10 ; you may not use this file except in compliance with the License . & # 10 ; You may obtain a copy of the License at & # 10 ; & # 10 ; https : / / www . apache . org / licenses / LICENSE - 2 . 0 & # 10 ; & # 10 ; Unless required by applicable law or agreed to in writing , software & # 10 ; distributed under the License is distributed on an & quot ; AS IS & quot ; BASIS , & # 10 ; WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . & # 10 ; See the License for the specific language governing permissions and & # 10 ; limitations under the License . "" / > \n build . gradle \n - minSdkVersion = 15 \n + minSdkVersion = 21 \n","Update copyright template , bump minSdk to 21 \n Bug : 72320343 , 72096328 \n Change - Id : Id2d0880b7e9f1400b1b45f8cfd1000b56b6b14d0",506
build . gradle \n - gradleVersion = ' 3 . 1 . 0 - alpha09 ' \n + gradleVersion = ' 3 . 1 . 0 - beta1 ' \n,Bump gradle to 3 . 1 - beta1 \n Change - Id : I39019ffca88118aa5a068dc36d000f1d7fc948ad,506
"core \ src \ androidTest \ java \ io \ plaidapp \ core \ data \ LoggedInUserDaoTest . kt \n - \n + private lateinit var loggedInUser : LoggedInUser \n - @ Before fun createDb ( ) { \n + @ Before fun setup ( ) { \n + loggedInUser = LoggedInUser ( \n + id = 1L , \n + displayName = "" Loggy L "" , \n + firstName = "" Loggy "" , \n + lastName = "" Loggerson "" , \n + portraitUrl = "" www "" \n + ) \n - @ After fun closeDb ( ) { \n + @ After fun tearDown ( ) { \n - val user = LoggedInUser ( \n - id = 1L , \n - displayName = "" Loggy L "" , \n - firstName = "" Loggy "" , \n - lastName = "" Loggerson "" , \n - portraitUrl = "" www "" ) \n - loggedInUserDao . insertLoggedInUser ( user ) \n + / / Given a LoggedInUser that has been inserted into the DB \n + loggedInUserDao . insertLoggedInUser ( loggedInUser ) \n + / / When getting the LoggedInUser via the DAO \n - assertEquals ( user , userFromDb ) \n + \n + / / Then the retrieved LoggedInUser matches the original LoggedInUser object \n + assertEquals ( loggedInUser , userFromDb ) \n - val user = LoggedInUser ( \n - id = 1L , \n - displayName = "" Loggy L "" , \n - firstName = "" Loggy "" , \n - lastName = "" Loggerson "" , \n - portraitUrl = "" www "" ) \n - loggedInUserDao . insertLoggedInUser ( user ) \n + / / Given a LoggedInUser that has been inserted into the DB \n + loggedInUserDao . insertLoggedInUser ( loggedInUser ) \n - val updatedUser = user . copy ( displayName = "" LL Cool L "" ) \n + / / When the user ' s information changes and a subsequent insert is triggered \n + val updatedUser = loggedInUser . copy ( displayName = "" LL Cool L "" ) \n + / / Then a subsequent query for the LoggedInUser should show the updated information \n",Address code review comments \n - Move loggedInUser to a member \n - Add Given / When / Then descriptions for tests,506
build . gradle \n - supportLibraryVersion = ' 27 . 0 . 2 ' \n - designLibraryVersion = ' 27 . 0 . 2 ' \n + supportLibraryVersion = ' 27 . 1 . 0 ' \n + designLibraryVersion = ' 27 . 1 . 0 ' \n,Support library 27 . 1 . 0 \n Bug : 72096328 \n Test : Kokoro \n Change - Id : Ib31b44ba2545cc1b20136bf8a06b5d91c03e73ac,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailFragment . kt \n - import android . support . v7 . app . AppCompatActivity \n - import android . view . Menu \n - import android . view . MenuInflater \n - import android . view . MenuItem \n + sessionDetailToolbar . inflateMenu ( R . menu . session _ detail _ menu ) \n + sessionDetailToolbar . setOnMenuItemClickListener { item - > \n + if ( item . itemId = = R . id . menu _ item _ share ) { \n + ShareCompat . IntentBuilder . from ( activity ) \n + . setType ( "" text / plain "" ) \n + . setText ( shareString ) \n + . setChooserTitle ( R . string . intent _ chooser _ session _ detail ) \n + . startChooser ( ) \n + } \n + true \n + } \n - / / TODO : replace with Toolbar ( b / 73537084 ) \n - ( activity as AppCompatActivity ) . setSupportActionBar ( binding . sessionDetailToolbar ) \n - \n - override fun onCreateOptionsMenu ( menu : Menu ? , inflater : MenuInflater ) { \n - super . onCreateOptionsMenu ( menu , inflater ) \n - inflater . inflate ( R . menu . session _ detail _ menu , menu ) \n - } \n - \n - override fun onOptionsItemSelected ( item : MenuItem ) : Boolean { \n - return when ( item . itemId ) { \n - R . id . menu _ item _ share - > { \n - ShareCompat . IntentBuilder . from ( activity ) \n - . setType ( "" text / plain "" ) \n - . setText ( shareString ) \n - . setChooserTitle ( R . string . intent _ chooser _ session _ detail ) \n - . startChooser ( ) \n - true \n - } \n - else - > super . onOptionsItemSelected ( item ) \n - } \n - } \n - \n mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n + app : title = "" @ { viewModel . session . title } "" \n",Use Toolbar instead of support action bar . \n Bug : 72096328 \n Test : Kokoro and manual \n Change - Id : I46d8c34265adb023e217bf1a510ff53acf7cab32,506
"mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n - app : sessionTags = "" @ { viewModel . session . tags } "" / > \n + app : sessionTags = "" @ { viewModel . session . displayTags } "" / > \n",Only show track tags on session detail screen \n Bug : 76227265 \n Test : Manual + Kokoro \n Change - Id : I68d1341f6baa46be1254dbccd912162796eb5dfd,506
build . gradle \n - androidGradlePluginVersion = ' 3 . 1 . 0 - rc03 ' \n + androidGradlePluginVersion = ' 3 . 1 . 0 ' \n - kotlinVersion = ' 1 . 2 . 30 ' \n + kotlinVersion = ' 1 . 2 . 31 ' \n,Update Gradle and Kotlin versions \n Bug : 72096328 \n Test : Kokoro \n Change - Id : I5fa8f5b66bc4d12f1d9e25a81169abbd16d29d47,506
"mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n + android : scaleType = "" centerCrop "" \n",Add centerCrop scale type to Session Detail header image \n Addresses 2 bugs : \n - Gray background bars appear around Session Detail header image if \n session has video \n - Update design of header image on Session Detail page for landscape \n view \n This might not be the final design but at least it avoids showing gray \n bars for the header image . \n Bug : 76223349 \n Bug : 76181958 \n Test : Manual + Kokoro \n Change - Id : I04adaebd5b685a84237ae4e86a0360b3656cf121,506
build . gradle \n + mavenCentral ( ) \n + mavenCentral ( ) \n,Add mavenCentral to gradle file . \n This should help us out while jcenter is having issues . \n Opened b / 77219987 to remove before launch . \n Test : kokoro \n Change - Id : Ic847208c19d05e94721538cb2dcea6e450f804bf,506
app \ build . gradle \n - versionName = ' 1 . 0 . 4 ' \n + versionName = ' 1 . 0 . 5 ' \n,Bump versionName to 1 . 0 . 5 for release .,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailFragment . kt \n - / / todo setup menu & fab based on attendee \n mobile \ src \ main \ res \ menu \ session _ detail _ menu . xml \n - - > \n - xmlns : android = "" http : / / schemas . android . com / apk / res / android "" > \n + xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n + tools : ignore = "" AlwaysShowAction "" > \n + < ! - - TODO re - show map button . Temporarily hiding while b / 78025651 is in progress \n + - - > \n",Temporarily hide map icon on session detail screen . \n Will resurface once b / 78025651 is fixed . \n Also remove outdated todo comment and suppress warning . \n Bug : 78025651 \n Test : kokoro \n Change - Id : I8f8c7e342c92e89c17658d8131e53ac4220c5688,506
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailViewModel . kt \n - currentState = = TimeUtils . SessionRelativeTimeState . AFTER \n + / / TODO : uncomment when rate session logic is hooked up \n + / / currentState = = TimeUtils . SessionRelativeTimeState . AFTER \n + false \n,Always hide rate session button \n Bug : 78230966 \n Test : kokoro \n Change - Id : Iaa2c628a53a557dccda70b3c3d4792b028a1a08b,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ info \ AboutFragment . kt \n + import android . app . AlertDialog \n + import android . webkit . WebView \n + import com . google . samples . apps . iosched . R \n + @ BindingAdapter ( value = [ "" dialogTitle "" , "" fileLink "" ] , requireAll = true ) \n + fun createDialogForFile ( button : Button , dialogTitle : String , fileLink : String ) { \n + val context = button . context \n + button . setOnClickListener { \n + val webView = WebView ( context ) . apply { loadUrl ( fileLink ) } \n + AlertDialog . Builder ( context ) \n + . setTitle ( dialogTitle ) \n + . setView ( webView ) \n + . create ( ) \n + . show ( ) \n + } \n + } \n + \n mobile \ src \ main \ res \ layout \ fragment _ info _ about . xml \n - app : websiteLink = "" @ { @ string / oss _ url } "" \n + app : dialogTitle = "" @ { @ string / settings _ oss _ licenses } "" \n + app : fileLink = "" @ { @ string / oss _ file } "" \n mobile \ src \ main \ res \ values \ strings . xml \n - < ! - - TODO : verify this is correct OSS url - - > \n - < string name = "" oss _ url "" translatable = "" false "" > https : / / github . com / google / iosched # copyright < / string > \n + < string name = "" oss _ file "" translatable = "" false "" > file : / / / android _ asset / licenses . html < / string > \n",Display OSS licence file html asset \n Bug : 77866808 \n Test : kokoro \n Change - Id : I0f865d18e29097eb20757deba0ef3f56eeb5c3cc,506
"mobile \ src \ main \ res \ values \ styles . xml \n + < item name = "" android : fontFamily "" > @ font / google _ sans < / item > \n + < item name = "" android : textAllCaps "" > false < / item > \n",Change link text styling on Info - > About screen \n Based on Material Launch Review \n - Use Google Sans \n - Use sentence case \n Bug : 77879200 \n Test : kokoro \n Change - Id : I7e5344b89d101b4e664fbd3fb8c60a64ba0b7316,506
"mobile \ src \ main \ res \ layout \ dialog _ schedule _ hints . xml \n - app : layout _ constraintTop _ toBottomOf = "" @ + id / schedule _ hint _ title "" / > \n + app : layout _ constraintTop _ toBottomOf = "" @ + id / schedule _ hint _ title "" \n + app : layout _ constrainedWidth = "" true "" / > \n - app : layout _ constraintTop _ toBottomOf = "" @ + id / schedule _ hint _ textview _ star _ event "" / > \n + app : layout _ constraintTop _ toBottomOf = "" @ + id / schedule _ hint _ textview _ star _ event "" \n + app : layout _ constrainedWidth = "" true "" / > \n",Wrap text on tutorial screen . \n Bug : 78627690 \n Test : kokoro \n Change - Id : Idb4a6473e3bcb89a0b2d550d18530db0abb3f3a4,506
"mobile \ src \ main \ res \ raw \ map _ markers . json \n - "" title "" : "" ADA Parking "" , \n + "" title "" : "" Accessible Parking "" , \n - "" description "" : "" When arriving to the venue , please follow signs for ADA parking and have your placard hanging from the car mirror and visible to parking employees at all times to expedite the parking process . Accessible parking spaces are readily available on a first - come , first - served basis and may not be reserved in advance to fairly serve all attendees . "" , \n + "" description "" : "" When arriving to the venue , please follow signs for Accessible parking and have your placard hanging from the car mirror and visible to parking employees at all times to expedite the parking process . Accessible parking spaces are readily available on a first - come , first - served basis and may not be reserved in advance to fairly serve all attendees . "" , \n mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" travel _ shuttle _ description "" translation _ description = "" Shuttle service instructions . "" > Event shuttles will be provided at no charge to all Google I / O attendees from all Google - recommended hotels . There is also select service from San Francisco and other locations along the Peninsula . You must show your Google I / O confirmation email or conference badge to board all Google I / O event shuttles . \ n \ nEach pick - up location can have ADA accessible vehicles . Please indicate on your registration form if you have any ADA or special assistance requirements , and the planning team will follow up with you directly . < / string > \n + < string name = "" travel _ shuttle _ description "" translation _ description = "" Shuttle service instructions . "" > Event shuttles will be provided at no charge to all Google I / O attendees from all Google - recommended hotels . There is also select service from San Francisco and other locations along the Peninsula . You must show your Google I / O confirmation email or conference badge to board all Google I / O event shuttles . \ n \ nEach pick - up location can support accessible vehicles . Please indicate on your registration form if you have any special assistance requirements , and the planning team will follow up with you directly . < / string > \n",Update text : ADA to Accessible \n Bug : 78902345 \n Test : kokoro \n Change - Id : I18f6b1d97df4928566eb1c622ee6cc76182ef73f,506
gradle . properties \n - conference _ day1 _ end = 2018 - 05 - 08T22 : 00 : 00 - 07 : 00 \n + conference _ day1 _ end = 2018 - 05 - 08T22 : 00 : 01 - 07 : 00 \n - conference _ day2 _ end = 2018 - 05 - 09T22 : 00 : 00 - 07 : 00 \n + conference _ day2 _ end = 2018 - 05 - 09T22 : 00 : 01 - 07 : 00 \n,Adjust static values for day 1 and 2 end times \n Bug : 79292225 \n Test : kokoro \n Change - Id : I5d4fdf2bba9e1c882b64ed4d6c6fd5f454de79fd,506
"mobile \ src \ main \ res \ layout \ fragment _ info _ event . xml \n + android : gravity = "" center _ vertical "" \n + android : minHeight = "" @ dimen / a11y _ min _ touch _ target "" \n + android : gravity = "" center _ vertical "" \n + android : minHeight = "" @ dimen / a11y _ min _ touch _ target "" \n",Increase height of Wifi password TextView \n Bug : 79113924 \n Test : kokoro \n Change - Id : Ieed8739b02b622132733631656f3d9967ae4e543,506
build . gradle \n - androidGradlePluginVersion = ' 3 . 2 . 0 - alpha15 ' \n + androidGradlePluginVersion = ' 3 . 2 . 0 - alpha16 ' \n,Bump AGP to 3 . 2 . 0 - alpha16 . \n Test : kokoro \n Change - Id : I087542cf375387857bac183c88d9a04675b548a6,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailViewModel . kt \n + / / TODO : write tests b / 74611561 \n - loadSessionUseCase ( sessionId , useCaseResult ) \n + session . value ? : loadSessionUseCase ( sessionId , useCaseResult ) \n",Fix reloading bug on session details page \n Bug : 73963235 \n Test : Manual + Kokoro \n Change - Id : Iae1ac66afceb383401ea07f8c05ef1c0a75f274d,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailDataBindingAdapters . kt \n - @ BindingAdapter ( value = [ "" startTime "" , "" endTime "" ] , requireAll = true ) \n - fun timeString ( view : TextView , startTime : ZonedDateTime ? , endTime : ZonedDateTime ? ) { \n - if ( startTime = = null | | endTime = = null ) { \n + @ BindingAdapter ( value = [ "" sessionDetailStartTime "" , "" sessionDetailEndTime "" ] , requireAll = true ) \n + fun timeString ( \n + view : TextView , \n + sessionDetailStartTime : ZonedDateTime ? , \n + sessionDetailEndTime : ZonedDateTime ? \n + ) { \n + if ( sessionDetailStartTime = = null | | sessionDetailEndTime = = null ) { \n - view . text = TimeUtils . timeString ( startTime , endTime ) \n + view . text = TimeUtils . timeString ( sessionDetailStartTime , sessionDetailEndTime ) \n mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n - app : startTime = "" @ { viewModel . session . startTime } "" \n - app : endTime = "" @ { viewModel . session . endTime } "" \n + app : sessionDetailStartTime = "" @ { viewModel . session . startTime } "" \n + app : sessionDetailEndTime = "" @ { viewModel . session . endTime } "" \n","Fix crash in Session Details screen \n There was an overlap in binding adapter naming of ` startTime ` and \n ` endTime ` , causing the Session Details fragment to select the incorrect \n one and crash . This change updates the binding names on the Session \n Details fragment . \n Test : Manual + Kokoro \n Change - Id : Ia729d47eac739dcf9edc57c02f98e08529bb0921",506
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ sessions \ LoadSessionUseCase . kt \n - / * * \n - * TODO : Example use case that simulates a delay . \n - * / \n - Thread . sleep ( 1000 ) \n,Remove delay in LoadSessionUseCase \n Design for Session Detail screen when data is not loaded to be \n addressed in b / 74272286 . \n Test : Manual + Kokoro \n Change - Id : Ib5ddb00e255e6bf2ac6882ca5f2244157a7d136a,506
"app \ build . gradle \n - minSdkVersion 21 \n + minSdkVersion 23 \n - } \n + } \n features \ activities \ build . gradle \n - minSdkVersion 21 \n + minSdkVersion 23 \n - \n - lintOptions { \n - abortOnError false \n - } \n features \ activities \ src \ main \ res \ values \ styles . xml \n - < item name = "" android : statusBarColor "" > @ android : color / transparent < / item > \n - < item name = "" android : navigationBarColor "" > @ android : color / transparent < / item > \n",Turn on lint and fix issues with features,506
third _ party \ bypass \ build . gradle \n - minSdkVersion 8 \n + minSdkVersion 23 \n - \n - lintOptions { \n - abortOnError false \n - } \n,Turn on lint and bump minSdk for third _ party,506
"app \ build . gradle \n - \n - lintOptions { \n - abortOnError false \n - } \n app \ src \ main \ res \ menu \ main . xml \n - - > \n - < menu xmlns : android = "" http : / / schemas . android . com / apk / res / android "" > \n + < menu xmlns : app = "" http : / / schemas . android . com / apk / res - auto "" \n + xmlns : android = "" http : / / schemas . android . com / apk / res / android "" > \n - android : showAsAction = "" always "" / > \n + app : showAsAction = "" always "" / > \n - android : showAsAction = "" always "" / > \n + app : showAsAction = "" always "" / > \n - android : showAsAction = "" never "" / > \n + app : showAsAction = "" never "" / > \n - android : showAsAction = "" never "" / > \n + app : showAsAction = "" never "" / > \n - android : showAsAction = "" never "" / > \n + app : showAsAction = "" never "" / > \n",Turn on lint checks for app and fix errors,506
"app \ src \ main \ res \ values - w600dp \ dimens . xml \n - - > \n - < resources > \n + < resources xmlns : tools = "" http : / / schemas . android . com / tools "" > \n - < dimen name = "" designer _ news _ story _ title _ height "" > 112dp < / dimen > < ! - - extended _ height _ toolbar - actionBarSize - - > \n - < dimen name = "" designer _ news _ story _ comments _ max _ width "" > 504dp < / dimen > < ! - - constrain text width ( in increments of 56dp ) - - > \n + < dimen name = "" designer _ news _ story _ title _ height "" tools : ignore = "" MissingDefaultResource "" > 112dp < / dimen > < ! - - extended _ height _ toolbar - actionBarSize - - > \n + < dimen name = "" designer _ news _ story _ comments _ max _ width "" tools : ignore = "" MissingDefaultResource "" > 504dp < / dimen > < ! - - constrain text width ( in increments of 56dp ) - - > \n",Ignore warning for default resource \n The dimensions are only used in a - w600dp layout .,506
". circleci \ config . yml \n - run : \n + - run : \n + name : Gather Lint results \n + command : ci _ scripts / copy _ lint _ results . sh \n - store _ artifacts : \n - path : app / build / reports \n - destination : reports \n + path : ci _ results / lint \n - store _ test _ results : \n - path : app / build / test - results \n + path : ci _ results / lint \n new file \n ci _ scripts \ copy _ lint _ results . sh \n + # ! / bin / sh \n + \n + RESULTS _ DIR = "" ci _ results / lint / "" \n + mkdir - p $ RESULTS _ DIR \n + \n + # Find all lint result files , except ones for third party libraries \n + LINT _ FILES = ` find . - type f - regex "" . * / build / reports / lint - results \ . . * "" | grep - v third _ party ` \n + \n + # Rename each file . Example : \n + \n + for file in $ LINT _ FILES \n + do \n + rename ' s / \ / ( . * ) \ / build \ / reports \ / lint - results / \ / $ 1 \ / build \ / reports \ / lint - results - $ 1 / ' $ file \n + done \n + \n + # Move all of the renamed files to the $ RESULTS _ DIR \n + find . - type f - regex "" . * / build / reports / lint - results - . * \ . . * "" - exec cp { } $ RESULTS _ DIR \ ; \n",Update CI to gather and store lint results,506
build . gradle \n - ' ktlint ' : ' 0 . 19 . 0 ' \n + ' ktlint ' : ' 0 . 24 . 0 ' \n,Update ktlin to 0 . 24 . 0,506
README . md \n + # # # Android Studio IDE setup \n + \n + Plaid uses [ ktlint ] ( https : / / ktlint . github . io / ) to enforce Kotlin coding styles . \n + Here ' s how to configure it for use with Android Studio ( instructions adapted \n + from the ktlint [ README ] ( https : / / github . com / shyiko / ktlint / blob / master / README . md ) ) : \n + \n + - Close Android Studio if it ' s open \n + - Download ktlint \n + ` curl - sSLO https : / / github . com / shyiko / ktlint / releases / download / 0 . 24 . 0 / ktlint & & chmod a + x ktlint ` \n + - Inside the project root directory run : \n + ` ktlint - - apply - to - idea - project - - android ` \n + - Remove ktlint if desired \n + ` rm ktlint ` \n + - Start Android Studio \n + \n - - - \n,Add instructions to configure Android Studio with ktlint,506
"build . gradle \n - ' kotlin ' : ' 1 . 2 . 41 ' , \n + ' kotlin ' : ' 1 . 2 . 50 ' , \n",Update Kotlin to 1 . 2 . 50,506
"rename from core \ src \ androidTest \ java \ io \ plaidapp \ core \ data \ LoggedInUserDaoTest . kt \n rename to core \ src \ androidTest \ java \ io \ plaidapp \ core \ designernews \ data \ LoggedInUserDaoTest . kt \n - package io . plaidapp . core . data \n + package io . plaidapp . core . designernews . data \n + import io . plaidapp . core . data . AppDatabase \n core \ src \ main \ java \ io \ plaidapp \ core \ data \ AppDatabase . kt \n + import io . plaidapp . core . designernews . data . LoggedInUserDao \n rename from core \ src \ main \ java \ io \ plaidapp \ core \ data \ LoggedInUserDao . kt \n rename to core \ src \ main \ java \ io \ plaidapp \ core \ designernews \ data \ LoggedInUserDao . kt \n - package io . plaidapp . core . data \n + package io . plaidapp . core . designernews . data \n + / * * \n + * This method should not be used . Instead , use [ setLoggedInUser ] , \n + * as that method guarantees only a single [ LoggedInUser ] will reside \n + * in the table . \n + * / \n",Move LoggedInUserDao and associated test to DesignerNews . \n Also add comment to encourage use of setLoggedInUser over \n insertLoggedInUser .,506
"scripts \ ftl _ run _ tests . sh \n - gsutil - m cp - r - U "" gs : / / TODO - PROJECT - ID / $ RESULTS _ DIR / * "" "" $ TEST _ DIR / $ RESULTS _ DIR "" \n + gsutil - m cp - r - U "" gs : / / android - devrel - ci / $ RESULTS _ DIR / * "" "" $ TEST _ DIR / $ RESULTS _ DIR "" \n scripts \ ftl _ setup . sh \n - gcloud config set project TODO - PROJECT - ID \n + gcloud config set project android - devrel - ci \n - gcloud auth activate - service - account TODO - SERVICE - ACCT - ID - - key - file client _ secret . json \n + gcloud auth activate - service - account plaid - ftl @ android - devrel - ci . iam . gserviceaccount . com - - key - file client _ secret . json \n",Add gcloud project ID and service account to FTL scripts,506
. circleci \ config . yml \n - image : circleci / android : api - 28 - alpha \n + working _ directory : ~ / plaid \n - image : google / cloud - sdk : latest \n + working _ directory : ~ / plaid \n + - checkout \n + - attach _ workspace : \n + at : ~ / plaid \n - run : \n,Update Circle CI config with explicit working directory,506
"scripts \ ftl _ run _ tests . sh \n - - device model = Nexus6P , version = 27 , locale = en _ US , orientation = portrait \ \n - - timeout 30m \ \n - - results - bucket cloud - test - android - devrel - ci \ \n - - - results - dir = $ RESULTS _ DIR \ \n - - - no - record - video \ \n - - - no - performance - metrics \n + - - results - dir = $ RESULTS _ DIR \n - "" app / build / outputs / apk / androidTest / debug / core - debug - androidTest . apk "" \n + "" app / build / outputs / apk / androidTest / debug / plaid - debug - androidTest . apk "" \n",Back to testing plaid instead of core apk . Enable video and perf metrics,506
"scripts \ ftl _ setup . sh \n + # Check if this script is running on the main , non - forked repository . \n + # Environment variables are not set in forked repository builds ; \n + # skip Firebase Test Lab steps in this case . \n + if [ - z "" $ IS _ MAIN _ PLAID _ REPO "" ] ; then \n + echo "" Running build on a forked repository - skipping FTL tests . "" \n + # exit 0 \n + fi \n + \n","Check if running build in a forked repo . \n This commit purposely omits the ` exit 0 ` as to trigger an error on \n a forked build . A subsequent commit will add it back , which should \n cause the forked build to not error .",506
. gitignore \n + google - services . json \n,Add google - services . json to gitignore,506
"scripts \ ftl _ setup . sh \n - # skip Firebase Test Lab steps in this case . \n + # in this case , skip Firebase Test Lab steps and finish the build . \n + circleci step halt \n",Skip rest of build if running on a forked repo,506
"scripts \ ftl _ run _ tests . sh \n + # Store the exit code from running the gcloud command . This is returned at the end of the script \n + GCLOUD _ EXIT _ CODE = 0 \n + \n - RESULTS _ DIR = $ 1 _ $ BUILD _ ID \n + RESULTS _ DIR = $ 1 _ $ BUILD _ ID \n - - - type instrumentation \ \n - - - app $ 2 \ \n - - - test $ 3 \ \n - - - device model = Pixel2 , version = 28 , locale = en _ US , orientation = portrait \ \n - - - timeout 30m \ \n - - - results - bucket cloud - test - android - devrel - ci \ \n - - - results - dir = $ RESULTS _ DIR \n + - - type instrumentation \ \n + - - app $ 2 \ \n + - - test $ 3 \ \n + - - device model = Pixel2 , version = 28 , locale = en _ US , orientation = portrait \ \n + - - timeout 30m \ \n + - - results - bucket cloud - test - android - devrel - ci \ \n + - - results - dir = $ RESULTS _ DIR \n + \n + # Capture the exit code of the gcloud command \n + # TODO : change this logic if running multiple gcloud commands , otherwise only the last gcloud ' s exit code is stored \n + GCLOUD _ EXIT _ CODE = $ ? \n - # Pull down test results \n - gsutil - m cp - r - U "" gs : / / cloud - test - android - devrel - ci / $ RESULTS _ DIR / * "" "" $ TEST _ DIR / $ RESULTS _ DIR "" \n + # Pull down test results \n + gsutil - m cp - r - U "" gs : / / cloud - test - android - devrel - ci / $ RESULTS _ DIR / * "" "" $ TEST _ DIR / $ RESULTS _ DIR "" \n - "" app "" \ \n - "" app / build / outputs / apk / debug / plaid - debug . apk "" \ \n - "" core / build / outputs / apk / androidTest / debug / core - debug - androidTest . apk "" \n + "" app "" \ \n + "" app / build / outputs / apk / debug / plaid - debug . apk "" \ \n + "" core / build / outputs / apk / androidTest / debug / core - debug - androidTest . apk "" \n + \n + exit "" $ GCLOUD _ EXIT _ CODE "" \n",Store gcloud error code and surface it later,506
"core \ src \ androidTest \ java \ io \ plaidapp \ core \ designernews \ data \ LoggedInUserDaoTest . kt \n - portraitUrl = "" www "" \n + portraitUrl = "" www "" , \n + upvotes = listOf ( "" 1 "" , "" 2 "" , "" 3 "" ) \n - portraitUrl = "" www "" \n + portraitUrl = "" www "" , \n + upvotes = listOf ( "" 4 "" , "" 5 "" , "" 6 "" ) \n core \ src \ main \ java \ io \ plaidapp \ core \ data \ AppDatabase . kt \n + import android . arch . persistence . room . TypeConverters \n + @ TypeConverters ( Converters : : class ) \n core \ src \ main \ java \ io \ plaidapp \ core \ designernews \ data \ users \ model \ LoggedInUser . kt \n - val portraitUrl : String ? = null \n + val portraitUrl : String ? = null , \n + \n + @ ColumnInfo ( name = "" upvotes "" ) \n + @ SerializedName ( "" upvotes "" ) \n + val upvotes : List < String > \n",Add upvotes property to LoggedInUser \n Requires adding @ TypeConverters annotation to AppDatabase .,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ util \ ViewBindingAdapters . kt \n - @ BindingAdapter ( value = [ "" imageUrl "" , "" placeholder "" ] , requireAll = false ) \n - fun imageUrl ( imageView : ImageView , imageUrl : Uri ? , placeholder : Drawable ? ) { \n + @ BindingAdapter ( value = [ "" imageUri "" , "" placeholder "" ] , requireAll = false ) \n + fun imageUri ( imageView : ImageView , imageUri : Uri ? , placeholder : Drawable ? ) { \n - when ( imageUrl ) { \n + when ( imageUri ) { \n - . load ( imageUrl ) \n + . load ( imageUri ) \n - imageUrl ( imageView , imageUrl ? . toUri ( ) , placeholder ) \n + imageUri ( imageView , imageUrl ? . toUri ( ) , placeholder ) \n mobile \ src \ main \ res \ layout \ fragment _ schedule . xml \n - app : imageUrl = "" @ { viewModel . currentUserImageUri } "" \n + app : imageUri = "" @ { viewModel . currentUserImageUri } "" \n mobile \ src \ main \ res \ layout \ fragment _ session _ detail . xml \n - app : headerImage = "" @ { viewModel . session . photoUrl } "" / > \n + app : imageUrl = "" @ { viewModel . session . photoUrl } "" / > \n",Load header image for Session Details screen \n Bug : 74446579 \n Test : Manual + Kokoro \n Change - Id : I04abfa6a6eab9c361e30246be40077c40055d4b1,506
"build . gradle \n - ' kotlin ' : ' 1 . 3 . 0 - rc - 146 ' , \n + ' kotlin ' : ' 1 . 3 . 0 - rc - 190 ' , \n",Update Kotlin to 1 . 3 . 0 - rc - 190,506
app \ src \ androidTest \ java \ io \ plaidapp \ ui \ HomeActivityTest . kt \n - import androidx . test . InstrumentationRegistry \n + import androidx . test . platform . app . InstrumentationRegistry \n core \ src \ androidTest \ java \ io \ plaidapp \ core \ designernews \ data \ database \ LoggedInUserDaoTest . kt \n - import androidx . test . InstrumentationRegistry \n + import androidx . test . platform . app . InstrumentationRegistry \n core \ src \ androidTest \ java \ io \ plaidapp \ core \ designernews \ data \ login \ AuthTokenLocalDataSourceTest . kt \n - import androidx . test . InstrumentationRegistry \n + import androidx . test . platform . app . InstrumentationRegistry \n core \ src \ androidTest \ java \ io \ plaidapp \ core \ designernews \ data \ login \ LoginLocalDataSourceTest . kt \n - import androidx . test . InstrumentationRegistry . getInstrumentation \n + import androidx . test . platform . app . InstrumentationRegistry \n - private var sharedPreferences = getInstrumentation ( ) . context \n + private var sharedPreferences = InstrumentationRegistry . getInstrumentation ( ) . context \n core \ src \ androidTest \ java \ io \ plaidapp \ core \ dribbble \ data \ prefs \ DribbbleV1SourceRemoverTest . kt \n - import androidx . test . InstrumentationRegistry \n + import androidx . test . platform . app . InstrumentationRegistry \n core \ src \ androidTest \ java \ io \ plaidapp \ core \ util \ TextViewExtensionTest . kt \n - import androidx . test . InstrumentationRegistry \n + import androidx . test . platform . app . InstrumentationRegistry \n - private val context = InstrumentationRegistry . getContext ( ) \n + private val context = InstrumentationRegistry . getInstrumentation ( ) . context \n,Update import for InstrumentationRegistry \n Use androidx . test . platform . app . InstrumentationRegistry instead of \n androidx . test . InstrumentationRegistry .,506
"core \ build . gradle \n - kotlin { \n - experimental { \n - coroutines ' enable ' \n - } \n - } \n - \n designernews \ build . gradle \n - \n - kotlin { \n - experimental { \n - coroutines "" enable "" \n - } \n - } \n dribbble \ build . gradle \n - \n - kotlin { \n - experimental { \n - coroutines "" enable "" \n - } \n - } \n",Remove declaration for coroutines ; already included in Kotlin 1 . 3,506
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ model \ Session . kt \n - val type : SessionType by lazyFast { \n + val type : SessionType by lazy ( LazyThreadSafetyMode . PUBLICATION ) { \n shared \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ shared \ model \ SessionTest . kt \n + import com . google . samples . apps . iosched . shared . model . SessionType . UNKNOWN \n + @ Test \n + fun testType _ unknown ( ) { \n + val session = TestData . session0 . copy ( tags = listOf ( ) ) \n + assertThat ( session . type , ` is ` ( UNKNOWN ) ) \n + } \n + \n",Guard against crash on app launch \n Use LazyThreadSafetyMode . PUBLICATION instead of \n LazyThreadSafetyMode . NONE . \n Bug : 77881087 \n Test : kokoro \n Change - Id : I161bdc15dd194b65db609d2f7388b482114abeeb,506
app \ build . gradle \n - versionName = ' 1 . 0 . 5 ' \n + versionName = ' 1 . 0 . 7 ' \n,Bump versionName to 1 . 0 . 7 for release .,506
"new file \n . circleci \ config . yml \n + version : 2 \n + \n + references : \n + cache _ key : & cache _ key \n + key : jars - { { checksum "" build . gradle "" } } - { { checksum "" app / build . gradle "" } } - { { checksum "" gradle / wrapper / gradle - wrapper . properties "" } } \n + \n + jobs : \n + build : \n + docker : \n + - image : circleci / android : api - 28 - alpha \n + environment : \n + JVM _ OPTS : "" - Xmx1024m "" \n + GRADLE _ OPTS : "" - Dorg . gradle . daemon = false - Dorg . gradle . workers . max = 2 "" \n + TERM : dumb \n + steps : \n + - checkout \n + - restore _ cache : \n + < < : * cache _ key \n + - run : \n + name : Download Dependencies \n + command : . / gradlew dependencies \n + - save _ cache : \n + < < : * cache _ key \n + paths : \n + - ~ / . gradle / caches \n + - ~ / . gradle / wrapper \n + - run : \n + name : Run JVM Tests & Lint \n + command : . / gradlew check \n + - store _ artifacts : \n + path : app / build / reports \n + destination : reports \n + - store _ test _ results : \n + path : app / build / test - results \n app \ build . gradle \n + \n + lintOptions { \n + abortOnError false \n + } \n features \ activities \ build . gradle \n + \n + lintOptions { \n + abortOnError false \n + } \n third _ party \ bypass \ build . gradle \n + \n + lintOptions { \n + abortOnError false \n + } \n",Add initial config for CircleCI \n Temporarily muting lint errors during initial CI setup .,506
"build . gradle \n - ' glide ' : ' 4 . 7 . 1 ' , \n + ' glide ' : ' 4 . 8 . 0 ' , \n core \ src \ main \ java \ io \ plaidapp \ core \ util \ glide \ DribbbleTarget . kt \n - override fun onGenerated ( palette : Palette ) { \n + override fun onGenerated ( palette : Palette ? ) { \n","Bump Glide to 4 . 8 . 0 , which supports AndroidX annotations",506
about \ src \ main \ java \ io \ plaidapp \ about \ ui \ model \ AboutViewModel . kt \n - import androidx . core . text . plusAssign \n - about1 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n + / / about1 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n - about2 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n + / / about2 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n - about3 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n + / / about3 + = AlignmentSpan . Standard ( Layout . Alignment . ALIGN _ CENTER ) \n,Temporarily comment out plusAssign usage . App runs now,506
"designernews \ build . gradle \n + dependencies { \n + implementation ( "" androidx . arch . core : core - runtime : 2 . 0 . 1 - alpha01 "" ) \n + } \n + \n + \n",Attempt to fix core - runtime CI error,506
"mobile \ src \ main \ res \ values \ strings . xml \n + < string name = "" search _ schedule _ hint "" translation _ description = "" Text field hint that is shown when user has not entered a search query "" > Search the schedule < / string > \n + < string name = "" search _ schedule _ no _ results "" translation _ description = "" Text that is shown if there are no search results "" > No results found < / string > \n + < string name = "" search _ schedule _ error "" translation _ description = "" Text that is shown if there was an error searching "" > Error searching the schedule < / string > \n + < string name = "" a11y _ search _ schedule "" translation _ description = "" Alternate text for a button used to search the schedule . "" > Search schedule < / string > \n",Add string resources for schedule search \n Bug : 126650209 \n Test : kokoro \n Change - Id : I53eb17c48f3a1acdb7107078ae79d6dbd219348c,506
"build . gradle \n - ' crashlytics ' : ' 2 . 9 . 6 ' , \n + ' crashlytics ' : ' 2 . 9 . 8 ' , \n - ' firebase ' : ' 16 . 0 . 5 ' , \n + ' firebase ' : ' 16 . 0 . 6 ' , \n - ' kotlin ' : ' 1 . 3 . 10 ' , \n + ' kotlin ' : ' 1 . 3 . 20 ' , \n - classpath ' com . android . tools . build : gradle : 3 . 4 . 0 - alpha09 ' \n + classpath ' com . android . tools . build : gradle : 3 . 4 . 0 - beta02 ' \n gradle \ wrapper \ gradle - wrapper . properties \n - # Thu Dec 13 21 : 38 : 10 PST 2018 \n + # Thu Jan 24 11 : 25 : 43 PST 2019 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 5 . 1 - milestone - 1 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 5 . 1 . 1 - all . zip \n",Update to latest versions of dependencies \n - Crashlytics \n - Firebase \n - Gradle \n - Kotlin \n Test : CI and manual tests,506
mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ speaker \ SpeakerViewModel . kt \n - / * * \n - * Clear subscriptions that might be leaked or that will not be used in the future . \n - * / \n - override fun onCleared ( ) { \n - loadSpeakerSessionsUseCase . onCleared ( ) \n - } \n - \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ sessions \ LoadUserSessionsUseCase . kt \n - \n - fun onCleared ( ) { \n - / / This use case is no longer going to be used so remove subscriptions \n - userEventRepository . clearSingleEventSubscriptions ( ) \n - } \n,Fixes bug with stars when coming back from speaker screen \n This is a cherry pick of 100424 from ADSsched . \n Bug : 124097859 \n Change - Id : I631e99daee22227c8391e7d6715c31896a247d78,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ signin \ SignInDialogFragment . kt \n + import androidx . lifecycle . Observer \n - import com . google . samples . apps . iosched . shared . result . EventObserver \n - signInViewModel . performSignInEvent . observe ( this , EventObserver { signInRequest - > \n - if ( signInRequest = = RequestSignIn ) { \n - signInHandler . makeSignInIntent ( ) ? . let { \n - startActivityForResult ( it , SIGN _ IN _ ACTIVITY _ REQUEST _ CODE ) \n + signInViewModel . performSignInEvent . observe ( this , Observer { request - > \n + if ( request . peekContent ( ) = = RequestSignIn ) { \n + request . getContentIfNotHandled ( ) \n + activity ? . let { \n + signInHandler . makeSignInIntent ( ) ? . let { \n + startActivityForResult ( it , SIGN _ IN _ ACTIVITY _ REQUEST _ CODE ) \n + dismiss ( ) \n + } \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ signin \ SignOutDialogFragment . kt \n + import androidx . lifecycle . Observer \n - import com . google . samples . apps . iosched . shared . result . EventObserver \n - signInViewModel . performSignInEvent . observe ( this , EventObserver { signInRequest - > \n - if ( signInRequest = = RequestSignOut ) { \n + signInViewModel . performSignInEvent . observe ( this , Observer { request - > \n + if ( request . peekContent ( ) = = RequestSignOut ) { \n + request . getContentIfNotHandled ( ) \n",Fixes sign in / out bugs \n This is a cherry pick of 98865 from ADSsched . \n Bug : 124097859 \n Change - Id : Ie91939712a740e351d3603a48e671fdfcdc18530,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailViewModel . kt \n - if ( currentFirebaseUser . value = = null ) { \n - / / No user information provided by [ SignInViewModelDelegate ] yet . \n - Timber . d ( "" No user information available yet , not refreshing "" ) \n - return \n - } \n mobile \ src \ test \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailViewModelTest . kt \n + import org . junit . Assert . assertNotEquals \n - fun testDataIsNotLoaded _ authNotReady ( ) { \n + fun testAnonymous _ dataReady ( ) { \n - assertEquals ( null , LiveDataTestUtil . getValue ( viewModel . session ) ) \n + assertNotEquals ( null , LiveDataTestUtil . getValue ( viewModel . session ) ) \n",Removes check for signed in user to fix details screen bug \n This is a cherry pick of 95105 from ADSsched . \n Bug : 124097859 \n Change - Id : Ib02b099ab4d67f3b0167b7172e4225dca66740d5,506
"mobile \ src \ main \ res \ values \ strings . xml \n - < string name = "" notifications _ preference _ dialog _ content "" translation _ description = "" The content of the dialog for the notifications preference "" > Would you like to receive notifications about I / O ? We \ ' ll send you information about session start times , after hours events , session recordings , and more . You can change this setting under \ "" Info > Settings \ "" at any time . < / string > \n + < string name = "" notifications _ preference _ dialog _ content "" translation _ description = "" The content of the dialog for the notifications preference "" > Would you like to receive notifications about I / O ? We \ ' ll send you information about session start times , after hours events , session recordings , and more . You can change this setting under \ "" Settings \ "" at any time . < / string > \n",Update text for toggling notifications \n Bug : 131909289 \n Test : kokoro \n Change - Id : Ibfa13109931687c4f8707532685068f392b79c1b,506
app \ build . gradle \n - versionName = ' 1 . 0 . 7 ' \n + versionName = ' 1 . 0 . 9 ' \n build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 4 . 0 - beta05 ' \n + classpath ' com . android . tools . build : gradle : 3 . 4 . 0 - rc02 ' \n,Bump versionName to 1 . 0 . 9 \n Also bump gradle to 3 . 4 . 0 - rc02,506
"build . gradle \n + roomVersion = ' 2 . 1 . 0 - alpha05 ' \n model \ build . gradle \n + apply plugin : ' kotlin - kapt ' \n + implementation "" androidx . room : room - ktx : $ rootProject . roomVersion "" \n + implementation "" androidx . room : room - runtime : $ rootProject . roomVersion "" \n + kapt "" androidx . room : room - compiler : $ rootProject . roomVersion "" \n",Add dependencies for Room architecture component \n Bug : 126650209 \n Test : kokoro \n Change - Id : I25c368f1d43187cb26e3200bccfaf636579bc50d,506
"model \ build . gradle \n - implementation "" androidx . room : room - ktx : $ rootProject . roomVersion "" \n - implementation "" androidx . room : room - runtime : $ rootProject . roomVersion "" \n - kapt "" androidx . room : room - compiler : $ rootProject . roomVersion "" \n",Remove Room dependency \n Bug : 130516615 \n Test : kokoro \n Change - Id : I9b95f1a77f431a9af27492e96d7f94102c2094fd,506
"mobile \ src \ main \ res \ layout \ fragment _ search . xml \n - android : text = "" @ string / schedule _ filters _ empty "" \n + android : text = "" @ string / search _ schedule _ no _ results "" \n - tools : text = "" @ string / schedule _ filters _ empty "" \n",Change text for empty search results \n Also remove tools : text as it is identical to android : text . \n Bug : 130516731 \n Test : kokoro \n Change - Id : Ib87283eb45daffe58829d303fea122949de3689c,506
model \ build . gradle \n - apply plugin : ' kotlin - kapt ' \n,Remove kapt plugin for model / build . gradle \n Bug : 130516615 \n Test : kokoro \n Change - Id : I58010231ef1dd3025d5919141cd2bc33a48a9289,506
app \ build . gradle \n - versionName = ' 1 . 0 . 9 ' \n + versionName = ' 1 . 1 . 0 ' \n,Bump versionName to 1 . 1 . 0,506
"app \ src \ main \ java \ io \ plaidapp \ ui \ HomeActivity . java \n + import androidx . appcompat . widget . TooltipCompat ; \n + TooltipCompat . setTooltipText ( toggle , getString ( R . string . theme ) ) ; \n",Add tooltip text to dark theme menu toggle,506
"shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ data \ userevent \ DefaultSessionAndUserEventRepository . kt \n - Timber . d ( "" EventRepository : No user logged in , returning session without user event . "" ) \n - val session = sessionRepository . getSession ( eventId ) \n - sessionResult . postValue ( \n - Result . Success ( \n - LoadUserSessionUseCaseResult ( \n - userSession = UserSession ( session , createDefaultUserEvent ( session ) ) , \n - userMessage = null \n + DefaultScheduler . execute { \n + Timber . d ( "" EventRepository : No user logged in , returning session without user event "" ) \n + val session = sessionRepository . getSession ( eventId ) \n + sessionResult . postValue ( \n + Result . Success ( \n + LoadUserSessionUseCaseResult ( \n + userSession = UserSession ( session , createDefaultUserEvent ( session ) ) , \n + userMessage = null \n + ) \n - ) \n + } \n","Add DefaultScheduler . execute to getObservableUserEvent \n Bug : 132063230 \n Test : manual , kokoro \n Change - Id : I43d56bbbd58cfd61928bd467c6fd8a0c9fd3839b",506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapUtils . kt \n - setTextAppearance ( context , R . style . TextApparance _ IOSched _ Map _ Label ) \n + setTextAppearance ( context , R . style . TextAppearance _ IOSched _ Map _ Label ) \n mobile \ src \ main \ res \ values \ styles . xml \n - < style name = "" TextApparance . IOSched . Map . Label "" parent = "" TextAppearance . AppCompat . Body1 "" > \n + < style name = "" TextAppearance . IOSched . Map . Label "" parent = "" TextAppearance . AppCompat . Body1 "" > \n",Fix typo in styles . xml : TextApparance \n Bug : 130186219 \n Test : kokoro \n Change - Id : I9ccdf2de3bdf45e5e77e8eef5084ef04abe6e99b,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchFragment . kt \n + import androidx . core . view . updatePadding \n - import kotlinx . android . synthetic . main . fragment _ info _ event . view . * \n - import kotlinx . android . synthetic . main . fragment _ search . view . * \n + import com . google . samples . apps . iosched . util . doOnApplyWindowInsets \n + import kotlinx . android . synthetic . main . fragment _ search . view . searchView \n + \n + binding . recyclerView . doOnApplyWindowInsets { v , insets , padding - > \n + v . updatePadding ( bottom = padding . bottom + insets . systemWindowInsetBottom ) \n + } \n mobile \ src \ main \ res \ layout \ fragment _ search . xml \n + app : layout _ behavior = "" @ string / appbar _ scrolling _ view _ behavior "" \n",Fix padding on search screen \n Bug : 130214646 \n Test : kokoro \n Change - Id : I55f7afda9f99eaa1f536ff60b1c66dd0ae9110b4,506
shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ fcm \ IoschedFirebaseMessagingService . kt \n - private val MINIMUM _ LATENCY = TimeUnit . SECONDS . toSeconds ( 5 ) \n + private val MINIMUM _ LATENCY = TimeUnit . SECONDS . toMillis ( 5 ) \n - private val OVERRIDE _ DEADLINE = TimeUnit . SECONDS . toMinutes ( 15 ) \n + private val OVERRIDE _ DEADLINE = TimeUnit . MINUTES . toMillis ( 15 ) \n,"Fix job override deadline \n This is a cherry pick of 96044 from ADSsched , which addresses a bug reported on GitHub ( https : / / github . com / google / iosched / issues / 294 ) \n Bug : 124097859 \n Change - Id : I701b94361fdb05498bae595ff93fb51cbbed1d38",506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ schedule \ ScheduleFragment . kt \n + import com . google . samples . apps . iosched . shared . analytics . AnalyticsActions \n + analyticsHelper . logUiEvent ( "" Navigate to Search "" , AnalyticsActions . CLICK ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchFragment . kt \n + import com . google . samples . apps . iosched . shared . analytics . AnalyticsHelper \n + @ Inject lateinit var analyticsHelper : AnalyticsHelper \n + \n + analyticsHelper . sendScreenView ( "" Search "" , requireActivity ( ) ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ search \ SearchViewModel . kt \n + import com . google . samples . apps . iosched . shared . analytics . AnalyticsActions \n + import com . google . samples . apps . iosched . shared . analytics . AnalyticsHelper \n + private val analyticsHelper : AnalyticsHelper , \n + analyticsHelper . logUiEvent ( "" Session : $ sessionId "" , AnalyticsActions . SEARCH _ RESULT _ CLICK ) \n + analyticsHelper . logUiEvent ( "" Query : $ query "" , AnalyticsActions . SEARCH _ QUERY _ SUBMIT ) \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ analytics \ AnalyticsHelper . kt \n + const val SEARCH _ QUERY _ SUBMIT = "" Submitted search query "" \n + const val SEARCH _ RESULT _ CLICK = "" Clicked on search result "" \n",Add analytics for search \n Bug : 130194672 \n Test : kokoro \n Change - Id : Id49424ec1ca3b227b12d43dd1e03581dc7079d2f,506
"buildSrc \ src \ main \ java \ Versions . kt \n - const val ANDROID _ GRADLE _ PLUGIN = "" 3 . 6 . 0 "" \n + const val ANDROID _ GRADLE _ PLUGIN = "" 3 . 6 . 1 "" \n",Update to AGP 3 . 6 . 1 \n Reflects latest Studio version . \n Test : kokoro + verify app runs \n Change - Id : Ib128223bd2c44958566d8b87b453b95a35e7a711,506
"buildSrc \ src \ main \ java \ Versions . kt \n - const val ANDROID _ GRADLE _ PLUGIN = "" 3 . 5 . 2 "" \n + const val ANDROID _ GRADLE _ PLUGIN = "" 3 . 6 . 0 "" \n kokoro \ build . sh \n + # Workaround for b / 148189425 \n + # AGP 3 . 6 . 0 requires a specific NDK version for running Gradle \n + echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" ndk ; 20 . 0 . 5594570 "" \n + \n",Update AGP to 3 . 6 . 0 \n Reflects release of Android Studio 3 . 6 stable . This also updates the \n kokoro run script so CI does not error on an older version of the NDK . \n Test : kokoro + manually run the app \n Change - Id : Ife41cb721d94d2ced1c156e126b2965f988840a6,506
"mobile \ src \ main \ res \ layout \ item _ feed _ social _ channels . xml \n - android : layout _ height = "" 0dp "" \n - app : layout _ constraintHeight _ default = "" wrap "" \n + android : layout _ height = "" wrap _ content "" \n + app : layout _ constrainedHeight = "" true "" \n - android : layout _ height = "" 0dp "" \n - app : layout _ constraintHeight _ default = "" wrap "" \n + android : layout _ height = "" wrap _ content "" \n + app : layout _ constrainedHeight = "" true "" \n","Update layout settings for social channels \n layout _ constraintHeight _ default = "" wrap "" is deprecated . We ' ll replace it with a combination of android : layout _ height = "" wrap _ content "" and app : layout _ constrainedHeight = "" true "" . \n Change - Id : I1dad191ae2ab1447f0a07c435e38ff3a174239d1",506
"depconstraints \ build . gradle . kts \n - val core = "" 1 . 2 . 0 - alpha02 "" \n + val core = "" 1 . 2 . 0 "" \n - val drawerLayout = "" 1 . 1 . 0 - alpha02 "" \n + val drawerLayout = "" 1 . 1 . 0 - beta01 "" \n - val material = "" 1 . 1 . 0 - alpha07 "" \n + val material = "" 1 . 1 . 0 "" \n mobile \ build . gradle . kts \n - / / To avoid the compile error from AppBarConfiguration \n - / / Cannot inline bytecode built with JVM target 1 . 8 into bytecode that is being built with JVM target 1 . 6 \n + / / To avoid the compile error : "" Cannot inline bytecode built with JVM target 1 . 8 \n + / / into bytecode that is being built with JVM target 1 . 6 "" \n - implementation ( Libs . CORE _ KTX ) \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ sessiondetail \ SessionDetailFragment . kt \n - ShareCompat . IntentBuilder . from ( activity ) \n + ShareCompat . IntentBuilder . from ( requireActivity ( ) ) \n shared \ build . gradle . kts \n + \n + / / Some libs ( such as androidx . core : core - ktx 1 . 2 . 0 and newer ) require Java 8 \n + compileOptions { \n + sourceCompatibility = JavaVersion . VERSION _ 1 _ 8 \n + targetCompatibility = JavaVersion . VERSION _ 1 _ 8 \n + } \n + \n + / / To avoid the compile error : "" Cannot inline bytecode built with JVM target 1 . 8 \n + / / into bytecode that is being built with JVM target 1 . 6 "" \n + kotlinOptions { \n + val options = this as org . jetbrains . kotlin . gradle . dsl . KotlinJvmOptions \n + options . jvmTarget = "" 1 . 8 "" \n + } \n","Update Core , Drawer Layout , and Material libraries \n Includes adding Java 8 requirement . \n Also remove duplicate core - ktx declaration . \n Bug : 148216985 \n Test : kokoro + verifying the app runs \n Change - Id : I82ff6c73902bfb83e9339241abb275603b3f0857",506
"buildSrc \ src \ main \ java \ Versions . kt \n - const val ANDROID _ GRADLE _ PLUGIN = "" 3 . 6 . 1 "" \n + const val ANDROID _ GRADLE _ PLUGIN = "" 4 . 0 . 0 - beta05 "" \n - } \n + } \n kokoro \ build . sh \n - # AGP 3 . 6 . 0 requires a specific NDK version for running Gradle \n + # AGP requires a specific NDK version for running Gradle \n - echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" ndk ; 20 . 0 . 5594570 "" > / dev / null \n + echo y | $ { ANDROID _ SDK _ HOME } / tools / bin / sdkmanager "" ndk ; 21 . 0 . 6113669 "" > / dev / null \n",Update AGP version to 4 . 0 . 0 - beta05 \n Migrating to Android Studio 4 . 0 series . \n Also updates NDK version for CI . \n Bug : 154842381 \n Test : kokoro + verifying app runs \n Change - Id : Ia9d80f722fb036c22c3edc58848188196c9ffd38,506
"buildSrc \ src \ main \ java \ Versions . kt \n - const val ANDROID _ GRADLE _ PLUGIN = "" 4 . 0 . 0 - beta05 "" \n + const val ANDROID _ GRADLE _ PLUGIN = "" 4 . 0 . 0 - rc01 "" \n mobile \ build . gradle . kts \n - dataBinding { \n - isEnabled = true \n + \n + buildFeatures { \n + dataBinding = true \n",Update to AGP 4 . 0 . 0 - rc01 \n Reflects latest Studio version . \n Also replace deprecated data binding declaration \n Test : kokoro + verify app runs \n Change - Id : I3bbd6dfec5d56c256d54808564252c2e73e6ac9b,506
"buildSrc \ src \ main \ java \ Versions . kt \n - / / Versions that are used for classpath ( and library ) dependencies \n - / / b / 146592586 prevents updating the AGP to 4 . 0 \n - const val ANDROID _ GRADLE _ PLUGIN = "" 4 . 0 . 0 - rc01 "" \n + const val ANDROID _ GRADLE _ PLUGIN = "" 4 . 0 . 0 "" \n",Update AGP to 4 . 0 . 0 \n Reflects release of Android Studio 4 . 0 stable . \n Bug : 154842381 \n Change - Id : I0f1d1fbd72f0b16fda8cf88f47b3d23795222bef,506
"mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ prefs \ SnackbarPreferenceViewModel . kt \n + import androidx . lifecycle . viewModelScope \n + import kotlinx . coroutines . launch \n - stopSnackbarActionUseCase ( true ) \n + viewModelScope . launch { \n + stopSnackbarActionUseCase ( true ) \n + } \n shared \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ shared \ domain \ prefs \ StopSnackbarActionUseCase . kt \n - import com . google . samples . apps . iosched . shared . domain . UseCase \n - import javax . inject . Inject \n + import com . google . samples . apps . iosched . shared . domain . CoroutinesUseCase \n + import javax . inject . Inject \n - ) : UseCase < Boolean , Unit > ( dispatcher ) { \n + ) : CoroutinesUseCase < Boolean , Unit > ( dispatcher ) { \n",Migrate Snackbar to Coroutines \n Bug : 148851443 \n Change - Id : Idefef485a7f1f81626f5c09eb3ce0ef79f4b2aff,506
"buildSrc \ src \ main \ java \ Versions . kt \n - const val KOTLIN = "" 1 . 3 . 70 "" \n - const val NAVIGATION = "" 2 . 2 . 0 "" \n + const val KOTLIN = "" 1 . 3 . 72 "" \n + const val NAVIGATION = "" 2 . 2 . 2 "" \n depconstraints \ build . gradle . kts \n - val appcompat = "" 1 . 1 . 0 - beta01 "" \n - val activity = "" 1 . 0 . 0 - beta01 "" \n + val appcompat = "" 1 . 1 . 0 "" \n + val activity = "" 1 . 0 . 0 "" \n - val drawerLayout = "" 1 . 1 . 0 - beta01 "" \n + val drawerLayout = "" 1 . 1 . 0 - rc01 "" \n - val fragment = "" 1 . 1 . 0 - beta01 "" \n + val fragment = "" 1 . 2 . 4 "" \n mobile \ src \ main \ java \ com \ google \ samples \ apps \ iosched \ ui \ map \ MapFragment . kt \n - parentFragment ! ! . requestPermissions ( \n + requireParentFragment ( ) . requestPermissions ( \n",Use stable versions of libraries where available \n Bug : 148645538 \n Test : kokoro \n Change - Id : I05f665ed1cc76c3ccb80b0a10cfcb834c58ceeec,506
"tools \ setup . sh \n + # Copyright 2019 Google LLC \n + # \n + # Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n + # you may not use this file except in compliance with the License . \n + # You may obtain a copy of the License at \n + # \n + # https : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + # \n + # Unless required by applicable law or agreed to in writing , software \n + # distributed under the License is distributed on an "" AS IS "" BASIS , \n + # WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n + # See the License for the specific language governing permissions and \n + # limitations under the License . \n + \n",Add copyright to setups script \n Change - Id : Icc5fd5b6191d89f7a461c8ab16e0f323e13b76d3,506
". travis . yml \n - rm - f $ HOME / . gradle / caches / modules - 2 / modules - 2 . lock \n - - yes | sdkmanager "" platforms ; android - 28 "" \n + - yes | sdkmanager "" platforms ; android - 29 "" \n - yes | sdkmanager "" build - tools ; 29 . 0 . 2 "" \n",Use android - 29 instead of android - 28 for Travis CI,506
"core \ java \ android \ app \ Activity . java \n - * The < a href = "" https : / / github . com / googlesamples / android - RuntimePermissions "" > \n - * RuntimePermissions < / a > sample app demonstrates how to use this method to \n + * The < a href = "" https : / / github . com / android / permissions - samples "" > \n + * RuntimePermissions < / a > sample apps demonstrate how to use this method to \n",Update link for Permissions samples in Javadoc \n Bug : 158042826 \n Change - Id : I71ab17b21b31ff6584facd023e4c4818b0ab1b55 \n Test : N / A,506
"x - pack \ plugin \ core \ src \ main \ java \ org \ elasticsearch \ license \ XPackLicenseState . java \n - SECURITY _ TOKEN _ SERVICE ( OperationMode . GOLD , false ) , \n + SECURITY _ TOKEN _ SERVICE ( OperationMode . STANDARD , false ) , \n x - pack \ plugin \ core \ src \ test \ java \ org \ elasticsearch \ license \ XPackLicenseStateTests . java \n + assertThat ( licenseState . checkFeature ( Feature . SECURITY _ TOKEN _ SERVICE ) , is ( true ) ) ; \n + assertThat ( licenseState . checkFeature ( Feature . SECURITY _ TOKEN _ SERVICE ) , is ( true ) ) ; \n","Move TokenService to Standard license ( # 66074 ) \n The token service was part of the Gold license , but due to its use as \n part of Cloud SSO , we are moving it down to Standard instead .",509
"x - pack \ plugin \ security \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ security \ authc \ TokenAuthIntegTests . java \n + / / Weird testing behaviour ahead . . . \n + / / invalidating by access token ( above ) is a Get , but invalidating by refresh token ( below ) is a Search \n + / / In a multi node cluster , in a small % of cases , the search might find a document that has been invalidated but not yet deleted \n + / / from that node ' s shard . \n + / / Our assertion , therefore , is that an attempt to invalidate the ( already invalidated ) refresh token must not actually invalidate \n + / / anything ( concurrency controls must prevent that ) , nor may return any errors , \n + / / but it might _ temporarily _ find an "" already invalidated "" token . \n + final InvalidateTokenRequest invalidateRefreshTokenRequest = InvalidateTokenRequest . refreshToken ( refreshToken ) ; \n - InvalidateTokenRequest . refreshToken ( refreshToken ) , SECURITY _ REQUEST _ OPTIONS ) ; \n + invalidateRefreshTokenRequest , SECURITY _ REQUEST _ OPTIONS ) ; \n - assertThat ( invalidateRefreshTokenResponse . getPreviouslyInvalidatedTokens ( ) , equalTo ( 0 ) ) ; \n + \n + / / 99 % of the time , this will already be zero , but if not ensure it goes to zero within the allowed timeframe \n + if ( invalidateRefreshTokenResponse . getPreviouslyInvalidatedTokens ( ) > 0 ) { \n + assertBusy ( ( ) - > { \n + var newResponse = restClient . security ( ) . invalidateToken ( invalidateRefreshTokenRequest , SECURITY _ REQUEST _ OPTIONS ) ; \n + assertThat ( newResponse . getPreviouslyInvalidatedTokens ( ) , equalTo ( 0 ) ) ; \n + } ) ; \n + } \n","Add resilience in TokenAuthIntegTests ( # 64757 ) \n The testExpiredTokensDeletedAfterExpiration method assumed that \n invalidating a refresh token immediately after the delete task was run \n would behave as if the token did not exist . \n However , the Elasticsearch concurrency controls do not guarantee that \n behaviour . It is possible for the request that searches for the token \n document the corresponds to the refresh token to find an invalidated \n but not yet deleted document which is reflected in the API response . \n This change makes the test resilient to this behaviour by wrapping the \n assertion in an assertBusy \n Resolves : # 56903",509
x - pack \ qa \ full - cluster - restart \ src \ test \ java \ org \ elasticsearch \ xpack \ restart \ FullClusterRestartIT . java \n - assertEquals ( getOldClusterVersion ( ) . onOrAfter ( Version . V _ 8 _ 0 _ 0 ) \n + assertEquals ( getOldClusterVersion ( ) . onOrAfter ( Version . V _ 7 _ 11 _ 0 ) \n,Update version constants in DataStreams BWC Test ( # 66316 ) \n This change updates version constants in ` FullClusterRestartIT ` to \n reflect the fact that # 65205 was backported to v7 . 11 ( as # 66307 ),509
"modules \ transport - netty4 \ src \ yamlRestTest \ java \ org \ elasticsearch \ http \ netty4 \ Netty4ClientYamlTestSuiteIT . java \n + import java . io . IOException ; \n + \n + @ Override \n + public void test ( ) throws IOException { \n + assumeFalse ( "" FIPS JVMs are configured to use the ' security4 ' transport rather than ' netty4 ' "" , inFipsJvm ( ) ) ; \n + super . test ( ) ; \n + } \n","Skip netty4 yaml test in FIPS mode ( # 66842 ) \n The "" Netty loaded "" YAML test asserts that the configured transport is \n "" netty4 "" , however when in FIPS mode , the tests enable security and the \n configured transport is "" security4 "" . \n This change skips the netty4 yaml test when running in FIPS mode . \n Resolves : # 66818",509
"x - pack \ plugin \ security \ cli \ src \ test \ java \ org \ elasticsearch \ xpack \ security \ cli \ HttpCertificateCommandTests . java \n - final String crtName = keyPath . getFileName ( ) . toString ( ) . replace ( "" . csr "" , "" . crt "" ) ; \n + final String csrName = csrPath . getFileName ( ) . toString ( ) ; \n + final String crtName = csrName . substring ( 0 , csrName . length ( ) - 4 ) + "" . crt "" ; \n - assertThat ( esReadme , containsString ( csrPath . getFileName ( ) . toString ( ) ) ) ; \n + assertThat ( esReadme , containsString ( csrName ) ) ; \n - assertThat ( yml , not ( containsString ( csrPath . getFileName ( ) . toString ( ) ) ) ) ; \n + assertThat ( yml , not ( containsString ( csrName ) ) ) ; \n - Stream . of ( password , csrPath . getFileName ( ) . toString ( ) ) \n + Stream . of ( password , csrName ) \n","Fix string replacement in certutil http test ( # 69319 ) \n This test had 2 issues : \n 1 . It performed a replacement using a string literal on a randomly \n generated string . It is possible that the filename had "" . csr "" \n somewhere in the basename , which would then produce incorrect results \n 2 . It used the wrong base file for the substitution ( key vs csr ) . \n This fixes the bug by using an index based replacement rather than a \n textual one . \n Resolves : # 67328",509
"server \ src \ main \ java \ org \ elasticsearch \ cluster \ metadata \ MetadataIndexTemplateService . java \n + import java . util . TreeMap ; \n - Map < String , List < String > > overlappingTemplates = new HashMap < > ( ) ; \n + Map < String , List < String > > overlappingTemplates = new TreeMap < > ( ) ; \n",Make template conflict warning deterministic ( # 67066 ) \n This changes the conflict ( overlap ) template warning so that the \n message is built deterministically . It does this by collecting the \n composable templates into a map sorted by template name . \n Relates : # 66820,509
"modules \ transport - netty4 \ src \ javaRestTest \ java \ org \ elasticsearch \ rest \ Netty4HeadBodyIsEmptyIT . java \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 66820 "" ) \n - "" [ ilm - history , . triggered _ watches , . watch - history - 14 , . slm - history , synthetics , metrics , . deprecation - indexing - template , "" + \n - "" . watches , logs ] with patterns ( ilm - history = > [ ilm - history - 5 * ] , . triggered _ watches = > [ . triggered _ watches * ] , "" + \n - "" . watch - history - 14 = > [ . watcher - history - 14 * ] , . slm - history = > [ . slm - history - 5 * ] , synthetics = > [ synthetics - * - * ] "" + \n - "" , metrics = > [ metrics - * - * ] , . deprecation - indexing - template = > [ . logs - deprecation - elasticsearch ] , "" + \n - "" . watches = > [ . watches * ] , logs = > [ logs - * - * ] ) ; this template [ template ] may be ignored in favor "" + \n - "" of a composable template at index creation time "" ) ) ; \n - } \n + "" [ . deprecation - indexing - template , . slm - history , . triggered _ watches , . watch - history - 14 , . watches , ilm - history , logs , "" + \n + "" metrics , synthetics ] with patterns ( . deprecation - indexing - template = > [ . logs - deprecation - elasticsearch ] , "" + \n + "" . slm - history = > [ . slm - history - 5 * ] , . triggered _ watches = > [ . triggered _ watches * ] , "" + \n + "" . watch - history - 14 = > [ . watcher - history - 14 * ] , . watches = > [ . watches * ] , ilm - history = > [ ilm - history - 5 * ] , "" + \n + "" logs = > [ logs - * - * ] , metrics = > [ metrics - * - * ] , synthetics = > [ synthetics - * - * ] "" + \n + "" ) ; this template [ template ] may be ignored in favor of a composable template at index creation time "" ) ) ; \n + } \n",Update template warning for FIPS in Netty test ( # 67067 ) \n This changes the expected error message ( on FIPS ) so that the \n order of the templates ( and their associated patterns ) matches \n the ( newly updated ) order generated by the server . \n Relates : # 67066 \n Resolves : # 66820,509
"x - pack \ plugin \ security \ src \ main \ java \ org \ elasticsearch \ xpack \ security \ authc \ TokenService . java \n + logger . debug ( "" Found superseding document : index = [ { } ] id = [ { } ] primTerm = [ { } ] seqNo = [ { } ] "" , \n + response . getIndex ( ) , response . getId ( ) , response . getPrimaryTerm ( ) , response . getSeqNo ( ) ) ; \n - onFailure . accept ( new IllegalStateException ( "" token document is missing and must be present "" ) ) ; \n + / / This shouldn ' t happen ( if we have a valid ` UserToken ` object , then should mean that we loaded it from the \n + / / index in a prior operation ( e . g . # getUserTokenFromId ) , however this error can happen if either : \n + / / 1 . The document was deleted just after we read it \n + / / 2 . This Get used a different replica to the previous one , and they were out of sync . \n + logger . warn ( \n + "" Could not find token document ( index = [ { } ] id = [ { } ] ) in order to validate user token [ { } ] for [ { } ] "" , \n + response . getIndex ( ) , \n + response . getId ( ) , \n + userToken . getId ( ) , \n + userToken . getAuthentication ( ) . getUser ( ) . principal ( ) ) ; \n + onFailure . accept ( traceLog ( "" validate token "" , userToken . getId ( ) , \n + new IllegalStateException ( "" token document is missing and must be present "" ) ) ) ; \n x - pack \ plugin \ security \ src \ main \ java \ org \ elasticsearch \ xpack \ security \ authc \ UserToken . java \n - * Get the authentication \n + * Get the authentication ( will not be null ) \n","Add more logging to TokenService on superseding doc ( # 66970 ) \n This adds two new log messages to TokenService \n 1 . After finding a superseding document , log ( DEBUG ) that it was \n successfully found ( previously we only logged not - found + retries ) \n 2 . If a document cannot be found in order to validate it , log ( WARN ) \n this explicitly .",509
"Libraries \ EventEmitter \ NativeEventEmitter . js \n - const count = this . listeners ( eventType ) . length ; \n + const count = this . listenerCount ( eventType ) ; \n Libraries \ vendor \ emitter \ _ EventEmitter . js \n - * Returns an array of listeners that are currently registered for the given \n + * Returns the number of listeners that are currently registered for the given \n - * @ returns { array } \n + * @ returns { number } \n - listeners ( eventType : string ) : [ EmitterSubscription ] { \n + listenerCount ( eventType : string ) : number { \n - ? subscriptions \n - / / We filter out missing entries because the array is sparse . \n - / / "" callbackfn is called only for elements of the array which actually \n - / / exist ; it is not called for missing elements of the array . "" \n - / / https : / / www . ecma - international . org / ecma - 262 / 9 . 0 / index . html # sec - array . prototype . filter \n - . filter ( sparseFilterPredicate ) \n - . map ( subscription = > subscription . listener ) \n - : [ ] ; \n + ? / / We filter out missing entries because the array is sparse . \n + / / "" callbackfn is called only for elements of the array which actually \n + / / exist ; it is not called for missing elements of the array . "" \n + / / https : / / www . ecma - international . org / ecma - 262 / 9 . 0 / index . html # sec - array . prototype . filter \n + subscriptions . filter ( sparseFilterPredicate ) . length \n + : 0 ; \n",EventEmitter : Replace ` listeners ( ) ` with ` listenerCount ( ) ` \n Summary : \n Replaces the ` listeners ( ) ` method on ` EventEmitter ` with a ` listenerCount ( ) ` method . \n Changelog : \n [ General ] [ Removed ] - Removed ` listeners ( ) ` from ` DeviceEventEmitter ` and ` NativeEventEmitter ` . \n [ General ] [ Added ] - Added ` listenerCount ( ) ` to ` DeviceEventEmitter ` and ` NativeEventEmitter ` . \n Reviewed By : cpojer \n Differential Revision : D22204156 \n fbshipit - source - id : 15029525aeef55de9934a4f319910e666ecbe1d8,510
"Libraries \ Text \ Text . js \n - touchableHandleResponderGrant : ? ( \n - event : PressEvent , \n - dispatchID : string , \n - ) = > void ; \n + touchableHandleResponderGrant : ? ( event : PressEvent ) = > void ; \n - onResponderGrant : ( event : PressEvent , dispatchID : string ) : void = > { \n - nullthrows ( this . touchableHandleResponderGrant ) ( event , dispatchID ) ; \n + onResponderGrant : ( event : PressEvent ) : void = > { \n + nullthrows ( this . touchableHandleResponderGrant ) ( event ) ; \n - this . props . onResponderGrant . call ( this , event , dispatchID ) ; \n + this . props . onResponderGrant . call ( this , event ) ; \n Libraries \ Text \ TextProps . js \n - onResponderGrant ? : ? ( event : PressEvent , dispatchID : string ) = > void , \n + onResponderGrant ? : ? ( event : PressEvent ) = > void , \n",Text : Remove Extraneous ` onResponderGrant ` Argument \n Summary : \n This argument for the ` onResponderGrant ` event callback on ` Text ` is extraneous . \n Changelog : \n [ General ] [ Fixed ] - Remove extraneous argument for ` onResponderGrant ` Flow type on ` Text ` . \n Reviewed By : TheSavior \n Differential Revision : D23513190 \n fbshipit - source - id : c4057cf534f4cdf73967e4324db64acc8cf323d0,510
"Libraries \ Components \ Switch \ Switch . js \n - } \n - \n - const platformProps = { \n - disabled , \n - onTintColor : trackColorForTrue , \n - style : StyleSheet . compose ( \n - { height : 31 , width : 51 } , \n - StyleSheet . compose ( \n - style , \n - ios _ backgroundColor = = null \n - ? null \n - : { \n - backgroundColor : ios _ backgroundColor , \n - borderRadius : 16 , \n - } , \n + } else { \n + const platformProps = { \n + disabled , \n + onTintColor : trackColorForTrue , \n + style : StyleSheet . compose ( \n + { height : 31 , width : 51 } , \n + StyleSheet . compose ( \n + style , \n + ios _ backgroundColor = = null \n + ? null \n + : { \n + backgroundColor : ios _ backgroundColor , \n + borderRadius : 16 , \n + } , \n + ) , \n - ) , \n - thumbTintColor : thumbColor , \n - tintColor : trackColorForFalse , \n - value : value = = = true , \n - } ; \n + thumbTintColor : thumbColor , \n + tintColor : trackColorForFalse , \n + value : value = = = true , \n + } ; \n - return ( \n - < SwitchNativeComponent \n - { . . . props } \n - { . . . platformProps } \n - accessibilityRole = { props . accessibilityRole ? ? ' switch ' } \n - onChange = { this . _ handleChange } \n - onResponderTerminationRequest = { returnsFalse } \n - onStartShouldSetResponder = { returnsTrue } \n - ref = { this . _ handleSwitchNativeComponentRef } \n - / > \n - ) ; \n + return ( \n + < SwitchNativeComponent \n + { . . . props } \n + { . . . platformProps } \n + accessibilityRole = { props . accessibilityRole ? ? ' switch ' } \n + onChange = { this . _ handleChange } \n + onResponderTerminationRequest = { returnsFalse } \n + onStartShouldSetResponder = { returnsTrue } \n + ref = { this . _ handleSwitchNativeComponentRef } \n + / > \n + ) ; \n + } \n Libraries \ Linking \ Linking . js \n + } else { \n + return new Promise ( ( resolve , reject ) = > reject ( new Error ( ' Unsupported ' ) ) ) ; \n - return new Promise ( ( resolve , reject ) = > reject ( new Error ( ' Unsupported ' ) ) ) ; \n",RN : Omit Unused Platform - Specific Code \n Summary : \n Our Babel plugin that strips irrelevant platform - specific code does not currently know how to deal with early return statements . \n This minor change to a couple call sites enables the output bundle for Android to omit code specific to iOS . \n Changelog : \n [ Internal ] \n Reviewed By : ejanzer \n Differential Revision : D24139922 \n fbshipit - source - id : 467c0c38dd45679b889a8a94d85f73fd969e5b36,510
"Libraries \ Components \ TextInput \ TextInput . js \n + / * * \n + * Called when a touch is engaged . \n + * / \n + onPressIn ? : ? ( event : PressEvent ) = > mixed , \n + \n + / * * \n + * Called when a touch is released . \n + * / \n + onPressOut ? : ? ( event : PressEvent ) = > mixed , \n + \n + onPressIn = { props . onPressIn } \n + onPressOut = { props . onPressOut } \n",TextInput : Add ` onPressIn ` and ` onPressOut ` \n Summary : \n Introduces support for ` onPressIn ` and ` onPressOut ` on the ` TextInput ` component . \n This makes it possible to add visual feedback when users touch interact with ` TextInput ` components . \n Changelog : \n [ General ] [ Added ] - TextInput now supports ` onPressIn ` and ` onPressOut ` . \n Reviewed By : TheSavior \n Differential Revision : D23514333 \n fbshipit - source - id : 1790e977b78f1c293d5476aef8613547f27d6731,510
"Libraries \ Components \ ScrollView \ ScrollView . js \n + import ScrollViewContext , { HORIZONTAL , VERTICAL } from ' . / ScrollViewContext ' ; \n - type ContextType = { | horizontal : boolean | } | null ; \n - const Context : React . Context < ContextType > = React . createContext ( null ) ; \n - const standardHorizontalContext : ContextType = Object . freeze ( { \n - horizontal : true , \n - } ) ; \n - const standardVerticalContext : ContextType = Object . freeze ( { horizontal : false } ) ; \n - Context : typeof Context , \n + Context : typeof ScrollViewContext , \n - static Context : React $ Context < ContextType > = Context ; \n + static Context : typeof ScrollViewContext = ScrollViewContext ; \n - < Context . Provider \n - value = { \n - this . props . horizontal = = = true \n - ? standardHorizontalContext \n - : standardVerticalContext \n - } > \n + < ScrollViewContext . Provider \n + value = { this . props . horizontal = = = true ? HORIZONTAL : VERTICAL } > \n - < / Context . Provider > \n + < / ScrollViewContext . Provider > \n - ForwardedScrollView . Context = Context ; \n + ForwardedScrollView . Context = ScrollViewContext ; \n new file \n Libraries \ Components \ ScrollView \ ScrollViewContext . js \n + / * * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * \n + * @ flow strict \n + * @ format \n + * / \n + \n + ' use strict ' ; \n + \n + import * as React from ' react ' ; \n + \n + type Value = { horizontal : boolean } | null ; \n + \n + const ScrollViewContext : React . Context < Value > = React . createContext ( null ) ; \n + \n + export default ScrollViewContext ; \n + \n + export const HORIZONTAL : Value = Object . freeze ( { horizontal : true } ) ; \n + export const VERTICAL : Value = Object . freeze ( { horizontal : false } ) ; \n",RN : Extract ` ScrollViewContext ` \n Summary : \n Extracts ` ScrollViewContext ` so that other components can use it without requiring ` ScrollView ` as a dependency . \n Changelog : \n [ Internal ] \n Reviewed By : kacieb \n Differential Revision : D22670035 \n fbshipit - source - id : 7f902697ad2a60cd1869438e9a2b77e479a18065,510
"deleted file \n Libraries \ Animated \ polyfills \ InteractionManager . js \n - / * * \n - * Copyright ( c ) Facebook , Inc . and its affiliates . \n - * \n - * This source code is licensed under the MIT license found in the \n - * LICENSE file in the root directory of this source tree . \n - * \n - * @ format \n - * / \n - \n - ' use strict ' ; \n - \n - module . exports = { \n - createInteractionHandle : function ( ) { } , \n - clearInteractionHandle : function ( ) { } , \n - } ; \n deleted file \n Libraries \ Animated \ polyfills \ Set . js \n - / * * \n - * Copyright ( c ) Facebook , Inc . and its affiliates . \n - * \n - * This source code is licensed under the MIT license found in the \n - * LICENSE file in the root directory of this source tree . \n - * \n - * @ format \n - * / \n - \n - ' use strict ' ; \n - \n - function SetPolyfill ( ) { \n - this . _ cache = [ ] ; \n - } \n - \n - SetPolyfill . prototype . add = function ( e ) { \n - if ( this . _ cache . indexOf ( e ) = = = - 1 ) { \n - this . _ cache . push ( e ) ; \n - } \n - } ; \n - \n - SetPolyfill . prototype . forEach = function ( cb ) { \n - this . _ cache . forEach ( cb ) ; \n - } ; \n - \n - module . exports = SetPolyfill ; \n deleted file \n Libraries \ Animated \ polyfills \ flattenStyle . js \n - / * * \n - * Copyright ( c ) Facebook , Inc . and its affiliates . \n - * \n - * This source code is licensed under the MIT license found in the \n - * LICENSE file in the root directory of this source tree . \n - * \n - * @ format \n - * / \n - \n - ' use strict ' ; \n - module . exports = function ( style ) { \n - return style ; \n - } ; \n",RN : Delete ` Animated / polyfills ` \n Summary : \n Deletes ` Animated / polyfills ` which is no longer necessary ( and only creates extra configuration burden ) . \n Changelog : \n [ Internal ] \n Reviewed By : cpojer \n Differential Revision : D22451963 \n fbshipit - source - id : 7a9a48b96b3783f2f6340226bdafd2eaa43f32e7,510
IntegrationTests \ IntegrationTestHarnessTest . js \n - const requestAnimationFrame = require ( ' fbjs / lib / requestAnimationFrame ' ) ; \n IntegrationTests \ SimpleSnapshotTest . js \n - const requestAnimationFrame = require ( ' fbjs / lib / requestAnimationFrame ' ) ; \n - \n,RN : Remove ` fbjs / requestAnimationFrame ` Dependency \n Summary : \n Removes ` fbjs / requestAnimationFrame ` call sites from React Native . It is already available globally . \n Changelog : \n [ Internal ] \n Reviewed By : cpojer \n Differential Revision : D22445947 \n fbshipit - source - id : d85418ac055eddd15ba7de4a586de1d31445e95c,510
"Libraries \ Image \ ImageSource . js \n - * @ flow \n + * @ flow strict \n - / / This is to sync with ImageSourcePropTypes . js . \n - / / We explicitly don ' t want this to be strict so that we can pass in objects \n - / / that might have more keys . This also has to be inexact to support taking \n - / / instances of classes like FBIcon . \n - / / https : / / fburl . com / 8lynhvtw \n + / * * \n + * Keep this in sync with ` DeprecatedImageSourcePropType . js ` . \n + * \n + * This type is intentinoally inexact in order to permit call sites that supply \n + * extra properties . \n + * / \n + \n + \n + \n - headers ? : ? Object , \n + headers ? : ? { [ string ] : string } , \n + \n + \n + \n + \n + \n - / / We have to export any because of an issue in Flow with objects that come from Relay : \n - / / https : / / fburl . com / 8ljo5tmr \n - / / https : / / fb . facebook . com / groups / flow / permalink / 1824103160971624 / \n - export type ImageSource = ImageURISource | number | Array < ImageURISource > ; \n + export type ImageSource = \n + | number \n + | ImageURISource \n + | $ ReadOnlyArray < ImageURISource > ; \n",RN : Cleanup ` ImageSource ` Flow Type \n Summary : \n Cleans up the documentation and types for ` ImageSource ` . \n The only material changes here are : \n - ` ImageSource ` ' s array variant will now be ` $ ReadOnlyArray ` instead of ` Array ` . \n - ` ImageURISource . headers ` is now an object of string properties . \n Changelog : \n [ General ] [ Changed ] - Refined ` ImageSource ` Flow type for array - variant and headers . \n Reviewed By : kacieb \n Differential Revision : D23355812 \n fbshipit - source - id : c3407db037dfb1d3514a028d1a237eb76ee6fedd,510
"Libraries \ Core \ setUpBatchedBridge . js \n - registerModule ( ' RCTDeviceEventEmitter ' , ( ) = > \n - require ( ' . . / EventEmitter / RCTDeviceEventEmitter ' ) , \n + registerModule ( \n + ' RCTDeviceEventEmitter ' , \n + ( ) = > require ( ' . . / EventEmitter / RCTDeviceEventEmitter ' ) . default , \n Libraries \ EventEmitter \ NativeEventEmitter . js \n - class NativeEventEmitter extends EventEmitter { \n + export default class NativeEventEmitter extends EventEmitter { \n - \n - module . exports = NativeEventEmitter ; \n Libraries \ EventEmitter \ RCTDeviceEventEmitter . js \n - module . exports = ( new RCTDeviceEventEmitter ( ) : RCTDeviceEventEmitter ) ; \n + export default ( new RCTDeviceEventEmitter ( ) : RCTDeviceEventEmitter ) ; \n Libraries \ EventEmitter \ _ _ mocks _ _ \ NativeEventEmitter . js \n - class NativeEventEmitter extends EventEmitter { \n + export default class NativeEventEmitter extends EventEmitter { \n - \n - module . exports = NativeEventEmitter ; \n index . js \n - return require ( ' . / Libraries / EventEmitter / NativeEventEmitter ' ) ; \n + return require ( ' . / Libraries / EventEmitter / NativeEventEmitter ' ) . default ; \n - return require ( ' . / Libraries / EventEmitter / RCTDeviceEventEmitter ' ) ; \n + return require ( ' . / Libraries / EventEmitter / RCTDeviceEventEmitter ' ) . default ; \n","EventEmitter : Default Export ` { Native , RCTDevice } EventEmitter ` \n Summary : \n Refactors ` NativeEventEmitter ` and ` RCTDeviceEventEmitter ` to be default exports . \n Changelog : \n [ Internal ] \n Reviewed By : RSNara \n Differential Revision : D22203918 \n fbshipit - source - id : 575b2baf1604d1a8a1bffd6d108c12f3f8415e0a",510
"Libraries \ Components \ Pressable \ Pressable . js \n + const restPropsWithDefaults : React . ElementConfig < typeof View > = { \n + . . . restProps , \n + . . . android _ rippleConfig ? . viewProps , \n + accessible : accessible ! = = false , \n + focusable : focusable ! = = false , \n + hitSlop , \n + } ; \n + \n - { . . . restProps } \n + { . . . restPropsWithDefaults } \n - { . . . android _ rippleConfig ? . viewProps } \n - accessible = { accessible ! = = false } \n - focusable = { focusable ! = = false } \n - hitSlop = { hitSlop } \n Libraries \ Pressability \ usePressability . js \n + / * * \n + * Creates a persistent instance of ` Pressability ` that automatically configures \n + * itself and resets . Accepts null ` config ` to support lazy initialization . Once \n + * initialized , will not un - initialize until the component has been unmounted . \n + * / \n - config : PressabilityConfig , \n - ) : EventHandlers { \n + config : ? PressabilityConfig , \n + ) : ? EventHandlers { \n - if ( pressabilityRef . current = = null ) { \n + if ( config ! = null & & pressabilityRef . current = = null ) { \n - pressability . configure ( config ) ; \n + if ( config ! = null & & pressability ! = null ) { \n + pressability . configure ( config ) ; \n + } \n - return ( ) = > { \n - pressability . reset ( ) ; \n - } ; \n + if ( pressability ! = null ) { \n + return ( ) = > { \n + pressability . reset ( ) ; \n + } ; \n + } \n - return pressability . getEventHandlers ( ) ; \n + return pressability = = null ? null : pressability . getEventHandlers ( ) ; \n",Pressability : Support Lazy Hook Initialization \n Summary : \n Changes ` usePressability ` so that it accepts a nullable ` config ` argument . \n This makes it possible for a component to use ` usePressability ` and lazily allocate the ` config ` and subsequent instance of ` Pressability ` . This can be useful for components that are commonly allocated but seldom pressed because it lets many usages of ` usePressability ` avoid allocating many extraneous objects . \n Changelog : \n [ Internal ] \n Reviewed By : kacieb \n Differential Revision : D23708206 \n fbshipit - source - id : 4a5063067131ce8c957fb16c49a2045e8c0b19fa,510
"Libraries \ Pressability \ Pressability . js \n + / / If we never activated ( due to delays ) , activate and deactivate now . \n + if ( ! isNextActive & & ! isPrevActive ) { \n + this . _ activate ( event ) ; \n + this . _ deactivate ( event ) ; \n + } \n - / / If we never activated ( due to delays ) , activate and deactivate now . \n - if ( ! isNextActive & & ! isPrevActive ) { \n - this . _ activate ( event ) ; \n - this . _ deactivate ( event ) ; \n - } \n","Pressability : Consistently Fire ` onPress { In , Out } ` w / o ` onPress ` \n Summary : \n Currently any component using ` Pressability ` is quickly tapped and released ( i . e . responder grant followed only by reponder release ) , we fire ` onPressIn ` and ` onPressOut ` immediately to ensure that any visual feedback for the interactive element is momentarily visible . \n Currently , we were mistakenly skipping this logic if ` onPress ` was null . \n This fixes it so that we fire ` onPressIn ` and ` onPressOut ` consistently , even if ` onPress ` is null . \n Changelog : \n [ General ] [ Fixed ] - Pressability now consistently fires ` onPressIn ` and ` onPressOut ` , even without an ` onPress ` . \n Reviewed By : lunaleaps \n Differential Revision : D23613254 \n fbshipit - source - id : e316707cbb2a4814262dea4eb1ddf6e3780268d1",510
"Libraries \ Components \ Pressable \ Pressable . js \n + \n + / * * \n + * Duration to wait after press down before calling ` onPressIn ` . \n + * / \n + unstable _ pressDelay ? : ? number , \n + unstable _ pressDelay , \n + delayPressIn : unstable _ pressDelay , \n + unstable _ pressDelay , \n",Pressable : Add ` unstable _ pressDelay ` Prop \n Summary : \n Adds a new ` unstable _ pressDelay ` prop to ` Pressable ` . \n This is intended to be used to experiment with adding a delay for when ` onPressIn ` fires . The intended purpose of this delay is to prevent ` Pressable ` elements from activating ( i . e . ` onPressIn ` firing ) if a touch gesture is immediately canceled by an enclosing native component ( e . g . ` ScrollView ` ) . \n Changelog : \n [ General ] [ Added ] - Added ` unstable _ pressDelay ` prop to ` Pressable ` . \n Reviewed By : lunaleaps \n Differential Revision : D23604581 \n fbshipit - source - id : 5ce5d15a996c8a7aabaa465aa02fa8bad1044227,510
"Libraries \ Text \ Text . js \n - import type { HostComponent } from ' . . / Renderer / shims / ReactNativeTypes ' ; \n - const Text = ( \n - props : TextProps , \n - forwardedRef : ? React . Ref < typeof NativeText | typeof NativeVirtualText > , \n - ) = > { \n - return < TouchableText { . . . props } forwardedRef = { forwardedRef } / > ; \n - } ; \n - const TextToExport = React . forwardRef ( Text ) ; \n - TextToExport . displayName = ' Text ' ; \n + const Text : React . AbstractComponent < \n + TextProps , \n + React . ElementRef < typeof NativeText | typeof NativeVirtualText > , \n + > = React . forwardRef ( \n + ( \n + props : TextProps , \n + forwardedRef : ? React . Ref < typeof NativeText | typeof NativeVirtualText > , \n + ) = > { \n + return < TouchableText { . . . props } forwardedRef = { forwardedRef } / > ; \n + } , \n + ) ; \n + Text . displayName = ' Text ' ; \n - TextToExport . propTypes = DeprecatedTextPropTypes ; \n + Text . propTypes = DeprecatedTextPropTypes ; \n - type TextStatics = $ ReadOnly < { | \n - propTypes : typeof DeprecatedTextPropTypes , \n - | } > ; \n + const TextToExport : typeof Text & \n + $ ReadOnly < { | \n + propTypes : typeof DeprecatedTextPropTypes , \n + | } > = \n + / / $ FlowFixMe [ incompatible - type ] - No good way to type a React . AbstractComponent with statics . \n + Text ; \n - module . exports = ( ( TextToExport : any ) : React . AbstractComponent < \n - TextProps , \n - React . ElementRef < HostComponent < TextProps > > , \n - > & \n - TextStatics ) ; \n + module . exports = TextToExport ; \n","Text : Refine Exported Flow Type \n Summary : \n Refines the exported type of ` Text ` so that it is more accurate . \n Instead of ` HostComponent < TextProps > ` ( which is not exactly accurate ) , we use the recently introduced types : ` NativText ` and ` NativeVirtualText ` . \n Changelog : \n [ Changed ] [ General ] - Refined Flow type for ` Text ` component . \n Reviewed By : nadiia \n Differential Revision : D24486720 \n fbshipit - source - id : fad114fd14335933ebc2f7430d7b8b7838b6b523",510
"Libraries \ Text \ Text . js \n + import TextInjection from ' . / TextInjection ' ; \n - Text ; \n + TextInjection . unstable _ Text = = null ? Text : TextInjection . unstable _ Text ; \n new file \n Libraries \ Text \ TextInjection . js \n + / * * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * \n + * @ format \n + * @ flow \n + * / \n + \n + ' use strict ' ; \n + \n + import typeof Text from ' . / Text ' ; \n + \n + export default { \n + unstable _ Text : ( null : ? Text ) , \n + } ; \n","Text : Setup Rewrite Experiment \n Summary : \n Prepares for production experimentation of a reimplementation of the ` Text ` component that uses ` Pressability ` and React Hooks . \n After I validate the new experimental implementation of ` Text ` , I will revert these changes and replace ` Text . js ` with the new implementation . \n Changelog : \n [ Internal ] \n Reviewed By : nadiia , kacieb \n Differential Revision : D24490569 \n fbshipit - source - id : 1ee4af72fcbda1b1d283a81c6bdf3fe67aa17e73",510
"Libraries \ Components \ Touchable \ TouchableBounce . js \n - onLongPress : event = > { \n - if ( this . props . onLongPress ! = null ) { \n - this . props . onLongPress ( event ) ; \n - } \n - } , \n + onLongPress : this . props . onLongPress , \n Libraries \ Components \ Touchable \ TouchableHighlight . js \n - onLongPress : event = > { \n - if ( this . props . onLongPress ! = null ) { \n - this . props . onLongPress ( event ) ; \n - } \n - } , \n + onLongPress : this . props . onLongPress , \n","RN : Fix TouchableHighlight w / o ` onLongPress ` \n Summary : \n When ` TouchableHighlight ` was migrated to use ` Pressability ` , a bug was introduced due to ` onLongPress ` being unconditionally supplied as a callback . This bug leads to ` onPress ` not firing if the element is pressed for longer than 500ms , even when ` onLongPress ` is not supplied . \n Closes # 29040 . \n Changelog : \n [ General ] [ Fixed ] - TouchableHighlight fires ` onPress ` when pressed for > 500ms , when ` onLongPress ` is not supplied . \n Reviewed By : TheSavior \n Differential Revision : D23664365 \n fbshipit - source - id : 3a0e92e276871eedd303888346a13433be15ac47",510
"Libraries \ Core \ Timers \ JSTimers . js \n - const Platform = require ( ' . . / . . / Utilities / Platform ' ) ; \n - const MAX _ TIMER _ DURATION _ MS = 60 * 1000 ; \n - const IS _ ANDROID = Platform . OS = = = ' android ' ; \n - const ANDROID _ LONG _ TIMER _ MESSAGE = \n - ' Setting a timer for a long period of time , i . e . multiple minutes , is a ' + \n - ' performance and correctness issue on Android as it keeps the timer ' + \n - ' module awake , and timers can only be called when the app is in the foreground . ' + \n - ' See https : / / github . com / facebook / react - native / issues / 12981 for more info . ' ; \n - \n - if ( _ _ DEV _ _ & & IS _ ANDROID & & duration > MAX _ TIMER _ DURATION _ MS ) { \n - console . warn ( \n - ANDROID _ LONG _ TIMER _ MESSAGE + \n - ' \ n ' + \n - ' ( Saw setTimeout with duration ' + \n - duration + \n - ' ms ) ' , \n - ) ; \n - } \n - if ( _ _ DEV _ _ & & IS _ ANDROID & & duration > MAX _ TIMER _ DURATION _ MS ) { \n - console . warn ( \n - ANDROID _ LONG _ TIMER _ MESSAGE + \n - ' \ n ' + \n - ' ( Saw setInterval with duration ' + \n - duration + \n - ' ms ) ' , \n - ) ; \n - } \n","RN : Remove Android ` setTimeout ` Warning \n Summary : \n Many third - party libraries ( especially data management and caching ones ) make use of long timeouts . \n There are currently no plans to change ` setTimeout ` on Android to support firing when apps are in the background . In the meantime , this warning is not actionable for developers who are using these frameworks . Their workarounds are to 1 ) deal with the noise in their logs , or 2 ) suppress the warning . \n Changelog : \n [ General ] [ Removed ] - Removed warning on Android for ` setTimeout ` with delays greater than 1 minute . \n Reviewed By : lunaleaps \n Differential Revision : D24964958 \n fbshipit - source - id : 1b40c8ba95d554c29dec74477aa63ea3ef8e4768",510
Libraries \ Text \ TextNativeComponent . js \n + ! global . RN $ Bridgeless & & \n,RN : Suppress RCTVirtualText Warning in Bridgeless \n Summary : \n The ` DummyUIManager ` module warns whenever ` RCTVirtualText ` is initialized . This stops that . \n Changelog : \n [ Internal ] \n Reviewed By : PeteTheHeat \n Differential Revision : D25073194 \n fbshipit - source - id : 8b9052d1cbb9a4defa5efbd110e1a91cd8884c48,510
"Libraries \ Utilities \ registerGeneratedViewConfig . js \n - verifyComponentAttributeEquivalence ( componentName , mergedViewConfig ) ; \n + if ( ! global . RN $ Bridgeless ) { \n + verifyComponentAttributeEquivalence ( componentName , mergedViewConfig ) ; \n + } \n Libraries \ Utilities \ verifyComponentAttributeEquivalence . js \n + \n - function verifyComponentAttributeEquivalence ( \n + export default function verifyComponentAttributeEquivalence ( \n - if ( ! global . RN $ Bridgeless ) { \n - const nativeAttributes = getNativeComponentAttributes ( componentName ) ; \n - \n - [ ' validAttributes ' , ' bubblingEventTypes ' , ' directEventTypes ' ] . forEach ( \n - prop = > { \n - const diffKeys = Object . keys ( \n - lefthandObjectDiff ( nativeAttributes [ prop ] , config [ prop ] ) , \n + const nativeAttributes = getNativeComponentAttributes ( componentName ) ; \n + \n + [ ' validAttributes ' , ' bubblingEventTypes ' , ' directEventTypes ' ] . forEach ( \n + prop = > { \n + const diffKeys = Object . keys ( \n + lefthandObjectDiff ( nativeAttributes [ prop ] , config [ prop ] ) , \n + ) ; \n + \n + if ( diffKeys . length ) { \n + console . error ( \n + ` $ { componentName } generated view config for $ { prop } does not match native , missing : $ { diffKeys . join ( \n + ' ' , \n + ) } ` , \n - \n - if ( diffKeys . length ) { \n - console . error ( \n - ` $ { componentName } generated view config for $ { prop } does not match native , missing : $ { diffKeys . join ( \n - ' ' , \n - ) } ` , \n - ) ; \n - } \n - } , \n - ) ; \n - } \n + } \n + } , \n + ) ; \n - \n - export default verifyComponentAttributeEquivalence ; \n",RN : Move RN $ Bridgeless Check to Registration \n Summary : \n Moves the ` RN $ Bridgeless ` check as part of moving more logic out of the verification function . \n Changelog : \n [ Internal ] \n Reviewed By : ejanzer \n Differential Revision : D25072601 \n fbshipit - source - id : 929230c02a6eaa1b724f7fd2e1a691a7c20c4b11,510
"Libraries \ Components \ ScrollView \ ScrollViewViewConfig . js \n - import type { PartialViewConfig } from ' react - native / Libraries / Renderer / shims / ReactNativeTypes ' ; \n + import type { PartialViewConfig } from ' . . / . . / Renderer / shims / ReactNativeTypes ' ; \n - contentInset : { diff : require ( ' . . / . . / Utilities / differ / pointsDiffer ' ) } , \n - contentOffset : { diff : require ( ' . . / . . / Utilities / differ / pointsDiffer ' ) } , \n + contentInset : { \n + diff : require ( ' . . / . . / Utilities / differ / pointsDiffer ' ) , \n + } , \n + contentOffset : { \n + diff : require ( ' . . / . . / Utilities / differ / pointsDiffer ' ) , \n + } , \n - endFillColor : { process : require ( ' . . / . . / StyleSheet / processColor ' ) } , \n + endFillColor : { \n + process : require ( ' . . / . . / StyleSheet / processColor ' ) , \n + } , \n + inverted : true , \n Libraries \ ReactNative \ getNativeComponentAttributes . js \n - / / ( not yet implemented ) \n + case ' Point ' : \n + return pointsDiffer ; \n ReactAndroid \ src \ main \ java \ com \ facebook \ react \ views \ scroll \ ReactScrollViewManager . java \n - @ ReactProp ( name = "" contentOffset "" ) \n + @ ReactProp ( name = "" contentOffset "" , customType = "" Point "" ) \n","RN : Update ViewConfig for ScrollView \n Summary : \n Updates ` ReactScrollViewManager ` and the ` ViewConfig ` for ` ScrollView ` so that they are equivalent . \n - ` inverted ` was missing . \n - ` contentOffset ` was missing differ on Android . ( However , there does not seem to be any perceivable behavior difference besides the native ` ViewConfig ` being different . ) \n Changelog : \n [ Internal ] \n Reviewed By : JoshuaGross \n Differential Revision : D25084470 \n fbshipit - source - id : 8bea3b7a692c1038819a4147b174583a4faa71e9",510
"Libraries \ ReactPrivate \ ReactNativePrivateInterface . js \n + import { type DangerouslyImpreciseStyleProp } from ' . . / StyleSheet / StyleSheet ' ; \n - get flattenStyle ( ) : flattenStyle { \n + get flattenStyle ( ) : flattenStyle < DangerouslyImpreciseStyleProp > { \n Libraries \ StyleSheet \ StyleSheetTypes . js \n + [ key : string ] : $ Shape < _ _ _ _ DangerouslyImpreciseStyle _ Internal > , \n + \n + export type _ _ _ _ FlattenStyleProp _ Internal < + TStyleProp > = $ Call < \n + < T > ( GenericStyleProp < T > ) = > T , \n + TStyleProp , \n + > ; \n Libraries \ StyleSheet \ flattenStyle . js \n - import type { \n - DangerouslyImpreciseStyle , \n - DangerouslyImpreciseStyleProp , \n - } from ' . / StyleSheet ' ; \n + import type { DangerouslyImpreciseStyleProp } from ' . / StyleSheet ' ; \n + import type { _ _ _ _ FlattenStyleProp _ Internal } from ' . / StyleSheetTypes ' ; \n - function flattenStyle ( \n - style : ? DangerouslyImpreciseStyleProp , \n - ) : ? DangerouslyImpreciseStyle { \n + function flattenStyle < + TStyleProp : DangerouslyImpreciseStyleProp > ( \n + style : ? TStyleProp , \n + ) : ? _ _ _ _ FlattenStyleProp _ Internal < TStyleProp > { \n","RN : Preserve Style Type in ` flattenStyle ` \n Summary : \n Refactors ` flattenStyle ` so that it preserves the style type of the argument . This lets us avoid using ` DangerouslyImpreciseStyleProp ` where we can . \n Changelog : \n [ Internal ] \n Reviewed By : JoshuaGross , nadiia , kacieb \n Differential Revision : D25097227 \n fbshipit - source - id : df6af6fefab25dbb62e3c81897c3cef98619a9c7",510
"Libraries \ NativeComponent \ NativeComponentRegistry . js \n + import UIManager from ' . . / ReactNative / UIManager ' ; \n + import * as React from ' react ' ; \n + * \n + * The provider should return null if the native component is unavailable in \n + * the current environment . \n - runtimeConfigProvider : ( name : string ) = > { native : boolean , verify : boolean } , \n + runtimeConfigProvider : ( \n + name : string , \n + ) = > ? { \n + native : boolean , \n + verify : boolean , \n + } , \n + \n + / * * \n + * Same as ` NativeComponentRegistry . get ( . . . ) ` , except this will check either \n + * the ` setRuntimeConfigProvider ` configuration or use native reflection ( slow ) \n + * to determine whether this native component is available . \n + * \n + * If the native component is not available , a stub component is returned . Note \n + * that the return value of this is not ` HostComponent ` because the returned \n + * component instance is not guaranteed to have native methods . \n + * / \n + export function getWithFallback _ DEPRECATED < Config > ( \n + name : string , \n + viewConfigProvider : ( ) = > PartialViewConfig , \n + ) : React . AbstractComponent < Config > { \n + if ( getRuntimeConfig = = null ) { \n + / / If ` setRuntimeConfigProvider ` is not configured , use native reflection . \n + if ( hasNativeViewConfig ( name ) ) { \n + return get < Config > ( name , viewConfigProvider ) ; \n + } \n + } else { \n + / / If there is no runtime config , then the native component is unavailable . \n + if ( getRuntimeConfig ( name ) ! = null ) { \n + return get < Config > ( name , viewConfigProvider ) ; \n + } \n + } \n + \n + const FallbackNativeComponent = function ( props : Config ) : React . Node { \n + return null ; \n + } ; \n + FallbackNativeComponent . displayName = ` Fallback ( $ { name } ) ` ; \n + return FallbackNativeComponent ; \n + } \n + \n + function hasNativeViewConfig ( name : string ) : boolean { \n + invariant ( getRuntimeConfig = = null , ' Unexpected invocation ! ' ) ; \n + return UIManager . getViewManagerConfig ( name ) ! = null ; \n + } \n jest \ setup . js \n + getWithFallback _ DEPRECATED : jest . fn ( ( name , viewConfigProvider ) = > { \n + return jest . requireActual ( ' . / mockNativeComponent ' ) ( name ) ; \n + } ) , \n","RN : Add ` NativeComponentRegistry . getWithFallback _ DEPRECATED ` \n Summary : \n Creates ` NativeComponentRegistry . getWithFallback _ DEPRECATED ` . This is deprecated from inception because it exists only to support a pattern that should not be necessary . \n For any given ` NativeX ` component , the JavaScript module that calls ` NativeComponentRegistry . get ( ' NativeX ' , … ) ` should only exist in the JavaScript bundle if the native binary actually supports that native component . \n But in today ' s transitional state of the world , there are JavaScript modules that use ` UIManager . getViewManagerConfig ( ' NativeX ' ) ` as a means of feature detection . \n The purpose of ` NativeComponentRegistry . getWithFallback _ DEPRECATED ` is to bridge this transitional gap . Component should migrate toward initializing the ` NativeComponentRegistry ` with a runtime configuration provider that enumerates all supported native components . If the native component is not supported , it should return null . \n Changelog : \n [ Internal ] \n Reviewed By : fkgozali \n Differential Revision : D25109988 \n fbshipit - source - id : 76f7077904594ca63495d8338905c43712ea02e0",510
"Libraries \ vendor \ emitter \ EventEmitter . js \n + import type { EventSubscription } from ' . / EventSubscription ' ; \n + \n - export interface EventSubscription { \n - remove ( ) : void ; \n - } \n + export type { EventSubscription } ; \n new file \n Libraries \ vendor \ emitter \ EventSubscription . js \n + / * * \n + * Copyright ( c ) Facebook , Inc . and its affiliates . \n + * \n + * This source code is licensed under the MIT license found in the \n + * LICENSE file in the root directory of this source tree . \n + * \n + * @ flow strict \n + * @ format \n + * / \n + \n + ' use strict ' ; \n + \n + / / This exists as a separate file only to avoid circular dependencies from \n + / / using this in ` _ EmitterSubscription ` . Combine this back into ` EventEmitter ` \n + / / after migration and cleanup is done . \n + \n + export interface EventSubscription { \n + remove ( ) : void ; \n + } \n Libraries \ vendor \ emitter \ _ EmitterSubscription . js \n - import EventSubscription from ' . / _ EventSubscription ' ; \n + import _ EventSubscription from ' . / _ EventSubscription ' ; \n + import { type EventSubscription } from ' . / EventSubscription ' ; \n - class EmitterSubscription < \n - EventDefinitions : { . . . } , \n - K : $ Keys < EventDefinitions > , \n - > extends EventSubscription < EventDefinitions , K > { \n + class EmitterSubscription < EventDefinitions : { . . . } , K : $ Keys < EventDefinitions > > \n + extends _ EventSubscription < EventDefinitions , K > \n + implements EventSubscription { \n - * Note : we ' re overriding the ` remove ( ) ` method of EventSubscription here \n + * Note : we ' re overriding the ` remove ( ) ` method of _ EventSubscription here \n Libraries \ vendor \ emitter \ _ EventSubscription . js \n + import { type EventSubscription } from ' . / EventSubscription ' ; \n - class EventSubscription < EventDefinitions : { . . . } , K : $ Keys < EventDefinitions > > { \n + class _ EventSubscription < EventDefinitions : { . . . } , K : $ Keys < EventDefinitions > > \n + implements EventSubscription { \n - module . exports = EventSubscription ; \n + module . exports = _ EventSubscription ; \n",RN : Implements ` EventSubscription ` \n Summary : \n Changes the to - be - legacy ` _ EventSubscription ` and ` _ EmitterSubscription ` classes to implement the event - agnostic ` EventSubscription ` interface . \n This interface is valuable because it abstracts away the event definitions . \n Changelog : \n [ Internal ] \n Reviewed By : lunaleaps \n Differential Revision : D26155911 \n fbshipit - source - id : f94280976d4f9219f4780ac8fae0d5fbc1865386,510
"Libraries \ EventEmitter \ NativeEventEmitter . js \n - type NativeEventEmitterOptions = $ ReadOnly < { | \n - _ _ SECRET _ DISABLE _ CALLS _ INTO _ MODULE _ DO _ NOT _ USE _ OR _ YOU _ WILL _ BE _ FIRED : boolean , \n - | } > ; \n - \n - const DEFAULT _ NATIVE _ EVENT _ EMITTER _ OPTIONS = { \n - _ _ SECRET _ DISABLE _ CALLS _ INTO _ MODULE _ DO _ NOT _ USE _ OR _ YOU _ WILL _ BE _ FIRED : false , \n - } ; \n - \n - _ disableCallsIntoModule : boolean ; \n - constructor ( \n - nativeModule : ? NativeModule , \n - options : NativeEventEmitterOptions = DEFAULT _ NATIVE _ EVENT _ EMITTER _ OPTIONS , \n - ) { \n + constructor ( nativeModule : ? NativeModule ) { \n - this . _ disableCallsIntoModule = \n - options . _ _ SECRET _ DISABLE _ CALLS _ INTO _ MODULE _ DO _ NOT _ USE _ OR _ YOU _ WILL _ BE _ FIRED ; \n - if ( this . _ nativeModule ! = null & & ! this . _ disableCallsIntoModule ) { \n + if ( this . _ nativeModule ! = null ) { \n - if ( this . _ nativeModule ! = null & & ! this . _ disableCallsIntoModule ) { \n + if ( this . _ nativeModule ! = null ) { \n - if ( this . _ nativeModule ! = null & & ! this . _ disableCallsIntoModule ) { \n + if ( this . _ nativeModule ! = null ) { \n",RN : Delete ` NativeEventEmitter ` Options \n Summary : \n Removes the ` options ` argument in the ` NativeEventEmitter ` constructor . It was only being used for an experimental flag that is no longer necessary . \n Changelog : \n [ General ] [ Removed ] - Removed second optional argument of ` NativeEventEmitter ` constructor \n Reviewed By : RSNara \n Differential Revision : D26138239 \n fbshipit - source - id : 0481ce44f0464668e3a6e7ffaf079d17c87afd42,510
"Libraries \ Text \ TextNativeComponent . js \n + android _ hyphenationFrequency : true , \n",Text : Restore ` android _ hyphenationFrequency ` \n Summary : \n Restore the ` android _ hyphenationFrequency ` attribute in the view config for ` Text ` . This was accidentally dropped by D23708205 ( https : / / github . com / facebook / react - native / commit / 06ce64356594a921cd9ae4f71c15dd56dd0e53a3 ) ( 06ce64356594a921cd9ae4f71c15dd56dd0e53a3 ) . \n Changelog : \n [ Android ] [ Fixed ] - Restore ` android _ hyphenationFrequency ` on ` Text ` . \n Reviewed By : mdvacca \n Differential Revision : D25889971 \n fbshipit - source - id : 622eef618370efdd9a8b060ccd3272e25de218fa,510
"Libraries \ Linking \ Linking . js \n + import { type EventSubscription } from ' . . / vendor / emitter / EventEmitter ' ; \n - ) : void { \n - this . addListener ( eventType , listener ) ; \n - } \n - \n - / * * \n - * Remove a handler by passing the ` url ` event type and the handler . \n - * \n - * See https : / / reactnative . dev / docs / linking . html # removeeventlistener \n - * / \n - removeEventListener < K : $ Keys < LinkingEventDefinitions > > ( \n - eventType : K , \n - listener : ( . . . $ ElementType < LinkingEventDefinitions , K > ) = > mixed , \n - ) : void { \n - this . removeListener ( eventType , listener ) ; \n + ) : EventSubscription { \n + return this . addListener ( eventType , listener ) ; \n","RN : Delete ` Linking . removeEventListener ` \n Summary : \n Deletes ` Linking . removeEventListener ` in favor of returning the ` EventSubscription ` returned by ` NativeEventEmitter . addListener ` . \n Changelog : \n [ General ] [ Added ] - ` Linking . addEventListener ` now returns a subscription with a ` remove ( ) ` method . \n [ General ] [ Removed ] - Removed ` Linking . removeEventListener ` . Instead , call ` remove ( ) ` on the subscription returned by ` Linking . addEventListener ` . \n Reviewed By : rubennorte , wtfil \n Differential Revision : D26155896 \n fbshipit - source - id : 1176ec6eae1c0fff2d68acf5411a18da530b212a",510
"Libraries \ EventEmitter \ RCTDeviceEventEmitter . js \n - function checkNativeEventModule ( eventType : ? string ) { \n - if ( eventType ) { \n - if ( eventType . lastIndexOf ( ' statusBar ' , 0 ) = = = 0 ) { \n - throw new Error ( \n - ' ` ' + \n - eventType + \n - ' ` event should be registered via the StatusBarIOS module ' , \n - ) ; \n - } \n - if ( eventType . lastIndexOf ( ' keyboard ' , 0 ) = = = 0 ) { \n - throw new Error ( \n - ' ` ' + \n - eventType + \n - ' ` event should be registered via the Keyboard module ' , \n - ) ; \n - } \n - if ( eventType = = = ' appStateDidChange ' | | eventType = = = ' memoryWarning ' ) { \n - throw new Error ( \n - ' ` ' + \n - eventType + \n - ' ` event should be registered via the AppState module ' , \n - ) ; \n - } \n - } \n - } \n - \n - addListener < K : $ Keys < EventDefinitions > > ( \n - eventType : K , \n - listener : ( . . . $ ElementType < EventDefinitions , K > ) = > mixed , \n - context : $ FlowFixMe , \n - ) : EmitterSubscription < EventDefinitions , K > { \n - if ( _ _ DEV _ _ ) { \n - checkNativeEventModule ( eventType ) ; \n - } \n - return super . addListener ( eventType , listener , context ) ; \n - } \n - \n - removeAllListeners < K : $ Keys < EventDefinitions > > ( eventType : ? K ) : void { \n - if ( _ _ DEV _ _ ) { \n - checkNativeEventModule ( eventType ) ; \n - } \n - super . removeAllListeners ( eventType ) ; \n - } \n - \n","RN : Remove ` RCTDeviceEventEmitter ` Checks \n Summary : \n Removes the checks in ` RCTDeviceEventEmitter ` that were initially added to migrate call sites to other modules when ` NativeEventEmitter ` was introduced . \n This set of checks is problematic for a few reasons : \n 1 . Does not cover many other events that have since been introduced , so the small list covered is arbitrary . \n 2 . Prevents composition of ` RCTDeviceEventEmitter ` in the implementation of those modules . \n 3 . Code bloat . \n Changelog : \n [ General ] [ Removed ] - ` RCTDeviceEventEmitter ` no longer throws for ` SttatusBar ` , ` Keyboard ` , and ` AppState ` events . However , you are still recommended to use the more appropriate modules for listening to these events . \n Reviewed By : lunaleaps \n Differential Revision : D26163602 \n fbshipit - source - id : 316287bfdf2947fe85d022a3f83a205e89c432ba",510
"Libraries \ Inspector \ Inspector . js \n - node . measure ( ( x , y , width , height , left , top ) = > { \n + / / Shape of ` node ` is different in Fabric . \n + const component = node . canonical ? ? node ; \n + \n + component . measure ( ( x , y , width , height , left , top ) = > { \n",Fabric : Fix DevTools Inspector \n Summary : \n Fixes a bug when using Fabric with React DevTools to inspect a component . \n The bug is due to the shape of instances being a bit different . These are where Paper and Fabric create instances differently : \n - Paper : [ ReactNativeHostConfig . js ] ( https : / / github . com / facebook / react / blob / aa736a0fa6e22f902bd7a98dcb9b24d8c4310e35 / packages / react - native - renderer / src / ReactNativeHostConfig . js # L138 ) \n - Fabric : [ ReactFabricHostConfig . js ] ( https : / / github . com / facebook / react / blob / aa736a0fa6e22f902bd7a98dcb9b24d8c4310e35 / packages / react - native - renderer / src / ReactFabricHostConfig . js # L218 - L236 ) \n Changelog : \n [ Internal ] \n Reviewed By : TheSavior \n Differential Revision : D26265476 \n fbshipit - source - id : dfc510dc3854e1478d20a4c612237b1c2da608eb,510
"Libraries \ LogBox \ UI \ LogBoxInspectorStackFrames . js \n - const [ collapsed , setCollapsed ] = React . useState ( true ) ; \n + const [ collapsed , setCollapsed ] = React . useState ( ( ) = > { \n + / / Only collapse frames initially if some frames are not collapsed . \n + return props . log . getAvailableStack ( ) . some ( ( { collapse } ) = > ! collapse ) ; \n + } ) ; \n","LogBox : Intelligently Un - Collapse Stack Frames \n Summary : \n Tweaks LogBox so that if all stack frames are collapsed , start off without collapsing any of them . \n It saves developers from one extra interaction to make the LogBox actually useful for errors where every frame is ignored . \n Changelog : \n [ General ] [ Changed ] - LogBox will not initially collapse stack frames if every frame would be collapsed . \n Differential Revision : D26266195 \n fbshipit - source - id : dcdbe0834da5fc3a0bf49fb7857de30dd7e4b8cb",510
"Libraries \ Components \ Keyboard \ Keyboard . js \n - import type EmitterSubscription from ' . . / . . / vendor / emitter / _ EmitterSubscription ' ; \n + import { type EventSubscription } from ' . . / . . / vendor / emitter / EventEmitter ' ; \n - class Keyboard extends NativeEventEmitter < KeyboardEventDefinitions > { \n - constructor ( ) { \n - super ( NativeKeyboardObserver ) ; \n - } \n + class Keyboard { \n + _ emitter : NativeEventEmitter < KeyboardEventDefinitions > = new NativeEventEmitter ( \n + NativeKeyboardObserver , \n + ) ; \n - context : $ FlowFixMe , \n - ) : EmitterSubscription < KeyboardEventDefinitions , K > { \n - return super . addListener ( eventType , listener ) ; \n - } \n - \n - / * * \n - * Removes a specific listener . \n - * \n - * @ param { string } eventName The ` nativeEvent ` is the string that identifies the event you ' re listening for . \n - * @ param { function } callback function to be called when the event fires . \n - * / \n - removeListener < K : $ Keys < KeyboardEventDefinitions > > ( \n - eventType : K , \n - listener : ( . . . $ ElementType < KeyboardEventDefinitions , K > ) = > mixed , \n - ) : void { \n - super . removeListener ( eventType , listener ) ; \n + context ? : mixed , \n + ) : EventSubscription { \n + return this . _ emitter . addListener ( eventType , listener ) ; \n - super . removeAllListeners ( eventType ) ; \n + this . _ emitter . removeAllListeners ( eventType ) ; \n Libraries \ Components \ Keyboard \ _ _ tests _ _ \ Keyboard - test . js \n - const NativeModules = require ( ' . . / . . / . . / BatchedBridge / NativeModules ' ) ; \n - import NativeEventEmitter from ' . . / . . / . . / EventEmitter / NativeEventEmitter ' ; \n - \n - it ( ' exposes KeyboardEventEmitter methods ' , ( ) = > { \n - const KeyboardObserver = NativeModules . KeyboardObserver ; \n - const KeyboardEventEmitter = new NativeEventEmitter ( KeyboardObserver ) ; \n - \n - / / $ FlowFixMe \n - expect ( Keyboard . _ subscriber ) . toBe ( KeyboardEventEmitter . _ subscriber ) ; \n - / / $ FlowFixMe Cannot access private property \n - expect ( Keyboard . _ nativeModule ) . toBe ( KeyboardEventEmitter . _ nativeModule ) ; \n - } ) ; \n - \n","RN : Simplify ` Keyboard ` \n Summary : \n Simplifies ` Keyboard ` by removing redundant methods and changing ` addEventListener ` to return an ` EventSubscription ` . \n Changelog : \n [ General ] [ Changed ] - ` Keyboard . addListener ` now returns an ` EventSubscription ` object . \n [ General ] [ Removed ] - Removed ` Keyboard . removeListener ` . Instead , use the ` remove ( ) ` method on the object returned by ` Keyboard . addListener ` . \n [ General ] [ Removed ] - ` Keyboard ` no longer inherits from ` NativeEventEmitter ` , so it no longer implements ` removeAllListeners ` , and ` removeSubscription ` . \n Reviewed By : milroc \n Differential Revision : D26163536 \n fbshipit - source - id : b4bd91627cd027a13fcba269a253823913eb7589",510
gdx \ src \ com \ badlogic \ gdx \ graphics \ g3d \ decals \ DecalMaterial . java \n - textureRegion . getTexture ( ) . bind ( ) ; \n + textureRegion . getTexture ( ) . bind ( 0 ) ; \n,"Decal Material binds to texture unit 0 , closes # 4024",515
"backends \ gdx - backend - lwjgl3 \ src \ com \ badlogic \ gdx \ backends \ lwjgl3 \ Lwjgl3Graphics . java \n - GLFW . glfwSetWindowMonitor ( window . getWindowHandle ( ) , currentMode . getMonitor ( ) , \n + GLFW . glfwSetWindowMonitor ( window . getWindowHandle ( ) , 0 , \n","Revert "" Fixes # 4322 : Restore window on correct monitor "" ( # 4324 )",515
extensions \ gdx - setup \ src \ com \ badlogic \ gdx \ setup \ resources \ android \ build . gradle \n + packagingOptions { \n + exclude ' META - INF / robovm / ios / robovm . xml ' \n + } \n,Add exclusion of robovm . xml for fat jars \n Adds an exclusion of robovm . xml for the android sub project to avoid conflicts due to the android gradle plugin and non platform specific dependencies that support robovm .,515
"backends \ gdx - backend - android \ src \ com \ badlogic \ gdx \ backends \ android \ AndroidFiles . java \n + import android . app . Activity ; \n + import android . app . Fragment ; \n + import android . content . Context ; \n + Context context ; \n + if ( Gdx . app instanceof Activity ) { \n + context = ( ( Activity ) Gdx . app ) . getBaseContext ( ) ; \n + } else if ( Gdx . app instanceof Fragment ) { \n + context = ( ( Fragment ) Gdx . app ) . getActivity ( ) . getBaseContext ( ) ; \n + } else { \n + throw new GdxRuntimeException ( "" APK expansion not supported for application type "" ) ; \n + } \n - ( ( AndroidApplication ) Gdx . app ) . getBaseContext ( ) , \n + context , \n",Allow apk expansion to be used with fragments also . Fixes # 4787,515
"gdx \ src \ com \ badlogic \ gdx \ graphics \ g2d \ SpriteCache . java \n + if ( drawing ) throw new IllegalStateException ( "" end must be called before beginCache "" ) ; \n + if ( drawing ) throw new IllegalStateException ( "" end must be called before beginCache "" ) ; \n + if ( currentCache ! = null ) throw new IllegalStateException ( "" endCache must be called before begin "" ) ; \n","Prevent nesting of beginCache and begin , fixes # 4781",515
gdx \ src \ com \ badlogic \ gdx \ graphics \ Mesh . java \n - result . setIndices ( indices ) ; \n + if ( indices ! = null ) result . setIndices ( indices ) ; \n,Check for 0 indices before attempting to set on copy . Fixes # 4775,515
"backends \ gdx - backend - moe \ src \ com \ badlogic \ gdx \ backends \ iosmoe \ IOSGraphics . java \n + import com . badlogic . gdx . backends . iosmoe . custom . HWMachine ; \n - / / String machineString = HWMachine . getMachineString ( ) ; \n - IOSDevice device = null ; / / IOSDevice . getDevice ( machineString ) ; \n - / / if ( device = = null ) \n - / / app . error ( tag , "" Machine ID : "" + machineString + "" not found , please report to LibGDX "" ) ; \n + String machineString = HWMachine . getMachineString ( ) ; \n + IOSDevice device = IOSDevice . getDevice ( machineString ) ; \n + if ( device = = null ) \n + app . error ( tag , "" Machine ID : "" + machineString + "" not found , please report to LibGDX "" ) ; \n backends \ gdx - backend - moe \ src \ com \ badlogic \ gdx \ backends \ iosmoe \ custom \ HWMachine . java \n + import org . moe . natj . c . StructObject ; \n + import org . moe . natj . general . ptr . NUIntPtr ; \n - public static native int sysctlbyname ( @ UncertainArgument ( "" Options : java . string , c . const - byte - ptr Fallback : java . string "" ) String name , \n - VoidPtr oldp , IntPtr oldlenp , VoidPtr newp , int newlen ) ; \n + public static native int sysctlbyname ( BytePtr name , VoidPtr oldp , \n + NUIntPtr oldlenp , VoidPtr newp , long newlen ) ; \n - IntPtr sizePtr = PtrFactory . newIntPtr ( BufferUtils . newIntBuffer ( 1 ) ) ; \n - sysctlbyname ( name , null , sizePtr , null , 0 ) ; \n - BytePtr machine = PtrFactory . newBytePtr ( sizePtr . get ( ) , true , true ) ; \n - sysctlbyname ( name , machine , sizePtr , null , 0 ) ; \n - return machine . toUTF8String ( ) ; \n + BytePtr namePtr = PtrFactory . newByteArray ( name . getBytes ( ) ) ; \n + NUIntPtr sizePtr = PtrFactory . newNUIntReference ( ) ; \n + sysctlbyname ( namePtr , null , sizePtr , null , 0 ) ; \n + long longsize = sizePtr . get ( ) ; \n + BytePtr machinePtr = PtrFactory . newByteReference ( ) ; \n + machinePtr . setValue ( ( byte ) longsize ) ; \n + sysctlbyname ( namePtr , machinePtr , sizePtr , null , 0 ) ; \n + return machinePtr . toUTF8String ( ) ; \n",Add back in device lookup support for MOE fixes # 4755,515
"backends \ gdx - backend - robovm \ build - objectal . sh \n - xcodebuild - project $ XCODEPROJ - arch arm64 - sdk iphoneos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / arm64 OTHER _ CFLAGS = "" - fembed - bitcode - miphoneos - version - min = 6 . 0 "" \n + xcodebuild - project $ XCODEPROJ - arch arm64 - sdk iphoneos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / arm64 OTHER _ CFLAGS = "" - fembed - bitcode - target arm64 - apple - ios9 . 0 . 0 "" \n - xcodebuild - project $ XCODEPROJ - arch x86 _ 64 - sdk iphonesimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / x86 _ 64 OTHER _ CFLAGS = "" - miphoneos - version - min = 6 . 0 "" \n - xcodebuild - project $ XCODEPROJ - arch arm64 - sdk appletvos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / tvos - arm64 OTHER _ CFLAGS = "" - fembed - bitcode - mtvos - version - min = 9 . 0 "" \n - xcodebuild - project $ XCODEPROJ - arch x86 _ 64 - sdk appletvsimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / tvos - x86 _ 64 OTHER _ CFLAGS = "" - mtvos - version - min = 9 . 0 "" \n + xcodebuild - project $ XCODEPROJ - arch x86 _ 64 - sdk iphonesimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / x86 _ 64 OTHER _ CFLAGS = "" - target x86 _ 64 - apple - ios9 . 0 . 0 "" \n + xcodebuild - project $ XCODEPROJ - arch arm64 - sdk appletvos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / tvos - arm64 OTHER _ CFLAGS = "" - fembed - bitcode - target arm64 - apple - tvos9 . 0 . 0 "" \n + xcodebuild - project $ XCODEPROJ - arch x86 _ 64 - sdk appletvsimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / tvos - x86 _ 64 OTHER _ CFLAGS = "" - target x86 _ 64 - apple - tvos9 . 0 . 0 "" \n",Try llvm triple for defining min targets . \n Bump to min of ios 9 . 0 . 0,515
"backends \ gdx - backend - robovm \ build - objectal . sh \n - xcodebuild - project $ XCODEPROJ - arch armv7 - sdk iphoneos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / armv7 OTHER _ CFLAGS = "" - fembed - bitcode - miphoneos - version - min = 6 . 0 "" \n + # xcodebuild - project $ XCODEPROJ - arch armv7 - sdk iphoneos CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / armv7 OTHER _ CFLAGS = "" - fembed - bitcode - miphoneos - version - min = 6 . 0 "" \n - xcodebuild - project $ XCODEPROJ - arch i386 - sdk iphonesimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / i386 OTHER _ CFLAGS = "" - miphoneos - version - min = 6 . 0 "" \n + # xcodebuild - project $ XCODEPROJ - arch i386 - sdk iphonesimulator CONFIGURATION _ BUILD _ DIR = $ BUILD _ DIR / i386 OTHER _ CFLAGS = "" - miphoneos - version - min = 6 . 0 "" \n",disable 32 bit ios objectal build for now,515
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryActionConditionTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65048 "" ) \n",[ TEST ] Mute HistoryActionConditionTests . testActionConditionWithFailures # 65049 \n Relates # 65048,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryTemplateEmailMappingsTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65052 "" ) \n",[ TEST ] Mute HistoryTemplateEmailMappingsTests . testEmailFields # 65053 \n Relates # 65052,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ test \ integration \ SingleNodeTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 54096 "" ) \n",[ TEST ] Mute SingleNodeTest . testThatLoadingWithNonExistingIndexWorks # 65058 \n Relates # 54096,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryActionConditionTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65064 "" ) \n",[ TEST ] Mute HistoryActionConditionTests . testActionCondition # 65066 \n Relates # 65064,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ actions \ webhook \ WebhookIntegrationTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65063 "" ) \n",[ TEST ] Mute WebhookIntegrationTests . testWebhook # 65068 \n Relates # 65063,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ test \ integration \ ExecutionVarsIntegrationTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65086 "" ) \n",[ TEST ] Mute ExecutionVarsIntegrationTests . testVars ( # 65088 ) \n Relates # 65086,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryTemplateTimeMappingsTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65089 "" ) \n",[ TEST ] Mute HistoryTemplateTimeMappingsTests . testTimeFields ( # 65090 ) \n Relates # 65089,519
"x - pack \ plugin \ watcher \ src \ internalClusterTest \ java \ org \ elasticsearch \ xpack \ watcher \ history \ HistoryTemplateIndexActionMappingsTests . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 65091 "" ) \n",[ TEST ] Mute HistoryTemplateIndexActionMappingsTests . testIndexActionFields ( # 65092 ) \n Relates # 65091,519
"x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ mixed _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 68099 "" \n + \n - - - \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ old _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 68099 "" \n - do : \n x - pack \ qa \ rolling - upgrade \ src \ test \ resources \ rest - api - spec \ test \ upgraded _ cluster \ 90 _ ml _ data _ frame _ analytics _ crud . yml \n + setup : \n + - skip : \n + version : "" all "" \n + reason : "" Until backport of https : / / github . com / elastic / elasticsearch / pull / 68099 "" \n + \n - - - \n",[ ML ] Mute data frame analytics BWC tests ( # 68269 ) \n Until # 68099 is backported to 7 . x .,519
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ ClassificationIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67581 "" ) \n x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RegressionIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67581 "" ) \n",[ TEST ] Mute ClassificationIT . testStopAndRestart and RegressionIT . testStopAndRestart ( # 67885 ),519
"x - pack \ plugin \ transform \ qa \ multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ transform \ integration \ continuous \ HistogramGroupByIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67887 "" ) \n",[ TEST ] Mute HistogramGroupByIT ( # 67888 ),519
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RunDataFrameAnalyticsIT . java \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67889 "" ) \n",[ TEST ] Mute RunDataFrameAnalyticsIT . testOutlierDetectionStopAndRestart ( # 67890 ),519
"x - pack \ plugin \ transform \ qa \ multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ transform \ integration \ continuous \ HistogramGroupByIT . java \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67887 "" ) \n","Revert "" [ TEST ] Mute HistogramGroupByIT ( # 67888 ) "" ( # 67894 ) \n This reverts commit 8b88568cd58622ce927bf630c6daa0781a2bc06d .",519
"x - pack \ plugin \ transform \ qa \ multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ transform \ integration \ continuous \ HistogramGroupByIT . java \n + import org . apache . lucene . util . LuceneTestCase . AwaitsFix ; \n + @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 67887 "" ) \n",[ TEST ] Mute HistogramGroupByIT ( # 67897 ),519
"x - pack \ plugin \ ml \ qa \ native - multi - node - tests \ src \ javaRestTest \ java \ org \ elasticsearch \ xpack \ ml \ integration \ RegressionIT . java \n + @ Before \n + public void setupLogging ( ) { \n + client ( ) . admin ( ) . cluster ( ) \n + . prepareUpdateSettings ( ) \n + . setTransientSettings ( Settings . builder ( ) \n + . put ( "" logger . org . elasticsearch . xpack . ml . process . logging . CppLogMessageHandler "" , "" DEBUG "" ) ) \n + . get ( ) ; \n + } \n + client ( ) . admin ( ) . cluster ( ) \n + . prepareUpdateSettings ( ) \n + . setTransientSettings ( Settings . builder ( ) \n + . putNull ( "" logger . org . elasticsearch . xpack . ml . process . logging . CppLogMessageHandler "" ) ) \n + . get ( ) ; \n - @ AwaitsFix ( bugUrl = "" https : / / github . com / elastic / elasticsearch / issues / 60340 "" ) \n",[ ML ] Unmute RegressionIT . testSingleNumericFeatureAndMixedTrainingAndNonTrainingRows ( # 67904 ) \n Besides unmuting the test I added debug - level logging to facilitate finding the root cause of the test failure .,519
"core \ java \ android \ text \ format \ Time . java \n + import com . android . i18n . timezone . WallTime ; \n - public final ZoneInfoData . WallTime wallTime ; \n + public final WallTime wallTime ; \n - this . wallTime = new ZoneInfoData . WallTime ( ) ; \n + this . wallTime = new WallTime ( ) ; \n core \ java \ android \ text \ format \ TimeFormatter . java \n + import com . android . i18n . timezone . WallTime ; \n - public String format ( String pattern , ZoneInfoData . WallTime wallTime , \n + public String format ( String pattern , WallTime wallTime , \n - private void formatInternal ( String pattern , ZoneInfoData . WallTime wallTime , \n + private void formatInternal ( String pattern , WallTime wallTime , \n - private boolean handleToken ( CharBuffer formatBuffer , ZoneInfoData . WallTime wallTime , \n + private boolean handleToken ( CharBuffer formatBuffer , WallTime wallTime , \n",Move WallTime out of ZoneInfoData \n Bug : 139480281 \n Test : m droid \n Change - Id : I4a81bb45e874480c7d1dd5f7736b529344d8d9fa,525
"new file \n core \ tests \ coretests \ src \ android \ text \ format \ OWNERS \n + # Inherits OWNERS from parent directory , plus the following \n + \n + vichang @ google . com \n",Add owner file to unit test folder for android . text . format \n same owners as core / java / android / text / format / OWNERS \n Test : treehugger \n Change - Id : I98565ac6ece872804e7b9269096c8bcabc29e067,525
"Android . bp \n + "" icu4j - platform - compat - config "" , \n core \ java \ android \ timezone \ TzDataSetVersion . java \n + import com . android . i18n . timezone . TimeZoneDataFiles ; \n - return new TzDataSetVersion ( \n - com . android . i18n . timezone . TzDataSetVersion . readTimeZoneModuleVersion ( ) ) ; \n + return new TzDataSetVersion ( TimeZoneDataFiles . readTimeZoneModuleVersion ( ) ) ; \n",Add app compat config from ICU4J \n Bug : 139480281 \n Bug : 171979766 \n Test : device boots \n Change - Id : Ib2065368e2c5e0904c229c9383bc774269a0f410,525
core \ java \ android \ app \ ActivityThread . java \n + import dalvik . system . AppSpecializationHooks ; \n + / / Let libcore handle any compat changes after installing the list of compat changes . \n + AppSpecializationHooks . handleCompatChangesBeforeBindingApplication ( ) ; \n + \n,Remove android . icu . impl . ICUBinary . dataPath for apps targeting S + \n Bug : 139480281 \n Bug : 171979766 \n Test : ZygoteHooksTest \n Change - Id : Ic25e240fbcedc08f9de799c025841e88f521d0bf,525
"services \ core \ java \ com \ android \ server \ hdmi \ HdmiCecController . java \n + import android . icu . util . IllformedLocaleException ; \n + import android . icu . util . ULocale ; \n + import com . android . internal . annotations . VisibleForTesting ; \n - import sun . util . locale . LanguageTag ; \n - \n - if ( ! LanguageTag . isLanguage ( language ) ) { \n + if ( ! isLanguage ( language ) ) { \n + / * * \n + * Returns true if the language code is well - formed . \n + * / \n + @ VisibleForTesting static boolean isLanguage ( String language ) { \n + / / Handle null and empty string because because ULocale . Builder # setLanguage accepts them . \n + if ( language = = null | | language . isEmpty ( ) ) { \n + return false ; \n + } \n + \n + ULocale . Builder builder = new ULocale . Builder ( ) ; \n + try { \n + builder . setLanguage ( language ) ; \n + return true ; \n + } catch ( IllformedLocaleException e ) { \n + return false ; \n + } \n + } \n + \n services \ tests \ servicestests \ src \ com \ android \ server \ hdmi \ HdmiCecControllerTest . java \n + import static junit . framework . Assert . assertFalse ; \n + import static junit . framework . Assert . assertTrue ; \n + \n + @ Test \n + public void testIsLanguage ( ) { \n + assertTrue ( HdmiCecController . isLanguage ( "" en "" ) ) ; \n + assertTrue ( HdmiCecController . isLanguage ( "" eng "" ) ) ; \n + assertTrue ( HdmiCecController . isLanguage ( "" ger "" ) ) ; \n + assertTrue ( HdmiCecController . isLanguage ( "" zh "" ) ) ; \n + assertTrue ( HdmiCecController . isLanguage ( "" zhi "" ) ) ; \n + assertTrue ( HdmiCecController . isLanguage ( "" zho "" ) ) ; \n + \n + assertFalse ( HdmiCecController . isLanguage ( null ) ) ; \n + assertFalse ( HdmiCecController . isLanguage ( "" "" ) ) ; \n + assertFalse ( HdmiCecController . isLanguage ( "" e "" ) ) ; \n + assertFalse ( HdmiCecController . isLanguage ( "" 一 "" ) ) ; / / language code must be ASCII \n + } \n","Replace LanguageTag . isLanguage with public API \n Libcore will be modulized and updatable , and thus \n avoid using libcore ' s private API . \n No behavior change . \n Bug : 154796679 \n Test : HdmiCecControllerTest # testIsLanguage \n Merged - In : If9cc4df26182141d292a218a5f4cba442e802309 \n Change - Id : If9cc4df26182141d292a218a5f4cba442e802309",525
"core \ java \ android \ content \ res \ ResourcesImpl . java \n - return Locale . adjustLanguageCode ( language ) + remainder ; \n + / / No need to convert to lower cases because the language in the return value of \n + / / Locale . toLanguageTag has been lower - cased . \n + final String adjustedLanguage ; \n + switch ( language ) { \n + case "" id "" : \n + adjustedLanguage = "" in "" ; \n + break ; \n + case "" yi "" : \n + adjustedLanguage = "" ji "" ; \n + break ; \n + case "" he "" : \n + adjustedLanguage = "" iw "" ; \n + break ; \n + default : \n + adjustedLanguage = language ; \n + break ; \n + } \n + return adjustedLanguage + remainder ; \n",Replace Locale # adjustLanguageCode with its own implementation \n No known behavior change . \n Bug : 154796679 \n Test : treehugger \n Merged - In : I474ad621b84da9f7cc7961def6d6751925577d41 \n Change - Id : I474ad621b84da9f7cc7961def6d6751925577d41,525
"core \ api \ current . txt \n - field public static final java . util . regex . Pattern IP _ ADDRESS ; \n + field @ Deprecated public static final java . util . regex . Pattern IP _ ADDRESS ; \n core \ java \ android \ util \ Patterns . java \n + "" [ 0 - 9 ] | [ 0 - 1 ] [ 0 - 9 ] { 2 } | [ 1 - 9 ] [ 0 - 9 ] | [ 1 - 9 ] | 0 ) \ \ . ( 25 [ 0 - 5 ] | 2 [ 0 - 4 ] [ 0 - 9 ] | [ 0 - 1 ] "" \n + "" [ 0 - 9 ] { 2 } | [ 1 - 9 ] [ 0 - 9 ] | [ 1 - 9 ] | 0 ) \ \ . ( 25 [ 0 - 5 ] | 2 [ 0 - 4 ] [ 0 - 9 ] | [ 0 - 1 ] [ 0 - 9 ] { 2 } "" \n + "" | [ 1 - 9 ] [ 0 - 9 ] | [ 0 - 9 ] ) ) "" ; \n + \n + / * * \n + * Kept for backward compatibility reasons . It does not match IPv6 addresses . \n + * \n + * @ deprecated Please use { @ link android . net . InetAddresses # isNumericAddress ( String ) } instead . \n + * / \n + @ Deprecated \n",Deprecate Patterns . IP _ ADDRESS \n Bug : 165470548 \n Test : n / a \n Change - Id : Ic1e188ea118c87514815ec9581bb158ab66e22e4,525
"core \ tests \ coretests \ src \ android \ text \ format \ DateIntervalFormatTest . java \n - assertEquals ( "" lun . , 19 de ene . – jue . , 22 de ene . de 2009 "" , \n + assertEquals ( "" lun , 19 de ene . – jue , 22 de ene . de 2009 "" , \n - assertEquals ( "" lun . , 19 de ene . – mié . , 22 de abr . de 2009 "" , \n + assertEquals ( "" lun , 19 de ene . – mié , 22 de abr . de 2009 "" , \n - assertEquals ( "" 19–22 ene . 2009 "" , formatDateRange ( es _ ES , tz , fixedTime , fixedTime + 3 * DAY , \n + assertEquals ( "" 19–22 ene 2009 "" , formatDateRange ( es _ ES , tz , fixedTime , fixedTime + 3 * DAY , \n - assertEquals ( "" lun . , 19 ene . – jue . , 22 ene . 2009 "" , \n + assertEquals ( "" lun , 19 ene – jue , 22 ene 2009 "" , \n - assertEquals ( "" 19 ene . – 22 abr . 2009 "" , \n + assertEquals ( "" 19 ene – 22 abr 2009 "" , \n - assertEquals ( "" lun . , 19 ene . – mié . , 22 abr . 2009 "" , \n + assertEquals ( "" lun , 19 ene – mié , 22 abr 2009 "" , \n - assertEquals ( "" 19 ene . 2009 – 9 feb . 2012 "" , \n + assertEquals ( "" 19 ene 2009 – 9 feb 2012 "" , \n - assertEquals ( "" ene . 2009 – feb . 2012 "" , \n + assertEquals ( "" ene 2009 – feb 2012 "" , \n core \ tests \ coretests \ src \ android \ text \ format \ FormatterTest . java \n - assertEquals ( "" 1 мин . "" , Formatter . formatShortElapsedTimeRoundingUpToMinutes ( \n + assertEquals ( "" 1 мин "" , Formatter . formatShortElapsedTimeRoundingUpToMinutes ( \n core \ tests \ coretests \ src \ android \ text \ format \ RelativeDateTimeFormatterTest . java \n - assertEquals ( "" D à T "" , icuFormatter . combineDateAndTime ( "" D "" , "" T "" ) ) ; \n + assertEquals ( "" D , T "" , icuFormatter . combineDateAndTime ( "" D "" , "" T "" ) ) ; \n - assertEquals ( "" D ' x ' à T { 0 } "" , icuFormatter . combineDateAndTime ( "" D ' x ' "" , "" T { 0 } "" ) ) ; \n + assertEquals ( "" D ' x ' , T { 0 } "" , icuFormatter . combineDateAndTime ( "" D ' x ' "" , "" T { 0 } "" ) ) ; \n",Update test expectation due to locale data change in ICU 68 . 2 \n Bug : 160356314 \n Test : atest FrameworksCoreTests : android . text . format \n Change - Id : I1c98de411794b9a964236a3bd128e8aaad52da97,525
"packages \ DynamicSystemInstallationService \ res \ values \ strings . xml \n + < ! - - Toast when we fail to disable Dynamic System [ CHAR LIMIT = 128 ] - - > \n + < string name = "" toast _ failed _ to _ disable _ dynsystem "" > Failed to disable dynamic system < / string > \n + \n packages \ DynamicSystemInstallationService \ src \ com \ android \ dynsystem \ DynamicSystemInstallationService . java \n - / / Per current design , we don ' t have disable ( ) API . AOT is disabled on next reboot . \n - / / TODO : Use better status query when b / 125079548 is done . \n + if ( ! mDynSystem . setEnable ( / * enable = * / false , / * oneShot = * / false ) ) { \n + Log . e ( TAG , "" Failed to disable DynamicSystem . "" ) ; \n + \n + / / Dismiss status bar and show a toast . \n + sendBroadcast ( new Intent ( Intent . ACTION _ CLOSE _ SYSTEM _ DIALOGS ) ) ; \n + Toast . makeText ( this , \n + getString ( R . string . toast _ failed _ to _ disable _ dynsystem ) , \n + Toast . LENGTH _ LONG ) . show ( ) ; \n + return ; \n + } \n + \n","Disable DSU in executeRebootToNormalCommand ( ) \n executeRebootToNormalCommand ( ) reboots the device only if DSU is \n successfully disabled , else show a toast describing the failure . \n Bug : 171380622 \n Test : 1 . Install and boot into a DSU \n 2 . adb shell gsi _ tool enable \n 3 . Press "" Restart "" in DSU notification \n 4 . Observe the device reboots back to the original system \n Change - Id : I19b3d09a64282a28ca7b99b441ca93dea45fcce0",543
new file \n packages \ DynamicSystemInstallationService \ OWNERS \n + yochiang @ google . com \n + howardsoc @ google . com \n + pchsueh @ google . com \n,Add OWNERS file for packages / DynamicSystemInstallationService \n Bug : 165925766 \n Test : No \n Change - Id : I816bcfdaa960af08269ae6c864fd2d33b631bedd,543
core \ java \ android \ os \ image \ OWNERS \n + include / packages / DynamicSystemInstallationService / OWNERS \n + \n packages \ DynamicSystemInstallationService \ OWNERS \n - yochiang @ google . com \n + yochiang @ google . com \n services \ core \ java \ com \ android \ server \ OWNERS \n + per - file DynamicSystemService . java = file : / packages / DynamicSystemInstallationService / OWNERS \n,Update OWNERS file for DynamicSystemInstallationService related files \n Also sort OWNERS by alphabetical order . \n Bug : 165925766 \n Test : No \n Change - Id : Ib272ba802d0f7281aa2d1bbc8b74dc5954dbe13c,543
"core \ api \ test - current . txt \n - field public static final String DYNAMIC _ SYSTEM = "" settings _ dynamic _ system "" ; \n core \ java \ android \ util \ FeatureFlagUtils . java \n - public static final String DYNAMIC _ SYSTEM = "" settings _ dynamic _ system "" ; \n - DEFAULT _ FLAGS . put ( DYNAMIC _ SYSTEM , "" false "" ) ; \n packages \ DynamicSystemInstallationService \ src \ com \ android \ dynsystem \ BootCompletedReceiver . java \n - import android . os . SystemProperties ; \n - import android . util . FeatureFlagUtils ; \n - if ( ! isInUse & & ! featureFlagEnabled ( ) ) { \n + if ( ! isInUse ) { \n - \n - private boolean featureFlagEnabled ( ) { \n - return SystemProperties . getBoolean ( \n - FeatureFlagUtils . PERSIST _ PREFIX + FeatureFlagUtils . DYNAMIC _ SYSTEM , false ) ; \n - } \n packages \ DynamicSystemInstallationService \ src \ com \ android \ dynsystem \ VerificationActivity . java \n - import android . os . SystemProperties ; \n - import android . util . FeatureFlagUtils ; \n - if ( ! featureFlagEnabled ( ) ) { \n - Log . w ( TAG , FeatureFlagUtils . DYNAMIC _ SYSTEM + "" not enabled ; activity aborted . "" ) ; \n - finish ( ) ; \n - return ; \n - } \n - \n - private boolean featureFlagEnabled ( ) { \n - return SystemProperties . getBoolean ( \n - FeatureFlagUtils . PERSIST _ PREFIX + FeatureFlagUtils . DYNAMIC _ SYSTEM , false ) ; \n - } \n - \n","Remove feature flag "" settings _ dynamic _ system "" \n The API surface of com . android . dynsystem is already protected by \n privileged permission android . permission . INSTALL _ DYNAMIC _ SYSTEM , \n which is only granted to system apps or priv apps . \n Thus the feature flag check here is redundant , because eligible \n callers of this API ( system app ) can also set the feature flag . \n Bug : 176795908 \n Test : Presubmit \n Test : Test DSU installation Intent \n Change - Id : Iedac8763372ef6f11754d3f272f70753fb3d4829 \n Merged - In : Iedac8763372ef6f11754d3f272f70753fb3d4829",543
packages \ DynamicSystemInstallationService \ src \ com \ android \ dynsystem \ BootCompletedReceiver . java \n - import android . os . image . DynamicSystemManager ; \n - DynamicSystemManager dynSystem = \n - ( DynamicSystemManager ) context . getSystemService ( Context . DYNAMIC _ SYSTEM _ SERVICE ) ; \n - \n - boolean isInUse = ( dynSystem ! = null ) & & dynSystem . isInUse ( ) ; \n - \n - if ( ! isInUse ) { \n - return ; \n - } \n - \n,"Fix dynsystem . BootCompletedReceiver \n Cleanup remnants of dynamic _ system feature flag . \n This piece of code only makes sense when we had the feature flag . \n Now that the feature flag is deprecated , we shouldn ' t check the \n DynamicSystemManager . isInUse ( ) anymore , because we actually do want to \n post a notification when DSU is installed but not in use . \n Bug : 176795908 \n Test : Install a DSU , reboot into guest system , reboot back to host \n system , verify the BootCompletedReceiver is active . \n Change - Id : I31c438fcd70e71eb2a5b14cdb713bd25516e8532",543
"core \ java \ android \ os \ image \ DynamicSystemClient . java \n + private static final String TAG = "" DynamicSystemClient "" ; \n + \n - private static final String TAG = "" DynSystemClient "" ; \n - \n - Slog . v ( TAG , "" DynSystemService connected "" ) ; \n + Slog . v ( TAG , "" onServiceConnected : "" + className ) ; \n - Slog . v ( TAG , "" DynSystemService disconnected "" ) ; \n + Slog . v ( TAG , "" onServiceDisconnected : "" + className ) ; \n packages \ DynamicSystemInstallationService \ src \ com \ android \ dynsystem \ DynamicSystemInstallationService . java \n - private static final String TAG = "" DynSystemInstallationService "" ; \n + private static final String TAG = "" DynamicSystemInstallationService "" ; \n","Change log tag of DynamicSystemClient to match class name \n Expand the "" DynSystem "" abbreviation to "" DynamicSystem "" . \n For simpler log grepping . \n Bug : 165471299 \n Test : No \n Change - Id : Ibec692ae45539dacd55e13ffaa903b58f3bf0417",543
"core \ java \ android \ os \ image \ DynamicSystemClient . java \n - import android . os . SystemProperties ; \n - import android . util . FeatureFlagUtils ; \n - if ( mExecutor ! = null ) { \n - mExecutor . execute ( ( ) - > { \n - mListener . onStatusChanged ( STATUS _ UNKNOWN , CAUSE _ ERROR _ IPC , 0 , e ) ; \n - } ) ; \n - } else { \n - mListener . onStatusChanged ( STATUS _ UNKNOWN , CAUSE _ ERROR _ IPC , 0 , e ) ; \n - } \n + notifyOnStatusChangedListener ( STATUS _ UNKNOWN , CAUSE _ ERROR _ IPC , 0 , e ) ; \n + private void notifyOnStatusChangedListener ( \n + int status , int cause , long progress , Throwable detail ) { \n + if ( mListener ! = null ) { \n + if ( mExecutor ! = null ) { \n + mExecutor . execute ( \n + ( ) - > { \n + mListener . onStatusChanged ( status , cause , progress , detail ) ; \n + } ) ; \n + } else { \n + mListener . onStatusChanged ( status , cause , progress , detail ) ; \n + } \n + } \n + } \n + \n - if ( ! featureFlagEnabled ( ) ) { \n - Slog . w ( TAG , FeatureFlagUtils . DYNAMIC _ SYSTEM + "" not enabled ; bind ( ) aborted . "" ) ; \n - return ; \n - } \n - \n - if ( ! featureFlagEnabled ( ) ) { \n - Slog . w ( TAG , FeatureFlagUtils . DYNAMIC _ SYSTEM + "" not enabled ; start ( ) aborted . "" ) ; \n - return ; \n - } \n - \n + intent . setFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; \n - private boolean featureFlagEnabled ( ) { \n - return SystemProperties . getBoolean ( \n - FeatureFlagUtils . PERSIST _ PREFIX + FeatureFlagUtils . DYNAMIC _ SYSTEM , false ) ; \n - } \n - \n - if ( mExecutor ! = null ) { \n - mExecutor . execute ( ( ) - > { \n - mListener . onStatusChanged ( status , cause , progress , detail ) ; \n - } ) ; \n - } else { \n - mListener . onStatusChanged ( status , cause , progress , detail ) ; \n - } \n + notifyOnStatusChangedListener ( status , cause , progress , detail ) ; \n","Fix DynamicSystemClient . start ( ) exceptions \n * Remove calls to featureFlagEnabled ( ) as they are causing avc denials , \n plus the feature flag is already deprecated . \n * Add Intent flag FLAG _ ACTIVITY _ NEW _ TASK to fix the \n AndroidRuntimeException , as the Context object used to startActivity ( ) \n may not be an Activity object instance . \n * Check the nullness of mListener before using it to fix the \n NullPointerException . \n Bug : 176795908 \n Test : atest \ \n cts / tests / tests / os / src / android / os / image / cts / DynamicSystemClientTest . java \n Change - Id : I265d9912e76c39406e0adeacd2490b62873c94e4",543
"presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ parquet \ ParquetPageSource . java \n - if ( getParquetType ( type , fileSchema , useParquetColumnNames , column . getName ( ) , column . getHiveColumnIndex ( ) , column . getHiveType ( ) ) = = null ) { \n - constantBlocks [ columnIndex ] = RunLengthEncodedBlock . create ( type , null , MAX _ VECTOR _ LENGTH ) ; \n - fieldsBuilder . add ( Optional . empty ( ) ) ; \n - } \n - else { \n + if ( getParquetType ( type , fileSchema , useParquetColumnNames , column . getName ( ) , column . getHiveColumnIndex ( ) , column . getHiveType ( ) ) . isPresent ( ) ) { \n + else { \n + constantBlocks [ columnIndex ] = RunLengthEncodedBlock . create ( type , null , MAX _ VECTOR _ LENGTH ) ; \n + fieldsBuilder . add ( Optional . empty ( ) ) ; \n + } \n presto - hive \ src \ main \ java \ com \ facebook \ presto \ hive \ parquet \ ParquetPageSourceFactory . java \n - import java . util . Objects ; \n - . filter ( Objects : : nonNull ) \n + . filter ( Optional : : isPresent ) \n + . map ( Optional : : get ) \n - public static org . apache . parquet . schema . Type getParquetType ( Type prestoType , MessageType messageType , boolean useParquetColumnNames , String columnName , int columnHiveIndex , HiveType hiveType ) \n + public static Optional < org . apache . parquet . schema . Type > getParquetType ( Type prestoType , MessageType messageType , boolean useParquetColumnNames , String columnName , int columnHiveIndex , HiveType hiveType ) \n - return null ; \n + return Optional . empty ( ) ; \n - return type ; \n + return Optional . of ( type ) ; \n",Use Optional instead of null when getting Parquet types,552
presto - druid \ pom . xml \n - < dependency > \n - < groupId > com . facebook . presto < / groupId > \n - < artifactId > presto - main < / artifactId > \n - < / dependency > \n - \n + < dependency > \n + < groupId > com . facebook . presto < / groupId > \n + < artifactId > presto - main < / artifactId > \n + < scope > test < / scope > \n + < / dependency > \n + \n - < scope > compile < / scope > \n + < scope > test < / scope > \n presto - druid \ src \ main \ java \ com \ facebook \ presto \ druid \ DruidBrokerPageSource . java \n + import org . joda . time . chrono . ISOChronology ; \n - import static com . facebook . presto . util . DateTimeZoneIndex . getChronology ; \n - . withChronology ( getChronology ( session . getTimeZoneKey ( ) ) ) \n - . withOffsetParsed ( ) \n - . withLocale ( session . getLocale ( ) ) ; \n + . withChronology ( ISOChronology . getInstanceUTC ( ) ) \n + . withOffsetParsed ( ) ; \n,Get rid of presto util dependency in Druid connector,552
"presto - druid \ src \ main \ java \ com \ facebook \ presto \ druid \ segment \ V9SegmentIndexSource . java \n + import org . apache . druid . segment . data . Indexed ; \n + import org . apache . druid . segment . data . ListIndexed ; \n + Indexed < String > indexed = new ListIndexed < > ( availableDimensions ) ; \n - GenericIndexed . fromIterable ( availableDimensions , STRING _ STRATEGY ) , \n + indexed , \n",Fix Druid 0 . 17 . 0 index generation,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - private final ObjectMapper objecMapper = new ObjectMapperProvider ( ) . get ( ) ; \n + private final ObjectMapper objectMapper = new ObjectMapperProvider ( ) . get ( ) ; \n - rootNode = objecMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n + rootNode = objectMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n,Fix ObjectMapper typo in ElasticsearchClient \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c5b6d857753ba38559b2bde69e993caef75d9f03 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - private final ObjectMapper objecMapper = new ObjectMapperProvider ( ) . get ( ) ; \n + private final ObjectMapper objectMapper = new ObjectMapperProvider ( ) . get ( ) ; \n - rootNode = objecMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n + rootNode = objectMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n,Fix ObjectMapper typo in ElasticsearchClient \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c5b6d857753ba38559b2bde69e993caef75d9f03 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchRecordCursor . java \n - / / TODO : clear scroll on close \n + if ( scrollId ! = null ) { \n + client . prepareClearScroll ( ) \n + . addScrollId ( scrollId ) \n + . execute ( ) ; \n + } \n,clear Elasticsearch scroll when connector query close \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 6f833e0292baa0a8c08df9656ed2f9adad986b79 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchRecordCursor . java \n - / / TODO : clear scroll on close \n + if ( scrollId ! = null ) { \n + client . prepareClearScroll ( ) \n + . addScrollId ( scrollId ) \n + . execute ( ) ; \n + } \n,clear Elasticsearch scroll when connector query close \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 6f833e0292baa0a8c08df9656ed2f9adad986b79 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public ClusterSearchShardsResponse getSearchShards ( String index , ElasticsearchTableDescription tableDescription ) \n + public ClusterSearchShardsResponse getSearchShards ( String index ) \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n - ClusterSearchShardsResponse response = client . getSearchShards ( index , table ) ; \n + ClusterSearchShardsResponse response = client . getSearchShards ( index ) ; \n",Remove unused parameter in Elasticsearch getSearchShards ( ) \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 4d0dae6eb5eed3128e40f9667f2cb2cef3bd8aa3 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public ClusterSearchShardsResponse getSearchShards ( String index , ElasticsearchTableDescription tableDescription ) \n + public ClusterSearchShardsResponse getSearchShards ( String index ) \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n - ClusterSearchShardsResponse response = client . getSearchShards ( index , table ) ; \n + ClusterSearchShardsResponse response = client . getSearchShards ( index ) ; \n",Remove unused parameter in Elasticsearch getSearchShards ( ) \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 4d0dae6eb5eed3128e40f9667f2cb2cef3bd8aa3 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - import static com . google . common . base . Verify . verify ; \n + import static com . google . common . base . Verify . verifyNotNull ; \n - verify ( client ! = null , "" client is null "" ) ; \n - String [ ] indices = getIndices ( client , new GetIndexRequest ( ) ) ; \n - return Arrays . stream ( indices ) \n - . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n - . collect ( toImmutableList ( ) ) ; \n - } \n - \n - public ClusterSearchShardsResponse getSearchShards ( String index ) \n - { \n - verify ( client ! = null , "" client is null "" ) ; \n - return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n - } \n - \n - private String [ ] getIndices ( TransportClient client , GetIndexRequest request ) \n - { \n - return retry ( ) \n + String [ ] result = retry ( ) \n - . getIndex ( request ) \n + . getIndex ( new GetIndexRequest ( ) ) \n + return Arrays . stream ( result ) \n + . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n + . collect ( toImmutableList ( ) ) ; \n + public ClusterSearchShardsResponse getSearchShards ( String index ) \n + { \n + verifyNotNull ( client , "" client is null "" ) ; \n + return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n + } \n + \n - verify ( client ! = null , "" client is null "" ) ; \n + verifyNotNull ( client , "" client is null "" ) ; \n",Simplify logic for Elasticsearch connector getSearchShards \n Cherry - pick of https : / / github . com / prestosql / presto / commit / fec68a910622d377abce0e54967cef1bccb2066c \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - import static com . google . common . base . Verify . verify ; \n + import static com . google . common . base . Verify . verifyNotNull ; \n - verify ( client ! = null , "" client is null "" ) ; \n - String [ ] indices = getIndices ( client , new GetIndexRequest ( ) ) ; \n - return Arrays . stream ( indices ) \n - . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n - . collect ( toImmutableList ( ) ) ; \n - } \n - \n - public ClusterSearchShardsResponse getSearchShards ( String index ) \n - { \n - verify ( client ! = null , "" client is null "" ) ; \n - return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n - } \n - \n - private String [ ] getIndices ( TransportClient client , GetIndexRequest request ) \n - { \n - return retry ( ) \n + String [ ] result = retry ( ) \n - . getIndex ( request ) \n + . getIndex ( new GetIndexRequest ( ) ) \n + return Arrays . stream ( result ) \n + . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n + . collect ( toImmutableList ( ) ) ; \n + public ClusterSearchShardsResponse getSearchShards ( String index ) \n + { \n + verifyNotNull ( client , "" client is null "" ) ; \n + return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n + } \n + \n - verify ( client ! = null , "" client is null "" ) ; \n + verifyNotNull ( client , "" client is null "" ) ; \n",Simplify logic for Elasticsearch connector getSearchShards \n Cherry - pick of https : / / github . com / prestosql / presto / commit / fec68a910622d377abce0e54967cef1bccb2066c \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - { \n - verifyNotNull ( client , "" client is null "" ) ; \n - return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n - } \n - \n - private ClusterSearchShardsResponse getSearchShardsResponse ( TransportClient client , ClusterSearchShardsRequest request ) \n - . searchShards ( request ) \n + . searchShards ( new ClusterSearchShardsRequest ( index ) ) \n",inline method for Elasticsearch getSearchShards ( ) \n Cherry - pick of https : / / github . com / prestosql / presto / commit / abf8ba45cbdb16ac56863c24d2f570e209b2349f \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - { \n - verifyNotNull ( client , "" client is null "" ) ; \n - return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n - } \n - \n - private ClusterSearchShardsResponse getSearchShardsResponse ( TransportClient client , ClusterSearchShardsRequest request ) \n - . searchShards ( request ) \n + . searchShards ( new ClusterSearchShardsRequest ( index ) ) \n",inline method for Elasticsearch getSearchShards ( ) \n Cherry - pick of https : / / github . com / prestosql / presto / commit / abf8ba45cbdb16ac56863c24d2f570e209b2349f \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + import org . elasticsearch . cluster . routing . ShardRouting ; \n + import java . util . Arrays ; \n + import java . util . stream . Collectors ; \n + Map < String , DiscoveryNode > nodeById = Arrays . stream ( nodes ) \n + . collect ( Collectors . toMap ( DiscoveryNode : : getId , node - > node ) ) ; \n + \n - int nodeIndex = group . getShardId ( ) . getId ( ) % nodes . length ; \n - shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , nodes [ nodeIndex ] . getHostName ( ) , nodes [ nodeIndex ] . getAddress ( ) . getPort ( ) ) ) ; \n + Optional < ShardRouting > routing = Arrays . stream ( group . getShards ( ) ) \n + . filter ( ShardRouting : : assignedToNode ) \n + . sorted ( this : : shardPreference ) \n + . findFirst ( ) ; \n + \n + DiscoveryNode node ; \n + if ( routing . isPresent ( ) ) { \n + node = nodeById . get ( routing . get ( ) . currentNodeId ( ) ) ; \n + } \n + else { \n + / / pick an arbitrary node \n + node = nodes [ group . getShardId ( ) . getId ( ) % nodes . length ] ; \n + } \n + \n + shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , node . getHostName ( ) , node . getAddress ( ) . getPort ( ) ) ) ; \n + private int shardPreference ( ShardRouting left , ShardRouting right ) \n + { \n + / / Favor non - primary shards \n + if ( left . primary ( ) = = right . primary ( ) ) { \n + return 0 ; \n + } \n + return left . primary ( ) ? 1 : - 1 ; \n + } \n + \n",Use shard primary host in Elasticsearch connector to save extra hop in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / e96d2f4afa32fd119a7fc431ca5d8257b9420a4f \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + import org . elasticsearch . cluster . routing . ShardRouting ; \n + import java . util . Arrays ; \n + import java . util . stream . Collectors ; \n + Map < String , DiscoveryNode > nodeById = Arrays . stream ( nodes ) \n + . collect ( Collectors . toMap ( DiscoveryNode : : getId , node - > node ) ) ; \n + \n - int nodeIndex = group . getShardId ( ) . getId ( ) % nodes . length ; \n - shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , nodes [ nodeIndex ] . getHostName ( ) , nodes [ nodeIndex ] . getAddress ( ) . getPort ( ) ) ) ; \n + Optional < ShardRouting > routing = Arrays . stream ( group . getShards ( ) ) \n + . filter ( ShardRouting : : assignedToNode ) \n + . sorted ( this : : shardPreference ) \n + . findFirst ( ) ; \n + \n + DiscoveryNode node ; \n + if ( routing . isPresent ( ) ) { \n + node = nodeById . get ( routing . get ( ) . currentNodeId ( ) ) ; \n + } \n + else { \n + / / pick an arbitrary node \n + node = nodes [ group . getShardId ( ) . getId ( ) % nodes . length ] ; \n + } \n + \n + shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , node . getHostName ( ) , node . getAddress ( ) . getPort ( ) ) ) ; \n + private int shardPreference ( ShardRouting left , ShardRouting right ) \n + { \n + / / Favor non - primary shards \n + if ( left . primary ( ) = = right . primary ( ) ) { \n + return 0 ; \n + } \n + return left . primary ( ) ? 1 : - 1 ; \n + } \n + \n",Use shard primary host in Elasticsearch connector to save extra hop in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / e96d2f4afa32fd119a7fc431ca5d8257b9420a4f \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchLoader . java \n + import org . elasticsearch . action . bulk . BulkRequest ; \n + import org . elasticsearch . action . index . IndexRequest ; \n - import static org . elasticsearch . common . xcontent . XContentType . JSON ; \n + BulkRequest request = new BulkRequest ( ) ; \n - client . prepareIndex ( tableName , "" doc "" ) \n - . setSource ( dataBuilder . string ( ) , JSON ) \n - . get ( ) ; \n + request . add ( new IndexRequest ( tableName , "" doc "" ) . source ( dataBuilder ) ) ; \n + client . bulk ( request ) . actionGet ( ) ; \n",bulk load elasticsearch test data \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 36d418f0a6834eb13b7ba98da15c8ae4db1a7f60 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchLoader . java \n + import org . elasticsearch . action . bulk . BulkRequest ; \n + import org . elasticsearch . action . index . IndexRequest ; \n - import static org . elasticsearch . common . xcontent . XContentType . JSON ; \n + BulkRequest request = new BulkRequest ( ) ; \n - client . prepareIndex ( tableName , "" doc "" ) \n - . setSource ( dataBuilder . string ( ) , JSON ) \n - . get ( ) ; \n + request . add ( new IndexRequest ( tableName , "" doc "" ) . source ( dataBuilder ) ) ; \n + client . bulk ( request ) . actionGet ( ) ; \n",bulk load elasticsearch test data \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 36d418f0a6834eb13b7ba98da15c8ae4db1a7f60 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ TinyintDecoder . java \n - throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , "" Expected a numeric value for TINYINT field "" ) ; \n + throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , "" Expected a numeric value for SMALLINT field "" ) ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ VarbinaryDecoder . java \n - throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , "" Expected a string value for VARBINARY field "" ) ; \n + throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , "" Expected a string value for VARCHAR field "" ) ; \n","Revert "" Fix error message typo in Elasticsearch decoders "" \n This reverts commit 1c076d48a4fb5c8ea00de7dbeb307a5111fd6988 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - String type = "" object "" ; \n - if ( value . has ( "" type "" ) ) { \n - type = value . get ( "" type "" ) . asText ( ) ; \n - } \n - \n - \n - switch ( type ) { \n - case "" date "" : \n + if ( value . has ( "" type "" ) ) { \n + String type = value . get ( "" type "" ) . asText ( ) ; \n + if ( type . equals ( "" date "" ) ) { \n - break ; \n - \n - case "" object "" : \n - if ( value . has ( "" properties "" ) ) { \n - result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n - } \n - else { \n - LOG . debug ( "" Ignoring empty object field : % s "" , name ) ; \n - } \n - break ; \n - \n - default : \n + } \n + else { \n + } \n + } \n + else if ( value . has ( "" properties "" ) ) { \n + result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n - @ Test \n - public void testEmptyObjectFields ( ) \n - { \n - String indexName = "" emptyobject "" ; \n - index ( indexName , ImmutableMap . < String , Object > builder ( ) \n - . put ( "" name "" , "" stringfield "" ) \n - . put ( "" emptyobject "" , ImmutableMap . of ( ) ) \n - . put ( "" fields . fielda "" , 32 ) \n - . put ( "" fields . fieldb "" , ImmutableMap . of ( ) ) \n - . build ( ) ) ; \n - \n - embeddedElasticsearchNode . getClient ( ) \n - . admin ( ) \n - . indices ( ) \n - . refresh ( refreshRequest ( indexName ) ) \n - . actionGet ( ) ; \n - \n - assertQuery ( \n - "" SELECT name , fields . fielda FROM emptyobject "" , \n - "" VALUES ( ' stringfield ' , 32 ) "" ) ; \n - } \n - \n","Revert "" Handle empty object field in Elasticsearch "" \n This reverts commit f6f7d735d41d759160897ccea44e1e7ca9f8ca41 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - private final boolean ignorePublishAddress ; \n - this . ignorePublishAddress = config . isIgnorePublishAddress ( ) ; \n - if ( hosts . length > 0 & & ! ignorePublishAddress ) { \n + if ( hosts . length > 0 ) { \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n - private boolean ignorePublishAddress ; \n - public boolean isIgnorePublishAddress ( ) \n - { \n - return ignorePublishAddress ; \n - } \n - \n - @ Config ( "" elasticsearch . ignore - publish - address "" ) \n - public ElasticsearchConfig setIgnorePublishAddress ( boolean ignorePublishAddress ) \n - { \n - this . ignorePublishAddress = ignorePublishAddress ; \n - return this ; \n - } \n - \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n - . setIgnorePublishAddress ( false ) \n - . put ( "" elasticsearch . ignore - publish - address "" , "" true "" ) \n - . setIgnorePublishAddress ( true ) \n","Revert "" Add option to ignore Elasticsearch publish _ address "" \n This reverts commit d7e1df7166f633e5ba09178dd42fd88580d57893 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields , Optional < String > sort ) \n + public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields ) \n - sort . ifPresent ( sourceBuilder : : sort ) ; \n - \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n - / / sorting by _ doc ( index order ) get special treatment in Elasticsearch and is more efficient \n - Optional < String > sort = Optional . of ( "" _ doc "" ) ; \n - \n - if ( table . getQuery ( ) . isPresent ( ) ) { \n - / / However , if we ' re using a custom Elasticsearch query , use default sorting . \n - / / Documents will be scored and returned based on relevance \n - sort = Optional . empty ( ) ; \n - } \n - \n - documentFields , \n - sort ) ; \n + documentFields ) ; \n","Revert "" Iterate over Elasticsearch documents in index order "" \n This reverts commit 4d436fd6b946fc948ef873f92cb8e4c36067202d .",552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n - embeddedElasticsearchNode . getClient ( ) \n - . admin ( ) \n - . indices ( ) \n - . refresh ( refreshRequest ( "" orders _ alias "" ) ) \n - . actionGet ( ) ; \n - \n - embeddedElasticsearchNode . getClient ( ) \n - . admin ( ) \n - . indices ( ) \n - . refresh ( refreshRequest ( "" multi _ alias "" ) ) \n - . actionGet ( ) ; \n - \n","Revert "" Refresh Elasticsearch index before test queries "" \n This reverts commit 4c7acd9c099d39ce8e5019827fdc729c2541034e .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchQueryBuilder . java \n - queryBuilder . filter ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n + queryBuilder . must ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n - rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . filter ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n + rangeQueryBuilder . must ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n","Revert "" Use filter clause for Elasticsearch queries "" \n This reverts commit e169f88cf2d0f77880decad192bdedad58794bb6 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n - private static final String ORIGINAL _ NAME = "" original - name "" ; \n - \n - result . add ( makeColumnMetadata ( field . getName ( ) , type ) ) ; \n + result . add ( new ColumnMetadata ( field . getName ( ) , type ) ) ; \n - results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( \n - ( String ) column . getProperties ( ) . getOrDefault ( ORIGINAL _ NAME , column . getName ( ) ) , \n - column . getType ( ) ) ) ; \n + results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( column . getName ( ) , column . getType ( ) ) ) ; \n - return makeColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n + return new ColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n - \n - private static ColumnMetadata makeColumnMetadata ( String name , Type type ) \n - { \n - return new ColumnMetadata ( \n - name , \n - type , \n - null , \n - null , \n - false , \n - ImmutableMap . of ( ORIGINAL _ NAME , name ) ) ; \n - } \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n - @ Test \n - public void testMixedCase ( ) \n - { \n - String indexName = "" mixed _ case "" ; \n - index ( indexName , ImmutableMap . < String , Object > builder ( ) \n - . put ( "" Name "" , "" john "" ) \n - . put ( "" AGE "" , 32 ) \n - . build ( ) ) ; \n - \n - embeddedElasticsearchNode . getClient ( ) \n - . admin ( ) \n - . indices ( ) \n - . refresh ( refreshRequest ( indexName ) ) \n - . actionGet ( ) ; \n - \n - assertQuery ( \n - "" SELECT name , age FROM mixed _ case "" , \n - "" VALUES ( ' john ' , 32 ) "" ) ; \n - \n - assertQuery ( \n - "" SELECT name , age FROM mixed _ case WHERE name = ' john ' "" , \n - "" VALUES ( ' john ' , 32 ) "" ) ; \n - } \n - \n","Revert "" Handle mixed - case columns in Elasticsearch "" \n This reverts commit ae19772f7e89d7fa14e1ae2293199f7fd6f47e45 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ TimestampDecoder . java \n - import java . time . Instant ; \n - import static com . facebook . presto . spi . StandardErrorCode . NOT _ SUPPORTED ; \n - import static java . lang . String . format ; \n - private static final ZoneId ZULU = ZoneId . of ( "" Z "" ) ; \n - \n - Object value = documentField . getValue ( ) ; \n - \n - LocalDateTime timestamp ; \n - if ( value instanceof String ) { \n - timestamp = ISO _ DATE _ TIME . parse ( ( String ) value , LocalDateTime : : from ) ; \n - } \n - else if ( value instanceof Number ) { \n - timestamp = LocalDateTime . ofInstant ( Instant . ofEpochMilli ( ( ( Number ) value ) . longValue ( ) ) , ZULU ) ; \n - } \n - else { \n - throw new PrestoException ( NOT _ SUPPORTED , format ( \n - "" Unsupported representation for timestamp type : % s [ % s ] "" , \n - value . getClass ( ) . getSimpleName ( ) , \n - value ) ) ; \n - } \n - \n - long epochMillis = timestamp . atZone ( zoneId ) \n - . toInstant ( ) \n - . toEpochMilli ( ) ; \n - \n - TIMESTAMP . writeLong ( output , epochMillis ) ; \n + TIMESTAMP . writeLong ( output , \n + ISO _ DATE _ TIME . parse ( documentField . getValue ( ) , LocalDateTime : : from ) \n + . atZone ( zoneId ) \n + . toInstant ( ) \n + . toEpochMilli ( ) ) ; \n","Revert "" Add support for datetimes exposed as numbers in Elasticsearch "" \n This reverts commit 97f32b6bd6367859bf2b9c9a34c4b728e71985cf .",552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - package com . facebook . presto . elasticsearch . client ; \n + package com . facebook . presto . elasticsearch ; \n - import com . facebook . presto . elasticsearch . ElasticsearchConfig ; \n + import com . facebook . presto . elasticsearch . client . ElasticsearchNode ; \n + import com . facebook . presto . elasticsearch . client . IndexMetadata ; \n + import com . facebook . presto . elasticsearch . client . NodesResponse ; \n + import com . facebook . presto . elasticsearch . client . SearchShardsResponse ; \n + import com . facebook . presto . elasticsearch . client . Shard ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConnectorModule . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSourceProvider . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ NodesSystemTable . java \n - import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n,"Revert "" Move ElasticsearchClient to client package "" \n This reverts commit ab543066b82c53b550597c939f30630d157c26e7 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - import static com . google . common . base . Preconditions . checkArgument ; \n - NodesResponse nodesResponse = doRequest ( "" / _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n + NodesResponse nodesResponse = doRequest ( "" _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n - SearchShardsResponse shardsResponse = doRequest ( format ( "" / % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n + SearchShardsResponse shardsResponse = doRequest ( format ( "" % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n - return doRequest ( "" / _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n + return doRequest ( "" _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n - checkArgument ( path . startsWith ( "" / "" ) , "" path must be an absolute path "" ) ; \n - \n","Revert "" Use absolute paths for Elasticsearch requests "" \n This reverts commit d4f21f3a75aed42fa78afd45ed40e81f79d33b02 .",552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n - ` ` elasticsearch . max - retry - time ` ` Maximum duration across all retry attempts for a single request . \n - ` ` elasticsearch . max - retry - time ` ` \n - ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ \n - \n - This property defines the maximum duration across all retry attempts for a single request to Elasticsearch . \n - \n - This property is optional ; the default is ` ` 20s ` ` . \n - \n - - - - - - - - - - - - \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) \n - . setMaxRetryTimeoutMillis ( ( int ) config . getMaxRetryTime ( ) . toMillis ( ) ) ; \n + . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n - private Duration maxRetryTime = new Duration ( 30 , SECONDS ) ; \n - @ NotNull \n - public Duration getMaxRetryTime ( ) \n - { \n - return maxRetryTime ; \n - } \n - \n - @ Config ( "" elasticsearch . max - retry - time "" ) \n - @ ConfigDescription ( "" Maximum timeout in case of multiple retries "" ) \n - public ElasticsearchConfig setMaxRetryTime ( Duration maxRetryTime ) \n - { \n - this . maxRetryTime = maxRetryTime ; \n - return this ; \n - } \n - \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n - . setMaxRetryTime ( new Duration ( 30 , SECONDS ) ) \n - . put ( "" elasticsearch . max - retry - time "" , "" 10s "" ) \n - . setMaxRetryTime ( new Duration ( 10 , SECONDS ) ) \n","Revert "" Make Elasticsearch retry timeout configurable "" \n This reverts commit a94d5fb3d9c5a9287c8b442b8c63687689e317d7 .",552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n - This property is optional ; the default is ` ` 1m ` ` . \n + This property is optional ; the default is ` ` 1s ` ` . \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MINUTES ; \n + import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n - private Duration scrollTimeout = new Duration ( 1 , MINUTES ) ; \n + private Duration scrollTimeout = new Duration ( 1 , SECONDS ) ; \n - private Duration requestTimeout = new Duration ( 10 , SECONDS ) ; \n + private Duration requestTimeout = new Duration ( 100 , MILLISECONDS ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MINUTES ; \n + import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n - . setScrollTimeout ( new Duration ( 1 , MINUTES ) ) \n + . setScrollTimeout ( new Duration ( 1 , SECONDS ) ) \n - . setRequestTimeout ( new Duration ( 10 , SECONDS ) ) \n + . setRequestTimeout ( new Duration ( 100 , MILLISECONDS ) ) \n","Revert "" Adjust Elasticsearch timeout defaults "" \n This reverts commit c295c03f2da2129ca6b891fe2aa3329a0da349db .",552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchLoader . java \n - import org . elasticsearch . action . bulk . BulkRequest ; \n - import org . elasticsearch . action . index . IndexRequest ; \n + import static org . elasticsearch . common . xcontent . XContentType . JSON ; \n - BulkRequest request = new BulkRequest ( ) ; \n - request . add ( new IndexRequest ( tableName , "" doc "" ) . source ( dataBuilder ) ) ; \n + client . prepareIndex ( tableName , "" doc "" ) \n + . setSource ( dataBuilder . string ( ) , JSON ) \n + . get ( ) ; \n - client . bulk ( request ) . actionGet ( ) ; \n","Revert "" bulk load elasticsearch test data "" \n This reverts commit 56a8b5945aaed8104071b08502332f20dbe24ef9 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - import org . elasticsearch . cluster . routing . ShardRouting ; \n - import java . util . Arrays ; \n - import java . util . stream . Collectors ; \n - Map < String , DiscoveryNode > nodeById = Arrays . stream ( nodes ) \n - . collect ( Collectors . toMap ( DiscoveryNode : : getId , node - > node ) ) ; \n - \n - Optional < ShardRouting > routing = Arrays . stream ( group . getShards ( ) ) \n - . filter ( ShardRouting : : assignedToNode ) \n - . sorted ( this : : shardPreference ) \n - . findFirst ( ) ; \n - \n - DiscoveryNode node ; \n - if ( routing . isPresent ( ) ) { \n - node = nodeById . get ( routing . get ( ) . currentNodeId ( ) ) ; \n - } \n - else { \n - / / pick an arbitrary node \n - node = nodes [ group . getShardId ( ) . getId ( ) % nodes . length ] ; \n - } \n - \n - shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , node . getHostName ( ) , node . getAddress ( ) . getPort ( ) ) ) ; \n + int nodeIndex = group . getShardId ( ) . getId ( ) % nodes . length ; \n + shards . add ( new Shard ( group . getShardId ( ) . getId ( ) , nodes [ nodeIndex ] . getHostName ( ) , nodes [ nodeIndex ] . getAddress ( ) . getPort ( ) ) ) ; \n - private int shardPreference ( ShardRouting left , ShardRouting right ) \n - { \n - / / Favor non - primary shards \n - if ( left . primary ( ) = = right . primary ( ) ) { \n - return 0 ; \n - } \n - return left . primary ( ) ? 1 : - 1 ; \n - } \n - \n","Revert "" Use shard primary host in Elasticsearch connector to save extra hop in Elasticsearch "" \n This reverts commit 405efd8984b42b74e2190e07c7b22fd3b77abf44 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + { \n + verifyNotNull ( client , "" client is null "" ) ; \n + return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n + } \n + \n + private ClusterSearchShardsResponse getSearchShardsResponse ( TransportClient client , ClusterSearchShardsRequest request ) \n - . searchShards ( new ClusterSearchShardsRequest ( index ) ) \n + . searchShards ( request ) \n","Revert "" inline method for Elasticsearch getSearchShards ( ) "" \n This reverts commit b89611d01be3856c91ddb01eb7c92fb7ef61f77f .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - import static com . google . common . base . Verify . verifyNotNull ; \n + import static com . google . common . base . Verify . verify ; \n + verify ( client ! = null , "" client is null "" ) ; \n + String [ ] indices = getIndices ( client , new GetIndexRequest ( ) ) ; \n + return Arrays . stream ( indices ) \n + . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n + . collect ( toImmutableList ( ) ) ; \n + } \n + \n + public ClusterSearchShardsResponse getSearchShards ( String index ) \n + { \n + verify ( client ! = null , "" client is null "" ) ; \n + return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n + } \n + \n + private String [ ] getIndices ( TransportClient client , GetIndexRequest request ) \n + { \n - String [ ] result = retry ( ) \n + return retry ( ) \n - . getIndex ( new GetIndexRequest ( ) ) \n + . getIndex ( request ) \n - return Arrays . stream ( result ) \n - . filter ( index - > index . startsWith ( tableDescription . getIndex ( ) ) ) \n - . collect ( toImmutableList ( ) ) ; \n - public ClusterSearchShardsResponse getSearchShards ( String index ) \n - { \n - verifyNotNull ( client , "" client is null "" ) ; \n - return getSearchShardsResponse ( client , new ClusterSearchShardsRequest ( index ) ) ; \n - } \n - \n - verifyNotNull ( client , "" client is null "" ) ; \n + verify ( client ! = null , "" client is null "" ) ; \n","Revert "" Simplify logic for Elasticsearch connector getSearchShards "" \n This reverts commit d098fe73c0130883089e044c4c778e8b0029a348 .",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public ClusterSearchShardsResponse getSearchShards ( String index ) \n + public ClusterSearchShardsResponse getSearchShards ( String index , ElasticsearchTableDescription tableDescription ) \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n - ClusterSearchShardsResponse response = client . getSearchShards ( index ) ; \n + ClusterSearchShardsResponse response = client . getSearchShards ( index , table ) ; \n","Revert "" Remove unused parameter in Elasticsearch getSearchShards ( ) "" \n This reverts commit 3ebaed0f7b8194e032c8ada057a1ec134ebbb8ca .",552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchRecordCursor . java \n + / / TODO : clear scroll on close \n - if ( scrollId ! = null ) { \n - client . prepareClearScroll ( ) \n - . addScrollId ( scrollId ) \n - . execute ( ) ; \n - } \n,"Revert "" clear Elasticsearch scroll when connector query close "" \n This reverts commit 8a53371e3d0e0f7ad4379238cd5ae1fd9c1c1696 .",552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - private final ObjectMapper objectMapper = new ObjectMapperProvider ( ) . get ( ) ; \n + private final ObjectMapper objecMapper = new ObjectMapperProvider ( ) . get ( ) ; \n - rootNode = objectMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n + rootNode = objecMapper . readTree ( mappingMetaData . source ( ) . uncompressed ( ) ) ; \n,"Revert "" Fix ObjectMapper typo in ElasticsearchClient "" \n This reverts commit d0ed535113fec5f4cb29322dea5c5d77f2a37a43 .",552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n - This property is optional ; the default is ` ` 1s ` ` . \n + This property is optional ; the default is ` ` 1m ` ` . \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n + import static java . util . concurrent . TimeUnit . MINUTES ; \n - private Duration scrollTimeout = new Duration ( 1 , SECONDS ) ; \n + private Duration scrollTimeout = new Duration ( 1 , MINUTES ) ; \n - private Duration requestTimeout = new Duration ( 100 , MILLISECONDS ) ; \n + private Duration requestTimeout = new Duration ( 10 , SECONDS ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n + import static java . util . concurrent . TimeUnit . MINUTES ; \n - . setScrollTimeout ( new Duration ( 1 , SECONDS ) ) \n + . setScrollTimeout ( new Duration ( 1 , MINUTES ) ) \n - . setRequestTimeout ( new Duration ( 100 , MILLISECONDS ) ) \n + . setRequestTimeout ( new Duration ( 10 , SECONDS ) ) \n",Adjust Elasticsearch timeout defaults \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c43d1d092273e5b961906f03f50a31a3b446cfa3 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n - This property is optional ; the default is ` ` 1s ` ` . \n + This property is optional ; the default is ` ` 1m ` ` . \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n + import static java . util . concurrent . TimeUnit . MINUTES ; \n - private Duration scrollTimeout = new Duration ( 1 , SECONDS ) ; \n + private Duration scrollTimeout = new Duration ( 1 , MINUTES ) ; \n - private Duration requestTimeout = new Duration ( 100 , MILLISECONDS ) ; \n + private Duration requestTimeout = new Duration ( 10 , SECONDS ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n - import static java . util . concurrent . TimeUnit . MILLISECONDS ; \n + import static java . util . concurrent . TimeUnit . MINUTES ; \n - . setScrollTimeout ( new Duration ( 1 , SECONDS ) ) \n + . setScrollTimeout ( new Duration ( 1 , MINUTES ) ) \n - . setRequestTimeout ( new Duration ( 100 , MILLISECONDS ) ) \n + . setRequestTimeout ( new Duration ( 10 , SECONDS ) ) \n",Adjust Elasticsearch timeout defaults \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c43d1d092273e5b961906f03f50a31a3b446cfa3 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test ( singleThreaded = true ) \n,Make TestElasticsearchIntegrationSmokeTest single threaded \n Fix flaky TestElasticsearchIntegrationSmokeTest . testMultiIndexAlias,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ VarcharDecoder . java \n - else if ( value instanceof String ) { \n + else if ( value instanceof String | | value instanceof Number ) { \n - throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , format ( "" Expected a string value for field ' % s ' of type VARCHAR : % s [ % s ] "" , path , value , value . getClass ( ) . getSimpleName ( ) ) ) ; \n + throw new PrestoException ( ELASTICSEARCH _ TYPE _ MISMATCH , format ( "" Expected a string or numeric value for field ' % s ' of type VARCHAR : % s [ % s ] "" , path , value , value . getClass ( ) . getSimpleName ( ) ) ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test \n + public void testNumericKeyword ( ) \n + throws IOException \n + { \n + String indexName = "" numeric _ keyword "" ; \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . prepareCreate ( indexName ) \n + . addMapping ( "" doc "" , \n + "" numeric _ column "" , "" type = keyword "" ) \n + . get ( ) ; \n + \n + index ( indexName , ImmutableMap . < String , Object > builder ( ) \n + . put ( "" numeric _ column "" , 20 ) \n + . build ( ) ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( indexName ) ) \n + . actionGet ( ) ; \n + \n + assertQuery ( \n + "" SELECT numeric _ column FROM numeric _ keyword "" , \n + "" VALUES 20 "" ) ; \n + assertQuery ( \n + "" SELECT numeric _ column FROM numeric _ keyword where numeric _ column = ' 20 ' "" , \n + "" VALUES 20 "" ) ; \n + } \n + \n",Support elasticsearch numeric keyword \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 101d55404e4172ac72889b2d175863de5ec07546 \n Co - authored - by : Chun Han Hsiao < chhsiao90 @ gmail . com >,552
"presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ KafkaMetadata . java \n - @ SuppressWarnings ( "" ValueOfIncrementOrDecrementUsed "" ) \n - @ SuppressWarnings ( "" ValueOfIncrementOrDecrementUsed "" ) \n",Remove Kafka connector suppress warnings labels \n Cherry - pick of https : / / github . com / prestosql / presto / commit / fa99b33f1b5de154a20027db77f8782e0fea6432 \n Co - authored - by : Charles Morgan < cjmorgan2000 @ gmail . com >,552
"presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ AbstractRowEncoder . java \n - validateColumns ( this . columnHandles ) ; \n - / * * \n - * Performs any checks on the column handle field values \n - * / \n - protected abstract void validateColumns ( List < EncoderColumnHandle > columnHandles ) ; \n - \n presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ csv \ CsvRowEncoder . java \n - this . row = new String [ columnHandles . size ( ) ] ; \n - } \n - \n - @ Override \n - protected void validateColumns ( List < EncoderColumnHandle > columnHandles ) \n - { \n - for ( EncoderColumnHandle columnHandle : columnHandles ) { \n - checkArgument ( columnHandle . getFormatHint ( ) = = null , "" unexpected format hint ' % s ' defined for column ' % s ' "" , columnHandle . getFormatHint ( ) , columnHandle . getName ( ) ) ; \n - checkArgument ( columnHandle . getDataFormat ( ) = = null , "" unexpected data format ' % s ' defined for column ' % s ' "" , columnHandle . getDataFormat ( ) , columnHandle . getName ( ) ) ; \n - \n - checkArgument ( isSupportedType ( columnHandle . getType ( ) ) , "" unsupported column type ' % s ' for column ' % s ' "" , columnHandle . getType ( ) , columnHandle . getName ( ) ) ; \n + for ( EncoderColumnHandle columnHandle : this . columnHandles ) { \n + checkArgument ( columnHandle . getFormatHint ( ) = = null , "" Unexpected format hint ' % s ' defined for column ' % s ' "" , columnHandle . getFormatHint ( ) , columnHandle . getName ( ) ) ; \n + checkArgument ( columnHandle . getDataFormat ( ) = = null , "" Unexpected data format ' % s ' defined for column ' % s ' "" , columnHandle . getDataFormat ( ) , columnHandle . getName ( ) ) ; \n + checkArgument ( isSupportedType ( columnHandle . getType ( ) ) , "" Unsupported column type ' % s ' for column ' % s ' "" , columnHandle . getType ( ) , columnHandle . getName ( ) ) ; \n + this . row = new String [ this . columnHandles . size ( ) ] ; \n",Move column handle validation for Kafka encoders into constructor \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 32c4f1ac5d1c9d6e4ddb7249b8cb134e6c2b518f \n Co - authored - by : Charles Morgan < cjmorgan2000 @ gmail . com >,552
"presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ KafkaPageSink . java \n + import java . io . IOException ; \n + import java . io . UncheckedIOException ; \n + try { \n + keyEncoder . close ( ) ; \n + messageEncoder . close ( ) ; \n + } \n + catch ( IOException e ) { \n + throw new UncheckedIOException ( "" Failed to close row encoders "" , e ) ; \n + } \n + \n presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ AbstractRowEncoder . java \n + \n + @ Override \n + public void close ( ) \n + { \n + } \n presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ RowEncoder . java \n + import java . io . Closeable ; \n + \n + extends Closeable \n",Make Kafka RowEncoder Closeable \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 1e74c545e257fa903f35803c13e5175cd51e7598 \n Co - authored - by : Charles Morgan < cjmorgan2000 @ gmail . com >,552
"presto - kafka \ src \ test \ java \ com \ facebook \ presto \ kafka \ TestKafkaIntegrationSmokeTest . java \n - "" VALUES ( "" + testCase . getFieldValues ( ) + "" ) "" , 1 ) ; \n + "" VALUES ( "" + testCase . getFieldValues ( ) + "" ) , ( "" + testCase . getFieldValues ( ) + "" ) "" , 2 ) ; \n - "" VALUES ( "" + testCase . getFieldValues ( ) + "" ) "" ) ; \n + "" VALUES ( "" + testCase . getFieldValues ( ) + "" ) , ( "" + testCase . getFieldValues ( ) + "" ) "" ) ; \n",Add row to Kafka round trip test \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 2aa3d75a5925a1c3326495452a870ef2f9778883 \n Co - authored - by : Charles Morgan < cjmorgan2000 @ gmail . com >,552
"presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ AbstractRowEncoder . java \n - public RowEncoder appendColumnValue ( Block block , int position ) \n + public void appendColumnValue ( Block block , int position ) \n - return this ; \n presto - kafka \ src \ main \ java \ com \ facebook \ presto \ kafka \ encoder \ RowEncoder . java \n - RowEncoder appendColumnValue ( Block block , int position ) ; \n + void appendColumnValue ( Block block , int position ) ; \n",Fix resource warning in KafkaPageSink # appendPage \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 7e759230022cd310086b76392ad2e1f057014ce2 \n Co - authored - by : Piotr Findeisen < piotr . findeisen @ gmail . com >,552
"presto - parquet \ src \ main \ java \ com \ facebook \ presto \ parquet \ predicate \ TupleDomainParquetPredicate . java \n - if ( statistics . genericGetMin ( ) = = null | | statistics . genericGetMax ( ) = = null ) { \n + if ( ! statistics . hasNonNullValue ( ) | | statistics . genericGetMin ( ) = = null | | statistics . genericGetMax ( ) = = null ) { \n presto - parquet \ src \ test \ java \ com \ facebook \ presto \ parquet \ TestTupleDomainParquetPredicate . java \n + \n + assertEquals ( getDomain ( BIGINT , 20 , longOnlyNullsStats ( 10 ) , ID , column , true ) , create ( ValueSet . all ( BIGINT ) , true ) ) ; \n + \n + assertEquals ( getDomain ( INTEGER , 20 , longOnlyNullsStats ( 10 ) , ID , column , true ) , create ( ValueSet . all ( INTEGER ) , true ) ) ; \n + \n + assertEquals ( getDomain ( SMALLINT , 20 , longOnlyNullsStats ( 10 ) , ID , column , true ) , create ( ValueSet . all ( SMALLINT ) , true ) ) ; \n + assertEquals ( getDomain ( TINYINT , 20 , longOnlyNullsStats ( 10 ) , ID , column , true ) , create ( ValueSet . all ( TINYINT ) , true ) ) ; \n + \n + private static LongStatistics longOnlyNullsStats ( long numNulls ) \n + { \n + LongStatistics statistics = new LongStatistics ( ) ; \n + statistics . setNumNulls ( numNulls ) ; \n + return statistics ; \n + } \n",Fix Parquet long statistics handling when min / max not set \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 3bc0e128855599115565a77485469096c25d5fd1 \n Co - authored - by : talbm < tal @ varada . io >,552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n + ` ` elasticsearch . max - retry - time ` ` Maximum duration across all retry attempts for a single request . \n + ` ` elasticsearch . max - retry - time ` ` \n + ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ \n + \n + This property defines the maximum duration across all retry attempts for a single request to Elasticsearch . \n + \n + This property is optional ; the default is ` ` 20s ` ` . \n + \n - - - - - - - - - - - - \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) ; \n + . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) \n + . setMaxRetryTimeoutMillis ( ( int ) config . getMaxRetryTime ( ) . toMillis ( ) ) ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n + private Duration maxRetryTime = new Duration ( 30 , SECONDS ) ; \n + @ NotNull \n + public Duration getMaxRetryTime ( ) \n + { \n + return maxRetryTime ; \n + } \n + \n + @ Config ( "" elasticsearch . max - retry - time "" ) \n + @ ConfigDescription ( "" Maximum timeout in case of multiple retries "" ) \n + public ElasticsearchConfig setMaxRetryTime ( Duration maxRetryTime ) \n + { \n + this . maxRetryTime = maxRetryTime ; \n + return this ; \n + } \n + \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n + . setMaxRetryTime ( new Duration ( 30 , SECONDS ) ) \n + . put ( "" elasticsearch . max - retry - time "" , "" 10s "" ) \n + . setMaxRetryTime ( new Duration ( 10 , SECONDS ) ) \n",Make Elasticsearch retry timeout configurable \n Cherry - pick of https : / / github . com / prestosql / presto / commit / bacd4d53b7bd0d91e2842092d95b06965e4e31d6 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - docs \ src \ main \ sphinx \ connector \ elasticsearch . rst \n + ` ` elasticsearch . max - retry - time ` ` Maximum duration across all retry attempts for a single request . \n + ` ` elasticsearch . max - retry - time ` ` \n + ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ ^ \n + \n + This property defines the maximum duration across all retry attempts for a single request to Elasticsearch . \n + \n + This property is optional ; the default is ` ` 20s ` ` . \n + \n - - - - - - - - - - - - \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) ; \n + . setSocketTimeout ( toIntExact ( config . getRequestTimeout ( ) . toMillis ( ) ) ) ) \n + . setMaxRetryTimeoutMillis ( ( int ) config . getMaxRetryTime ( ) . toMillis ( ) ) ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n + private Duration maxRetryTime = new Duration ( 30 , SECONDS ) ; \n + @ NotNull \n + public Duration getMaxRetryTime ( ) \n + { \n + return maxRetryTime ; \n + } \n + \n + @ Config ( "" elasticsearch . max - retry - time "" ) \n + @ ConfigDescription ( "" Maximum timeout in case of multiple retries "" ) \n + public ElasticsearchConfig setMaxRetryTime ( Duration maxRetryTime ) \n + { \n + this . maxRetryTime = maxRetryTime ; \n + return this ; \n + } \n + \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n + . setMaxRetryTime ( new Duration ( 30 , SECONDS ) ) \n + . put ( "" elasticsearch . max - retry - time "" , "" 10s "" ) \n + . setMaxRetryTime ( new Duration ( 10 , SECONDS ) ) \n",Make Elasticsearch retry timeout configurable \n Cherry - pick of https : / / github . com / prestosql / presto / commit / bacd4d53b7bd0d91e2842092d95b06965e4e31d6 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + import static com . google . common . base . Preconditions . checkArgument ; \n - NodesResponse nodesResponse = doRequest ( "" _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n + NodesResponse nodesResponse = doRequest ( "" / _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n - SearchShardsResponse shardsResponse = doRequest ( format ( "" % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n + SearchShardsResponse shardsResponse = doRequest ( format ( "" / % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n - return doRequest ( "" _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n + return doRequest ( "" / _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n + checkArgument ( path . startsWith ( "" / "" ) , "" path must be an absolute path "" ) ; \n + \n",Use absolute paths for Elasticsearch requests \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 5744589d1d3c2827e7338621d77f28d8a84e26d8 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + import static com . google . common . base . Preconditions . checkArgument ; \n - NodesResponse nodesResponse = doRequest ( "" _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n + NodesResponse nodesResponse = doRequest ( "" / _ nodes / http "" , NODES _ RESPONSE _ CODEC : : fromJson ) ; \n - SearchShardsResponse shardsResponse = doRequest ( format ( "" % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n + SearchShardsResponse shardsResponse = doRequest ( format ( "" / % s / _ search _ shards "" , index ) , SEARCH _ SHARDS _ RESPONSE _ CODEC : : fromJson ) ; \n - return doRequest ( "" _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n + return doRequest ( "" / _ cat / indices ? h = index & format = json & s = index : asc "" , body - > { \n + checkArgument ( path . startsWith ( "" / "" ) , "" path must be an absolute path "" ) ; \n + \n",Use absolute paths for Elasticsearch requests \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 5744589d1d3c2827e7338621d77f28d8a84e26d8 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - package com . facebook . presto . elasticsearch ; \n + package com . facebook . presto . elasticsearch . client ; \n - import com . facebook . presto . elasticsearch . client . ElasticsearchNode ; \n - import com . facebook . presto . elasticsearch . client . IndexMetadata ; \n - import com . facebook . presto . elasticsearch . client . NodesResponse ; \n - import com . facebook . presto . elasticsearch . client . SearchShardsResponse ; \n - import com . facebook . presto . elasticsearch . client . Shard ; \n + import com . facebook . presto . elasticsearch . ElasticsearchConfig ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConnectorModule . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSourceProvider . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ NodesSystemTable . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n,Move ElasticsearchClient to client package \n Cherry - pick of https : / / github . com / prestosql / presto / commit / fd3e994bcc7c783bcf362af1e0c7b16406b39728 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - package com . facebook . presto . elasticsearch ; \n + package com . facebook . presto . elasticsearch . client ; \n - import com . facebook . presto . elasticsearch . client . ElasticsearchNode ; \n - import com . facebook . presto . elasticsearch . client . IndexMetadata ; \n - import com . facebook . presto . elasticsearch . client . NodesResponse ; \n - import com . facebook . presto . elasticsearch . client . SearchShardsResponse ; \n - import com . facebook . presto . elasticsearch . client . Shard ; \n + import com . facebook . presto . elasticsearch . ElasticsearchConfig ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConnectorModule . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSourceProvider . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchSplitManager . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ NodesSystemTable . java \n + import com . facebook . presto . elasticsearch . client . ElasticsearchClient ; \n,Move ElasticsearchClient to client package \n Cherry - pick of https : / / github . com / prestosql / presto / commit / fd3e994bcc7c783bcf362af1e0c7b16406b39728 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ pom . xml \n + < dependency > \n + < groupId > org . assertj < / groupId > \n + < artifactId > assertj - core < / artifactId > \n + < scope > test < / scope > \n + < / dependency > \n + \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + import static org . assertj . core . api . Assertions . assertThat ; \n + @ Test \n + public void testShowCreateTable ( ) \n + { \n + assertThat ( computeActual ( "" SHOW CREATE TABLE orders "" ) . getOnlyValue ( ) ) \n + . isEqualTo ( "" CREATE TABLE elasticsearch . tpch . orders ( \ n "" + \n + "" clerk varchar , \ n "" + \n + "" comment varchar , \ n "" + \n + "" custkey bigint , \ n "" + \n + "" orderdate timestamp , \ n "" + \n + "" orderkey bigint , \ n "" + \n + "" orderpriority varchar , \ n "" + \n + "" orderstatus varchar , \ n "" + \n + "" shippriority bigint , \ n "" + \n + "" totalprice real \ n "" + \n + "" ) "" ) ; \n + } \n + \n",Enable testShowCreateTable for Elasticsearch connector \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 69804f451a4b697d73c50e5a61d7a034adfff4ab \n Co - authored - by : Łukasz Osipiuk < lukasz @ osipiuk . net >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ TimestampDecoder . java \n + import java . time . Instant ; \n + import static com . facebook . presto . spi . StandardErrorCode . NOT _ SUPPORTED ; \n + import static java . lang . String . format ; \n + private static final ZoneId ZULU = ZoneId . of ( "" Z "" ) ; \n + \n - TIMESTAMP . writeLong ( output , \n - ISO _ DATE _ TIME . parse ( documentField . getValue ( ) , LocalDateTime : : from ) \n - . atZone ( zoneId ) \n - . toInstant ( ) \n - . toEpochMilli ( ) ) ; \n + Object value = documentField . getValue ( ) ; \n + \n + LocalDateTime timestamp ; \n + if ( value instanceof String ) { \n + timestamp = ISO _ DATE _ TIME . parse ( ( String ) value , LocalDateTime : : from ) ; \n + } \n + else if ( value instanceof Number ) { \n + timestamp = LocalDateTime . ofInstant ( Instant . ofEpochMilli ( ( ( Number ) value ) . longValue ( ) ) , ZULU ) ; \n + } \n + else { \n + throw new PrestoException ( NOT _ SUPPORTED , format ( \n + "" Unsupported representation for timestamp type : % s [ % s ] "" , \n + value . getClass ( ) . getSimpleName ( ) , \n + value ) ) ; \n + } \n + \n + long epochMillis = timestamp . atZone ( zoneId ) \n + . toInstant ( ) \n + . toEpochMilli ( ) ; \n + \n + TIMESTAMP . writeLong ( output , epochMillis ) ; \n",Add support for datetimes exposed as numbers in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 8a384e0b4cc276353495eb8c5d638540dcd55f65 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ decoders \ TimestampDecoder . java \n + import java . time . Instant ; \n + import static com . facebook . presto . spi . StandardErrorCode . NOT _ SUPPORTED ; \n + import static java . lang . String . format ; \n + private static final ZoneId ZULU = ZoneId . of ( "" Z "" ) ; \n + \n - TIMESTAMP . writeLong ( output , \n - ISO _ DATE _ TIME . parse ( documentField . getValue ( ) , LocalDateTime : : from ) \n - . atZone ( zoneId ) \n - . toInstant ( ) \n - . toEpochMilli ( ) ) ; \n + Object value = documentField . getValue ( ) ; \n + \n + LocalDateTime timestamp ; \n + if ( value instanceof String ) { \n + timestamp = ISO _ DATE _ TIME . parse ( ( String ) value , LocalDateTime : : from ) ; \n + } \n + else if ( value instanceof Number ) { \n + timestamp = LocalDateTime . ofInstant ( Instant . ofEpochMilli ( ( ( Number ) value ) . longValue ( ) ) , ZULU ) ; \n + } \n + else { \n + throw new PrestoException ( NOT _ SUPPORTED , format ( \n + "" Unsupported representation for timestamp type : % s [ % s ] "" , \n + value . getClass ( ) . getSimpleName ( ) , \n + value ) ) ; \n + } \n + \n + long epochMillis = timestamp . atZone ( zoneId ) \n + . toInstant ( ) \n + . toEpochMilli ( ) ; \n + \n + TIMESTAMP . writeLong ( output , epochMillis ) ; \n",Add support for datetimes exposed as numbers in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 8a384e0b4cc276353495eb8c5d638540dcd55f65 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n + private static final String ORIGINAL _ NAME = "" original - name "" ; \n + \n - result . add ( new ColumnMetadata ( field . getName ( ) , type ) ) ; \n + result . add ( makeColumnMetadata ( field . getName ( ) , type ) ) ; \n - results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( column . getName ( ) , column . getType ( ) ) ) ; \n + results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( \n + ( String ) column . getProperties ( ) . getOrDefault ( ORIGINAL _ NAME , column . getName ( ) ) , \n + column . getType ( ) ) ) ; \n - return new ColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n + return makeColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n + \n + private static ColumnMetadata makeColumnMetadata ( String name , Type type ) \n + { \n + return new ColumnMetadata ( \n + name , \n + type , \n + null , \n + null , \n + false , \n + ImmutableMap . of ( ORIGINAL _ NAME , name ) ) ; \n + } \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test \n + public void testMixedCase ( ) \n + { \n + String indexName = "" mixed _ case "" ; \n + index ( indexName , ImmutableMap . < String , Object > builder ( ) \n + . put ( "" Name "" , "" john "" ) \n + . put ( "" AGE "" , 32 ) \n + . build ( ) ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( indexName ) ) \n + . actionGet ( ) ; \n + \n + assertQuery ( \n + "" SELECT name , age FROM mixed _ case "" , \n + "" VALUES ( ' john ' , 32 ) "" ) ; \n + \n + assertQuery ( \n + "" SELECT name , age FROM mixed _ case WHERE name = ' john ' "" , \n + "" VALUES ( ' john ' , 32 ) "" ) ; \n + } \n + \n",Handle mixed - case columns in Elasticsearch \n The roundtrip of column names via ColumnMetadata causes the name \n to be lower - cased . This results in a mismatch when decoding \n the documents produced by Elasticsearch . \n This change retains the original column name as an additional \n property in the ColumnMetadata for each column . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 0300bd0c0655d38a3fc6d7659bf4463ad925c8b4 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchMetadata . java \n + private static final String ORIGINAL _ NAME = "" original - name "" ; \n + \n - result . add ( new ColumnMetadata ( field . getName ( ) , type ) ) ; \n + result . add ( makeColumnMetadata ( field . getName ( ) , type ) ) ; \n - results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( column . getName ( ) , column . getType ( ) ) ) ; \n + results . put ( column . getName ( ) , new ElasticsearchColumnHandle ( \n + ( String ) column . getProperties ( ) . getOrDefault ( ORIGINAL _ NAME , column . getName ( ) ) , \n + column . getType ( ) ) ) ; \n - return new ColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n + return makeColumnMetadata ( handle . getName ( ) , handle . getType ( ) ) ; \n + \n + private static ColumnMetadata makeColumnMetadata ( String name , Type type ) \n + { \n + return new ColumnMetadata ( \n + name , \n + type , \n + null , \n + null , \n + false , \n + ImmutableMap . of ( ORIGINAL _ NAME , name ) ) ; \n + } \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test \n + public void testMixedCase ( ) \n + { \n + String indexName = "" mixed _ case "" ; \n + index ( indexName , ImmutableMap . < String , Object > builder ( ) \n + . put ( "" Name "" , "" john "" ) \n + . put ( "" AGE "" , 32 ) \n + . build ( ) ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( indexName ) ) \n + . actionGet ( ) ; \n + \n + assertQuery ( \n + "" SELECT name , age FROM mixed _ case "" , \n + "" VALUES ( ' john ' , 32 ) "" ) ; \n + \n + assertQuery ( \n + "" SELECT name , age FROM mixed _ case WHERE name = ' john ' "" , \n + "" VALUES ( ' john ' , 32 ) "" ) ; \n + } \n + \n",Handle mixed - case columns in Elasticsearch \n The roundtrip of column names via ColumnMetadata causes the name \n to be lower - cased . This results in a mismatch when decoding \n the documents produced by Elasticsearch . \n This change retains the original column name as an additional \n property in the ColumnMetadata for each column . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 0300bd0c0655d38a3fc6d7659bf4463ad925c8b4 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchQueryBuilder . java \n - queryBuilder . must ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n + queryBuilder . filter ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n + rangeQueryBuilder . filter ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n","Use filter clause for Elasticsearch queries \n Filter clauses are more efficient to compute ( they ignore scoring ) , \n and can be cached by Elasticsearch . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 56aa0d71fad111e76b596a59f45380246c49b94e \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchQueryBuilder . java \n - queryBuilder . must ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n + queryBuilder . filter ( new BoolQueryBuilder ( ) . must ( buildPredicate ( session , column . getName ( ) , domain , column . getType ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gt ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . gte ( getValue ( session , type , range . getLow ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lte ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n + rangeQueryBuilder . filter ( new RangeQueryBuilder ( columnName ) . lt ( getValue ( session , type , range . getHigh ( ) . getValue ( ) ) ) ) ; \n - rangeQueryBuilder . must ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n + rangeQueryBuilder . filter ( new TermQueryBuilder ( columnName , getValue ( session , type , getOnlyElement ( valuesToInclude ) ) ) ) ; \n","Use filter clause for Elasticsearch queries \n Filter clauses are more efficient to compute ( they ignore scoring ) , \n and can be cached by Elasticsearch . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 56aa0d71fad111e76b596a59f45380246c49b94e \n Co - authored - by : Martin Traverso mtraverso @ gmail . com",552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( "" orders _ alias "" ) ) \n + . actionGet ( ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( "" multi _ alias "" ) ) \n + . actionGet ( ) ; \n + \n","Refresh Elasticsearch index before test queries \n Updates are done asychronously . This ensures the changes are visible \n before the test queries execute to provide "" read your own writes "" \n behavior . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 2111f6cf0f2a1653c7c00f2ec68bc21c15527b64 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >",552
"presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( "" orders _ alias "" ) ) \n + . actionGet ( ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( "" multi _ alias "" ) ) \n + . actionGet ( ) ; \n + \n","Refresh Elasticsearch index before test queries \n Updates are done asychronously . This ensures the changes are visible \n before the test queries execute to provide "" read your own writes "" \n behavior . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 2111f6cf0f2a1653c7c00f2ec68bc21c15527b64 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields ) \n + public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields , Optional < String > sort ) \n + sort . ifPresent ( sourceBuilder : : sort ) ; \n + \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n + / / sorting by _ doc ( index order ) get special treatment in Elasticsearch and is more efficient \n + Optional < String > sort = Optional . of ( "" _ doc "" ) ; \n + \n + if ( table . getQuery ( ) . isPresent ( ) ) { \n + / / However , if we ' re using a custom Elasticsearch query , use default sorting . \n + / / Documents will be scored and returned based on relevance \n + sort = Optional . empty ( ) ; \n + } \n + \n - documentFields ) ; \n + documentFields , \n + sort ) ; \n",Iterate over Elasticsearch documents in index order \n This can improve performance of scroll queries . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 7f4e39ddcf8c512c3fc6a2fd9962c38ae04d87fe \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n - public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields ) \n + public SearchResponse beginSearch ( String index , int shard , QueryBuilder query , Optional < List < String > > fields , List < String > documentFields , Optional < String > sort ) \n + sort . ifPresent ( sourceBuilder : : sort ) ; \n + \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchPageSource . java \n + / / sorting by _ doc ( index order ) get special treatment in Elasticsearch and is more efficient \n + Optional < String > sort = Optional . of ( "" _ doc "" ) ; \n + \n + if ( table . getQuery ( ) . isPresent ( ) ) { \n + / / However , if we ' re using a custom Elasticsearch query , use default sorting . \n + / / Documents will be scored and returned based on relevance \n + sort = Optional . empty ( ) ; \n + } \n + \n - documentFields ) ; \n + documentFields , \n + sort ) ; \n",Iterate over Elasticsearch documents in index order \n This can improve performance of scroll queries . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / 7f4e39ddcf8c512c3fc6a2fd9962c38ae04d87fe \n Co - authored - by : Martin Traverso mtraverso @ gmail . com,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + private final boolean ignorePublishAddress ; \n + this . ignorePublishAddress = config . isIgnorePublishAddress ( ) ; \n - if ( hosts . length > 0 ) { \n + if ( hosts . length > 0 & & ! ignorePublishAddress ) { \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n + private boolean ignorePublishAddress ; \n + public boolean isIgnorePublishAddress ( ) \n + { \n + return ignorePublishAddress ; \n + } \n + \n + @ Config ( "" elasticsearch . ignore - publish - address "" ) \n + public ElasticsearchConfig setIgnorePublishAddress ( boolean ignorePublishAddress ) \n + { \n + this . ignorePublishAddress = ignorePublishAddress ; \n + return this ; \n + } \n + \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n + . setIgnorePublishAddress ( false ) \n + . put ( "" elasticsearch . ignore - publish - address "" , "" true "" ) \n + . setIgnorePublishAddress ( true ) \n","Add option to ignore Elasticsearch publish _ address \n The address is used to address Elasticsearch nodes . When \n running in a container environment , the published address \n may not match the public address of the container . \n This option makes the connector ignore the published address \n and use the configured address , instead . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / d04b31c4d91b0365419f175698a4dcb1176b4455 \n Co - authored - by : Martin Traverso < mtraverso @ gmail . com >",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + private final boolean ignorePublishAddress ; \n + this . ignorePublishAddress = config . isIgnorePublishAddress ( ) ; \n - if ( hosts . length > 0 ) { \n + if ( hosts . length > 0 & & ! ignorePublishAddress ) { \n presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchConfig . java \n + private boolean ignorePublishAddress ; \n + public boolean isIgnorePublishAddress ( ) \n + { \n + return ignorePublishAddress ; \n + } \n + \n + @ Config ( "" elasticsearch . ignore - publish - address "" ) \n + public ElasticsearchConfig setIgnorePublishAddress ( boolean ignorePublishAddress ) \n + { \n + this . ignorePublishAddress = ignorePublishAddress ; \n + return this ; \n + } \n + \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchConfig . java \n + . setIgnorePublishAddress ( false ) \n + . put ( "" elasticsearch . ignore - publish - address "" , "" true "" ) \n + . setIgnorePublishAddress ( true ) \n","Add option to ignore Elasticsearch publish _ address \n The address is used to address Elasticsearch nodes . When \n running in a container environment , the published address \n may not match the public address of the container . \n This option makes the connector ignore the published address \n and use the configured address , instead . \n Cherry - pick of https : / / github . com / prestosql / presto / commit / d04b31c4d91b0365419f175698a4dcb1176b4455 \n Co - authored - by : Martin Traverso mtraverso @ gmail . com",552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + String type = "" object "" ; \n + if ( value . has ( "" type "" ) ) { \n + type = value . get ( "" type "" ) . asText ( ) ; \n + } \n + \n - if ( value . has ( "" type "" ) ) { \n - String type = value . get ( "" type "" ) . asText ( ) ; \n - if ( type . equals ( "" date "" ) ) { \n + \n + switch ( type ) { \n + case "" date "" : \n - } \n - else { \n + break ; \n + \n + case "" object "" : \n + if ( value . has ( "" properties "" ) ) { \n + result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n + } \n + else { \n + LOG . debug ( "" Ignoring empty object field : % s "" , name ) ; \n + } \n + break ; \n + \n + default : \n - } \n - } \n - else if ( value . has ( "" properties "" ) ) { \n - result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test \n + public void testEmptyObjectFields ( ) \n + { \n + String indexName = "" emptyobject "" ; \n + index ( indexName , ImmutableMap . < String , Object > builder ( ) \n + . put ( "" name "" , "" stringfield "" ) \n + . put ( "" emptyobject "" , ImmutableMap . of ( ) ) \n + . put ( "" fields . fielda "" , 32 ) \n + . put ( "" fields . fieldb "" , ImmutableMap . of ( ) ) \n + . build ( ) ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( indexName ) ) \n + . actionGet ( ) ; \n + \n + assertQuery ( \n + "" SELECT name , fields . fielda FROM emptyobject "" , \n + "" VALUES ( ' stringfield ' , 32 ) "" ) ; \n + } \n + \n",Handle empty object field in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c84e70f1cba085af73820fc3ceec76c631a97bcb \n Co - authored - by : luhhujbb < luhhujbb @ aol . com >,552
"presto - elasticsearch \ src \ main \ java \ com \ facebook \ presto \ elasticsearch \ ElasticsearchClient . java \n + String type = "" object "" ; \n + if ( value . has ( "" type "" ) ) { \n + type = value . get ( "" type "" ) . asText ( ) ; \n + } \n + \n - if ( value . has ( "" type "" ) ) { \n - String type = value . get ( "" type "" ) . asText ( ) ; \n - if ( type . equals ( "" date "" ) ) { \n + \n + switch ( type ) { \n + case "" date "" : \n - } \n - else { \n + break ; \n + \n + case "" object "" : \n + if ( value . has ( "" properties "" ) ) { \n + result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n + } \n + else { \n + LOG . debug ( "" Ignoring empty object field : % s "" , name ) ; \n + } \n + break ; \n + \n + default : \n - } \n - } \n - else if ( value . has ( "" properties "" ) ) { \n - result . add ( new IndexMetadata . Field ( isArray , name , parseType ( value . get ( "" properties "" ) , metaNode ) ) ) ; \n presto - elasticsearch \ src \ test \ java \ com \ facebook \ presto \ elasticsearch \ TestElasticsearchIntegrationSmokeTest . java \n + @ Test \n + public void testEmptyObjectFields ( ) \n + { \n + String indexName = "" emptyobject "" ; \n + index ( indexName , ImmutableMap . < String , Object > builder ( ) \n + . put ( "" name "" , "" stringfield "" ) \n + . put ( "" emptyobject "" , ImmutableMap . of ( ) ) \n + . put ( "" fields . fielda "" , 32 ) \n + . put ( "" fields . fieldb "" , ImmutableMap . of ( ) ) \n + . build ( ) ) ; \n + \n + embeddedElasticsearchNode . getClient ( ) \n + . admin ( ) \n + . indices ( ) \n + . refresh ( refreshRequest ( indexName ) ) \n + . actionGet ( ) ; \n + \n + assertQuery ( \n + "" SELECT name , fields . fielda FROM emptyobject "" , \n + "" VALUES ( ' stringfield ' , 32 ) "" ) ; \n + } \n + \n",Handle empty object field in Elasticsearch \n Cherry - pick of https : / / github . com / prestosql / presto / commit / c84e70f1cba085af73820fc3ceec76c631a97bcb \n Co - authored - by : luhhujbb luhhujbb @ aol . com,552
presto - druid \ src \ main \ java \ com \ facebook \ presto \ druid \ segment \ V9SegmentIndexSource . java \n + import org . apache . druid . common . config . NullHandling ; \n + NullHandling . initializeForTests ( ) ; \n,Fix druid connector segment scan \n Caused by : com . fasterxml . jackson . databind . exc . InvalidDefinitionException : No serializer found for class org . joda . time . Interval,552
src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ android \ AndroidCommon . java \n - javaCommon . setJavaCompilationArtifacts ( javaArtifacts ) ; \n,Do not set java compilation artifacts twice . \n PiperOrigin - RevId : 329778954,557
"src \ test \ shell \ integration \ runfiles _ test . sh \n + # TODO ( b / 174761497 ) : Re - enable the test outside of Bazel . \n + [ [ "" $ { PRODUCT _ NAME } "" ! = bazel ] ] & & return 0 \n + \n",Restrict the test case changing workspaces to run only for Bazel . \n PiperOrigin - RevId : 345531558,557
src \ test \ java \ com \ google \ devtools \ build \ lib \ exec \ util \ SpawnBuilder . java \n + public SpawnBuilder withOutputs ( ActionInput . . . outputs ) { \n + for ( ActionInput output : outputs ) { \n + withOutput ( output ) ; \n + } \n + return this ; \n + } \n + \n,Add a convenience method in ` SpawnBuilder ` to add multiple ` ActionInput ` \n outputs in one call . \n PiperOrigin - RevId : 340738576,557
"src \ main \ java \ com \ google \ devtools \ build \ lib \ actions \ MetadataProvider . java \n + import com . google . devtools . build . lib . vfs . FileSystem ; \n + \n + / * * \n + * Returns a { @ link FileSystem } which , if not - null , should be used instead of the one associated \n + * with { @ linkplain Artifact # getPath ( ) the path provided for input artifacts } . \n + * \n + * < p > For { @ linkplain ActionInput ActionInputs } which are { @ linkplain Artifact Artifacts } , we can \n + * perform direct operations on the { @ linkplain Artifact # getPath path } . Doing so , may require \n + * { @ link FileSystem } redirection . This method defines whether that is the case and which { @ link \n + * FileSystem } to use for that . \n + * / \n + @ Nullable \n + default FileSystem getFileSystemForInputResolution ( ) { \n + return null ; \n + } \n","Add a new method to ` MetadataProvider ` to optionally provide a ` FileSystem ` to \n use when operating on ` Artifact ` paths . \n Some of the ` ActionInput ` instances are ` Artifact ` s which means that we have \n the ability to operate on their path . In some cases , we cannot use those paths \n as is since ` FileSystem ` redirection is needed . The new method provides that \n information as well as the ` FileSystem ` to use in such case . \n PiperOrigin - RevId : 330612369",557
"src \ test \ shell \ unittest . bash \n - echo - n "" $ TEST _ name "" \n + echo - n "" $ TEST _ name "" > & 2 \n","Print test name to stderr on failures in bash tests . \n When using ` enable _ errexit ` , the test infrastructure will print a test name \n when it is present . It does so to ` stdout ` rather than ` stderr ` , unlike the \n rest of the error logging . This creates a particulary problematic scenario for \n commands with errors which capture stdout : \n ` ` ` \n variable = $ ( command which fails ) \n ` ` ` \n After that , ` variable ` will contain the test name , mixed with other output if \n that was produced . \n Fix the logging on errors to go to stderr . Please note that this brings the \n error report string in line with what ` fail ` does . \n PiperOrigin - RevId : 327463371",557
"src \ main \ java \ com \ google \ devtools \ build \ lib \ skyframe \ TreeArtifactValue . java \n - / * * \n - * Make sure the builder will inject a { @ link TreeArtifactValue } for a given { @ linkplain \n - * SpecialArtifact tree artifact } . \n - * \n - * < p > Convenience method allowing to construct potentially empty { @ link TreeArtifactValue } with \n - * a { @ link MultiBuilder } . \n - * \n - * < p > There is no need to call this method before { @ link # putChild ( TreeFileArtifact , \n - * FileArtifactValue ) } or { @ link # setArchivedRepresentation ( ArchivedTreeArtifact , \n - * FileArtifactValue ) } since both methods implicitly make sure that the { @ link \n - * TreeArtifactValue } will be created for the related { @ linkplain SpecialArtifact parent tree \n - * artifact } . \n - * / \n - MultiBuilder addTreeArtifact ( SpecialArtifact treeArtifact ) ; \n - \n - @ Override \n - public MultiBuilder addTreeArtifact ( SpecialArtifact treeArtifact ) { \n - Preconditions . checkArgument ( \n - treeArtifact . isTreeArtifact ( ) , "" Not a tree artifact : % s "" , treeArtifact ) ; \n - map . computeIfAbsent ( treeArtifact , Builder : : new ) ; \n - return this ; \n - } \n - \n - @ Override \n - public MultiBuilder addTreeArtifact ( SpecialArtifact treeArtifact ) { \n - Preconditions . checkArgument ( \n - treeArtifact . isTreeArtifact ( ) , "" Not a tree artifact : % s "" , treeArtifact ) ; \n - children . computeIfAbsent ( treeArtifact , ignored - > new ConcurrentHashMap < > ( ) ) ; \n - return null ; \n - } \n - \n",Remove dead code from ` TreeArtifactValue ` . \n PiperOrigin - RevId : 328435075,557
src \ test \ java \ com \ google \ devtools \ build \ lib \ exec \ util \ SpawnBuilder . java \n + private ResourceSet resourceSet = ResourceSet . ZERO ; \n - ResourceSet . ZERO ) ; \n + resourceSet ) ; \n + \n + public SpawnBuilder withLocalResources ( ResourceSet resourceSet ) { \n + this . resourceSet = resourceSet ; \n + return this ; \n + } \n,Allow specifying local resources in ` SpawnBuilder ` . \n PiperOrigin - RevId : 332852793,557
"src \ main \ java \ com \ google \ devtools \ build \ lib \ actions \ Artifact . java \n + \n + @ AutoCodec . VisibleForSerialization \n + @ AutoCodec . Instantiator \n + static ArchivedTreeArtifact createForDeserialization ( \n + SpecialArtifact treeArtifact , ArtifactRoot root , PathFragment execPath ) { \n + ArchivedTreeArtifact result = new ArchivedTreeArtifact ( treeArtifact , root , execPath ) ; \n + result . setGeneratingActionKey ( treeArtifact . getGeneratingActionKey ( ) ) ; \n + return result ; \n + } \n src \ test \ java \ com \ google \ devtools \ build \ lib \ actions \ ArtifactTest . java \n + import com . google . devtools . build . lib . actions . Artifact . ArchivedTreeArtifact ; \n + import com . google . devtools . build . lib . actions . Artifact . SpecialArtifact ; \n + import com . google . devtools . build . lib . actions . Artifact . SpecialArtifactType ; \n + \n + @ Test \n + public void archivedTreeArtifact _ codec _ roundTripsArchivedArtifact ( ) throws Exception { \n + ArchivedTreeArtifact artifact1 = createArchivedTreeArtifact ( rootDir , "" tree1 "" ) ; \n + ArtifactRoot anotherRoot = \n + ArtifactRoot . asDerivedRoot ( scratch . getFileSystem ( ) . getPath ( "" / "" ) , "" src "" ) ; \n + ArchivedTreeArtifact artifact2 = createArchivedTreeArtifact ( anotherRoot , "" tree2 "" ) ; \n + new SerializationTester ( artifact1 , artifact2 ) \n + . addDependency ( FileSystem . class , scratch . getFileSystem ( ) ) \n + . addDependency ( \n + Root . RootCodecDependencies . class , new Root . RootCodecDependencies ( anotherRoot . getRoot ( ) ) ) \n + . addDependencies ( SerializationDepsUtils . SERIALIZATION _ DEPS _ FOR _ TEST ) \n + . < ArchivedTreeArtifact > setVerificationFunction ( \n + ( original , deserialized ) - > { \n + assertThat ( original ) . isEqualTo ( deserialized ) ; \n + assertThat ( original . getGeneratingActionKey ( ) ) \n + . isEqualTo ( deserialized . getGeneratingActionKey ( ) ) ; \n + } ) \n + . runTests ( ) ; \n + } \n + \n + private static ArchivedTreeArtifact createArchivedTreeArtifact ( \n + ArtifactRoot root , String treeRelativePath ) { \n + SpecialArtifact treeArtifact = \n + new SpecialArtifact ( \n + root , \n + root . getExecPath ( ) . getRelative ( treeRelativePath ) , \n + ActionsTestUtil . NULL _ ARTIFACT _ OWNER , \n + SpecialArtifactType . TREE ) ; \n + treeArtifact . setGeneratingActionKey ( ActionsTestUtil . NULL _ ACTION _ LOOKUP _ DATA ) ; \n + return ArchivedTreeArtifact . create ( treeArtifact , root . getExecPath ( ) . subFragment ( 0 , 1 ) ) ; \n + } \n","Fix ` ArchivedTreeArtifact ` deserialization to set generating action . \n ` ArchivedTreeArtifact ` uses default deserialization , which will call the \n constructor of with its members . Similarly to ` TreeFileArtifact ` , we need to \n also set the generating action . Create an ` Instantiator ` to take care of that . \n PiperOrigin - RevId : 334258237",557
src \ main \ java \ com \ google \ devtools \ build \ lib \ exec \ ExecutionPolicy . java \n + \n + @ Override \n + public String toString ( ) { \n + return locality . toString ( ) ; \n + } \n,Add ` toString ` implementation for ` ExecutionPolicy ` . \n ` ExecutionPolicy ` uses the default ` toString ` implementation making it useless \n for debugging . Add an implementation producing more readable output . \n PiperOrigin - RevId : 339552679,557
"src \ main \ java \ com \ google \ devtools \ build \ lib \ exec \ BUILD \n + deps = [ "" / / third _ party : error _ prone _ annotations "" ] , \n src \ main \ java \ com \ google \ devtools \ build \ lib \ exec \ ExecutionPolicy . java \n - / * * \n - * Determines whether a Spawn is executable locally , remotely , or both . \n - * / \n + import com . google . errorprone . annotations . Immutable ; \n + \n + / * * Determines whether a Spawn is executable locally , remotely , or both . * / \n + @ Immutable \n",Mark ` ExecutionPolicy ` as immutable . \n The class is a simple wrapper around an enum . \n PiperOrigin - RevId : 339714074,557
src \ main \ protobuf \ failure _ details . proto \n + \n + reserved 7 ; / / For internal use \n,Reserve an failure detail code in ` Filesystem ` category . \n PiperOrigin - RevId : 347691385,557
src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ cpp \ CppCompileAction . java \n - import com . google . devtools . build . lib . bugreport . BugReport ; \n - BugReport . sendBugReport ( e ) ; \n + actionExecutionContext . getBugReporter ( ) . sendBugReport ( e ) ; \n,Use ` BugReporter ` from ` ActionExecutionContext ` in ` CppCompileAction ` . \n Use the ` BugReporter ` instance available in ` ActionExecutionContext ` rather \n than calling static ` BugReport : : sendReport ` in ` CppCompileAction ` . \n PiperOrigin - RevId : 348875394,557
"src \ main \ java \ com \ google \ devtools \ build \ lib \ vfs \ PathFragment . java \n - / / Path is normalized , so any "" . . "" would have to be at the very start \n - return normalizedPath . startsWith ( "" . . "" ) ; \n + / / Path is normalized , so any "" . . "" would have to be the first segment . \n + return normalizedPath . equals ( "" . . "" ) | | normalizedPath . startsWith ( "" . . "" + SEPARATOR _ CHAR ) ; \n src \ test \ java \ com \ google \ devtools \ build \ lib \ vfs \ PathFragmentTest . java \n + import static com . google . devtools . build . lib . vfs . PathFragment . EMPTY _ FRAGMENT ; \n + \n + @ Test \n + public void containsUplevelReference _ emptyPath _ returnsFalse ( ) { \n + assertThat ( EMPTY _ FRAGMENT . containsUplevelReferences ( ) ) . isFalse ( ) ; \n + } \n + \n + @ Test \n + public void containsUplevelReference _ uplevelOnlyPath _ returnsTrue ( ) { \n + PathFragment pathFragment = create ( "" . . "" ) ; \n + assertThat ( pathFragment . containsUplevelReferences ( ) ) . isTrue ( ) ; \n + } \n + \n + @ Test \n + public void containsUplevelReferences _ firstSegmentStartingWithDotDot _ returnsFalse ( ) { \n + PathFragment pathFragment = create ( "" . . file "" ) ; \n + assertThat ( pathFragment . containsUplevelReferences ( ) ) . isFalse ( ) ; \n + } \n + \n + @ Test \n + public void containsUplevelReferences _ startsWithUplevelReference _ returnsTrue ( ) { \n + PathFragment pathFragment = create ( "" . . / file "" ) ; \n + assertThat ( pathFragment . containsUplevelReferences ( ) ) . isTrue ( ) ; \n + } \n + \n + @ Test \n + public void containsUplevelReferences _ uplevelReferenceMidPath _ normalizesAndReturnsFalse ( ) { \n + PathFragment pathFragment = create ( "" a / . . / b "" ) ; \n + \n + assertThat ( pathFragment . containsUplevelReferences ( ) ) . isFalse ( ) ; \n + assertThat ( pathFragment . getPathString ( ) ) . isEqualTo ( "" b "" ) ; \n + } \n + \n + @ Test \n + public void containsUplevelReferenes _ uplevelReferenceMidGlobalPath _ normalizesAndReturnsFalse ( ) { \n + PathFragment pathFragment = create ( "" / dir1 / dir2 / . . / file "" ) ; \n + \n + assertThat ( pathFragment . containsUplevelReferences ( ) ) . isFalse ( ) ; \n + assertThat ( pathFragment . getPathString ( ) ) . isEqualTo ( "" / dir1 / file "" ) ; \n + } \n","Do not detect file names starting ` . . ` as having up - level references . \n ` PathFragment : : containsUplevelReferences ` detects whether a path has an \n up - level reference ( ` . . ` ) . The logic looks at the beginning of the normalized \n path whether it starts with a ` . . ` . This is incorrect for path segments which \n have a ` . . ` prefix , but are not ` . . ` , e . g . ` . . file ` . This causes bazel to crash \n when we create a tree artifact with a file starting with a ` . . ` . \n Fix the detection to only recognize paths with ` . . ` segments . \n PiperOrigin - RevId : 351624019",557
src \ main \ java \ com \ google \ devtools \ build \ lib \ runtime \ CommandEnvironment . java \n - * Returns precomputed workspace information or null . \n + * Returns workspace information obtained from the { @ linkplain \n + * com . google . devtools . build . lib . skyframe . DiffAwareness . View # getWorkspaceInfo ( ) diff } or null . \n - * < p > Precomputed workspace info is an optimization allowing to share information about the \n - * workspace if it was derived at the time of synchronizing the workspace . This way we can make it \n - * available earlier during the build and avoid retrieving it again . \n + * < p > We store workspace info as an optimization to allow sharing of information about the \n + * workspace if it was derived from the diff at the time of synchronizing the workspace . This way \n + * we can make it available earlier during the build and avoid retrieving it again . \n,"Rephrase Javadoc for ` CommandEnvironment : : getWorkspaceInfoFromDiff ` not to \n refer to "" precomputed "" workspace info . \n PiperOrigin - RevId : 355239840",557
"rxjava - core \ src \ main \ java \ rx \ operators \ OperationSkipUntil . java \n - if ( ! running . get ( ) ) { \n - ResultManager . this . onCompleted ( ) ; \n - } else { \n - self . unsubscribe ( ) ; \n - } \n + self . unsubscribe ( ) ; \n rxjava - core \ src \ test \ java \ rx \ operators \ OperationSkipUntilTest . java \n - verify ( observer , times ( 1 ) ) . onCompleted ( ) ; \n + verify ( observer , never ( ) ) . onCompleted ( ) ; \n",Fixed case with skipUntil ( empty ( ) ) = = never ( ) ( matches Rx . NET ),559
rxjava - core \ src \ main \ java \ rx \ operators \ OperationCombineLatest . java \n + Throwable err = null ; \n - values [ index ] = value ; \n - if ( ! hasValue . get ( index ) ) { \n - hasValue . set ( index ) ; \n - hasCount + + ; \n - } \n - if ( hasCount = = values . length ) { \n - / / clone : defensive copy due to varargs \n - try { \n - observer . onNext ( combiner . call ( values . clone ( ) ) ) ; \n - } catch ( Throwable t ) { \n - terminate ( ) ; \n - observer . onError ( t ) ; \n - cancel . unsubscribe ( ) ; \n + if ( ! isTerminated ( ) ) { \n + values [ index ] = value ; \n + if ( ! hasValue . get ( index ) ) { \n + hasValue . set ( index ) ; \n + hasCount + + ; \n + } \n + if ( hasCount = = values . length ) { \n + / / clone : defensive copy due to varargs \n + try { \n + observer . onNext ( combiner . call ( values . clone ( ) ) ) ; \n + } catch ( Throwable t ) { \n + terminate ( ) ; \n + err = t ; \n + } \n + if ( err ! = null ) { \n + / / no need to lock here \n + observer . onError ( err ) ; \n + cancel . unsubscribe ( ) ; \n + } \n + boolean unsub = false ; \n - observer . onError ( e ) ; \n - cancel . unsubscribe ( ) ; \n + unsub = true ; \n + if ( unsub ) { \n + observer . onError ( e ) ; \n + cancel . unsubscribe ( ) ; \n + } \n + boolean unsub = false ; \n - observer . onCompleted ( ) ; \n - cancel . unsubscribe ( ) ; \n + unsub = true ; \n - \n + if ( unsub ) { \n + / / no need to hold a lock at this point \n + observer . onCompleted ( ) ; \n + cancel . unsubscribe ( ) ; \n + } \n,"Moved onError , onCompleted and cancel . unsubscribed outside the lock",559
"rxjava - core \ src \ main \ java \ rx \ subjects \ SubjectSubscriptionManager . java \n - import java . util . Collections ; \n - import java . util . List ; \n - onTerminate . call ( ( Collection ) newState . observersList ) ; \n + onTerminate . call ( ( Collection ) Arrays . asList ( newState . observers ) ) ; \n + @ SuppressWarnings ( "" rawtypes "" ) \n - final SubjectObserver < Object > [ ] observers ; \n + final SubjectObserver [ ] observers ; \n - @ SuppressWarnings ( "" rawtypes "" ) \n - @ SuppressWarnings ( "" rawtypes "" ) \n - final List < SubjectObserver < Object > > observersList ; \n - this . observersList = Arrays . asList ( this . observers ) ; \n - observersList = Collections . emptyList ( ) ; \n","Added create with initial capacity , minor fix",559
rxjava - core \ src \ main \ java \ rx \ observers \ SerializedObserver . java \n + boolean skipFinal = false ; \n - } \n - if ( list = = null ) { \n - break ; \n + if ( list = = null ) { \n + emitting = false ; \n + skipFinal = true ; \n + return ; \n + } \n - synchronized ( this ) { \n - if ( terminated ) { \n - list = queue ; \n - queue = null ; \n - } else { \n - emitting = false ; \n - list = null ; \n + if ( ! skipFinal ) { \n + synchronized ( this ) { \n + if ( terminated ) { \n + list = queue ; \n + queue = null ; \n + } else { \n + emitting = false ; \n + list = null ; \n + } \n - / / this will only drain if terminated ( done here outside of synchronized block ) \n - drainQueue ( list ) ; \n + \n + / / this will only drain if terminated ( done here outside of synchronized block ) \n + drainQueue ( list ) ; \n - \n + \n,Removed window between the two synchronized blocks .,559
rxjava - core \ src \ main \ java \ rx \ operators \ OperatorDebounceWithTime . java \n - boolean localTerminate ; \n - localTerminate = terminate ; \n - if ( localTerminate ) { \n - onNextAndComplete . onCompleted ( ) ; \n - return ; \n - } \n + / / Check if a termination was requested in the meantime . \n,Removed localTerminate as it is never observed as true at that point .,559
"rxjava - contrib \ rxjava - string \ src \ test \ java \ rx \ observables \ StringObservableTest . java \n - List < Line > lines = StringObservable . byLine ( Observable . from ( Arrays . asList ( "" qwer "" , "" \ nasdf \ n "" , "" zx "" , "" cv "" ) ) ) . toList ( ) . toBlockingObservable ( ) . single ( ) ; \n + String newLine = System . getProperty ( "" line . separator "" ) ; \n + \n + List < Line > lines = StringObservable . byLine ( Observable . from ( Arrays . asList ( "" qwer "" , newLine + "" asdf "" + newLine , "" zx "" , "" cv "" ) ) ) . toList ( ) . toBlockingObservable ( ) . single ( ) ; \n",Fixed byLine test to use line . separator system property instead of \ n .,559
"src \ perf \ java \ rx \ operators \ OperatorSerializePerf . java \n - import org . openjdk . jmh . annotations . BenchmarkMode ; \n - import org . openjdk . jmh . annotations . Benchmark ; \n - import org . openjdk . jmh . annotations . Mode ; \n - import org . openjdk . jmh . annotations . OutputTimeUnit ; \n - import org . openjdk . jmh . annotations . Param ; \n - import org . openjdk . jmh . annotations . Scope ; \n - import org . openjdk . jmh . annotations . State ; \n + import org . openjdk . jmh . annotations . * ; \n - import rx . Observable ; \n + import rx . * ; \n - import rx . Subscriber ; \n - import rx . jmh . InputWithIncrementingInteger ; \n - import rx . jmh . LatchedObserver ; \n + import rx . functions . Func1 ; \n + import rx . jmh . * ; \n - public static class InputWithInterval extends InputWithIncrementingInteger { \n + public static class InputWithInterval extends InputWithIncrementingInteger implements Func1 < Long , Integer > { \n - interval = Observable . timer ( 0 , 1 , TimeUnit . MILLISECONDS ) . take ( size ) . cast ( Integer . class ) ; \n + interval = Observable . timer ( 0 , 1 , TimeUnit . MILLISECONDS ) . take ( size ) . map ( this ) ; \n + } \n + @ Override \n + public Integer call ( Long t1 ) { \n + return t1 . intValue ( ) ; \n",Fixed timer cast - to - int crash causing incorrect benchmark .,559
"src \ main \ java \ rx \ internal \ operators \ OperatorBufferWithTime . java \n - child . add ( inner ) ; \n + SerializedSubscriber < List < T > > serialized = new SerializedSubscriber < List < T > > ( child ) ; \n - ExactSubscriber bsub = new ExactSubscriber ( new SerializedSubscriber < List < T > > ( child ) , inner ) ; \n + ExactSubscriber bsub = new ExactSubscriber ( serialized , inner ) ; \n + bsub . add ( inner ) ; \n + child . add ( bsub ) ; \n - InexactSubscriber bsub = new InexactSubscriber ( new SerializedSubscriber < List < T > > ( child ) , inner ) ; \n + InexactSubscriber bsub = new InexactSubscriber ( serialized , inner ) ; \n + bsub . add ( inner ) ; \n + child . add ( bsub ) ; \n - super ( child ) ; \n - super ( child ) ; \n src \ main \ java \ rx \ internal \ operators \ OperatorMerge . java \n - synchronized ( this ) { \n + synchronized ( ms ) { \n src \ test \ java \ rx \ internal \ operators \ OperatorBufferTest . java \n + @ Test ( timeout = 3000 ) \n + public void testBufferWithTimeDoesntUnsubscribeDownstream ( ) throws InterruptedException { \n + @ SuppressWarnings ( "" unchecked "" ) \n + final Observer < Object > o = mock ( Observer . class ) ; \n + \n + \n + final CountDownLatch cdl = new CountDownLatch ( 1 ) ; \n + Subscriber < Object > s = new Subscriber < Object > ( ) { \n + @ Override \n + public void onNext ( Object t ) { \n + o . onNext ( t ) ; \n + } \n + @ Override \n + public void onError ( Throwable e ) { \n + o . onError ( e ) ; \n + cdl . countDown ( ) ; \n + } \n + @ Override \n + public void onCompleted ( ) { \n + o . onCompleted ( ) ; \n + cdl . countDown ( ) ; \n + } \n + } ; \n + \n + Observable . range ( 1 , 1 ) . delay ( 1 , TimeUnit . SECONDS ) . buffer ( 2 , TimeUnit . SECONDS ) . unsafeSubscribe ( s ) ; \n + \n + cdl . await ( ) ; \n + \n + verify ( o ) . onNext ( Arrays . asList ( 1 ) ) ; \n + verify ( o ) . onCompleted ( ) ; \n + verify ( o , never ( ) ) . onError ( any ( Throwable . class ) ) ; \n + \n + assertFalse ( s . isUnsubscribed ( ) ) ; \n + } \n",Fixed unsubscription issue in buffer with time and a potential \n concurrency issue in merge .,559
"src \ main \ java \ rx \ internal \ operators \ OperatorMerge . java \n - request ( emitted ) ; \n + if ( emitted > 0 ) { \n + request ( emitted ) ; \n + } \n + @ SuppressWarnings ( "" unused "" ) \n",Avoid request ( 0 ) to trigger a recursive call .,559
src \ main \ java \ rx \ internal \ operators \ OperatorOnBackpressureBlock . java \n - if ( n = = Long . MAX _ VALUE ) { \n - return ; \n - } else { \n - break ; \n - } \n + break ; \n - if ( requestedCount = = Long . MAX _ VALUE | | emitted = = 0 ) { \n - skipFinal = true ; \n - emitting = false ; \n - return ; \n + / / if no backpressure below \n + if ( requestedCount = = Long . MAX _ VALUE ) { \n + / / no new data arrived since the last poll \n + if ( queue . peek ( ) = = null ) { \n + skipFinal = true ; \n + emitting = false ; \n + return ; \n + } \n + n = Long . MAX _ VALUE ; \n + if ( emitted = = 0 ) { \n + skipFinal = true ; \n + emitting = false ; \n + return ; \n + } \n - n + = requestedCount ; \n + n = requestedCount ; \n src \ test \ java \ rx \ internal \ operators \ OnBackpressureBlockTest . java \n - @ Test \n + @ Test ( timeout = 10000 ) \n - @ Test \n + @ Test ( timeout = 10000 ) \n - @ Test \n + @ Test ( timeout = 10000 ) \n,Do not leave drain if queue has data and downstream doesn ' t do \n backpressure .,559
rxjava - core \ src \ main \ java \ rx \ subjects \ SubjectSubscriptionManager . java \n - if ( add ( bo ) & & child . isUnsubscribed ( ) ) { \n - remove ( bo ) ; \n + if ( ! child . isUnsubscribed ( ) ) { \n + if ( add ( bo ) & & child . isUnsubscribed ( ) ) { \n + remove ( bo ) ; \n + } \n,Don ' t add the subscriber to the manager if it unsubscribed during the onStart call,559
"src \ main \ java \ rx \ subjects \ ReplaySubject . java \n - import rx . functions . Functions ; \n + o . index ( null ) ; / / once caught up , no need for the index anymore \n",Fix memory leak in bounded ReplaySubject due to retaining the node index \n indefinitely once the Subscriber caught up .,559
src \ main \ java \ io \ reactivex \ plugins \ RxJavaPlugins . java \n - / * test . * / void unlock ( ) { \n + / * test . * / static void unlock ( ) { \n,Forgot static modifier on unlock in Plugins .,559
"src \ main \ java \ rx \ internal \ util \ BackpressureDrainManager . java \n - / * \n - * Copyright 2011 David Karnok \n - * \n + / * * \n + * Copyright 2014 Netflix , Inc . \n + * \n - * \n - * http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n - * \n + * \n + * http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n + * \n - \n src \ test \ java \ rx \ internal \ operators \ OperatorOnBackpressureBufferTest . java \n - @ Test ( timeout = 500 ) \n + @ Test ( timeout = 2000 ) \n","Fixed file comment , larger timeout for a test",559
src \ test \ java \ rx \ internal \ operators \ OperatorMergeTest . java \n - @ Test \n + @ Test ( timeout = 10000 ) \n,MergeTest . testConcurrency timeout to let other tests run,559
src \ test \ java \ rx \ BackpressureTests . java \n - \n + volatile int sink ; \n + int s = sink ; \n - t = String . valueOf ( i + t . hashCode ( ) ) ; \n + t = String . valueOf ( i + t . hashCode ( ) + s ) ; \n + sink = t . hashCode ( ) ; \n,Fixed SLOW _ PASS _ THRU to prevent JIT optimizing it away .,559
"src \ test \ java \ rx \ internal \ operators \ OnSubscribeRefCountTest . java \n - Observable < Long > r = Observable . timer ( 0 , 1 , TimeUnit . MILLISECONDS ) \n + Observable < Long > r = Observable . timer ( 0 , 5 , TimeUnit . MILLISECONDS ) \n - Thread . sleep ( 50 ) ; \n + Thread . sleep ( 52 ) ; \n",RefCountAsync : adjusted time values as 1 ms is unreliable,559
"src \ test \ java \ rx \ internal \ operators \ OperatorMergeMaxConcurrentTest . java \n - import java . util . concurrent . CountDownLatch ; \n + import java . util . concurrent . * ; \n - public void testSympleAsyncLoop ( ) { \n + public void testSimpleAsyncLoop ( ) { \n - for ( int i = 1 ; i < 100 ; i + + ) { \n + for ( int i = 1 ; i < 50 ; i + + ) { \n - ts . awaitTerminalEvent ( ) ; \n + ts . awaitTerminalEvent ( 1 , TimeUnit . SECONDS ) ; \n - for ( int i = 2 ; i < 100 ; i + + ) { \n + for ( int i = 2 ; i < 50 ; i + + ) { \n - ts . awaitTerminalEvent ( ) ; \n + ts . awaitTerminalEvent ( 1 , TimeUnit . SECONDS ) ; \n",Less concurrent threads and more in - line timeout detection .,559
"src \ main \ java \ rx \ internal \ operators \ OperatorPublish . java \n - nl . accept ( s , o ) ; \n - req . decrementAndGet ( ) ; \n + if ( req ! = null ) { / / null req indicates a concurrent unsubscription happened \n + nl . accept ( s , o ) ; \n + req . decrementAndGet ( ) ; \n + } \n",Handle concurrent unsubscription in drain ( avoid NPE ) .,559
"src \ main \ java \ rx \ internal \ operators \ OnSubscribeCombineLatest . java \n - long r = Math . min ( emitted . get ( ) , n ) ; \n - request ( r ) ; \n - emitted . addAndGet ( - r ) ; \n + do { \n + long r = emitted . get ( ) ; \n + long u = Math . min ( r , n ) ; \n + if ( emitted . compareAndSet ( r , r - u ) ) { \n + request ( u ) ; \n + break ; \n + } \n + } while ( true ) ; \n src \ test \ java \ rx \ internal \ operators \ OnSubscribeCombineLatestTest . java \n + @ Test \n + public void testBackpressureLoop ( ) { \n + for ( int i = 0 ; i < 5000 ; i + + ) { \n + testBackpressure ( ) ; \n + } \n + } \n + \n",CombineLatest : fixed concurrent requestUpTo yielding - 1 requests \n sometimes .,559
src \ test \ java \ rx \ internal \ operators \ OperatorRetryTest . java \n - @ Test ( timeout = 10000 ) \n + @ Test ( timeout = 15000 ) \n - @ Test ( timeout = 10000 ) \n + @ Test ( timeout = 15000 ) \n src \ test \ java \ rx \ subjects \ ReplaySubjectBoundedConcurrencyTest . java \n - @ Test ( timeout = 5000 ) \n + @ Test ( timeout = 10000 ) \n src \ test \ java \ rx \ subjects \ ReplaySubjectConcurrencyTest . java \n - @ Test ( timeout = 5000 ) \n + @ Test ( timeout = 10000 ) \n,Give more time to certain concurrency tests .,559
"src \ main \ java \ rx \ Observable . java \n - * then completes as soon as this condition is not satisfied . \n + * then completes if the condition is satisfied . \n - * @ param predicate \n + * @ param stopPredicate \n - * then completes as soon as this condition is not satisfied . \n + * then completes if the condition is satisfied . \n - public final Observable < T > takeUntil ( final Func1 < ? super T , Boolean > predicate ) { \n - return lift ( new OperatorTakeUntilPredicate < T > ( predicate ) ) ; \n + public final Observable < T > takeUntil ( final Func1 < ? super T , Boolean > stopPredicate ) { \n + return lift ( new OperatorTakeUntilPredicate < T > ( stopPredicate ) ) ; \n src \ main \ java \ rx \ internal \ operators \ OperatorTakeUntilPredicate . java \n - boolean doContinue = false ; \n + boolean stop = false ; \n - doContinue = predicate . call ( args ) ; \n + stop = stopPredicate . call ( args ) ; \n - if ( ! doContinue ) { \n + if ( stop ) { \n - private final Func1 < ? super T , Boolean > predicate ; \n + private final Func1 < ? super T , Boolean > stopPredicate ; \n - public OperatorTakeUntilPredicate ( final Func1 < ? super T , Boolean > predicate ) { \n - this . predicate = predicate ; \n + public OperatorTakeUntilPredicate ( final Func1 < ? super T , Boolean > stopPredicate ) { \n + this . stopPredicate = stopPredicate ; \n src \ test \ java \ rx \ internal \ operators \ OperatorTakeUntilPredicateTest . java \n - Observable . just ( 1 , 2 ) . takeUntil ( UtilityFunctions . alwaysTrue ( ) ) . subscribe ( o ) ; \n + Observable . just ( 1 , 2 ) . takeUntil ( UtilityFunctions . alwaysFalse ( ) ) . subscribe ( o ) ; \n - Observable . just ( 1 , 2 ) . takeUntil ( UtilityFunctions . alwaysFalse ( ) ) . subscribe ( o ) ; \n + Observable . just ( 1 , 2 ) . takeUntil ( UtilityFunctions . alwaysTrue ( ) ) . subscribe ( o ) ; \n - return t1 < 2 ; \n + return t1 = = 2 ; \n - . takeUntil ( UtilityFunctions . alwaysTrue ( ) ) . subscribe ( o ) ; \n + . takeUntil ( UtilityFunctions . alwaysFalse ( ) ) . subscribe ( o ) ; \n - Observable . range ( 1 , 1000 ) . takeUntil ( UtilityFunctions . alwaysTrue ( ) ) . subscribe ( ts ) ; \n + Observable . range ( 1 , 1000 ) . takeUntil ( UtilityFunctions . alwaysFalse ( ) ) . subscribe ( ts ) ; \n",Changed predicate to stopPredicate : stops on becoming true .,559
"src \ main \ java \ rx \ Observable . java \n - @ Beta \n - public final Observable < T > switchIfEmpty ( Observable < T > alternate ) { \n + @ Experimental \n + public final Observable < T > switchIfEmpty ( Observable < ? extends T > alternate ) { \n src \ main \ java \ rx \ internal \ operators \ OperatorSwitchIfEmpty . java \n - public class OperatorSwitchIfEmpty < T > implements Observable . Operator < T , T > { \n - private final Observable < T > alternate ; \n + public final class OperatorSwitchIfEmpty < T > implements Observable . Operator < T , T > { \n + private final Observable < ? extends T > alternate ; \n - public OperatorSwitchIfEmpty ( Observable < T > alternate ) { \n + public OperatorSwitchIfEmpty ( Observable < ? extends T > alternate ) { \n","Using @ Experimental , covariance and final class",559
src \ main \ java \ io \ reactivex \ observables \ BlockingObservable . java \n + import io . reactivex . subscribers . AsyncObserver ; \n - Observer < T > s = new Observer < T > ( ) { \n + AsyncObserver < T > s = new AsyncObserver < T > ( ) { \n,BlockingObservable . toFuture cancel races with onSubscribe .,559
src \ test \ java \ rx \ BackpressureTests . java \n - final int NUM = RxRingBuffer . SIZE * 3 ; / / > 1 so that take doesn ' t prevent buffer overflow \n + final int NUM = RxRingBuffer . SIZE * 3 / 2 ; / / > 1 so that take doesn ' t prevent buffer overflow \n,Checking if the test change is the main cause or not .,559
"src \ main \ java \ rx \ internal \ operators \ OnSubscribeRedo . java \n + currentProducer . set ( null ) ; \n + currentProducer . set ( null ) ; \n src \ test \ java \ rx \ internal \ operators \ OperatorRepeatTest . java \n - import java . util . Arrays ; \n + import java . util . * ; \n + import java . util . concurrent . TimeUnit ; \n + / * * Issue # 2844 : wrong target of request . * / \n + @ Test ( timeout = 3000 ) \n + public void testRepeatRetarget ( ) { \n + final List < Integer > concatBase = new ArrayList < Integer > ( ) ; \n + TestSubscriber < Integer > ts = new TestSubscriber < Integer > ( ) ; \n + Observable . just ( 1 , 2 ) \n + . repeat ( 5 ) \n + . concatMap ( new Func1 < Integer , Observable < Integer > > ( ) { \n + @ Override \n + public Observable < Integer > call ( Integer x ) { \n + System . out . println ( "" testRepeatRetarget - > "" + x ) ; \n + concatBase . add ( x ) ; \n + return Observable . < Integer > empty ( ) \n + . delay ( 200 , TimeUnit . MILLISECONDS ) ; \n + } \n + } ) \n + . subscribe ( ts ) ; \n + \n + ts . awaitTerminalEvent ( ) ; \n + ts . assertNoErrors ( ) ; \n + ts . assertReceivedOnNext ( Collections . < Integer > emptyList ( ) ) ; \n + \n + assertEquals ( Arrays . asList ( 1 , 2 , 1 , 2 , 1 , 2 , 1 , 2 , 1 , 2 ) , concatBase ) ; \n + } \n",Fix for issue 2844 : wrong target of request on repeat,559
src \ test \ java \ rx \ internal \ util \ RxRingBufferWithoutUnsafeTest . java \n + import java . util . * ; \n - import rx . Producer ; \n - import rx . Scheduler ; \n + import rx . * ; \n + @ Test ( timeout = 20000 ) \n + public void testConcurrencyLoop ( ) throws InterruptedException { \n + for ( int i = 0 ; i < 50 ; i + + ) { \n + testConcurrency ( ) ; \n + } \n + } \n + \n - @ Test \n + @ Test ( timeout = 10000 ) \n - final CountDownLatch emitLatch = new CountDownLatch ( 255 ) ; \n - final CountDownLatch drainLatch = new CountDownLatch ( 2 ) ; \n + final CountDownLatch emitLatch = new CountDownLatch ( 127 ) ; \n + int drainers = 3 ; \n + final CountDownLatch drainLatch = new CountDownLatch ( drainers ) ; \n - Scheduler . Worker w2 = Schedulers . newThread ( ) . createWorker ( ) ; \n - Scheduler . Worker w3 = Schedulers . newThread ( ) . createWorker ( ) ; \n + List < Scheduler . Worker > drainerWorkers = new ArrayList < Scheduler . Worker > ( ) ; \n - if ( emitLatch . getCount ( ) = = 0 ) { \n + try { \n + Thread . sleep ( 1 ) ; \n + } catch ( InterruptedException ex ) { \n + / / ignored \n + } \n + if ( emitLatch . getCount ( ) = = 0 & & b . isEmpty ( ) ) { \n - w2 . schedule ( drainer ) ; \n - w3 . schedule ( drainer ) ; \n + for ( int i = 0 ; i < drainers ; i + + ) { \n + Scheduler . Worker w = Schedulers . newThread ( ) . createWorker ( ) ; \n + w . schedule ( drainer ) ; \n + drainerWorkers . add ( w ) ; \n + } \n - w2 . unsubscribe ( ) ; \n - w3 . unsubscribe ( ) ; \n + for ( Scheduler . Worker w : drainerWorkers ) { \n + w . unsubscribe ( ) ; \n + } \n,Fix the drainer to check if the queue is empty before quitting .,559
"src \ main \ java \ rx \ internal \ schedulers \ EventLoopsScheduler . java \n - ScheduledAction s = poolWorker . scheduleActual ( action , 0 , null ) ; \n - \n - serial . add ( s ) ; \n - s . addParent ( serial ) ; \n + ScheduledAction s = poolWorker . scheduleActual ( action , 0 , null , serial ) ; \n src \ main \ java \ rx \ internal \ util \ SubscriptionList . java \n - import java . util . ArrayList ; \n - import java . util . Arrays ; \n - import java . util . Collection ; \n - import java . util . LinkedList ; \n - import java . util . List ; \n - import java . util . concurrent . locks . ReentrantLock ; \n + import java . util . * ; \n - private final ReentrantLock lock = new ReentrantLock ( ) ; \n - lock . lock ( ) ; \n - try { \n + synchronized ( this ) { \n - } finally { \n - lock . unlock ( ) ; \n - lock . lock ( ) ; \n - try { \n + synchronized ( this ) { \n - } finally { \n - lock . unlock ( ) ; \n - lock . lock ( ) ; \n - try { \n + synchronized ( this ) { \n - } finally { \n - lock . unlock ( ) ; \n - lock . lock ( ) ; \n - try { \n + synchronized ( this ) { \n - } finally { \n - lock . unlock ( ) ; \n - lock . lock ( ) ; \n - try { \n + synchronized ( this ) { \n - } finally { \n - lock . unlock ( ) ; \n",Fix the performance degradation due to different schedule execution and \n SubscriptionList . add ( ) and thread unparking .,559
gradle \ buildViaTravis . sh \n - echo - e ' ERROR : Should not be here = > Branch [ ' $ TRAVIS _ BRANCH ' ] Tag [ ' $ TRAVIS _ TAG ' ] ' \n + echo - e ' WARN : Should not be here = > Branch [ ' $ TRAVIS _ BRANCH ' ] Tag [ ' $ TRAVIS _ TAG ' ] ' \n + . / gradlew - Prelease . useLastTag = true build \n,Build at least as if it was a pull request .,559
"src \ main \ java \ rx \ Observable . java \n - import rx . annotations . Beta ; \n - import rx . annotations . Experimental ; \n + import rx . annotations . * ; \n - import rx . internal . util . ScalarSynchronousObservable ; \n - import rx . internal . util . UtilityFunctions ; \n + import rx . internal . util . * ; \n + / * * An empty observable which just emits onCompleted to any subscriber . * / \n + private static final Observable < Object > EMPTY = create ( new OnSubscribe < Object > ( ) { \n + @ Override \n + public void call ( Subscriber < ? super Object > t1 ) { \n + t1 . onCompleted ( ) ; \n + } \n + } ) ; \n + \n + @ SuppressWarnings ( "" unchecked "" ) \n - return from ( Collections . < T > emptyList ( ) ) ; \n + return ( Observable < T > ) EMPTY ; \n src \ test \ java \ rx \ ObservableTests . java \n + @ Test \n + public void testEmptyIdentity ( ) { \n + assertEquals ( Observable . empty ( ) , Observable . empty ( ) ) ; \n + } \n + \n + @ Test \n + public void testEmptyIsEmpty ( ) { \n + Observable . < Integer > empty ( ) . subscribe ( w ) ; \n + \n + verify ( w ) . onCompleted ( ) ; \n + verify ( w , never ( ) ) . onNext ( any ( Integer . class ) ) ; \n + verify ( w , never ( ) ) . onError ( any ( Throwable . class ) ) ; \n + } \n",Changed empty into a stateless constant observable .,559
"src \ main \ java \ rx \ Observable . java \n + if ( observer instanceof Subscriber ) { \n + return subscribe ( ( Subscriber < ? super T > ) observer ) ; \n + } \n src \ test \ java \ rx \ ObservableTests . java \n + \n + @ Test / / cf . https : / / github . com / ReactiveX / RxJava / issues / 2599 \n + public void testSubscribingSubscriberAsObserverMaintainsSubscriptionChain ( ) { \n + TestSubscriber < Object > subscriber = new TestSubscriber < Object > ( ) ; \n + Subscription subscription = Observable . just ( "" event "" ) . subscribe ( ( Observer < Object > ) subscriber ) ; \n + subscription . unsubscribe ( ) ; \n + \n + subscriber . assertUnsubscribed ( ) ; \n + } \n",Cast back Observer to Subscriber if passed to subscribe ( Observer ),559
"src \ main \ java \ rx \ internal \ operators \ OperatorPublish . java \n + / * \n + * We need to read terminalEvent before checking the queue for emptyness because \n + * all enqueue happens before setting the terminal event . \n + * If it were the other way around , when the emission is paused between \n + * checking isEmpty and checking terminalEvent , some other thread might \n + * have produced elements and set the terminalEvent and we ' d quit emitting \n + * prematurely . \n + * / \n + Object term = terminalEvent ; \n - if ( checkTerminated ( terminalEvent , empty ) ) { \n + if ( checkTerminated ( term , empty ) ) { \n + term = terminalEvent ; \n - if ( checkTerminated ( terminalEvent , v = = null ) ) { \n + if ( checkTerminated ( term , v = = null ) ) { \n - } \n + } \n",Fix termination race condition in OperatorPublish . dispatch,559
"src \ main \ java \ rx \ internal \ operators \ OperatorDelay . java \n - \n + / / indicates an error cut ahead \n + / / accessed from the worker thread only \n + boolean done ; \n - child . onCompleted ( ) ; \n + if ( ! done ) { \n + done = true ; \n + child . onCompleted ( ) ; \n + } \n - public void onError ( Throwable e ) { \n - child . onError ( e ) ; \n + public void onError ( final Throwable e ) { \n + worker . schedule ( new Action0 ( ) { \n + @ Override \n + public void call ( ) { \n + if ( ! done ) { \n + done = true ; \n + child . onError ( e ) ; \n + worker . unsubscribe ( ) ; \n + } \n + } \n + } ) ; \n - child . onNext ( t ) ; \n + if ( ! done ) { \n + child . onNext ( t ) ; \n + } \n src \ test \ java \ rx \ internal \ operators \ OperatorDelayTest . java \n + \n + @ Test \n + public void testErrorRunsBeforeOnNext ( ) { \n + TestScheduler test = Schedulers . test ( ) ; \n + \n + PublishSubject < Integer > ps = PublishSubject . create ( ) ; \n + \n + TestSubscriber < Integer > ts = TestSubscriber . create ( ) ; \n + \n + ps . delay ( 1 , TimeUnit . SECONDS , test ) . subscribe ( ts ) ; \n + \n + ps . onNext ( 1 ) ; \n + \n + test . advanceTimeBy ( 500 , TimeUnit . MILLISECONDS ) ; \n + \n + ps . onError ( new TestException ( ) ) ; \n + \n + test . advanceTimeBy ( 1 , TimeUnit . SECONDS ) ; \n + \n + ts . assertNoValues ( ) ; \n + ts . assertError ( TestException . class ) ; \n + ts . assertNotCompleted ( ) ; \n + } \n",Delay : error cut ahead was not properly serialized,559
src \ main \ java \ rx \ internal \ operators \ OperatorReplay . java \n - setFirst ( next . get ( ) ) ; \n + setFirst ( next ) ; \n - final void removeSome ( int n ) { \n + / * test * / final void removeSome ( int n ) { \n - setFirst ( head . get ( ) ) ; \n + setFirst ( head ) ; \n - Node newHead = new Node ( null ) ; \n - newHead . lazySet ( n ) ; \n - if ( n = = null ) { \n - tail = newHead ; \n - } \n - set ( newHead ) ; \n + set ( n ) ; \n - Node head = get ( ) ; \n - Node next = head . get ( ) ; \n + Node prev = get ( ) ; \n + Node next = prev . get ( ) ; \n + prev = next ; \n + prev = next ; \n - setFirst ( next ) ; \n + setFirst ( prev ) ; \n - Node head = get ( ) ; \n - Node next = head . get ( ) ; \n + Node prev = get ( ) ; \n + Node next = prev . get ( ) ; \n + prev = next ; \n - setFirst ( next ) ; \n + setFirst ( prev ) ; \n,No need to allocate a new head node .,559
"src \ main \ java \ rx \ internal \ operators \ OperatorPublish . java \n + term = terminalEvent ; \n - if ( checkTerminated ( terminalEvent , empty ) ) { \n + if ( checkTerminated ( term , empty ) ) { \n",Fixes another race between terminalEvent and the queue being empty .,559
"src \ main \ java \ io \ reactivex \ Observable . java \n - return OperatorReplay . create ( this ) ; \n + return OperatorReplay . createFrom ( this ) ; \n - \n src \ main \ java \ io \ reactivex \ internal \ operators \ OperatorReplay . java \n + / / TODO javac 1 . 8 fails with ambiguity error if this method is called create ( ) , works properly \n - public static < T > ConnectableObservable < T > create ( Observable < ? extends T > source ) { \n + public static < T > ConnectableObservable < T > createFrom ( Observable < ? extends T > source ) { \n - return create ( source ) ; \n + return createFrom ( source ) ; \n",Workaround for another javac 1 . 8 bug .,559
"src \ main \ java \ io \ reactivex \ Observable . java \n - public final < U > Observable < U > collect ( U initialValue , BiConsumer < ? super U , ? super T > collector ) { \n + public final < U > Observable < U > collectInto ( U initialValue , BiConsumer < ? super U , ? super T > collector ) { \n",collect : javac is unable to select the right overload for some reason,559
"src \ test \ java \ io \ reactivex \ internal \ operators \ OperatorConcatTest . java \n - for ( int i = 0 ; i < 100 ; i + + ) { \n - System . out . println ( "" testNestedAsyncConcat > > "" + i ) ; \n + for ( int i = 0 ; i < 500 ; i + + ) { \n + if ( i % 10 = = 0 ) { \n + System . out . println ( "" testNestedAsyncConcat > > "" + i ) ; \n + } \n + final CountDownLatch parentHasFinished = new CountDownLatch ( 1 ) ; \n + \n + \n + parentHasFinished . countDown ( ) ; \n + try { \n + / / wait for the parent to complete \n + if ( ! parentHasFinished . await ( 5 , TimeUnit . SECONDS ) ) { \n + fail ( "" Parent didn ' t finish within the time limit "" ) ; \n + } \n + } catch ( Throwable e ) { \n + throw new RuntimeException ( "" failed waiting on threads "" , e ) ; \n + } \n + \n",Fixed testNestedAsyncConcat not waiting for the parent to complete and \n misses the last onComplete,559
"src \ main \ java \ io \ reactivex \ internal \ queue \ SpscLinkedArrayQueue . java \n - } else if ( null ! = lvElement ( buffer , calcWrappedOffset ( index + 1 , mask ) ) ) { / / buffer is not full \n + } else if ( null = = lvElement ( buffer , calcWrappedOffset ( index + 1 , mask ) ) ) { / / buffer is not full \n",2 . x : fix SpscLinkedArrayQueue leaves 1 slot null just before growing,559
src \ test \ java \ rx \ BackpressureTests . java \n - final int NUM = ( int ) ( RxRingBuffer . SIZE * 1 . 5 ) ; / / > 1 so that take doesn ' t prevent buffer overflow \n + final int NUM = RxRingBuffer . SIZE * 3 ; / / > 1 so that take doesn ' t prevent buffer overflow \n,Added more to take to decrease the likelyhood that nothing is dropped .,559
"src \ main \ java \ rx \ subjects \ AsyncSubject . java \n - * < p > The can return { @ code null } for various reasons . Use { @ link # hasValue ( ) } , { @ link # hasThrowable ( ) } \n + * < p > The method can return { @ code null } for various reasons . Use { @ link # hasValue ( ) } , { @ link # hasThrowable ( ) } \n src \ main \ java \ rx \ subjects \ BehaviorSubject . java \n - * < p > The can return { @ code null } for various reasons . Use { @ link # hasValue ( ) } , { @ link # hasThrowable ( ) } \n + * < p > The method can return { @ code null } for various reasons . Use { @ link # hasValue ( ) } , { @ link # hasThrowable ( ) } \n",Small fix in the sentences of getValue .,559
"src \ test \ java \ io \ reactivex \ schedulers \ SchedulerLifecycleTest . java \n - import org . junit . Test ; \n + import org . junit . * ; \n - Set < Thread > rxThreads = new HashSet < Thread > ( ) ; \n + Set < Thread > rxThreadsBefore = new HashSet < Thread > ( ) ; \n - rxThreads . add ( t ) ; \n + rxThreadsBefore . add ( t ) ; \n - Set < Thread > rxThreads2 = new HashSet < Thread > ( ) ; \n + Set < Thread > rxThreadsAfter = new HashSet < Thread > ( ) ; \n - rxThreads2 . add ( t ) ; \n + rxThreadsAfter . add ( t ) ; \n + \n + / / cached threads may get dropped between the two checks \n + rxThreadsAfter . removeAll ( rxThreadsBefore ) ; \n - assertEquals ( rxThreads , rxThreads2 ) ; \n + Assert . assertTrue ( "" Some new threads appeared : "" + rxThreadsAfter , rxThreadsAfter . isEmpty ( ) ) ; \n",2 . x : fix SchedulerLifecycle . testStartIdempotence vs cached threads dying,559
. gitignore \n + \n + # PMD files \n + . pmd \n + . ruleset \n + \n + # Android Studio \n + local . properties \n,"Ignore PMD and android studio , also check if push is still enabled .",559
"src \ main \ java \ io \ reactivex \ Scheduler . java \n - * { @ link Flowable # zip ( Flowable , Flowable , rx . functions . Func2 ) } where \n + * { @ link Flowable # zip ( org . reactivestreams . Publisher , org . reactivestreams . Publisher , io . reactivex . functions . BiFunction ) } where \n src \ main \ java \ io \ reactivex \ internal \ schedulers \ SchedulerWhen . java \n - * When the { @ link Worker } is unsubscribed the { @ link Completable } emits an \n + * When the { @ link io . reactivex . Scheduler . Worker Worker } is unsubscribed the { @ link Completable } emits an \n - * the number of concurrent { @ link Worker } s rather than individual actions . \n - * Generally each { @ link Observable } uses its own { @ link Worker } . This means \n + * the number of concurrent { @ link io . reactivex . Scheduler . Worker Worker } s rather than individual actions . \n + * Generally each { @ link Observable } uses its own { @ link io . reactivex . Scheduler . Worker Worker } . This means \n - * { @ link Observable # zip ( Observable , Observable , rx . functions . Func2 ) } where \n + * { @ link Flowable # zip ( org . reactivestreams . Publisher , org . reactivestreams . Publisher , io . reactivex . functions . BiFunction ) } where \n - * \n - * @ param combine \n - * @ return \n - static abstract class ScheduledAction extends AtomicReference < Disposable > implements Disposable { \n - public ScheduledAction ( ) { \n + abstract static class ScheduledAction extends AtomicReference < Disposable > implements Disposable { \n + ScheduledAction ( ) { \n - private final void call ( Worker actualWorker , CompletableObserver actionCompletable ) { \n + void call ( Worker actualWorker , CompletableObserver actionCompletable ) { \n - public ImmediateAction ( Runnable action ) { \n + ImmediateAction ( Runnable action ) { \n - public DelayedAction ( Runnable action , long delayTime , TimeUnit unit ) { \n + DelayedAction ( Runnable action , long delayTime , TimeUnit unit ) { \n - public OnCompletedAction ( Runnable action , CompletableObserver actionCompletable ) { \n + OnCompletedAction ( Runnable action , CompletableObserver actionCompletable ) { \n",2 . x : Fix javadoc and style errors,559
README . md \n - compile ' io . reactivex : rxjava : 1 . 1 . 4 ' \n + compile ' io . reactivex : rxjava : 1 . 1 . 5 ' \n,Update readme to point to RxJava 1 . 1 . 5,559
src \ test \ java \ io \ reactivex \ internal \ util \ OpenHashSetTest . java \n + @ Override \n + public boolean equals ( Object o ) { \n + return this = = o ; \n + } \n,Add equals ( ) to the unit test to satisfy checkstyle,559
"build . gradle \n - \n - println ( "" Releasing with version "" + project . properties [ "" release . version "" ] ) ; \n + project . properties . put ( "" release . version "" , releaseTag ) ; \n + \n + println ( "" Releasing with version "" + version ) ; \n - println ( "" ReleaseMode : "" + rootProject . releaseMode ) ; \n - \n + def rver = version ; \n + \n + println ( "" ReleaseMode : "" + rootProject . releaseMode + "" version "" + rver ) ; \n + \n","2 . x : fix "" full "" mode gradle code",559
"build . gradle \n - repo = "" generic "" \n - name = "" rxjava "" \n + repo = "" RxJava "" \n + name = "" RxJava "" \n",2 . x : fix bintray repo and name config,559
"build . gradle \n - publications = [ "" mavenJava "" ] \n",2 . x : RC4 fix maven - POM generation again,559
"src \ main \ java \ io \ reactivex \ observers \ DisposableObserver . java \n - * < p > Like all other consumers , { @ code DefaultObserver } can be subscribed only once . \n + * < p > Like all other consumers , { @ code DisposableObserver } can be subscribed only once . \n src \ main \ java \ io \ reactivex \ subscribers \ DisposableSubscriber . java \n - * < p > Like all other consumers , { @ code DefaultSubscriber } can be subscribed only once . \n + * < p > Like all other consumers , { @ code DisposableSubscriber } can be subscribed only once . \n",2 . x : fix DisposableX copy - paste error in javadoc,559
src \ main \ java \ io \ reactivex \ observables \ package - info . java \n - * { @ link io . reactivex . observable . ConnectableObservable } and \n - * { @ link io . reactivex . observable . GroupedObservable } . \n + * { @ link io . reactivex . observables . ConnectableObservable } and \n + * { @ link io . reactivex . observables . GroupedObservable } . \n,2 . x : fix javadoc link in observables / package - info,559
src \ main \ java \ io \ reactivex \ flowables \ ConnectableFlowable . java \n - * @ param connection the callback Action1 that will receive the Subscription representing the \n + * @ param connection the callback Consumer that will receive the Subscription representing the \n src \ main \ java \ io \ reactivex \ internal \ operators \ flowable \ FlowableRefCount . java \n - / / outside of this class thus preventing the Action1 passed \n + / / outside of this class thus preventing the Consumer passed \n - / / Action1 passed to source . connect was not called \n + / / Consumer passed to source . connect was not called \n src \ main \ java \ io \ reactivex \ internal \ operators \ observable \ ObservableRefCount . java \n - / / outside of this class thus preventing the Action1 passed \n + / / outside of this class thus preventing the Consumer passed \n - / / Action1 passed to source . connect was not called \n + / / Consumer passed to source . connect was not called \n src \ main \ java \ io \ reactivex \ observables \ ConnectableObservable . java \n - * @ param connection the callback Action1 that will receive the Subscription representing the \n + * @ param connection the callback Consumer that will receive the Subscription representing the \n,2 . x : Replace Action1 with Consumer in docs,559
"build . gradle \n + print ( "" Memory usage before : "" ) \n + println ( java . lang . management . ManagementFactory . getMemoryMXBean ( ) . getHeapMemoryUsage ( ) . getUsed ( ) / 1024 . 0 / 1024 . 0 ) \n + task GCandMem2 ( dependsOn : ' test ' ) < < { \n + print ( "" Memory usage before : "" ) \n + println ( java . lang . management . ManagementFactory . getMemoryMXBean ( ) . getHeapMemoryUsage ( ) . getUsed ( ) / 1024 . 0 / 1024 . 0 ) \n + System . gc ( ) \n + Thread . sleep ( 200 ) \n + print ( "" Memory usage : "" ) \n + println ( java . lang . management . ManagementFactory . getMemoryMXBean ( ) . getHeapMemoryUsage ( ) . getUsed ( ) / 1024 . 0 / 1024 . 0 ) \n + } \n + \n + testng . dependsOn GCandMem2 \n + \n","Run GC before the TestNG to avoid kill 137 , hopefully",559
src \ test \ java \ io \ reactivex \ TestHelper . java \n + * @ param < T > the input value type \n,2 . x : add missing < T > javadoc,559
src \ main \ java \ io \ reactivex \ schedulers \ Schedulers . java \n - * The implementation is backed by a pool of single - threaded { link ScheduledExecutorService } instances \n + * The implementation is backed by a pool of single - threaded { @ link ScheduledExecutorService } instances \n - * { link ScheduledExecutorService } instance . Note that this scheduler may create an unbounded number \n + * { @ link ScheduledExecutorService } instance . Note that this scheduler may create an unbounded number \n,2 . x : fix Schedulers . io ( ) javadoc { link missing the @ symbol,559
src \ main \ java \ io \ reactivex \ Single . java \n - * @ param scheduler the target scheduler to use fro the non - blocking wait and emission \n + * @ param scheduler the target scheduler to use for the non - blocking wait and emission \n,2 . x : Fix a small typo in Single . delay,559
src \ main \ java \ io \ reactivex \ Flowable . java \n - * < p > This method executes the { @ code Consumer } on the current thread while \n + * This method executes the { @ code Consumer } on the current thread while \n src \ main \ java \ io \ reactivex \ Observable . java \n - * < p > This method executes the { @ code Consumer } on the current thread while \n + * This method executes the { @ code Consumer } on the current thread while \n,2 . x : Fix Javadoc warnings on empty < p >,559
"src \ main \ java \ io \ reactivex \ Completable . java \n - * < img width = "" 640 "" height = "" 442 "" src = "" https : / / raw . github . com / wiki / ReactiveX / RxJava / images / rx - operators / Completable . fromPublisher . png "" alt = "" "" > \n + * < img width = "" 640 "" height = "" 422 "" src = "" https : / / raw . github . com / wiki / ReactiveX / RxJava / images / rx - operators / Completable . fromPublisher . png "" alt = "" "" > \n - * < p > \n - * < img width = "" 640 "" height = "" 293 "" src = "" https : / / raw . github . com / wiki / ReactiveX / RxJava / images / rx - operators / Completable . toObservable . png "" alt = "" "" > \n + * < p > \n + * < img width = "" 640 "" height = "" 293 "" src = "" https : / / raw . github . com / wiki / ReactiveX / RxJava / images / rx - operators / Completable . toObservable . png "" alt = "" "" > \n",2 . x : Fix aspect of some Completable marbles .,559
"docs \ Operator - Matrix . md \n - esent ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ absent ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ off . png ) | \n - ` zipWith ` | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ present ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ on . png ) | ! [ absent ] ( https : / / raw . github . com / wiki / ReactiveX / RxJava / images / checkmark _ off . png ) | \n docs \ _ Sidebar . md . md \n + * [ Operator matrix ] ( https : / / github . com / ReactiveX / RxJava / wiki / Operator - Matrix ) \n src \ test \ java \ io \ reactivex \ rxjava3 \ internal \ util \ OperatorMatrixGenerator . java \n - try ( PrintWriter out = new PrintWriter ( Files . newBufferedWriter ( Paths . get ( "" docs "" , "" Operator - Matrix . md "" ) , StandardOpenOption . CREATE ) ) ) { \n + try ( PrintWriter out = new PrintWriter ( Files . newBufferedWriter ( Paths . get ( "" docs "" , "" Operator - Matrix . md "" ) , StandardOpenOption . CREATE , StandardOpenOption . TRUNCATE _ EXISTING ) ) ) { \n",Fix a minor mistake in the generator and docs,559
"src \ main \ java \ io \ reactivex \ rxjava3 \ internal \ operators \ maybe \ MaybeZipArray . java \n - import java . util . Arrays ; \n src \ main \ java \ io \ reactivex \ rxjava3 \ internal \ operators \ single \ SingleZipArray . java \n - import java . util . Arrays ; \n src \ test \ java \ io \ reactivex \ rxjava3 \ internal \ operators \ maybe \ MaybeZipArrayTest . java \n + \n + @ Test \n + public void onSuccessAfterDispose ( ) { \n + AtomicReference < MaybeObserver < ? super Integer > > emitter = new AtomicReference < > ( ) ; \n + \n + TestObserver < List < Object > > to = Maybe . zipArray ( Arrays : : asList , \n + ( MaybeSource < Integer > ) o - > emitter . set ( o ) , Maybe . < Integer > never ( ) ) \n + . test ( ) ; \n + \n + emitter . get ( ) . onSubscribe ( Disposable . empty ( ) ) ; \n + \n + to . dispose ( ) ; \n + \n + emitter . get ( ) . onSuccess ( 1 ) ; \n + \n + to . assertEmpty ( ) ; \n + } \n src \ test \ java \ io \ reactivex \ rxjava3 \ internal \ operators \ single \ SingleZipArrayTest . java \n + import java . util . concurrent . atomic . AtomicReference ; \n + import io . reactivex . rxjava3 . disposables . Disposable ; \n + \n + @ Test \n + public void onSuccessAfterDispose ( ) { \n + AtomicReference < SingleObserver < ? super Integer > > emitter = new AtomicReference < > ( ) ; \n + \n + TestObserver < List < Object > > to = Single . zipArray ( Arrays : : asList , \n + ( SingleSource < Integer > ) o - > emitter . set ( o ) , Single . < Integer > never ( ) ) \n + . test ( ) ; \n + \n + emitter . get ( ) . onSubscribe ( Disposable . empty ( ) ) ; \n + \n + to . dispose ( ) ; \n + \n + emitter . get ( ) . onSuccess ( 1 ) ; \n + \n + to . assertEmpty ( ) ; \n + } \n",3 . x : Cover changes of # 7196,559
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 114 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 115 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / charlesfinley "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6307904 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt Dolan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = charlesfinley "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" charlesfinley "" , \n + "" name "" : "" Matt Dolan "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6307904 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / charlesfinley "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 115 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 116 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / MananS77 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 21033516 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Manan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AMananS77 "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" MananS77 "" , \n + "" name "" : "" Manan "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 21033516 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / MananS77 "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 116 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 117 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / nishant "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 15331971 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Nishant Arora < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = nishant "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" nishant "" , \n + "" name "" : "" Nishant Arora "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 15331971 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / nishant "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 117 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 118 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / raja - peeyush - kumar - singh "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 5496024 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Peeyush < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = raja - peeyush - kumar - singh "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" raja - peeyush - kumar - singh "" , \n + "" name "" : "" Peeyush "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 5496024 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / raja - peeyush - kumar - singh "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 129 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 130 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / fedorskvorcov "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 43882212 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Fedor Skvorcov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = fedorskvorcov "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" fedorskvorcov "" , \n + "" name "" : "" Fedor Skvorcov "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 43882212 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / fedorskvorcov "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 140 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 141 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / ibrahimalii . github . io / "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 21141301 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ibrahim ali abdelghany < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AibrahimAlii "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ibrahimAlii "" , \n + "" name "" : "" Ibrahim ali abdelghany "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 21141301 ? v = 4 "" , \n + "" profile "" : "" https : / / ibrahimalii . github . io / "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / charlesfinley "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6307904 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt Dolan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = charlesfinley "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / charlesfinley "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6307904 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt Dolan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = charlesfinley "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Acharlesfinley "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" review "" \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 118 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 119 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / ravening "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 10645273 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rakesh < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ravening "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ravening "" , \n + "" name "" : "" Rakesh "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 10645273 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ravening "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 133 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 134 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / christophflick . de "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 4465376 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christoph Flick < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ChFlick "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ChFlick "" , \n + "" name "" : "" Christoph Flick "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 4465376 ? v = 4 "" , \n + "" profile "" : "" http : / / christophflick . de "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 141 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 142 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / gkulkarni2020 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 5161548 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Girish Kulkarni < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gkulkarni2020 "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" gkulkarni2020 "" , \n + "" name "" : "" Girish Kulkarni "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 5161548 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / gkulkarni2020 "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" doc "" \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / Anurag870 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6295975 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Anurag870 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Anurag870 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / Anurag870 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6295975 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Anurag870 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Anurag870 "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Anurag870 "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : add Anurag870 as a contributor ( # 1609 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n * Update README . md \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com > \n Co - authored - by : Ilkka Seppälä < iluwatar @ users . noreply . github . com >,561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 130 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 131 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / samilAyoub "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 61546990 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > samilAyoub < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = samilAyoub "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" samilAyoub "" , \n + "" name "" : "" samilAyoub "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 61546990 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / samilAyoub "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / ravening "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 10645273 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rakesh < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ravening "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / ravening "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 10645273 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rakesh < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ravening "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Aravening "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" review "" \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 134 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 135 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / Ascenio "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 7662016 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ascênio < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AAscenio "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" Ascenio "" , \n + "" name "" : "" Ascênio "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 7662016 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Ascenio "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 135 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 136 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / domenico - sibilio / "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 24280982 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Domenico Sibilio < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = dsibilio "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" dsibilio "" , \n + "" name "" : "" Domenico Sibilio "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 24280982 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / domenico - sibilio / "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 136 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 137 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / akashchandwani "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 3483277 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Akash Chandwani < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Aakashchandwani "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" akashchandwani "" , \n + "" name "" : "" Akash Chandwani "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 3483277 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / akashchandwani "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" omk13 "" , \n + "" name "" : "" Omar Karazoun "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 59054172 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / omk13 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 142 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 143 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / omk13 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 59054172 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Omar Karazoun < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = omk13 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add omk13 as a contributor ( # 1611 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" jeff303 "" , \n + "" name "" : "" Jeff Evans "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 3521562 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / jeff303 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 143 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 144 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / jeff303 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 3521562 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Jeff Evans < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = jeff303 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add jeff303 as a contributor ( # 1612 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" projectManagement "" \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / iluwatar "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 582346 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ilkka Seppälä < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = iluwatar "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / iluwatar "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 582346 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ilkka Seppälä < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = iluwatar "" title = "" Code "" > 💻 < / a > < a href = "" # projectManagement - iluwatar "" title = "" Project Management "" > 📆 < / a > < / td > \n",docs : add iluwatar as a contributor ( # 1344 ) \n * docs : update README . md [ skip ci ] \n * docs : create . all - contributorsrc [ skip ci ] \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < iluwatar @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" amit1307 "" , \n + "" name "" : "" amit1307 "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 23420222 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / amit1307 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 1 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 2 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / amit1307 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 23420222 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > amit1307 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = amit1307 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add amit1307 as a contributor ( # 1345 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" fluxw42 "" , \n + "" name "" : "" Jeroen Meulemeester "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 1545460 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / fluxw42 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 3 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 4 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / fluxw42 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 1545460 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Jeroen Meulemeester < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = fluxw42 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add fluxw42 as a contributor ( # 1348 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" thomasoss "" , \n + "" name "" : "" Thomas "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 22516154 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / thomasoss "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 5 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 6 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / thomasoss "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 22516154 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Thomas < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = thomasoss "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add thomasoss as a contributor ( # 1350 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" anuragagarwal561994 "" , \n + "" name "" : "" Anurag Agarwal "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6075379 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / anuragagarwal561994 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 6 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 7 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / anuragagarwal561994 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6075379 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Anurag Agarwal < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = anuragagarwal561994 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add anuragagarwal561994 as a contributor ( # 1351 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" markusmo3 "" , \n + "" name "" : "" Markus Moser "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 3317416 ? v = 4 "" , \n + "" profile "" : "" https : / / markusmo3 . github . io "" , \n + "" contributions "" : [ \n + "" design "" , \n + "" code "" , \n + "" ideas "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 7 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 8 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / markusmo3 . github . io "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 3317416 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Markus Moser < / b > < / sub > < / a > < br / > < a href = "" # design - markusmo3 "" title = "" Design "" > 🎨 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = markusmo3 "" title = "" Code "" > 💻 < / a > < a href = "" # ideas - markusmo3 "" title = "" Ideas , Planning , & Feedback "" > 🤔 < / a > < / td > \n + < / tr > \n",docs : add markusmo3 as a contributor ( # 1352 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" isabiq "" , \n + "" name "" : "" Sabiq Ihab "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 19510920 ? v = 4 "" , \n + "" profile "" : "" https : / / twitter . com / i _ sabiq "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 8 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 9 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / twitter . com / i _ sabiq "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 19510920 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Sabiq Ihab < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = isabiq "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add isabiq as a contributor ( # 1353 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" inbravo "" , \n + "" name "" : "" Amit Dixit "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 5253764 ? v = 4 "" , \n + "" profile "" : "" http : / / inbravo . github . io "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 9 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 10 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / inbravo . github . io "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 5253764 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Amit Dixit < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = inbravo "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add inbravo as a contributor ( # 1354 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" piyushchaudhari04 "" , \n + "" name "" : "" Piyush Kailash Chaudhari "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 10268029 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / piyushchaudhari04 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 10 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 11 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / piyushchaudhari04 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 10268029 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Piyush Kailash Chaudhari < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = piyushchaudhari04 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add piyushchaudhari04 as a contributor ( # 1355 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" joshzambales "" , \n + "" name "" : "" joshzambales "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 8704552 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / joshzambales "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 11 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 12 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / joshzambales "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 8704552 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > joshzambales < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = joshzambales "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add joshzambales as a contributor ( # 1356 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" Crossy147 "" , \n + "" name "" : "" Kamil Pietruszka "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 7272996 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Crossy147 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 12 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 13 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / Crossy147 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 7272996 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kamil Pietruszka < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Crossy147 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Crossy147 as a contributor ( # 1357 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" zafarella "" , \n + "" name "" : "" Zafar Khaydarov "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 660742 ? v = 4 "" , \n + "" profile "" : "" http : / / cs . joensuu . fi / ~ zkhayda "" , \n + "" contributions "" : [ \n + "" code "" , \n + "" doc "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 13 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 14 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / cs . joensuu . fi / ~ zkhayda "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 660742 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Zafar Khaydarov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = zafarella "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = zafarella "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : add zafarella as a contributor ( # 1358 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" kemitix "" , \n + "" name "" : "" Paul Campbell "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 1147749 ? v = 4 "" , \n + "" profile "" : "" https : / / kemitix . github . io / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 14 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 15 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / kemitix . github . io / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 1147749 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Paul Campbell < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = kemitix "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add kemitix as a contributor ( # 1359 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" Argyro - Sioziou "" , \n + "" name "" : "" Argyro Sioziou "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 22822639 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Argyro - Sioziou "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 15 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 16 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / Argyro - Sioziou "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 22822639 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Argyro Sioziou < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Argyro - Sioziou "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Argyro - Sioziou as a contributor ( # 1360 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" TylerMcConville "" , \n + "" name "" : "" TylerMcConville "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 4946449 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / TylerMcConville "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 16 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 17 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / TylerMcConville "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 4946449 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > TylerMcConville < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = TylerMcConville "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add TylerMcConville as a contributor ( # 1361 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" saksham93 "" , \n + "" name "" : "" saksham93 "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 37399540 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / saksham93 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 17 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 18 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / saksham93 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 37399540 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > saksham93 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = saksham93 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add saksham93 as a contributor ( # 1362 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" nikhilbarar "" , \n + "" name "" : "" nikhilbarar "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 37332144 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / nikhilbarar "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 18 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 19 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / nikhilbarar "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 37332144 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > nikhilbarar < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = nikhilbarar "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add nikhilbarar as a contributor ( # 1363 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" colinbut "" , \n + "" name "" : "" Colin But "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 10725674 ? v = 4 "" , \n + "" profile "" : "" http : / / colinbut . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 19 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 20 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / colinbut . com "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10725674 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Colin But < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = colinbut "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add colinbut as a contributor ( # 1364 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ruslanpa "" , \n + "" name "" : "" Ruslan "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 1503411 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ruslanpa "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 20 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 21 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / ruslanpa "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 1503411 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ruslan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ruslanpa "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add ruslanpa as a contributor ( # 1365 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" JuhoKang "" , \n + "" name "" : "" Juho Kang "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 4745294 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / JuhoKang "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 21 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 22 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / JuhoKang "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 4745294 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Juho Kang < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = JuhoKang "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add JuhoKang as a contributor ( # 1366 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" dheeraj - mummareddy "" , \n + "" name "" : "" Dheeraj Mummareddy "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 7002230 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / dheeraj - mummareddy "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 22 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 23 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / dheeraj - mummareddy "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 7002230 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Dheeraj Mummareddy < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = dheeraj - mummareddy "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add dheeraj - mummareddy as a contributor ( # 1367 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" bernardosulzbach "" , \n + "" name "" : "" Bernardo Sulzbach "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 8271090 ? v = 4 "" , \n + "" profile "" : "" https : / / www . bernardosulzbach . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 23 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 24 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / www . bernardosulzbach . com "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 8271090 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Bernardo Sulzbach < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = bernardosulzbach "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add bernardosulzbach as a contributor ( # 1368 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" 4lexis "" , \n + "" name "" : "" Aleksandar Dudukovic "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 19871727 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / 4lexis "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 24 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 25 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / 4lexis "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 19871727 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Aleksandar Dudukovic < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = 4lexis "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add 4lexis as a contributor ( # 1369 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" yusufaytas "" , \n + "" name "" : "" Yusuf Aytaş "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 1049483 ? v = 4 "" , \n + "" profile "" : "" https : / / www . yusufaytas . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 25 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 26 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / www . yusufaytas . com "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 1049483 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Yusuf Aytaş < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = yusufaytas "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add yusufaytas as a contributor ( # 1370 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" qpi "" , \n + "" name "" : "" Mihály Kuprivecz "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 1001491 ? v = 4 "" , \n + "" profile "" : "" http : / / futurehomes . hu "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 26 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 27 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / futurehomes . hu "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 1001491 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Mihály Kuprivecz < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = qpi "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add qpi as a contributor ( # 1371 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" kapinuss "" , \n + "" name "" : "" Stanislav Kapinus "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 17639945 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / kapinuss "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 27 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 28 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / kapinuss "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 17639945 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Stanislav Kapinus < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = kapinuss "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add kapinuss as a contributor ( # 1372 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" gvsharma "" , \n + "" name "" : "" GVSharma "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6648152 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / gvsharma "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 28 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 29 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / gvsharma "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6648152 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > GVSharma < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gvsharma "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add gvsharma as a contributor ( # 1373 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" SrdjanPaunovic "" , \n + "" name "" : "" Srđan Paunović "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 22815104 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / SrdjanPaunovic "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 29 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 30 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / SrdjanPaunovic "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 22815104 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Srđan Paunović < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = SrdjanPaunovic "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add SrdjanPaunovic as a contributor ( # 1374 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" robertt240 "" , \n + "" name "" : "" Robert Kasperczyk "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 9137432 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / robertt240 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 31 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 32 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / robertt240 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 9137432 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Robert Kasperczyk < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = robertt240 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add robertt240 as a contributor ( # 1376 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" okinskas "" , \n + "" name "" : "" Ovidijus Okinskas "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 20372387 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / ovidijus - okinskas / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / ovidijus - okinskas / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 20372387 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ovidijus Okinskas < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = okinskas "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add okinskas as a contributor ( # 1377 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" ankurkaushal "" , \n + "" name "" : "" Ankur Kaushal "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 2236616 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ankurkaushal "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / ankurkaushal "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 2236616 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ankur Kaushal < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ankurkaushal "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add ankurkaushal as a contributor ( # 1378 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Tschis "" , \n + "" name "" : "" Rodolfo Forte "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 20662669 ? v = 4 "" , \n + "" profile "" : "" http : / / tschis . github . io "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / tschis . github . io "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 20662669 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rodolfo Forte < / b > < / sub > < / a > < br / > < a href = "" # content - Tschis "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add Tschis as a contributor ( # 1379 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" qza "" , \n + "" name "" : "" qza "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 233149 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / qza "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / qza "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 233149 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > qza < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = qza "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add qza as a contributor ( # 1380 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" pitsios - s "" , \n + "" name "" : "" Stamatis Pitsios "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6773603 ? v = 4 "" , \n + "" profile "" : "" https : / / twitter . com / StPitsios "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / twitter . com / StPitsios "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6773603 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Stamatis Pitsios < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = pitsios - s "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add pitsios - s as a contributor ( # 1381 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 103 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 104 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / grzesiekkedzior "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > grzesiekkedzior < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = grzesiekkedzior "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" grzesiekkedzior "" , \n + "" name "" : "" grzesiekkedzior "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / grzesiekkedzior "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + { \n + "" login "" : "" llitfkitfk "" , \n + "" name "" : "" 田浩 "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 2404785 ? v = 4 "" , \n + "" profile "" : "" https : / / t . me / paul _ docker "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / twitter . com / StPitsios "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6773603 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Stamatis Pitsios < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = pitsios - s "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / t . me / paul _ docker "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2404785 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > 田浩 < / b > < / sub > < / a > < br / > < a href = "" # content - llitfkitfk "" title = "" Content "" > 🖋 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / twitter . com / StPitsios "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6773603 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Stamatis Pitsios < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = pitsios - s "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add llitfkitfk as a contributor ( # 1382 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" gwildor28 "" , \n + "" name "" : "" gwildor28 "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 16000365 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / gwildor28 "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / t . me / paul _ docker "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2404785 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > 田浩 < / b > < / sub > < / a > < br / > < a href = "" # content - llitfkitfk "" title = "" Content "" > 🖋 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / gwildor28 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 16000365 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gwildor28 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gwildor28 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / t . me / paul _ docker "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2404785 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > 田浩 < / b > < / sub > < / a > < br / > < a href = "" # content - llitfkitfk "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add gwildor28 as a contributor ( # 1383 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" amit2103 "" , \n + "" name "" : "" Amit Pandey "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 7566692 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / amit2103 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / gwildor28 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 16000365 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gwildor28 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gwildor28 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / amit2103 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 7566692 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Amit Pandey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = amit2103 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / gwildor28 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 16000365 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gwildor28 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gwildor28 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add amit2103 as a contributor ( # 1384 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" hoswey "" , \n + "" name "" : "" Hoswey "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 3689445 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / hoswey "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / amit2103 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 7566692 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Amit Pandey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = amit2103 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / hoswey "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 3689445 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hoswey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hoswey "" title = "" Code "" > 💻 < / a > < / td > \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / amit2103 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 7566692 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Amit Pandey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = amit2103 "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add hoswey as a contributor ( # 1385 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" gopinath - langote "" , \n + "" name "" : "" Gopinath Langote "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 10210778 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / gopinathlangote / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / hoswey "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 3689445 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hoswey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hoswey "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / gopinathlangote / "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10210778 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Gopinath Langote < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gopinath - langote "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / hoswey "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 3689445 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hoswey < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hoswey "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add gopinath - langote as a contributor ( # 1386 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" ThatGuyWithTheHat "" , \n + "" name "" : "" Matt "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 24470582 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ThatGuyWithTheHat "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / gopinathlangote / "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10210778 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Gopinath Langote < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gopinath - langote "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / ThatGuyWithTheHat "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 24470582 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt < / b > < / sub > < / a > < br / > < a href = "" # content - ThatGuyWithTheHat "" title = "" Content "" > 🖋 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / gopinathlangote / "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10210778 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Gopinath Langote < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = gopinath - langote "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add ThatGuyWithTheHat as a contributor ( # 1387 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" vehpsr "" , \n + "" name "" : "" gans "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 3133265 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / vehpsr "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / ThatGuyWithTheHat "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 24470582 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt < / b > < / sub > < / a > < br / > < a href = "" # content - ThatGuyWithTheHat "" title = "" Content "" > 🖋 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / vehpsr "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 3133265 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gans < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vehpsr "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / ThatGuyWithTheHat "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 24470582 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Matt < / b > < / sub > < / a > < br / > < a href = "" # content - ThatGuyWithTheHat "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add vehpsr as a contributor ( # 1389 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Azureyjt "" , \n + "" name "" : "" Azureyjt "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 18476317 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Azureyjt "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / vehpsr "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 3133265 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gans < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vehpsr "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / Azureyjt "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 18476317 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Azureyjt < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Azureyjt "" title = "" Code "" > 💻 < / a > < / td > \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / vehpsr "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 3133265 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > gans < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vehpsr "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add Azureyjt as a contributor ( # 1388 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" mookkiah "" , \n + "" name "" : "" Mahendran Mookkiah "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 8975264 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / mookkiah "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / Azureyjt "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 18476317 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Azureyjt < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Azureyjt "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / mookkiah "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 8975264 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Mahendran Mookkiah < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = mookkiah "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / Azureyjt "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 18476317 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Azureyjt < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Azureyjt "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add mookkiah as a contributor ( # 1390 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" llorllale "" , \n + "" name "" : "" George Aristy "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 2019896 ? v = 4 "" , \n + "" profile "" : "" https : / / llorllale . github . io / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / mookkiah "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 8975264 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Mahendran Mookkiah < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = mookkiah "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / llorllale . github . io / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2019896 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Aristy < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = llorllale "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / mookkiah "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 8975264 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Mahendran Mookkiah < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = mookkiah "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add llorllale as a contributor ( # 1391 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" igeligel "" , \n + "" name "" : "" Kevin Peters "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 12736734 ? v = 4 "" , \n + "" profile "" : "" https : / / www . kevinpeters . net / about / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / llorllale . github . io / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2019896 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Aristy < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = llorllale "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / www . kevinpeters . net / about / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 12736734 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kevin Peters < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = igeligel "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / llorllale . github . io / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2019896 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Aristy < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = llorllale "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add igeligel as a contributor ( # 1392 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" hbothra15 "" , \n + "" name "" : "" Hemant Bothra "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 7418012 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / hbothra15 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / www . kevinpeters . net / about / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 12736734 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kevin Peters < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = igeligel "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / hbothra15 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 7418012 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hemant Bothra < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hbothra15 "" title = "" Code "" > 💻 < / a > < / td > \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / www . kevinpeters . net / about / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 12736734 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kevin Peters < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = igeligel "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add hbothra15 as a contributor ( # 1393 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" giorgosmav21 "" , \n + "" name "" : "" George Mavroeidis "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 22855493 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / giorgosmav21 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / hbothra15 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 7418012 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hemant Bothra < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hbothra15 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / giorgosmav21 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 22855493 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Mavroeidis < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = giorgosmav21 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / hbothra15 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 7418012 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hemant Bothra < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hbothra15 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add giorgosmav21 as a contributor ( # 1394 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" oconnelc "" , \n + "" name "" : "" Christopher O ' Connell "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1112973 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / oconnelc "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / giorgosmav21 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 22855493 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Mavroeidis < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = giorgosmav21 "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / oconnelc "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1112973 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christopher O ' Connell < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = oconnelc "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / giorgosmav21 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 22855493 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > George Mavroeidis < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = giorgosmav21 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add oconnelc as a contributor ( # 1395 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" npczwh "" , \n + "" name "" : "" Zhang WH "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 14066422 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / npczwh "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / oconnelc "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1112973 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christopher O ' Connell < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = oconnelc "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / npczwh "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 14066422 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Zhang WH < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = npczwh "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / oconnelc "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1112973 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christopher O ' Connell < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = oconnelc "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add npczwh as a contributor ( # 1396 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" leogtzr "" , \n + "" name "" : "" Leo Gutiérrez Ramírez "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1211969 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / leogtzr "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / leogtzr "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1211969 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Leo Gutiérrez Ramírez < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = leogtzr "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add leogtzr as a contributor ( # 1397 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" hannespernpeintner "" , \n + "" name "" : "" Hannes "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 1679437 ? v = 4 "" , \n + "" profile "" : "" https : / / bitbucket . org / hannespernpeintner / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / bitbucket . org / hannespernpeintner / "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 1679437 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hannes < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hannespernpeintner "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add hannespernpeintner as a contributor ( # 1398 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" dgruntz "" , \n + "" name "" : "" Dominik Gruntz "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1516800 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / dgruntz "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / dgruntz "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1516800 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Dominik Gruntz < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = dgruntz "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add dgruntz as a contributor ( # 1399 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" christofferh "" , \n + "" name "" : "" Christoffer Hamberg "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 767643 ? v = 4 "" , \n + "" profile "" : "" https : / / christofferh . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / christofferh . com "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 767643 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christoffer Hamberg < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = christofferh "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add christofferh as a contributor ( # 1400 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" AnaghaSasikumar "" , \n + "" name "" : "" AnaghaSasikumar "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 42939261 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / AnaghaSasikumar "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / AnaghaSasikumar "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 42939261 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > AnaghaSasikumar < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = AnaghaSasikumar "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add AnaghaSasikumar as a contributor ( # 1401 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" waisuan "" , \n + "" name "" : "" Evan Sia Wai Suan "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 10975700 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / waisuan "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / waisuan "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10975700 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Evan Sia Wai Suan < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = waisuan "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add waisuan as a contributor ( # 1402 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" perwramdemark "" , \n + "" name "" : "" Per Wramdemark "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 7052193 ? v = 4 "" , \n + "" profile "" : "" http : / / www . wramdemark . se "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / www . wramdemark . se "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 7052193 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Per Wramdemark < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = perwramdemark "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add perwramdemark as a contributor ( # 1403 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" leonmak "" , \n + "" name "" : "" Leon Mak "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 13071508 ? v = 4 "" , \n + "" profile "" : "" http : / / leonmak . me "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / leonmak . me "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 13071508 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Leon Mak < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = leonmak "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n + < tr > \n",docs : add leonmak as a contributor ( # 1404 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" kanwarpreet25 "" , \n + "" name "" : "" kanwarpreet25 "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 39183641 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / kanwarpreet25 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / kanwarpreet25 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 39183641 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > kanwarpreet25 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = kanwarpreet25 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add kanwarpreet25 as a contributor ( # 1405 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" MSaifAsif "" , \n + "" name "" : "" M Saif Asif "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6280554 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / MSaifAsif "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / MSaifAsif "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6280554 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > M Saif Asif < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = MSaifAsif "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add MSaifAsif as a contributor ( # 1406 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Alwayswithme "" , \n + "" name "" : "" PhoenixYip "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 3234786 ? v = 4 "" , \n + "" profile "" : "" https : / / alwayswithme . github . io "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / alwayswithme . github . io "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 3234786 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > PhoenixYip < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Alwayswithme "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Alwayswithme as a contributor ( # 1407 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" ranjeet - floyd "" , \n + "" name "" : "" Ranjeet "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1992972 ? v = 4 "" , \n + "" profile "" : "" https : / / ranjeet - floyd . github . io "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / ranjeet - floyd . github . io "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1992972 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ranjeet < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ranjeet - floyd "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add ranjeet - floyd as a contributor ( # 1408 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" mitchellirvin "" , \n + "" name "" : "" Mitchell Irvin "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 16233245 ? v = 4 "" , \n + "" profile "" : "" http : / / mitchell - irvin . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / mitchell - irvin . com "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 16233245 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Mitchell Irvin < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = mitchellirvin "" title = "" Code "" > 💻 < / a > < / td > \n + < tr > \n + < / tr > \n + < tr > \n + < / tr > \n + < tr > \n + < / tr > \n + < tr > \n + < / tr > \n + < tr > \n + < / tr > \n",docs : add mitchellirvin as a contributor ( # 1409 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" kirill - vlasov "" , \n + "" name "" : "" Kirill Vlasov "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 16112495 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / kirill - vlasov "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / kirill - vlasov "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 16112495 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kirill Vlasov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = kirill - vlasov "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add kirill - vlasov as a contributor ( # 1410 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" joningiwork "" , \n + "" name "" : "" Jón Ingi Sveinbjörnsson "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 6115148 ? v = 4 "" , \n + "" profile "" : "" http : / / joningi . net "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / joningi . net "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 6115148 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Jón Ingi Sveinbjörnsson < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = joningiwork "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add joningiwork as a contributor ( # 1411 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" jarpit96 "" , \n + "" name "" : "" Arpit Jain "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 10098713 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / jarpit96 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / jarpit96 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10098713 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Arpit Jain < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = jarpit96 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add jarpit96 as a contributor ( # 1412 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" hoangnam2261 "" , \n + "" name "" : "" hoangnam2261 "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 31692990 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / hoangnam2261 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / hoangnam2261 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 31692990 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > hoangnam2261 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hoangnam2261 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add hoangnam2261 as a contributor ( # 1413 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" fanofxiaofeng "" , \n + "" name "" : "" 靳阳 "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 3983683 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / fanofxiaofeng "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / fanofxiaofeng "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 3983683 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > 靳阳 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = fanofxiaofeng "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add fanofxiaofeng as a contributor ( # 1414 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" dmitraver "" , \n + "" name "" : "" Dmitry Avershin "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 1798156 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / dmitraver "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / dmitraver "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 1798156 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Dmitry Avershin < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = dmitraver "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add dmitraver as a contributor ( # 1415 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" besok "" , \n + "" name "" : "" Boris "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 29834592 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / besok "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / besok "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 29834592 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Boris < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = besok "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add besok as a contributor ( # 1416 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" baislsl "" , \n + "" name "" : "" Shengli Bai "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 17060584 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / baislsl "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < / tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / baislsl "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 17060584 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Shengli Bai < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = baislsl "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add baislsl as a contributor ( # 1417 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" akrystian "" , \n + "" name "" : "" adamski . pro "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6537430 ? v = 4 "" , \n + "" profile "" : "" http : / / adamski . pro "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / adamski . pro "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6537430 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > adamski . pro < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = akrystian "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add akrystian as a contributor ( # 1418 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Rzeposlaw "" , \n + "" name "" : "" Katarzyna Rzepecka "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 18425745 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Rzeposlaw "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / Rzeposlaw "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 18425745 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Katarzyna Rzepecka < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Rzeposlaw "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Rzeposlaw as a contributor ( # 1419 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" LuigiCortese "" , \n + "" name "" : "" Luigi Cortese "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 9956006 ? v = 4 "" , \n + "" profile "" : "" http : / / www . devsedge . net / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / www . devsedge . net / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 9956006 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Luigi Cortese < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = LuigiCortese "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add LuigiCortese as a contributor ( # 1420 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Juaanma "" , \n + "" name "" : "" Juan Manuel Suárez "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 7390500 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Juaanma "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / Juaanma "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 7390500 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Juan Manuel Suárez < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Juaanma "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Juaanma as a contributor ( # 1421 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" 7agustibm "" , \n + "" name "" : "" Agustí Becerra Milà "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 8149332 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / 7agustibm "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / 7agustibm "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 8149332 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Agustí Becerra Milà < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = 7agustibm "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add 7agustibm as a contributor ( # 1422 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" yosfik "" , \n + "" name "" : "" Yosfik Alqadri "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 4850270 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / yosfik "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / yosfik "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 4850270 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Yosfik Alqadri < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = yosfik "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add yosfik as a contributor ( # 1423 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" vanogrid "" , \n + "" name "" : "" Alexander Ivanov "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 4307918 ? v = 4 "" , \n + "" profile "" : "" https : / / www . vanogrid . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / www . vanogrid . com "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 4307918 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Alexander Ivanov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vanogrid "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add vanogrid as a contributor ( # 1424 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" valdar - hu "" , \n + "" name "" : "" Krisztián Nagy "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 17962817 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / valdar - hu "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / valdar - hu "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 17962817 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Krisztián Nagy < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = valdar - hu "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add valdar - hu as a contributor ( # 1425 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" staillebois "" , \n + "" name "" : "" staillebois "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 23701200 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / staillebois "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / staillebois "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 23701200 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > staillebois < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = staillebois "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add staillebois as a contributor ( # 1426 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" sankypanhale "" , \n + "" name "" : "" Sanket Panhale "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6478783 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / sankypanhale "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / sankypanhale "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6478783 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Sanket Panhale < / b > < / sub > < / a > < br / > < a href = "" # content - sankypanhale "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add sankypanhale as a contributor ( # 1427 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" prafful1 "" , \n + "" name "" : "" Prafful Agarwal "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 14350274 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / prafful1 "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / prafful1 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 14350274 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Prafful Agarwal < / b > < / sub > < / a > < br / > < a href = "" # content - prafful1 "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add prafful1 as a contributor ( # 1428 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" pnowy "" , \n + "" name "" : "" Przemek "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 3254609 ? v = 4 "" , \n + "" profile "" : "" https : / / przemeknowak . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / przemeknowak . com "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 3254609 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Przemek < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = pnowy "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add pnowy as a contributor ( # 1429 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" lbroman "" , \n + "" name "" : "" lbroman "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 86007 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / lbroman "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / lbroman "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 86007 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > lbroman < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = lbroman "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add lbroman as a contributor ( # 1430 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" kaiwinter "" , \n + "" name "" : "" Kai Winter "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 110982 ? v = 4 "" , \n + "" profile "" : "" http : / / about . me / kaiwinter "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / about . me / kaiwinter "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 110982 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Kai Winter < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = kaiwinter "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add kaiwinter as a contributor ( # 1431 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" jjjimenez100 "" , \n + "" name "" : "" Joshua Jimenez "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 22243493 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / jjjimenez100 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / jjjimenez100 "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 22243493 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Joshua Jimenez < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = jjjimenez100 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add jjjimenez100 as a contributor ( # 1432 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" dzmitryh "" , \n + "" name "" : "" Dima Gubin "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 5390492 ? v = 4 "" , \n + "" profile "" : "" https : / / about . me / dzmitryh "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / about . me / dzmitryh "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 5390492 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Dima Gubin < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = dzmitryh "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add dzmitryh as a contributor ( # 1433 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" christophercolumbusdog "" , \n + "" name "" : "" Christian Cygnus "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 9342724 ? v = 4 "" , \n + "" profile "" : "" http : / / ccygnus . com / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / ccygnus . com / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 9342724 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Christian Cygnus < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = christophercolumbusdog "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add christophercolumbusdog as a contributor ( # 1434 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" anthonycampbell "" , \n + "" name "" : "" anthony "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 10249255 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / anthonycampbell "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / anthonycampbell "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 10249255 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > anthony < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = anthonycampbell "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add anthonycampbell as a contributor ( # 1435 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" amogozov "" , \n + "" name "" : "" Artur Mogozov "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 7372215 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / amogozov "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / amogozov "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 7372215 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Artur Mogozov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = amogozov "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add amogozov as a contributor ( # 1436 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" alexsomai "" , \n + "" name "" : "" Alexandru Somai "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 5720977 ? v = 4 "" , \n + "" profile "" : "" https : / / alexsomai . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / alexsomai . com "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 5720977 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Alexandru Somai < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = alexsomai "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add alexsomai as a contributor ( # 1437 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" MaVdbussche "" , \n + "" name "" : "" Martin Vandenbussche "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 26136934 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / MaVdbussche "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / MaVdbussche "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 26136934 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Martin Vandenbussche < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = MaVdbussche "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add MaVdbussche as a contributor ( # 1438 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Harshrajsinh "" , \n + "" name "" : "" Harshraj Thakor "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 22811531 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Harshrajsinh "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / github . com / Harshrajsinh "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 22811531 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Harshraj Thakor < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Harshrajsinh "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Harshrajsinh as a contributor ( # 1439 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Deathnerd "" , \n + "" name "" : "" Wes Gilleland "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1685953 ? v = 4 "" , \n + "" profile "" : "" http : / / theerroris . me "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" http : / / theerroris . me "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1685953 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Wes Gilleland < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Deathnerd "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Deathnerd as a contributor ( # 1440 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Anurag870 "" , \n + "" name "" : "" Anurag870 "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 6295975 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Anurag870 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / Anurag870 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 6295975 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Anurag870 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Anurag870 "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add Anurag870 as a contributor ( # 1441 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" Amarnath510 "" , \n + "" name "" : "" Amarnath Chandana "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 4599623 ? v = 4 "" , \n + "" profile "" : "" https : / / amarnath510 . github . io / portfolio "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / amarnath510 . github . io / portfolio "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 4599623 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Amarnath Chandana < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = Amarnath510 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add Amarnath510 as a contributor ( # 1442 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + { \n + "" login "" : "" IAmPramod "" , \n + "" name "" : "" Pramod Gupta "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 2184241 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / pramodgupta3 / "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n + } , \n README . md \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / pramodgupta3 / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2184241 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Pramod Gupta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AIAmPramod "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : add IAmPramod as a contributor ( # 1443 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" yorlov "" , \n + "" name "" : "" Yuri Orlov "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 1595733 ? v = 4 "" , \n + "" profile "" : "" http : / / vk . com / yuri . orlov "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 100 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 101 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" http : / / vk . com / yuri . orlov "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 1595733 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Yuri Orlov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = yorlov "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add yorlov as a contributor ( # 1446 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" varunu28 "" , \n + "" name "" : "" Varun Upadhyay "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 7676016 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / varunu28 / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 101 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 102 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / varunu28 / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 7676016 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Varun Upadhyay < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = varunu28 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add varunu28 as a contributor ( # 1447 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" PalAditya "" , \n + "" name "" : "" Aditya Pal "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 25523604 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / PalAditya "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 102 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 103 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / PalAditya "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 25523604 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Aditya Pal < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = PalAditya "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add PalAditya as a contributor ( # 1448 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" grzesiekkedzior "" , \n + "" name "" : "" grzesiekkedzior "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / grzesiekkedzior "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 103 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 104 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / grzesiekkedzior "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > grzesiekkedzior < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = grzesiekkedzior "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add grzesiekkedzior as a contributor ( # 1449 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" sivasubramanim "" , \n + "" name "" : "" Sivasubramani M "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 51107434 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / sivasubramanim "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 104 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 105 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / sivasubramanim "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 51107434 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Sivasubramani M < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = sivasubramanim "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add sivasubramanim as a contributor ( # 1450 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" d4gg4d "" , \n + "" name "" : "" Sami Airaksinen "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 99457 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / d4gg4d "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 105 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 106 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / d4gg4d "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 99457 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Sami Airaksinen < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = d4gg4d "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add d4gg4d as a contributor ( # 1451 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" vertti "" , \n + "" name "" : "" Janne Sinivirta "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 557751 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / vertti "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 106 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 107 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / vertti "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 557751 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Janne Sinivirta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vertti "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add vertti as a contributor ( # 1452 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" Bobo1239 "" , \n + "" name "" : "" Boris - Chengbiao Zhou "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 2302947 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / Bobo1239 "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 107 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 108 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / Bobo1239 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2302947 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Boris - Chengbiao Zhou < / b > < / sub > < / a > < br / > < a href = "" # content - Bobo1239 "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add Bobo1239 as a contributor ( # 1453 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" Jahhein "" , \n + "" name "" : "" Jacob Hein "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 10779515 ? v = 4 "" , \n + "" profile "" : "" https : / / jahhein . github . io "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 108 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 109 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / jahhein . github . io "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 10779515 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Jacob Hein < / b > < / sub > < / a > < br / > < a href = "" # content - Jahhein "" title = "" Content "" > 🖋 < / a > < / td > \n + < / tr > \n",docs : add Jahhein as a contributor ( # 1454 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" iamrichardjones "" , \n + "" name "" : "" Richard Jones "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 14842151 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / iamrichardjones "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 109 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 110 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / iamrichardjones "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 14842151 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Richard Jones < / b > < / sub > < / a > < br / > < a href = "" # content - iamrichardjones "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add iamrichardjones as a contributor ( # 1455 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" rachelcarmena "" , \n + "" name "" : "" Rachel M . Carmena "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 22792183 ? v = 4 "" , \n + "" profile "" : "" https : / / rachelcarmena . github . io "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 110 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 111 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / rachelcarmena . github . io "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 22792183 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rachel M . Carmena < / b > < / sub > < / a > < br / > < a href = "" # content - rachelcarmena "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add rachelcarmena as a contributor ( # 1456 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" zd - zero "" , \n + "" name "" : "" Zaerald Denze Lungos "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 21978370 ? v = 4 "" , \n + "" profile "" : "" https : / / zd - zero . github . io "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 111 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 112 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / zd - zero . github . io "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 21978370 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Zaerald Denze Lungos < / b > < / sub > < / a > < br / > < a href = "" # content - zd - zero "" title = "" Content "" > 🖋 < / a > < / td > \n",docs : add zd - zero as a contributor ( # 1457 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" webpro "" , \n + "" name "" : "" Lars Kappert "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 456426 ? v = 4 "" , \n + "" profile "" : "" https : / / webpro . nl "" , \n + "" contributions "" : [ \n + "" content "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 112 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 113 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / webpro . nl "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 456426 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Lars Kappert < / b > < / sub > < / a > < br / > < a href = "" # content - webpro "" title = "" Content "" > 🖋 < / a > < / td > \n + < / tr > \n",docs : add webpro as a contributor ( # 1458 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" design "" \n README . md \n - < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / pramodgupta3 / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2184241 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Pramod Gupta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AIAmPramod "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / hbothra15 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 7418012 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Hemant Bothra < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = hbothra15 "" title = "" Code "" > 💻 < / a > < a href = "" # design - hbothra15 "" title = "" Design "" > 🎨 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / pramodgupta3 / "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 2184241 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Pramod Gupta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3AIAmPramod "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : add hbothra15 as a contributor ( # 1459 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n * fix merge \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Ilkka Seppälä < ilkka . seppala @ gofore . com >,561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 119 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 120 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / vINCENT8888801 "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 8037883 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Wei Seng < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = vINCENT8888801 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" vINCENT8888801 "" , \n + "" name "" : "" Wei Seng "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 8037883 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / vINCENT8888801 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" viveksb007 "" , \n + "" name "" : "" Vivek Singh "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 12713808 ? v = 4 "" , \n + "" profile "" : "" https : / / viveksb007 . github . io "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 144 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 145 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / viveksb007 . github . io "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 12713808 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Vivek Singh < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = viveksb007 "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add viveksb007 as a contributor ( # 1613 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 122 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 123 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / xdvrx1 . github . io / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 47092464 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > xdvrx1 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Axdvrx1 "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" xdvrx1 "" , \n + "" name "" : "" xdvrx1 "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 47092464 ? v = 4 "" , \n + "" profile "" : "" https : / / xdvrx1 . github . io / "" , \n + "" contributions "" : [ \n + "" review "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - < td align = "" center "" > < a href = "" https : / / xdvrx1 . github . io / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 47092464 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > xdvrx1 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Axdvrx1 "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / xdvrx1 . github . io / "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 47092464 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > xdvrx1 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Axdvrx1 "" title = "" Reviewed Pull Requests "" > 👀 < / a > < a href = "" # ideas - xdvrx1 "" title = "" Ideas , Planning , & Feedback "" > 🤔 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n - "" review "" \n + "" review "" , \n + "" ideas "" \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 123 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 124 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / subho . xyz "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 13291222 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Subhrodip Mohanta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ohbus "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ohbus "" , \n + "" name "" : "" Subhrodip Mohanta "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 13291222 ? v = 4 "" , \n + "" profile "" : "" http : / / subho . xyz "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 124 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 125 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / nahteb "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 13121570 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Bethan Palmer < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = nahteb "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" nahteb "" , \n + "" name "" : "" Bethan Palmer "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 13121570 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / nahteb "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - < td align = "" center "" > < a href = "" http : / / subho . xyz "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 13291222 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Subhrodip Mohanta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ohbus "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" http : / / subho . xyz "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 13291222 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Subhrodip Mohanta < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ohbus "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Aohbus "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" review "" \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 125 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 126 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / ToxicDreamz "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 45225562 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Toxic Dreamz < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ToxicDreamz "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ToxicDreamz "" , \n + "" name "" : "" Toxic Dreamz "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 45225562 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ToxicDreamz "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 126 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 127 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / www . edycutjong . com "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 1098102 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Edy Cu Tjong < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = edycutjong "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" edycutjong "" , \n + "" name "" : "" Edy Cu Tjong "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 1098102 ? v = 4 "" , \n + "" profile "" : "" http : / / www . edycutjong . com "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 127 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 128 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / mkrzywanski "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 15279585 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Michał Krzywański < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = mkrzywanski "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" mkrzywanski "" , \n + "" name "" : "" Michał Krzywański "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 15279585 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / mkrzywanski "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 128 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 129 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / www . stefan - birkner . de "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 711349 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Stefan Birkner < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = stefanbirkner "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" stefanbirkner "" , \n + "" name "" : "" Stefan Birkner "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 711349 ? v = 4 "" , \n + "" profile "" : "" https : / / www . stefan - birkner . de "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" siavashsoleymani "" , \n + "" name "" : "" siavash "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 18074419 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / siavashsoleymani "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 145 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 146 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / siavashsoleymani "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 18074419 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > siavash < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = siavashsoleymani "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add siavashsoleymani as a contributor ( # 1616 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Subhrodip Mohanta < subhrodipmohanta @ gmail . com >,561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 132 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 133 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / swarajsaaj "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 6285049 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Swaraj < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = swarajsaaj "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" swarajsaaj "" , \n + "" name "" : "" Swaraj "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 6285049 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / swarajsaaj "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 120 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 121 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / www . linkedin . com / in / ashish - trivedi - 218379135 / "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 23194128 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Ashish Trivedi < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ashishtrivedi16 "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ashishtrivedi16 "" , \n + "" name "" : "" Ashish Trivedi "" , \n + "" avatar _ url "" : "" https : / / avatars3 . githubusercontent . com / u / 23194128 ? v = 4 "" , \n + "" profile "" : "" https : / / www . linkedin . com / in / ashish - trivedi - 218379135 / "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 121 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 122 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / rayyounghong . com "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 41055099 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > 洪月阳 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = RayYH "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" RayYH "" , \n + "" name "" : "" 洪月阳 "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 41055099 ? v = 4 "" , \n + "" profile "" : "" https : / / rayyounghong . com "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 137 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 138 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" http : / / www . linkedin . com / in / manannikov "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 7019769 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Pavlo Manannikov < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = manannikov "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" manannikov "" , \n + "" name "" : "" Pavlo Manannikov "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 7019769 ? v = 4 "" , \n + "" profile "" : "" http : / / www . linkedin . com / in / manannikov "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 138 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 139 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / eimanip "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 20307301 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Eiman < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = eimanip "" title = "" Code "" > 💻 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" eimanip "" , \n + "" name "" : "" Eiman "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 20307301 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / eimanip "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - < td align = "" center "" > < a href = "" https : / / github . com / grzesiekkedzior "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > grzesiekkedzior < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = grzesiekkedzior "" title = "" Code "" > 💻 < / a > < / td > \n + < td align = "" center "" > < a href = "" https : / / github . com / grzesiekkedzior "" > < img src = "" https : / / avatars3 . githubusercontent . com / u / 23739158 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > grzesiekkedzior < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = grzesiekkedzior "" title = "" Code "" > 💻 < / a > < a href = "" https : / / github . com / iluwatar / java - design - patterns / pulls ? q = is % 3Apr + reviewed - by % 3Agrzesiekkedzior "" title = "" Reviewed Pull Requests "" > 👀 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n - "" code "" \n + "" code "" , \n + "" review "" \n",docs : update . all - contributorsrc [ skip ci ],561
"README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 104 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 140 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / OrangePants - R "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 42976136 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rocky < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = OrangePants - R "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : update README . md [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" OrangePants - R "" , \n + "" name "" : "" Rocky "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 42976136 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / OrangePants - R "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" vdlald "" , \n + "" name "" : "" Vladislav Golubinov "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 29997701 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / vdlald "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n",docs : update . all - contributorsrc [ skip ci ],561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ruchpeanuts "" , \n + "" name "" : "" ruchpeanuts "" , \n + "" avatar _ url "" : "" https : / / avatars0 . githubusercontent . com / u / 29301900 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ruchpeanuts "" , \n + "" contributions "" : [ \n + "" doc "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 146 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 147 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / ruchpeanuts "" > < img src = "" https : / / avatars0 . githubusercontent . com / u / 29301900 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > ruchpeanuts < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ruchpeanuts "" title = "" Documentation "" > 📖 < / a > < / td > \n",docs : add ruchpeanuts as a contributor ( # 1618 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" warp125 "" , \n + "" name "" : "" warp125 "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 48073115 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / warp125 "" , \n + "" contributions "" : [ \n + "" translation "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 147 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 148 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / warp125 "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 48073115 ? v = 4 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > warp125 < / b > < / sub > < / a > < br / > < a href = "" # translation - warp125 "" title = "" Translation "" > 🌍 < / a > < / td > \n",docs : add warp125 as a contributor ( # 1619 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" ignite1771 "" , \n + "" name "" : "" ignite1771 "" , \n + "" avatar _ url "" : "" https : / / avatars2 . githubusercontent . com / u / 59446563 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / ignite1771 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 149 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 150 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / ignite1771 "" > < img src = "" https : / / avatars2 . githubusercontent . com / u / 59446563 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > ignite1771 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = ignite1771 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add ignite1771 as a contributor ( # 1626 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com > \n Co - authored - by : Subhrodip Mohanta < subhrodipmohanta @ gmail . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" demirhalil "" , \n + "" name "" : "" Halil Demir "" , \n + "" avatar _ url "" : "" https : / / avatars1 . githubusercontent . com / u / 22895118 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / demirhalil "" , \n + "" contributions "" : [ \n + "" translation "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 150 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 151 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / demirhalil "" > < img src = "" https : / / avatars1 . githubusercontent . com / u / 22895118 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Halil Demir < / b > < / sub > < / a > < br / > < a href = "" # translation - demirhalil "" title = "" Translation "" > 🌍 < / a > < / td > \n",docs : add demirhalil as a contributor ( # 1630 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" rohit10000 "" , \n + "" name "" : "" Rohit Singh "" , \n + "" avatar _ url "" : "" https : / / avatars . githubusercontent . com / u / 20845565 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / rohit10000 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 151 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 152 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / rohit10000 "" > < img src = "" https : / / avatars . githubusercontent . com / u / 20845565 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Rohit Singh < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = rohit10000 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add rohit10000 as a contributor ( # 1637 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" byoungju94 "" , \n + "" name "" : "" byoungju94 "" , \n + "" avatar _ url "" : "" https : / / avatars . githubusercontent . com / u / 42516378 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / byoungju94 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 152 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 153 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < tr > \n + < td align = "" center "" > < a href = "" https : / / github . com / byoungju94 "" > < img src = "" https : / / avatars . githubusercontent . com / u / 42516378 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > byoungju94 < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = byoungju94 "" title = "" Code "" > 💻 < / a > < / td > \n + < / tr > \n",docs : add byoungju94 as a contributor ( # 1642 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" richardmr36 "" , \n + "" name "" : "" Martel Richard "" , \n + "" avatar _ url "" : "" https : / / avatars . githubusercontent . com / u / 19147333 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / richardmr36 "" , \n + "" contributions "" : [ \n + "" code "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 154 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 155 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / richardmr36 "" > < img src = "" https : / / avatars . githubusercontent . com / u / 19147333 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Martel Richard < / b > < / sub > < / a > < br / > < a href = "" https : / / github . com / iluwatar / java - design - patterns / commits ? author = richardmr36 "" title = "" Code "" > 💻 < / a > < / td > \n",docs : add richardmr36 as a contributor ( # 1662 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
". all - contributorsrc \n + } , \n + { \n + "" login "" : "" moustafafarhat "" , \n + "" name "" : "" Moustafa Farhat "" , \n + "" avatar _ url "" : "" https : / / avatars . githubusercontent . com / u / 38836727 ? v = 4 "" , \n + "" profile "" : "" https : / / github . com / moustafafarhat "" , \n + "" contributions "" : [ \n + "" translation "" \n + ] \n README . md \n - [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 153 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + [ ! [ All Contributors ] ( https : / / img . shields . io / badge / all _ contributors - 154 - orange . svg ? style = flat - square ) ] ( # contributors - ) \n + < td align = "" center "" > < a href = "" https : / / github . com / moustafafarhat "" > < img src = "" https : / / avatars . githubusercontent . com / u / 38836727 ? v = 4 ? s = 100 "" width = "" 100px ; "" alt = "" "" / > < br / > < sub > < b > Moustafa Farhat < / b > < / sub > < / a > < br / > < a href = "" # translation - moustafafarhat "" title = "" Translation "" > 🌍 < / a > < / td > \n",docs : add moustafafarhat as a contributor ( # 1649 ) \n * docs : update README . md [ skip ci ] \n * docs : update . all - contributorsrc [ skip ci ] \n Co - authored - by : allcontributors [ bot ] < 46447321 + allcontributors [ bot ] @ users . noreply . github . com >,561
docs \ reference \ snapshot - restore \ apis \ restore - snapshot - api . asciidoc \n - ` POST / _ snapshot / < repository > / < snapshot > ` \n + ` POST / _ snapshot / < repository > / < snapshot > / _ restore ` \n,[ DOCS ] Correct restore snapshot API request example ( # 65525 ),566
"x - pack \ plugin \ core \ src \ main \ resources \ org \ elasticsearch \ xpack \ core \ ml \ notifications _ index _ template . json \n - "" type "" : "" keyword "" \n + "" type "" : "" keyword "" , \n + "" ignore _ above "" : 1024 \n x - pack \ plugin \ transform \ src \ main \ java \ org \ elasticsearch \ xpack \ transform \ persistence \ TransformInternalIndex . java \n + public static final String IGNORE _ ABOVE = "" ignore _ above "" ; \n + . field ( IGNORE _ ABOVE , 1024 ) \n x - pack \ qa \ src \ main \ java \ org \ elasticsearch \ xpack \ test \ rest \ IndexMappingTemplateAsserter . java \n + / / Excluding this from notifications index as ` ignore _ above ` has been added to the ` message . raw ` field . \n + / / The exception is necessary for Full Cluster Restart tests . \n + Set < String > notificationsIndexExceptions = new HashSet < > ( ) ; \n + notificationsIndexExceptions . add ( "" properties . message . fields . raw . ignore _ above "" ) ; \n + \n - "" . ml - notifications - 000001 "" , "" . ml - notifications - 000001 "" , true , Collections . emptySet ( ) , false ) ; \n + "" . ml - notifications - 000001 "" , "" . ml - notifications - 000001 "" , true , notificationsIndexExceptions , false ) ; \n + keysInTemplateMissingFromIndex . removeAll ( exceptions ) ; \n","Add ignore _ above for message . raw field in notifications index mappings ( # 64455 ) \n Setting ignore _ above to 1024 by default for the message . raw field in . ml - notifications - * and \n . transform - notifications * indices ' s mappings , in order to prevent indexing failed when the \n content length of the field exceeds the limit of keyword type . \n Relates to # 63888",566
"server \ src \ main \ java \ org \ elasticsearch \ ingest \ ConfigurationUtils . java \n - processors . add ( readProcessor ( processorFactories , scriptService , entry . getKey ( ) , entry . getValue ( ) ) ) ; \n + if ( entry . getValue ( ) = = null ) { \n + throw newConfigurationException ( entry . getKey ( ) , null , null , "" processor config cannot be [ null ] "" ) ; \n + } else { \n + processors . add ( readProcessor ( processorFactories , scriptService , entry . getKey ( ) , entry . getValue ( ) ) ) ; \n + } \n server \ src \ test \ java \ org \ elasticsearch \ ingest \ ConfigurationUtilsTests . java \n + \n + List < Map < String , Object > > config3 = new ArrayList < > ( ) ; \n + config3 . add ( Collections . singletonMap ( "" test _ processor "" , null ) ) ; \n + ElasticsearchParseException e3 = expectThrows ( ElasticsearchParseException . class , \n + ( ) - > ConfigurationUtils . readProcessorConfigs ( config3 , scriptService , registry ) ) ; \n + assertThat ( e3 . getMetadata ( "" es . processor _ type "" ) , equalTo ( Collections . singletonList ( "" test _ processor "" ) ) ) ; \n + assertThat ( e3 . getMessage ( ) , equalTo ( "" processor config cannot be [ null ] "" ) ) ; \n","Fail with a better error when providing null as processor config . ( # 64565 ) \n When executing PUT pipeline API , if the config of one processor is null , then NPE is throwed . This PR fix the NPE and add a test for the change . \n Relates to # 57793",566
"docs \ reference \ cluster \ tasks . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = wait _ for _ completion ] \n - \n + ` wait _ for _ completion ` : : \n + ( Optional , Boolean ) If ` true ` , the request blocks until the operation is complete . \n + Defaults to ` false ` . \n docs \ reference \ docs \ reindex . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = wait _ for _ completion ] \n + ` wait _ for _ completion ` : : \n + ( Optional , Boolean ) If ` true ` , the request blocks until the operation is complete . \n + Defaults to ` true ` . \n docs \ reference \ rest - api \ common - parms . asciidoc \n - - \n - \n - tag : : wait _ for _ completion [ ] \n - ` wait _ for _ completion ` : : \n - ( Optional , Boolean ) If ` true ` , the request blocks until the operation is complete . \n - Defaults to ` true ` . \n - end : : wait _ for _ completion [ ] \n docs \ reference \ searchable - snapshots \ apis \ mount - snapshot . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = wait _ for _ completion ] \n + ` wait _ for _ completion ` : : \n + ( Optional , Boolean ) If ` true ` , the request blocks until the operation is complete . \n + Defaults to ` false ` . \n",[ DOCS ] Correct the default value of ` wait _ for _ completion ` query param ( # 65800 ) \n Co - authored - by : James Rodewig < 40268737 + jrodewig @ users . noreply . github . com >,566
docs \ reference \ index - modules \ allocation \ data _ tier _ allocation . asciidoc \n - = = = = Data tier allocation settings \n + = = = = Data tier allocation settings \n - \n,[ DOCS ] Format the data tier allocation doc ( # 64722 ),566
"docs \ reference \ docs \ delete - by - query . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = search _ timeout ] \n + ` search _ timeout ` : : \n + ( Optional , < < time - units , time units > > ) \n + Explicit timeout for each search request . \n + Defaults to no timeout . \n docs \ reference \ docs \ update - by - query . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = search _ timeout ] \n + ` search _ timeout ` : : \n + ( Optional , < < time - units , time units > > ) \n + Explicit timeout for each search request . \n + Defaults to no timeout . \n docs \ reference \ rest - api \ common - parms . asciidoc \n - tag : : search _ timeout [ ] \n - ` timeout ` : : \n - ( Optional , < < time - units , time units > > ) \n - Explicit timeout for each search request . \n - Defaults to no timeout . \n - end : : search _ timeout [ ] \n - \n",[ DOCS ] Fix ` search _ timeout ` parameter docs ( # 66075 ) \n Co - authored - by : James Rodewig < 40268737 + jrodewig @ users . noreply . github . com >,566
docs \ reference \ ilm \ actions \ ilm - migrate . asciidoc \n + \n + \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n,[ DOCS ] Format the ilm - migrate doc ( # 65182 ),566
docs \ reference \ search \ explain . asciidoc \n + \n,[ DOCS ] Fix formatting issue in search explain docs ( # 65303 ),566
docs \ reference \ indices \ delete - component - template . asciidoc \n - ` DELETE / _ template / < component - template > ` \n + ` DELETE / _ component _ template / < component - template > ` \n,[ DOCS ] Correct the url in delete - component - template doc ( # 65349 ),566
docs \ reference \ cluster \ nodes - stats . asciidoc \n - ` GET / _ nodes / stats / < metric > ` + \n + ` GET / _ nodes / stats / < metric > ` + \n - ` GET / _ nodes / < node _ id > / stats / < metric > ` + \n + ` GET / _ nodes / < node _ id > / stats / < metric > ` + \n docs \ reference \ docs \ delete - by - query . asciidoc \n - slices ` are distributed proportionally to each sub - request . Combine that with \n + ` slices ` are distributed proportionally to each sub - request . Combine that with \n docs \ reference \ index - modules \ allocation \ filtering . asciidoc \n + \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - ` . / bin / elasticsearch - Enode . attr . size = medium \n + . / bin / elasticsearch - Enode . attr . size = medium \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n,[ DOCS ] Fix some typos in docs ( # 66672 ),566
"libs \ dissect \ src \ main \ java \ org \ elasticsearch \ dissect \ DissectParser . java \n - for ( ; i < input . length ; i + + ) { \n + while ( i < input . length ) { \n + } else { \n + i + + ; \n + } else { \n + i + + ; \n libs \ dissect \ src \ test \ java \ org \ elasticsearch \ dissect \ DissectParserTests . java \n + public void testEmptyValueWithBrackets ( ) { \n + assertMatch ( "" ( % { a } ) [ % { b } ] - [ % { c } ] "" , "" ( foo ) [ ] - [ bar ] "" , Arrays . asList ( "" a "" , "" b "" , "" c "" ) , Arrays . asList ( "" foo "" , "" "" , "" bar "" ) ) ; \n + assertMatch ( "" [ % { a } ] [ % { b } ] "" , "" [ ] [ ] "" , Arrays . asList ( "" a "" , "" b "" ) , Arrays . asList ( "" "" , "" "" ) ) ; \n + } \n + \n",Fix parsing empty value with brackets failed in Dissect ingest processor ( # 65524 ),566
client \ benchmark \ src \ main \ java \ org \ elasticsearch \ client \ benchmark \ ops \ bulk \ BulkBenchmarkTask . java \n - if ( iteration < warmupIterations ) { \n + if ( iteration > = warmupIterations ) { \n,Fix recording sample for formal run iterations in BulkBenchmarkTask ( # 64514 ),566
client \ benchmark \ src \ main \ java \ org \ elasticsearch \ client \ benchmark \ AbstractBenchmark . java \n - int totalDocs = Integer . valueOf ( args [ 5 ] ) ; \n + float totalDocs = Float . valueOf ( args [ 5 ] ) ; \n - int totalIterationCount = ( int ) Math . floor ( totalDocs / bulkSize ) ; \n + int totalIterationCount = ( int ) Math . ceil ( totalDocs / bulkSize ) ; \n,Fix wrong totalIterationCount when running BulkIndexBenchmark ( # 64515 ),566
docs \ reference \ indices \ get - component - template . asciidoc \n - ` < component - template > ` \n + ` < component - template > ` : : \n,[ DOCS ] Format the Get component template API doc ( # 68259 ) \n Co - authored - by : Elastic Machine < elasticmachine @ users . noreply . github . com >,566
"docs \ reference \ search \ multi - search . asciidoc \n - include : : { es - repo - dir } / rest - api / common - parms . asciidoc [ tag = expand - wildcards ] \n + ` expand _ wildcards ` : : : \n + + \n + - - \n + ( Optional , string ) \n + Type of index that wildcard expressions can match . If the request can target \n + data streams , this argument determines whether wildcard expressions match \n + hidden data streams . Supports comma - separated values , such as ` open , hidden ` . \n + Valid values are : \n + \n + ` all ` : : \n + Match any data stream or index , including < < hidden - indices , hidden > > ones . \n + \n + ` open ` : : \n + Match open , non - hidden indices . Also matches any non - hidden data stream . \n + \n + ` closed ` : : \n + Match closed , non - hidden indices . Also matches any non - hidden data stream . Data \n + streams cannot be closed . \n + \n + ` hidden ` : : \n + Match hidden data streams and hidden indices . Must be combined with ` open ` , \n + ` closed ` , or both . \n + \n + ` none ` : : \n + Wildcard expressions are not accepted . \n + - - \n + \n",[ DOCS ] Format the multi search api doc ( # 68621 ),566
TESTING . asciidoc \n - See link : . / buildSrc / src / main / java / org / elasticsearch / gradle / VersionCollection . java [ VersionCollection ] \n + See link : . / buildSrc / src / main / java / org / elasticsearch / gradle / BwcVersions . java [ BwcVersions ] \n,[ DOCS ] Correct the path of BwcVersions in the Testing doc ( # 68798 ),566
"guava - testlib \ src \ com \ google \ common \ testing \ NullPointerTester . java \n - for ( Class < ? > type : TypeToken . of ( cls ) . getTypes ( ) . classes ( ) . rawTypes ( ) ) { \n + for ( Class < ? > type : TypeToken . of ( cls ) . getTypes ( ) . rawTypes ( ) ) { \n guava - testlib \ test \ com \ google \ common \ testing \ NullPointerTesterTest . java \n + private interface InterfaceStaticMethodFailsToCheckNull { \n + static String create ( String s ) { \n + return "" I don ' t check "" ; \n + } \n + } \n + \n + private interface InterfaceStaticMethodChecksNull { \n + static String create ( String s ) { \n + return checkNotNull ( s ) ; \n + } \n + } \n + \n + private interface InterfaceDefaultMethodFailsToCheckNull { \n + static InterfaceDefaultMethodFailsToCheckNull create ( ) { \n + return new InterfaceDefaultMethodFailsToCheckNull ( ) { } ; \n + } \n + \n + default void doNotCheckNull ( String s ) { } \n + } \n + \n + private interface InterfaceDefaultMethodChecksNull { \n + static InterfaceDefaultMethodChecksNull create ( ) { \n + return new InterfaceDefaultMethodChecksNull ( ) { } ; \n + } \n + \n + default void checksNull ( String s ) { \n + checkNotNull ( s ) ; \n + } \n + } \n + \n + public void testInterfaceStaticMethod ( ) { \n + NullPointerTester tester = new NullPointerTester ( ) ; \n + tester . testAllPublicStaticMethods ( InterfaceStaticMethodChecksNull . class ) ; \n + try { \n + tester . testAllPublicStaticMethods ( InterfaceStaticMethodFailsToCheckNull . class ) ; \n + } catch ( AssertionError expected ) { \n + return ; \n + } \n + fail ( ) ; \n + } \n + \n + public void testInterfaceDefaultMethod ( ) { \n + NullPointerTester tester = new NullPointerTester ( ) ; \n + tester . testAllPublicInstanceMethods ( InterfaceDefaultMethodChecksNull . create ( ) ) ; \n + try { \n + tester . testAllPublicInstanceMethods ( InterfaceDefaultMethodFailsToCheckNull . create ( ) ) ; \n + } catch ( AssertionError expected ) { \n + return ; \n + } \n + fail ( ) ; \n + } \n + \n",Support interface static methods and default methods for NullPointerTester . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 145114472,567
"guava - testlib \ src \ com \ google \ common \ testing \ ArbitraryInstances . java \n + import java . util . stream . Stream ; \n + if ( type = = Stream . class ) { \n + return type . cast ( Stream . empty ( ) ) ; \n + } \n guava - testlib \ test \ com \ google \ common \ testing \ ClassSanityTesterTest . java \n + import java . util . stream . Collectors ; \n + import java . util . stream . Stream ; \n + public void testStreamParameterSkippedForNullTesting ( ) throws Exception { \n + tester . testNulls ( WithStreamParameter . class ) ; \n + } \n + \n + static class WithStreamParameter { \n + private final List < ? > list ; \n + \n + / / This should be ignored . \n + public WithStreamParameter ( Stream < ? > s , String str ) { \n + this . list = s . collect ( Collectors . toList ( ) ) ; \n + checkNotNull ( str ) ; \n + } \n + } \n + \n","Change NullPointerTester to work for Stream parameters . \n The default - generated proxy for Stream instance will throw ClassCastException if the method / constructor calls collect ( ) , which is common . \n The reason for the exception is that stream . collect ( ) return R , which the proxy has no idea that is ' a List < T > , or ImmutableList < T > or whatever . That type is unknown because of erasure . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 145114911",567
"android \ guava \ src \ com \ google \ common \ reflect \ TypeToken . java \n + \n + / / This happens to be the hash of the class as of now . So setting it makes a backward compatible \n + / / change . Going forward , if any incompatible change is added , we can change the UID back to 1 . \n + private static final long serialVersionUID = 3637540370352322684L ; \n guava \ src \ com \ google \ common \ reflect \ TypeToken . java \n + \n + / / This happens to be the hash of the class as of now . So setting it makes a backward compatible \n + / / change . Going forward , if any incompatible change is added , we can change the UID back to 1 . \n + private static final long serialVersionUID = 3637540370352322684L ; \n",Set serialVersionUID in TypeToken . java \n RELNOTES = Add a ` serialVersionUID ` to ` TypeToken ` \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 189785498,567
"android \ guava - tests \ test \ com \ google \ common \ reflect \ TypeTokenSubtypeTest . java \n + public void testGetSubtypeOf _ impossibleWildcard ( ) { \n + TypeToken < List < ? extends Number > > numberList = new TypeToken < List < ? extends Number > > ( ) { } ; \n + abstract class StringList implements List < String > { } \n + try { \n + numberList . getSubtype ( StringList . class ) ; \n + fail ( ) ; \n + } catch ( IllegalArgumentException expected ) { } \n + } \n + \n android \ guava \ src \ com \ google \ common \ reflect \ TypeToken . java \n + checkArgument ( \n + subtype . isSubtypeOf ( this ) , "" % s does not appear to be a subtype of % s "" , subtype , this ) ; \n guava - tests \ test \ com \ google \ common \ reflect \ TypeTokenSubtypeTest . java \n + public void testGetSubtypeOf _ impossibleWildcard ( ) { \n + TypeToken < List < ? extends Number > > numberList = new TypeToken < List < ? extends Number > > ( ) { } ; \n + abstract class StringList implements List < String > { } \n + try { \n + numberList . getSubtype ( StringList . class ) ; \n + fail ( ) ; \n + } catch ( IllegalArgumentException expected ) { } \n + } \n + \n guava \ src \ com \ google \ common \ reflect \ TypeToken . java \n + checkArgument ( \n + subtype . isSubtypeOf ( this ) , "" % s does not appear to be a subtype of % s "" , subtype , this ) ; \n","Add isSubtypeOf ( ) "" pre "" - condition check before getSubtype ( ) returns . \n We have to call it before return because before type variable substitution , isSubtypeOf ( ) can ' t apply . \n See https : / / github . com / google / guava / issues / 3048 \n RELNOTES = Validate ` TypeToken . getSubtype ( ) ` . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 187777105",567
"android \ guava - tests \ test \ com \ google \ common \ graph \ TraverserTest . java \n - Traverser . forGraph ( fixedSuccessors ( Iterables . cycle ( 1 , 2 , 3 ) ) ) . breadthFirst ( 0 ) ; \n - assertThat ( Iterables . limit ( result , 2 ) ) . containsExactly ( 0 , 1 ) . inOrder ( ) ; \n + Traverser . forGraph ( fixedSuccessors ( Iterables . cycle ( 1 , 2 , 3 ) ) ) . depthFirstPreOrder ( 0 ) ; \n + assertThat ( Iterables . limit ( result , 3 ) ) . containsExactly ( 0 , 1 , 2 ) . inOrder ( ) ; \n android \ guava \ src \ com \ google \ common \ graph \ Traverser . java \n + import com . google . errorprone . annotations . DoNotMock ; \n + @ DoNotMock ( \n + "" Call forGraph or forTree , passing a lambda or a Graph with the desired edges ( built with "" \n + + "" GraphBuilder ) "" ) \n guava - tests \ test \ com \ google \ common \ graph \ TraverserTest . java \n - Traverser . forGraph ( fixedSuccessors ( Iterables . cycle ( 1 , 2 , 3 ) ) ) . breadthFirst ( 0 ) ; \n - assertThat ( Iterables . limit ( result , 2 ) ) . containsExactly ( 0 , 1 ) . inOrder ( ) ; \n + Traverser . forGraph ( fixedSuccessors ( Iterables . cycle ( 1 , 2 , 3 ) ) ) . depthFirstPreOrder ( 0 ) ; \n + assertThat ( Iterables . limit ( result , 3 ) ) . containsExactly ( 0 , 1 , 2 ) . inOrder ( ) ; \n guava \ src \ com \ google \ common \ graph \ Traverser . java \n + import com . google . errorprone . annotations . DoNotMock ; \n + @ DoNotMock ( \n + "" Call forGraph or forTree , passing a lambda or a Graph with the desired edges ( built with "" \n + + "" GraphBuilder ) "" ) \n",Add @ DoNotMock to Traverser . \n RELNOTES = Add @ DoNotMock to Traverser \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 321469875,567
android \ guava - tests \ test \ com \ google \ common \ reflect \ ClassPathTest . java \n - assertThat ( resources ) . isNotEmpty ( ) ; \n - if ( ! location . file ( ) . isDirectory ( ) ) { \n + if ( ! location . file ( ) . isDirectory ( ) & & location . file ( ) . exists ( ) ) { \n guava - tests \ test \ com \ google \ common \ reflect \ ClassPathTest . java \n - assertThat ( resources ) . isNotEmpty ( ) ; \n - if ( ! location . file ( ) . isDirectory ( ) ) { \n + if ( ! location . file ( ) . isDirectory ( ) & & location . file ( ) . exists ( ) ) { \n,Fix Android test failure in ClassPathTest . \n Reproduced the error and verified that this change fixes it . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 341509765,567
"android \ guava - tests \ test \ com \ google \ common \ reflect \ ClassPathTest . java \n + import java . util . jar . JarFile ; \n - protected void scanFrom ( File file , ClassLoader loader ) throws IOException { \n - if ( file . isDirectory ( ) ) { \n - return ; \n - } \n - this . found = file ; \n + void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n + this . found = new File ( file . getName ( ) ) ; \n - protected void scanResource ( ResourceInfo resource ) throws IOException { \n - throw new IllegalStateException ( ) ; \n - } \n + protected void scanResource ( ResourceInfo resource ) { } \n android \ guava \ src \ com \ google \ common \ reflect \ ClassPath . java \n - private void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n + @ VisibleForTesting \n + void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n guava - tests \ test \ com \ google \ common \ reflect \ ClassPathTest . java \n + import java . util . jar . JarFile ; \n - protected void scanFrom ( File file , ClassLoader loader ) throws IOException { \n - if ( file . isDirectory ( ) ) { \n - return ; \n - } \n - this . found = file ; \n + void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n + this . found = new File ( file . getName ( ) ) ; \n - protected void scanResource ( ResourceInfo resource ) throws IOException { \n - throw new IllegalStateException ( ) ; \n - } \n + protected void scanResource ( ResourceInfo resource ) { } \n guava \ src \ com \ google \ common \ reflect \ ClassPath . java \n - private void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n + @ VisibleForTesting \n + void scanJarFile ( ClassLoader classloader , JarFile file ) throws IOException { \n",Fix ClassPathTest on Android JDK 11 . \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 334217434,567
gradle . properties \n - version = 1 . 0 . 3 - SNAPSHOT \n + version = 1 . 0 . 3 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 0 . 3 ' .,570
gradle . properties \n - version = 1 . 0 . 4 - SNAPSHOT \n + version = 1 . 0 . 4 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 0 . 4 ' .,570
gradle . properties \n - version = 1 . 0 . 4 \n + version = 1 . 0 . 5 - SNAPSHOT \n,Gradle Release Plugin - new version commit : ' hystrix - 1 . 0 . 5 - SNAPSHOT ' .,570
gradle . properties \n - version = 1 . 1 . 0 - SNAPSHOT \n + version = 1 . 1 . 0 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 1 . 0 ' .,570
gradle . properties \n - version = 1 . 0 . 0 - SNAPSHOT \n + version = 1 . 0 . 0 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 0 . 0 ' .,570
gradle . properties \n - version = 1 . 0 . 0 \n + version = 1 . 0 . 1 - SNAPSHOT \n,Gradle Release Plugin - new version commit : ' hystrix - 1 . 0 . 1 - SNAPSHOT ' .,570
gradle . properties \n - version = 1 . 0 . 1 - SNAPSHOT \n + version = 1 . 0 . 1 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 0 . 1 ' .,570
gradle . properties \n - version = 1 . 0 . 1 \n + version = 1 . 0 . 2 - SNAPSHOT \n,Gradle Release Plugin - new version commit : ' hystrix - 1 . 0 . 2 - SNAPSHOT ' .,570
gradle . properties \n - version = 1 . 0 . 2 - SNAPSHOT \n + version = 1 . 0 . 2 \n,Gradle Release Plugin - pre tag commit : ' hystrix - 1 . 0 . 2 ' .,570
gradle . properties \n - version = 1 . 0 . 2 \n + version = 1 . 0 . 3 - SNAPSHOT \n,Gradle Release Plugin - new version commit : ' hystrix - 1 . 0 . 3 - SNAPSHOT ' .,570
"library \ src \ main \ java \ com \ daimajia \ swipe \ SwipeLayout . java \n - if ( event . getX ( ) > v . getLeft ( ) & & event . getX ( ) < v . getRight ( ) \n - & & event . getY ( ) > v . getTop ( ) & & event . getY ( ) < v . getBottom ( ) ) { \n + int [ ] loc = new int [ 2 ] ; \n + v . getLocationOnScreen ( loc ) ; \n + int left = loc [ 0 ] , top = loc [ 1 ] ; \n + \n + if ( event . getRawX ( ) > left & & event . getRawX ( ) < left + v . getWidth ( ) \n + & & event . getRawY ( ) > top & & event . getRawY ( ) < top + v . getHeight ( ) ) { \n + \n - close ( ) ; \n + open ( ) ; \n","fix # 9 , change to screen coordinates",581
library \ src \ main \ java \ com \ daimajia \ swipe \ SwipeAdapter . java \n - \n + \n - private SwipeLayout mPrevious ; \n + private Set < SwipeLayout > mShownLayouts = new HashSet < SwipeLayout > ( ) ; \n + mShownLayouts . add ( swipeLayout ) ; \n + \n + public void closeAllItems ( ) { \n + closeAllExcept ( null ) ; \n + } \n + \n + public void closeAllExcept ( SwipeLayout layout ) { \n + for ( SwipeLayout s : mShownLayouts ) { \n + if ( s ! = layout ) \n + s . close ( ) ; \n + } \n + } \n + \n - if ( mode = = Mode . Multiple ) \n + if ( mode = = Mode . Multiple ) { \n - else { \n - if ( position = = mOpenPosition ) { \n - mOpenPosition = INVALID _ POSITION ; \n - mPrevious = null ; \n - } \n - if ( mOpenPosition ! = position ) { \n - if ( mPrevious ! = null ) \n - mPrevious . close ( ) ; \n - } \n - mOpenPosition = position ; \n - mPrevious = layout ; \n + closeAllExcept ( layout ) ; \n - if ( mode = = Mode . Multiple ) \n + if ( mode = = Mode . Multiple ) \n + else { \n + closeAllExcept ( layout ) ; \n + mOpenPosition = position ; \n + } \n,a simpler and better way to mange open items,581
gradle . properties \n - VERSION _ NAME = 1 . 1 . 6 \n - VERSION _ CODE = 17 \n + VERSION _ NAME = 1 . 1 . 7 \n + VERSION _ CODE = 18 \n library \ src \ main \ java \ com \ daimajia \ swipe \ adapters \ SimpleCursorSwipeAdapter . java \n - import android . annotation . TargetApi ; \n + import android . support . v4 . widget . SimpleCursorAdapter ; \n - import android . widget . SimpleCursorAdapter ; \n - @ TargetApi ( 11 ) \n,"fix # 35 , v1 . 1 . 7",581
"demo \ src \ main \ java \ com \ daimajia \ swipedemo \ MyActivity . java \n - import com . daimajia . swipe . SimpleSwipeListener ; \n - sample1 . addSwipeListener ( new SimpleSwipeListener ( ) { \n - @ Override \n - public void onOpen ( SwipeLayout layout ) { \n - Toast . makeText ( MyActivity . this , "" Opened "" , Toast . LENGTH _ SHORT ) . show ( ) ; \n - } \n - } ) ; \n gradle . properties \n - VERSION _ NAME = 1 . 0 . 8 \n - VERSION _ CODE = 9 \n + VERSION _ NAME = 1 . 1 . 0 \n + VERSION _ CODE = 11 \n library \ src \ main \ java \ com \ daimajia \ swipe \ SwipeLayout . java \n - import android . widget . HeaderViewListAdapter ; \n + private boolean mSwipeEnabled = true ; \n + \n + \n + if ( ! isEnabled ( ) | | ! isEnabledInAdapterView ( ) ) { \n + return true ; \n + } \n + \n + if ( ! isSwipeEnabled ( ) ) { \n + return false ; \n + } \n + \n - \n - if ( ! isEnabledInAdapterView ( ) ) \n + if ( ! isEnabledInAdapterView ( ) | | ! isEnabled ( ) ) \n + if ( ! isSwipeEnabled ( ) ) \n + return super . onTouchEvent ( event ) ; \n + \n + \n - enable & = ( ( BaseAdapter ) adapter ) . isEnabled ( p ) ; \n + enable = ( ( BaseAdapter ) adapter ) . isEnabled ( p ) ; \n - enable & = ( ( ListAdapter ) adapter ) . isEnabled ( p ) ; \n - } else if ( adapter instanceof HeaderViewListAdapter ) { \n - enable & = ( ( HeaderViewListAdapter ) adapter ) . isEnabled ( p ) ; \n + enable = ( ( ListAdapter ) adapter ) . isEnabled ( p ) ; \n + public void setSwipeEnabled ( boolean enabled ) { \n + mSwipeEnabled = enabled ; \n + } \n + \n + public boolean isSwipeEnabled ( ) { \n + return mSwipeEnabled ; \n + } \n + \n","fix # 24 , support disable swipe gesture and fix setEnabled ( boolean ) not works issue",581
"build . gradle \n - classpath ' com . android . tools . build : gradle : 0 . 12 . + ' \n + classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' \n demo \ build . gradle \n - applicationId "" com . daimajia . swipedemo "" \n - runProguard false \n + minifyEnabled false \n gradle . properties \n - VERSION _ NAME = 1 . 1 . 7 \n - VERSION _ CODE = 18 \n + VERSION _ NAME = 1 . 1 . 8 \n + VERSION _ CODE = 19 \n gradle \ wrapper \ gradle - wrapper . properties \n - distributionUrl = http \ : / / services . gradle . org / distributions / gradle - 1 . 12 - all . zip \n + distributionUrl = http \ : / / services . gradle . org / distributions / gradle - 2 . 2 . 1 - all . zip \n library \ build . gradle \n - applicationId "" com . daimajia . swipe "" \n",support compile under build : gradle : 1 . 0 . 0,581
"build . gradle \n - mavenCentral ( ) \n + jcenter ( ) \n - mavenCentral ( ) \n + jcenter ( ) \n new file \n library \ src \ main \ res \ values \ strings . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" utf - 8 "" ? > \n + < resources > \n + \n + < ! - - hack to prevent missing R . txt , it ' s pretty wired . - - > \n + < string name = "" android _ animations _ lib _ name "" > AndroidAnimations < / string > \n + \n + < / resources > \n",fix missing R . txt when building .,581
new file \n . travis . yml \n + language : android \n + android : \n + components : \n + - tools \n + - platform - tools \n + - build - tools - 25 . 2 . 0 \n + - android - 25 \n + - extra - android - support \n + - extra \n + - extra - android - m2repository \n + script : \n + - . / gradlew assembleDebug \n build . gradle \n - classpath ' com . android . tools . build : gradle : 2 . 2 . 3 ' \n + classpath ' com . android . tools . build : gradle : 2 . 3 . 0 ' \n gradle \ wrapper \ gradle - wrapper . properties \n - # Wed Mar 08 17 : 06 : 52 CST 2017 \n + # Thu Mar 09 16 : 07 : 03 CST 2017 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 14 . 1 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 3 . 3 - all . zip \n library \ build . gradle \n - compile ' com . android . support : recyclerview - v7 : 25 . 1 . 1 ' \n - compile ' com . android . support : support - v4 : 25 . 1 . 1 ' \n + compile ' com . android . support : recyclerview - v7 : 25 . 2 . 0 ' \n + compile ' com . android . support : support - v4 : 25 . 2 . 0 ' \n,"update build tools , add travis config .",581
"guava - tests \ test \ com \ google \ common \ base \ ThrowablesTest . java \n + @ GwtIncompatible / / Throwables . getCauseAs ( Throwable , Class ) \n + public void testGetCauseAs ( ) { \n + SomeCheckedException cause = new SomeCheckedException ( ) ; \n + SomeChainingException thrown = new SomeChainingException ( cause ) ; \n + \n + assertThat ( thrown . getCause ( ) ) . isSameAs ( cause ) ; \n + assertThat ( Throwables . getCauseAs ( thrown , SomeCheckedException . class ) ) . isSameAs ( cause ) ; \n + assertThat ( Throwables . getCauseAs ( thrown , Exception . class ) ) . isSameAs ( cause ) ; \n + \n + try { \n + Throwables . getCauseAs ( thrown , IllegalStateException . class ) ; \n + fail ( "" Should have thrown CCE "" ) ; \n + } catch ( ClassCastException expected ) { \n + assertThat ( expected . getCause ( ) ) . isSameAs ( thrown ) ; \n + } \n + } \n + \n guava \ src \ com \ google \ common \ base \ Throwables . java \n + \n + / * * \n + * Returns { @ code throwable } ' s cause , cast to { @ code expectedCauseType } . \n + * \n + * @ throws ClassCastException if the cause cannot be cast to the expected type . The { @ link \n + * ClassCastException } ' s cause is { @ code throwable } . \n + * @ since 22 . 0 \n + * / \n + @ Beta \n + @ GwtIncompatible / / Class . cast ( Object ) \n + public static < X extends Throwable > X getCauseAs ( Throwable throwable , Class < X > expectedCauseType ) \n + throws ClassCastException { \n + try { \n + return expectedCauseType . cast ( throwable . getCause ( ) ) ; \n + } catch ( ClassCastException e ) { \n + e . initCause ( throwable ) ; \n + throw e ; \n + } \n + } \n","Implement Throwables . getCauseAs ( Throwable , Class ) , which safely casts a Throwable ' s cause and ensures that the exception thrown on a bad cast has the original exception as its cause . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 142602139",594
android \ pom . xml \n - < version > 7 < / version > \n + < version > 9 < / version > \n pom . xml \n - < version > 7 < / version > \n + < version > 9 < / version > \n,Update oss - parent to version 9 . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 177595991,594
"README . md \n - * The main flavor requires JDK 1 . 8 or higher . \n + * The JRE flavor requires JDK 1 . 8 or higher . \n - The most recent release is [ Guava 23 . 0 ] [ current release ] , released August 4 , 2017 . \n - \n - - 23 . 0 API Docs : [ guava ] [ guava - release - api - docs ] , [ guava - testlib ] [ testlib - release - api - docs ] \n - - 23 . 0 API Diffs from 22 . 0 : [ guava ] [ guava - release - api - diffs ] \n + The most recent release is [ Guava 23 . 1 ] [ current release ] , released September 27 , \n + 2017 . \n - version ` 23 . 0 ` for the main flavor , or ` 23 . 0 - android ` for the Android flavor . \n + version ` 23 . 1 - jre ` for the JRE flavor , or ` 23 . 1 - android ` for the Android flavor . \n - < version > 23 . 0 < / version > \n + < version > 23 . 1 - jre < / version > \n - < version > 23 . 0 - android < / version > \n + < version > 23 . 1 - android < / version > \n - compile ' com . google . guava : guava : 23 . 0 ' \n + compile ' com . google . guava : guava : 23 . 1 - jre ' \n - compile ' com . google . guava : guava : 23 . 0 - android ' \n + compile ' com . google . guava : guava : 23 . 1 - android ' \n - [ current release ] : https : / / github . com / google / guava / wiki / Release23 \n - [ guava - release - api - docs ] : http : / / google . github . io / guava / releases / 23 . 0 / api / docs / \n - [ testlib - release - api - docs ] : http : / / www . javadoc . io / doc / com . google . guava / guava - testlib / 23 . 0 \n - [ guava - release - api - diffs ] : http : / / google . github . io / guava / releases / 23 . 0 / api / diffs / \n + [ current release ] : https : / / github . com / google / guava / releases / tag / v23 . 1 \n","Update "" current release "" to 23 . 1 . Remove API diffs that are available from the release page . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 170739806",594
"android \ guava - tests \ test \ com \ google \ common \ base \ ThrowablesTest . java \n + import static com . google . common . base . StandardSystemProperty . JAVA _ SPECIFICATION _ VERSION ; \n + / / TODO ( b / 64442212 ) : Remove this guard once lazyStackTrace ( ) works in Java 9 . \n + if ( JAVA _ SPECIFICATION _ VERSION . value ( ) . equals ( "" 9 "" ) ) { \n + return ; \n + } \n guava - tests \ test \ com \ google \ common \ base \ ThrowablesTest . java \n + import static com . google . common . base . StandardSystemProperty . JAVA _ SPECIFICATION _ VERSION ; \n + / / TODO ( b / 64442212 ) : Remove this guard once lazyStackTrace ( ) works in Java 9 . \n + if ( JAVA _ SPECIFICATION _ VERSION . value ( ) . equals ( "" 9 "" ) ) { \n + return ; \n + } \n","Ignore the lazyStackTraceIsLazy test on Java 9 , for now . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 164604079",594
android \ guava \ src \ com \ google \ common \ net \ InternetDomainName . java \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n android \ guava \ src \ com \ google \ common \ util \ concurrent \ MoreExecutors . java \n - * @ since NEXT \n + * @ since 23 . 3 ( since 23 . 1 as { @ link # sequentialExecutor ( Executor ) } ) \n android \ guava \ src \ com \ google \ thirdparty \ publicsuffix \ PublicSuffixType . java \n - * @ since NEXT \n + * @ since 23 . 3 \n guava \ src \ com \ google \ common \ net \ InternetDomainName . java \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n - * @ since NEXT \n + * @ since 23 . 3 \n guava \ src \ com \ google \ common \ util \ concurrent \ MoreExecutors . java \n - * @ since NEXT \n + * @ since 23 . 3 ( since 23 . 1 as { @ link # sequentialExecutor ( Executor ) } ) \n guava \ src \ com \ google \ thirdparty \ publicsuffix \ PublicSuffixType . java \n - * @ since NEXT \n + * @ since 23 . 3 \n,Set all @ since NEXT to @ since 23 . 3 . \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 173458674,594
"README . md \n - The most recent release is [ Guava 23 . 2 ] [ current release ] , released October 11 , \n + The most recent release is [ Guava 23 . 3 ] [ current release ] , released October 26 , \n - version ` 23 . 2 - jre ` for the JRE flavor , or ` 23 . 2 - android ` for the Android flavor . \n + version ` 23 . 3 - jre ` for the JRE flavor , or ` 23 . 3 - android ` for the Android flavor . \n - < version > 23 . 2 - jre < / version > \n + < version > 23 . 3 - jre < / version > \n - < version > 23 . 2 - android < / version > \n + < version > 23 . 3 - android < / version > \n - compile ' com . google . guava : guava : 23 . 2 - jre ' \n + compile ' com . google . guava : guava : 23 . 3 - jre ' \n - compile ' com . google . guava : guava : 23 . 2 - android ' \n + compile ' com . google . guava : guava : 23 . 3 - android ' \n - - Our users ' guide , [ Guava Explained ] [ ] \n + - Our users ' guide , [ Guava Explained ] \n - [ A nice collection ] ( http : / / www . tfnico . com / presentations / google - guava ) of other helpful links \n - [ current release ] : https : / / github . com / google / guava / releases / tag / v23 . 2 \n + [ current release ] : https : / / github . com / google / guava / releases / tag / v23 . 3 \n",Update readme to show new current version 23 . 3 . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 173589977,594
android \ guava - tests \ test \ com \ google \ common \ base \ SuppliersTest . java \n - private void memoizeExceptionThrownTest ( ThrowingSupplier memoizedSupplier ) { \n + private void memoizeExceptionThrownTest ( ThrowingSupplier throwingSupplier ) { \n + Supplier < Integer > memoizedSupplier = Suppliers . memoize ( throwingSupplier ) ; \n guava - tests \ test \ com \ google \ common \ base \ SuppliersTest . java \n - private void memoizeExceptionThrownTest ( ThrowingSupplier memoizedSupplier ) { \n + private void memoizeExceptionThrownTest ( ThrowingSupplier throwingSupplier ) { \n + Supplier < Integer > memoizedSupplier = Suppliers . memoize ( throwingSupplier ) ; \n,Make SuppliersTest . testMemoizeExceptionThrown ( ) actually memoize the suppliers before testing them . \n Fixes https : / / github . com / google / guava / issues / 3122 \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 193705380,594
"android \ guava - tests \ test \ com \ google \ common \ cache \ EmptyCachesTest . java \n - values . toArray ( null ) ; \n + values . toArray ( ( Object [ ] ) null ) ; \n - entries . toArray ( null ) ; \n + entries . toArray ( ( Entry < Object , Object > [ ] ) null ) ; \n guava - tests \ test \ com \ google \ common \ cache \ EmptyCachesTest . java \n - values . toArray ( null ) ; \n + values . toArray ( ( Object [ ] ) null ) ; \n - entries . toArray ( null ) ; \n + entries . toArray ( ( Entry < Object , Object > [ ] ) null ) ; \n",Cast null to make sure to select the right Collection . toArray ( ) . In JDK 11 there ' s a new default method that takes a different parameter . \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 214442788,594
android \ pom . xml \n - < maven - javadoc - plugin . version > 3 . 0 . 0 < / maven - javadoc - plugin . version > \n + < maven - javadoc - plugin . version > 3 . 0 . 1 < / maven - javadoc - plugin . version > \n pom . xml \n - < maven - javadoc - plugin . version > 3 . 0 . 0 < / maven - javadoc - plugin . version > \n + < maven - javadoc - plugin . version > 3 . 0 . 1 < / maven - javadoc - plugin . version > \n,Use maven - javadoc - plugin 3 . 0 . 1 . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 225846924,594
"android \ guava - tests \ test \ com \ google \ common \ hash \ BloomFilterTest . java \n - BloomFilter . create ( Funnels . unencodedCharsFunnel ( ) , Integer . MAX _ VALUE / 2 , 0 . 29 ) ; \n + BloomFilter . create ( Funnels . unencodedCharsFunnel ( ) , Integer . MAX _ VALUE / 2 , 0 . 30 ) ; \n guava - tests \ test \ com \ google \ common \ hash \ BloomFilterTest . java \n - BloomFilter . create ( Funnels . unencodedCharsFunnel ( ) , Integer . MAX _ VALUE / 2 , 0 . 29 ) ; \n + BloomFilter . create ( Funnels . unencodedCharsFunnel ( ) , Integer . MAX _ VALUE / 2 , 0 . 30 ) ; \n",Bumped the FPP to prevent OOMs on JDK 11 . \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 241778584,594
android \ guava - tests \ test \ com \ google \ common \ net \ InetAddressesTest . java \n - InetAddress ipv4Addr = null ; \n - ipv4Addr = InetAddress . getByName ( ipStr ) ; \n + InetAddress ipv4Addr = InetAddress . getByName ( ipStr ) ; \n - InetAddress ipv6Addr = null ; \n - ipv6Addr = InetAddress . getByName ( ipStr ) ; \n + InetAddress ipv6Addr = InetAddress . getByName ( ipStr ) ; \n - InetAddress ipv6Addr = null ; \n - ipv6Addr = InetAddress . getByName ( ipString ) ; \n + InetAddress ipv6Addr = InetAddress . getByName ( ipString ) ; \n guava - tests \ test \ com \ google \ common \ net \ InetAddressesTest . java \n - InetAddress ipv4Addr = null ; \n - ipv4Addr = InetAddress . getByName ( ipStr ) ; \n + InetAddress ipv4Addr = InetAddress . getByName ( ipStr ) ; \n - InetAddress ipv6Addr = null ; \n - ipv6Addr = InetAddress . getByName ( ipStr ) ; \n + InetAddress ipv6Addr = InetAddress . getByName ( ipStr ) ; \n - InetAddress ipv6Addr = null ; \n - ipv6Addr = InetAddress . getByName ( ipString ) ; \n + InetAddress ipv6Addr = InetAddress . getByName ( ipString ) ; \n,Clean up some unnecessary initializations . \n RELNOTES = n / a \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 280196393,594
spring - boot - project \ spring - boot - autoconfigure \ src \ main \ java \ org \ springframework \ boot \ autoconfigure \ web \ servlet \ DispatcherServletAutoConfiguration . java \n + boolean containsDispatcherBean = beanFactory . containsBean ( DEFAULT _ DISPATCHER _ SERVLET _ BEAN _ NAME ) ; \n + if ( ! containsDispatcherBean ) { \n + return ConditionOutcome . match ( ) ; \n + } \n - boolean containsDispatcherBean = beanFactory . containsBean ( DEFAULT _ DISPATCHER _ SERVLET _ BEAN _ NAME ) ; \n - if ( containsDispatcherBean & & ! servlets . contains ( DEFAULT _ DISPATCHER _ SERVLET _ BEAN _ NAME ) ) { \n + if ( ! servlets . contains ( DEFAULT _ DISPATCHER _ SERVLET _ BEAN _ NAME ) ) { \n,Improve performance of DispatcherServletRegistrationCondition \n See gh - 23554,595
spring - boot - project \ spring - boot - actuator \ src \ main \ java \ org \ springframework \ boot \ actuate \ endpoint \ annotation \ EndpointDiscoverer . java \n - / * * \n - * Determine if an extension bean should be exposed . Subclasses can override this \n - * method to provide additional logic . \n - * @ param extensionBean the extension bean \n - * @ return { @ code true } if the extension is exposed \n - * / \n - @ Deprecated \n - protected boolean isExtensionExposed ( Object extensionBean ) { \n - return true ; \n - } \n - \n - & & isEndpointExposed ( endpointBean . getBean ( ) ) ; \n - } \n - \n - / * * \n - * Determine if an endpoint bean should be exposed . Subclasses can override this \n - * method to provide additional logic . \n - * @ param endpointBean the endpoint bean \n - * @ return { @ code true } if the endpoint is exposed \n - * / \n - @ Deprecated \n - protected boolean isEndpointExposed ( Object endpointBean ) { \n - return true ; \n + & & isEndpointTypeExposed ( endpointBean . getBeanType ( ) ) ; \n,Remove deprecated code in EndpointDiscoverer \n See gh - 24317,595
spring - boot - project \ spring - boot - devtools \ src \ main \ java \ org \ springframework \ boot \ devtools \ env \ DevToolsPropertyDefaultsPostProcessor . java \n - System . out . println ( resourceProperties ) ; \n,Remove System . out . println in DevToolsPropertyDefaultsPostProcessor \n See gh - 24325,595
spring - boot - project \ spring - boot - docs \ src \ docs \ asciidoc \ spring - boot - features . adoc \n - - - - \n - spring . config . import = my . properties \n - my . property = value \n + spring : \n + config : \n + import : my . properties \n + my : \n + property : value \n - - - - \n - - - - \n - my . property = value \n - spring . config . import = my . properties \n + my : \n + property : value \n + spring : \n + config : \n + import : my . properties \n - - - - \n,Fix Asciidoc build step \n See gh - 24326,595
"spring - boot - project \ spring - boot \ src \ main \ java \ org \ springframework \ boot \ system \ JavaVersion . java \n + import java . util . stream . Stream ; \n - FIFTEEN ( "" 15 "" , CharSequence . class , "" isEmpty "" ) ; \n + FIFTEEN ( "" 15 "" , CharSequence . class , "" isEmpty "" ) , \n + \n + / * * \n + * Java 16 . \n + * / \n + SIXTEEN ( "" 16 "" , Stream . class , "" toList "" ) ; \n spring - boot - project \ spring - boot \ src \ test \ java \ org \ springframework \ boot \ system \ JavaVersionTests . java \n + @ Test \n + @ EnabledOnJre ( JRE . JAVA _ 16 ) \n + void currentJavaVersionSixteen ( ) { \n + assertThat ( JavaVersion . getJavaVersion ( ) ) . isEqualTo ( JavaVersion . SIXTEEN ) ; \n + } \n + \n",Add JavaVersion entry for JDK 16 \n See gh - 24453,595
spring - boot - project \ spring - boot - docs \ src \ docs \ asciidoc \ attributes . adoc \n - : spring - framework - docs : https : / / docs . spring . io / spring / docs / { spring - framework - version } / spring - framework - reference \n + : spring - framework - docs : https : / / docs . spring . io / spring / docs / { spring - framework - version } / reference / html \n,Fix links to Spring Framework documentation \n See gh - 23737,595
spring - boot - project \ spring - boot - tools \ spring - boot - maven - plugin \ src \ docs \ asciidoc \ packaging - oci - image . adoc \n - < / builderpublish > \n + < / publishRegistry > \n,Fix XML tag in image publishing example \n See gh - 23632,595
spring - boot - project \ spring - boot - docs \ src \ main \ asciidoc \ howto . adoc \n - Flyway supports SQL and Java https : / / flywaydb . org / documentation / callbacks . html [ callbacks ] . \n + Flyway supports SQL and Java https : / / flywaydb . org / documentation / concepts / callbacks [ callbacks ] . \n,Fix link to Flyway callback docs \n See gh - 24119,595
spring - boot - project \ spring - boot - actuator \ src \ main \ java \ org \ springframework \ boot \ actuate \ cassandra \ CassandraDriverReactiveHealthIndicator . java \n - * Create a new { @ link CassandraHealthIndicator } instance . \n + * Create a new { @ link CassandraDriverReactiveHealthIndicator } instance . \n spring - boot - project \ spring - boot - autoconfigure \ src \ main \ java \ org \ springframework \ boot \ autoconfigure \ web \ ConditionalOnEnabledResourceChain . java \n - * handling chain is enabled . Matches if { @ link ResourceProperties . Chain # getEnabled ( ) } is \n - * { @ code true } or if { @ code webjars - locator - core } is on the classpath . \n + * handling chain is enabled . Matches if \n + * { @ link WebProperties . Resources . Chain # getEnabled ( ) } is { @ code true } or if \n + * { @ code webjars - locator - core } is on the classpath . \n,Fix deprecation warnings in javadoc comments \n See gh - 24120,595
"spring - boot - project \ spring - boot - test \ src \ main \ java \ org \ springframework \ boot \ test \ context \ SpringBootTestContextBootstrapper . java \n - List < Class < ? > > combined = new ArrayList < > ( Arrays . asList ( classes ) ) ; \n + Set < Class < ? > > combined = new LinkedHashSet < > ( Arrays . asList ( classes ) ) ; \n spring - boot - project \ spring - boot - test \ src \ test \ java \ org \ springframework \ boot \ test \ context \ bootstrap \ SpringBootTestContextBootstrapperTests . java \n + import org . springframework . test . context . MergedContextConfiguration ; \n - Object contextConfiguration = ReflectionTestUtils . getField ( context , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration contextConfiguration = getMergedContextConfiguration ( context ) ; \n - Object otherContextConfiguration = ReflectionTestUtils . getField ( otherContext2 , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration otherContextConfiguration = getMergedContextConfiguration ( otherContext2 ) ; \n - Object contextConfiguration = ReflectionTestUtils . getField ( context , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration contextConfiguration = getMergedContextConfiguration ( context ) ; \n - Object otherContextConfiguration = ReflectionTestUtils . getField ( otherContext2 , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration otherContextConfiguration = getMergedContextConfiguration ( otherContext2 ) ; \n - Object contextConfiguration = ReflectionTestUtils . getField ( context , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration contextConfiguration = getMergedContextConfiguration ( context ) ; \n - Object otherContextConfiguration = ReflectionTestUtils . getField ( otherContext , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration otherContextConfiguration = getMergedContextConfiguration ( otherContext ) ; \n - void mergedContextConfigurationWhenWebEnvironmentsSameShouldtBeConsideredEqual ( ) { \n + void mergedContextConfigurationWhenWebEnvironmentsSameShouldBeConsideredEqual ( ) { \n - Object contextConfiguration = ReflectionTestUtils . getField ( context , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration contextConfiguration = getMergedContextConfiguration ( context ) ; \n - Object otherContextConfiguration = ReflectionTestUtils . getField ( otherContext , "" mergedContextConfiguration "" ) ; \n + MergedContextConfiguration otherContextConfiguration = getMergedContextConfiguration ( otherContext ) ; \n + @ Test \n + void mergedContextConfigurationClassesShouldNotContainDuplicates ( ) { \n + TestContext context = buildTestContext ( SpringBootTestClassesConfiguration . class ) ; \n + MergedContextConfiguration contextConfiguration = getMergedContextConfiguration ( context ) ; \n + Class < ? > [ ] classes = contextConfiguration . getClasses ( ) ; \n + assertThat ( classes ) . containsExactly ( SpringBootTestContextBootstrapperExampleConfig . class ) ; \n + } \n + \n + private MergedContextConfiguration getMergedContextConfiguration ( TestContext context ) { \n + return ( MergedContextConfiguration ) ReflectionTestUtils . getField ( context , "" mergedContextConfiguration "" ) ; \n + } \n + \n + @ SpringBootTest ( classes = SpringBootTestContextBootstrapperExampleConfig . class ) \n + static class SpringBootTestClassesConfiguration { \n + \n + } \n + \n",Avoid duplicates in MergedContextConfiguration \n Remove duplicate config attribute classes by using a ` Set ` rather \n than a ` List ` in the ` SpringBootTestContextBootstrapper ` . \n See gh - 24532,595
"spring - boot - project \ spring - boot - test \ src \ main \ java \ org \ springframework \ boot \ test \ context \ SpringBootContextLoader . java \n - return application . run ( getArgs ( config ) ) ; \n + String [ ] args = SpringBootTestArgs . get ( config . getContextCustomizers ( ) ) ; \n + return application . run ( args ) ; \n - / * * \n - * Return the application arguments to use . If no arguments are available , return an \n - * empty array . \n - * @ param config the source context configuration \n - * @ return the application arguments to use \n - * @ deprecated since 2 . 2 . 7 \n - * @ see SpringApplication # run ( String . . . ) \n - * / \n - @ Deprecated \n - protected String [ ] getArgs ( MergedContextConfiguration config ) { \n - return SpringBootTestArgs . get ( config . getContextCustomizers ( ) ) ; \n - } \n - \n",Remove deprecated SpringBootContextLoader # getArgs ( ) \n See gh - 24550,595
"buildSrc \ src \ main \ resources \ NOTICE . txt \n - Copyright ( c ) 2012 - 2020 Pivotal , Inc . \n + Copyright ( c ) 2012 - 2021 Pivotal , Inc . \n eclipse \ eclipse . properties \n - copyright - year = 2012 - 2020 \n + copyright - year = 2012 - 2021 \n spring - boot - project \ spring - boot - docs \ src \ docs \ asciidoc \ index - docinfo . xml \n - < year > 2012 - 2020 < / year > \n + < year > 2012 - 2021 < / year > \n spring - boot - project \ spring - boot - docs \ src \ docs \ asciidoc \ legal . adoc \n - Copyright & # 169 ; 2012 - 2020 \n + Copyright & # 169 ; 2012 - 2021 \n",Update copyrights to 2021 \n See gh - 24625,595
"spring - boot - project \ spring - boot \ src \ main \ resources \ META - INF \ additional - spring - configuration - metadata . json \n - "" type "" : "" java . nio . Charset "" , \n + "" type "" : "" java . nio . charset . Charset "" , \n - "" type "" : "" java . nio . Charset "" , \n + "" type "" : "" java . nio . charset . Charset "" , \n",Fix configuration metadata for logging . charset . * properties \n See gh - 24851,595
spring - boot - project \ spring - boot - docs \ src \ docs \ asciidoc \ spring - boot - features . adoc \n - [ [ boot - features - custom - log - configuration ] ] \n + [ [ boot - features - log - shutdown - hook ] ] \n,Fix duplicate anchor id \n See gh - 25048,595
"spring - boot - project \ spring - boot - tools \ spring - boot - test - support \ src \ main \ java \ org \ springframework \ boot \ testsupport \ testcontainers \ DockerImageNames . java \n - * Copyright 2012 - 2020 the original author or authors . \n + * Copyright 2012 - 2021 the original author or authors . \n - private static final String CASSANDRA _ VERSION = "" 3 . 11 . 2 "" ; \n + private static final String CASSANDRA _ VERSION = "" 3 . 11 . 10 "" ; \n - private static final String MONGO _ VERSION = "" 4 . 0 . 10 "" ; \n + private static final String MONGO _ VERSION = "" 4 . 0 . 23 "" ; \n - private static final String POSTGRESQL _ VERSION = "" 9 . 6 . 12 "" ; \n + private static final String POSTGRESQL _ VERSION = "" 9 . 6 . 21 "" ; \n - private static final String REDIS _ VERSION = "" 4 . 0 . 6 "" ; \n + private static final String REDIS _ VERSION = "" 4 . 0 . 14 "" ; \n",Update Testcontainers image versions \n See gh - 25412,595
"spring - boot - project \ spring - boot \ src \ main \ java \ org \ springframework \ boot \ context \ properties \ source \ PrefixedConfigurationPropertySource . java \n - String prefix = ( StringUtils . hasText ( this . prefix ) ) ? this . prefix + "" . "" : "" "" ; \n + if ( ! StringUtils . hasText ( this . prefix ) ) { \n + return name ; \n + } \n + String prefix = this . prefix + "" . "" ; \n spring - boot - project \ spring - boot \ src \ main \ java \ org \ springframework \ boot \ context \ properties \ source \ PrefixedIterableConfigurationPropertySource . java \n + import org . springframework . util . StringUtils ; \n + \n + if ( ! StringUtils . hasText ( getPrefix ( ) ) ) { \n + return getSource ( ) . stream ( ) ; \n + } \n spring - boot - project \ spring - boot \ src \ test \ java \ org \ springframework \ boot \ context \ properties \ source \ PrefixedIterableConfigurationPropertySourceTests . java \n + @ Test \n + void emptyPrefixShouldReturnOriginalStream ( ) { \n + MockConfigurationPropertySource source = new MockConfigurationPropertySource ( ) ; \n + source . put ( "" my . foo . bar "" , "" bing "" ) ; \n + source . put ( "" my . foo . baz "" , "" biff "" ) ; \n + source . put ( "" hello . bing "" , "" blah "" ) ; \n + IterableConfigurationPropertySource prefixed = source . withPrefix ( "" "" ) ; \n + assertThat ( prefixed . stream ( ) ) . containsExactly ( ConfigurationPropertyName . of ( "" my . foo . bar "" ) , \n + ConfigurationPropertyName . of ( "" my . foo . baz "" ) , ConfigurationPropertyName . of ( "" hello . bing "" ) ) ; \n + } \n + \n",Ignore empty prefixes in new PrefixedConfigurationPropertySource \n See gh - 25445,595
spring - boot - project \ spring - boot - docs \ build . gradle \n + . findAll { ! it . name . startsWith ( ' spring - boot - starter ' ) } \n,Exclude starters from Javadoc aggregation \n See gh - 24648,595
"spring - boot - project \ spring - boot - cli \ build . gradle \n - from zipTree ( configurations . loader . singleFile ) \n + from ( zipTree ( configurations . loader . singleFile ) ) { \n + exclude "" META - INF / LICENSE . txt "" \n + exclude "" META - INF / NOTICE . txt "" \n + } \n spring - boot - project \ spring - boot - tools \ spring - boot - loader - tools \ build . gradle \n - from { \n - zipTree ( configurations . loader . incoming . files . filter { it . name . startsWith "" spring - boot - loader "" } . singleFile ) \n + from ( zipTree ( configurations . loader . incoming . files . filter { it . name . startsWith "" spring - boot - loader "" } . singleFile ) ) { \n + exclude "" META - INF / LICENSE . txt "" \n + exclude "" META - INF / NOTICE . txt "" \n - from { \n - zipTree ( configurations . jarmode . incoming . files . filter { it . name . startsWith "" spring - boot - jarmode - layertools "" } . singleFile ) \n + from ( zipTree ( configurations . jarmode . incoming . files . filter { it . name . startsWith "" spring - boot - jarmode - layertools "" } . singleFile ) ) { \n + exclude "" META - INF / LICENSE . txt "" \n + exclude "" META - INF / NOTICE . txt "" \n",Fix build deprecation warnings about duplicate jar entries \n See gh - 25116,595
"settings . gradle \n - id "" com . gradle . enterprise "" version "" 3 . 5 . 1 "" \n + id "" com . gradle . enterprise "" version "" 3 . 5 . 2 "" \n",Upgrade to Gradle Enterprise Gradle Plugin 3 . 5 . 2 \n See gh - 25120,595
"PerformanceTestOrmLite \ build . gradle \n - apply plugin : ' android ' \n + apply plugin : ' com . android . application ' \n + androidTestCompile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) \n rename from PerformanceTestOrmLite \ lib \ ormlite - android - 4 . 34 - SNAPSHOT . jar \n rename to PerformanceTestOrmLite \ libs \ ormlite - android - 4 . 34 - SNAPSHOT . jar \n rename from PerformanceTestOrmLite \ lib \ ormlite - core - 4 . 34 - SNAPSHOT . jar \n rename to PerformanceTestOrmLite \ libs \ ormlite - core - 4 . 34 - SNAPSHOT . jar \n",Actually add dependencies for OrmLite perf test .,608
DaoCore \ build . gradle \n + archivesBaseName = ' greendao ' \n deleted file \n DaoCore \ settings . gradle \n - rootProject . name = ' greendao ' \n DaoExample \ build . gradle \n + archivesBaseName = ' greendao - example ' \n deleted file \n DaoExample \ settings . gradle \n - rootProject . name = ' greendao - example ' \n DaoExampleGenerator \ build . gradle \n + archivesBaseName = ' greendao - example - generator ' \n deleted file \n DaoExampleGenerator \ settings . gradle \n - rootProject . name = ' greendao - example - generator ' \n DaoGenerator \ build . gradle \n + archivesBaseName = ' greendao - generator ' \n deleted file \n DaoGenerator \ settings . gradle \n - rootProject . name = ' greendao - generator ' \n,Specify artifact ids in build . gradle files . \n - Remove settings . gradle files .,608
". travis . yml \n - ANDROID _ SDKS = android - 19 , sysimg - 19 ANDROID _ TARGET = android - 19 ANDROID _ ABI = armeabi - v7a \n - - build - tools - 22 . 0 . 1 \n + - build - tools - 23 . 0 . 0 \n - echo no | android create avd - - force - n test - t $ ANDROID _ TARGET - - abi $ ANDROID _ ABI \n - emulator - avd test - no - skin - no - audio - no - window & \n DaoTest \ build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 2 . 3 ' \n + classpath ' com . android . tools . build : gradle : 1 . 3 . 1 ' \n - apply plugin : ' android ' \n + apply plugin : ' com . android . application ' \n - buildToolsVersion ' 22 . 0 . 1 ' \n + buildToolsVersion ' 23 . 0 . 0 ' \n PerformanceTestOrmLite \ build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 2 . 3 ' \n + classpath ' com . android . tools . build : gradle : 1 . 3 . 1 ' \n - buildToolsVersion ' 22 . 0 . 1 ' \n + buildToolsVersion ' 23 . 0 . 0 ' \n",Update Android SDK build tools to 23 . 0 . 0 . \n - https : / / developer . android . com / tools / revisions / build - tools . html \n - Also update Android Plugin for Gradle to 1 . 3 . 1 . \n - http : / / tools . android . com / tech - docs / new - build - system,608
. travis . yml \n + sudo : false \n - oraclejdk7 \n,"Disable sudo for travis , auto uses new container - based builders .",608
". travis . yml \n - sudo : false \n + # Use the Travis Container - Based Infrastructure \n + sudo : false \n - oraclejdk7 \n + global : \n + # increase adb timeout ( 2 minutes by default ) \n + - ADB _ INSTALL _ TIMEOUT = 8 \n - ANDROID _ SDKS = android - 19 , sysimg - 19 ANDROID _ TARGET = android - 19 ANDROID _ ABI = armeabi - v7a \n",Fix Android tests failing due to timeouts . \n - http : / / stackoverflow . com / questions / 28949722 / android - tests - fail - on - travis - with - shellcommandunresponsiveexception,608
"PerformanceTestOrmLite \ build . gradle \n - androidTestCompile fileTree ( dir : ' libs ' , include : [ ' * . jar ' ] ) \n + androidTestCompile ' com . j256 . ormlite : ormlite - android : 4 . 48 ' \n deleted file \n PerformanceTestOrmLite \ libs \ ormlite - android - 4 . 34 - SNAPSHOT . jar \n Binary files a / PerformanceTestOrmLite / libs / ormlite - android - 4 . 34 - SNAPSHOT . jar and / dev / null differ \n deleted file \n PerformanceTestOrmLite \ libs \ ormlite - core - 4 . 34 - SNAPSHOT . jar \n Binary files a / PerformanceTestOrmLite / libs / ormlite - core - 4 . 34 - SNAPSHOT . jar and / dev / null differ \n","Update ORMlite to 4 . 48 . \n - http : / / ormlite . com / changelog . txt \n - Also add as a gradle dependecy , remove library jars .",608
"DaoTest \ src \ de \ greenrobot \ daotest \ performance \ PerformanceTest . java \n - public abstract class PerformanceTest < D extends AbstractDao < T , K > , T , K > extends AbstractDaoTest < D , T , K > { \n + public abstract class PerformanceTest < D extends AbstractDao < T , K > , T , K > \n + extends AbstractDaoTest < D , T , K > { \n + accessAll ( list , "" access - all - 1 "" ) ; \n + accessAll ( list , "" access - all - 2 "" ) ; \n + \n + / * * \n + * Access every property of the entity under test and record execution time with { @ link \n + * # startClock ( String ) } and { @ link # stopClock ( ) } . \n + * / \n + protected abstract void accessAll ( List < T > list , String traceName ) ; \n DaoTest \ src \ de \ greenrobot \ daotest \ performance \ PerformanceTestNotNull . java \n + import java . util . List ; \n + @ Override \n + protected void accessAll ( List < SimpleEntityNotNull > list , String traceName ) { \n + startClock ( traceName ) ; \n + for ( int i = 0 ; i < list . size ( ) ; i + + ) { \n + SimpleEntityNotNull entity = list . get ( i ) ; \n + entity . getId ( ) ; \n + entity . getSimpleBoolean ( ) ; \n + entity . getSimpleByte ( ) ; \n + entity . getSimpleShort ( ) ; \n + entity . getSimpleInt ( ) ; \n + entity . getSimpleLong ( ) ; \n + entity . getSimpleFloat ( ) ; \n + entity . getSimpleDouble ( ) ; \n + entity . getSimpleString ( ) ; \n + entity . getSimpleByteArray ( ) ; \n + } \n + stopClock ( ) ; \n + } \n + \n","Add property access test to greenDAO perf test . \n - Simply get every property of the entity under test . Logged as "" access - all - 1 "" and "" access - all - 2 "" .",608
"PerformanceTestOrmLite \ src \ de \ greenrobot \ performance \ ormlite \ PerformanceTestOrmLite . java \n + start = System . currentTimeMillis ( ) ; \n + for ( int i = 0 ; i < reloaded . size ( ) ; i + + ) { \n + SimpleEntityNotNull entity = reloaded . get ( i ) ; \n + entity . getId ( ) ; \n + entity . getSimpleBoolean ( ) ; \n + entity . getSimpleByte ( ) ; \n + entity . getSimpleShort ( ) ; \n + entity . getSimpleInt ( ) ; \n + entity . getSimpleLong ( ) ; \n + entity . getSimpleFloat ( ) ; \n + entity . getSimpleDouble ( ) ; \n + entity . getSimpleString ( ) ; \n + entity . getSimpleByteArray ( ) ; \n + } \n + time = System . currentTimeMillis ( ) - start ; \n + Log . d ( "" DAO "" , "" ORMLite : Accessed properties of "" + reloaded . size ( ) + "" entities in "" + time \n + + "" ms "" ) ; \n + \n - Dao < MinimalEntity , Long > minimalDao = DaoManager . createDao ( connectionSource , MinimalEntity . class ) ; \n + Dao < MinimalEntity , Long > minimalDao = DaoManager . createDao ( connectionSource , \n + MinimalEntity . class ) ; \n",For completeness : access properties in ORMLite perf test .,608
DaoTest \ src \ de \ greenrobot \ daotest \ performance \ PerformanceTest . java \n + private static final int BATCH _ SIZE = 10000 ; \n + private static final int RUNS = 8 ; \n + \n - / / runTests ( 1000 ) ; \n - / / runTests ( 1000 ) ; \n - / / runTests ( 1000 ) ; \n - / / runTests ( 1000 ) ; \n - / / runTests ( 1000 ) ; \n - / / runTests ( 1000 ) ; \n + / / disabled for regular builds \n + / / for ( int i = 0 ; i < RUNS ; i + + ) { \n + / / runTests ( BATCH _ SIZE ) ; \n + / / } \n PerformanceTestOrmLite \ src \ de \ greenrobot \ performance \ ormlite \ PerformanceTestOrmLite . java \n + private static final int BATCH _ SIZE = 10000 ; \n + private static final int RUNS = 8 ; \n + \n + \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n + \n + for ( int i = 0 ; i < RUNS ; i + + ) { \n + deleteAll ( ) ; \n + runTests ( BATCH _ SIZE ) ; \n + } \n PerformanceTestRealm \ src \ androidTest \ java \ de \ greenrobot \ performance \ realm \ PerformanceTestRealm . java \n + private static final int BATCH _ SIZE = 10000 ; \n + private static final int RUNS = 8 ; \n + \n + \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n - deleteAll ( ) ; \n - runTests ( 1000 ) ; \n + \n + for ( int i = 0 ; i < RUNS ; i + + ) { \n + deleteAll ( ) ; \n + runTests ( BATCH _ SIZE ) ; \n + } \n,"Set perf test batch size to 10 . 000 , do 8 runs .",608
PerformanceTestOrmLite \ src \ de \ greenrobot \ performance \ ormlite \ PerformanceTestOrmLite . java \n - protected void setUp ( ) { \n + protected void setUp ( ) throws Exception { \n + super . setUp ( ) ; \n + super . tearDown ( ) ; \n PerformanceTestRealm \ src \ androidTest \ java \ de \ greenrobot \ performance \ realm \ PerformanceTestRealm . java \n - protected void setUp ( ) { \n + protected void setUp ( ) throws Exception { \n + super . setUp ( ) ; \n + super . tearDown ( ) ; \n,Properly call super setUp and tearDown test methods .,608
"PerformanceTestActiveAndroid \ src \ androidTest \ java \ de \ greenrobot \ performance \ activeandroid \ PerformanceTestActiveAndroid . java \n + long start = System . currentTimeMillis ( ) ; \n + long time = System . currentTimeMillis ( ) - start ; \n + Log . d ( "" DAO "" , "" ActiveAndroid : Deleted all entities in "" + time + "" ms "" ) ; \n PerformanceTestOrmLite \ src \ de \ greenrobot \ performance \ ormlite \ PerformanceTestOrmLite . java \n + long start = System . currentTimeMillis ( ) ; \n + long time = System . currentTimeMillis ( ) - start ; \n + Log . d ( "" DAO "" , "" ORMLite : Deleted all entities in "" + time + "" ms "" ) ; \n PerformanceTestRealm \ src \ androidTest \ java \ de \ greenrobot \ performance \ realm \ PerformanceTestRealm . java \n + long start = System . currentTimeMillis ( ) ; \n + long time = System . currentTimeMillis ( ) - start ; \n + Log . d ( "" DAO "" , "" ActiveAndroid : Deleted all entities in "" + time + "" ms "" ) ; \n",Measure deletion time in third - party perf tests .,608
"DaoTest \ src \ de \ greenrobot \ daotest \ performance \ PerformanceTestNotNull . java \n - stopClock ( ) ; \n + stopClock ( list . size ( ) + "" entities "" ) ; \n",List count of entities for greendao access test .,608
"PerformanceTests \ Cupboard \ build . gradle \n - buildConfigField "" boolean "" , "" RUN _ PERFORMANCE _ TESTS "" , "" true "" \n + buildConfigField "" boolean "" , "" RUN _ PERFORMANCE _ TESTS "" , "" false "" \n",Don ' t run tests by default .,608
PerformanceTests \ Cupboard \ build . gradle \n - buildToolsVersion ' 23 . 0 . 0 ' \n - compileSdkVersion 19 \n + buildToolsVersion rootProject . ext . buildToolsVersion \n + compileSdkVersion rootProject . ext . compileSdkVersion \n - minSdkVersion 4 \n - targetSdkVersion 19 \n + minSdkVersion rootProject . ext . minSdkVersion \n + targetSdkVersion rootProject . ext . targetSdkVersion \n,Use SDK level settings from root config .,608
"PerformanceTests \ Cupboard \ src \ androidTest \ java \ de \ greenrobot \ performance \ cupboard \ PerformanceTestCupboard . java \n - private static final String TAG = "" PerformanceTestCupboard "" ; \n + private static final String TAG = "" PerfTestCupboard "" ; \n + \n + \n - runTests ( 100 ) ; / / Warmup \n - \n + Log . d ( TAG , "" - - - - - - - - - - - - - - - Start "" ) ; \n - deleteAll ( ) ; \n - deleteAll ( ) ; \n - final List < SimpleEntityNotNull > list = new ArrayList < SimpleEntityNotNull > ( ) ; \n + final List < SimpleEntityNotNull > list = new ArrayList < > ( ) ; \n + \n + deleteAll ( ) ; \n + \n",Improve Cupboard test . \n - Shorten log tag . \n - Add proper start log . \n - Run delete within test . \n - Formatting .,608
"PerformanceTests \ Cupboard \ src \ androidTest \ java \ de \ greenrobot \ performance \ cupboard \ PerformanceTestCupboard . java \n - \n - \n - import java . util . Random ; \n - import static nl . qbusict . cupboard . CupboardFactory . cupboard ; \n - \n - setupCupboard ( ) ; \n + setUpCupboard ( ) ; \n - private void setupCupboard ( ) { \n + private void setUpCupboard ( ) { \n + / / set up database \n + cupboard . register ( IndexedStringEntity . class ) ; \n + DbHelper dbHelper = new DbHelper ( getApplication ( ) , DATABASE _ NAME , DATABASE _ VERSION ) ; \n + DatabaseCompartment database = cupboard . withDatabase ( dbHelper . getWritableDatabase ( ) ) ; \n + Log . d ( TAG , "" Set up database . "" ) ; \n + \n - \n - / / setup database \n - cupboard . register ( IndexedStringEntity . class ) ; \n - DbHelper dbHelper = new DbHelper ( getApplication ( ) , DATABASE _ NAME , DATABASE _ VERSION ) ; \n - DatabaseCompartment database = cupboard . withDatabase ( dbHelper . getWritableDatabase ( ) ) ; \n + Log . d ( TAG , "" Built entities . "" ) ; \n + Log . d ( TAG , "" Inserted entities . "" ) ; \n + Log . d ( TAG , "" - - - - - - - - - - - - - - - Start "" ) ; \n - / / setup database \n + / / set up database \n - Log . d ( TAG , "" - - - - - - - - - - - - - - - Start "" ) ; \n + \n",Add tweaks from Active Android indexed test to cupboard test . \n - Create entities after database setup . \n - Add log output between steps .,608
"PerformanceTests \ ActiveAndroid \ src \ androidTest \ java \ de \ greenrobot \ performance \ activeandroid \ PerformanceTestActiveAndroid . java \n - . where ( "" INDEXED _ STRING = ? "" , nextIndex ) \n + . where ( "" INDEXED _ STRING = ? "" , fixedRandomStrings [ nextIndex ] ) \n",Actually query for strings in Active Android test .,608
"PerformanceTests \ ActiveAndroid \ src \ androidTest \ java \ de \ greenrobot \ performance \ activeandroid \ PerformanceTestActiveAndroid . java \n + private static final int QUERY _ COUNT = 1000 ; \n - private static final int INDEXED _ RUNS = 1000 ; \n + Log . d ( TAG , "" - - - - - - - - Indexed Queries : Start "" ) ; \n - Log . d ( TAG , "" - - - - - - - - - - - - - - - Indexed Queries : Start "" ) ; \n + for ( int i = 0 ; i < RUNS ; i + + ) { \n + Log . d ( TAG , "" - - - - Run "" + ( i + 1 ) + "" of "" + RUNS ) ; \n + doIndexedStringEntityQuery ( ) ; \n + } \n + \n + Log . d ( TAG , "" - - - - - - - - Indexed Queries : End "" ) ; \n + } \n + private void doIndexedStringEntityQuery ( ) { \n - int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( INDEXED _ RUNS , BATCH _ SIZE - 1 ) ; \n + int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( QUERY _ COUNT , BATCH _ SIZE - 1 ) ; \n - for ( int i = 0 ; i < INDEXED _ RUNS ; i + + ) { \n + for ( int i = 0 ; i < QUERY _ COUNT ; i + + ) { \n + / / noinspection unused \n - Log . d ( TAG , "" Queried for "" + INDEXED _ RUNS + "" indexed entities in "" + time + "" ms "" ) ; \n + Log . d ( TAG , \n + "" Queried for "" + QUERY _ COUNT + "" of "" + BATCH _ SIZE + "" indexed entities in "" + time \n + + "" ms . "" ) ; \n - Log . d ( TAG , "" - - - - - - - - - - - - - - - Indexed Queries : End "" ) ; \n + / / delete all entities \n + ActiveAndroid . execSQL ( "" DELETE FROM INDEXED _ STRING _ ENTITY "" ) ; \n + Log . d ( TAG , "" Deleted all entities . "" ) ; \n",Add runs to Active Android indexed test .,608
"PerformanceTests \ Cupboard \ src \ androidTest \ java \ de \ greenrobot \ performance \ cupboard \ PerformanceTestCupboard . java \n + private static final int QUERY _ COUNT = 1000 ; \n - private static final int INDEXED _ RUNS = 1000 ; \n - int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( INDEXED _ RUNS , BATCH _ SIZE - 1 ) ; \n + int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( QUERY _ COUNT , BATCH _ SIZE - 1 ) ; \n - for ( int i = 0 ; i < INDEXED _ RUNS ; i + + ) { \n + for ( int i = 0 ; i < QUERY _ COUNT ; i + + ) { \n - Log . d ( TAG , "" Queried for "" + INDEXED _ RUNS + "" indexed entities in "" + time + "" ms "" ) ; \n + Log . d ( TAG , \n + "" Queried for "" + QUERY _ COUNT + "" of "" + BATCH _ SIZE + "" indexed entities in "" + time \n + + "" ms . "" ) ; \n PerformanceTests \ OrmLite \ src \ androidTest \ java \ de \ greenrobot \ performance \ ormlite \ PerformanceTestOrmLite . java \n + private static final int QUERY _ COUNT = 1000 ; \n - private static final int INDEXED _ RUNS = 1000 ; \n - int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( INDEXED _ RUNS , BATCH _ SIZE - 1 ) ; \n + int [ ] randomIndices = StringGenerator . getFixedRandomIndices ( QUERY _ COUNT , BATCH _ SIZE - 1 ) ; \n - for ( int i = 0 ; i < INDEXED _ RUNS ; i + + ) { \n + for ( int i = 0 ; i < QUERY _ COUNT ; i + + ) { \n - Log . d ( TAG , "" Queried for "" + INDEXED _ RUNS + "" indexed entities in "" + time + "" ms "" ) ; \n + Log . d ( TAG , \n + "" Queried for "" + QUERY _ COUNT + "" of "" + BATCH _ SIZE + "" indexed entities in "" + time \n + + "" ms . "" ) ; \n","Better result output also for cupboard , ORMLite indexed tests .",608
"build . gradle \n - gradleVersion = ' 2 . 12 ' \n + gradleVersion = ' 2 . 14 . 1 ' \n + \n + / / common dependencies for the example projects \n + dep = [ \n + androidPlugin : ' com . android . tools . build : gradle : 2 . 1 . 3 ' , \n + greendaoPlugin : ' org . greenrobot : greendao - gradle - plugin : 3 . 1 . 0 ' , \n + appcompat : ' com . android . support : appcompat - v7 : 23 . 4 . 0 ' , \n + recyclerview : ' com . android . support : recyclerview - v7 : 23 . 4 . 0 ' \n + ] \n examples \ DaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 2 . 1 . 2 ' \n - classpath ' org . greenrobot : greendao - gradle - plugin : 3 . 1 . 0 ' \n + classpath dep . androidPlugin \n + classpath dep . greendaoPlugin \n - compile ' com . android . support : appcompat - v7 : 23 . 4 . 0 ' \n - compile "" com . android . support : recyclerview - v7 : 23 . 4 . 0 "" \n + compile dep . appcompat \n + compile dep . recyclerview \n examples \ RxDaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 2 . 1 . 2 ' \n - classpath ' org . greenrobot : greendao - gradle - plugin : 3 . 1 . 0 ' \n + classpath dep . androidPlugin \n + classpath dep . greendaoPlugin \n - compile ' com . android . support : appcompat - v7 : 23 . 4 . 0 ' \n - compile "" com . android . support : recyclerview - v7 : 23 . 4 . 0 "" \n + compile dep . appcompat \n + compile dep . recyclerview \n gradle \ wrapper \ gradle - wrapper . properties \n - # Thu Mar 31 20 : 39 : 08 CEST 2016 \n + # Tue Aug 16 09 : 33 : 25 CEST 2016 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 12 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 14 . 1 - all . zip \n",Update Gradle to 2 . 14 . 1 . \n - Gradle security update . \n - Move shared example dependencies to root gradle config file .,608
build . gradle \n - / / common dependencies for the example projects \n + / / common dependencies for Android projects \n tests \ DaoTest \ build . gradle \n + jcenter ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 1 . 2 ' \n + classpath dep . androidPlugin \n tests \ DaoTestEntityAnnotation \ build . gradle \n + jcenter ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 1 . 2 ' \n - classpath ' org . greenrobot : greendao - gradle - plugin : 3 . 1 . 0 ' \n + classpath dep . androidPlugin \n + classpath dep . greendaoPlugin \n tests \ DaoTestPerformance \ build . gradle \n + jcenter ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 1 . 2 ' \n + classpath dep . androidPlugin \n,Use android and greendao plugin version defined in root build . gradle .,608
rename from tests \ DaoTestEntityAnnotation \ src \ androidTest \ Java \ org \ greenrobot \ greendao \ test \ entityannotation \ CustomerOrderTest . java \n rename to tests \ DaoTestEntityAnnotation \ src \ androidTest \ java \ org \ greenrobot \ greendao \ test \ entityannotation \ CustomerOrderTest . java \n rename from tests \ DaoTestEntityAnnotation \ src \ androidTest \ Java \ org \ greenrobot \ greendao \ test \ entityannotation \ CustomerTest . java \n rename to tests \ DaoTestEntityAnnotation \ src \ androidTest \ java \ org \ greenrobot \ greendao \ test \ entityannotation \ CustomerTest . java \n rename from tests \ DaoTestEntityAnnotation \ src \ androidTest \ Java \ org \ greenrobot \ greendao \ test \ entityannotation \ OrderTest . java \n rename to tests \ DaoTestEntityAnnotation \ src \ androidTest \ java \ org \ greenrobot \ greendao \ test \ entityannotation \ OrderTest . java \n rename from tests \ DaoTestEntityAnnotation \ src \ androidTest \ Java \ org \ greenrobot \ greendao \ test \ entityannotation \ TypesInInnerClassTest . java \n rename to tests \ DaoTestEntityAnnotation \ src \ androidTest \ java \ org \ greenrobot \ greendao \ test \ entityannotation \ TypesInInnerClassTest . java \n,Make annotation test java directory lower case . \n - Should fix test collision issues with travis ( case - sensitive file system ) .,608
greendao - api \ build . gradle \n - version = ' 3 . 1 . 0 ' \n + version = ' 3 . 1 . 1 - SNAPSHOT ' \n greendao - api \ src \ main \ java \ org \ greenrobot \ greendao \ annotation \ Entity . java \n - * Whether constructors should be generated . \n + * Whether an all properties constructor should be generated . A no - args constructor is always required . \n + / * * \n + * Whether getters and setters for properties should be generated if missing . \n + * / \n + boolean generateGettersSetters ( ) default true ; \n + \n,Add generateGettersSetters flag to Entity annotation . # 358,608
"greendao - api \ build . gradle \n - version = ' 3 . 1 . 1 ' \n + version = ' 3 . 2 . 0 - SNAPSHOT ' \n greendao - api \ src \ main \ java \ org \ greenrobot \ greendao \ annotation \ Entity . java \n + / * * \n + * Define a protobuf class of this entity to create an additional , special DAO for . \n + * / \n + Class protobuf ( ) default void . class ; \n + \n",Add protobuf attribute on @ Entity . \n - Prepare version 3 . 2 . 0 - SNAPSHOT .,608
DaoGenerator \ build . gradle \n - version = ' 3 . 1 . 0 ' \n + version = ' 3 . 2 . 0 - SNAPSHOT ' \n DaoGenerator \ src - template \ dao . ftl \n - < # if entity . active > \n + < # if entity . active & & ! entity . protobuf > \n + < # else > \n + < # if entity . protobuf > \n + return entity . has $ { entity . pkProperty . propertyName ? cap _ first } ( ) ; \n + < / # if > \n,Better protobuf support in DAO generator . \n - Do not create attachEntitiy method . \n - Use hasX instead of getX ! = null in hasKey ( ) . \n - Prepare version 3 . 2 . 0 - SNAPSHOT .,608
DaoCore \ build . gradle \n - version = ' 3 . 1 . 1 ' \n + version = ' 3 . 2 . 0 - SNAPSHOT ' \n,Build greendao 3 . 2 . 0 - SNAPSHOT .,608
"build . gradle \n - / / common dependencies for Android projects \n + / / common dependencies \n + / / do not use in example projects , so easy copy / paste is possible \n - greendaoPlugin : ' org . greenrobot : greendao - gradle - plugin : 3 . 1 . 1 ' , \n - appcompat : ' com . android . support : appcompat - v7 : 25 . 0 . 0 ' , \n - recyclerview : ' com . android . support : recyclerview - v7 : 25 . 0 . 0 ' \n + greendaoPlugin : ' org . greenrobot : greendao - gradle - plugin : 3 . 2 . 0 ' \n examples \ DaoExample \ build . gradle \n - classpath dep . androidPlugin \n - classpath dep . greendaoPlugin \n + classpath ' com . android . tools . build : gradle : 2 . 2 . 2 ' \n + classpath ' org . greenrobot : greendao - gradle - plugin : 3 . 2 . 0 ' \n - buildToolsVersion rootProject . ext . buildToolsVersion \n - compileSdkVersion rootProject . ext . compileSdkVersion \n + buildToolsVersion ' 25 . 0 . 0 ' \n + compileSdkVersion 25 \n - targetSdkVersion rootProject . ext . targetSdkVersion \n + targetSdkVersion 25 \n - compile dep . appcompat \n - compile dep . recyclerview \n + def supportLibVersion = ' 25 . 0 . 0 ' \n + compile "" com . android . support : appcompat - v7 : $ supportLibVersion "" \n + compile "" com . android . support : recyclerview - v7 : $ supportLibVersion "" \n examples \ RxDaoExample \ build . gradle \n - classpath dep . androidPlugin \n - classpath dep . greendaoPlugin \n + classpath ' com . android . tools . build : gradle : 2 . 2 . 2 ' \n + classpath ' org . greenrobot : greendao - gradle - plugin : 3 . 2 . 0 ' \n - buildToolsVersion rootProject . ext . buildToolsVersion \n - compileSdkVersion rootProject . ext . compileSdkVersion \n + buildToolsVersion ' 25 . 0 . 0 ' \n + compileSdkVersion 25 \n - targetSdkVersion rootProject . ext . targetSdkVersion \n + targetSdkVersion 25 \n - compile dep . appcompat \n - compile dep . recyclerview \n + def supportLibVersion = ' 25 . 0 . 0 ' \n + compile "" com . android . support : appcompat - v7 : $ supportLibVersion "" \n + compile "" com . android . support : recyclerview - v7 : $ supportLibVersion "" \n",Update examples to plugin version 3 . 2 . 0 . \n - Do not use root project variables to include dependencies to allow easy copy / paste .,608
DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ database \ DatabaseOpenHelper . java \n - return encryptedHelper . wrap ( encryptedHelper . getReadableDatabase ( password ) ) ; \n + return encryptedHelper . wrap ( encryptedHelper . getWritableDatabase ( password ) ) ; \n,Actually get writable db with getEncryptedWritableDb . \n - Closes https : / / github . com / greenrobot / greenDAO / issues / 572 .,608
build . gradle \n - if ( project . hasProperty ( ' preferedRepo ' ) & & project . hasProperty ( ' preferedUsername ' ) \n + if ( project . hasProperty ( ' preferedRepo ' ) & & preferedRepo = = ' local ' ) { \n + repository url : repositories . mavenLocal ( ) . url \n + } else if ( project . hasProperty ( ' preferedRepo ' ) & & project . hasProperty ( ' preferedUsername ' ) \n,Support deploying to local repository . \n - Set preferedRepo = local in gradle . properties .,608
"DaoGenerator \ src - template \ dao . ftl \n - db . execSQL ( "" CREATE < # if index . unique > UNIQUE < / # if > INDEX "" + constraint + "" $ { index . name } ON $ { entity . dbName } "" + \n + db . execSQL ( "" CREATE < # if index . unique > UNIQUE < / # if > INDEX "" + constraint + "" $ { index . name } ON \ "" $ { entity . dbName } \ "" "" + \n",Also escape table name when creating index . \n - Closes https : / / github . com / greenrobot / greenDAO / issues / 622 \n - Tested with note example ( snapshot generator and plugin ) .,608
"EventBusTest \ AndroidManifest . xml \n - < instrumentation \n - android : name = "" android . test . InstrumentationTestRunner "" \n - android : targetPackage = "" de . greenrobot . event . test "" / > \n - < uses - library android : name = "" android . test . runner "" / > \n","Fix empty test suite error for EventBusTest module . \n - Closes https : / / github . com / greenrobot / EventBus / issues / 439 \n - Remove outdated instrumentation tags from AndroidManifest . xml to stop overriding build . gradle config . Make sure to remove existing run configurations , sync your project , then right click class / method to run test .",608
"DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ query \ QueryBuilder . java \n - / / SQLCipher 3 . 5 . 0 + does not understand "" COLLATE LOCALIZED "" \n - if ( dao . getDatabase ( ) . getRawDatabase ( ) instanceof SQLiteDatabase ) { \n - this . stringOrderCollation = stringOrderCollation = = null | | stringOrderCollation . startsWith ( "" "" ) ? \n - stringOrderCollation : "" "" + stringOrderCollation ; \n - } \n + this . stringOrderCollation = stringOrderCollation = = null | | stringOrderCollation . startsWith ( "" "" ) ? \n + stringOrderCollation : "" "" + stringOrderCollation ; \n","Allow collation for SQLCipher databases . \n - Closes https : / / github . com / greenrobot / greenDAO / issues / 727 . \n - SQLCipher just does not support collation that requires Android libraries \n ( like ' COLLATE LOCALIZED ' ) . Everything else standard SQLite is supported , \n so allow it .",608
"EventBusTestJava \ build . gradle \n + / / we have tests in the main source set so they can be shared with the Android test module \n + / / to make Gradle pick them up , add the dir to the test source set \n + sourceSets { \n + test { \n + java { \n + srcDirs + = [ ' src / main / java ' ] \n + } \n + } \n + } \n + \n deleted file \n EventBusTestJava \ src \ test \ java \ EventBusTestSuite . java \n - import org . greenrobot . eventbus . EventBusBasicTest ; \n - import org . greenrobot . eventbus . EventBusBuilderTest ; \n - import org . junit . runner . RunWith ; \n - import org . junit . runners . Suite ; \n - import org . junit . runners . Suite . SuiteClasses ; \n - \n - / / Gradle does not pick up tests in src dir , so help Gradle with a suite \n - / / ( Tests are in main src so we can use them for Android too ) \n - @ RunWith ( Suite . class ) \n - @ SuiteClasses ( { \n - EventBusBasicTest . class , \n - EventBusBuilderTest . class \n - } ) \n - public class EventBusTestSuite { \n - } \n","Add main src dir to test source set so tests are picked up . \n - By default Gradle ( Java plugin ) only looks in the test source set for \n tests . But we need to share them with the Android test module , so they \n have to be in the main source set .",608
"EventBusTest \ src \ org \ greenrobot \ eventbus \ indexed \ Indexed . java \n + import org . greenrobot . eventbus . EventBusJavaTestsIndex ; \n - return EventBus . builder ( ) . addIndex ( new EventBusTestsIndex ( ) ) . build ( ) ; \n + / / TODO ut : remove index of this module once all tests moved to Java module \n + return EventBus . builder ( ) \n + . addIndex ( new EventBusTestsIndex ( ) ) \n + . addIndex ( new EventBusJavaTestsIndex ( ) ) \n + . build ( ) ; \n EventBusTestJava \ build . gradle \n + buildscript { \n + repositories { \n + maven { url "" https : / / plugins . gradle . org / m2 / "" } \n + } \n + \n + dependencies { \n + classpath "" net . ltgt . gradle : gradle - apt - plugin : 0 . 12 "" \n + } \n + } \n + \n + apply plugin : ' net . ltgt . apt - idea ' \n + apt project ( ' : EventBusAnnotationProcessor ' ) \n + tasks . withType ( JavaCompile ) { \n + options . compilerArgs + = [ "" - AeventBusIndex = org . greenrobot . eventbus . EventBusJavaTestsIndex "" ] \n + } \n",Experimental : generate index for Java tests for use in Android tests .,608
EventBusTestJava \ src \ main \ java \ org \ greenrobot \ eventbus \ EventBusInheritanceDisabledTest . java \n - static class SubscriberExtendedWithoutNewSubscriberMethod extends EventBusInheritanceDisabledTest { \n + public static class SubscriberExtendedWithoutNewSubscriberMethod extends EventBusInheritanceDisabledTest { \n EventBusTestJava \ src \ main \ java \ org \ greenrobot \ eventbus \ EventBusInheritanceTest . java \n - static class SubscriberExtendedWithoutNewSubscriberMethod extends EventBusInheritanceTest { \n + public static class SubscriberExtendedWithoutNewSubscriberMethod extends EventBusInheritanceTest { \n,Fix JUnit error : ( inline ) test classes have to be public .,608
"EventBusTest \ src \ org \ greenrobot \ eventbus \ indexed \ EventBusBackgroundThreadTestWithIndex . java \n - assertTrue ( eventBus . toString ( ) . contains ( "" indexCount = 1 "" ) ) ; \n + assertTrue ( eventBus . toString ( ) . contains ( "" indexCount = 2 "" ) ) ; \n EventBusTest \ src \ org \ greenrobot \ eventbus \ indexed \ EventBusBasicTestWithIndex . java \n - assertTrue ( eventBus . toString ( ) . contains ( "" indexCount = 1 "" ) ) ; \n + assertTrue ( eventBus . toString ( ) . contains ( "" indexCount = 2 "" ) ) ; \n EventBusTest \ src \ org \ greenrobot \ eventbus \ indexed \ Indexed . java \n - / / TODO ut : remove index of this module once all tests moved to Java module \n",For now keep both Java and Android module index .,608
EventBusTest \ src \ org \ greenrobot \ eventbus \ EventBusMainThreadTest . java \n - import org . junit . After ; \n - import org . junit . Before ; \n - private TestBackgroundPoster backgroundPoster ; \n - \n - @ Before \n - public void setUp ( ) throws Exception { \n - backgroundPoster = new TestBackgroundPoster ( eventBus ) ; \n - backgroundPoster . start ( ) ; \n - } \n - \n - @ After \n - public void tearDown ( ) throws Exception { \n - backgroundPoster . shutdown ( ) ; \n - backgroundPoster . join ( ) ; \n - } \n - \n + TestBackgroundPoster backgroundPoster = new TestBackgroundPoster ( eventBus ) ; \n + backgroundPoster . start ( ) ; \n + \n + \n + backgroundPoster . shutdown ( ) ; \n + backgroundPoster . join ( ) ; \n,"Fix regression : test fails if poster set - up out of method . \n Not sure why , but event is not received if background poster is set up \n using field . Setting up inside test method works fine . Also works fine \n in EventBusAndroidOrderTest .",608
"EventBusTest \ AndroidManifest . xml \n - package = "" de . greenrobot . event . testapp "" \n - android : versionCode = "" 1 "" \n - android : versionName = "" 1 . 0 "" > \n - \n - < uses - sdk android : minSdkVersion = "" 8 "" / > \n + xmlns : tools = "" http : / / schemas . android . com / tools "" \n + package = "" org . greenrobot . eventbus "" > \n - android : label = "" EventBus Test "" > \n + android : label = "" EventBus Test "" \n + tools : ignore = "" GoogleAppIndexingWarning , MissingApplicationIcon "" > \n EventBusTest \ build . gradle \n + minSdkVersion 8 \n + targetSdkVersion 25 \n + versionCode 1 \n + versionName "" 1 . 0 "" \n + \n","Use same targetSdkVersion if running Android tests with Gradle . \n - Define min and target SDK , version in Gradle config . \n - Ignore manifest warnings .",608
"EventBus \ src \ org \ greenrobot \ eventbus \ EventBus . java \n - mainThreadPoster . enqueue ( subscription , event ) ; \n + if ( mainThreadPoster ! = null ) { \n + mainThreadPoster . enqueue ( subscription , event ) ; \n + } else { \n + / / temporary : technically not correct as poster not decoupled from subscriber \n + invokeSubscriber ( subscription , event ) ; \n + } \n",Do not crash if using MAIN _ ORDERED on non - Android . \n Temporarily just directly invoke the subscriber if no main thread poster \n is available . Technically this breaks the promised decoupling of poster \n and subscriber .,608
"EventBusPerformance \ build . gradle \n - classpath ' com . neenbedankt . gradle . plugins : android - apt : 1 . 8 ' \n - apply plugin : ' com . neenbedankt . android - apt ' \n - apt project ( ' : EventBusAnnotationProcessor ' ) \n + annotationProcessor project ( ' : EventBusAnnotationProcessor ' ) \n - apt { \n - arguments { \n - eventBusIndex "" org . greenrobot . eventbusperf . MyEventBusIndex "" \n - } \n - } \n - \n + defaultConfig { \n + javaCompileOptions { \n + annotationProcessorOptions { \n + arguments = [ eventBusIndex : ' org . greenrobot . eventbusperf . MyEventBusIndex ' ] \n + } \n + } \n + } \n EventBusTest \ build . gradle \n - classpath ' com . neenbedankt . gradle . plugins : android - apt : 1 . 8 ' \n - apply plugin : ' com . neenbedankt . android - apt ' \n - \n - sourceCompatibility = 1 . 7 \n - androidTestApt project ( ' : EventBusAnnotationProcessor ' ) \n + androidTestAnnotationProcessor project ( ' : EventBusAnnotationProcessor ' ) \n + \n + javaCompileOptions { \n + annotationProcessorOptions { \n + arguments = [ eventBusIndex : ' org . greenrobot . eventbus . EventBusTestsIndex ' ] \n + } \n + } \n - \n - apt { \n - arguments { \n - eventBusIndex "" org . greenrobot . eventbus . EventBusTestsIndex "" \n - } \n - } \n - \n",Use annotationProcessor instead of android - apt .,608
build . gradle \n - gradleVersion = ' 3 . 5 ' \n + gradleVersion = ' 4 . 1 ' \n + distributionType = org . gradle . api . tasks . wrapper . Wrapper . DistributionType . ALL \n gradle \ wrapper \ gradle - wrapper . jar \n Binary files a / gradle / wrapper / gradle - wrapper . jar and b / gradle / wrapper / gradle - wrapper . jar differ \n gradle \ wrapper \ gradle - wrapper . properties \n - # Fri May 26 21 : 49 : 46 CEST 2017 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 3 . 5 - all . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 4 . 1 - all . zip \n gradlew \n - warn ( ) { \n + warn ( ) { \n - die ( ) { \n + die ( ) { \n - save ( ) { \n + save ( ) { \n,Gradle 4 . 1 \n - Fixes issues with dependencies not getting recognized by Android \n Studio .,608
EventBusTest \ build . gradle \n + google ( ) \n - androidTestCompile ' com . android . support . test : runner : 0 . 5 ' \n - androidTestCompile ' com . android . support . test : rules : 0 . 5 ' \n + androidTestCompile ' com . android . support . test : runner : 1 . 0 . 1 ' \n + androidTestCompile ' com . android . support . test : rules : 1 . 0 . 1 ' \n - minSdkVersion 8 \n + minSdkVersion 9 \n,"EventBusTest : Update testing support library to 1 . 0 . 1 . \n - Requires minSdk 9 ( was 8 ) , Google repo .",608
new file \n EventBusTest \ src \ org \ greenrobot \ eventbus \ indexed \ EventBusAndroidOrderTestWithIndex . java \n + package org . greenrobot . eventbus . indexed ; \n + \n + import org . greenrobot . eventbus . EventBusAndroidOrderTest ; \n + \n + public class EventBusAndroidOrderTestWithIndex extends EventBusAndroidOrderTest { \n + \n + @ Override \n + public void setUp ( ) throws Exception { \n + eventBus = Indexed . build ( ) ; \n + super . setUp ( ) ; \n + } \n + \n + } \n,Add index tests for MAIN vs MAIN _ ORDERED behavior .,608
"EventBusPerformance \ build . gradle \n - buildToolsVersion ' 25 . 0 . 3 ' / / When updating , don ' t forget to adjust . travis . yml \n - compileSdkVersion 25 \n + buildToolsVersion _ buildToolsVersion \n + compileSdkVersion _ compileSdkVersion \n EventBusTest \ build . gradle \n - buildToolsVersion ' 26 . 0 . 3 ' / / When updating , don ' t forget to adjust . travis . yml \n - compileSdkVersion 26 \n + buildToolsVersion _ buildToolsVersion \n + compileSdkVersion _ compileSdkVersion \n build . gradle \n + buildscript { \n + ext { \n + _ buildToolsVersion = ' 26 . 0 . 2 ' / / When updating , don ' t forget to adjust . travis . yml \n + _ compileSdkVersion = 26 \n + } \n + } \n + \n",Use common build tools version and compileSdk ( for Travis ) .,608
"build . gradle \n - _ buildToolsVersion = ' 26 . 0 . 2 ' / / When updating , don ' t forget to adjust . travis . yml \n + _ buildToolsVersion = ' 26 . 0 . 3 ' / / When updating , don ' t forget to adjust . travis . yml \n",Actually use same build tools version as Travis ( 26 . 0 . 3 ) .,608
EventBus \ build . gradle \n - repositories { \n - mavenCentral ( ) \n - } \n - \n EventBusAnnotationProcessor \ build . gradle \n - repositories { \n - mavenCentral ( ) \n - } \n - \n EventBusPerformance \ build . gradle \n - repositories { \n - jcenter ( ) \n - } \n - \n EventBusTest \ build . gradle \n - repositories { \n - jcenter ( ) \n - google ( ) \n - } \n - \n EventBusTestJava \ build . gradle \n - repositories { \n - jcenter ( ) \n - } \n - \n EventBusTestSubscriberInJar \ build . gradle \n - repositories { \n - jcenter ( ) \n - } \n - \n build . gradle \n + allprojects { \n + repositories { \n + jcenter ( ) \n + mavenCentral ( ) \n + google ( ) \n + } \n + } \n + \n,Define repositories once in root build file .,608
"EventBusPerformance \ build . gradle \n - jcenter ( ) \n + google ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 ' \n - compile project ( ' : eventbus ' ) \n + implementation project ( ' : eventbus ' ) \n - compile ' com . squareup : otto : 1 . 3 . 8 ' \n + implementation ' com . squareup : otto : 1 . 3 . 8 ' \n EventBusTest \ build . gradle \n - jcenter ( ) \n + google ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n + classpath ' com . android . tools . build : gradle : 3 . 0 . 0 ' \n - androidTestCompile project ( ' : eventbus ' ) \n - androidTestCompile project ( ' : EventBusTestJava ' ) \n + androidTestImplementation project ( ' : eventbus ' ) \n + androidTestImplementation project ( ' : EventBusTestJava ' ) \n - / / Trying to repro bug : \n - / / androidTestAnnotationProcessor ' org . greenrobot : eventbus - annotation - processor : 3 . 1 . 0 ' \n - compile fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n - androidTestCompile ' com . android . support . test : runner : 1 . 0 . 1 ' \n - androidTestCompile ' com . android . support . test : rules : 1 . 0 . 1 ' \n + implementation fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n + androidTestImplementation ' com . android . support . test : runner : 1 . 0 . 1 ' \n + androidTestImplementation ' com . android . support . test : rules : 1 . 0 . 1 ' \n",Update Android Gradle Plugin to 3 . 0 . 0 .,608
"EventBusPerformance \ build . gradle \n - google ( ) \n + jcenter ( ) \n - classpath ' com . android . tools . build : gradle : 3 . 0 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n - implementation project ( ' : eventbus ' ) \n + compile project ( ' : eventbus ' ) \n - implementation ' com . squareup : otto : 1 . 3 . 8 ' \n + compile ' com . squareup : otto : 1 . 3 . 8 ' \n EventBusTest \ build . gradle \n - google ( ) \n + jcenter ( ) \n - classpath ' com . android . tools . build : gradle : 3 . 0 . 0 ' \n + classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n - androidTestImplementation project ( ' : eventbus ' ) \n - androidTestImplementation project ( ' : EventBusTestJava ' ) \n + androidTestCompile project ( ' : eventbus ' ) \n + androidTestCompile project ( ' : EventBusTestJava ' ) \n - implementation fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n - androidTestImplementation ' com . android . support . test : runner : 1 . 0 . 1 ' \n - androidTestImplementation ' com . android . support . test : rules : 1 . 0 . 1 ' \n + / / Trying to repro bug : \n + / / androidTestAnnotationProcessor ' org . greenrobot : eventbus - annotation - processor : 3 . 1 . 0 ' \n + compile fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n + androidTestCompile ' com . android . support . test : runner : 1 . 0 . 1 ' \n + androidTestCompile ' com . android . support . test : rules : 1 . 0 . 1 ' \n","Revert : Update Android Gradle Plugin to 3 . 0 . 0 . \n - IntelliJ 2017 . 2 does not yet support this version , wait for 2017 . 3 . \n - https : / / stackoverflow . com / questions / 44796375 / is - it - possible - to - use - android - gradle - plugin - 3 - 0 - 0 - with - intellij",608
DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ database \ Database . java \n + boolean isOpen ( ) ; \n + \n DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ database \ EncryptedDatabase . java \n + @ Override \n + public boolean isOpen ( ) { \n + return delegate . isOpen ( ) ; \n + } \n + \n DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ database \ StandardDatabase . java \n + @ Override \n + public boolean isOpen ( ) { \n + return delegate . isOpen ( ) ; \n + } \n + \n,Add Database # isOpen ( ) . Closes # 700 .,608
README . md \n - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n + classpath ' com . android . tools . build : gradle : 3 . 1 . 1 ' \n - compile ' org . greenrobot : greendao : 3 . 2 . 2 ' / / add library \n + implementation ' org . greenrobot : greendao : 3 . 2 . 2 ' / / add library \n,README : use implementation instead of compile .,608
". travis . yml \n - tools # to install Android SDK tools 25 . 1 . x , https : / / github . com / travis - ci / travis - ci / issues / 6040 # issuecomment - 219367943 \n - build - tools - $ ANDROID _ BUILD _ TOOLS _ VERSION \n - android - $ ANDROID _ API _ LEVEL \n - - android - 25 \n + - android - 27 \n - extra - android - support \n build . gradle \n - compileSdkVersion = 25 \n + compileSdkVersion = 27 \n examples \ DaoExample \ build . gradle \n - compileSdkVersion 25 \n + compileSdkVersion 27 \n - targetSdkVersion 25 \n + targetSdkVersion 27 \n - implementation ' com . android . support : appcompat - v7 : 25 . 3 . 1 ' \n - implementation ' com . android . support : recyclerview - v7 : 25 . 3 . 1 ' \n + implementation ' com . android . support : appcompat - v7 : 27 . 1 . 1 ' \n + implementation ' com . android . support : recyclerview - v7 : 27 . 1 . 1 ' \n examples \ RxDaoExample \ build . gradle \n - compileSdkVersion 25 \n + compileSdkVersion 27 \n - targetSdkVersion 25 \n + targetSdkVersion 27 \n - implementation ' com . android . support : appcompat - v7 : 25 . 3 . 1 ' \n - implementation ' com . android . support : recyclerview - v7 : 25 . 3 . 1 ' \n + implementation ' com . android . support : appcompat - v7 : 27 . 1 . 1 ' \n + implementation ' com . android . support : recyclerview - v7 : 27 . 1 . 1 ' \n","Compile with Android SDK 27 . \n - Update examples to target 27 , update libraries .",608
"DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ query \ QueryBuilder . java \n - builder . append ( "" JOIN "" ) . append ( join . daoDestination . getTablename ( ) ) . append ( ' ' ) ; \n + builder . append ( "" JOIN "" ) ; \n + builder . append ( ' "" ' ) . append ( join . daoDestination . getTablename ( ) ) . append ( ' "" ' ) . append ( ' ' ) ; \n",QueryBuilder : escape table name for JOIN as well . \n Closes https : / / github . com / greenrobot / greenDAO / issues / 888,608
"build . gradle \n - androidPlugin : ' com . android . tools . build : gradle : 3 . 1 . 1 ' , \n + androidPlugin : ' com . android . tools . build : gradle : 3 . 1 . 4 ' , \n examples \ DaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 1 . 1 ' \n + classpath ' com . android . tools . build : gradle : 3 . 1 . 4 ' \n examples \ RxDaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 1 . 1 ' \n + classpath ' com . android . tools . build : gradle : 3 . 1 . 4 ' \n",Update Android Plugin to 3 . 1 . 4 .,608
"examples \ RxDaoExample \ build . gradle \n - implementation ' io . reactivex : rxjava : 1 . 2 . 9 ' \n + implementation ' io . reactivex : rxjava : 1 . 3 . 0 ' \n tests \ DaoTest \ build . gradle \n - androidTestImplementation ' net . zetetic : android - database - sqlcipher : 3 . 5 . 4 ' \n - androidTestImplementation ' io . reactivex : rxjava : 1 . 1 . 7 ' \n + androidTestImplementation ' net . zetetic : android - database - sqlcipher : 3 . 5 . 6 ' \n + androidTestImplementation ' io . reactivex : rxjava : 1 . 3 . 0 ' \n tests \ DaoTest \ src \ androidTest \ java \ org \ greenrobot \ greendao \ daotest \ encrypted \ EncryptedDbUtils . java \n - import java . io . File ; \n - \n + import java . io . File ; \n - assertEquals ( "" 3 . 11 . 0 "" , queryString ( db , "" select sqlite _ version ( ) "" ) ) ; \n + assertEquals ( "" 3 . 15 . 2 "" , queryString ( db , "" select sqlite _ version ( ) "" ) ) ; \n","Update RxJava , update SQLCipher version used by tests . \n - Update encrypted SQLite version check .",608
"tests \ DaoTest \ build . gradle \n + \n + testOptions { \n + unitTests { \n + includeAndroidResources = true \n + } \n + } \n - testImplementation ' org . robolectric : robolectric : 3 . 1 ' \n + testImplementation "" junit : junit : 4 . 12 "" \n + testImplementation ' org . robolectric : robolectric : 3 . 8 ' \n tests \ DaoTest \ src \ test \ java \ org \ greenrobot \ greendao \ unittest \ MinimalEntityTest . java \n + import org . greenrobot . greendao . daotest . dummyapp . BuildConfig ; \n + import org . greenrobot . greendao . database . Database ; \n + import org . greenrobot . greendao . query . Query ; \n - import org . robolectric . RobolectricGradleTestRunner ; \n + import org . robolectric . RobolectricTestRunner ; \n - import org . greenrobot . greendao . database . Database ; \n - import org . greenrobot . greendao . query . Query ; \n - import org . greenrobot . greendao . daotest . dummyapp . BuildConfig ; \n - \n - \n - @ RunWith ( RobolectricGradleTestRunner . class ) \n + @ RunWith ( RobolectricTestRunner . class ) \n","DaoTest : update Robolectric to 3 . 8 , manually include JUnit .",608
"README . md \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n - < a href = "" https : / / search . maven . org / # search % 7Cga % 7C1 % 7Cg % 3A % 22org . greenrobot % 22 % 20AND % 20a % 3A % 22eventbus % 22 "" > < img src = "" https : / / img . shields . io / maven - central / v / org . greenrobot / eventbus . svg "" > < / a > \n + < a href = "" https : / / search . maven . org / search ? q = g : org . greenrobot % 20AND % 20a : eventbus "" > < img src = "" https : / / img . shields . io / maven - central / v / org . greenrobot / eventbus . svg "" > < / a > \n - compile ' org . greenrobot : eventbus : 3 . 1 . 1 ' \n + implementation ' org . greenrobot : eventbus : 3 . 1 . 1 ' \n","README : use new dependency config , update Central search link .",608
"build . gradle \n - androidPlugin : ' com . android . tools . build : gradle : 3 . 1 . 4 ' , \n + androidPlugin : ' com . android . tools . build : gradle : 3 . 2 . 1 ' , \n examples \ DaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 1 . 4 ' \n + classpath ' com . android . tools . build : gradle : 3 . 2 . 1 ' \n examples \ RxDaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 1 . 4 ' \n + classpath ' com . android . tools . build : gradle : 3 . 2 . 1 ' \n tests \ DaoTest \ build . gradle \n + minSdkVersion 7 \n + \n tests \ DaoTest \ src \ main \ AndroidManifest . xml \n - < uses - sdk android : minSdkVersion = "" 7 "" / > \n - \n tests \ DaoTestPerformance \ src \ main \ AndroidManifest . xml \n - < uses - sdk android : minSdkVersion = "" 4 "" / > \n - \n",Update Android Plugin to 3 . 2 . 1 . \n - Need to move minSdkVersion to build files .,608
build . gradle \n - task wrapper ( type : Wrapper ) { \n - group ' build setup ' \n - gradleVersion = ' 4 . 6 ' \n - distributionType = org . gradle . api . tasks . wrapper . Wrapper . DistributionType . ALL \n + wrapper { \n + distributionType = Wrapper . DistributionType . ALL \n gradle \ wrapper \ gradle - wrapper . jar \n Binary files a / gradle / wrapper / gradle - wrapper . jar and b / gradle / wrapper / gradle - wrapper . jar differ \n gradle \ wrapper \ gradle - wrapper . properties \n - # Tue Apr 17 14 : 24 : 16 CEST 2018 \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 4 . 10 . 3 - all . zip \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 4 . 6 - all . zip \n gradlew \n - warn ( ) { \n + warn ( ) { \n - die ( ) { \n + die ( ) { \n - save ( ) { \n + save ( ) { \n,Update Gradle [ 4 . 6 - > 4 . 10 . 3 ] .,608
"DaoCore \ src \ main \ java \ org \ greenrobot \ greendao \ database \ DatabaseOpenHelper . java \n + import android . annotation . SuppressLint ; \n + import android . database . DatabaseErrorHandler ; \n + @ SuppressLint ( "" NewApi "" ) \n + public DatabaseOpenHelper ( Context context , String name , CursorFactory factory , int version , DatabaseErrorHandler errorHandler ) { \n + super ( context , name , factory , version , errorHandler ) ; \n + this . context = context ; \n + this . name = name ; \n + this . version = version ; \n + } \n + \n",DatabaseOpenHelper : add constructor accepting DatabaseErrorHandler . \n Available since Honeycomb . \n https : / / github . com / greenrobot / greenDAO / issues / 839,608
"EventBus \ build . gradle \n - apply plugin : ' idea ' \n - / / Still unsupported , see http : / / issues . gradle . org / browse / GRADLE - 784 \n - / / Like this , it won ' t appear at all in the POM \n - configurations { \n - provided \n - } \n - \n - provided ' com . google . android : android : 4 . 1 . 1 . 4 ' \n - provided ' com . google . android : android - test : 4 . 1 . 1 . 4 ' \n - provided ' com . google . android : annotations : 4 . 1 . 1 . 4 ' \n - provided ' com . google . android : support - v4 : r7 ' \n + compileOnly ' com . google . android : android : 4 . 1 . 1 . 4 ' \n + compileOnly ' com . google . android : android - test : 4 . 1 . 1 . 4 ' \n + compileOnly ' com . google . android : annotations : 4 . 1 . 1 . 4 ' \n + compileOnly ' com . google . android : support - v4 : r7 ' \n - compileClasspath + = configurations . provided \n - idea { \n - module { \n - scopes . PROVIDED . plus + = [ configurations . provided ] \n - } \n - } \n - \n - classpath + = configurations . provided \n EventBusAnnotationProcessor \ build . gradle \n - / / Still unsupported , see http : / / issues . gradle . org / browse / GRADLE - 784 \n - / / Like this , it won ' t appear at all in the POM \n - configurations { \n - provided \n - } \n - \n - compile project ( ' : eventbus ' ) \n - compile ' de . greenrobot : java - common : 2 . 3 . 1 ' \n + implementation project ( ' : eventbus ' ) \n + implementation ' de . greenrobot : java - common : 2 . 3 . 1 ' \n - compileClasspath + = configurations . provided \n - classpath + = configurations . provided \n",Change provided - > compileOnly and compile - > implementation .,608
"EventBusTestJava \ build . gradle \n - buildscript { \n - repositories { \n - maven { url "" https : / / plugins . gradle . org / m2 / "" } \n - } \n - \n - dependencies { \n - classpath "" net . ltgt . gradle : gradle - apt - plugin : 0 . 12 "" \n - } \n - } \n - \n - / / plugin to make it easier / safer to use EventBus annotation processor \n - apply plugin : ' net . ltgt . apt - idea ' \n - apt project ( ' : eventbus - annotation - processor ' ) \n + annotationProcessor project ( ' : eventbus - annotation - processor ' ) \n","Drop apt plugin , use Gradle annotationProcessor instead .",608
"EventBusPerformance \ AndroidManifest . xml \n - package = "" org . greenrobot . eventbusperf "" \n - android : versionCode = "" 1 "" \n - android : versionName = "" 2 . 0 . 0 "" > \n - \n - < uses - sdk \n - android : minSdkVersion = "" 7 "" \n - android : targetSdkVersion = "" 17 "" / > \n + package = "" org . greenrobot . eventbusperf "" > \n EventBusPerformance \ build . gradle \n + google ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n + classpath ' com . android . tools . build : gradle : 3 . 5 . 2 ' \n - compile project ( ' : eventbus ' ) \n + implementation project ( ' : eventbus ' ) \n - compile ' com . squareup : otto : 1 . 3 . 8 ' \n + implementation ' com . squareup : otto : 1 . 3 . 8 ' \n - buildToolsVersion _ buildToolsVersion \n + minSdkVersion 7 \n + targetSdkVersion 17 \n + versionCode 1 \n + versionName "" 2 . 0 . 0 "" \n EventBusTest \ build . gradle \n + google ( ) \n - classpath ' com . android . tools . build : gradle : 2 . 3 . 3 ' \n + classpath ' com . android . tools . build : gradle : 3 . 5 . 2 ' \n - androidTestCompile project ( ' : eventbus ' ) \n - androidTestCompile project ( ' : EventBusTestJava ' ) \n + androidTestImplementation project ( ' : eventbus ' ) \n + androidTestImplementation project ( ' : EventBusTestJava ' ) \n - compile fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n - androidTestCompile ' com . android . support . test : runner : 1 . 0 . 1 ' \n - androidTestCompile ' com . android . support . test : rules : 1 . 0 . 1 ' \n + implementation fileTree ( dir : ' libs ' , include : ' * . jar ' ) \n + androidTestImplementation ' com . android . support . test : runner : 1 . 0 . 1 ' \n + androidTestImplementation ' com . android . support . test : rules : 1 . 0 . 1 ' \n - buildToolsVersion _ buildToolsVersion \n build . gradle \n - _ buildToolsVersion = ' 26 . 0 . 3 ' / / When updating , don ' t forget to adjust . travis . yml \n - _ compileSdkVersion = 26 \n + _ compileSdkVersion = 26 / / When updating , don ' t forget to adjust . travis . yml . \n",Update Android Gradle Plugin [ 2 . 3 . 3 - > 3 . 5 . 2 ] .,608
"README . md \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n + Available on < a href = "" https : / / search . maven . org / search ? q = g : org . greenrobot % 20AND % 20a : eventbus "" > Maven Central < / a > . \n + \n - Or download [ the latest JAR ] ( https : / / search . maven . org / remote _ content ? g = org . greenrobot & a = eventbus & v = LATEST ) from Maven Central . \n - \n - - - - - - - - - - - - \n",README : drop broken Central JAR link .,608
README . md \n - [ _ _ ObjectBox _ _ ] ( http : / / objectbox . io / ) ( [ GitHub ] ( https : / / github . com / objectbox / objectbox - java ) ) is a new superfast object - oriented database for mobile . \n + [ _ _ ObjectBox _ _ ] ( https : / / objectbox . io / ) ( [ GitHub ] ( https : / / github . com / objectbox / objectbox - java ) ) is a new superfast object - oriented database for mobile . \n - [ _ _ Essentials _ _ ] ( http : / / greenrobot . org / essentials / ) ( [ GitHub ] ( https : / / github . com / greenrobot / essentials ) ) is a set of utility classes and hash functions for Android & Java projects . \n + [ _ _ Essentials _ _ ] ( https : / / github . com / greenrobot / essentials ) is a set of utility classes and hash functions for Android & Java projects . \n - [ _ _ greenDAO _ _ ] ( http : / / greenrobot . org / greendao / ) ( [ GitHub ] ( https : / / github . com / greenrobot / greenDAO ) ) is an ORM optimized for Android : it maps database tables to Java objects and uses code generation for optimal speed . \n - \n - Check our [ homepage ] ( http : / / greenrobot . org / ) to stay up to date . \n + [ _ _ greenDAO _ _ ] ( https : / / github . com / greenrobot / greenDAO ) is an ORM optimized for Android : it maps database tables to Java objects and uses code generation for optimal speed . \n,README : update links ( TLS ) .,608
"README . md \n - classpath ' com . android . tools . build : gradle : 3 . 1 . 1 ' \n + classpath ' com . android . tools . build : gradle : 3 . 5 . 3 ' \n build . gradle \n - androidPlugin : ' com . android . tools . build : gradle : 3 . 2 . 1 ' , \n + androidPlugin : ' com . android . tools . build : gradle : 3 . 5 . 3 ' , \n examples \ DaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 2 . 1 ' \n + classpath ' com . android . tools . build : gradle : 3 . 5 . 3 ' \n examples \ RxDaoExample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 3 . 2 . 1 ' \n + classpath ' com . android . tools . build : gradle : 3 . 5 . 3 ' \n",Update Android Plugin [ 3 . 2 . 1 - > 3 . 5 . 3 ] .,608
build . gradle \n - compileSdkVersion = 27 \n + compileSdkVersion = 29 \n examples \ DaoExample \ build . gradle \n - compileSdkVersion 27 \n + compileSdkVersion 29 \n - targetSdkVersion 27 \n + targetSdkVersion 29 \n examples \ RxDaoExample \ build . gradle \n - compileSdkVersion 27 \n + compileSdkVersion 29 \n - targetSdkVersion 27 \n + targetSdkVersion 29 \n,"Compile with SDK 29 , for examples also target SDK 29 .",608
examples \ DaoExample \ build . gradle \n + / / To use deprecated test classes on SDK 28 + . https : / / developer . android . com / training / testing / set - up - project \n + useLibrary ' android . test . runner ' \n + useLibrary ' android . test . base ' \n + \n tests \ DaoTest \ build . gradle \n + / / To use deprecated test classes on SDK 28 + . https : / / developer . android . com / training / testing / set - up - project \n + useLibrary ' android . test . runner ' \n + useLibrary ' android . test . base ' \n + \n tests \ DaoTestEntityAnnotation \ build . gradle \n + / / To use deprecated test classes on SDK 28 + . https : / / developer . android . com / training / testing / set - up - project \n + useLibrary ' android . test . runner ' \n + useLibrary ' android . test . base ' \n + \n tests \ DaoTestPerformance \ build . gradle \n + / / To use deprecated test classes on SDK 28 + . https : / / developer . android . com / training / testing / set - up - project \n + useLibrary ' android . test . runner ' \n + useLibrary ' android . test . base ' \n + \n,Add required Android JUnit test classes removed in SDK 28 .,608
README . md \n - keepclassmembers class * extends org . greenrobot . greendao . AbstractDao { \n - - keep class * * $ Properties { * ; } \n + - keep class * * $ Properties { * ; } \n - # If you do not use SQLCipher : \n + # If you DO use SQLCipher : \n + - keep class org . greenrobot . greendao . database . SqlCipherEncryptedHelper { * ; } \n + \n + # If you do NOT use SQLCipher : \n - dontwarn net . sqlcipher . database . * * \n - # If you do not use RxJava : \n + # If you do NOT use RxJava : \n - dontwarn rx . * * \n,README : add keep rule for SqlCipherEncryptedHelper .,608
DaoGenerator \ build . gradle \n - compile ' org . freemarker : freemarker : 2 . 3 . 23 ' \n - testCompile ' junit : junit : 4 . 12 ' \n + compile ' org . freemarker : freemarker : 2 . 3 . 29 ' \n + testImplementation ' junit : junit : 4 . 12 ' \n,Update freemarker [ 2 . 3 . 22 - > 2 . 3 . 29 ] .,608
DaoGenerator \ src \ org \ greenrobot \ greendao \ generator \ DaoGenerator . java \n - Configuration config = new Configuration ( Configuration . VERSION _ 2 _ 3 _ 23 ) ; \n + Configuration config = new Configuration ( Configuration . VERSION _ 2 _ 3 _ 29 ) ; \n,DaoGenerator : set freemarker incompatible improvements to 2 . 3 . 29 . \n Configuration does not appear to document breaking changes .,608
"dubbo - filter \ dubbo - filter - validation \ src \ main \ java \ com \ alibaba \ dubbo \ validation \ support \ jvalidation \ JValidator . java \n - parameterClass = ctClass . toClass ( ) ; \n + parameterClass = ctClass . toClass ( clazz . getClassLoader ( ) , null ) ; \n",Fixed # 796 javassist ' frozen class ' error in Jvalidator cause of inconsistent classloader,634
dubbo - config \ dubbo - config - spring \ src \ main \ java \ com \ alibaba \ dubbo \ config \ spring \ AnnotationBean . java \n + @ Deprecated \n,update version to 2 . 5 . 7,634
. travis . yml \n - oraclejdk8 \n - - oraclejdk7 \n - - openjdk6 \n + - openjdk7 \n,"Update . travis . yml : delete openjdk6 , change oraclejdk7 to openjdk7",634
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ directory \ AbstractDirectory . java \n - if ( router . getUrl ( ) = = null | | router . getUrl ( ) . getParameter ( Constants . RUNTIME _ KEY , true ) ) { \n + if ( router . getUrl ( ) ! = null & & router . getUrl ( ) . getParameter ( Constants . RUNTIME _ KEY , false ) ) { \n dubbo - registry \ dubbo - registry - api \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ integration \ RegistryDirectory . java \n - if ( router . getUrl ( ) ! = null & & ! router . getUrl ( ) . getParameter ( Constants . RUNTIME _ KEY , true ) ) { \n + if ( router . getUrl ( ) ! = null ) { \n","Fixed # 946 , route rule should always run when changed , but should only run at every invoke when RUNTIME _ KEY is true .",634
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ router \ file \ FileRouterFactory . java \n - URL script = url . setProtocol ( protocol ) . addParameter ( Constants . TYPE _ KEY , type ) . addParameterAndEncoded ( Constants . RULE _ KEY , rule ) ; \n + \n + boolean runtime = url . getParameter ( Constants . RUNTIME _ KEY , false ) ; \n + URL script = url . setProtocol ( protocol ) . addParameter ( Constants . TYPE _ KEY , type ) . addParameter ( Constants . RUNTIME _ KEY , runtime ) . addParameterAndEncoded ( Constants . RULE _ KEY , rule ) ; \n dubbo - cluster \ src \ test \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ router \ file \ FileRouterEngineTest . java \n + import com . alibaba . dubbo . common . Constants ; \n + url = url . addParameter ( Constants . RUNTIME _ KEY , true ) ; \n",Fix unit test : add runtime = true key to url,634
dubbo - admin \ pom . xml \n + < ! - - Fix webx 3 . x not compatible with spring 4 . x or higher - - > \n + < dependencyManagement > \n + < dependencies > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - framework - bom < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < scope > import < / scope > \n + < type > pom < / type > \n + < / dependency > \n + < / dependencies > \n + < / dependencyManagement > \n - < exclusions > \n - < exclusion > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - context < / artifactId > \n - < / exclusion > \n - < exclusion > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - beans < / artifactId > \n - < / exclusion > \n - < exclusion > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - web < / artifactId > \n - < / exclusion > \n - < / exclusions > \n - < / dependency > \n - < ! - - FIXME 临时解决spring 4和webx3 . x不兼容的问题 - - > \n - < dependency > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - context < / artifactId > \n - < version > 3 . 2 . 16 . RELEASE < / version > \n - < / dependency > \n - < dependency > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - beans < / artifactId > \n - < version > 3 . 2 . 16 . RELEASE < / version > \n - < / dependency > \n - < dependency > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - web < / artifactId > \n - < version > 3 . 2 . 16 . RELEASE < / version > \n - < / dependency > \n - < dependency > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - core < / artifactId > \n - < version > 3 . 2 . 16 . RELEASE < / version > \n - < / dependency > \n - < dependency > \n - < groupId > org . springframework < / groupId > \n - < artifactId > spring - aop < / artifactId > \n - < version > 3 . 2 . 16 . RELEASE < / version > \n,Fixed # 909 use spring bom dependency to unify version .,634
README . md \n - $ tar zxvf dubbo - demo - provider - xxx - assembly . tar . gz \n - $ cd dubbo - demo - provider - xxx / bin \n + $ tar zxvf dubbo - demo - provider - 2 . 5 . 4 - SNAPSHOT - assembly . tar . gz \n + $ cd dubbo - demo - provider - 2 . 5 . 4 - SNAPSHOT / bin \n - $ tar zxvf dubbo - demo - consumer - xxx - assembly . tar . gz \n - $ cd dubbo - demo - consumer - xxx / bin \n + $ tar zxvf dubbo - demo - consumer - 2 . 5 . 4 - SNAPSHOT - assembly . tar . gz \n + $ cd dubbo - demo - consumer - 2 . 5 . 4 - SNAPSHOT / bin \n,MISC : edit quick start in README . md,634
"dubbo - registry \ dubbo - registry - redis \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ redis \ RedisRegistry . java \n + import com . alibaba . dubbo . common . utils . StringUtils ; \n + \n + String password = url . getPassword ( ) ; \n - this . jedisPools . put ( address , new JedisPool ( config , host , port , \n - url . getParameter ( Constants . TIMEOUT _ KEY , Constants . DEFAULT _ TIMEOUT ) ) ) ; \n + if ( StringUtils . isEmpty ( password ) ) { \n + this . jedisPools . put ( address , new JedisPool ( config , host , port , \n + url . getParameter ( Constants . TIMEOUT _ KEY , Constants . DEFAULT _ TIMEOUT ) ) ) ; \n + } else { \n + this . jedisPools . put ( address , new JedisPool ( config , host , port , \n + url . getParameter ( Constants . TIMEOUT _ KEY , Constants . DEFAULT _ TIMEOUT ) , password ) ) ; \n + } \n dubbo - registry \ dubbo - registry - redis \ src \ test \ java \ com \ alibaba \ dubbo \ registry \ redis \ RedisRegistryTest . java \n + URL registryUrlWithPasswd = URL . valueOf ( "" zookeeper : / / 239 . 255 . 255 . 255 ? password = 123456 "" ) ; \n + "" ? notify = false & methods = test1 , test2 "" ) ; \n + / / RedisRegistry registryWithPasswd = new RedisRegistry ( registryUrlWithPasswd ) ; \n - / / registry . register ( service , serviceUrl ) ; \n + / / registry . register ( serviceUrl ) ; \n + @ Test \n + public void testRedisPasswd ( ) { \n + / / Assert . assertNotNull ( registryWithPasswd ) ; \n + } \n + \n","Fixed # 665 , redis registry support password auth",634
pom . xml \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - compiler - plugin < / artifactId > \n + < version > $ { maven _ compiler _ plugin _ version } < / version > \n + < configuration > \n + < fork > true < / fork > \n + < source > $ { java _ source _ version } < / source > \n + < target > $ { java _ target _ version } < / target > \n + < encoding > $ { file _ encoding } < / encoding > \n + < compilerArgs > \n + < arg > - XX : MaxPermSize = 512M < / arg > \n + < / compilerArgs > \n + < / configuration > \n + < / plugin > \n,add maven - compiler - plugin to pom . xml,634
"new file \n dubbo - demo \ dubbo - demo - consumer \ src \ main \ resources \ log4j . properties \n + # # # set log levels # # # \n + log4j . rootLogger = info , stdout \n + # # # 输出到控制台 # # # \n + log4j . appender . stdout = org . apache . log4j . ConsoleAppender \n + log4j . appender . stdout . Target = System . out \n + log4j . appender . stdout . layout = org . apache . log4j . PatternLayout \n + log4j . appender . stdout . layout . ConversionPattern = [ % d { dd / MM / yy hh : mm : ss : sss z } ] % t % 5p % c { 2 } : % m % n \n new file \n dubbo - demo \ dubbo - demo - provider \ src \ main \ resources \ log4j . properties \n + # # # set log levels # # # \n + log4j . rootLogger = info , stdout \n + # # # 输出到控制台 # # # \n + log4j . appender . stdout = org . apache . log4j . ConsoleAppender \n + log4j . appender . stdout . Target = System . out \n + log4j . appender . stdout . layout = org . apache . log4j . PatternLayout \n + log4j . appender . stdout . layout . ConversionPattern = [ % d { dd / MM / yy hh : mm : ss : sss z } ] % t % 5p % c { 2 } : % m % n \n",Add log4j . properties to dubbo - demo,634
dubbo - config \ dubbo - config - api \ pom . xml \n - < version > $ { jel _ version } < / version > \n + < scope > test < / scope > \n dubbo - config \ dubbo - config - spring \ pom . xml \n + < dependency > \n + < groupId > org . glassfish < / groupId > \n + < artifactId > javax . el < / artifactId > \n + < scope > test < / scope > \n + < / dependency > \n dubbo - maven \ pom . xml \n + < dependency > \n + < groupId > org . glassfish < / groupId > \n + < artifactId > javax . el < / artifactId > \n + < version > 3 . 0 . 1 - b08 < / version > \n + < scope > provided < / scope > \n + < / dependency > \n dubbo - test \ dubbo - test - integration \ pom . xml \n + < dependency > \n + < groupId > org . glassfish < / groupId > \n + < artifactId > javax . el < / artifactId > \n + < / dependency > \n,Add javax . el dependency to test modules,634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ filter \ ExecuteLimitFilter . java \n - boolean isException = false ; \n + boolean isSuccess = true ; \n - isException = true ; \n + isSuccess = false ; \n - RpcStatus . endCount ( url , methodName , System . currentTimeMillis ( ) - begin , isException ) ; \n + RpcStatus . endCount ( url , methodName , System . currentTimeMillis ( ) - begin , isSuccess ) ; \n",Fix count reverse problem ( failure counted as success ) in ExecuteLimitFilter,634
"dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ extension \ ExtensionLoader . java \n - codeBuidler . append ( "" \ npublic class "" + type . getSimpleName ( ) + "" $ Adpative "" + "" implements "" + type . getCanonicalName ( ) + "" { "" ) ; \n + codeBuidler . append ( "" \ npublic class "" + type . getSimpleName ( ) + "" $ Adaptive "" + "" implements "" + type . getCanonicalName ( ) + "" { "" ) ; \n",Fix misspell of ' adaptive ' in ExtensionLoader,634
"dubbo - container \ dubbo - container - api \ src \ main \ java \ com \ alibaba \ dubbo \ container \ Main . java \n + import java . util . concurrent . locks . Condition ; \n + import java . util . concurrent . locks . ReentrantLock ; \n - private static volatile boolean running = true ; \n + private static final ReentrantLock LOCK = new ReentrantLock ( ) ; \n + \n + private static final Condition STOP = LOCK . newCondition ( ) ; \n - synchronized ( Main . class ) { \n - running = false ; \n - Main . class . notify ( ) ; \n + try { \n + LOCK . lock ( ) ; \n + STOP . signal ( ) ; \n + } finally { \n + LOCK . unlock ( ) ; \n - synchronized ( Main . class ) { \n - while ( running ) { \n - try { \n - Main . class . wait ( ) ; \n - } catch ( Throwable e ) { \n - } \n - } \n + try { \n + LOCK . lock ( ) ; \n + STOP . await ( ) ; \n + } catch ( InterruptedException e ) { \n + logger . warn ( "" Dubbo service server stopped , interrupted by other thread ! "" , e ) ; \n + } finally { \n + LOCK . unlock ( ) ; \n",Fixed # 520 change Main . class wait / notify to lock / condition,634
"dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ bytecode \ ClassGenerator . java \n + import com . alibaba . dubbo . common . utils . ClassHelper ; \n - return toClass ( getClass ( ) . getClassLoader ( ) , getClass ( ) . getProtectionDomain ( ) ) ; \n + return toClass ( ClassHelper . getClassLoader ( ClassGenerator . class ) , getClass ( ) . getProtectionDomain ( ) ) ; \n dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ bytecode \ Proxy . java \n - return getProxy ( ClassHelper . getCallerClassLoader ( Proxy . class ) , ics ) ; \n + return getProxy ( ClassHelper . getClassLoader ( Proxy . class ) , ics ) ; \n",Fixed # 434 proxy class should be loaded by contextclassloader,634
dubbo - monitor \ dubbo - monitor - default \ src \ main \ resources \ META - INF \ dubbo \ internal \ com . alibaba . dubbo . monitor . MonitorFactory \n - dubbo = com . alibaba . dubbo . monitor . dubbo . DubboMonitorFactroy \n + dubbo = com . alibaba . dubbo . monitor . dubbo . DubboMonitorFactory \n,Fixed # 360 typo ( dubbo - monitor ) : Fix typo of DubboMonitorFactory,634
dubbo - admin \ pom . xml \n + < exclusions > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - context < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - beans < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - web < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < / dependency > \n + < ! - - FIXME 临时解决spring 4和webx3 . x不兼容的问题 - - > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - context < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - beans < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - web < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - core < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - aop < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n,fix ( dubbo - admin ) : webx - 3 . 0 . 8 not compitable with spring - 4 . x,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ com \ alibaba \ dubbo \ config \ ServiceConfig . java \n + import com . alibaba . dubbo . common . utils . NamedThreadFactory ; \n + import java . util . concurrent . Executors ; \n + import java . util . concurrent . ScheduledExecutorService ; \n + import java . util . concurrent . TimeUnit ; \n + \n + private static final ScheduledExecutorService delayExportExecutor = Executors . newSingleThreadScheduledExecutor ( new NamedThreadFactory ( "" DubboServiceDelayExporter "" , true ) ) ; \n - if ( export ! = null & & ! export . booleanValue ( ) ) { \n + if ( export ! = null & & ! export ) { \n + \n - Thread thread = new Thread ( new Runnable ( ) { \n + delayExportExecutor . schedule ( new Runnable ( ) { \n - try { \n - Thread . sleep ( delay ) ; \n - } catch ( Throwable e ) { \n - } \n - } ) ; \n - thread . setDaemon ( true ) ; \n - thread . setName ( "" DelayExportServiceThread "" ) ; \n - thread . start ( ) ; \n + } , delay , TimeUnit . MILLISECONDS ) ; \n + public void setInterface ( String interfaceName ) { \n + this . interfaceName = interfaceName ; \n + if ( id = = null | | id . length ( ) = = 0 ) { \n + id = interfaceName ; \n + } \n + } \n + \n - public void setInterface ( String interfaceName ) { \n - this . interfaceName = interfaceName ; \n - if ( id = = null | | id . length ( ) = = 0 ) { \n - id = interfaceName ; \n - } \n - } \n - \n dubbo - config \ dubbo - config - spring \ src \ main \ java \ com \ alibaba \ dubbo \ config \ spring \ ServiceBean . java \n - return supportedApplicationListener & & ( delay = = null | | delay . intValue ( ) = = - 1 ) ; \n + return supportedApplicationListener & & ( delay = = null | | delay = = - 1 ) ; \n",Fixed # 543 service being exported on several ports ( 20880、20881 . . . ) due to concurrent problem on delay export .,634
dubbo - config \ dubbo - config - spring \ src \ main \ java \ com \ alibaba \ dubbo \ config \ spring \ AnnotationBean . java \n + serviceConfig . setRef ( bean ) ; \n - serviceConfig . setRef ( bean ) ; \n,Fixed # 666 serviceConfig . setRef ( bean ) 前移，避免delay = 0时的空指针,634
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ loadbalance \ AbstractLoadBalance . java \n - long timestamp = invoker . getUrl ( ) . getParameter ( Constants . TIMESTAMP _ KEY , 0L ) ; \n + long timestamp = invoker . getUrl ( ) . getParameter ( Constants . REMOTE _ TIMESTAMP _ KEY , 0L ) ; \n dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ ClusterUtils . java \n + / / 保留provider的启动timestamp \n + map . put ( Constants . REMOTE _ TIMESTAMP _ KEY , remoteMap . get ( Constants . TIMESTAMP _ KEY ) ) ; \n dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ Constants . java \n + public static final String REMOTE _ TIMESTAMP _ KEY = "" remote . timestamp "" ; \n + \n","Fix warmup timestamp bug , add ' remote . timestamp ' key to url on consumer side",634
"dubbo - test \ dubbo - test - examples \ src \ main \ java \ com \ alibaba \ dubbo \ examples \ heartbeat \ heartbeat - consumer . xml \n - < dubbo : reference id = "" helloService "" interface = "" com . alibaba . dubbo . examples . remoting . heartbeat . api . HelloService "" \n + < dubbo : reference id = "" helloService "" interface = "" com . alibaba . dubbo . examples . heartbeat . api . HelloService "" \n dubbo - test \ dubbo - test - examples \ src \ main \ java \ com \ alibaba \ dubbo \ examples \ heartbeat \ heartbeat - provider . xml \n - < bean id = "" helloService "" class = "" com . alibaba . dubbo . examples . remoting . heartbeat . impl . HelloServiceImpl "" / > \n + < bean id = "" helloService "" class = "" com . alibaba . dubbo . examples . heartbeat . impl . HelloServiceImpl "" / > \n - < dubbo : service registry = "" N / A "" interface = "" com . alibaba . dubbo . examples . remoting . heartbeat . api . HelloService "" \n + < dubbo : service registry = "" N / A "" interface = "" com . alibaba . dubbo . examples . heartbeat . api . HelloService "" \n",Fix config error of heartbeat UT in dubbo - test - examples,634
dubbo - admin \ pom . xml \n + < dependency > \n + < groupId > org . apache . velocity < / groupId > \n + < artifactId > velocity < / artifactId > \n + < / dependency > \n pom . xml \n + < velocity _ version > 3 . 1 . 6 < / velocity _ version > \n + < dependency > \n + < groupId > org . apache . velocity < / groupId > \n + < artifactId > velocity < / artifactId > \n + < version > $ { velocity _ version } < / version > \n + < / dependency > \n,Upgrade webx version to fix dubbo - admin incompatible problem when running with jdk1 . 8,634
pom . xml \n - < webx _ version > 3 . 0 . 8 < / webx _ version > \n - < velocity _ version > 3 . 1 . 6 < / velocity _ version > \n + < webx _ version > 3 . 1 . 6 < / webx _ version > \n + < velocity _ version > 1 . 7 < / velocity _ version > \n,Upgrade webx version to fix dubbo - admin incompatible problem when running with jdk1 . 8,634
dubbo - remoting \ dubbo - remoting - zookeeper \ src \ test \ java \ com \ alibaba \ dubbo \ remoting \ zookeeper \ curator \ CuratorZookeeperClientTest . java \n + import org . junit . Ignore ; \n + @ Ignore \n,Ignore unit test CuratorZookeeperClientTest ( no zk server ),634
dubbo - remoting \ dubbo - remoting - netty4 \ pom . xml \n - < name > dubbo - remoting - netty4 < / name > \n + < name > $ { project . artifactId } < / name > \n + < description > The netty4 remoting module of dubbo project < / description > \n + < skip _ maven _ deploy > true < / skip _ maven _ deploy > \n dubbo \ pom . xml \n + < dependency > \n + < groupId > com . alibaba < / groupId > \n + < artifactId > dubbo - remoting - netty4 < / artifactId > \n + < version > $ { project . parent . version } < / version > \n + < / dependency > \n + < include > com . alibaba : dubbo - remoting - netty4 < / include > \n,Add package support for ' dubbo - remoting - netty4 ' module,634
dubbo - maven \ pom . xml \n + < dependency > \n + < groupId > io . netty < / groupId > \n + < artifactId > netty - all < / artifactId > \n + < version > 4 . 0 . 35 . Final < / version > \n + < scope > provided < / scope > \n + < / dependency > \n,Add netty4 dependency to ' dubbo - maven / pom . xml ',634
"dubbo - simple \ dubbo - monitor - simple \ src \ main \ java \ com \ alibaba \ dubbo \ monitor \ simple \ SimpleMonitorService . java \n - private static SimpleMonitorService INSTANCE = null ; \n - INSTANCE = this ; \n - } \n - \n - public static SimpleMonitorService getInstance ( ) { \n - return INSTANCE ; \n + statisticsDirectory = ConfigUtils . getProperty ( "" dubbo . statistics . directory "" ) ; \n + chartsDirectory = ConfigUtils . getProperty ( "" dubbo . charts . directory "" ) ; \n - public String getStatisticsDirectory ( ) { \n - return statisticsDirectory ; \n - } \n - \n - public void setStatisticsDirectory ( String statistics ) { \n - if ( statistics ! = null ) { \n - this . statisticsDirectory = statistics ; \n - } \n - } \n - \n - public String getChartsDirectory ( ) { \n - return chartsDirectory ; \n - } \n - \n - public void setChartsDirectory ( String charts ) { \n - if ( charts ! = null ) { \n - this . chartsDirectory = charts ; \n - } \n - } \n - \n dubbo - simple \ dubbo - monitor - simple \ src \ main \ java \ com \ alibaba \ dubbo \ monitor \ simple \ pages \ ChartsPageHandler . java \n + import com . alibaba . dubbo . common . utils . ConfigUtils ; \n - import com . alibaba . dubbo . monitor . simple . SimpleMonitorService ; \n - String directory = SimpleMonitorService . getInstance ( ) . getChartsDirectory ( ) ; \n + String directory = ConfigUtils . getProperty ( "" dubbo . charts . directory "" ) ; \n dubbo - simple \ dubbo - monitor - simple \ src \ main \ java \ com \ alibaba \ dubbo \ monitor \ simple \ pages \ StatisticsPageHandler . java \n + import com . alibaba . dubbo . common . utils . ConfigUtils ; \n - import com . alibaba . dubbo . monitor . simple . SimpleMonitorService ; \n - String directory = SimpleMonitorService . getInstance ( ) . getStatisticsDirectory ( ) ; \n + String directory = ConfigUtils . getProperty ( "" dubbo . statistics . directory "" ) ; \n",Fixed # 847 remove unreasonable instance getter in SimpleMonitorService,634
"dubbo - remoting \ dubbo - remoting - zookeeper \ src \ main \ java \ com \ alibaba \ dubbo \ remoting \ zookeeper \ curator \ CuratorZookeeperClient . java \n + import com . alibaba . dubbo . common . utils . StringUtils ; \n + import java . util . Collections ; \n - listener . childChanged ( event . getPath ( ) , client . getChildren ( ) . usingWatcher ( this ) . forPath ( event . getPath ( ) ) ) ; \n + String path = event . getPath ( ) = = null ? "" "" : event . getPath ( ) ; \n + listener . childChanged ( path , \n + / / if path is null , curator using watcher will throw NullPointerException . \n + / / if client connect or disconnect to server , zookeeper will queue \n + / / watched event ( Watcher . Event . EventType . None , . . , path = null ) . \n + StringUtils . isNotEmpty ( path ) \n + ? client . getChildren ( ) . usingWatcher ( this ) . forPath ( path ) \n + : Collections . < String > emptyList ( ) ) ; \n",Merged # 928 manually : fix curator null path bug,634
"dubbo - config \ dubbo - config - spring \ src \ main \ java \ com \ alibaba \ dubbo \ config \ spring \ ServiceBean . java \n - import org . springframework . context . ApplicationEvent ; \n - public class ServiceBean < T > extends ServiceConfig < T > implements InitializingBean , DisposableBean , ApplicationContextAware , ApplicationListener , BeanNameAware { \n + public class ServiceBean < T > extends ServiceConfig < T > implements InitializingBean , DisposableBean , ApplicationContextAware , ApplicationListener < ContextRefreshedEvent > , BeanNameAware { \n - public void onApplicationEvent ( ApplicationEvent event ) { \n - if ( ContextRefreshedEvent . class . getName ( ) . equals ( event . getClass ( ) . getName ( ) ) ) { \n - if ( isDelay ( ) & & ! isExported ( ) & & ! isUnexported ( ) ) { \n - if ( logger . isInfoEnabled ( ) ) { \n - logger . info ( "" The service ready on spring started . service : "" + getInterface ( ) ) ; \n - } \n - export ( ) ; \n + public void onApplicationEvent ( ContextRefreshedEvent event ) { \n + if ( isDelay ( ) & & ! isExported ( ) & & ! isUnexported ( ) ) { \n + if ( logger . isInfoEnabled ( ) ) { \n + logger . info ( "" The service ready on spring started . service : "" + getInterface ( ) ) ; \n + export ( ) ; \n",Tuning spring event performance ( # 969 ),634
"dubbo - simple \ dubbo - monitor - simple \ src \ main \ resources \ META - INF \ spring \ dubbo - monitor - simple . xml \n - < property name = "" statisticsDirectory "" value = "" $ { dubbo . statistics . directory } "" / > \n - < property name = "" chartsDirectory "" value = "" $ { dubbo . charts . directory } "" / > \n","Fixed # 938 , SimpleMonitorService only support read config from dubbo . properties",634
dubbo - admin \ pom . xml \n + < exclusions > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - context < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - beans < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - web < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < / dependency > \n + < ! - - FIXME 临时解决spring 4和webx3 . x不兼容的问题 - - > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - context < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - beans < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - web < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - core < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n + < / dependency > \n + < dependency > \n + < groupId > org . springframework < / groupId > \n + < artifactId > spring - aop < / artifactId > \n + < version > 3 . 2 . 16 . RELEASE < / version > \n,fix ( dubbo - admin ) : webx - 3 . 0 . 8 not compitable with spring - 4 . x,634
"dubbo - admin \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ common \ status \ MemoryStatusChecker . java \n - boolean ok = ( maxMemory - ( totalMemory - freeMemory ) > 2048 ) ; / / 剩余空间小于2M报警 \n + boolean ok = ( maxMemory - ( totalMemory - freeMemory ) > 2048 ) ; / / Alarm when spare memory < 2M \n + ( totalMemory / 1024 / 1024 ) + "" M , Free : "" + ( freeMemory / 1024 / 1024 ) \n + "" M , Use : "" + ( ( totalMemory / 1024 / 1024 ) - ( freeMemory / 1024 / 1024 ) ) + "" M "" ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ com \ alibaba \ dubbo \ config \ ReferenceConfig . java \n - / / attributes通过系统context进行存储 . \n + / / attributes are stored by system context . \n - if ( url ! = null & & url . length ( ) > 0 ) { / / 指定URL的情况下，不做本地引用 \n + if ( url ! = null & & url . length ( ) > 0 ) { / / if a url is specified , don ' t do local reference \n dubbo - plugin \ dubbo - qos \ src \ main \ java \ com \ alibaba \ dubbo \ qos \ textui \ TTable . java \n - * 获取表格边框设置 \n dubbo - registry \ dubbo - registry - api \ src \ test \ java \ com \ alibaba \ dubbo \ registry \ PerformanceRegistryTest . java \n - / / 读取参数 \n + / / read server info from property \n dubbo - registry \ dubbo - registry - default \ src \ test \ java \ com \ alibaba \ dubbo \ registry \ dubbo \ RegistryDirectoryTest . java \n - / / 两个invoker = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = \n + / / 2 invokers = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = = \n","I18N effort for code base , translate the missing content",634
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ loadbalance \ ConsistentHashLoadBalance . java \n + import com . alibaba . dubbo . rpc . support . RpcUtils ; \n - String key = invokers . get ( 0 ) . getUrl ( ) . getServiceKey ( ) + "" . "" + invocation . getMethodName ( ) ; \n + String methodName = RpcUtils . getMethodName ( invocation ) ; \n + String key = invokers . get ( 0 ) . getUrl ( ) . getServiceKey ( ) + "" . "" + methodName ; \n - selectors . put ( key , new ConsistentHashSelector < T > ( invokers , invocation . getMethodName ( ) , identityHashCode ) ) ; \n + selectors . put ( key , new ConsistentHashSelector < T > ( invokers , methodName , identityHashCode ) ) ; \n dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ support \ AbstractClusterInvoker . java \n - . getMethodParameter ( invocation . getMethodName ( ) , Constants . LOADBALANCE _ KEY , Constants . DEFAULT _ LOADBALANCE ) ) ; \n + . getMethodParameter ( RpcUtils . getMethodName ( invocation ) , Constants . LOADBALANCE _ KEY , Constants . DEFAULT _ LOADBALANCE ) ) ; \n","Merge pull request # 1872 , get the real methodname to support consistenthash for generic invoke .",634
"dubbo - cluster \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ cluster \ configurator \ AbstractConfigurator . java \n - Set < String > condtionKeys = new HashSet < String > ( ) ; \n - condtionKeys . add ( Constants . CATEGORY _ KEY ) ; \n - condtionKeys . add ( Constants . CHECK _ KEY ) ; \n - condtionKeys . add ( Constants . DYNAMIC _ KEY ) ; \n - condtionKeys . add ( Constants . ENABLED _ KEY ) ; \n + Set < String > conditionKeys = new HashSet < String > ( ) ; \n + conditionKeys . add ( Constants . CATEGORY _ KEY ) ; \n + conditionKeys . add ( Constants . CHECK _ KEY ) ; \n + conditionKeys . add ( Constants . DYNAMIC _ KEY ) ; \n + conditionKeys . add ( Constants . ENABLED _ KEY ) ; \n - condtionKeys . add ( key ) ; \n + conditionKeys . add ( key ) ; \n - return doConfigure ( url , configuratorUrl . removeParameters ( condtionKeys ) ) ; \n + return doConfigure ( url , configuratorUrl . removeParameters ( conditionKeys ) ) ; \n - if ( i < j ) { \n - return - 1 ; \n - } else if ( i > j ) { \n - return 1 ; \n - } else { \n - return 0 ; \n - } \n + return i < j ? - 1 : ( i = = j ? 0 : 1 ) ; \n","Merge # 1740 manually , fix typo .",634
"dubbo - remoting \ dubbo - remoting - zookeeper \ src \ main \ java \ com \ alibaba \ dubbo \ remoting \ zookeeper \ ZookeeperTransporter . java \n - @ SPI ( "" zkclient "" ) \n + @ SPI ( "" curator "" ) \n","Fixed # 1186 , change the default ZK client from ` zkclient ` to ` curator `",634
"dubbo - remoting \ dubbo - remoting - zookeeper \ src \ main \ java \ com \ alibaba \ dubbo \ remoting \ zookeeper \ ZookeeperTransporter . java \n - @ SPI ( "" zkclient "" ) \n + @ SPI ( "" curator "" ) \n","Fixed # 1186 , change the default ZK client from ` zkclient ` to ` curator `",634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ com \ alibaba \ dubbo \ remoting \ telnet \ codec \ TelnetCodec . java \n - return Charset . forName ( "" GBK "" ) ; \n + return Charset . forName ( Constants . DEFAULT _ CHARSET ) ; \n","Merge # 1215 manually , unify charset as UTF - 8",634
"dubbo - rpc \ dubbo - rpc - rest \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ rest \ NettyServer . java \n + import com . alibaba . dubbo . common . utils . NetUtils ; \n - server . setPort ( url . getPort ( ) ) ; \n + String bindIp = url . getParameter ( Constants . BIND _ IP _ KEY , url . getHost ( ) ) ; \n + if ( ! url . isAnyHost ( ) & & NetUtils . isValidLocalHost ( bindIp ) ) { \n + server . setHostname ( bindIp ) ; \n + } \n + server . setPort ( url . getParameter ( Constants . BIND _ PORT _ KEY , url . getPort ( ) ) ) ; \n + server . setMaxRequestSize ( url . getParameter ( Constants . PAYLOAD _ KEY , Constants . DEFAULT _ PAYLOAD ) ) ; \n dubbo - test \ dubbo - test - examples \ src \ main \ java \ com \ alibaba \ dubbo \ examples \ rest \ RestConsumer . java \n - RpcContext . getContext ( ) . setAttachment ( "" clientImpl "" , "" dubbox "" ) ; \n + RpcContext . getContext ( ) . setAttachment ( "" clientImpl "" , "" dubbo "" ) ; \n dubbo - test \ pom . xml \n + < dependency > \n + < groupId > org . hibernate < / groupId > \n + < artifactId > hibernate - validator < / artifactId > \n + < / dependency > \n + < dependency > \n + < groupId > org . glassfish < / groupId > \n + < artifactId > javax . el < / artifactId > \n + < / dependency > \n","Fixed # 1226 , enhance netty support for rest protocol",634
"dubbo - filter \ dubbo - filter - validation \ src \ main \ java \ com \ alibaba \ dubbo \ validation \ filter \ ValidationFilter . java \n + import com . alibaba . dubbo . rpc . RpcResult ; \n - throw new RpcException ( t . getMessage ( ) , t ) ; \n + return new RpcResult ( t ) ; \n","Fix # 1031 , return RpcResult for validation exception to avoid retry .",634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ com \ alibaba \ dubbo \ remoting \ transport \ CodecSupport . java \n + import java . io . IOException ; \n + private static Map < Byte , String > ID _ SERIALIZATIONNAME _ MAP = new HashMap < Byte , String > ( ) ; \n + ID _ SERIALIZATIONNAME _ MAP . put ( idByte , name ) ; \n - public static Serialization getSerialization ( URL url , Byte id ) { \n - Serialization result = getSerializationById ( id ) ; \n - if ( result = = null ) { \n - result = getSerialization ( url ) ; \n + public static Serialization getSerialization ( URL url , Byte id ) throws IOException { \n + Serialization serialization = getSerializationById ( id ) ; \n + String serializationName = url . getParameter ( Constants . SERIALIZATION _ KEY , Constants . DEFAULT _ REMOTING _ SERIALIZATION ) ; \n + / / Check if "" serialization id "" passed from network matches the id on this side ( only take effect for JDK serialization ) , for security purpose . \n + if ( serialization = = null \n + | | ( ( id = = 3 | | id = = 7 | | id = = 4 ) & & ! ( serializationName . equals ( ID _ SERIALIZATIONNAME _ MAP . get ( id ) ) ) ) ) { \n + throw new IOException ( "" Unexpected serialization id : "" + id + "" received from network , please check if the peer send the right id . "" ) ; \n - return result ; \n + return serialization ; \n",Fixed # 1138 check serialization in case it ' s changed from network .,634
all \ pom . xml \n - < promoteTransitiveDependencies > true < / promoteTransitiveDependencies > \n + < promoteTransitiveDependencies > false < / promoteTransitiveDependencies > \n,"Fix "" promoteTransitiveDependencies = false "" of maven - shade - plugin",634
hessian - lite \ src \ main \ java \ com \ alibaba \ com \ caucho \ hessian \ io \ JavaDeserializer . java \n - return 0 ; \n + return new Byte ( ( byte ) 0 ) ; \n - return 0 ; \n + return new Short ( ( short ) 0 ) ; \n - return 0 ; \n + return new Character ( ( char ) 0 ) ; \n - return 0 ; \n + return Integer . valueOf ( 0 ) ; \n - return 0L ; \n + return Long . valueOf ( 0 ) ; \n - return 0F ; \n + return Float . valueOf ( 0 ) ; \n - return 0D ; \n + return Double . valueOf ( 0 ) ; \n,"Fixed # 1398 , revert bugs introduced from # 1375",634
"dubbo - rpc \ dubbo - rpc - default \ src \ test \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ dubbo \ ImplicitCallBackTest . java \n - ret = pFuture . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n + ret = pFuture . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n - ret = p1Future . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n - ret2 = p2Future . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n + ret = p1Future . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n + ret2 = p2Future . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n",Fix time unit problem related with FutureAdapter in UT,634
"dubbo - rpc \ dubbo - rpc - default \ src \ test \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ dubbo \ ImplicitCallBackTest . java \n - ret = pFuture . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n + ret = pFuture . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n - ret = p1Future . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n - ret2 = p2Future . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n + ret = p1Future . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n + ret2 = p2Future . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n - ret = pFuture . get ( 1000 , TimeUnit . MICROSECONDS ) ; \n + ret = pFuture . get ( 1000 * 1000 , TimeUnit . MICROSECONDS ) ; \n",Fix time unit problem related with FutureAdapter in UT,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ Constants . java \n - public static final String TAG _ KEY = "" tag "" ; \n + public static final String TAG _ KEY = "" dubbo . tag "" ; \n - public static final String FORCE _ USE _ TAG = "" force . tag "" ; \n + public static final String FORCE _ USE _ TAG = "" dubbo . force . tag "" ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractServiceConfig . java \n + @ Parameter ( key = "" dubbo . tag "" , useKeyAsProperty = false ) \n",add ` dubbo . ` prefix for tag router key,634
pom . xml \n - < excludePackageNames > com . alibaba . com . * < / excludePackageNames > \n,Change pom to create javadoc for embedded hessian - lite,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ RouterChain . java \n + node . setInvokers ( null ) ; / / only store invoker list in leaf nodes . \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ AbstractRouter . java \n - * TODO Extract more code here if necessary \n + * TODO Extract more code to here if necessary \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ ConfigConditionRouter . java \n - logger . info ( "" Notification of tag rule , change type is : "" + event . getChangeType ( ) + "" , raw rule is : \ n "" + event . getNewValue ( ) ) ; \n + logger . info ( "" Notification of condition rule , change type is : "" + event . getChangeType ( ) + "" , raw rule is : \ n "" + event . getNewValue ( ) ) ; \n - routerChain . notifyRuleChanged ( ) ; \n + \n + if ( routerChain ! = null ) { \n + routerChain . notifyRuleChanged ( ) ; \n + } \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ tag \ TagRouter . java \n - routerChain . notifyRuleChanged ( ) ; \n + if ( routerChain ! = null ) { \n + routerChain . notifyRuleChanged ( ) ; \n + } \n dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryDirectory . java \n - methodGroupInvokers . put ( method , groupInvokers ) ; \n + methodGroupInvokers . put ( method , groupList ) ; \n",fix problem when creating router chain for StaticDirectory ( consume multi groups ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ AbstractProtocol . java \n + import com . alibaba . dubbo . common . Constants ; \n - return ProtocolUtils . serviceKey ( url ) ; \n + int port = url . getParameter ( Constants . BIND _ PORT _ KEY , url . getPort ( ) ) ; \n + return serviceKey ( port , url . getPath ( ) , url . getParameter ( Constants . VERSION _ KEY ) , \n + url . getParameter ( Constants . GROUP _ KEY ) ) ; \n","Fixes # 1289 , use bind _ port as mapping key",634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ support \ AbstractRegistry . java \n - import java . util . concurrent . atomic . AtomicBoolean ; \n - private AtomicBoolean destroyed = new AtomicBoolean ( false ) ; \n - \n - if ( ! destroyed . compareAndSet ( false , true ) ) { \n - return ; \n - } \n - \n dubbo - registry \ dubbo - registry - api \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ support \ FailbackRegistry . java \n - import java . util . concurrent . atomic . AtomicBoolean ; \n - private AtomicBoolean destroyed = new AtomicBoolean ( false ) ; \n - \n - if ( destroyed . get ( ) ) { \n - return ; \n - } \n - if ( destroyed . get ( ) ) { \n - return ; \n - } \n - if ( destroyed . get ( ) ) { \n - return ; \n - } \n - if ( destroyed . get ( ) ) { \n - return ; \n - } \n - if ( ! canDestroy ( ) ) { \n - return ; \n - } \n - / / TODO : 2017 / 8 / 30 to abstract this method \n - protected boolean canDestroy ( ) { \n - if ( destroyed . compareAndSet ( false , true ) ) { \n - return true ; \n - } else { \n - return false ; \n - } \n - } \n - \n - \n","Fixes # 1313 , remove destroy check in Registry .",634
"new file \n CHANGES . md \n + 1 . Hessian - lite serialization : revert locale serialization for compatibility , # 1413 \n + 2 . Asset transfer to ASF , includeing pom , license , DISCLAIMER and so on , # 1491 \n + 3 . Introduce of new dispatcher policy : EagerThreadpool , # 1568 \n + 4 . Separate monitor data with group and version , # 1407 \n + 5 . Spring Boot Enhancenment , # 1611 \n + 6 . Gaceful shutdown enhancement \n + - Remove exporter destroy logic in AnnotationBean . \n + - Waiting for registry notification on consumer side by checking channel state . \n + 7 . Simplify consumer / provider side check in RpcContext , # 1444 . \n",Add CHANGES . md as release note .,634
distribution \ src \ assembly \ source - release . xml \n + < exclude > * * / * . log < / exclude > \n,Add * . log exclude pattern for source - release assembly,634
distribution \ pom . xml \n - < version > 3 . 2 . 2 < / version > \n + < version > 3 . 2 . 3 < / version > \n dubbo - bootstrap \ pom . xml \n - < version > 2 . 6 . 2 - SNAPSHOT < / version > \n + < version > 2 . 6 . 3 - SNAPSHOT < / version > \n dubbo - serialization \ dubbo - serialization - api \ pom . xml \n - < version > 2 . 6 . 3 - SNAPSHOT < / version > \n + < version > 3 . 2 . 3 < / version > \n dubbo - serialization \ dubbo - serialization - hessian2 \ pom . xml \n - < version > 2 . 6 . 3 - SNAPSHOT < / version > \n + < version > 3 . 2 . 3 < / version > \n dubbo - serialization \ dubbo - serialization - jdk \ pom . xml \n - < version > 2 . 6 . 3 - SNAPSHOT < / version > \n + < version > 3 . 2 . 3 < / version > \n dubbo - test \ pom . xml \n - < version > 3 . 2 . 2 < / version > \n + < version > 3 . 2 . 3 < / version > \n hessian - lite \ pom . xml \n - < version > 2 . 6 . 3 - SNAPSHOT < / version > \n + < version > 3 . 2 . 3 < / version > \n,upgrade version manually after merge 2 . 6 . 2 - release,634
dubbo - maven \ pom . xml \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n - < version > 3 . 1 . 4 . Final < / version > \n + < version > 3 . 0 . 19 - FInal < / version > \n + < dependency > \n + < groupId > com . esotericsoftware < / groupId > \n + < artifactId > kryo < / artifactId > \n + < version > 4 . 0 . 1 < / version > \n + < / dependency > \n + < dependency > \n + < groupId > de . javakaffee < / groupId > \n + < artifactId > kryo - serializers < / artifactId > \n + < version > 0 . 42 < / version > \n + < / dependency > \n + < dependency > \n + < groupId > de . ruedigermoeller < / groupId > \n + < artifactId > fst < / artifactId > \n + < version > 2 . 48 - jdk - 6 < / version > \n + < / dependency > \n pom . xml \n - < netty4 _ version > 4 . 1 . 16 . Final < / netty4 _ version > \n + < netty4 _ version > 4 . 0 . 35 . Final < / netty4 _ version > \n + \n - < resteasy _ version > 3 . 1 . 4 . Final < / resteasy _ version > \n + < resteasy _ version > 3 . 0 . 19 . Final < / resteasy _ version > \n,Degrade the resteasy and netty version for jdk1 . 7 compatibility .,634
dubbo - maven \ pom . xml \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n - < version > 3 . 0 . 19 - Final < / version > \n + < version > 3 . 0 . 19 . Final < / version > \n,Fix typo of resteasy version in dubbo - maven,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ Router . java \n + import org . apache . dubbo . rpc . cluster . router . TreeNode ; \n - return "" "" ; \n + return TreeNode . FAILOVER _ KEY ; \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ InvokerTreeCache . java \n + / * * \n + * This may mistakely return empty list for runtime routers \n + * see { @ link org . apache . dubbo . rpc . cluster . router . tag . TagRouter . getKey ( ) } for the workaround . \n + * / \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ ConditionRouter . java \n - import org . apache . dubbo . rpc . cluster . router . TreeNode ; \n - @ Override \n - public String getKey ( ) { \n - return TreeNode . FAILOVER _ KEY ; \n - } \n - \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ ConfigConditionRouter . java \n + if ( isRuntime ( ) ) { \n + return super . getKey ( ) ; \n + } \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ script \ ScriptRouter . java \n - import org . apache . dubbo . rpc . cluster . router . TreeNode ; \n - @ Override \n - public String getKey ( ) { \n - return TreeNode . FAILOVER _ KEY ; \n - } \n - \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ tag \ TagRouter . java \n - result = filterInvoker ( invokers , invoker - > invoker . getUrl ( ) . getParameter ( Constants . TAG _ KEY ) . equals ( tag ) ) ; \n + result = filterInvoker ( invokers , invoker - > tag . equals ( invoker . getUrl ( ) . getParameter ( Constants . TAG _ KEY ) ) ) ; \n + @ Override \n + if ( isRuntime ( ) ) { \n + return super . getKey ( ) ; \n + } \n",Fix problem when rule need to run at runtime .,634
. travis . yml \n - oraclejdk8 \n - - travis _ wait 30 . / mvnw clean package \n + - travis _ wait 30 . / mvnw clean package - Dcheckstyle . skip = false - Drat . skip = false \n - bash < ( curl - s https : / / codecov . io / bash ) \n,"Merge pull request # 2130 , enable checkstyle and rat plugin in travis . \n Fixes # 2129",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ ExtensionLoader . java \n + codeBuilder . append ( "" \ nprivate static final org . apache . dubbo . common . logger . Logger logger = org . apache . dubbo . common . logger . LoggerFactory . getLogger ( ExtensionLoader . class ) ; "" ) ; \n + codeBuilder . append ( "" \ nprivate java . util . concurrent . atomic . AtomicInteger count = new java . util . concurrent . atomic . AtomicInteger ( 0 ) ; \ n "" ) ; \n + \n - s = String . format ( "" \ n % s extension = ( % < s ) % s . getExtensionLoader ( % s . class ) . getExtension ( extName ) ; "" , \n - type . getName ( ) , ExtensionLoader . class . getSimpleName ( ) , type . getName ( ) ) ; \n - code . append ( s ) ; \n + code . append ( String . format ( "" \ n % s extension = null ; \ n try { \ nextension = ( % < s ) % s . getExtensionLoader ( % s . class ) . getExtension ( extName ) ; \ n } catch ( Exception e ) { \ n "" , \n + type . getName ( ) , ExtensionLoader . class . getSimpleName ( ) , type . getName ( ) ) ) ; \n + code . append ( String . format ( "" if ( count . incrementAndGet ( ) = = 1 ) { \ nlogger . warn ( \ "" Failed to find extension named \ "" + extName + \ "" for type % s , will use default extension % s instead . \ "" , e ) ; \ n } \ n "" , \n + type . getName ( ) , defaultExtName ) ) ; \n + code . append ( String . format ( "" extension = ( % s ) % s . getExtensionLoader ( % s . class ) . getExtension ( \ "" % s \ "" ) ; \ n } "" , \n + type . getName ( ) , ExtensionLoader . class . getSimpleName ( ) , type . getName ( ) , defaultExtName ) ) ; \n","Increase availability , make @ Adaptive try default extension when the specified one couldn ' t be found . ( # 2159 ) \n * Increase availability , make @ Adaptive try default extension when the specified one couldn ' t be found . \n * Add warn log for @ Adaptive when using default extension . \n * Optimization , append to StringBuilder directly .",634
"new file \n dubbo - cluster \ src \ test \ resources \ com \ alibaba \ dubbo \ rpc \ cluster \ router \ file \ availablerule . javascript \n + function route ( invokers , invocation , context ) { \n + var result = new java . util . ArrayList ( invokers . size ( ) ) ; \n + \n + for ( i = 0 ; i < invokers . size ( ) ; i + + ) { \n + if ( invokers . get ( i ) . isAvailable ( ) ) { \n + result . add ( invokers . get ( i ) ) ; \n + } \n + } ; \n + return result ; \n + } ; \n + route ( invokers , invocation , context ) ; \n new file \n dubbo - cluster \ src \ test \ resources \ com \ alibaba \ dubbo \ rpc \ cluster \ router \ file \ methodrule . javascript \n + function route ( invokers , invocation , context ) { \n + var result = new java . util . ArrayList ( ) ; \n + if ( invokers . size ( ) > 1 & & invocation . getMethodName ( ) . equals ( "" method1 "" ) ) { \n + result . add ( invokers . get ( 0 ) ) ; \n + } else { \n + result . add ( invokers . get ( 1 ) ) ; \n + } \n + return result ; \n + } ; \n + route ( invokers , invocation , context ) ; \n new file \n dubbo - cluster \ src \ test \ resources \ com \ alibaba \ dubbo \ rpc \ cluster \ router \ file \ notAvailablerule . javascript \n + function route ( invokers , invocation , context ) { \n + var result = new java . util . ArrayList ( invokers . size ( ) ) ; \n + \n + for ( i = 0 ; i < invokers . size ( ) ; i + + ) { \n + if ( ! invokers . get ( i ) . isAvailable ( ) ) { \n + result . add ( invokers . get ( i ) ) ; \n + } \n + } ; \n + return result ; \n + } ; \n + route ( invokers , invocation , context ) ; \n",Add . script route rules back for UT,634
bom \ pom . xml \n - < groupId > org . sonatype . oss < / groupId > \n - < artifactId > oss - parent < / artifactId > \n - < version > 7 < / version > \n + < groupId > org . apache < / groupId > \n + < artifactId > apache < / artifactId > \n + < version > 19 < / version > \n dependencies - bom \ pom . xml \n - < groupId > org . sonatype . oss < / groupId > \n - < artifactId > oss - parent < / artifactId > \n - < version > 7 < / version > \n + < groupId > org . apache < / groupId > \n + < artifactId > apache < / artifactId > \n + < version > 19 < / version > \n pom . xml \n - < groupId > org . sonatype . oss < / groupId > \n - < artifactId > oss - parent < / artifactId > \n - < version > 7 < / version > \n + < groupId > org . apache < / groupId > \n + < artifactId > apache < / artifactId > \n + < version > 19 < / version > \n,"Merge pull request # 2005 , change maven parent from sonatype to apache .",634
dubbo - bom \ pom . xml \n - < dependency > \n - < groupId > com . alibaba < / groupId > \n - < artifactId > hessian - lite < / artifactId > \n - < version > 3 . 2 . 3 < / version > \n - < / dependency > \n,Remove hessian - lite dependency from bom pom,634
dubbo - config \ dubbo - config - dynamic \ src \ main \ java \ org \ apache \ dubbo \ config \ dynamic \ support \ archaius \ sources \ ZooKeeperConfigurationSource . java \n + if ( type = = TreeCacheEvent . Type . INITIALIZED | | type = = TreeCacheEvent . Type . CONNECTION _ RECONNECTED ) { \n + connected = true ; \n + } \n,Update config connecting status when ZK connection changes .,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ configurator \ AbstractConfigurator . java \n - if ( configuratorUrl . getHost ( ) = = null | | url = = null | | url . getHost ( ) = = null ) { \n + / / If override url is not enabled or is invalid , just return . \n + if ( ! configuratorUrl . getParameter ( Constants . ENABLED _ KEY , true ) | | configuratorUrl . getHost ( ) = = null | | url = = null | | url . getHost ( ) = = null ) { \n",Add enabled = true check for override url .,634
bom \ pom . xml \n - < groupId > org . apache < / groupId > \n - < artifactId > apache < / artifactId > \n - < version > 18 < / version > \n - < relativePath / > \n + < groupId > org . sonatype . oss < / groupId > \n + < artifactId > oss - parent < / artifactId > \n + < version > 7 < / version > \n dependencies - bom \ pom . xml \n - < groupId > org . apache < / groupId > \n - < artifactId > apache < / artifactId > \n - < version > 18 < / version > \n - < relativePath / > \n + < groupId > org . sonatype . oss < / groupId > \n + < artifactId > oss - parent < / artifactId > \n + < version > 7 < / version > \n pom . xml \n - < groupId > org . apache < / groupId > \n - < artifactId > apache < / artifactId > \n - < version > 18 < / version > \n + < groupId > org . sonatype . oss < / groupId > \n + < artifactId > oss - parent < / artifactId > \n + < version > 7 < / version > \n,Change parent pom back to oss in this version,634
dubbo - dependencies - bom \ pom . xml \n - < scope > provided < / scope > \n dubbo - governance \ dubbo - governance - zookeeper \ pom . xml \n + < dependency > \n + < groupId > commons - configuration < / groupId > \n + < artifactId > commons - configuration < / artifactId > \n + < / dependency > \n,Remove provided scope restrict of commons - configuration dependency,634
"dubbo - governance \ dubbo - governance - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ governance \ support \ archaius \ sources \ ZooKeeperConfigurationSource . java \n - public static final String DEFAULT _ CONFIG _ ROOT _ PATH = "" / dubbo / config "" ; \n + public static final String DEFAULT _ CONFIG _ ROOT _ PATH = "" / dubbo "" ; \n dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryProtocol . java \n + / * * \n + * generate a url contains configuration items for config center . \n + * if no configuration item found , use registry url instead . \n + * \n + * @ param registryUrl \n + * @ return \n + * / \n + \n + String configNamespace = registryUrl . getParameter ( Constants . CONFIG _ NAMESPACE _ KEY ) ; \n + if ( StringUtils . isEmpty ( configNamespace ) ) { \n + url = url . addParameter ( Constants . CONFIG _ NAMESPACE _ KEY , registryUrl . getParameter ( Constants . GROUP _ KEY , Constants . DEFAULT _ PROTOCOL ) ) ; \n + } \n",Change the default root directory of zookeeper config center from ' / dubbo / config ' to ' / dubbo ' .,634
"dubbo - demo \ dubbo - demo - consumer \ pom . xml \n + < dependency > \n + < groupId > org . apache . dubbo < / groupId > \n + < artifactId > dubbo - metadata - report - zookeeper < / artifactId > \n + < / dependency > \n dubbo - demo \ dubbo - demo - consumer \ src \ main \ resources \ META - INF \ spring \ dubbo - demo - consumer . xml \n - < dubbo : registry group = "" dubboregistrygroup1 "" address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" default = "" true "" / > \n - < dubbo : registry group = "" dubboregistrygroup1 "" address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" / > \n + < dubbo : registry address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" default = "" true "" / > \n + < dubbo : registry address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" / > \n - < dubbo : servicestore address = "" redis : / / 127 . 0 . 0 . 1 : 6379 "" / > \n + < dubbo : servicestore address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" / > \n dubbo - demo \ dubbo - demo - provider \ src \ main \ resources \ META - INF \ spring \ dubbo - demo - provider . xml \n - < dubbo : registry group = "" dubboregistrygroup1 "" address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" simple = "" false "" > \n + < ! - - < dubbo : registry group = "" dubboregistrygroup1 "" address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" simple = "" false "" > \n - < / dubbo : registry > \n + < / dubbo : registry > - - > \n + < dubbo : registry group = "" dubboregistrygroup1 "" address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" / > \n","Changes on demo , for test purpose .",634
dubbo - container \ dubbo - container - api \ pom . xml \n - < version > 2 . 6 . 0 < / version > \n + < version > 2 . 6 . 1 < / version > \n hessian - lite \ pom . xml \n - < version > 2 . 6 . 0 < / version > \n + < version > 2 . 6 . 1 < / version > \n,Upgrade version to 2 . 6 . 1,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ConfigCenterConfig . java \n - public void init ( ) throws Exception { \n + public void init ( ) { \n - throw e ; \n + throw new IllegalStateException ( "" Failed to parse configurations from Config Center . "" , e ) ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n + checkAndUpdateSubConfigs ( ) ; \n + \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + checkAndUpdateSubConfigs ( ) ; \n + \n dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ ReferenceBean . java \n - checkAndUpdateSubConfigs ( ) ; \n - \n dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ ServiceBean . java \n - checkAndUpdateSubConfigs ( ) ; \n - \n",Move refresh action of configs from Spring bean to a Config API .,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - if ( method . getReturnType ( ) = = Object . class | | parameter ! = null & & parameter . excluded ( ) ) { \n + / / treat url and configuration differently , the value should always present in configuration though it may not need to present in url . \n + / / if ( method . getReturnType ( ) = = Object . class | | parameter ! = null & & parameter . excluded ( ) ) { \n + if ( method . getReturnType ( ) = = Object . class ) { \n",ignore parameter ( exclude = true ) .,634
"dubbo - configcenter \ dubbo - configcenter - apollo \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ apollo \ ApolloDynamicConfiguration . java \n - if ( change . getChangeType ( ) = = PropertyChangeType . DELETED | | StringUtils . isEmpty ( change . getNewValue ( ) ) ) { \n + if ( change . getChangeType ( ) = = PropertyChangeType . DELETED ) { \n + if ( StringUtils . isEmpty ( change . getNewValue ( ) ) ) { \n + logger . warn ( "" We received an empty rule for "" + key + "" , the current working rule is "" + change . getOldValue ( ) + "" , the empty rule will not take effect . "" ) ; \n + return ; \n + } \n dubbo - configcenter \ dubbo - configcenter - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ archaius \ ArchaiusDynamicConfiguration . java \n + import org . apache . dubbo . common . logger . Logger ; \n + import org . apache . dubbo . common . logger . LoggerFactory ; \n + private static final Logger logger = LoggerFactory . getLogger ( ArchaiusDynamicConfiguration . class ) ; \n - if ( StringUtils . isEmpty ( newValue ) ) { \n + if ( newValue = = null ) { \n + if ( newValue . equals ( "" "" ) ) { \n + logger . warn ( "" We received an empty rule for "" + key + "" , the current working rule is unknown , the empty rule will not take effect . "" ) ; \n + return ; \n + } \n","empty rule protection : "" "" should not be treated as delete .",634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryProtocol . java \n + import org . apache . dubbo . registry . support . ProviderInvokerWrapper ; \n + public void unregister ( URL registryUrl , URL registedProviderUrl ) { \n + Registry registry = registryFactory . getRegistry ( registryUrl ) ; \n + registry . unregister ( registedProviderUrl ) ; \n + } \n + \n - boolean shouldReregister = ProviderConsumerRegTable . getProviderWrapper ( originInvoker ) . isReg ( ) ; \n + ProviderInvokerWrapper < T > providerInvokerWrapper = ProviderConsumerRegTable . getProviderWrapper ( originInvoker ) ; \n - if ( shouldReregister ) { \n + / * * \n + * Only if the new url going to Registry is different with the previous one should we do unregister and register . \n + * / \n + if ( providerInvokerWrapper . isReg ( ) & & ! registeredProviderUrl . equals ( providerInvokerWrapper . getProviderUrl ( ) ) ) { \n + unregister ( registryUrl , providerInvokerWrapper . getProviderUrl ( ) ) ; \n","Fix reExport , check url to registry changed before do register .",634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - System . out . println ( this . getClass ( ) . getName ( ) ) ; \n - System . out . println ( method . getName ( ) ) ; \n dubbo - configcenter \ dubbo - configcenter - apollo \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ apollo \ ApolloDynamicConfiguration . java \n - / / String configEnv = env . getCompositeConf ( ) . getString ( ENV _ KEY ) ; \n - / / String configCluster = env . getCompositeConf ( ) . getString ( CLUSTER _ KEY ) ; \n dubbo - configcenter \ dubbo - configcenter - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ archaius \ sources \ ZooKeeperConfigurationSource . java \n + import java . util . concurrent . CountDownLatch ; \n - private boolean connected = false ; \n + private CountDownLatch initializedLatch = new CountDownLatch ( 1 ) ; \n - connected = client . blockUntilConnected ( connectTimeout , TimeUnit . MILLISECONDS ) ; \n + boolean connected = client . blockUntilConnected ( connectTimeout , TimeUnit . MILLISECONDS ) ; \n - if ( type = = TreeCacheEvent . Type . INITIALIZED | | type = = TreeCacheEvent . Type . CONNECTION _ RECONNECTED ) { \n - connected = true ; \n + if ( type = = TreeCacheEvent . Type . INITIALIZED ) { \n + initializedLatch . countDown ( ) ; \n - if ( ! connected ) { \n - logger . warn ( "" ConfigCenter is not connected yet , zookeeper does ' t support local snapshot , so there ' s no backup data to use ! "" ) ; \n - return all ; \n + try { \n + initializedLatch . await ( ) ; \n + } catch ( InterruptedException e ) { \n + logger . error ( "" Being interrupted unexpectedly when waiting zookeeper to initialize , the config data may not ready yet , be careful ! "" ) ; \n - \n - public boolean isConnected ( ) { \n - return connected ; \n - } \n","Fix concurrent problem of zookeeper configcenter , wait to start until cache being fully populated .",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ ClassHelper . java \n + \n + / * * \n + * We only check boolean value at this moment . \n + * \n + * @ param type \n + * @ param value \n + * @ return \n + * / \n + public static boolean isTypeMatch ( Class < ? > type , String value ) { \n + if ( ( type = = boolean . class | | type = = Boolean . class ) \n + & & ! ( "" true "" . equals ( value ) | | "" false "" . equals ( value ) ) ) { \n + return false ; \n + } \n + return true ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - if ( value ! = null & & isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n + if ( value ! = null & & ClassHelper . isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n",Add extra type match check when override config value .,634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - if ( parameter ! = null & & parameter . key ( ) . length ( ) > 0 ) { \n + if ( parameter ! = null & & parameter . key ( ) . length ( ) > 0 & & parameter . propertyKey ( ) ) { \n,does not use parameter key in config metadata,634
"dubbo - configcenter \ dubbo - configcenter - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ zookeeper \ CacheListener . java \n + import org . apache . dubbo . common . utils . CollectionUtils ; \n - private Map < String , Set < ConfigurationListener > > listeners = new ConcurrentHashMap < > ( ) ; \n + private Map < String , Set < ConfigurationListener > > keyListeners = new ConcurrentHashMap < > ( ) ; \n - listeners . get ( key ) . forEach ( listener - > listener . process ( configChangeEvent ) ) ; \n + Set < ConfigurationListener > listeners = keyListeners . get ( key ) ; \n + if ( CollectionUtils . isNotEmpty ( listeners ) ) { \n + listeners . forEach ( listener - > listener . process ( configChangeEvent ) ) ; \n + } \n - Set < ConfigurationListener > set = this . listeners . computeIfAbsent ( key , k - > new CopyOnWriteArraySet < > ( ) ) ; \n + Set < ConfigurationListener > set = this . keyListeners . computeIfAbsent ( key , k - > new CopyOnWriteArraySet < > ( ) ) ; \n",fix NPE when no listeners registered for key,634
dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryDirectory . java \n - import org . apache . dubbo . common . utils . CollectionUtils ; \n - if ( invokerUrls ! = null & & invokerUrls . isEmpty ( ) & & this . cachedInvokerUrls ! = null ) { \n + if ( invokerUrls = = null ) { \n + invokerUrls = new ArrayList < > ( ) ; \n + } \n + if ( invokerUrls . isEmpty ( ) & & this . cachedInvokerUrls ! = null ) { \n - } else if ( invokerUrls ! = null ) { \n + } else { \n - if ( CollectionUtils . isEmpty ( invokerUrls ) ) { \n + if ( invokerUrls . isEmpty ( ) ) { \n,generate a empty list for invokerUrls in refreshInvoker if it ' s null,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ directory \ StaticDirectory . java \n - public void buildRouterChain ( List < Invoker < T > > groupInvokers ) { \n + public void buildRouterChain ( ) { \n - routerChain . notifyFullInvokers ( groupInvokers , getUrl ( ) ) ; \n + routerChain . notifyFullInvokers ( invokers , getUrl ( ) ) ; \n dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryDirectory . java \n - staticDirectory . buildRouterChain ( invokers ) ; \n + staticDirectory . buildRouterChain ( ) ; \n",fix wrong invokers reference to StaticDirectory under multi - group,634
dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ schema \ DubboBeanDefinitionParser . java \n - import java . util . List ; \n,remove package import used by comment to pass travis,634
"dubbo - cluster \ src \ test \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ ConditionRouterTest . java \n - invokers . add ( new MockInvoker < String > ( ) ) ; \n - invokers . add ( new MockInvoker < String > ( ) ) ; \n - invokers . add ( new MockInvoker < String > ( ) ) ; \n + invokers . add ( new MockInvoker < String > ( URL . valueOf ( "" dubbo : / / "" + NetUtils . getLocalHost ( ) + "" : 20880 / com . foo . BarService "" ) ) ) ; \n + invokers . add ( new MockInvoker < String > ( URL . valueOf ( "" dubbo : / / "" + NetUtils . getLocalHost ( ) + "" : 20880 / com . foo . BarService "" ) ) ) ; \n + invokers . add ( new MockInvoker < String > ( URL . valueOf ( "" dubbo : / / "" + NetUtils . getLocalHost ( ) + "" : 20880 / com . foo . BarService "" ) ) ) ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - if ( value ! = null & & ClassHelper . isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n + if ( StringUtils . isNotEmpty ( value ) & & ClassHelper . isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n",remove package import used by comment to pass travis,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ ListenableRouter . java \n - import org . apache . dubbo . common . utils . Assert ; \n + import org . apache . dubbo . common . utils . StringUtils ; \n - Assert . notEmptyString ( ruleKey , "" router rule ' s key cannot be null "" ) ; \n - String router = ruleKey + Constants . ROUTERS _ SUFFIX ; \n - configuration . addListener ( router , this ) ; \n - String rule = configuration . getConfig ( router ) ; \n + if ( StringUtils . isEmpty ( ruleKey ) ) { \n + return ; \n + } \n + String routerKey = ruleKey + Constants . ROUTERS _ SUFFIX ; \n + configuration . addListener ( routerKey , this ) ; \n + String rule = configuration . getConfig ( routerKey ) ; \n - this . process ( new ConfigChangeEvent ( router , rule ) ) ; \n + this . process ( new ConfigChangeEvent ( routerKey , rule ) ) ; \n",Remove assert check to continue with execute .,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ async \ support \ AsyncFor . java \n - * If an interface is annotated with AsyncFor , it will be treated as an async counterpart for the sync one . \n + * If a method is annotated with AsyncFor , it will be treated as an async counterpart for the sync specified in value . \n - @ Target ( { ElementType . TYPE , ElementType . ANNOTATION _ TYPE } ) \n + @ Target ( { ElementType . METHOD } ) \n",change @ AsyncFor annotation from TYPE to METHOD,634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ AsyncRpcResult . java \n + / * * \n + * CompletableFuture can only be completed once , so try to update the result of one completed CompletableFuture will \n + * has no effect . To avoid this problem , we check the complete status of this future before update it ' s value . \n + * \n + * But notice that trying to give an uncompleted CompletableFuture a new specified value may face a race condition , \n + * because the background thread watching the real result will also change the status of this CompletableFuture . \n + * The result is you may lose the value you expected to set . \n + * \n + * @ param value \n + * / \n - AppResponse appResponse = new AppResponse ( ) ; \n - appResponse . setValue ( value ) ; \n - this . complete ( appResponse ) ; \n + try { \n + if ( this . isDone ( ) ) { \n + this . get ( ) . setValue ( value ) ; \n + } else { \n + AppResponse appResponse = new AppResponse ( ) ; \n + appResponse . setValue ( value ) ; \n + this . complete ( appResponse ) ; \n + } \n + } catch ( Exception e ) { \n + / / This should never happen ; \n + logger . error ( "" Got exception when trying to change the value of the underlying result from AsyncRpcResult . "" , e ) ; \n + } \n - AppResponse appResponse = new AppResponse ( ) ; \n - appResponse . setException ( t ) ; \n - this . complete ( appResponse ) ; \n + try { \n + if ( this . isDone ( ) ) { \n + this . get ( ) . setException ( t ) ; \n + } else { \n + AppResponse appResponse = new AppResponse ( ) ; \n + appResponse . setException ( t ) ; \n + this . complete ( appResponse ) ; \n + } \n + } catch ( Exception e ) { \n + / / This should never happen ; \n + logger . error ( "" Got exception when trying to change the value of the underlying result from AsyncRpcResult . "" , e ) ; \n + } \n",check complete status of async - result before try to update ( # 4394 ) \n # 4394,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ tag \ TagRouter . java \n - return invokers ; \n + return filterUsingStaticTag ( invokers , url , invocation ) ; \n - if ( CollectionUtils . isNotEmpty ( result ) | | isForceUse ( invocation ) ) { \n + if ( CollectionUtils . isNotEmpty ( result ) | | isForceUseTag ( invocation ) ) { \n + / * * \n + * If there ' s no dynamic tag rule being set , use static tag in URL . \n + * \n + * A typical scenario is a Consumer using version 2 . 7 . x calls Providers using version 2 . 6 . x or lower , \n + * the Consumer should always respect the tag in provider URL regardless of whether a dynamic tag rule has been set to it or not . \n + * \n + * TODO , to guarantee consistent behavior of interoperability between 2 . 6 - and 2 . 7 + , this method should has the same logic with the TagRouter in 2 . 6 . x . \n + * \n + * @ param invokers \n + * @ param url \n + * @ param invocation \n + * @ param < T > \n + * @ return \n + * / \n + private < T > List < Invoker < T > > filterUsingStaticTag ( List < Invoker < T > > invokers , URL url , Invocation invocation ) { \n + List < Invoker < T > > result = invokers ; \n + / / Dynamic param \n + String tag = StringUtils . isEmpty ( invocation . getAttachment ( TAG _ KEY ) ) ? url . getParameter ( TAG _ KEY ) : \n + invocation . getAttachment ( TAG _ KEY ) ; \n + / / Tag request \n + if ( ! StringUtils . isEmpty ( tag ) ) { \n + result = filterInvoker ( invokers , invoker - > tag . equals ( invoker . getUrl ( ) . getParameter ( Constants . TAG _ KEY ) ) ) ; \n + if ( CollectionUtils . isEmpty ( result ) & & ! isForceUseTag ( invocation ) ) { \n + result = filterInvoker ( invokers , invoker - > StringUtils . isEmpty ( invoker . getUrl ( ) . getParameter ( Constants . TAG _ KEY ) ) ) ; \n + } \n + } else { \n + result = filterInvoker ( invokers , invoker - > StringUtils . isEmpty ( invoker . getUrl ( ) . getParameter ( Constants . TAG _ KEY ) ) ) ; \n + } \n + return result ; \n + } \n + \n - private boolean isForceUse ( Invocation invocation ) { \n + private boolean isForceUseTag ( Invocation invocation ) { \n",[ Dubbo - 3231 ] keep TagRouter consistent with 2 . 6 . x ( # 3233 ) \n * keep TagRouter consistent with 2 . 6 . x \n * refactor filterUsingStaticTag using lambda in tagRouter,634
"dubbo - compatible \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ Protocol . java \n + import com . alibaba . dubbo . common . URL ; \n + \n + \n + < T > Exporter < T > export ( Invoker < T > invoker ) throws RpcException ; \n + \n + < T > Invoker < T > refer ( Class < T > aClass , URL url ) throws RpcException ; \n + \n + default < T > org . apache . dubbo . rpc . Exporter < T > export ( org . apache . dubbo . rpc . Invoker < T > invoker ) throws RpcException { \n + return this . export ( new Invoker . CompatibleInvoker < > ( invoker ) ) ; \n + } \n + \n + default < T > org . apache . dubbo . rpc . Invoker < T > refer ( Class < T > aClass , org . apache . dubbo . common . URL url ) throws RpcException { \n + return this . refer ( aClass , new URL ( url ) ) ; \n + } \n",Protocol compatibility ( # 3254 ) \n add default method into Protocol .,634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ RegistryDirectory . java \n - if ( invokerUrls . size ( ) = = 1 & & invokerUrls . get ( 0 ) ! = null & & Constants . EMPTY _ PROTOCOL . equals ( invokerUrls \n - . get ( 0 ) \n - . getProtocol ( ) ) ) { \n + if ( invokerUrls . size ( ) = = 1 \n + & & invokerUrls . get ( 0 ) ! = null \n + & & Constants . EMPTY _ PROTOCOL . equals ( invokerUrls . get ( 0 ) . getProtocol ( ) ) ) { \n - / / state change \n - / / If the calculation is wrong , it is not processed . \n + / * * \n + * If the calculation is wrong , it is not processed . \n + * \n + * 1 . The protocol configured by the client is inconsistent with the protocol of the server . \n + * eg : consumer protocol = dubbo , provider only has other protocol services ( rest ) . \n + * 2 . The registration center is not robust and pushes illegal specification data . \n + * \n + * / \n","Add comments , manually merge # 3181 .",634
"dubbo - rpc \ dubbo - rpc - thrift \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ thrift \ ThriftCodec . java \n + String path ; \n + path = protocol . readString ( ) ; \n + result . setAttachment ( Constants . PATH _ KEY , path ) ; \n + / / path \n + protocol . writeString ( inv . getAttachment ( Constants . PATH _ KEY ) ) ; \n dubbo - rpc \ dubbo - rpc - thrift \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ thrift \ ThriftProtocol . java \n - String serviceName = inv . getAttachments ( ) . get ( Constants . INTERFACE _ KEY ) ; \n + String path = inv . getAttachments ( ) . get ( Constants . PATH _ KEY ) ; \n - serviceName , null , null ) ; \n + path , null , null ) ; \n dubbo - rpc \ dubbo - rpc - thrift \ src \ test \ java \ org \ apache \ dubbo \ rpc \ protocol \ thrift \ ThriftCodecTest . java \n + / / path \n + Assertions . assertEquals ( Demo . Iface . class . getName ( ) , protocol . readString ( ) ) ; \n + / / path \n + protocol . writeString ( Demo . Iface . class . getName ( ) ) ; \n + / / path \n + protocol . writeString ( Demo . class . getName ( ) ) ; \n + protocol . writeString ( \n + ( ( RpcInvocation ) request . getData ( ) ) \n + . getAttachment ( Constants . PATH _ KEY ) ) ; \n + invocation . setAttachment ( Constants . PATH _ KEY , Demo . Iface . class . getName ( ) ) ; \n","Fix thrift protocol , use path to locate exporter . ( # 3331 ) \n * Fix thrift protocol , use path to locate exporter . \n * Fix UT",634
dubbo - dependencies - bom \ pom . xml \n - < version > 19 < / version > \n + < version > 21 < / version > \n,"A follow up of 6058846 , update apache pom version to 21",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ NetUtils . java \n + import static org . apache . dubbo . common . constants . CommonConstants . DUBBO _ IP _ TO _ BIND ; \n - import static org . apache . dubbo . common . constants . CommonConstants . DUBBO _ IP _ TO _ BIND ; \n + private static volatile String HOST _ ADDRESS ; \n + \n + public static String getHostAddress ( ) { \n + if ( HOST _ ADDRESS ! = null ) { \n + return HOST _ ADDRESS ; \n + } \n + \n + HOST _ ADDRESS = getLocalHost ( ) ; \n + return HOST _ ADDRESS ; \n + } \n + \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ ConsumerContextFilter . java \n - . setLocalAddress ( NetUtils . getLocalHost ( ) , 0 ) \n + . setLocalAddress ( NetUtils . getHostAddress ( ) , 0 ) \n",performance tuning : avoid address resolve ( # 4220 ),634
"dubbo - remoting \ dubbo - remoting - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ remoting \ zookeeper \ curator \ CuratorZookeeperClient . java \n - if ( logger . isInfoEnabled ( ) ) { \n - logger . info ( "" listen the zookeeper changed . The changed data : "" + event . getData ( ) ) ; \n + if ( logger . isDebugEnabled ( ) ) { \n + logger . debug ( "" listen the zookeeper changed . The changed data : "" + event . getData ( ) ) ; \n","fixes # 4345 , change zookeeper notification log level from info to debug",634
dubbo - all \ pom . xml \n + < dependency > \n + < groupId > org . yaml < / groupId > \n + < artifactId > snakeyaml < / artifactId > \n + < / dependency > \n,"make snakeyaml transitive , governance rule relies on this dependency to work . ( # 3659 )",634
dubbo - all \ pom . xml \n + < dependency > \n + < groupId > org . yaml < / groupId > \n + < artifactId > snakeyaml < / artifactId > \n + < / dependency > \n,"make snakeyaml transitive , governance rule relies on this dependency to work . ( # 3659 )",634
"dubbo - rpc \ dubbo - rpc - rest \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ rest \ RestProtocol . java \n - if ( contextPath . equalsIgnoreCase ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + if ( contextPath ! = null ) { \n + if ( contextPath . equalsIgnoreCase ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + return "" "" ; \n + } \n + if ( contextPath . endsWith ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + contextPath = contextPath . substring ( 0 , contextPath . lastIndexOf ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) ; \n + } \n + return contextPath . endsWith ( "" / "" ) ? contextPath . substring ( 0 , contextPath . length ( ) - 1 ) : contextPath ; \n + } else { \n - if ( contextPath . endsWith ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n - contextPath = contextPath . substring ( 0 , contextPath . lastIndexOf ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) ; \n - } \n - return contextPath . endsWith ( "" / "" ) ? contextPath . substring ( 0 , contextPath . length ( ) - 1 ) : contextPath ; \n",check null for path before call rest server ( # 3665 ),634
"dubbo - rpc \ dubbo - rpc - rest \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ rest \ RestProtocol . java \n - if ( contextPath . equalsIgnoreCase ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + if ( contextPath ! = null ) { \n + if ( contextPath . equalsIgnoreCase ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + return "" "" ; \n + } \n + if ( contextPath . endsWith ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n + contextPath = contextPath . substring ( 0 , contextPath . lastIndexOf ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) ; \n + } \n + return contextPath . endsWith ( "" / "" ) ? contextPath . substring ( 0 , contextPath . length ( ) - 1 ) : contextPath ; \n + } else { \n - if ( contextPath . endsWith ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) { \n - contextPath = contextPath . substring ( 0 , contextPath . lastIndexOf ( url . getParameter ( Constants . INTERFACE _ KEY ) ) ) ; \n - } \n - return contextPath . endsWith ( "" / "" ) ? contextPath . substring ( 0 , contextPath . length ( ) - 1 ) : contextPath ; \n",check null for path before call rest server ( # 3665 ),634
dubbo - rpc \ dubbo - rpc - rsocket \ pom . xml \n - < version > 2 . 7 . 0 - SNAPSHOT < / version > \n + < version > 2 . 7 . 1 - SNAPSHOT < / version > \n,change rsocket parent module version to 2 . 7 . 1 - SNAPSHOT,634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ exchange \ support \ header \ AbstractTimerTask . java \n - return ( Long ) channel . getAttribute ( HeaderExchangeHandler . KEY _ READ _ TIMESTAMP ) ; \n + return ( Long ) channel . getAttribute ( HeartbeatHandler . KEY _ READ _ TIMESTAMP ) ; \n - return ( Long ) channel . getAttribute ( HeaderExchangeHandler . KEY _ WRITE _ TIMESTAMP ) ; \n + return ( Long ) channel . getAttribute ( HeartbeatHandler . KEY _ WRITE _ TIMESTAMP ) ; \n dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ exchange \ support \ header \ HeaderExchangeHandler . java \n - public static final String KEY _ READ _ TIMESTAMP = HeartbeatHandler . KEY _ READ _ TIMESTAMP ; \n - \n - public static final String KEY _ WRITE _ TIMESTAMP = HeartbeatHandler . KEY _ WRITE _ TIMESTAMP ; \n - \n - channel . setAttribute ( KEY _ READ _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n - channel . setAttribute ( KEY _ WRITE _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n - channel . setAttribute ( KEY _ READ _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n - channel . setAttribute ( KEY _ WRITE _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n - channel . setAttribute ( KEY _ WRITE _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n - channel . setAttribute ( KEY _ READ _ TIMESTAMP , System . currentTimeMillis ( ) ) ; \n",Performance tuning : keep heartbeat updated in io thread to avoid race condition . ( # 4246 ),634
dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ GenericFilter . java \n + rpcInvocation . setInvoker ( inv . getInvoker ( ) ) ; \n,copy invoker to new invocation in generic filter,634
"dubbo - configcenter \ dubbo - configcenter - apollo \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ apollo \ ApolloDynamicConfiguration . java \n + / / Apollo does not allow namespace ends with ' . properties ' , ' . yaml ' , . . . \n + if ( key . endsWith ( "" . properties "" ) ) { \n + key = key . replace ( "" . properties "" , "" - properties "" ) ; \n + } \n",replace namespace suffix ' . properties ' with ' - properties ',634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ context \ ConfigManager . java \n - throw new IllegalStateException ( "" The expected single matching "" + configType + "" but found "" + size + "" instances "" ) ; \n - } else { \n - return configsMap . values ( ) . iterator ( ) . next ( ) ; \n + logger . warn ( "" Expected single matching of "" + configType + "" , but found "" + size + "" instances , will randomly pick the first one . "" ) ; \n + \n + return configsMap . values ( ) . iterator ( ) . next ( ) ; \n",log warn msg for duplicate global configs ( # 5419 ),634
. gitignore \n + \n + # flatten ignore \n + . flattened - pom . xml \n,Ignore flatten related files . ( # 3885 ),634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n + \n + @ Parameter ( excluded = true ) \n + public String getUniqueServiceName ( ) { \n + return URL . buildKey ( interfaceName , group , version ) ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + \n + @ Parameter ( excluded = true ) \n + public String getUniqueServiceName ( ) { \n + return URL . buildKey ( interfaceName , group , version ) ; \n + } \n",Add ' getUniqueServiceKey ' to keep backward compatibility .,634
"dubbo - remoting \ dubbo - remoting - http \ src \ main \ java \ org \ apache \ dubbo \ remoting \ http \ tomcat \ TomcatHttpServer . java \n + / / tell tomcat to fail on startup failures . \n + System . setProperty ( "" org . apache . catalina . startup . EXIT _ ON _ INIT _ FAILURE "" , "" true "" ) ; \n + \n","Fixes # 3367 , fail to parse config text with white space ( # 3589 )",634
"CHANGES . md \n - - Support Zipkin tracing feature provided by Zipkin officially , # 3728 . \n + - Support Zipkin tracing feature provided by Zipkin officially , # 3728 , # 4471 . \n - DubboComponentScan supports simultaneous scanning of annotations under the ` com . alibaba . * ` and ` org . apache . * ` packages , # 4330 . \n - - 统一异步和同步的回调流程，异常场景触发onError回调 https : / / github . com / apache / dubbo / pull / 4401 \n - - CompletableFuture . get ( ) 在JDK1 . 8环境下带来的性能下降问题 https : / / github . com / apache / dubbo / pull / 4279 \n + - 统一异步和同步的回调流程，异常场景触发onError回调 # 4401 \n + - CompletableFuture . get ( ) 在JDK1 . 8环境下带来的性能下降问题 # 4279 \n - - ConfigCenter自定义namespace不生效的问题 https : / / github . com / apache / dubbo / pull / 4411 \n - - 统一Zookeeper、Nacos、Etcd等几个配置中心实现的模型，可能带来的不兼容性问题请参见说明。相关修改：https : / / github . com / apache / dubbo / pull / 4388 \n - - 调整Override覆盖规则中心优先级：服务级别 > 应用级别 https : / / github . com / apache / dubbo / issues / 4175 \n + - ConfigCenter自定义namespace不生效的问题 # 4411 \n + - 统一Zookeeper、Nacos、Etcd等几个配置中心实现的模型，可能带来的不兼容性问题请参见说明。相关修改： # 4388 \n + - 调整Override覆盖规则中心优先级：服务级别 > 应用级别 # 4175 \n - - 兼容zipkin官方提供的基于Dubbo - 2 . 6 API的集成 https : / / github . com / apache / dubbo / issues / 3728 \n - - DubboComponentScan支持同时扫描com . alibaba . * 和org . apache . * 两个包下的注解 https : / / github . com / apache / dubbo / issues / 4330 \n + - 兼容zipkin官方提供的基于Dubbo - 2 . 6 API的集成 # 3728 , # 4471 \n + - DubboComponentScan支持同时扫描 ` com . alibaba . * ` 和 ` org . apache . * ` 两个包下的注解 # 4330 \n - 4 . Nacos注册中心只订阅地址列表，不再订阅配置信息 https : / / github . com / apache / dubbo / pull / 4454 \n + 4 . Nacos注册中心只订阅地址列表，不再订阅配置信息 # 4454 \n",polish 2 . 7 . 3 change list,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n - AbstractConfig . appendParameters ( map , metrics ) ; \n - AbstractConfig . appendParameters ( map , application ) ; \n - AbstractConfig . appendParameters ( map , module ) ; \n + AbstractConfig . appendParameters ( map , getMetrics ( ) ) ; \n + AbstractConfig . appendParameters ( map , getApplication ( ) ) ; \n + AbstractConfig . appendParameters ( map , getModule ( ) ) ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n - AbstractConfig . appendParameters ( map , metrics ) ; \n - AbstractConfig . appendParameters ( map , application ) ; \n - AbstractConfig . appendParameters ( map , module ) ; \n + AbstractConfig . appendParameters ( map , getMetrics ( ) ) ; \n + AbstractConfig . appendParameters ( map , getApplication ( ) ) ; \n + AbstractConfig . appendParameters ( map , getModule ( ) ) ; \n dubbo - config \ dubbo - config - api \ src \ test \ java \ org \ apache \ dubbo \ config \ ServiceConfigTest . java \n + \n + @ Test \n + public void testApplicationInUrl ( ) { \n + service . export ( ) ; \n + Assertions . assertNotNull ( service . toUrl ( ) . getParameter ( APPLICATION _ KEY ) ) ; \n + Assertions . assertEquals ( "" app "" , service . toUrl ( ) . getParameter ( APPLICATION _ KEY ) ) ; \n + } \n dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ ServiceBean . java \n + import org . apache . dubbo . config . support . Parameter ; \n + @ Parameter ( excluded = true ) \n",Fix config append lost ApplicationConfig ( # 5434 ),634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ integration \ AbstractConfiguratorListener . java \n - process ( new ConfigChangeEvent ( key , rawConfig ) ) ; \n + genConfiguratorsFromRawRule ( rawConfig ) ; \n - try { \n - / / parseConfigurators will recognize app / service config automatically . \n - configurators = Configurator . toConfigurators ( ConfigParser . parseConfigurators ( event . getValue ( ) ) ) \n - . orElse ( configurators ) ; \n - } catch ( Exception e ) { \n - logger . error ( "" Failed to parse raw dynamic config and it will not take effect , the raw config is : "" + \n - event . getValue ( ) , e ) ; \n + if ( ! genConfiguratorsFromRawRule ( event . getValue ( ) ) ) { \n + private boolean genConfiguratorsFromRawRule ( String rawConfig ) { \n + boolean parseSuccess = true ; \n + try { \n + / / parseConfigurators will recognize app / service config automatically . \n + configurators = Configurator . toConfigurators ( ConfigParser . parseConfigurators ( rawConfig ) ) \n + . orElse ( configurators ) ; \n + } catch ( Exception e ) { \n + logger . error ( "" Failed to parse raw dynamic config and it will not take effect , the raw config is : "" + \n + rawConfig , e ) ; \n + parseSuccess = false ; \n + } \n + return parseSuccess ; \n + } \n + \n","[ Dubbo - 3669 ] Only parse rules on init , does not override . ( # 3685 )",634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ exchange \ support \ DefaultFuture . java \n + private static final Map < Long , Timeout > PENDING _ TASKS = new ConcurrentHashMap < > ( ) ; \n + \n + Timeout t = PENDING _ TASKS . remove ( future . getId ( ) ) ; \n + if ( t ! = null ) { \n + / / decrease Time \n + t . cancel ( ) ; \n + } \n + ( new SimpleDateFormat ( "" yyyy - MM - dd HH : mm : ss . SSS "" ) . format ( new Date ( ) ) ) \n - TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n + Timeout t = TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n + PENDING _ TASKS . put ( future . getId ( ) , t ) ; \n - \n - if ( future = = null | | future . isDone ( ) ) { \n + / / remove from pending task \n + PENDING _ TASKS . remove ( future . getId ( ) ) ; \n + \n + if ( future . isDone ( ) ) { \n",Shorten the life cycle of Timeout to get a better gc effect ( # 4081 ),634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ exchange \ support \ DefaultFuture . java \n - / / private static final Map < Long , Timeout > PENDING _ TASKS = new ConcurrentHashMap < > ( ) ; \n - \n + private Timeout timeoutCheckTask ; \n + / * * \n + * check time out of the future \n + * / \n + private static void timeoutCheck ( DefaultFuture future ) { \n + TimeoutCheckTask task = new TimeoutCheckTask ( future . getId ( ) ) ; \n + future . timeoutCheckTask = TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n + } \n + \n + received ( channel , response , false ) ; \n + } \n + \n + public static void received ( Channel channel , Response response , boolean timeout ) { \n + Timeout t = future . timeoutCheckTask ; \n + if ( ! timeout ) { \n + / / decrease Time \n + t . cancel ( ) ; \n + } \n - / / Timeout t = PENDING _ TASKS . remove ( future . getId ( ) ) ; \n - / / if ( t ! = null ) { \n - / / / / decrease Time \n - / / t . cancel ( ) ; \n - / / } \n + ( new SimpleDateFormat ( "" yyyy - MM - dd HH : mm : ss . SSS "" ) . format ( new Date ( ) ) ) \n + \n - / * * \n - * check time out of the future \n - * / \n - private static void timeoutCheck ( DefaultFuture future ) { \n - TimeoutCheckTask task = new TimeoutCheckTask ( future . getId ( ) ) ; \n - TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n - / / PENDING _ TASKS . put ( future . getId ( ) , t ) ; \n - } \n - \n - / / remove from pending task \n - / / PENDING _ TASKS . remove ( future . getId ( ) ) ; \n - \n - DefaultFuture future = FUTURES . remove ( requestID ) ; \n + DefaultFuture future = DefaultFuture . getFuture ( requestID ) ; \n - DefaultFuture . received ( future . getChannel ( ) , timeoutResponse ) ; \n + DefaultFuture . received ( future . getChannel ( ) , timeoutResponse , true ) ; \n",optimze TimeTask in DefaultFuture ( # 4132 ) \n optimze TimeTask in DefaultFuture,634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ exchange \ support \ DefaultFuture . java \n - private static final Map < Long , Timeout > PENDING _ TASKS = new ConcurrentHashMap < > ( ) ; \n - \n - private final long id ; \n + private final Long id ; \n + private Timeout timeoutCheckTask ; \n - TimeoutCheckTask task = new TimeoutCheckTask ( future ) ; \n - Timeout t = TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n - PENDING _ TASKS . put ( future . getId ( ) , t ) ; \n + TimeoutCheckTask task = new TimeoutCheckTask ( future . getId ( ) ) ; \n + future . timeoutCheckTask = TIME _ OUT _ TIMER . newTimeout ( task , future . getTimeout ( ) , TimeUnit . MILLISECONDS ) ; \n + received ( channel , response , false ) ; \n + } \n + \n + public static void received ( Channel channel , Response response , boolean timeout ) { \n - future . doReceived ( response ) ; \n - Timeout t = PENDING _ TASKS . remove ( future . getId ( ) ) ; \n - if ( t ! = null ) { \n + Timeout t = future . timeoutCheckTask ; \n + if ( ! timeout ) { \n + future . doReceived ( response ) ; \n + ( new SimpleDateFormat ( "" yyyy - MM - dd HH : mm : ss . SSS "" ) . format ( new Date ( ) ) ) \n - private DefaultFuture future ; \n + private final Long requestID ; \n - TimeoutCheckTask ( DefaultFuture future ) { \n - this . future = future ; \n + TimeoutCheckTask ( Long requestID ) { \n + this . requestID = requestID ; \n + DefaultFuture future = DefaultFuture . getFuture ( requestID ) ; \n - DefaultFuture . received ( future . getChannel ( ) , timeoutResponse ) ; \n + DefaultFuture . received ( future . getChannel ( ) , timeoutResponse , true ) ; \n","Performance tuning for TimeoutTask in DefaultFuture ( # 4129 ) \n Performance tuning for TimeoutTask in DefaultFuture , manually merge # 4085 and # 4087",634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ AppResponse . java \n + import java . lang . reflect . Field ; \n + / / fix issue # 619 \n + try { \n + / / get Throwable class \n + Class clazz = exception . getClass ( ) ; \n + while ( ! clazz . getName ( ) . equals ( Throwable . class . getName ( ) ) ) { \n + clazz = clazz . getSuperclass ( ) ; \n + } \n + / / get stackTrace value \n + Field stackTraceField = clazz . getDeclaredField ( "" stackTrace "" ) ; \n + stackTraceField . setAccessible ( true ) ; \n + Object stackTrace = stackTraceField . get ( exception ) ; \n + if ( stackTrace = = null ) { \n + exception . setStackTrace ( new StackTraceElement [ 0 ] ) ; \n + } \n + } catch ( Exception e ) { \n + / / ignore \n + } \n",add miss - deleted snippet from # 2956 ( # 4137 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ constants \ ConfigConstants . java \n - String QOS _ ENABLE = "" qos . enable "" ; \n + String QOS _ ENABLE = "" qos - enable "" ; \n - String QOS _ PORT = "" qos . port "" ; \n + String QOS _ PORT = "" qos - port "" ; \n - String ACCEPT _ FOREIGN _ IP = "" qos . accept . foreign . ip "" ; \n + String ACCEPT _ FOREIGN _ IP = "" qos - accept - foreign - ip "" ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ApplicationConfig . java \n + import static org . apache . dubbo . common . constants . ConfigConstants . QOS _ ENABLE ; \n + import static org . apache . dubbo . common . constants . ConfigConstants . QOS _ PORT ; \n + import static org . apache . dubbo . common . constants . ConfigConstants . SHUTDOWN _ WAIT _ KEY ; \n - import static org . apache . dubbo . common . constants . ConfigConstants . QOS _ ENABLE ; \n - import static org . apache . dubbo . common . constants . ConfigConstants . QOS _ PORT ; \n - import static org . apache . dubbo . common . constants . ConfigConstants . SHUTDOWN _ WAIT _ KEY ; \n + @ Deprecated \n + @ Parameter ( key = "" qos . enable "" , excluded = true ) \n + public Boolean getQosEnableDeprecated ( ) { \n + return getQosEnable ( ) ; \n + } \n + \n + @ Deprecated \n + public void setQosEnableDeprecated ( Boolean qosEnable ) { \n + setQosEnable ( qosEnable ) ; \n + } \n + \n + @ Deprecated \n + @ Parameter ( key = "" qos . port "" , excluded = true ) \n + public Integer getQosPortDeprecated ( ) { \n + return getQosPort ( ) ; \n + } \n + \n + @ Deprecated \n + public void setQosPortDeprecated ( Integer qosPort ) { \n + this . setQosPort ( qosPort ) ; \n + } \n + \n + @ Deprecated \n + @ Parameter ( key = "" qos . accept . foreign . ip "" , excluded = true ) \n + public Boolean getQosAcceptForeignIpDeprecated ( ) { \n + return this . getQosAcceptForeignIp ( ) ; \n + } \n + \n + @ Deprecated \n + public void setQosAcceptForeignIpDeprecated ( Boolean qosAcceptForeignIp ) { \n + this . setQosAcceptForeignIp ( qosAcceptForeignIp ) ; \n + } \n + \n",unify config config items : qos . enable to qos - enable . ( # 4095 ) \n unify config config items : qos . enable to qos - enable . ( # 4095 ),634
dubbo - rpc \ dubbo - rpc - api \ src \ main \ resources \ META - INF \ dubbo \ internal \ org . apache . dubbo . rpc . Filter \n - timeout = org . apache . dubbo . rpc . filter . TimeoutFilter \n - callback - registration = org . apache . dubbo . rpc . filter . CallbackRegistrationFilter \n + timeout = org . apache . dubbo . rpc . filter . TimeoutFilter \n,delete useless SPI declare ( # 4148 ),634
"dubbo - cluster \ src \ test \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ ConditionRouterTest . java \n + System . err . println ( "" The localhost address : "" + invoker2 . getUrl ( ) . getAddress ( ) ) ; \n + System . err . println ( invoker3 . getUrl ( ) . getAddress ( ) ) ; \n + \n + \n + \n dubbo - registry \ dubbo - registry - nacos \ pom . xml \n + < dependency > \n + < groupId > javax . annotation < / groupId > \n + < artifactId > javax . annotation - api < / artifactId > \n + < version > 1 . 3 . 1 < / version > \n + < / dependency > \n + \n",Solve compile problem in java11 ( # 4172 ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ AsyncToSyncInvoker . java \n + import java . util . concurrent . TimeUnit ; \n + \n + import static org . apache . dubbo . common . constants . CommonConstants . DEFAULT _ TIMEOUT ; \n + import static org . apache . dubbo . common . constants . CommonConstants . TIMEOUT _ KEY ; \n - asyncResult . get ( ) ; \n + asyncResult . get ( getUrl ( ) . getParameter ( TIMEOUT _ KEY , DEFAULT _ TIMEOUT ) , TimeUnit . MILLISECONDS ) ; \n",Observation of performance degradation when running under JDK 8 ( # 4381 ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ AsyncRpcResult . java \n - this . whenComplete ( ( v , t ) - > { \n + CompletableFuture < Result > future = this . whenComplete ( ( v , t ) - > { \n - / / You may need to return a new Result instance representing the next async stage , \n - / / like thenApply will return a new CompletableFuture . \n - return this ; \n + \n + AsyncRpcResult nextStage = new AsyncRpcResult ( this ) ; \n + nextStage . subscribeTo ( future ) ; \n + return nextStage ; \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ ProtocolFilterWrapper . java \n - asyncResult . whenCompleteWithContext ( ( r , t ) - > { \n + asyncResult = asyncResult . whenCompleteWithContext ( ( r , t ) - > { \n - try { \n - if ( t = = null ) { \n - listener . onResponse ( r , filterInvoker , invocation ) ; \n - } else { \n - listener . onError ( t , filterInvoker , invocation ) ; \n - } \n - } catch ( Throwable filterError ) { \n - t = filterError ; \n + if ( t = = null ) { \n + listener . onResponse ( r , filterInvoker , invocation ) ; \n + } else { \n + listener . onError ( t , filterInvoker , invocation ) ; \n - try { \n - filter . onResponse ( r , filterInvoker , invocation ) ; \n - } catch ( Throwable filterError ) { \n - t = filterError ; \n - } \n + filter . onResponse ( r , filterInvoker , invocation ) ; \n - \n",support handle of exception from onResponse or onError ( # 4401 ) \n fix # 4401,634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractInterfaceConfig . java \n + if ( application = = null ) { \n + return ; \n + } \n + if ( module = = null ) { \n + return ; \n + } \n + if ( registries = = null ) { \n + return ; \n + } \n + if ( monitor = = null ) { \n + return ; \n + } \n + if ( configCenter = = null ) { \n + return ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractServiceConfig . java \n + if ( protocols = = null ) { \n + return ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n + if ( consumer = = null ) { \n + return ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + if ( provider = = null ) { \n + return ; \n + } \n,add empty check at the start of setter .,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ Version . java \n + / / version 1 . 0 . 0 represents Dubbo rpc protocol before v2 . 6 . 2 \n + public static final int LEGACY _ DUBBO _ PROTOCOL _ VERSION = 10000 ; / / 1 . 0 . 0 \n - v = parseInt ( version ) ; \n - / / e . g . , version number 2 . 6 . 3 will convert to 2060300 \n - if ( version . split ( "" \ \ . "" ) . length = = 3 ) { \n - v = v * 100 ; \n + try { \n + v = parseInt ( version ) ; \n + / / e . g . , version number 2 . 6 . 3 will convert to 2060300 \n + if ( version . split ( "" \ \ . "" ) . length = = 3 ) { \n + v = v * 100 ; \n + } \n + } catch ( Exception e ) { \n + logger . warn ( "" Please make sure your version value has the right format : "" + \n + "" \ n 1 . only contains digital number : 2 . 0 . 0 ; \ n 2 . with string suffix : 2 . 6 . 7 - stable . "" + \n + "" \ nIf you are using Dubbo before v2 . 6 . 2 , the version value is the same with the jar version . "" ) ; \n + v = LEGACY _ DUBBO _ PROTOCOL _ VERSION ; \n dubbo - common \ src \ test \ java \ org \ apache \ dubbo \ common \ version \ VersionTest . java \n + Assertions . assertFalse ( Version . isSupportResponseAttachment ( "" 1 . 0 . 0 "" ) ) ; \n + Assertions . assertTrue ( Version . isSupportResponseAttachment ( "" 2 . 6 . 6 - stable "" ) ) ; \n + \n + Assertions . assertFalse ( Version . isSupportResponseAttachment ( "" 2 . 0 . contains "" ) ) ; \n + Assertions . assertFalse ( Version . isSupportResponseAttachment ( "" version . string "" ) ) ; \n + Assertions . assertFalse ( Version . isSupportResponseAttachment ( "" prefix2 . 0 "" ) ) ; \n","Make code strong , version check compatibility . Fix https : / / github . com / apache / dubbo / pull / 4488 ( # 4490 )",634
README . md \n - < dubbo . version > 2 . 7 . 2 < / dubbo . version > \n + < dubbo . version > 2 . 7 . 3 < / dubbo . version > \n,update default dependency to the latest version .,634
"dubbo - serialization \ dubbo - serialization - protobuf - json \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ protobuf \ support \ GenericProtobufObjectInput . java \n - import com . google . common . base . Charsets ; \n + import org . apache . dubbo . common . serialize . ObjectInput ; \n + \n + import com . google . protobuf . BytesValue ; \n - import org . apache . dubbo . common . serialize . ObjectInput ; \n - return readUTF ( ) . getBytes ( Charsets . ISO _ 8859 _ 1 ) ; \n + return read ( BytesValue . class ) . getValue ( ) . toByteArray ( ) ; \n dubbo - serialization \ dubbo - serialization - protobuf - json \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ protobuf \ support \ GenericProtobufObjectOutput . java \n - import com . google . common . base . Charsets ; \n + import org . apache . dubbo . common . serialize . ObjectOutput ; \n + \n + import com . google . protobuf . ByteString ; \n + import com . google . protobuf . BytesValue ; \n - import org . apache . dubbo . common . serialize . ObjectOutput ; \n - writeUTF ( new String ( b , Charsets . ISO _ 8859 _ 1 ) ) ; \n + writeObject ( BytesValue . newBuilder ( ) . setValue ( ByteString . copyFrom ( b ) ) . build ( ) ) ; \n - writeUTF ( new String ( b , off , len , Charsets . ISO _ 8859 _ 1 ) ) ; \n + writeObject ( BytesValue . newBuilder ( ) . setValue ( ByteString . copyFrom ( b , off , len ) ) . build ( ) ) ; \n",use standard protobuf json format to write byte [ ] ( # 4638 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ IOUtils . java \n + public static final int EOF = - 1 ; \n - int read ; \n - long total = 0 ; \n - while ( is . available ( ) > 0 ) { \n - read = is . read ( buff , 0 , buff . length ) ; \n - if ( read > 0 ) { \n - os . write ( buff , 0 , read ) ; \n - total + = read ; \n - } \n + return write ( is , os , buff ) ; \n + } \n + \n + public static long write ( final InputStream input , final OutputStream output , final byte [ ] buffer ) throws IOException { \n + long count = 0 ; \n + int n ; \n + while ( EOF ! = ( n = input . read ( buffer ) ) ) { \n + output . write ( buffer , 0 , n ) ; \n + count + = n ; \n - return total ; \n + return count ; \n - char [ ] buf = new char [ BUFFER _ SIZE ] ; \n + char [ ] buf = new char [ bufferSize ] ; \n",[ Dubbo - 3420 ] check EOF of inputstream in IOUtils . write ( # 4648 ) \n * check EOF of inputstream in IOUtils . write \n * fix wrong variable reference,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ AppRouter . java \n - * Application level router , "" application . routers "" \n + * Application level router , "" application . routers . condition "" \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ ListenableRouter . java \n - import org . apache . dubbo . common . Constants ; \n + private static final String RULE _ SUFFIX = "" . routers . condition "" ; \n - String routerKey = ruleKey + Constants . ROUTERS _ SUFFIX ; \n + String routerKey = ruleKey + RULE _ SUFFIX ; \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ condition \ config \ ServiceRouter . java \n - * Service level router , "" server - uniq - name . routers "" \n + * Service level router , "" server - unique - name . routers . condition "" \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ router \ tag \ TagRouter . java \n - * TagRouter \n + * TagRouter , "" application . routers . tag "" \n - private static final String RULE _ PREFIX = "" . tagrouters "" ; \n + private static final String RULE _ SUFFIX = "" . routers . tag "" ; \n - configuration . removeListener ( application + RULE _ PREFIX , this ) ; \n + configuration . removeListener ( application + RULE _ SUFFIX , this ) ; \n - String key = providerApplication + RULE _ PREFIX ; \n + String key = providerApplication + RULE _ SUFFIX ; \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ Constants . java \n - public static final String ROUTERS _ SUFFIX = "" . routers "" ; \n - \n dubbo - configcenter \ dubbo - configcenter - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ zookeeper \ CacheListener . java \n - if ( data . getPath ( ) . split ( "" / "" ) . length = = 5 ) { \n + if ( data . getPath ( ) . split ( "" / "" ) . length > = 5 ) { \n",give router rule a more layered extensiable ZK path : \n * . . / routers / condition \n * . . / routers / tag \n * . . / routers / otherRouter,634
"CHANGES . md \n - # # # Compatibility \n - \n - In order to unify the implementation of service governance rules in different configuration centers , such as Zookeeper , Nacos , Etcd , etc . , we have refactored some implementations of the configuration center compared to 2 . 7 . 0 ~ 2 . 7 . 2 . \n - \n - * For users who are using 2 . 7 . x service governance rules , please check [ the new implementation ] ( http : / / dubbo . apache . org / en - us / docs / dev / impls / Config - center . html ) before upgrading to 2 . 7 . 3 , make sure all rules have a copy under the new storage path to ensure a smooth upgrade . \n - * For users who have upgraded the 2 . 7 . x version but are not using any service governance rules , you can upgrade directly . \n - * For users using 2 . 6 . x and lower versions can upgrade directly . But make sure you follow the following instructions [ Upgrading from 2 . 6 . x to 2 . 7 . x ] ( https : / / github . com / apache / dubbo / releases / tag / dubbo - 2 . 7 . 0 ) \n - \n - # # # 升级注意事项 \n - \n - 为了统一不同配置中心（如Zookeeper、Nacos、Etcd等）对于服务治理规则的实现，我们对2 . 7 . 0以来的配置中心的部分实现进行了重构。 \n - \n - * 对于已使用了2 . 7 . x新版本服务治理规则的用户，升级2 . 7 . 3之前请先 [ 查看新版实现 ] ( http : / / dubbo . apache . org / zh - cn / docs / dev / impls / config - center . html ) ，确保已有规则在新路径下已经存在拷贝，以确保平滑升级。 \n - * 对于已经升级了2 . 7 . x版本，但是未使用服务治理规则的用户，此次升级不受影响。 \n - * 对于2 . 6 . x及以下版本用户不受此次变更影响，升级步骤请参见 [ 升级到2 . 7 . x的说明文档 ] ( https : / / github . com / apache / dubbo / releases / tag / dubbo - 2 . 7 . 0 ) 。 \n - \n",polish 2 . 7 . 3 change list,634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 3 < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 3 < / revision > \n pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 3 < / revision > \n,update version to 2 . 7 . 3 to prepare for release,634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ client \ ServiceDiscoveryRegistry . java \n - import java . util . LinkedHashMap ; \n + import java . util . LinkedHashMap ; \n - import static org . apache . dubbo . common . constants . CommonConstants . COMMA _ SPLIT _ PATTERN ; \n + import static org . apache . dubbo . common . constants . CommonConstants . APPLICATION _ KEY ; \n + import static org . apache . dubbo . common . constants . CommonConstants . COMMA _ SPLIT _ PATTERN ; \n - initTemplateURLs ( subscribedURL , serviceInstances ) ; \n + List < URL > subscribedURLs = new LinkedList < > ( ) ; \n + if ( ServiceInstanceMetadataUtils . isDubboServiceInstance ( serviceInstances . get ( 0 ) ) ) { \n + initTemplateURLs ( subscribedURL , serviceInstances ) ; \n + / / Clone the subscribed URLs from the template URLs \n + subscribedURLs = cloneSubscribedURLs ( subscribedURL , serviceInstances ) ; \n + } else { \n + for ( ServiceInstance instance : serviceInstances ) { \n + URLBuilder builder = new URLBuilder ( \n + subscribedServices . get ( serviceName ) , \n + instance . getHost ( ) , \n + instance . getPort ( ) , \n + subscribedURL . getServiceInterface ( ) , \n + instance . getMetadata ( ) \n + ) ; \n + builder . addParameter ( APPLICATION _ KEY , serviceName ) ; \n + subscribedURLs . add ( builder . build ( ) ) ; \n + } \n + } \n - / / Clone the subscribed URLs from the template URLs \n - List < URL > subscribedURLs = cloneSubscribedURLs ( subscribedURL , serviceInstances ) ; \n",generate urls directly for non - dubbo service instances .,634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ client \ ServiceDiscoveryRegistry . java \n + import static org . apache . dubbo . common . utils . DubboServiceLoader . loadServices ; \n - subscribedURLs = cloneSubscribedURLs ( subscribedURL , serviceInstances ) ; \n + subscribedURLs = cloneExportedURLs ( subscribedURL , serviceInstances ) ; \n",generate urls directly for non - dubbo service instances .,634
dubbo - all \ pom . xml \n + < exclusions > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - core < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - netty < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < exclusions > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - core < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - netty < / artifactId > \n + < / exclusion > \n + < / exclusions > \n + < exclusions > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - core < / artifactId > \n + < / exclusion > \n + < exclusion > \n + < groupId > io . grpc < / groupId > \n + < artifactId > grpc - netty < / artifactId > \n + < / exclusion > \n + < / exclusions > \n dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - cloudnative - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - cloudnative - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - cloudnative - SNAPSHOT < / revision > \n,change pom version to 2 . 7 . 5 - cloudnative - SNAPSHOT,634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractInterfaceConfig . java \n - if ( configCenter ! = null ) { \n - configCenter . refresh ( ) ; \n + if ( configCenter = = null ) { \n + ConfigManager . getInstance ( ) . getConfigCenter ( ) . ifPresent ( cc - > this . configCenter = cc ) ; \n + } \n + \n + if ( this . configCenter ! = null ) { \n + / / TODO there may have duplicate refresh \n + this . configCenter . refresh ( ) ; \n,fetch from ConfigManager if ConfigCenter is not set,634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n - checkRegistry ( ) ; \n + checkRegistry ( ) ; \n,put checkRegistry ( ) inside refer ( ) not before refer ( ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ FutureContext . java \n + import org . apache . dubbo . rpc . protocol . dubbo . FutureAdapter ; \n + / * * \n + * Guarantee ' using org . apache . dubbo . rpc . RpcContext . getFuture ( ) before proxy returns ' can work , a typical scenario is : \n + * < pre > { @ code \n + * public final class TracingFilter implements Filter { \n + * public Result invoke ( Invoker < ? > invoker , Invocation invocation ) throws RpcException { \n + * Result result = invoker . invoke ( invocation ) ; \n + * Future < Object > future = rpcContext . getFuture ( ) ; \n + * if ( future instanceof FutureAdapter ) { \n + * ( ( FutureAdapter ) future ) . getFuture ( ) . setCallback ( new FinishSpanCallback ( span ) ) ; \n + * } \n + * . . . . . . \n + * } \n + * } \n + * } < / pre > \n + * \n + * Start from 2 . 7 . 3 , you don ' t have to get Future from RpcContext , we recommend using Result directly : \n + * < pre > { @ code \n + * public final class TracingFilter implements Filter { \n + * public Result invoke ( Invoker < ? > invoker , Invocation invocation ) throws RpcException { \n + * Result result = invoker . invoke ( invocation ) ; \n + * result . whenComplete ( new FinishSpanCallback ( span ) ) ; \n + * . . . . . . \n + * } \n + * } \n + * } < / pre > \n + * \n + * / \n + if ( compatibleFuture ! = null ) { \n + this . setFuture ( new FutureAdapter ( compatibleFuture ) ) ; \n + } \n",org . apache . dubbo . rpc . RpcContext . getFuture ( ) cannot work in Filter . ( # 4504 ) \n fixes # 4499,634
dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ GenericFilter . java \n - return result ; \n + return ; \n,to meet new onResponse signature : return directly,634
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ ExtensionLoader . java \n - private IllegalStateException findException ( String name ) { \n + private void findException ( String name ) { \n - return entry . getValue ( ) ; \n + throw entry . getValue ( ) ; \n + } \n + \n + private IllegalStateException noExtensionException ( String name ) { \n + / / throws any possible exception in loading period . \n + findException ( name ) ; \n - throw findException ( name ) ; \n + throw noExtensionException ( name ) ; \n,throw exception whenever SPI extensions are in abnormal status when loading ( # 5072 ),634
"dubbo - serialization \ dubbo - serialization - api \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ ObjectInput . java \n - default Object readThrowable ( ) throws IOException , ClassNotFoundException { \n - return readObject ( ) ; \n - } \n - \n + \n + / * * \n + * The following methods are customized for the requirement of Dubbo ' s RPC protocol implementation . Legacy protocol \n + * implementation will try to write Map , Throwable and Null value directly to the stream , which does not meet the \n + * restrictions of all serialization protocols . \n + * \n + * < p > \n + * See how ProtobufSerialization , KryoSerialization implemented these methods for more details . \n + * < p > \n + * < p > \n + * The binding of RPC protocol and biz serialization protocol is not a good practice . Encoding of RPC protocol \n + * should be highly independent and portable , easy to cross platforms and languages , for example , like the http headers , \n + * restricting the content of headers / attachments to Ascii strings and uses ISO _ 8859 _ 1 to encode them . \n + * https : / / tools . ietf . org / html / rfc7540 # section - 8 . 1 . 2 \n + * / \n + default Object readThrowable ( ) throws IOException , ClassNotFoundException { \n + return readObject ( ) ; \n + } \n dubbo - serialization \ dubbo - serialization - api \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ ObjectOutput . java \n + * \n - * See ProtobufSerialization , KryoSerialization for more details . \n + * See how ProtobufSerialization , KryoSerialization implemented these methods for more details . \n - * The binding of RPC protocol and biz serialization protocol is not a good practice . The encoding of RPC protocol \n + * \n + * The binding of RPC protocol and biz serialization protocol is not a good practice . Encoding of RPC protocol \n - * restricting the headers / attachments to Ascii strings and uses ISO _ 8859 _ 1 to encode . \n + * restricting the content of headers / attachments to Ascii strings and uses ISO _ 8859 _ 1 to encode them . \n",customize serialization input & output interface definition .,634
. travis . yml \n - openjdk11 \n - - openjdk8 \n + - oraclejdk8 \n,try to fix travis javax . ex dependency issue,634
". travis . yml \n + - rm - rf $ HOME / . m2 / repository / org / glassfish / javax . el / 3 . 0 . 1 - b08 \n - travis _ wait 30 . / mvnw - - batch - mode - - no - transfer - progress clean install - DskipTests = false - Dcheckstyle . skip = false - Drat . skip = false - Dmaven . javadoc . skip = true \n - bash < ( curl - s https : / / codecov . io / bash ) \n - - if [ - f dubbo . log ] ; then echo "" - - - - - - TAIL of dubbo . log - - - - - - "" ; tail - n 1000 dubbo . log ; echo "" - - - - - - END of dubbo . log - - - - - - "" ; fi \n + - echo "" build failed ! "" \n",try to fix travis javax . ex dependency issue,634
. travis . yml \n - openjdk11 \n - - oraclejdk8 \n + - openjdk8 \n,try to fix travis javax . ex dependency issue,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ ExtensionLoader . java \n - private void findException ( String name ) { \n + private IllegalStateException findException ( String name ) { \n - throw entry . getValue ( ) ; \n + return entry . getValue ( ) ; \n - } \n - \n - private IllegalStateException noExtensionException ( String name ) { \n - / / throws any possible exception in loading period . \n - findException ( name ) ; \n - throw noExtensionException ( name ) ; \n + throw findException ( name ) ; \n - throw new IllegalStateException ( "" Duplicate extension "" + type . getName ( ) + "" name "" + name + "" on "" + c . getName ( ) + "" and "" + clazz . getName ( ) ) ; \n + String duplicateMsg = "" Duplicate extension "" + type . getName ( ) + "" name "" + name + "" on "" + c . getName ( ) + "" and "" + clazz . getName ( ) ; \n + logger . error ( duplicateMsg ) ; \n + throw new IllegalStateException ( duplicateMsg ) ; \n",revert # 5072 by logging error msg . ( # 5084 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ ExtensionLoader . java \n - private void findException ( String name ) { \n + private IllegalStateException findException ( String name ) { \n - throw entry . getValue ( ) ; \n + return entry . getValue ( ) ; \n - } \n - \n - private IllegalStateException noExtensionException ( String name ) { \n - / / throws any possible exception in loading period . \n - findException ( name ) ; \n - throw noExtensionException ( name ) ; \n + throw findException ( name ) ; \n - throw new IllegalStateException ( "" Duplicate extension "" + type . getName ( ) + "" name "" + name + "" on "" + c . getName ( ) + "" and "" + clazz . getName ( ) ) ; \n + String duplicateMsg = "" Duplicate extension "" + type . getName ( ) + "" name "" + name + "" on "" + c . getName ( ) + "" and "" + clazz . getName ( ) ; \n + logger . error ( duplicateMsg ) ; \n + throw new IllegalStateException ( duplicateMsg ) ; \n",revert # 5072 by logging error msg . ( # 5084 ),634
"dubbo - common \ pom . xml \n - < dependency > \n - < groupId > com . alibaba < / groupId > \n - < artifactId > hessian - lite < / artifactId > \n - < / dependency > \n - < dependency > \n - < groupId > com . esotericsoftware < / groupId > \n - < artifactId > kryo < / artifactId > \n - < / dependency > \n - < dependency > \n - < groupId > de . javakaffee < / groupId > \n - < artifactId > kryo - serializers < / artifactId > \n - < / dependency > \n - < dependency > \n - < groupId > de . ruedigermoeller < / groupId > \n - < artifactId > fst < / artifactId > \n - < / dependency > \n dubbo - configcenter \ dubbo - configcenter - apollo \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ apollo \ ApolloDynamicConfiguration . java \n - if ( StringUtils . isEmpty ( group ) ) { \n + if ( StringUtils . isEmpty ( group ) ) { \n dubbo - rpc \ dubbo - rpc - api \ pom . xml \n + < dependency > \n + < groupId > com . alibaba < / groupId > \n + < artifactId > hessian - lite < / artifactId > \n + < scope > test < / scope > \n + < / dependency > \n dubbo - serialization \ dubbo - serialization - api \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ support \ SerializableClassRegistry . java \n - import com . esotericsoftware . kryo . Serializer ; \n - \n - public static void registerClass ( Class clazz , Serializer serializer ) { \n + public static void registerClass ( Class clazz , Object serializer ) { \n",Simplify dubbo - common transitive dependencies ( # 5107 ),634
"dubbo - configcenter \ dubbo - configcenter - apollo \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ support \ apollo \ ApolloDynamicConfiguration . java \n + import static org . apache . dubbo . common . constants . CommonConstants . GROUP _ KEY ; \n - dubboConfig = ConfigService . getConfig ( url . getParameter ( CONFIG _ NAMESPACE _ KEY , DEFAULT _ GROUP ) ) ; \n - dubboConfigFile = ConfigService . getConfigFile ( url . getParameter ( CONFIG _ NAMESPACE _ KEY , DEFAULT _ GROUP ) , ConfigFileFormat . Properties ) ; \n + String namespace = url . getParameter ( CONFIG _ NAMESPACE _ KEY , DEFAULT _ GROUP ) ; \n + String apolloNamespace = StringUtils . isEmpty ( namespace ) ? url . getParameter ( GROUP _ KEY , DEFAULT _ GROUP ) : namespace ; \n + dubboConfig = ConfigService . getConfig ( apolloNamespace ) ; \n + dubboConfigFile = ConfigService . getConfigFile ( apolloNamespace , ConfigFileFormat . Properties ) ; \n + \n - if ( StringUtils . isEmpty ( group ) ) { \n - return dubboConfigFile . getContent ( ) ; \n - } \n - if ( group . equals ( url . getParameter ( APPLICATION _ KEY ) ) ) { \n - return ConfigService . getConfigFile ( APOLLO _ APPLICATION _ KEY , ConfigFileFormat . Properties ) . getContent ( ) ; \n - } \n - \n - ConfigFile configFile = ConfigService . getConfigFile ( group , ConfigFileFormat . Properties ) ; \n + ConfigFile configFile = ConfigService . getConfigFile ( key , ConfigFileFormat . Properties ) ; \n - throw new IllegalStateException ( "" There is no namespace named "" + group + "" in Apollo . "" ) ; \n + throw new IllegalStateException ( "" There is no namespace named "" + key + "" in Apollo . "" ) ; \n","Apollo config center optimization , use ' dubbo . properties ' as default namespace for properties . ( # 5105 )",634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n - String value = StringUtils . trim ( compositeConfiguration . getString ( extractPropertyName ( getClass ( ) , method ) ) ) ; \n - / / isTypeMatch ( ) is called to avoid duplicate and incorrect update , for example , we have two ' setGeneric ' methods in ReferenceConfig . \n - if ( StringUtils . isNotEmpty ( value ) & & ClassUtils . isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n - method . invoke ( this , ClassUtils . convertPrimitive ( method . getParameterTypes ( ) [ 0 ] , value ) ) ; \n + try { \n + String value = StringUtils . trim ( compositeConfiguration . getString ( extractPropertyName ( getClass ( ) , method ) ) ) ; \n + / / isTypeMatch ( ) is called to avoid duplicate and incorrect update , for example , we have two ' setGeneric ' methods in ReferenceConfig . \n + if ( StringUtils . isNotEmpty ( value ) & & ClassUtils . isTypeMatch ( method . getParameterTypes ( ) [ 0 ] , value ) ) { \n + method . invoke ( this , ClassUtils . convertPrimitive ( method . getParameterTypes ( ) [ 0 ] , value ) ) ; \n + } \n + } catch ( NoSuchMethodException e ) { \n + logger . info ( "" Failed to override the property "" + method . getName ( ) + "" in "" + \n + this . getClass ( ) . getSimpleName ( ) + \n + "" , please make sure every property has getter / setter method provided . "" ) ; \n",add back try - catch clause deleted in https : / / github . com / apache / dubbo / pull / 4899 . ( # 5110 ),634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n,upgrade version to 2 . 7 . 5 - SNAPSHOT,634
"compiler \ src \ java _ plugin \ cpp \ java _ generator . cpp \n - p - > Print ( * vars , "" public $ dubbo _ stub $ ( $ Channel $ channel ) { \ n "" \n - "" blockingStub = $ service _ class _ name $ . newBlockingStub ( channel ) ; \ n "" \n - "" futureStub = $ service _ class _ name $ . newFutureStub ( channel ) ; \ n "" \n - "" stub = $ service _ class _ name $ . newStub ( channel ) ; \ n "" \n + p - > Print ( * vars , "" public $ dubbo _ stub $ ( $ Channel $ channel , $ CallOptions $ callOptions ) { \ n "" \n + "" blockingStub = $ service _ class _ name $ . newBlockingStub ( channel ) . . build ( channel , callOptions ) ; \ n "" \n + "" futureStub = $ service _ class _ name $ . newFutureStub ( channel ) . build ( channel , callOptions ) ; \ n "" \n + "" stub = $ service _ class _ name $ . newStub ( channel ) . build ( channel , callOptions ) ; \ n "" \n - p - > Print ( * vars , "" public static $ dubbo _ stub $ getDubboStub ( $ Channel $ channel ) { \ n \ n "" ) ; \n - p - > Print ( * vars , "" return new $ dubbo _ stub $ ( channel ) ; "" ) ; \n + p - > Print ( * vars , "" public static $ dubbo _ stub $ getDubboStub ( $ Channel $ channel , $ CallOptions $ callOptions ) { \ n \ n "" ) ; \n + p - > Print ( * vars , "" return new $ dubbo _ stub $ ( channel , callOptions ) ; \ n "" ) ; \n",adjust grpc stub generator to fit GrpcProtocol implementation .,634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ transport \ AbstractEndpoint . java \n - import org . apache . dubbo . common . utils . StringUtils ; \n + import org . apache . dubbo . remoting . Codec ; \n + import org . apache . dubbo . remoting . transport . codec . CodecAdapter ; \n - String codecVersion = url . getParameter ( Constants . CODEC _ VERSION _ KEY ) ; \n - \n - String codec = codecName + ( StringUtils . isNotEmpty ( codecVersion ) ? codecVersion : "" "" ) ; \n - ExtensionLoader < Codec2 > codec2Loader = ExtensionLoader . getExtensionLoader ( Codec2 . class ) ; \n - if ( codec2Loader . hasExtension ( codec ) ) { \n - return codec2Loader . getExtension ( codec ) ; \n + if ( ExtensionLoader . getExtensionLoader ( Codec2 . class ) . hasExtension ( codecName ) ) { \n + return ExtensionLoader . getExtensionLoader ( Codec2 . class ) . getExtension ( codecName ) ; \n - codec2Loader . getSupportedExtensionInstances ( ) \n + return new CodecAdapter ( ExtensionLoader . getExtensionLoader ( Codec . class ) \n + . getExtension ( codecName ) ) ; \n dubbo - rpc \ dubbo - rpc - hessian \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ hessian \ HttpClientConnectionFactory . java \n + * TODO , Consider using connection pool \n dubbo - serialization \ dubbo - serialization - protobuf \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ protobuf \ support \ GenericProtobufSerialization . java \n - return new GenericProtobufJsonObjectOutput ( output ) ; \n + return new GenericProtobufObjectOutput ( output ) ; \n - return new GenericProtobufJsonObjectInput ( input ) ; \n + return new GenericProtobufObjectInput ( input ) ; \n","some small changes : comment , protobuf , etc .",634
"LICENSE \n - This product contains a modified portion of ' edazdarevic . commons . net . CIDRUtils ' , \n - under a "" MIT License "" license , see https : / / github . com / edazdarevic / CIDRUtils / blob / master / CIDRUtils . java \n + This product contains a modified portion of ' edazdarevic . commons . net . CIDRUtils ' published at \n + https : / / github . com / edazdarevic / CIDRUtils . The project is licensed under a MIT License : \n + * The MIT License \n + * \n + * Copyright ( c ) 2013 Edin Dazdarevic ( edin . dazdarevic @ gmail . com ) \n + * Permission is hereby granted , free of charge , to any person obtaining a copy \n + * of this software and associated documentation files ( the "" Software "" ) , to deal \n + * in the Software without restriction , including without limitation the rights \n + * to use , copy , modify , merge , publish , distribute , sublicense , and / or sell \n + * copies of the Software , and to permit persons to whom the Software is \n + * furnished to do so , subject to the following conditions : \n + * The above copyright notice and this permission notice shall be included in \n + * all copies or substantial portions of the Software . \n + * THE SOFTWARE IS PROVIDED "" AS IS "" , WITHOUT WARRANTY OF ANY KIND , EXPRESS OR \n + * IMPLIED , INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY , \n + * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT . IN NO EVENT SHALL THE \n + * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM , DAMAGES OR OTHER \n + * LIABILITY , WHETHER IN AN ACTION OF CONTRACT , TORT OR OTHERWISE , ARISING FROM , \n + * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN \n + * THE SOFTWARE . \n",update LICENSE : include the MIT license text of referenced code .,634
"dubbo - rpc \ dubbo - rpc - dubbo \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ dubbo \ DecodeableRpcResult . java \n - Object obj = in . readObject ( Throwable . class ) ; \n + Object obj = in . readObject ( ) ; \n dubbo - serialization \ dubbo - serialization - gson \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ gson \ GsonJsonObjectInput . java \n - import com . google . gson . Gson ; \n + import com . google . gson . Gson ; \n + \n + import java . io . EOFException ; \n + import java . io . IOException ; \n - import java . lang . reflect . Type ; \n - import java . io . IOException ; \n - import java . io . EOFException ; \n + import java . lang . reflect . Type ; \n - return gson . fromJson ( json , Object . class ) ; \n + return gson . fromJson ( json , String . class ) ; \n","revert # 5099 , deserialization readObject related changes .",634
"dubbo - serialization \ dubbo - serialization - gson \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ gson \ GsonJsonObjectInput . java \n - return gson . fromJson ( json , String . class ) ; \n + return gson . fromJson ( json , Object . class ) ; \n","followup of c31ef9ad934688469826b39f35b709f712e56c75 , use readObject ( json , Object . class )",634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistryFactory . java \n + import org . apache . dubbo . registry . NotifyListener ; \n + import java . util . List ; \n + import java . util . concurrent . atomic . AtomicBoolean ; \n + private static final AtomicBoolean destroyed = new AtomicBoolean ( false ) ; \n + \n + if ( ! destroyed . compareAndSet ( false , true ) ) { \n + return ; \n + } \n + \n + if ( destroyed . get ( ) ) { \n + LOGGER . warn ( "" All registry instances have been destroyed , failed to fetch any instance . "" + \n + "" Usually , this means no need to try to do unnecessary redundant resource clearance , all registries has been taken care of . "" ) ; \n + return DEFAULT _ NOP _ REGISTRY ; \n + } \n + \n + \n + private static Registry DEFAULT _ NOP _ REGISTRY = new Registry ( ) { \n + @ Override \n + public URL getUrl ( ) { \n + return null ; \n + } \n + \n + @ Override \n + public boolean isAvailable ( ) { \n + return false ; \n + } \n + \n + @ Override \n + public void destroy ( ) { \n + \n + } \n + \n + @ Override \n + public void register ( URL url ) { \n + \n + } \n + \n + @ Override \n + public void unregister ( URL url ) { \n + \n + } \n + \n + @ Override \n + public void subscribe ( URL url , NotifyListener listener ) { \n + \n + } \n + \n + @ Override \n + public void unsubscribe ( URL url , NotifyListener listener ) { \n + \n + } \n + \n + @ Override \n + public List < URL > lookup ( URL url ) { \n + return null ; \n + } \n + } ; \n + \n",Fix shutdown bug : avoid recreating registry after destroy . ( # 5450 ),634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistryFactory . java \n + / / for unit test \n + public static void clearRegistryNotDestroy ( ) { \n + REGISTRIES . clear ( ) ; \n + } \n + \n dubbo - registry \ dubbo - registry - default \ src \ test \ java \ org \ apache \ dubbo \ registry \ dubbo \ RegistryStatusCheckerTest . java \n + import org . apache . dubbo . rpc . model . ApplicationModel ; \n - AbstractRegistryFactory . destroyAll ( ) ; \n + AbstractRegistryFactory . clearRegistryNotDestroy ( ) ; \n + ApplicationModel . setApplication ( "" testCheckOK "" ) ; \n",fix default registry ut failure ( # 5452 ),634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractInterfaceConfig . java \n + if ( cc . getParameters ( ) = = null ) { \n + cc . setParameters ( new HashMap < > ( ) ) ; \n + } \n - Map < String , String > configParams = cc . getParameters ( ) = = null ? new HashMap < > ( ) : cc . getParameters ( ) ; \n - configParams . putAll ( rc . getParameters ( ) ) ; \n - cc . setParameters ( configParams ) ; \n - } else { \n - rc . setParameters ( new HashMap < > ( ) ) ; \n + cc . getParameters ( ) . putAll ( rc . getParameters ( ) ) ; \n",fix parameters could be null . ( # 5205 ),634
CHANGES . md \n - # # 2 . 7 . 4 \n + # # 2 . 7 . 4 . 1 \n,bump version to 2 . 7 . 4 . 1,634
README . md \n - < dubbo . version > 2 . 7 . 3 < / dubbo . version > \n + < dubbo . version > 2 . 7 . 4 . 1 < / dubbo . version > \n,use the latest version as the default dependency .,634
dubbo - compatible \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ Protocol . java \n + import org . apache . dubbo . rpc . ProtocolServer ; \n + \n + import java . util . Collections ; \n + import java . util . List ; \n + \n + \n + @ Override \n + default List < ProtocolServer > getServers ( ) { \n + return Collections . emptyList ( ) ; \n + } \n,add default implementation for alibaba pacakge compatible class,634
"dubbo - bootstrap \ dubbo - bootstrap - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ beans \ factory \ annotation \ ReferenceAnnotationBeanPostProcessor . java \n + import org . apache . dubbo . config . ApplicationConfig ; \n + import org . apache . dubbo . config . ConsumerConfig ; \n + import org . apache . dubbo . config . MetadataReportConfig ; \n + import org . apache . dubbo . config . MetricsConfig ; \n + import org . apache . dubbo . config . ModuleConfig ; \n + import org . apache . dubbo . config . MonitorConfig ; \n + import org . apache . dubbo . config . ProtocolConfig ; \n + import org . apache . dubbo . config . ProviderConfig ; \n + import org . apache . dubbo . config . RegistryConfig ; \n + import org . apache . dubbo . config . spring . ConfigCenterBean ; \n + import static org . springframework . beans . factory . BeanFactoryUtils . beansOfTypeIncludingAncestors ; \n + private volatile boolean preparedDubboConfigBeans ; \n + \n + private void prepareDubboConfigBeans ( ) { \n + \n + if ( preparedDubboConfigBeans ) { \n + return ; \n + } \n + \n + preparedDubboConfigBeans = true ; \n + \n + ConfigurableListableBeanFactory beanFactory = getBeanFactory ( ) ; \n + \n + / / Initializes there Dubbo ' s Config Beans before @ Reference bean autowiring \n + beansOfTypeIncludingAncestors ( beanFactory , ApplicationConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , ModuleConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , RegistryConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , ProtocolConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , MonitorConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , ProviderConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , ConsumerConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , ConfigCenterBean . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , MetadataReportConfig . class ) ; \n + beansOfTypeIncludingAncestors ( beanFactory , MetricsConfig . class ) ; \n + } \n + \n + prepareDubboConfigBeans ( ) ; \n",init application scope configs before start referencing .,634
"dubbo - config \ dubbo - config - spring \ src \ main \ resources \ META - INF \ compat \ dubbo . xsd \n + < xsd : appinfo > \n + < tool : annotation > \n + < tool : exports type = "" org . apache . dubbo . config . ConfigCenterConfig "" / > \n + < / tool : annotation > \n + < / xsd : appinfo > \n dubbo - config \ dubbo - config - spring \ src \ main \ resources \ META - INF \ dubbo . xsd \n + < xsd : appinfo > \n + < tool : annotation > \n + < tool : exports type = "" org . apache . dubbo . config . MetadataReportConfig "" / > \n + < / tool : annotation > \n + < / xsd : appinfo > \n + < xsd : appinfo > \n + < tool : annotation > \n + < tool : exports type = "" org . apache . dubbo . config . ConfigCenterConfig "" / > \n + < / tool : annotation > \n + < / xsd : appinfo > \n",Complete xsd definition for ConfigCenterConfig and MetadataReporterConfig ( # 3854 ),634
dubbo - dependencies - bom \ pom . xml \n - < nacos _ version > 1 . 0 . 1 < / nacos _ version > \n + < nacos _ version > 1 . 1 . 1 < / nacos _ version > \n,Upgrade nacos - client dependency version to 1 . 1 . 1 ( # 4534 ) \n * upgrade nacos - client dependency version to 1 . 1 . 0 \n * change to 1 . 1 . 1,634
"compiler \ build . gradle \n - version = "" 1 . 19 . 0 "" / / CURRENT _ GRPC _ VERSION \n + version = "" 1 . 19 . 0 - SNAPSHOT "" / / CURRENT _ GRPC _ VERSION \n compiler \ src \ java _ plugin \ cpp \ java _ generator . cpp \n + p - > Print ( * vars , "" private $ dubbo _ interface $ proxiedImpl ; \ n \ n "" ) ; \n + p - > Print ( * vars , "" public final void setProxiedImpl ( $ dubbo _ interface $ proxiedImpl ) { \ n "" ) ; \n + p - > Print ( * vars , "" this . proxiedImpl = proxiedImpl ; \ n "" ) ; \n + p - > Print ( * vars , "" } \ n \ n "" ) ; \n + \n - ( * vars ) [ "" instance "" ] = "" this "" ; \n + ( * vars ) [ "" instance "" ] = "" proxiedImpl "" ; \n + ( * vars ) [ "" dubbo _ interface "" ] = "" I "" + service - > name ( ) ; \n - "" private final $ service _ name $ serviceImpl ; \ n "" \n + "" private final $ dubbo _ interface $ serviceImpl ; \ n "" \n - "" MethodHandlers ( $ service _ name $ serviceImpl , int methodId ) { \ n "" \n + "" MethodHandlers ( $ dubbo _ interface $ serviceImpl , int methodId ) { \ n "" \n - vars [ "" ListenableFuture "" ] = \n - "" com . google . common . util . concurrent . ListenableFuture "" ; \n + vars [ "" ListenableFuture "" ] = "" com . google . common . util . concurrent . ListenableFuture "" ; \n","fix grpc impl proxy problem , costomize protoc compiler",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ context \ ConfigManager . java \n - throw new IllegalStateException ( "" Duplicate Config found for "" + configName + "" , you should use only one unique "" + configName + "" for one application . "" ) ; \n + logger . warn ( "" Duplicate Config found for "" + configName + "" , you should use only one unique "" + configName + "" for one application . "" ) ; \n",change from throwing exception to logging warn message for duplicate configs,634
dubbo - all \ pom . xml \n + < dependency > \n + < groupId > com . alibaba . spring < / groupId > \n + < artifactId > spring - context - support < / artifactId > \n + < / dependency > \n dubbo - dependencies - bom \ pom . xml \n - < alibaba _ spring _ context _ support _ version > 1 . 0 . 4 < / alibaba _ spring _ context _ support _ version > \n + < alibaba _ spring _ context _ support _ version > 1 . 0 . 4 - SNAPSHOT < / alibaba _ spring _ context _ support _ version > \n,"temporarily change spring - context - support dependency back to SNAPSHOT , the formal release turns to be broken .",634
compiler \ README . md \n - < pluginArtifact > org . apache . dubbo : protoc - gen - grpc - java : $ { proto _ dubbo _ plugin _ version } : exe : $ { os . detected . classifier } < / pluginArtifact > \n + < pluginArtifact > org . apache . dubbo : protoc - gen - dubbo - java : $ { proto _ dubbo _ plugin _ version } : exe : $ { os . detected . classifier } < / pluginArtifact > \n dubbo - serialization \ dubbo - serialization - protobuf \ pom . xml \n - org . apache . dubbo : protoc - gen - grpc - java : $ { proto _ dubbo _ plugin _ version } : exe : $ { os . detected . classifier } \n + org . apache . dubbo : protoc - gen - dubbo - java : $ { proto _ dubbo _ plugin _ version } : exe : $ { os . detected . classifier } \n,artifact id changed to protoc - gen - dubbo - java,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ConfigCenterConfig . java \n - @ Parameter ( key = Constants . CONFIG _ CLUSTER _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ CLUSTER _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ NAMESPACE _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ NAMESPACE _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ GROUP _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ GROUP _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ CHECK _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ CHECK _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ ENABLE _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ ENABLE _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ TIMEOUT _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ TIMEOUT _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ CONFIGFILE _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ CONFIGFILE _ KEY , useKeyAsProperty = false ) \n - @ Parameter ( key = Constants . CONFIG _ APPNAME _ KEY ) \n + @ Parameter ( key = Constants . CONFIG _ APPNAME _ KEY , useKeyAsProperty = false ) \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ support \ Parameter . java \n + / * * \n + * if { @ link # key ( ) } is specified , it will be used as the key for the annotated property when generating url . \n + * by default , this key will also be used to retrieve the config value : \n + * < pre > \n + * { @ code \n + * class ExampleConfig { \n + * / / Dubbo will try to get "" dubbo . example . alias _ for _ item = xxx "" from . properties , if you want to use the original property \n + * / / "" dubbo . example . item = xxx "" , you need to set useKeyAsProperty = false . \n + * @ Parameter ( key = "" alias _ for _ item "" ) \n + * public getItem ( ) ; \n + * } \n + * } \n + * \n + * < / pre > \n + * / \n",Revert # 3688 config - center - config ( # 3853 ),634
dubbo - compatible \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ RpcContext . java \n - if ( rpcContext . getCompletableFuture ( ) ! = null ) { \n - copy . setFuture ( rpcContext . getCompletableFuture ( ) ) ; \n - } \n + \n,fix RpcContext compatible problem ( # 4544 ),634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 3 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 4 - SNAPSHOT < / revision > \n,bump version to 2 . 7 . 4 - SNAPSHOT ( # 4549 ),634
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistryFactory . java \n - / / Registry Collection Map < RegistryAddress , Registry > \n + / / Registry Collection Map < RegistryAddress , ServiceOrientedRegistry > \n + / / Registry Collection Map < RegistryAddress , Registry > \n + private static final Map < String , Registry > COMPATIBLE _ REGISTRIES = new HashMap < > ( ) ; \n + \n - Registry registry = REGISTRIES . get ( key ) ; \n - if ( registry ! = null ) { \n - return registry ; \n - } \n - / / creates an instance of ServiceOrientedRegistry if supported \n - / / since 2 . 7 . 4 \n - registry = ServiceOrientedRegistry . create ( url ) ; \n - if ( registry = = null ) { / / If not supported , create the default Registry \n + boolean isServiceOriented = ServiceOrientedRegistry . supports ( url ) ; \n + if ( isServiceOriented ) { \n + Registry registry = REGISTRIES . get ( key ) ; \n + if ( registry ! = null ) { \n + return registry ; \n + } \n - registry = createRegistry ( url ) ; \n - } \n - if ( registry = = null ) { \n - throw new IllegalStateException ( "" Can not create registry "" + url ) ; \n + registry = ServiceOrientedRegistry . create ( url ) ; \n + if ( registry = = null ) { \n + throw new IllegalStateException ( "" Can not service - oriented registry "" + url ) ; \n + } \n + REGISTRIES . put ( key , registry ) ; \n + return registry ; \n + } else { \n + return getCompatibleRegistry ( key , url ) ; \n - REGISTRIES . put ( key , registry ) ; \n - return registry ; \n + private Registry getCompatibleRegistry ( String key , URL url ) { \n + Registry registry = COMPATIBLE _ REGISTRIES . get ( key ) ; \n + if ( registry ! = null ) { \n + return registry ; \n + } \n + / / create registry by spi / ioc \n + registry = createRegistry ( url ) ; \n + if ( registry = = null ) { \n + throw new IllegalStateException ( "" Can not create registry "" + url ) ; \n + } \n + COMPATIBLE _ REGISTRIES . put ( key , registry ) ; \n + return registry ; \n + } \n + \n",support old registry model and new registry model,634
dubbo - bom \ pom . xml \n + < dependency > \n + < groupId > org . apache . dubbo < / groupId > \n + < artifactId > dubbo < / artifactId > \n + < version > $ { project . version } < / version > \n + < / dependency > \n,add all - in - one dependency to dubbo bom file . ( # 5499 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfigBase . java \n + if ( StringUtils . isEmpty ( registryIds ) ) { \n + setRegistryIds ( consumer . getRegistryIds ( ) ) ; \n + } \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfigBase . java \n + if ( StringUtils . isEmpty ( registryIds ) ) { \n + setRegistryIds ( provider . getRegistryIds ( ) ) ; \n + } \n + if ( StringUtils . isEmpty ( protocolIds ) ) { \n + setProtocolIds ( provider . getProtocolIds ( ) ) ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n - / / Use default configs defined explicitly on global scope \n + / / Use default configs defined explicitly with global scope \n dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ schema \ DubboBeanDefinitionParser . java \n + import org . apache . dubbo . config . AbstractServiceConfig ; \n - } else if ( "" provider "" . equals ( property ) | | "" registry "" . equals ( property ) | | ( "" protocol "" . equals ( property ) & & ServiceBean . class . equals ( beanClass ) ) ) { \n + } else if ( "" provider "" . equals ( property ) | | "" registry "" . equals ( property ) | | ( "" protocol "" . equals ( property ) & & AbstractServiceConfig . class . isAssignableFrom ( beanClass ) ) ) { \n",Fix multi protocol does not work when referencing in ProviderConfig ( # 5498 ) \n fix # 5398,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractInterfaceConfig . java \n - * Registry centers \n + * The registry list the service will register to \n + * Also see { @ link # registryIds } , only one of them will work . \n + / * * \n + * The id list of registries the service will register to \n + * Also see { @ link # registries } , only one of them will work . \n + * / \n - List < RegistryConfig > tmpRegistries = CollectionUtils . isNotEmpty ( registries ) ? registries : new ArrayList < > ( ) ; \n + List < RegistryConfig > tmpRegistries = new ArrayList < > ( ) ; \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractServiceConfig . java \n + * Also see { @ link # protocolIds } , only one of them will work . \n + \n + / * * \n + * The id list of protocols the service will export with \n + * Also see { @ link # protocols } , only one of them will work . \n + * / \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfigBase . java \n - List < ProtocolConfig > tmpProtocols = CollectionUtils . isNotEmpty ( protocols ) ? protocols : new ArrayList < > ( ) ; \n + List < ProtocolConfig > tmpProtocols = new ArrayList < > ( ) ; \n","protocols / protocolIds and registries / registryIds , make sure only one can work ( # 5497 )",634
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ NetUtils . java \n + import org . apache . dubbo . common . logger . support . FailsafeLogger ; \n - private static final Logger logger = LoggerFactory . getLogger ( NetUtils . class ) ; \n + private static Logger logger ; \n + \n + { \n + logger = LoggerFactory . getLogger ( NetUtils . class ) ; \n + if ( logger instanceof FailsafeLogger ) { \n + logger = ( ( FailsafeLogger ) logger ) . getLogger ( ) ; \n + } \n + } \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ AbstractConfig . java \n + \n + try { \n + getClass ( ) . getDeclaredField ( key ) ; \n + } catch ( NoSuchFieldException e ) { \n + / / ignore \n + continue ; \n + } \n + \n,"Fix netutils log endless recursive ( # 5514 ) \n * Fixes # 4992 , endless recursive call when NetUtils method fails . \n * Fixes # 4225",634
"rename from dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ ServiceDescriptor . java \n rename to dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ BaseServiceMetadata . java \n - public class ServiceDescriptor { \n + public class BaseServiceMetadata { \n - public static ServiceDescriptor revertDisplayServiceKey ( String displayKey ) { \n + public static BaseServiceMetadata revertDisplayServiceKey ( String displayKey ) { \n - return new ServiceDescriptor ( ) ; \n + return new BaseServiceMetadata ( ) ; \n - ServiceDescriptor serviceDescriptor = new ServiceDescriptor ( ) ; \n + BaseServiceMetadata serviceDescriptor = new BaseServiceMetadata ( ) ; \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ URL . java \n - return ServiceDescriptor . buildServiceKey ( path , group , version ) ; \n + return BaseServiceMetadata . buildServiceKey ( path , group , version ) ; \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ rpc \ model \ ServiceMetadata . java \n - import org . apache . dubbo . common . ServiceDescriptor ; \n + import org . apache . dubbo . common . BaseServiceMetadata ; \n - public class ServiceMetadata extends ServiceDescriptor { \n + public class ServiceMetadata extends BaseServiceMetadata { \n",Rename ServiceDescriptor to BaseServiceMetadata ( # 5512 ),634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n + if ( registryConfig . getTimeout ( ) ! = null ) { \n + cc . setTimeout ( registryConfig . getTimeout ( ) . longValue ( ) ) ; \n + } \n,fix configcenter use registry timeout value . ( # 5518 ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ ListenableFilter . java \n - * \n + * This abstract will be removed soon from one future release . \n + * Please implementing Filter . Listener directly for callback registration , \n + * check the default implementation , see { @ link org . apache . dubbo . rpc . filter . ExceptionFilter } , for example . \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ ProtocolFilterWrapper . java \n + } else { / / Deprecated ! \n + filter . onResponse ( r , invoker , invocation ) ; \n",call Filter . onResponse for backward compatibility . ( # 5527 ),634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ interceptor \ ClusterInterceptor . java \n - void onResponse ( Result appResponse , AbstractClusterInvoker < ? > clusterInvoker , Invocation invocation ) ; \n + void onMessage ( Result appResponse , AbstractClusterInvoker < ? > clusterInvoker , Invocation invocation ) ; \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ interceptor \ ConsumerContextClusterInterceptor . java \n - public void onResponse ( Result appResponse , AbstractClusterInvoker < ? > invoker , Invocation invocation ) { \n + public void onMessage ( Result appResponse , AbstractClusterInvoker < ? > invoker , Invocation invocation ) { \n dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ support \ wrapper \ AbstractCluster . java \n - listener . onResponse ( r , clusterInvoker , invocation ) ; \n + listener . onMessage ( r , clusterInvoker , invocation ) ; \n",Rename onReponse in ClusterInterceptor to onMessage ( # 5528 ),634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 5 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n,change version to 2 . 7 . 6 - SNAPSHOT to prepare for next major release,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ threadpool \ ThreadlessExecutor . java \n + private boolean finished = false ; \n + \n - * Waits until there is a Runnable , then executes it and all queued Runnables after it . \n + * Waits until there is a task , executes the task and all queued tasks ( if there ' re any ) . The task is either a normal \n + * response or a timeout response . \n + / * * \n + * Usually , { @ link # waitAndDrain ( ) } will only get called once . It blocks for the response for the first time , \n + * once the response ( the task ) reached and being executed waitAndDrain will return , the whole request process \n + * then finishes . Subsequent calls on { @ link # waitAndDrain ( ) } ( if there ' re any ) should return immediately . \n + * \n + * There ' s no need to worry that { @ link # finished } is not thread - safe . Checking and updating of \n + * ' finished ' only appear in waitAndDrain , since waitAndDrain is binding to one RPC call ( one thread ) , the call \n + * of it is totally sequential . \n + * / \n + if ( finished ) { \n + return ; \n + } \n + \n + / / mark the status of ThreadlessExecutor as finished . \n + finished = true ; \n",add finish status for ThreadlessExecutor to support being called multiple times . ( # 5540 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ rpc \ model \ ConsumerModel . java \n + \n + initMethodModels ( ) ; \n + } \n - for ( Method method : metadata . getServiceType ( ) . getMethods ( ) ) { \n - methodModels . put ( method , new ConsumerMethodModel ( method ) ) ; \n + public void initMethodModels ( ) { \n + Class [ ] interfaceList = serviceMetadata . getTarget ( ) . getClass ( ) . getInterfaces ( ) ; \n + for ( Class interfaceClass : interfaceList ) { \n + for ( Method method : interfaceClass . getMethods ( ) ) { \n + methodModels . put ( method , new ConsumerMethodModel ( method ) ) ; \n + } \n",add back missed logic in ConsumerModel during 3 . x merge . ( # 5539 ),634
README . md \n - < dubbo . version > 2 . 7 . 4 . 1 < / dubbo . version > \n + < dubbo . version > 2 . 7 . 5 < / dubbo . version > \n,upgrade dependency to 2 . 7 . 5,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ rpc \ model \ ServiceMetadata . java \n - this . attributeMap . put ( key , value ) ; \n + this . attachments . put ( key , value ) ; \n",fix addAttachment put into the wrong property ( # 6012 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ config \ configcenter \ DynamicConfiguration . java \n + import java . util . Collections ; \n - throw new UnsupportedOperationException ( "" No support "" ) ; \n + return false ; \n - throw new UnsupportedOperationException ( "" No support "" ) ; \n + return Collections . emptySortedSet ( ) ; \n",DynamicConfiguration : return default value if not implemented . ( # 6086 ) \n fixes # 5916,634
dubbo - compatible \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ dubbo \ FutureAdapter . java \n + public FutureAdapter ( ResponseFuture responseFuture ) { \n + this . future = new CompletableFuture < > ( ) ; \n + responseFuture . setCallback ( new ResponseCallback ( ) { \n + @ Override \n + public void done ( Object response ) { \n + future . complete ( response ) ; \n + } \n + \n + @ Override \n + public void caught ( Throwable exception ) { \n + future . completeExceptionally ( exception ) ; \n + } \n + } ) ; \n + } \n + \n,"fix # 6555 , backward compatibility : com . alibaba . dubbo . rpc . protocol . dubbo . FutureAdapter missing constructor . ( # 6675 )",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ constants \ CommonConstants . java \n - String METADATA _ REVISION = "" metadata . revision "" ; \n - \n - String METADATA _ KEY = "" metadata "" ; \n + String METADATA _ KEY = "" metadata - type "" ; \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ApplicationConfig . java \n + import static org . apache . dubbo . common . constants . CommonConstants . METADATA _ KEY ; \n + @ Parameter ( key = METADATA _ KEY ) \n dubbo - demo \ dubbo - demo - xml \ dubbo - demo - xml - provider \ src \ main \ resources \ spring \ dubbo - provider . xml \n - < dubbo : application name = "" demo - provider "" / > \n + < dubbo : application metadata - type = "" remote "" name = "" demo - provider "" / > \n + < dubbo : metadata - report address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 "" / > \n",fix specifying metadata type cannot work ( # 5703 ) \n fix # 5667,634
"dubbo - monitor \ dubbo - monitor - api \ src \ main \ java \ org \ apache \ dubbo \ monitor \ support \ MonitorFilter . java \n - invocation . setAttachment ( MONITOR _ FILTER _ START _ TIME , String . valueOf ( System . currentTimeMillis ( ) ) ) ; \n + invocation . put ( MONITOR _ FILTER _ START _ TIME , System . currentTimeMillis ( ) ) ; \n - collect ( invoker , invocation , result , RpcContext . getContext ( ) . getRemoteHost ( ) , Long . valueOf ( ( String ) invocation . getAttachment ( MONITOR _ FILTER _ START _ TIME ) ) , false ) ; \n + collect ( invoker , invocation , result , RpcContext . getContext ( ) . getRemoteHost ( ) , ( long ) invocation . get ( MONITOR _ FILTER _ START _ TIME ) , false ) ; \n - collect ( invoker , invocation , null , RpcContext . getContext ( ) . getRemoteHost ( ) , Long . valueOf ( ( String ) invocation . getAttachment ( MONITOR _ FILTER _ START _ TIME ) ) , true ) ; \n + collect ( invoker , invocation , null , RpcContext . getContext ( ) . getRemoteHost ( ) , ( long ) invocation . get ( MONITOR _ FILTER _ START _ TIME ) , true ) ; \n",fix monitor filter : consumer side elapsed time is negative ( # 5705 ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ dubbo \ FutureAdapter . java \n - * FutureAdapter \n + * This is the type of the Future instance users get in an async call : \n + * 1 . unwrap AppResponse in appResponseFuture and convert to plain biz result represented by FutureAdapter . \n + * 2 . customized behaviors meaningful for RPC , for example , { @ link # cancel ( boolean ) } \n","add comment for FutureAdapter , see # 3979",634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n + / / for compatibility purpose \n + DubboShutdownHook . destroyAll ( ) ; \n - / / for compatibility purpose \n - DubboShutdownHook . destroyAll ( ) ; \n - \n,"Revert "" [ Dubbo - 5813 ] prevent destroyAll method of DubboShutdownHook being invoked twice when using Spring ( # 5814 ) "" ( # 5818 ) \n This reverts commit 5194791f130eb34d6ed75bc43ef731289a12148a .",634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ DubboShutdownHook . java \n - private final AtomicBoolean destroyed = new AtomicBoolean ( false ) ; \n + private static final AtomicBoolean destroyed = new AtomicBoolean ( false ) ; \n - if ( ! destroyed . compareAndSet ( false , true ) ) { \n - return ; \n - } \n - \n - AbstractRegistryFactory . destroyAll ( ) ; \n - destroyProtocols ( ) ; \n + if ( destroyed . compareAndSet ( false , true ) ) { \n + AbstractRegistryFactory . destroyAll ( ) ; \n + destroyProtocols ( ) ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n + \n",fix destroyAll called twice . ( # 5819 ) \n fix # 5813,634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n + import static org . apache . dubbo . common . constants . CommonConstants . REMOTE _ METADATA _ STORAGE _ TYPE ; \n + MetadataReportConfig metadataReportConfig = getMetadataReportConfig ( ) ; \n + if ( metadataReportConfig ! = null & & metadataReportConfig . isValid ( ) ) { \n + map . putIfAbsent ( METADATA _ KEY , REMOTE _ METADATA _ STORAGE _ TYPE ) ; \n + } \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + import static org . apache . dubbo . common . constants . CommonConstants . REMOTE _ METADATA _ STORAGE _ TYPE ; \n + MetadataReportConfig metadataReportConfig = getMetadataReportConfig ( ) ; \n + if ( metadataReportConfig ! = null & & metadataReportConfig . isValid ( ) ) { \n + map . putIfAbsent ( METADATA _ KEY , REMOTE _ METADATA _ STORAGE _ TYPE ) ; \n + } \n",fix metadata config does not take effect ( # 5809 ),634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n - startMetadataReport ( ) ; \n - \n - initMetadataServiceExporter ( ) ; \n - \n - / / check Config Center \n - Collection < ConfigCenterConfig > configCenters = configManager . getConfigCenters ( ) ; \n - if ( CollectionUtils . isNotEmpty ( configCenters ) ) { \n - for ( ConfigCenterConfig configCenterConfig : configCenters ) { \n - ConfigValidationUtils . validateConfigCenterConfig ( configCenterConfig ) ; \n - } \n - } \n + \n - for ( MetadataReportConfig metadataReportConfig : metadatas ) { \n - ConfigValidationUtils . validateMetadataConfig ( metadataReportConfig ) ; \n + if ( CollectionUtils . isEmpty ( metadatas ) ) { \n + MetadataReportConfig metadataReportConfig = new MetadataReportConfig ( ) ; \n + metadataReportConfig . refresh ( ) ; \n + if ( metadataReportConfig . isValid ( ) ) { \n + configManager . addMetadataReport ( metadataReportConfig ) ; \n + metadatas = configManager . getMetadataConfigs ( ) ; \n + } \n + } \n + if ( CollectionUtils . isNotEmpty ( metadatas ) ) { \n + for ( MetadataReportConfig metadataReportConfig : metadatas ) { \n + metadataReportConfig . refresh ( ) ; \n + ConfigValidationUtils . validateMetadataConfig ( metadataReportConfig ) ; \n + } \n + / / check Config Center \n + if ( CollectionUtils . isEmpty ( configCenters ) ) { \n + ConfigCenterConfig configCenterConfig = new ConfigCenterConfig ( ) ; \n + configCenterConfig . refresh ( ) ; \n + if ( configCenterConfig . isValid ( ) ) { \n + configManager . addConfigCenter ( configCenterConfig ) ; \n + configCenters = configManager . getConfigCenters ( ) ; \n + } \n + } else { \n + for ( ConfigCenterConfig configCenterConfig : configCenters ) { \n + configCenterConfig . refresh ( ) ; \n + ConfigValidationUtils . validateConfigCenterConfig ( configCenterConfig ) ; \n + } \n + } \n + \n - configCenter . refresh ( ) ; \n - ConfigValidationUtils . validateConfigCenterConfig ( configCenter ) ; \n + startMetadataReport ( ) ; \n - } \n - \n - / * * \n - * Initialize { @ link MetadataServiceExporter } \n - * / \n - private void initMetadataServiceExporter ( ) { \n,fix config - center configured in dubbo . properties does not work . ( # 5811 ) \n fixes # 5777,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ URL . java \n + import static org . apache . dubbo . common . constants . CommonConstants . DEFAULT _ KEY _ PREFIX ; \n - parameters . put ( part . substring ( 0 , j ) , part . substring ( j + 1 ) ) ; \n + String key = part . substring ( 0 , j ) ; \n + String value = part . substring ( j + 1 ) ; \n + parameters . put ( key , value ) ; \n + / / compatible with lower versions registering "" default . "" keys \n + if ( key . startsWith ( DEFAULT _ KEY _ PREFIX ) ) { \n + parameters . putIfAbsent ( key . substring ( DEFAULT _ KEY _ PREFIX . length ( ) ) , value ) ; \n + } \n dubbo - common \ src \ test \ java \ org \ apache \ dubbo \ common \ utils \ UrlUtilsTest . java \n + \n + @ Test \n + public void testIsMatchUrlWithDefaultPrefix ( ) { \n + URL url = URL . valueOf ( "" dubbo : / / 127 . 0 . 0 . 1 : 20880 / com . xxx . XxxService ? default . version = 1 . 0 . 0 & default . group = test "" ) ; \n + assertEquals ( "" 1 . 0 . 0 "" , url . getParameter ( "" version "" ) ) ; \n + assertEquals ( "" 1 . 0 . 0 "" , url . getParameter ( "" default . version "" ) ) ; \n + \n + URL consumerUrl = URL . valueOf ( "" consumer : / / 127 . 0 . 0 . 1 / com . xxx . XxxService ? version = 1 . 0 . 0 & group = test "" ) ; \n + assertTrue ( UrlUtils . isMatch ( consumerUrl , url ) ) ; \n + \n + URL consumerUrl1 = URL . valueOf ( "" consumer : / / 127 . 0 . 0 . 1 / com . xxx . XxxService ? default . version = 1 . 0 . 0 & default . group = test "" ) ; \n + assertTrue ( UrlUtils . isMatch ( consumerUrl , url ) ) ; \n + } \n","compatible with lower versions registering "" default . "" keys ( # 5950 )",634
dubbo - dependencies - bom \ pom . xml \n - < hessian _ lite _ version > 3 . 2 . 6 < / hessian _ lite _ version > \n + < hessian _ lite _ version > 3 . 2 . 7 < / hessian _ lite _ version > \n,update hessian - lite to 3 . 2 . 7 ( # 5964 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ ReflectUtils . java \n - import java . beans . PropertyDescriptor ; \n - * Get the value from the specified bean and its property . \n + * Get the value from the specified bean and its getter method . \n - * @ param bean the bean instance \n - * @ param propertyName the name of property \n - * @ param < T > the type of property value \n + * @ param bean the bean instance \n + * @ param methodName the name of getter \n + * @ param < T > the type of property value \n - public static < T > T getProperty ( Object bean , String propertyName ) { \n + public static < T > T getProperty ( Object bean , String methodName ) { \n + \n - propertyValue = ( T ) Stream . of ( beanInfo . getPropertyDescriptors ( ) ) \n - . filter ( propertyDescriptor - > propertyName . equals ( propertyDescriptor . getName ( ) ) ) \n - . map ( PropertyDescriptor : : getReadMethod ) \n + propertyValue = ( T ) Stream . of ( beanInfo . getMethodDescriptors ( ) ) \n + . filter ( methodDescriptor - > methodName . equals ( methodDescriptor . getName ( ) ) ) \n - return method . invoke ( bean ) ; \n + return method . getMethod ( ) . invoke ( bean ) ; \n + / / ignore \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ context \ ConfigManager . java \n - Boolean isDefault = getProperty ( config , "" default "" ) ; \n + Boolean isDefault = getProperty ( config , "" isDefault "" ) ; \n dubbo - common \ src \ test \ java \ org \ apache \ dubbo \ config \ context \ ConfigManagerTest . java \n + \n + @ Test \n + public void testDefaultConfig ( ) { \n + ProviderConfig providerConfig = new ProviderConfig ( ) ; \n + providerConfig . setDefault ( false ) ; \n + assertFalse ( ConfigManager . isDefaultConfig ( providerConfig ) ) ; \n + \n + ProviderConfig providerConfig1 = new ProviderConfig ( ) ; \n + assertTrue ( ConfigManager . isDefaultConfig ( providerConfig1 ) ) ; \n + \n + ProviderConfig providerConfig3 = new ProviderConfig ( ) ; \n + providerConfig . setDefault ( true ) ; \n + assertTrue ( ConfigManager . isDefaultConfig ( providerConfig3 ) ) ; \n + \n + ProtocolConfig protocolConfig = new ProtocolConfig ( ) ; \n + protocolConfig . setDefault ( false ) ; \n + assertFalse ( ConfigManager . isDefaultConfig ( protocolConfig ) ) ; \n + } \n",Fix default config does not work as expected . ( # 5952 ) \n fixes # 5947,634
"dubbo - dependencies - bom \ pom . xml \n - < hessian _ lite _ version > 3 . 2 . 7 < / hessian _ lite _ version > \n + < hessian _ lite _ version > 3 . 2 . 8 < / hessian _ lite _ version > \n dubbo - serialization \ dubbo - serialization - hessian2 \ src \ main \ java \ org \ apache \ dubbo \ common \ serialize \ hessian2 \ Hessian2SerializerFactory . java \n + import org . apache . dubbo . common . config . ConfigurationUtils ; \n + import org . apache . dubbo . common . utils . StringUtils ; \n + \n + private static final String WHITELIST = "" dubbo . application . hessian2 . whitelist "" ; \n + private static final String ALLOW = "" dubbo . application . hessian2 . allow "" ; \n + private static final String DENY = "" dubbo . application . hessian2 . deny "" ; \n + \n + public static final SerializerFactory SERIALIZER _ FACTORY ; \n - public static final SerializerFactory SERIALIZER _ FACTORY = new Hessian2SerializerFactory ( ) ; \n + / * * \n + * see https : / / github . com / ebourg / hessian / commit / cf851f5131707891e723f7f6a9718c2461aed826 \n + * / \n + static { \n + SERIALIZER _ FACTORY = new Hessian2SerializerFactory ( ) ; \n + String whiteList = ConfigurationUtils . getProperty ( WHITELIST ) ; \n + if ( "" true "" . equals ( whiteList ) ) { \n + SERIALIZER _ FACTORY . getClassFactory ( ) . setWhitelist ( true ) ; \n + String allowPattern = ConfigurationUtils . getProperty ( ALLOW ) ; \n + if ( StringUtils . isNotEmpty ( allowPattern ) ) { \n + SERIALIZER _ FACTORY . getClassFactory ( ) . allow ( allowPattern ) ; \n + } \n + } else { \n + SERIALIZER _ FACTORY . getClassFactory ( ) . setWhitelist ( false ) ; \n + String denyPattern = ConfigurationUtils . getProperty ( DENY ) ; \n + if ( StringUtils . isNotEmpty ( denyPattern ) ) { \n + SERIALIZER _ FACTORY . getClassFactory ( ) . deny ( denyPattern ) ; \n + } \n + } \n + } \n",Hessian2 whitelist ( # 6378 ) \n fixes # 6364,634
"dubbo - configcenter \ dubbo - configcenter - consul \ src \ main \ java \ org \ apache \ dubbo \ configcenter \ consul \ ConsulDynamicConfiguration . java \n - return kvClient . getValueAsString ( key , Charsets . UTF _ 8 ) . orElseThrow ( ( ) - > new IllegalArgumentException ( key + "" does not exit . "" ) ) ; \n + return kvClient . getValueAsString ( key , Charsets . UTF _ 8 ) . orElse ( null ) ; \n dubbo - configcenter \ dubbo - configcenter - consul \ src \ test \ java \ org \ apache \ dubbo \ configcenter \ consul \ ConsulDynamicConfigurationTest . java \n - Assertions . assertThrows ( IllegalArgumentException . class , ( ) - > configuration . getConfig ( "" not - exist "" , "" dubbo "" ) ) ; \n + Assertions . assertNull ( configuration . getConfig ( "" not - exist "" , "" dubbo "" ) ) ; \n","Fix consul , getproperty return null if key does not match a value . ( # 5850 )",634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ extension \ ExtensionLoader . java \n - return ( ExtensionLoader < T > ) EXTENSION _ LOADERS . computeIfAbsent ( type , k - > new ExtensionLoader < T > ( type ) ) ; \n + \n + ExtensionLoader < T > loader = ( ExtensionLoader < T > ) EXTENSION _ LOADERS . get ( type ) ; \n + if ( loader = = null ) { \n + EXTENSION _ LOADERS . putIfAbsent ( type , new ExtensionLoader < T > ( type ) ) ; \n + loader = ( ExtensionLoader < T > ) EXTENSION _ LOADERS . get ( type ) ; \n + } \n + return loader ; \n",revert computeIfAbsent for jdk related bug : ( # 6032 ) \n https : / / bugs . openjdk . java . net / browse / JDK - 8062841,634
dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistryFactory . java \n + import java . util . LinkedList ; \n - return Collections . unmodifiableCollection ( REGISTRIES . values ( ) ) ; \n + return Collections . unmodifiableCollection ( new LinkedList < > ( REGISTRIES . values ( ) ) ) ; \n,fix potential ConcurrentModificationException ( # 6031 ) \n fixes # 6027,634
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ utils \ NetUtils . java \n + for ( NetworkInterface networkInterface : validNetworkInterfaces ) { \n + Enumeration < InetAddress > addresses = networkInterface . getInetAddresses ( ) ; \n + while ( addresses . hasMoreElements ( ) ) { \n + Optional < InetAddress > addressOp = toValidAddress ( addresses . nextElement ( ) ) ; \n + if ( addressOp . isPresent ( ) ) { \n + try { \n + if ( addressOp . get ( ) . isReachable ( 100 ) ) { \n + result = networkInterface ; \n + break ; \n + } \n + } catch ( IOException e ) { \n + / / ignore \n + } \n + } \n + } \n + } \n + } \n + \n + if ( result = = null ) { \n,pick the first valid interface address before choosing 127 . 0 . 0 . 1 ( # 6211 ) \n * pick the first valid interface address before choosing 127 . 0 . 0 . 1,634
dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ ServiceBean . java \n - if ( StringUtils . isNotEmpty ( beanName ) \n - & & StringUtils . isNotEmpty ( getInterface ( ) ) \n - & & beanName . startsWith ( getInterface ( ) ) ) { \n - setPath ( beanName ) ; \n + if ( StringUtils . isNotEmpty ( getInterface ( ) ) ) { \n + setPath ( getInterface ( ) ) ; \n,use interface name as path ( # 6212 ) \n * use interface name as path ( # 6212 ),634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ support \ MockInvoker . java \n + import org . apache . dubbo . common . extension . ExtensionFactory ; \n - if ( ConfigUtils . isDefault ( mockService ) ) { \n + boolean isDefault = ConfigUtils . isDefault ( mockService ) ; \n + if ( isDefault ) { \n - Class < ? > mockClass = ReflectUtils . forName ( mockService ) ; \n - if ( ! serviceType . isAssignableFrom ( mockClass ) ) { \n + Class < ? > mockClass ; \n + try { \n + mockClass = ReflectUtils . forName ( mockService ) ; \n + } catch ( Exception e ) { \n + if ( ! isDefault ) { / / does not check Spring bean if it is default config . \n + ExtensionFactory extensionFactory = \n + ExtensionLoader . getExtensionLoader ( ExtensionFactory . class ) . getAdaptiveExtension ( ) ; \n + Object obj = extensionFactory . getExtension ( serviceType , mockService ) ; \n + if ( obj ! = null ) { \n + return obj ; \n + } \n + } \n + throw new IllegalStateException ( "" Did not find mock class or instance "" \n + + mockService \n + + "" , please check if there ' s mock class or instance implementing interface "" \n + + serviceType . getName ( ) , e ) ; \n + } \n + if ( mockClass = = null | | ! serviceType . isAssignableFrom ( mockClass ) ) { \n",Support spring bean as mock value ( # 6188 ) \n * support mock impl as spring bean,634
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ AttachmentsAdapter . java \n + for ( Entry < String , Object > entry : attachments . entrySet ( ) ) { \n + String converResult = convert ( entry . getValue ( ) ) ; \n + if ( converResult ! = null ) { \n + super . put ( entry . getKey ( ) , converResult ) ; \n + } \n + } \n - @ Override \n - public String get ( Object key ) { \n - Object obj = attachments . get ( key ) ; \n - return convert ( obj ) ; \n - } \n - \n - Object obj = attachments . put ( key , value ) ; \n - return convert ( obj ) ; \n + attachments . put ( key , value ) ; \n + return super . put ( key , value ) ; \n - Object obj = attachments . remove ( key ) ; \n - return convert ( obj ) ; \n + attachments . remove ( key ) ; \n + return super . remove ( key ) ; \n - } \n - \n - public static class StringToObjectMap extends HashMap < String , Object > { \n - private Map < String , String > attachments ; \n - \n - public StringToObjectMap ( Map < String , String > attachments ) { \n - this . attachments = attachments ; \n - } \n - public Object get ( Object key ) { \n - return attachments . get ( key ) ; \n - } \n - \n - @ Override \n - public Object put ( String key , Object value ) { \n - if ( value instanceof String ) { \n - return attachments . put ( key , ( String ) value ) ; \n - } \n - return null ; / / or JSON . toString ( obj ) ; \n + public void clear ( ) { \n + attachments . clear ( ) ; \n + super . clear ( ) ; \n - public Object remove ( Object key ) { \n - return attachments . remove ( key ) ; \n + public void putAll ( Map < ? extends String , ? extends String > map ) { \n + attachments . putAll ( map ) ; \n + super . putAll ( map ) ; \n - } \n + } \n",fix object attachments iteration bug ( # 6210 ) \n * fix object attachments iteration bug,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ MethodConfig . java \n - if ( StringUtils . isEmpty ( id ) ) { \n - id = name ; \n - } \n + / / FIXME , add id strategy in ConfigManager \n + / / if ( StringUtils . isEmpty ( id ) ) { \n + / / id = name ; \n + / / } \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfigBase . java \n - if ( StringUtils . isEmpty ( id ) ) { \n - id = interfaceName ; \n - } \n + / / FIXME , add id strategy in ConfigManager \n + / / if ( StringUtils . isEmpty ( id ) ) { \n + / / id = interfaceName ; \n + / / } \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfigBase . java \n - if ( StringUtils . isEmpty ( id ) ) { \n - id = interfaceName ; \n - } \n + / / FIXME , add id strategy in ConfigManager \n + / / if ( StringUtils . isEmpty ( id ) ) { \n + / / id = interfaceName ; \n + / / } \n",do not set default id ( # 6236 ),634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ RegistryConfig . java \n + import static org . apache . dubbo . common . constants . RemotingConstants . BACKUP _ KEY ; \n - updateParameters ( url . getParameters ( ) ) ; \n + Map < String , String > params = url . getParameters ( ) ; \n + params . remove ( BACKUP _ KEY ) ; \n + updateParameters ( params ) ; \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n + import static org . apache . dubbo . common . constants . CommonConstants . REGISTRY _ SPLIT _ PATTERN ; \n - cc . setAddress ( registryConfig . getAddress ( ) ) ; \n + cc . setAddress ( getRegistryCompatibleAddress ( registryConfig . getAddress ( ) ) ) ; \n + private String getRegistryCompatibleAddress ( String registryAddress ) { \n + String [ ] addresses = REGISTRY _ SPLIT _ PATTERN . split ( registryAddress ) ; \n + if ( addresses = = null | | addresses . length = = 0 ) { \n + throw new IllegalStateException ( "" Invalid registry address found . "" ) ; \n + } \n + return addresses [ 0 ] ; \n + } \n + \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ utils \ ConfigValidationUtils . java \n + import static org . apache . dubbo . common . constants . RemotingConstants . BACKUP _ KEY ; \n - checkNameHasSymbol ( entry . getKey ( ) , entry . getValue ( ) ) ; \n + if ( ! entry . getKey ( ) . equals ( BACKUP _ KEY ) ) { \n + checkNameHasSymbol ( entry . getKey ( ) , entry . getValue ( ) ) ; \n + } \n","support multiple address format ( # 6209 ) \n < dubbo : registry address = "" zookeeper : / / 127 . 0 . 0 . 1 : 2181 ? backup = 127 . 0 . 0 . 1 : 2181 | zookeeper : / / 127 . 0 . 0 . 1 : 2183 "" / >",634
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfigBase . java \n - public void exported ( ) { \n - \n - } \n - \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + \n + exported ( ) ; \n + } \n + \n + public void exported ( ) { \n + / / dispatch a ServiceConfigExportedEvent since 2 . 7 . 4 \n + dispatch ( new ServiceConfigExportedEvent ( this ) ) ; \n - \n - / / dispatch a ServiceConfigExportedEvent since 2 . 7 . 4 \n - dispatch ( new ServiceConfigExportedEvent ( this ) ) ; \n,publish event when exported . ( # 5715 ),634
dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ rpc \ model \ ConsumerModel . java \n - Class [ ] interfaceList = serviceMetadata . getTarget ( ) . getClass ( ) . getInterfaces ( ) ; \n + Class [ ] interfaceList = null ; \n + if ( proxyObject = = null ) { \n + interfaceList = new Class [ ] { referenceConfig . getActualInterface ( ) } ; \n + } else { \n + interfaceList = proxyObject . getClass ( ) . getInterfaces ( ) ; \n + } \n,fix NPE when check = false is set and provider is empty . ( # 6376 ) \n fixes # 6228,634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ support \ registry \ ZoneAwareClusterInvoker . java \n - import static org . apache . dubbo . common . constants . RegistryConstants . REGISTRY _ KEY ; \n - . getParameter ( REGISTRY _ KEY + "" . "" + PREFERRED _ KEY , false ) ) { \n + . getParameter ( PREFERRED _ KEY , false ) ) { \n - if ( clusterInvoker . isAvailable ( ) & & zone . equals ( clusterInvoker . getRegistryUrl ( ) . getParameter ( REGISTRY _ KEY + "" . "" + ZONE _ KEY ) ) ) { \n + if ( clusterInvoker . isAvailable ( ) & & zone . equals ( clusterInvoker . getRegistryUrl ( ) . getParameter ( ZONE _ KEY ) ) ) { \n","fix # 6529 , set registry zone does not work properly . ( # 6667 )",634
dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ bootstrap \ DubboBootstrap . java \n - cc . setGroup ( registryConfig . getGroup ( ) ) ; \n + if ( StringUtils . isNotEmpty ( registryConfig . getGroup ( ) ) ) { \n + cc . setGroup ( registryConfig . getGroup ( ) ) ; \n + } \n,"fix # 6532 , set config center group when registry group is not null . ( # 6669 )",634
dubbo - compatible \ src \ main \ java \ com \ alibaba \ dubbo \ common \ extension \ ExtensionFactory . java \n + import org . apache . dubbo . common . extension . SPI ; \n + \n + @ SPI \n,add @ SPI annotation ( # 6436 ),634
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ReferenceConfig . java \n + checkInvokerAvailable ( ) ; \n + \n + if ( logger . isInfoEnabled ( ) ) { \n + logger . info ( "" Refer dubbo service "" + interfaceClass . getName ( ) + "" from url "" + invoker . getUrl ( ) ) ; \n + } \n + / / create service proxy \n + return ( T ) PROXY _ FACTORY . getProxy ( invoker , ProtocolUtils . isGeneric ( generic ) ) ; \n + } \n + \n + private void checkInvokerAvailable ( ) throws IllegalStateException { \n + "" to the consumer "" \n + NetUtils . getLocalHost ( ) + "" use dubbo version "" + Version . getVersion ( ) ) ; \n - if ( logger . isInfoEnabled ( ) ) { \n - logger . info ( "" Refer dubbo service "" + interfaceClass . getName ( ) + "" from url "" + invoker . getUrl ( ) ) ; \n - } \n - / / create service proxy \n - return ( T ) PROXY _ FACTORY . getProxy ( invoker , ProtocolUtils . isGeneric ( generic ) ) ; \n",check invoker available status after proxy created . ( # 6435 ),634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 7 - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 7 - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 6 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 7 - SNAPSHOT < / revision > \n,"prepare for next release , change version to 2 . 7 . 7 - SNAPSHOT",634
"dubbo - cluster \ src \ main \ java \ org \ apache \ dubbo \ rpc \ cluster \ support \ MergeableClusterInvoker . java \n - import org . apache . dubbo . common . URL ; \n - log . debug ( "" No available provider for service "" + directory . getUrl ( ) . getServiceKey ( ) + "" on group "" + invoker . getUrl ( ) . getParameter ( GROUP _ KEY ) + "" , will continue to try another group . "" ) ; \n + log . debug ( "" No available provider for service "" + getUrl ( ) . getServiceKey ( ) + "" on group "" + invoker . getUrl ( ) . getParameter ( GROUP _ KEY ) + "" , will continue to try another group . "" ) ; \n - @ Override \n - public URL getUrl ( ) { \n - return directory . getUrl ( ) ; \n - } \n - \n",Fix merge does not work . ( # 5848 ) \n * fix merge does not work,634
". github \ workflows \ build - and - test . yml \n + - name : "" Calculate Dubbo Version "" \n + id : dubbo - version \n + run : | \n + REVISION = ` awk ' / < revision > [ ^ < ] + < \ / revision > / { gsub ( / < revision > | < \ / revision > / , "" "" , $ 1 ) ; print $ 1 ; exit ; } ' . / dubbo / pom . xml ` \n + echo "" : : set - output name = version : : $ REVISION "" \n + echo "" dubbo version : $ REVISION "" \n - name : "" Build Dubbo with Maven "" \n - name : "" Build Dubbo Spring Boot with Maven "" \n - . / mvnw - - batch - mode - - no - transfer - progress clean install - Dmaven . test . skip = true - Dmaven . test . skip . exec = true \n - - name : "" Calculate Dubbo Version "" \n - id : dubbo - version \n - run : | \n - REVISION = ` awk ' / < revision > [ ^ < ] + < \ / revision > / { gsub ( / < revision > | < \ / revision > / , "" "" , $ 1 ) ; print $ 1 ; exit ; } ' . / dubbo / pom . xml ` \n - echo "" : : set - output name = version : : $ REVISION "" \n - echo "" dubbo version : $ REVISION "" \n + . / mvnw - - batch - mode - - no - transfer - progress clean install - Drevision = $ { { steps . dubbo - version . outputs . version } } - Dmaven . test . skip = true - Dmaven . test . skip . exec = true \n","fix spring - boot - starter ci , try using dubbo revision ( # 7296 )",634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 10 - SNAPSHOT < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 10 - SNAPSHOT < / revision > \n pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 10 - SNAPSHOT < / revision > \n,bump version 2 . 7 . 10 - SNAPSHOT,634
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ URLStrParser . java \n + import static org . apache . dubbo . common . constants . CommonConstants . DEFAULT _ KEY _ PREFIX ; \n + if ( valueStart = = valueEnd ) { \n + value = name ; \n + } else { \n + value = decodeComponent ( str , valueStart , valueEnd , false , tempBuf ) ; \n + } \n + / / compatible with lower versions registering "" default . "" keys \n + if ( name . startsWith ( DEFAULT _ KEY _ PREFIX ) ) { \n + params . putIfAbsent ( name . substring ( DEFAULT _ KEY _ PREFIX . length ( ) ) , value ) ; \n + } \n - String name = str . substring ( nameStart , valueStart - 1 ) ; \n + String name = str . substring ( nameStart , valueStart - 1 ) ; \n + if ( valueStart = = valueEnd ) { \n + value = name ; \n + } else { \n + value = str . substring ( valueStart , valueEnd ) ; \n + } \n + / / compatible with lower versions registering "" default . "" keys \n + if ( name . startsWith ( DEFAULT _ KEY _ PREFIX ) ) { \n + params . putIfAbsent ( name . substring ( DEFAULT _ KEY _ PREFIX . length ( ) ) , value ) ; \n + } \n","Interoperability with 2 . 6 . x provider urls having "" default . xxx "" keys ( # 7239 )",634
"deleted file \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ ConfigurationURL . java \n - / * \n - * Licensed to the Apache Software Foundation ( ASF ) under one or more \n - * contributor license agreements . See the NOTICE file distributed with \n - * this work for additional information regarding copyright ownership . \n - * The ASF licenses this file to You under the Apache License , Version 2 . 0 \n - * ( the "" License "" ) ; you may not use this file except in compliance with \n - * the License . You may obtain a copy of the License at \n - * \n - * http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n - * \n - * Unless required by applicable law or agreed to in writing , software \n - * distributed under the License is distributed on an "" AS IS "" BASIS , \n - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n - * See the License for the specific language governing permissions and \n - * limitations under the License . \n - * / \n - package org . apache . dubbo . common ; \n - \n - public class ConfigurationURL extends URL { \n - } \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ common \ URL . java \n + / / ignore the url content following ' # ' \n + int poundIndex = url . indexOf ( ' # ' ) ; \n + if ( poundIndex ! = - 1 ) { \n + url = url . substring ( 0 , poundIndex ) ; \n + } \n",ignore ' # ' when parsing url ( # 7114 ),634
dubbo - registry \ dubbo - registry - zookeeper \ src \ main \ java \ org \ apache \ dubbo \ registry \ zookeeper \ ZookeeperServiceDiscovery . java \n - curatorFramework . create ( ) . forPath ( path ) ; \n + curatorFramework . create ( ) . creatingParentsIfNeeded ( ) . forPath ( path ) ; \n + \n,"fix zk service discovery , create parent node if absent ( # 7304 )",634
dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ ProtocolFilterWrapper . java \n - for ( Filter filter : filters ) { \n + for ( int i = filters . size ( ) - 1 ; i > = 0 ; i - - ) { \n + final Filter filter = filters . get ( i ) ; \n,fix filter chain order ( # 7305 ),634
"dubbo - config \ dubbo - config - spring \ src \ main \ java \ org \ apache \ dubbo \ config \ spring \ beans \ factory \ annotation \ ServiceClassPostProcessor . java \n + import org . apache . dubbo . config . spring . context . DubboBootstrapApplicationListener ; \n + import static com . alibaba . spring . util . BeanRegistrar . registerInfrastructureBean ; \n + / / @ since 2 . 7 . 5 \n + registerInfrastructureBean ( registry , DubboBootstrapApplicationListener . BEAN _ NAME , DubboBootstrapApplicationListener . class ) ; \n + \n","Revert "" remove repeat action of register DubboBootStrapApplicationListener in ServiceClassPostProcessor , it already register in DubboApplicationListenerRegistrar ( # 7000 ) "" ( # 7308 ) \n This reverts commit f75c22c9cd41275101e4a2b08481791a0948eb99 .",634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 8 . 1 < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 8 . 1 < / revision > \n pom . xml \n - < revision > 2 . 7 . 9 - SNAPSHOT < / revision > \n + < revision > 2 . 7 . 8 . 1 < / revision > \n,update pom version to 2 . 7 . 8 . 1,634
"dubbo - remoting \ dubbo - remoting - api \ src \ main \ java \ org \ apache \ dubbo \ remoting \ transport \ CodecSupport . java \n - Byte id = SERIALIZATIONNAME _ ID _ MAP . get ( name ) ; \n - if ( id = = null ) { \n - throw new RuntimeException ( "" No extension find for serialization name "" + name ) ; \n - } \n - return id ; \n + return SERIALIZATIONNAME _ ID _ MAP . get ( name ) ; \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ AbstractInvoker . java \n - invocation . put ( SERIALIZATION _ ID _ KEY , CodecSupport . getIDByName ( getUrl ( ) . getParameter ( SERIALIZATION _ KEY , DEFAULT _ REMOTING _ SERIALIZATION ) ) ) ; \n + Byte serializationId = CodecSupport . getIDByName ( getUrl ( ) . getParameter ( SERIALIZATION _ KEY , DEFAULT _ REMOTING _ SERIALIZATION ) ) ; \n + if ( serializationId ! = null ) { \n + invocation . put ( SERIALIZATION _ ID _ KEY , serializationId ) ; \n + } \n","check serialization not null before set , too many uts to fix",634
dubbo - dependencies - bom \ pom . xml \n - < revision > 2 . 7 . 8 . 1 < / revision > \n + < revision > 2 . 7 . 9 < / revision > \n dubbo - dependencies \ dubbo - dependencies - zookeeper \ pom . xml \n - < revision > 2 . 7 . 8 . 1 < / revision > \n + < revision > 2 . 7 . 9 < / revision > \n pom . xml \n - < revision > 2 . 7 . 8 . 1 < / revision > \n + < revision > 2 . 7 . 9 < / revision > \n,change pom version to 2 . 7 . 9,634
"transport \ src \ main \ java \ io \ netty \ channel \ nio \ NioEventLoop . java \n - private static final boolean DISABLE _ KEYSET _ OPTIMIZATION = \n + private static final boolean DISABLE _ KEY _ SET _ OPTIMIZATION = \n - final String buglevel = SystemPropertyUtil . get ( key ) ; \n - if ( buglevel = = null ) { \n + final String bugLevel = SystemPropertyUtil . get ( key ) ; \n + if ( bugLevel = = null ) { \n - logger . debug ( "" - Dio . netty . noKeySetOptimization : { } "" , DISABLE _ KEYSET _ OPTIMIZATION ) ; \n + logger . debug ( "" - Dio . netty . noKeySetOptimization : { } "" , DISABLE _ KEY _ SET _ OPTIMIZATION ) ; \n - if ( DISABLE _ KEYSET _ OPTIMIZATION ) { \n + if ( DISABLE _ KEY _ SET _ OPTIMIZATION ) { \n",Use camel - case in NioEventLoop ( # 8713 ) \n Motivation : \n Java uses camel - case by convention . \n Modification : \n Consistently use camel - case . \n Result : \n More consistent code styling .,636
"common \ src \ main \ java \ io \ netty \ util \ concurrent \ SingleThreadEventExecutor . java \n - if ( oldState = = ST _ NOT _ STARTED ) { \n - try { \n - doStartThread ( ) ; \n - } catch ( Throwable cause ) { \n - STATE _ UPDATER . set ( this , ST _ TERMINATED ) ; \n - terminationFuture . tryFailure ( cause ) ; \n - \n - if ( ! ( cause instanceof Exception ) ) { \n - / / Also rethrow as it may be an OOME for example \n - PlatformDependent . throwException ( cause ) ; \n - } \n - return terminationFuture ; \n - } \n + if ( ensureThreadStarted ( oldState ) ) { \n + return terminationFuture ; \n - if ( oldState = = ST _ NOT _ STARTED ) { \n - try { \n - doStartThread ( ) ; \n - } catch ( Throwable cause ) { \n - STATE _ UPDATER . set ( this , ST _ TERMINATED ) ; \n - terminationFuture . tryFailure ( cause ) ; \n - \n - if ( ! ( cause instanceof Exception ) ) { \n - / / Also rethrow as it may be an OOME for example \n - PlatformDependent . throwException ( cause ) ; \n - } \n - return ; \n - } \n + if ( ensureThreadStarted ( oldState ) ) { \n + return ; \n + private boolean ensureThreadStarted ( int oldState ) { \n + if ( oldState = = ST _ NOT _ STARTED ) { \n + try { \n + doStartThread ( ) ; \n + } catch ( Throwable cause ) { \n + STATE _ UPDATER . set ( this , ST _ TERMINATED ) ; \n + terminationFuture . tryFailure ( cause ) ; \n + \n + if ( ! ( cause instanceof Exception ) ) { \n + / / Also rethrow as it may be an OOME for example \n + PlatformDependent . throwException ( cause ) ; \n + } \n + return true ; \n + } \n + } \n + return false ; \n + } \n + \n",extract duplicate code into method ( # 8720 ) \n Motivation : \n Clean up code to increase readability . \n Modification : \n Extract duplicate code blocks into method . \n Result : \n Less code duplication,636
transport \ src \ main \ java \ io \ netty \ channel \ ChannelPipeline . java \n - @ Override \n + @ Override \n,cleanup : fix indent ( # 8734 ) \n Motivation : \n Clean up to make the code style unified . \n Modification : \n Fix indent \n Result : \n Indents are unified,636
"common \ src \ main \ java \ io \ netty \ util \ concurrent \ SingleThreadEventExecutor . java \n - * If the { @ link SingleThreadEventExecutor } is not started yet , this operation will start it and block until the \n + * If the { @ link SingleThreadEventExecutor } is not started yet , this operation will start it and block until \n common \ src \ test \ java \ io \ netty \ util \ concurrent \ SingleThreadEventExecutorTest . java \n - public void testWrappedExecutureIsShutdown ( ) { \n + public void testWrappedExecutorIsShutdown ( ) { \n",fix typo ( # 8741 ) \n Motivation : \n Correct typo \n Modification : \n Correct typo \n Result : \n JavaDoc and method name are more readable,636
"pom . xml \n - - Djava . net . preferIPv4Stack = true \n + - Djava . net . preferIPv4Stack = true - XX : MetaspaceSize = 64m - XX : MaxMetaspaceSize = 128m \n - < profile > \n - < id > java6 < / id > \n - < properties > \n - < maven _ jar _ version > 3 . 0 . 2 < / maven _ jar _ version > \n - < maven _ surefire _ version > 2 . 22 . 1 < / maven _ surefire _ version > \n - < maven _ deploy _ version > 2 . 7 < / maven _ deploy _ version > \n - < maven _ compiler _ version > 3 . 1 < / maven _ compiler _ version > \n - < maven _ source _ version > 3 . 0 . 1 < / maven _ source _ version > \n - < maven _ javadoc _ version > 2 . 10 . 1 < / maven _ javadoc _ version > \n - < / properties > \n - < / profile > \n - < profile > \n - < id > hudson < / id > \n - < build > \n - < plugins > \n - < plugin > \n - < groupId > org . apache . maven . plugins < / groupId > \n - < artifactId > maven - surefire - plugin < / artifactId > \n - < configuration > \n - < testFailureIgnore > true < / testFailureIgnore > \n - < / configuration > \n - < / plugin > \n - < / plugins > \n - < / build > \n - < / profile > \n - < profile > \n - < id > java8 - vm - args < / id > \n - < activation > \n - < jdk > [ 1 . 8 , ) < / jdk > \n - < / activation > \n - < properties > \n - < ! - - Build args - - > \n - < ! - - if you run dubbo on java8 + , please use these vm args - - > \n - < argline > - server - Xms256m - Xmx512m - XX : MetaspaceSize = 64m - XX : MaxMetaspaceSize = 128m - Dfile . encoding = UTF - 8 \n - - Djava . net . preferIPv4Stack = true \n - < / argline > \n - < / properties > \n - < / profile > \n",Clean pom . xml file # 3186 ( # 3211 ) \n * update as requested \n * add meta space size arguments,636
"dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n - ProviderModel providerModel = new ProviderModel ( getUniqueServiceName ( ) , ref , interfaceClass ) ; \n - ApplicationModel . initProviderModel ( getUniqueServiceName ( ) , providerModel ) ; \n + String uniqueServiceName = getUniqueServiceName ( ) ; \n + ProviderModel providerModel = new ProviderModel ( uniqueServiceName , ref , interfaceClass ) ; \n + ApplicationModel . initProviderModel ( uniqueServiceName , providerModel ) ; \n",enhancement : extract duplicated method calls to variable ( # 3482 ) \n extract duplicated method calls to variable,636
dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistry . java \n + import java . util . Collections ; \n - return registered ; \n + return Collections . unmodifiableSet ( registered ) ; \n - return subscribed ; \n + return Collections . unmodifiableMap ( subscribed ) ; \n - return notified ; \n + return Collections . unmodifiableMap ( notified ) ; \n dubbo - registry \ dubbo - registry - api \ src \ test \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistryTest . java \n - abstractRegistry . getRegistered ( ) . clear ( ) ; \n + for ( URL url : abstractRegistry . getRegistered ( ) ) { \n + abstractRegistry . unregister ( url ) ; \n + } \n - abstractRegistry . getRegistered ( ) . add ( url ) ; \n + abstractRegistry . register ( url ) ; \n - abstractRegistry . getRegistered ( ) . clear ( ) ; \n + for ( URL u : abstractRegistry . getRegistered ( ) ) { \n + abstractRegistry . unregister ( u ) ; \n + } \n - abstractRegistry . getRegistered ( ) . add ( urlSub ) ; \n + abstractRegistry . register ( urlSub ) ; \n dubbo - registry \ dubbo - registry - multicast \ src \ test \ java \ org \ apache \ dubbo \ registry \ multicast \ MulticastRegistryTest . java \n - registered . clear ( ) ; \n + for ( URL url : registered ) { \n + registry . unregister ( url ) ; \n + } \n,[ Dubbo - 3106 ] Make getRegistered return unmodifiable collection . # 3106 ( # 3425 ) \n * make getRegistered return unmodifiable collection . # 3106 \n * fix ci failure,636
"dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistry . java \n + import java . util . concurrent . atomic . AtomicInteger ; \n + / / Max times to retry to save properties to local cache file \n + private static final int MAX _ RETRY _ TIMES _ SAVE _ PROPERTIES = 3 ; \n + private final AtomicInteger savePropertiesRetryTimes = new AtomicInteger ( ) ; \n + savePropertiesRetryTimes . incrementAndGet ( ) ; \n + if ( savePropertiesRetryTimes . get ( ) > = MAX _ RETRY _ TIMES _ SAVE _ PROPERTIES ) { \n + logger . warn ( "" Failed to save registry cache file after retrying "" + MAX _ RETRY _ TIMES _ SAVE _ PROPERTIES + "" times , cause : "" + e . getMessage ( ) , e ) ; \n + savePropertiesRetryTimes . set ( 0 ) ; \n + return ; \n + } \n + savePropertiesRetryTimes . set ( 0 ) ; \n - logger . warn ( "" Failed to save registry cache file , cause : "" + e . getMessage ( ) , e ) ; \n + logger . warn ( "" Failed to save registry cache file , will retry , cause : "" + e . getMessage ( ) , e ) ; \n",[ DUBBO - 3746 ] Bugfix : infinite loop in AbstractRegistry when IOException . fix # 3746 ( # 3748 ),636
"CHANGES . md \n - Simplified registry URL . With lower Registry memory use and less notification pressure from Service Directory , separates Configuration notification from Service Discovery . \n - - Metadata Center . A totally new concept since 2 . 7 . 0 , used to store service metadata including static configuration , service definition , method signature , etc . . By default , Zookeeper and Redis are supported as the backend storage . Will work as the basis of service testing , mock and other service governance features going to be supported in OPS . \n + - Metadata Center . A totally new concept since 2 . 7 . 0 , used to store service metadata including static configuration , service definition , method signature , etc . . By default , Zookeeper and Redis are supported as the backend storage . Will work as the basis of service testing , mock and other service governance features going to be supported in [ Dubbo - Admin ] ( https : / / github . com / apache / incubator - dubbo - admin ) . \n - Asynchronous Programming Model ( only works for Dubbo protocol now ) \n - Built - in support for the method with CompletableFuture < T > signature . \n README . md \n - * Improve the [ dubbo - ops / dubbo - monitor ] ( https : / / github . com / apache / incubator - dubbo - ops ) . \n + * Improve the [ dubbo - admin / dubbo - monitor ] ( https : / / github . com / apache / incubator - dubbo - admin ) . \n - * [ Dubbo OPS ] ( https : / / github . com / apache / incubator - dubbo - ops ) - The reference implementation for Dubbo admin \n + * [ Dubbo Admin ] ( https : / / github . com / apache / incubator - dubbo - admin ) - The reference implementation for Dubbo admin \n",rename dubbo - ops to dubbo - admin ( # 3628 ),636
guava \ src \ com \ google \ common \ collect \ ImmutableSet . java \n + import com . google . j2objc . annotations . RetainedWith ; \n + @ RetainedWith \n,Adds @ RetainedWith to ImmutableSet . asList to prevent the reference cycle from \n causing leaks in Objective - C . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 140738410,639
guava \ src \ com \ google \ common \ collect \ MapMakerInternalMap . java \n - final E entry ; \n + @ Weak final E entry ; \n,Fixes a reference cycle between WeakValueEntry instances and their \n WeakValueReference . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 137989327,639
guava \ src \ com \ google \ common \ collect \ RegularImmutableAsList . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final ImmutableCollection < E > delegate ; \n + private final ImmutableCollection < E > delegate ; \n,Removes unnecessary ( and unsafe ) @ Weak annotation that is causing crashes on \n iOS . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 138077107,639
"android \ guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n + import com . google . j2objc . annotations . RetainedWith ; \n - @ LazyInit private transient ImmutableSet < K > keySet ; \n + @ LazyInit @ RetainedWith private transient ImmutableSet < K > keySet ; \n android \ guava \ src \ com \ google \ common \ collect \ ImmutableMapKeySet . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final ImmutableMap < K , V > map ; \n + private final ImmutableMap < K , V > map ; \n guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n + import com . google . j2objc . annotations . RetainedWith ; \n - @ LazyInit private transient ImmutableSet < K > keySet ; \n + @ LazyInit @ RetainedWith private transient ImmutableSet < K > keySet ; \n guava \ src \ com \ google \ common \ collect \ ImmutableMapKeySet . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final ImmutableMap < K , V > map ; \n + private final ImmutableMap < K , V > map ; \n guava \ src \ com \ google \ common \ collect \ RegularImmutableMap . java \n - @ Weak private final RegularImmutableMap < K , V > map ; \n + private final RegularImmutableMap < K , V > map ; \n",Use J2ObjC ' s @ RetainedWith annotation instead of @ Weak on ImmutableMap . keySet \n to prevent crashes on iOS . \n TESTED = Created a map inside a autorelease pool and saved a reference to the \n keyset . Checked that the keyset functions correctly outside the autorelease \n pool . Checked that both the keyset and the map are deallocated by the \n autorelease pool when not holding a reference to the keyset . Did this test with \n both ImmutableMap . of ( < 2 entries > ) and ImmutableBiMap . of ( < 2 entries > ) . \n RELNOTES = J2ObjC : Fixes crashes from use of ` ImmutableMap . keySet ( ) ` . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 233811320,639
"android \ guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n - @ LazyInit private transient ImmutableCollection < V > values ; \n + @ LazyInit @ RetainedWith private transient ImmutableCollection < V > values ; \n android \ guava \ src \ com \ google \ common \ collect \ ImmutableMapValues . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final ImmutableMap < K , V > map ; \n + private final ImmutableMap < K , V > map ; \n guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n - @ LazyInit private transient ImmutableCollection < V > values ; \n + @ LazyInit @ RetainedWith private transient ImmutableCollection < V > values ; \n guava \ src \ com \ google \ common \ collect \ ImmutableMapValues . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final ImmutableMap < K , V > map ; \n + private final ImmutableMap < K , V > map ; \n guava \ src \ com \ google \ common \ collect \ RegularImmutableMap . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak final RegularImmutableMap < K , V > map ; \n + final RegularImmutableMap < K , V > map ; \n",Use J2ObjC ' s @ RetainedWith annotation instead of @ Weak on ImmutableMap . values \n to prevent crashes on iOS . \n TESTED = Created a map inside an autorelease pool and saved a reference to the \n values collection . Checked that the values collection functions correctly \n outside the autorelease pool . Checked that both the values collection and the \n map are deallocated by the autorelease pool when not holding a strong reference \n to the values collection . Did this test with ImmutableMap . of ( < 2 entries > ) and \n ImmutableMap . copyOf ( < EnumMap with 2 entries > ) . \n RELNOTES = J2ObjC : Fixes crashes from use of ` ImmutableMap . values ( ) ` . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 235206171,639
"android \ guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n - @ WeakOuter \n - @ LazyInit private transient ImmutableSet < Entry < K , V > > entrySet ; \n + @ LazyInit @ RetainedWith private transient ImmutableSet < Entry < K , V > > entrySet ; \n android \ guava \ src \ com \ google \ common \ collect \ ImmutableMapEntrySet . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final transient ImmutableMap < K , V > map ; \n + private final transient ImmutableMap < K , V > map ; \n android \ guava \ src \ com \ google \ common \ collect \ ImmutableSortedMap . java \n - import com . google . j2objc . annotations . WeakOuter ; \n - @ WeakOuter \n guava \ src \ com \ google \ common \ collect \ ImmutableMap . java \n - @ WeakOuter \n - @ LazyInit private transient ImmutableSet < Entry < K , V > > entrySet ; \n + @ LazyInit @ RetainedWith private transient ImmutableSet < Entry < K , V > > entrySet ; \n guava \ src \ com \ google \ common \ collect \ ImmutableMapEntrySet . java \n - import com . google . j2objc . annotations . Weak ; \n - @ Weak private final transient ImmutableMap < K , V > map ; \n + private final transient ImmutableMap < K , V > map ; \n guava \ src \ com \ google \ common \ collect \ ImmutableSortedMap . java \n - import com . google . j2objc . annotations . WeakOuter ; \n - @ WeakOuter \n guava \ src \ com \ google \ common \ collect \ RegularImmutableBiMap . java \n - import com . google . j2objc . annotations . WeakOuter ; \n - @ WeakOuter \n",Use J2ObjC ' s @ RetainedWith annotation instead of @ Weak on \n ImmutableMap . entrySet ( ) to prevent crashes on iOS . \n TESTED = Created a map inside an autorelease pool and saved a reference to the \n entry set . Checked that the entry set functions correctly outside the \n autorelease pool . Checked that both the entry set and the are deallocated by the \n autorelease pool when not holding a strong reference to the entry set . Did this \n test with the following constructions to cover all entry set implementations : \n - ImmutableMap . of ( < 2 entries > ) \n - ImmutableMap . copyOf ( < EnumMap with 2 entries > ) \n - ImmutableSortedMap . of ( < 2 entries > ) \n - ImmutableBiMap . of ( < 2 entries > ) . inverse ( ) \n RELNOTES = J2ObjC : Fixes crashes from use of ImmutableMap . entrySet ( ) . \n - - - - - - - - - - - - - \n Created by MOE : https : / / github . com / google / moe \n MOE _ MIGRATED _ REVID = 237300208,639
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerSpawnRunner . java \n - + "" - - experimentalJsonWorkerProtocol is used "" ) ; \n + + "" - - experimental _ allow _ json _ worker _ protocol is used "" ) ; \n",Use actual name of flag in error message . \n RELNOTES : n / a \n PiperOrigin - RevId : 335055802,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ util \ SimpleLogHandler . java \n + import java . io . InterruptedIOException ; \n + / / This allows us to do the I / O while not forgetting that we were interrupted . \n + boolean isInterrupted = Thread . interrupted ( ) ; \n + if ( e instanceof InterruptedIOException ) { \n + isInterrupted = true ; \n + } \n + if ( e instanceof InterruptedIOException ) { \n + isInterrupted = true ; \n + } \n + } \n + if ( isInterrupted ) { \n + Thread . currentThread ( ) . interrupt ( ) ; \n + boolean isInterrupted = Thread . interrupted ( ) ; \n + if ( e instanceof InterruptedIOException ) { \n + isInterrupted = true ; \n + } \n + if ( isInterrupted ) { \n + Thread . currentThread ( ) . interrupt ( ) ; \n + } \n + boolean isInterrupted = Thread . interrupted ( ) ; \n + if ( e instanceof InterruptedIOException ) { \n + isInterrupted = true ; \n + } \n + if ( e instanceof InterruptedIOException ) { \n + isInterrupted = true ; \n + } \n + if ( isInterrupted ) { \n + Thread . currentThread ( ) . interrupt ( ) ; \n + } \n src \ test \ java \ com \ google \ devtools \ build \ lib \ util \ SimpleLogHandlerTest . java \n + \n + @ Test \n + public void publish _ handlesInterrupt ( ) throws Exception { \n + SimpleLogHandler handler = \n + SimpleLogHandler . builder ( ) \n + . setPrefix ( tmp . getRoot ( ) + File . separator + "" hello "" ) \n + . setFormatter ( new TrivialFormatter ( ) ) \n + . build ( ) ; \n + Thread t = \n + new Thread ( \n + ( ) - > { \n + Thread . currentThread ( ) . interrupt ( ) ; \n + handler . publish ( new LogRecord ( Level . SEVERE , "" Hello world "" ) ) ; / / To open the log file . \n + assertThat ( Thread . currentThread ( ) . isInterrupted ( ) ) . isTrue ( ) ; \n + handler . flush ( ) ; \n + assertThat ( Thread . currentThread ( ) . isInterrupted ( ) ) . isTrue ( ) ; \n + handler . close ( ) ; \n + assertThat ( Thread . currentThread ( ) . isInterrupted ( ) ) . isTrue ( ) ; \n + } ) ; \n + t . run ( ) ; \n + t . join ( ) ; \n + } \n",Make SimpleLogHandler not swallow interrupts . \n RELNOTES : n / a \n PiperOrigin - RevId : 346163236,640
src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerFactory . java \n - logFile ) ) ) ; \n + worker . getLogFile ( ) ) ) ) ; \n,Output the correct logfile for multiplex workers when using - - worker _ verbose . \n RELNOTES : n / a \n PiperOrigin - RevId : 336038952,640
src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerPoolTest . java \n - for ( int tries = 0 ; tries < 10 ; tries + + ) { \n + for ( int tries = 0 ; tries < 1000 ; tries + + ) { \n - for ( int tries = 0 ; tries < 10 ; tries + + ) { \n + for ( int tries = 0 ; tries < 1000 ; tries + + ) { \n,Increase number of tries for testing multithreading . \n RELNOTES : none \n PiperOrigin - RevId : 326613543,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerModule . java \n + options = env . getOptions ( ) . getOptions ( WorkerOptions . class ) ; \n + options . workerMultiplex , \n src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerSpawnRunner . java \n + private final boolean multiplex ; \n + boolean multiplex , \n + this . multiplex = multiplex ; \n - Spawns . supportsMultiplexWorkers ( spawn ) , \n + multiplex & & Spawns . supportsMultiplexWorkers ( spawn ) , \n src \ test \ shell \ integration \ bazel _ worker _ multiplexer _ test . sh \n + add _ to _ bazelrc "" build - - experimental _ worker _ multiplex "" \n",Start using the experimental _ worker _ multiplex flag . \n RELNOTES : Puts the experimental _ worker _ multiplex flag to use . \n PiperOrigin - RevId : 327794094,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ cpp \ LinkBuildVariables . java \n - \n - LIBRARY _ INSTALL _ NAME ( "" library _ install _ name "" ) , \n - PathFragment frag = PathFragment . create ( outputFile ) ; \n - buildVariables . addStringVariable ( LIBRARY _ INSTALL _ NAME . getVariableName ( ) , frag . getBaseName ( ) ) ; \n",Automated rollback of commit 6186ee21b349a987da212986c3681574f21168e0 . \n * * * Reason for rollback * * * \n Introduces memory regression across multiple sentinels . \n * * * Original change description * * * \n Add a build variable for - install _ name / - soname . \n ' library _ install _ name ' seemed generic enough . \n RELNOTES : Add a build variable for - install _ name / - soname . \n PiperOrigin - RevId : 331568616,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ java \ JavaToolchainRule . java \n - . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( false ) ) \n + . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( true ) ) \n src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ ExampleWorker . java \n - WorkResponse . newBuilder ( ) . setOutput ( baos . toString ( ) ) . setExitCode ( exitCode ) . build ( ) ; \n + WorkResponse . newBuilder ( ) \n + . setOutput ( baos . toString ( ) ) \n + . setExitCode ( exitCode ) \n + . setRequestId ( request . getRequestId ( ) ) \n + . build ( ) ; \n src \ test \ shell \ integration \ bazel _ worker _ test . sh \n + add _ to _ bazelrc "" build - - noexperimental _ worker _ multiplex "" \n",Turns on multiplex workers in Java toolchain rule . \n RELNOTES : Javac now supports multiplex workers . \n PiperOrigin - RevId : 333464218,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ java \ JavaToolchainRule . java \n - . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( true ) ) \n + . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( false ) ) \n src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ ExampleWorker . java \n - WorkResponse . newBuilder ( ) \n - . setOutput ( baos . toString ( ) ) \n - . setExitCode ( exitCode ) \n - . setRequestId ( request . getRequestId ( ) ) \n - . build ( ) ; \n + WorkResponse . newBuilder ( ) . setOutput ( baos . toString ( ) ) . setExitCode ( exitCode ) . build ( ) ; \n src \ test \ shell \ integration \ bazel _ worker _ test . sh \n - add _ to _ bazelrc "" build - - noexperimental _ worker _ multiplex "" \n","Automated rollback of commit aab567cbde4f1817b598207d99a93393dad4a094 . \n * * * Reason for rollback * * * \n Saw regression of 10 % on a normal machine , up to 50 % on a manycore machine . \n * * * Original change description * * * \n Turns on multiplex workers in Java toolchain rule . \n RELNOTES : Javac now supports multiplex workers . \n PiperOrigin - RevId : 333531421",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerMultiplexer . java \n - recordingStream = new RecordingInputStream ( process . getInputStream ( ) ) ; \n + Subprocess p = this . process ; \n + if ( p = = null | | ! p . isAlive ( ) ) { \n + / / Avoid busy - wait for a new process . \n + Thread . sleep ( 1 ) ; \n + return ; \n + } \n + recordingStream = new RecordingInputStream ( p . getInputStream ( ) ) ; \n - return process ! = null & & ! process . isAlive ( ) & & ! isInterrupted ; \n + Subprocess p = this . process ; / / Protects against this . process getting null . \n + return p ! = null & & ! p . isAlive ( ) & & ! isInterrupted ; \n - return process ! = null & & ! process . isAlive ( ) \n - ? Optional . of ( process . exitValue ( ) ) \n - : Optional . empty ( ) ; \n + Subprocess p = this . process ; / / Protects against this . process getting null . \n + return p ! = null & & ! p . isAlive ( ) ? Optional . of ( p . exitValue ( ) ) : Optional . empty ( ) ; \n src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ TestUtils . java \n - return wasDestroyed ; \n + return ! wasDestroyed ; \n src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerMultiplexerTest . java \n - / / Responses can arrive out of order \n + / / Responses can arrive out of order , and before the workerproxies are ready to get them . \n","Prevent reads from this . process when this . process can be async updated . \n Only synchronized methods can write to this . process , and we don ' t want to synchronize too much . \n Also fixes the isAlive method in FakeSubprocess . \n RELNOTES : n / a \n PiperOrigin - RevId : 341587731",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ JsonWorkerProtocol . java \n - JsonWorkerProtocol ( InputStream stdin , OutputStream stdout ) { \n + JsonWorkerProtocol ( OutputStream workersStdin , InputStream workersStdout ) { \n - jsonWriter = new BufferedWriter ( new OutputStreamWriter ( stdout , UTF _ 8 ) ) ; \n - reader = new JsonReader ( new BufferedReader ( new InputStreamReader ( stdin , UTF _ 8 ) ) ) ; \n + jsonWriter = new BufferedWriter ( new OutputStreamWriter ( workersStdin , UTF _ 8 ) ) ; \n + reader = new JsonReader ( new BufferedReader ( new InputStreamReader ( workersStdout , UTF _ 8 ) ) ) ; \n src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ ProtoWorkerProtocol . java \n - / * * The worker process ' s stdin * / \n - private final InputStream stdin ; \n + / * * The worker process ' s stdin , which we send requests to . * / \n + private final OutputStream workersStdin ; \n - / * * The worker process ' s stdout . * / \n - private final OutputStream stdout ; \n + / * * The worker process ' s stdout , which we read responses from . * / \n + private final InputStream workersStdout ; \n - public ProtoWorkerProtocol ( InputStream stdin , OutputStream stdout ) { \n - this . stdin = stdin ; \n - this . stdout = stdout ; \n + public ProtoWorkerProtocol ( OutputStream workersStdin , InputStream workersStdout ) { \n + this . workersStdin = workersStdin ; \n + this . workersStdout = workersStdout ; \n - request . writeDelimitedTo ( stdout ) ; \n - stdout . flush ( ) ; \n + request . writeDelimitedTo ( workersStdin ) ; \n + workersStdin . flush ( ) ; \n - return WorkResponse . parseDelimitedFrom ( stdin ) ; \n + return WorkResponse . parseDelimitedFrom ( workersStdout ) ; \n src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ Worker . java \n - workerProtocol = new JsonWorkerProtocol ( recordingInputStream , process . getOutputStream ( ) ) ; \n + workerProtocol = new JsonWorkerProtocol ( process . getOutputStream ( ) , recordingInputStream ) ; \n - workerProtocol = new ProtoWorkerProtocol ( recordingInputStream , process . getOutputStream ( ) ) ; \n + workerProtocol = new ProtoWorkerProtocol ( process . getOutputStream ( ) , recordingInputStream ) ; \n","Clarify naming of inputs and outputs . \n Rearranged constructor parameters to follow the logical order of events , that should make it easier to understand . \n PiperOrigin - RevId : 337314034",640
"src \ java _ tools \ buildjar \ java \ com \ google \ devtools \ build \ buildjar \ WorkRequestHandler . java \n - / / Hint to the system that now would be a good time to run a gc . After a compile \n - / / completes lots of objects should be available for collection and it should be cheap to \n - / / collect them . \n - System . gc ( ) ; \n + / / This would be a tempting place to suggest a GC , but it causes a 10 % performance hit . \n",Don ' t call System . gc ( ) in worker after a WorkRequest is done . \n Benchmarks show that removing this call is never worse and often quite a bit better . \n RELNOTES : n / a \n PiperOrigin - RevId : 337592348,640
src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerMultiplexer . java \n + / / The process may have died in the meanwhile ( e . g . between builds ) . \n + if ( this . process ! = null & & ! this . process . isAlive ( ) ) { \n + this . process = null ; \n + } \n + this . process = null ; \n,Null out the process field of WorkerMultiplexer if the process dies . \n Possibly fixes Bazel issue # 10288 . \n RELNOTES : n / a \n PiperOrigin - RevId : 338053292,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ java \ JavaToolchainRule . java \n - . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( false ) ) \n + . add ( attr ( "" javac _ supports _ multiplex _ workers "" , BOOLEAN ) . value ( true ) ) \n src \ test \ java \ com \ google \ devtools \ build \ lib \ worker \ ExampleWorker . java \n - WorkResponse . newBuilder ( ) . setOutput ( baos . toString ( ) ) . setExitCode ( exitCode ) . build ( ) ; \n + WorkResponse . newBuilder ( ) \n + . setOutput ( baos . toString ( ) ) \n + . setExitCode ( exitCode ) \n + . setRequestId ( request . getRequestId ( ) ) \n + . build ( ) ; \n src \ test \ shell \ integration \ bazel _ worker _ test . sh \n + add _ to _ bazelrc "" build - - noexperimental _ worker _ multiplex "" \n","Automated rollback of commit d5d65ec3410e9228f92ba77b730c542f399fec47 . \n * * * Reason for rollback * * * \n Multiplex regression fixed with https : / / github . com / bazelbuild / bazel / commit / 6bf44ba9339a59c852a5da5f72e14bdb87af6483 . To be submitted after next java toolchain release . \n * * * Original change description * * * \n Automated rollback of commit aab567cbde4f1817b598207d99a93393dad4a094 . \n * * * Reason for rollback * * * \n Saw regression of 10 % on a normal machine , up to 50 % on a manycore machine . \n * * * Original change description * * * \n Turns on multiplex workers in Java toolchain rule . \n RELNOTES : Javac now supports multiplex workers . \n PiperOrigin - RevId : 339280531",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerOptions . java \n + \n + @ Option ( \n + name = "" experimental _ worker _ multiplex "" , \n + defaultValue = "" true "" , \n + documentationCategory = OptionDocumentationCategory . UNCATEGORIZED , \n + effectTags = { OptionEffectTag . UNKNOWN } , \n + help = \n + "" Currently a no - op . Future : If enabled , workers that support the experimental "" \n + + "" multiplexing feature will use that feature . "" ) \n + public boolean experimentalWorkerMultiplex ; \n",Add unused experimental flag for enabling worker multiplexing . \n RELNOTES : none \n PiperOrigin - RevId : 326001617,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ dynamic \ DynamicSpawnStrategy . java \n - "" Execution stopped because other strategy finished first "" ) ; \n + String . format ( \n + "" Execution stopped because % s strategy finished first "" , \n + strategyThatCancelled . get ( ) ) ) ; \n - throw new AssertionError ( "" Unexpected exception type from strategy . exec ( ) "" ) ; \n + throw new AssertionError ( \n + String . format ( \n + "" Unexpected exception type % s from strategy . exec ( ) "" , cause . getClass ( ) . getName ( ) ) ) ; \n - "" executorCreated not yet called or no default dynamic _ local _ strategy set "" ) ; \n + String . format ( \n + "" executorCreated not yet called or no default dynamic _ local _ strategy set for % s "" , \n + spawn . getMnemonic ( ) ) ) ; \n - "" executorCreated not yet called or no default dynamic _ remote _ strategy set "" ) ; \n + String . format ( \n + "" executorCreated not yet called or no default dynamic _ remote _ strategy set for % s "" , \n + spawn . getMnemonic ( ) ) ) ; \n",Add a bit more information to exceptions around dynamic strategy failure . \n RELNOTES : none . \n PiperOrigin - RevId : 341780605,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ dynamic \ DynamicExecutionOptions . java \n - defaultValue = "" true "" , \n + defaultValue = "" false "" , \n + "" new version in that this version cannot stop a local spawn once it has started "" \n","Switch legacy _ spawn _ scheduler flag to false . \n The new scheduler works better on well - cached builds , and has been found to give performance improvements from 10 to 50 % internally . \n RELNOTES : Dynamic execution now uses the new scheduler by default . \n PiperOrigin - RevId : 342593974",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ dynamic \ DynamicExecutionOptions . java \n - defaultValue = "" false "" , \n + defaultValue = "" true "" , \n + "" new version in that this version cannot stop a local spawn once it has started "" \n","Automated rollback of commit d9e8c0316239978b071a0a325d8a244c613188ec . \n * * * Reason for rollback * * * \n Causes test failures . \n * * * Original change description * * * \n Switch legacy _ spawn _ scheduler flag to false . \n The new scheduler works better on well - cached builds , and has been found to give performance improvements from 10 to 50 % internally . \n RELNOTES : Dynamic execution now uses the new scheduler by default . \n PiperOrigin - RevId : 342663496",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ dynamic \ DynamicExecutionOptions . java \n - defaultValue = "" true "" , \n + defaultValue = "" false "" , \n + "" new version in that this version cannot stop a local spawn once it has started "" \n src \ main \ java \ com \ google \ devtools \ build \ lib \ dynamic \ DynamicSpawnStrategy . java \n + import com . google . devtools . build . lib . events . Event ; \n + * @ param options The options for dynamic execution . \n + * @ param context The context of this action execution . \n + * @ param spawn The spawn being executed . \n - AtomicReference < DynamicMode > strategyThatCancelled ) \n + AtomicReference < DynamicMode > strategyThatCancelled , \n + DynamicExecutionOptions options , \n + ActionExecutionContext context , \n + Spawn spawn ) \n + if ( options . debugSpawnScheduler ) { \n + context \n + . getEventHandler ( ) \n + . handle ( \n + Event . info ( \n + String . format ( \n + "" % s action finished % sly "" , \n + spawn . getMnemonic ( ) , strategyThatCancelled . get ( ) ) ) ) ; \n + } \n + \n - strategyThatCancelled ) ) ; \n + strategyThatCancelled , \n + DynamicSpawnStrategy . this . options , \n + actionExecutionContext , \n + spawn ) ) ; \n - strategyThatCancelled ) ) ; \n + strategyThatCancelled , \n + DynamicSpawnStrategy . this . options , \n + actionExecutionContext , \n + spawn ) ) ; \n","Flip legacy _ spawn _ scheduler to default off . \n The new scheduler works better on well - cached builds , and has been found to give performance improvements from 10 to 50 % internally . \n RELNOTES : The new dynamic scheduler is now the default . \n PiperOrigin - RevId : 342842491",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerMultiplexer . java \n + / * * The implementation of the worker protocol ( JSON or Proto ) . * / \n + private WorkerProtocolImpl workerProtocol ; \n + recordingStream = new RecordingInputStream ( process . getInputStream ( ) ) ; \n + recordingStream . startRecording ( 4096 ) ; \n + if ( workerProtocol = = null ) { \n + switch ( workerKey . getProtocolFormat ( ) ) { \n + case JSON : \n + workerProtocol = new JsonWorkerProtocol ( process . getOutputStream ( ) , recordingStream ) ; \n + break ; \n + case PROTO : \n + workerProtocol = new ProtoWorkerProtocol ( process . getOutputStream ( ) , recordingStream ) ; \n + break ; \n + } \n + } \n - request . writeDelimitedTo ( process . getOutputStream ( ) ) ; \n - process . getOutputStream ( ) . flush ( ) ; \n + workerProtocol . putRequest ( request ) ; \n - recordingStream = new RecordingInputStream ( process . getInputStream ( ) ) ; \n - recordingStream . startRecording ( 4096 ) ; \n - parsedResponse = WorkResponse . parseDelimitedFrom ( recordingStream ) ; \n + parsedResponse = workerProtocol . getResponse ( ) ; \n - / / A null parsedResponse can happen if the input stream is closed , in which case we \n + \n + / / A null parsedResponse can only happen if the input stream is closed , in which case we \n",Allow use of JSON protocol in multiplex workers . \n RELNOTES : Multiplex persistent workers can now use the JSON protocol . \n PiperOrigin - RevId : 352415016,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ worker \ WorkerExecRoot . java \n + import static com . google . devtools . build . lib . vfs . Dirent . Type . DIRECTORY ; \n + import static com . google . devtools . build . lib . vfs . Dirent . Type . SYMLINK ; \n + \n - import com . google . devtools . build . lib . vfs . FileStatus ; \n + import com . google . devtools . build . lib . vfs . Dirent ; \n - for ( Path path : root . getDirectoryEntries ( ) ) { \n - FileStatus stat = path . stat ( Symlinks . NOFOLLOW ) ; \n + for ( Dirent dirent : root . readdir ( Symlinks . NOFOLLOW ) ) { \n + Path absPath = root . getChild ( dirent . getName ( ) ) ; \n - if ( path . startsWith ( workDir ) ) { \n + if ( absPath . startsWith ( workDir ) ) { \n - pathRelativeToWorkDir = path . relativeTo ( workDir ) ; \n + pathRelativeToWorkDir = absPath . relativeTo ( workDir ) ; \n - LabelConstants . EXPERIMENTAL _ EXTERNAL _ PATH _ PREFIX . getRelative ( path . relativeTo ( execroot ) ) ; \n + LabelConstants . EXPERIMENTAL _ EXTERNAL _ PATH _ PREFIX . getRelative ( \n + absPath . relativeTo ( execroot ) ) ; \n - if ( stat . isSymbolicLink ( ) & & path . readSymbolicLink ( ) . equals ( destination . get ( ) ) ) { \n + if ( SYMLINK . equals ( dirent . getType ( ) ) \n + & & absPath . readSymbolicLink ( ) . equals ( destination . get ( ) ) ) { \n - path . delete ( ) ; \n + absPath . delete ( ) ; \n - } else if ( stat . isDirectory ( ) ) { \n + } else if ( DIRECTORY . equals ( dirent . getType ( ) ) ) { \n - cleanExisting ( path , inputs , inputsToCreate , dirsToCreate ) ; \n + cleanExisting ( absPath , inputs , inputsToCreate , dirsToCreate ) ; \n - path . deleteTree ( ) ; \n + absPath . deleteTree ( ) ; \n - path . delete ( ) ; \n + absPath . delete ( ) ; \n","Use readdir for cleanExisting in WorkerExecRoot . \n Consistently reduces system time spent under Linux , leaves the other metrics alone . May be even better under Mac , if it has a good implementation . \n RELNOTES : None . \n PiperOrigin - RevId : 359296744",640
src \ test \ java \ com \ google \ devtools \ build \ lib \ util \ SimpleLogHandlerTest . java \n - t . run ( ) ; \n + t . start ( ) ; \n + / / For b / 176321271 \n + assertThat ( Thread . currentThread ( ) . isInterrupted ( ) ) . isFalse ( ) ; \n,"Fix order - dependent tests by properly running a thread . \n Thanks , IntelliJ , for pointing out that Thread . run ( ) probably shouldn ' t be called directly . \n RELNOTES : None . \n PiperOrigin - RevId : 350505650",640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ sandbox \ LinuxSandboxedSpawnRunner . java \n - * This method does the following things : - If mount source does not exist on the host system , \n - * throw an error message - If mount target exists , check whether the source and target are of the \n - * same type - If mount target does not exist on the host system , throw an error message \n + * This method does the following things : \n + * \n + * < ul > \n + * < li > If mount source does not exist on the host system , throw an error message \n + * < li > If mount target exists , check whether the source and target are of the same type \n + * < li > If mount target does not exist on the host system , throw an error message \n + * < / ul > \n - * @ throws UserExecException \n + * @ throws UserExecException if any of the mount points are not valid \n - for ( SortedMap . Entry < Path , Path > bindMount : bindMounts . entrySet ( ) ) { \n + for ( Map . Entry < Path , Path > bindMount : bindMounts . entrySet ( ) ) { \n - "" Mount target ' % s ' is not of the same type as mount source ' % s ' . "" , \n - target , source ) , \n + "" Mount target ' % s ' is a % s but mount source ' % s ' is a % s , they must be the "" \n + + "" same type . "" , \n + target , \n + ( isTargetFile ? "" file "" : "" directory "" ) , \n + source , \n + ( isSourceFile ? "" file "" : "" directory "" ) ) , \n",Improve error message for mount point type mismatch . \n RELNOTES : None . \n PiperOrigin - RevId : 357177120,640
"src \ main \ java \ com \ google \ devtools \ build \ lib \ query2 \ common \ CommonQueryOptions . java \n + "" Note that this requires the stack to be present "" ) \n + @ Option ( \n + name = "" proto : definition _ stack "" , \n + defaultValue = "" false "" , \n + documentationCategory = OptionDocumentationCategory . QUERY , \n + effectTags = { OptionEffectTag . TERMINAL _ OUTPUT } , \n + help = \n + "" Populate the definition _ stack proto field , which records for each rule instance the "" \n + + "" Starlark call stack at the moment the rule ' s class was defined . "" ) \n + public boolean protoIncludeDefinitionStack ; \n + \n src \ main \ java \ com \ google \ devtools \ build \ lib \ query2 \ query \ output \ ProtoOutputFormatter . java \n + private boolean includeDefinitionStack = false ; \n + this . includeDefinitionStack = options . protoIncludeDefinitionStack ; \n + if ( includeDefinitionStack & & rule . getRuleClassObject ( ) . isStarlark ( ) ) { \n + for ( StarlarkThread . CallStackEntry fr : rule . getRuleClassObject ( ) . getCallStack ( ) ) { \n + / / Always report relative locations . \n + / / ( New fields needn ' t honor relativeLocations . ) \n + rulePb . addDefinitionStack ( \n + FormatUtils . getRootRelativeLocation ( fr . location , rule . getPackage ( ) ) + "" : "" + fr . name ) ; \n + } \n + } \n src \ main \ protobuf \ build . proto \n + \n + / / The Starlark call stack for the definition of the rule class of this \n + / / particular rule instance . If empty , either populating the field was not \n + / / enabled on the command line with the - - proto : definition _ stack flag or the \n + / / rule is a native one . \n + repeated string definition _ stack = 14 ; \n","Add a field to the proto output that tells where Starlark rules were defined . \n The field is called ` definition _ stack ` and is formatted like ` instantiation _ stack ` . Unlike that one , it does not require that instantiation stacks be recorded . \n For native rules , this is empty . This makes it easy to tell Starlark and native rules apart from the query output . \n RELNOTES : None . \n PiperOrigin - RevId : 330883644",641
"src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ java \ BUILD \n + "" / / src / main / java / com / google / devtools / build / lib / packages / semantics "" , \n src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ java \ JavaHelper . java \n + import com . google . devtools . build . lib . packages . semantics . BuildLanguageOptions ; \n + import net . starlark . java . eval . StarlarkSemantics ; \n - JavaSemantics semantics , RuleContext ruleContext , Artifact resource ) { \n - PathFragment resourcePath = resource . getRepositoryRelativePath ( ) ; \n + JavaSemantics semantics , RuleContext ruleContext , Artifact resource ) \n + throws InterruptedException { \n + StarlarkSemantics starlarkSemantics = \n + ruleContext . getAnalysisEnvironment ( ) . getStarlarkSemantics ( ) ; \n + PathFragment resourcePath = \n + resource . getOutputDirRelativePath ( \n + starlarkSemantics . getBool ( BuildLanguageOptions . EXPERIMENTAL _ SIBLING _ REPOSITORY _ LAYOUT ) ) ; \n + if ( ! ruleContext . getLabel ( ) . getWorkspaceRoot ( starlarkSemantics ) . isEmpty ( ) ) { \n + PathFragment workspace = \n + PathFragment . create ( ruleContext . getLabel ( ) . getWorkspaceRoot ( starlarkSemantics ) ) ; \n + resourcePath = resourcePath . relativeTo ( workspace ) ; \n + } \n",Automated rollback of commit ecb7bd2c640989d88decfd2771e26b7e24398640 . \n * * * Reason for rollback * * * \n Makes it impossible to build Bazel itself : https : / / github . com / bazelbuild / bazel / issues / 12287 \n * * * Original change description * * * \n Replace Artifact # getOutputDirRelativePath call in JavaHelper # getJavaResourcePath with getRepositoryRelativePath . \n PiperOrigin - RevId : 337470643,641
src \ main \ java \ com \ google \ devtools \ build \ lib \ rules \ apple \ DottedVersion . java \n - \n - @ Override \n - public String toString ( ) { \n - return version . toString ( ) ; \n - } \n,"Automated rollback of commit efcf2be83da0670c1b6e332516b8c8e5bceb85ef . \n * * * Reason for rollback * * * \n Breaks targets at Google . \n * * * Original change description * * * \n Implement com . google . devtools . build . lib . rules . apple . DottedVersion $ Option toString ( ) \n This way , the string value shows up when running bazel config , instead of values such as ` com . google . devtools . build . lib . rules . apple . DottedVersion $ Option @ 1703e2 ` \n Closes # 12347 . \n PiperOrigin - RevId : 339615880",641
"src \ main \ java \ com \ google \ devtools \ build \ lib \ actions \ CompletionContext . java \n - import com . google . devtools . build . lib . actions . Artifact . ArchivedTreeArtifact ; \n - import com . google . devtools . build . lib . actions . Artifact . ArtifactExpander ; \n - import com . google . devtools . build . lib . actions . Artifact . ArtifactExpanderImpl ; \n - import com . google . devtools . build . lib . actions . Artifact . MissingExpansionException ; \n - import com . google . devtools . build . lib . actions . Artifact . SpecialArtifact ; \n + import com . google . common . collect . ImmutableMap ; \n - import java . util . ArrayList ; \n - import java . util . List ; \n - null , ( artifact , output ) - > { } , ArtifactPathResolver . IDENTITY , false , false ) ; \n + null , ImmutableMap . of ( ) , ImmutableMap . of ( ) , ArtifactPathResolver . IDENTITY , false , false ) ; \n - private final ArtifactExpander expander ; \n - \n + private final Map < Artifact , ImmutableCollection < Artifact > > expandedArtifacts ; \n + private final Map < Artifact , ImmutableList < FilesetOutputSymlink > > expandedFilesets ; \n - ArtifactExpander expander , \n + Map < Artifact , ImmutableCollection < Artifact > > expandedArtifacts , \n + Map < Artifact , ImmutableList < FilesetOutputSymlink > > expandedFilesets , \n - this . expander = expander ; \n + this . expandedArtifacts = expandedArtifacts ; \n + this . expandedFilesets = expandedFilesets ; \n - Map < SpecialArtifact , ArchivedTreeArtifact > archivedTreeArtifacts , \n - ArtifactExpander expander = \n - new ArtifactExpanderImpl ( expandedArtifacts , archivedTreeArtifacts , expandedFilesets ) ; \n - execRoot , expander , pathResolver , expandFilesets , fullyResolveFilesetSymlinks ) ; \n + execRoot , \n + expandedArtifacts , \n + expandedFilesets , \n + pathResolver , \n + expandFilesets , \n + fullyResolveFilesetSymlinks ) ; \n - List < Artifact > expandedArtifacts = new ArrayList < > ( ) ; \n - expander . expand ( artifact , expandedArtifacts ) ; \n + ImmutableCollection < Artifact > expandedArtifacts = this . expandedArtifacts . get ( artifact ) ; \n - ImmutableList < FilesetOutputSymlink > links ; \n - try { \n - links = expander . getFileset ( filesetArtifact ) ; \n - } catch ( MissingExpansionException e ) { \n - throw new IllegalStateException ( e ) ; \n - } \n + ImmutableList < FilesetOutputSymlink > links = expandedFilesets . get ( filesetArtifact ) ; \n src \ main \ java \ com \ google \ devtools \ build \ lib \ skyframe \ CompletionFunction . java \n - archivedTreeArtifacts , \n","Do not pass an ArtifactExpander to CompletionContext . \n Instead , pass in the required maps because the behavior of CompletionContext is simple enough that it makes more sense to do that instead . \n The long - term goal is to turn the completion events into data objects . Unfortunately , that probably won ' t happen for a while since pathResolver does to useful work and it ' s hard to plumb that in in any other way . \n RELNOTES : None . \n PiperOrigin - RevId : 360205871",641
src \ main \ java \ com \ google \ devtools \ build \ lib \ includescanning \ IncludeScanningModule . java \n + spawnScannerSupplier . get ( ) . setOutputService ( env . getOutputService ( ) ) ; \n src \ main \ java \ com \ google \ devtools \ build \ lib \ includescanning \ SpawnIncludeScanner . java \n + import com . google . devtools . build . lib . vfs . OutputService ; \n + private OutputService outputService ; \n + public void setOutputService ( OutputService outputService ) { \n + Preconditions . checkState ( this . outputService = = null ) ; \n + this . outputService = outputService ; \n + } \n + \n - / / Output files are generally not locally available should be scanned remotely to avoid the \n + / / Files written remotely that are not locally available should be scanned remotely to avoid the \n - / / remotely when the file size exceeds a certain size . \n - if ( remoteExtractionThreshold = = 0 | | ! file . isSourceArtifact ( ) ) { \n + / / remotely when explicitly directed to via a flag . \n + if ( remoteExtractionThreshold = = 0 \n + | | ( outputService ! = null & & outputService . isRemoteFile ( file ) ) ) { \n src \ main \ java \ com \ google \ devtools \ build \ lib \ remote \ RemoteOutputService . java \n + import com . google . devtools . build . lib . vfs . Path ; \n + @ Override \n + public boolean isRemoteFile ( Artifact artifact ) { \n + Path path = artifact . getPath ( ) ; \n + return path . getFileSystem ( ) instanceof RemoteActionFileSystem \n + & & ( ( RemoteActionFileSystem ) path . getFileSystem ( ) ) . isRemote ( path ) ; \n + } \n + \n src \ main \ java \ com \ google \ devtools \ build \ lib \ vfs \ OutputService . java \n + / * * @ return true iff the file actually lives on a remote server * / \n + boolean isRemoteFile ( Artifact file ) ; \n + \n,"Automated rollback of commit 7d7ceaec50c84480617e22707304c975d8dc2940 . \n * * * Reason for rollback * * * \n Makes Exoblaze slower : \n https : / / storage . cloud . google . com / blaze - performance - data / 2021 - 01 - 19 / nightly _ report . html # yt - ios - local - blaze - bench - imacpro - 2017 - 18c \n * * * Original change description * * * \n Simplify the decision on whether to extract include remotely . Instead of asking \n the output service whether a given file is a remote file , just always extract \n output files remotely . \n RELNOTES : None . \n PiperOrigin - RevId : 353812770",641
"src \ main \ java \ com \ google \ devtools \ build \ lib \ remote \ merkletree \ DirectoryTreeBuilder . java \n - explodeDirectory ( path , execRoot ) ; \n + explodeDirectory ( input . getExecPath ( ) , execRoot ) ; \n src \ test \ shell \ bazel \ disk _ cache _ test . sh \n + function test _ input _ directories _ in _ external _ repo _ with _ sibling _ repository _ layout ( ) { \n + create _ new _ workspace \n + l = $ TEST _ TMPDIR / l \n + mkdir - p "" $ l / dir "" \n + touch "" $ l / WORKSPACE "" \n + touch "" $ l / dir / f "" \n + cat > "" $ l / BUILD "" < < ' EOF ' \n + exports _ files ( [ "" dir "" ] ) \n + EOF \n + \n + cat > > WORKSPACE < < EOF \n + local _ repository ( name = "" l "" , path = "" $ l "" ) \n + EOF \n + \n + cat > BUILD < < ' EOF ' \n + genrule ( name = "" g "" , srcs = [ "" @ l / / : dir "" ] , outs = [ "" go "" ] , cmd = "" find $ < > $ @ "" ) \n + EOF \n + \n + bazel build \ \n + - - experimental _ sibling _ repository _ layout \ \n + - - disk _ cache = "" $ TEST _ TMPDIR / cache "" \ \n + / / : g | | fail "" build failed "" \n + \n + } \n + \n","Make the Merkle tree computation work in the wake of https : / / github . com / bazelbuild / bazel / commit / 7149f578006a4ad0d51df69830a6986749b34df5 . \n Fixes a bunch of downstream breakages : \n https : / / github . com / bazelbuild / continuous - integration / issues / 1093 \n https : / / github . com / bazelbuild / continuous - integration / issues / 1094 \n https : / / github . com / bazelbuild / rules _ nodejs / issues / 2464 \n https : / / github . com / bazelbuild / rules _ python / issues / 419 \n Turns out , the assertion that "" Merkle tree computation uses ` ActionInput . getExecPath ( ) ` "" was only mostly correct : there was a place where the key of the input map was used instead . \n I ' m somewhat surprised that this did not show up in our test battery , although , admittedly , "" unsound directory as an input file in an external repository "" doesn ' t sound like the most common use case . \n RELNOTES : None . \n PiperOrigin - RevId : 358366246",641
"src \ main \ java \ com \ google \ devtools \ build \ lib \ analysis \ AspectCompleteEvent . java \n + import com . google . devtools . build . lib . cmdline . Label ; \n + import com . google . devtools . build . lib . packages . AspectDescriptor ; \n - private final AspectValue aspectValue ; \n + private final Label label ; \n + private final AspectDescriptor descriptor ; \n - AspectValue aspectValue , \n + Label label , \n + AspectDescriptor descriptor , \n - this . aspectValue = aspectValue ; \n + this . label = label ; \n + this . descriptor = descriptor ; \n - return new AspectCompleteEvent ( value , null , completionContext , artifacts , configurationEventId ) ; \n + return new AspectCompleteEvent ( \n + value . getKey ( ) . getLabel ( ) , \n + value . getAspect ( ) . getDescriptor ( ) , \n + null , \n + completionContext , \n + artifacts , \n + configurationEventId ) ; \n - return new AspectCompleteEvent ( value , rootCauses , ctx , outputs , configurationEventId ) ; \n - } \n - \n - / * * \n - * Returns the target associated with the event . \n - * / \n - public AspectValue getAspectValue ( ) { \n - return aspectValue ; \n + return new AspectCompleteEvent ( \n + value . getKey ( ) . getLabel ( ) , \n + value . getAspect ( ) . getDescriptor ( ) , \n + rootCauses , \n + ctx , \n + outputs , \n + configurationEventId ) ; \n - aspectValue . getKey ( ) . getLabel ( ) , \n - configurationEventId , \n - aspectValue . getAspect ( ) . getDescriptor ( ) . getDescription ( ) ) ; \n + label , configurationEventId , descriptor . getDescription ( ) ) ; \n","Don ' t keep a reference to the full AspectValue in AspectCompleteEvent . \n This makes AspectCompleteEvent a lightweight data object instead , which is nicer . \n RELNOTES : None . \n PiperOrigin - RevId : 359711784",641
"src \ test \ java \ com \ google \ devtools \ build \ lib \ analysis \ AspectTest . java \n - . contains ( \n - "" ConflictException : for foo / aspect . out , previous action : action ' Action for aspect 1 ' , "" \n - + "" attempted action : action ' Action for aspect 2 ' "" ) ; \n + . containsMatch ( \n + "" ConflictException : for foo / aspect . out , previous action : action ' Action for aspect . ' , "" \n + + "" attempted action : action ' Action for aspect . ' "" ) ; \n",Make AspectTest . topLevelConflictDetected not flaky . \n The message relied on the order in which the two aspects were analyzed . \n RELNOTES : None . \n PiperOrigin - RevId : 359713477,641
"services \ core \ java \ com \ android \ server \ TestNetworkService . java \n + import android . net . NetworkAgentConfig ; \n - import android . net . NetworkInfo ; \n - import android . net . NetworkInfo . DetailedState ; \n + import android . net . NetworkProvider ; \n - @ NonNull private static final String TEST _ NETWORK _ TYPE = "" TEST _ NETWORK "" ; \n + @ NonNull private static final String TEST _ NETWORK _ LOGTAG = "" TestNetworkAgent "" ; \n + @ NonNull private static final String TEST _ NETWORK _ PROVIDER _ NAME = TAG ; \n + @ NonNull private final ConnectivityManager mCm ; \n + @ NonNull private final NetworkProvider mNetworkProvider ; \n + \n + mCm = mContext . getSystemService ( ConnectivityManager . class ) ; \n + mNetworkProvider = new NetworkProvider ( mContext , mHandler . getLooper ( ) , \n + TEST _ NETWORK _ PROVIDER _ NAME ) ; \n + mCm . registerNetworkProvider ( mNetworkProvider ) ; \n - @ NonNull private final NetworkInfo mNi ; \n - @ NonNull private final NetworkCapabilities mNc ; \n - @ NonNull private final LinkProperties mLp ; \n - @ NonNull Looper looper , \n - @ NonNull NetworkInfo ni , \n + @ NonNull Looper looper , \n + @ NonNull NetworkAgentConfig config , \n - @ NonNull IBinder binder ) \n + @ NonNull IBinder binder , \n + @ NonNull NetworkProvider np ) \n - super ( looper , context , TEST _ NETWORK _ TYPE , ni , nc , lp , NETWORK _ SCORE ) ; \n + super ( context , looper , TEST _ NETWORK _ LOGTAG , nc , lp , NETWORK _ SCORE , config , np ) ; \n - mNi = ni ; \n - mNc = nc ; \n - mLp = lp ; \n - mNi . setDetailedState ( DetailedState . DISCONNECTED , null , null ) ; \n - mNi . setIsAvailable ( false ) ; \n - sendNetworkInfo ( mNi ) ; \n + unregister ( ) ; \n - / / Build network info with special testing type \n - NetworkInfo ni = new NetworkInfo ( ConnectivityManager . TYPE _ TEST , 0 , TEST _ NETWORK _ TYPE , "" "" ) ; \n - ni . setDetailedState ( DetailedState . CONNECTED , null , null ) ; \n - ni . setIsAvailable ( true ) ; \n - \n - return new TestNetworkAgent ( looper , context , ni , nc , lp , callingUid , binder ) ; \n + final TestNetworkAgent agent = new TestNetworkAgent ( context , looper , \n + new NetworkAgentConfig . Builder ( ) . build ( ) , nc , lp , callingUid , binder , \n + mNetworkProvider ) ; \n + agent . register ( ) ; \n + agent . markConnected ( ) ; \n + return agent ; \n",Use public API of NetworkAgent in TestNetworkService \n - Create NetworkAgent by using the public API of NetworkAgent . \n - Remove the usage of NetworkInfo . \n Bug : 172183305 \n Test : Build pass . \n Test : atest FrameworksNetTests \n Test : atest CtsNetTestCasesLatestSdk \n Test : atest NetworkStackIntegrationTests \n Test : atest TetheringIntegrationTests \n Change - Id : Icba59295861201c221587caa9df02275c4087fb8,646
"services \ core \ java \ com \ android \ server \ connectivity \ NetworkNotificationManager . java \n - import com . android . internal . notification . SystemNotificationChannels ; \n - private static final boolean VDBG = false ; \n + \n + / / Notification channels used by ConnectivityService mainline module , it should be aligned with \n + / / SystemNotificationChannels . \n + public static final String NOTIFICATION _ NETWORK _ STATUS = "" NETWORK _ STATUS "" ; \n + public static final String NOTIFICATION _ NETWORK _ ALERTS = "" NETWORK _ ALERTS "" ; \n + public static final String NOTIFICATION _ VPN = "" VPN "" ; \n - ? SystemNotificationChannels . NETWORK _ ALERTS \n - : SystemNotificationChannels . NETWORK _ STATUS ; \n + ? NOTIFICATION _ NETWORK _ ALERTS : NOTIFICATION _ NETWORK _ STATUS ; \n services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n + import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ VPN ; \n - import com . android . internal . notification . SystemNotificationChannels ; \n - new Notification . Builder ( mContext , SystemNotificationChannels . VPN ) \n + new Notification . Builder ( mContext , NOTIFICATION _ VPN ) \n services \ core \ java \ com \ android \ server \ net \ LockdownVpnTracker . java \n + import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ VPN ; \n + \n - import com . android . internal . notification . SystemNotificationChannels ; \n - new Notification . Builder ( mContext , SystemNotificationChannels . VPN ) \n + new Notification . Builder ( mContext , NOTIFICATION _ VPN ) \n","Use local defined constants for notification channels \n ConnectivityService mainline module cannot call the members \n inside SystemNotificationChannels . java . So use the local defined \n constants instead . \n Bug : 172040168 \n Test : atest FrameworksNetTests \n Test : Manual test NO _ INTERNET , SIGN _ IN , PARTIAL _ CONNECTIVITY , \n VPN _ ALWAYS _ ON notifications . \n Change - Id : I223b207c4346e8239dee78e50dd2b0532a3e55b0",646
services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - & & ( lp . hasIPv4DefaultRoute ( ) | | lp . hasIpv4UnreachableDefaultRoute ( ) ) \n - & & ( lp . hasIPv6DefaultRoute ( ) | | lp . hasIpv6UnreachableDefaultRoute ( ) ) ; \n + & & ( lp . hasIpv4DefaultRoute ( ) | | lp . hasIpv4UnreachableDefaultRoute ( ) ) \n + & & ( lp . hasIpv6DefaultRoute ( ) | | lp . hasIpv6UnreachableDefaultRoute ( ) ) ; \n,"Use hasIpv [ 4 | 6 ] DefaultRoute instead of hasIPv [ 4 | 6 ] DefaultRoute \n ConnectivityService is going to be a mainline module , it can only \n use formal APIs or @ SystemApi . So use @ SystemApi \n hasIpv4DefaultRoute and hasIpv6DefaultRoute instead of \n hasIPv4DefaultRoute and hasIPv6DefaultRoute . \n Bug : 172183305 \n Test : atest FrameworksNetTests \n Change - Id : I67e5fa234fbb6d0b9739ae3295eb0b0ea108f582",646
"services \ core \ java \ com \ android \ server \ connectivity \ NetworkNotificationManager . java \n - / / SystemNotificationChannels . \n - public static final String NOTIFICATION _ NETWORK _ STATUS = "" NETWORK _ STATUS "" ; \n - public static final String NOTIFICATION _ NETWORK _ ALERTS = "" NETWORK _ ALERTS "" ; \n - public static final String NOTIFICATION _ VPN = "" VPN "" ; \n + / / SystemNotificationChannels so the channels are the same as the ones used as the system \n + / / server . \n + public static final String NOTIFICATION _ CHANNEL _ NETWORK _ STATUS = "" NETWORK _ STATUS "" ; \n + public static final String NOTIFICATION _ CHANNEL _ NETWORK _ ALERTS = "" NETWORK _ ALERTS "" ; \n + public static final String NOTIFICATION _ CHANNEL _ VPN = "" VPN "" ; \n - ? NOTIFICATION _ NETWORK _ ALERTS : NOTIFICATION _ NETWORK _ STATUS ; \n + ? NOTIFICATION _ CHANNEL _ NETWORK _ ALERTS : NOTIFICATION _ CHANNEL _ NETWORK _ STATUS ; \n services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n - import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ VPN ; \n + import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ CHANNEL _ VPN ; \n - new Notification . Builder ( mContext , NOTIFICATION _ VPN ) \n + new Notification . Builder ( mContext , NOTIFICATION _ CHANNEL _ VPN ) \n services \ core \ java \ com \ android \ server \ net \ LockdownVpnTracker . java \n - import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ VPN ; \n + import static com . android . server . connectivity . NetworkNotificationManager . NOTIFICATION _ CHANNEL _ VPN ; \n - new Notification . Builder ( mContext , NOTIFICATION _ VPN ) \n + new Notification . Builder ( mContext , NOTIFICATION _ CHANNEL _ VPN ) \n","Fix the comments left on aosp / 1481197 \n Bug : 172040168 \n Test : atest FrameworksNetTests \n Test : Manual test NO _ INTERNET , SIGN _ IN , PARTIAL _ CONNECTIVITY , \n VPN _ ALWAYS _ ON notifications . \n Change - Id : Ibd05366481e6ddadf8b323335c2c35d40d340d0d",646
"services \ core \ java \ com \ android \ server \ connectivity \ PermissionMonitor . java \n - import android . content . pm . UserInfo ; \n - List < UserInfo > users = mUserManager . getAliveUsers ( ) ; \n - if ( users ! = null ) { \n - for ( UserInfo user : users ) { \n - mUsers . add ( user . id ) ; \n - } \n + final List < UserHandle > users = mUserManager . getUserHandles ( true / * excludeDying * / ) ; \n + for ( UserHandle user : users ) { \n + mUsers . add ( user . getIdentifier ( ) ) ; \n tests \ net \ java \ com \ android \ server \ connectivity \ PermissionMonitorTest . java \n - import android . content . pm . UserInfo ; \n - when ( mUserManager . getAliveUsers ( ) ) . thenReturn ( \n - Arrays . asList ( new UserInfo [ ] { \n - new UserInfo ( MOCK _ USER1 , "" "" , 0 ) , \n - new UserInfo ( MOCK _ USER2 , "" "" , 0 ) , \n + when ( mUserManager . getUserHandles ( eq ( true ) ) ) . thenReturn ( \n + Arrays . asList ( new UserHandle [ ] { \n + new UserHandle ( MOCK _ USER1 ) , \n + new UserHandle ( MOCK _ USER2 ) , \n","Use getUserHandles ( ) instead of getUsers ( ) to get user id \n UserManager # getUsers ( ) is a hidden API , use getUserHandles ( ) to \n get user id instead in PermissionMonitor . \n Bug : 171529940 \n Test : atest FrameworksNetTests \n Change - Id : Ic304627688de8e49505a95ebc99628b2e0eafab9",646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - import com . android . internal . util . DumpUtils ; \n + private boolean checkDumpPermission ( Context context , String tag , PrintWriter pw ) { \n + if ( context . checkCallingOrSelfPermission ( android . Manifest . permission . DUMP ) \n + ! = PackageManager . PERMISSION _ GRANTED ) { \n + pw . println ( "" Permission Denial : can ' t dump "" + tag + "" from from pid = "" \n + + Binder . getCallingPid ( ) + "" , uid = "" + Binder . getCallingUid ( ) \n + + "" due to missing android . permission . DUMP permission "" ) ; \n + return false ; \n + } else { \n + return true ; \n + } \n + } \n + \n - if ( ! DumpUtils . checkDumpPermission ( mContext , TAG , pw ) ) return ; \n + if ( ! checkDumpPermission ( mContext , TAG , pw ) ) return ; \n","Reimplement DumpUtils # checkDumpPermission ( ) in ConnectivityService \n ConnectivityService is going to be a part of mainline module , to \n prevent using @ hide method in ConnectivityService , reimplement \n DumpUtils # checkDumpPermission ( ) in ConnectivityService . \n Bug : 175177794 \n Test : atest FrameworksNetTests \n Test : adb shell dumpsys connectivity \n Change - Id : I1e4bc023b39b40a717a3a0fd8cd60aa2f25e9bdb",646
services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n - setLockdown ( false ) ; \n + setVpnForcedLocked ( false ) ; \n,"Fix storing the wrong value of mLockdown in setting \n When user is stopped , the Vpn # onUserStopped ( ) will be called and \n the value of mLockdown will be set to false then store into \n setting . \n This is a wrong behavior because user doesn ' t change it , so for \n this kind of case , there is no need to store the value of \n mLockdown in setting . \n In fact , there is no need to call Vpn # saveAlwaysOnPackage ( ) when \n user is stopped because there is nothing changed . \n Bug : 168500792 \n Test : atest FrameworksNetTests \n Change - Id : Ie85a347216614b7873bfdf199165d89527ada3a8 \n Merged - In : Ie85a347216614b7873bfdf199165d89527ada3a8",646
"services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n + import android . content . ContentResolver ; \n - Settings . Secure . putStringForUser ( mContext . getContentResolver ( ) , key , value , userId ) ; \n + Settings . Secure . putString ( getContentResolverAsUser ( userId ) , key , value ) ; \n - Settings . Secure . putIntForUser ( mContext . getContentResolver ( ) , key , value , userId ) ; \n + Settings . Secure . putInt ( getContentResolverAsUser ( userId ) , key , value ) ; \n - return Settings . Secure . getStringForUser ( mContext . getContentResolver ( ) , key , userId ) ; \n + return Settings . Secure . getString ( getContentResolverAsUser ( userId ) , key ) ; \n - return Settings . Secure . getIntForUser ( mContext . getContentResolver ( ) , key , def , userId ) ; \n + return Settings . Secure . getInt ( getContentResolverAsUser ( userId ) , key , def ) ; \n + } \n + \n + private ContentResolver getContentResolverAsUser ( int userId ) { \n + return mContext . createContextAsUser ( \n + UserHandle . of ( userId ) , 0 / * flags * / ) . getContentResolver ( ) ; \n","Use public API of Settings . Secure to get / put secure settings \n Get / put secure settings by using public API of Settings . Secure to \n prevent using hidden API . \n Bug : 171033200 \n Test : atest FrameworksNetTests \n Test : Install 3rd - party VPN app and create multiple users , then \n change the VPN always - on setting in one of users and check \n if the VPN always - on setting of the others is not changed . \n ( i . e . Make sure they won ' t influence each other . ) \n Change - Id : Icd455df3fa6eac52cdab1b162556f429da99e8f7",646
services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - / * * \n - * @ see ServiceManager # checkService ( String ) \n - * / \n - public boolean hasService ( @ NonNull String name ) { \n - return ServiceManager . checkService ( name ) ! = null ; \n - } \n - \n - if ( mNetConfigs [ TYPE _ ETHERNET ] = = null & & mDeps . hasService ( Context . ETHERNET _ SERVICE ) ) { \n + if ( mNetConfigs [ TYPE _ ETHERNET ] = = null \n + & & mContext . getSystemService ( Context . ETHERNET _ SERVICE ) ! = null ) { \n tests \ net \ java \ com \ android \ server \ ConnectivityServiceTest . java \n + import android . net . EthernetManager ; \n + @ Mock EthernetManager mEthernetManager ; \n + if ( Context . ETHERNET _ SERVICE . equals ( name ) ) return mEthernetManager ; \n - doReturn ( true ) . when ( deps ) . hasService ( Context . ETHERNET _ SERVICE ) ; \n,"Using Context # getSystemService instead of ServiceManager # checkService \n ConnectivityService is going to be a mainline module , it can only \n use formal APIs or @ SystemApi . So use public API - \n Context # getSystemService ( ) instead of hidden API - \n ServiceManager # checkService ( ) . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I9824caa7aec57e70f0ba405fcce39f9bc068732d",646
"services \ core \ java \ com \ android \ server \ net \ LockdownVpnTracker . java \n + import static android . net . ConnectivityManager . TYPE _ NONE ; \n - import android . net . ConnectivityManager ; \n - final String egressTypeName = ( egressInfo = = null ) ? \n - null : ConnectivityManager . getNetworkTypeName ( egressInfo . getType ( ) ) ; \n + final int egressType = ( egressInfo = = null ) ? TYPE _ NONE : egressInfo . getType ( ) ; \n - Slog . d ( TAG , "" handleStateChanged : egress = "" + egressTypeName + \n - "" "" + mAcceptedEgressIface + "" - > "" + egressIface ) ; \n + Slog . d ( TAG , "" handleStateChanged : egress = "" + egressType \n + + "" "" + mAcceptedEgressIface + "" - > "" + egressIface ) ; \n - final int egressType = egressInfo . getType ( ) ; \n","Don ' t use @ hide API - ConnectivityManager # getNetworkTypeName ( ) \n To prevent calling @ hide API , print definition of network type \n directly instead of calling @ hide API . \n Bug : 172183305 \n Test : atest FrameworksNetTests \n Test : atest CtsNetTestCasesLatestSdk \n Test : Setup a platform VPN and enable VPN always - on , then check \n the log . \n Change - Id : I807e90537f706face51c5cc221490ea742d22a0e",646
"services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n - req = cm . getDefaultRequest ( ) ; \n + / / Basically , the request here is referring to the default request which is defined \n + / / in ConnectivityService . Ideally , ConnectivityManager should provide an new API \n + / / which can provide the status of physical network even though there is a virtual \n + / / network . b / 147280869 is used for tracking the new API . \n + / / TODO : Use the new API to register default physical network . \n + req = new NetworkRequest . Builder ( ) \n + . addCapability ( NetworkCapabilities . NET _ CAPABILITY _ INTERNET ) \n + . build ( ) ; \n","Define and use default request in Ikev2VpnRunner \n Vpn might be included in ConnectivityService mainline module , so \n it should prevent calling @ hide API . Even if Vpn isn ' t included \n in ConnectivityService mainline module eventually , it ' s still \n fine to use local defined default request instead of calling \n @ hide API . \n Ideally , ConnectivityManager will provide a new API which can \n provide the status of physical network even though there is a \n virtual network . b / 147280869 is used for tracking the new API . \n Bug : 172183305 \n Test : atest FrameworksNetTests \n Test : atest CtsNetTestCasesLatestSdk \n Test : Manual setup IKEV2 VPN connection . \n Change - Id : If76e7497bef4890a74641695c3ebd395795bbe7f",646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - / / Note : if mDefaultRequest is changed , NetworkMonitor needs to be updated . \n",Remove a comment from ConnectivityService \n This comment is not true anymore since NetworkMonitor is not only \n verifying the default network but also verifying VPN when private \n DNS is enabled . \n Test : Build pass . \n Change - Id : Ib975aa28c84b9974a73d1baca9d5185c01b71217,646
"tests \ net \ common \ java \ android \ net \ MatchAllNetworkSpecifierTest . kt \n - @ Test @ IgnoreAfter ( Build . VERSION _ CODES . R ) \n - fun testCanBeSatisfiedBy _ BeforeS ( ) { \n + @ Test \n + @ IgnoreUpTo ( Build . VERSION _ CODES . Q ) \n + @ IgnoreAfter ( Build . VERSION _ CODES . R ) \n + / / Only run this test on Android R . \n + / / The method - satisfiedBy ( ) has changed to canBeSatisfiedBy ( ) starting from Android R , so the \n + / / method - canBeSatisfiedBy ( ) cannot be found when running this test on Android Q . \n + fun testCanBeSatisfiedBy _ OnlyForR ( ) { \n","Ignore verifying canBeSatisfiedBy ( ) on Android Q \n The method - satisfiedBy ( ) has changed to canBeSatisfiedBy ( ) \n starting from Android R , so the method - canBeSatisfiedBy ( ) \n cannot be found when running this test on Android Q . \n Ignore verifying canBeSatisfiedBy ( ) on Android Q to fix this \n problem . \n Bug : 173911834 \n Test : Run MatchAllNetworkSpecifierTest on Android Q , R , S . \n Change - Id : Ibe317b56f82d3ea100b1d78c3907dce4f2fd964d",646
"tests \ net \ common \ java \ android \ net \ MatchAllNetworkSpecifierTest . kt \n + import android . os . Build \n + import com . android . testutils . DevSdkIgnoreRule \n + import com . android . testutils . DevSdkIgnoreRule . IgnoreAfter \n + import com . android . testutils . DevSdkIgnoreRule . IgnoreUpTo \n + import org . junit . Assert . assertFalse \n + import org . junit . Rule \n + @ Rule @ JvmField \n + val ignoreRule : DevSdkIgnoreRule = DevSdkIgnoreRule ( ) \n + \n + private val specifier = MatchAllNetworkSpecifier ( ) \n + private val discoverySession = Mockito . mock ( DiscoverySession : : class . java ) \n + private val peerHandle = Mockito . mock ( PeerHandle : : class . java ) \n + private val wifiAwareNetworkSpecifier = WifiAwareNetworkSpecifier . Builder ( discoverySession , \n + peerHandle ) . build ( ) \n + \n + @ Test @ IgnoreAfter ( Build . VERSION _ CODES . R ) \n + fun testCanBeSatisfiedBy _ BeforeS ( ) { \n + / / MatchAllNetworkSpecifier didn ' t follow its parent class to change the satisfiedBy ( ) to \n + / / canBeSatisfiedBy ( ) , so if a caller calls MatchAllNetworkSpecifier # canBeSatisfiedBy ( ) , the \n + / / NetworkSpecifier # canBeSatisfiedBy ( ) will be called actually , and false will be returned . \n + / / Although it ' s not meeting the expectation , the behavior still needs to be verified . \n + assertFalse ( specifier . canBeSatisfiedBy ( wifiAwareNetworkSpecifier ) ) \n + } \n + \n + @ IgnoreUpTo ( Build . VERSION _ CODES . R ) \n - val specifier = MatchAllNetworkSpecifier ( ) \n - val discoverySession = Mockito . mock ( DiscoverySession : : class . java ) \n - val peerHandle = Mockito . mock ( PeerHandle : : class . java ) \n - val wifiAwareNetworkSpecifier = WifiAwareNetworkSpecifier . Builder ( discoverySession , \n - peerHandle ) . build ( ) \n","Separate 2 tests to verify canBeSatisfiedBy ( ) \n In Android R , NetworkSpecifier # satisfiedBy ( ) has changed to \n NetworkSpecifier # canBeSatisfiedBy ( ) , but its subclass - \n MatchAllNetworkSpecifier hasn ' t . \n In Android S , both of MatchAllNetworkSpecifier and \n NetworkSpecifier has changed satisfiedBy ( ) to canBeSatisfiedBy ( ) . \n So if running the latest CTS on R device , it will verify \n NetworkSpecifier # canBeSatisfiedBy ( ) instead of \n MatchAllNetworkSpecifier # satisfiedBy ( ) and get the unexpected \n result . \n The fix is to separate 2 tests to verify canBeSatisfiedBy ( ) , one \n is for Android R or older version and the other is for Android \n S + . \n Bug : 172401624 \n Test : Run MatchAllNetworkSpecifierTest on Android R and S . \n Change - Id : I1391bae9a0fc0298beb8fe80b5f388b492244566",646
"services \ core \ Android . bp \n - "" netd _ aidl _ interfaces - platform - java "" , \n + "" netd - client "" , \n services \ net \ Android . bp \n - "" netd _ aidl _ interfaces - platform - java "" , \n + "" netd - client "" , \n","Use netd - client instead of netd _ aidl _ interfaces - platform - java \n netd - client contains netd _ aidl _ interface - java and \n netd _ event _ listener _ interface - java which is almost the same as \n netd _ aidl _ interfaces - platform - java . \n The difference of them is that netd - client refers to the stable \n netd aidl but netd _ aidl _ interfaces - platform - java refers to the \n unstable one , so they cannot be put together , otherwise , there \n will be a dependency problem in the build time . \n Also , the libraries which are referring to the \n netd _ aidl _ interfaces - unstable - java should also be changed to \n netd _ aidl _ interfaces - java eventually when releasing . \n So it ' s fine to use netd - client to replace \n netd _ aidl _ interfaces - platform - java . \n Bug : 174837473 \n Test : make ; atest FrameworksNetTests \n Change - Id : Ie8cbece445c4e0b79faf89e7ccbac2cbea115c9d",646
"packages \ Connectivity \ service \ Android . bp \n + "" netd - client "" , \n services \ core \ java \ com \ android \ server \ TestNetworkService . java \n + import android . net . NetworkStack ; \n + import com . android . net . module . util . NetdUtils ; \n - / / This requires NETWORK _ STACK privileges . \n - mNMS . setInterfaceUp ( iface ) ; \n + NetworkStack . checkNetworkStackPermission ( mContext ) ; \n + NetdUtils . setInterfaceUp ( mNetd , iface ) ; \n","Use function inside NetdUtils instead of NetworkManagementService \n TestNetworkService will be a part of mainline module , to prevent \n using @ hide API of NetworkManagementService in TestNetworkService , \n use function inside NetdUtils instead . \n Bug : 170598012 \n Test : atest CtsNetTestCasesLatestSdk \n Change - Id : I738066ce2f1bcd616dc582a3ff1fd77bcd660c73",646
"services \ core \ java \ com \ android \ server \ IpSecService . java \n - import android . os . INetworkManagementService ; \n - / * NetworkManager instance * / \n - private final INetworkManagementService mNetworkManager ; \n - \n - private IpSecService ( Context context , INetworkManagementService networkManager ) { \n - this ( context , networkManager , IpSecServiceConfiguration . GETSRVINSTANCE ) ; \n + private IpSecService ( Context context ) { \n + this ( context , IpSecServiceConfiguration . GETSRVINSTANCE ) ; \n - static IpSecService create ( Context context , INetworkManagementService networkManager ) \n + static IpSecService create ( Context context ) \n - final IpSecService service = new IpSecService ( context , networkManager ) ; \n + final IpSecService service = new IpSecService ( context ) ; \n - public IpSecService ( Context context , INetworkManagementService networkManager , \n - IpSecServiceConfiguration config ) { \n + public IpSecService ( Context context , IpSecServiceConfiguration config ) { \n - networkManager , \n - public IpSecService ( Context context , INetworkManagementService networkManager , \n - IpSecServiceConfiguration config , UidFdTagger uidFdTagger ) { \n + public IpSecService ( Context context , IpSecServiceConfiguration config , \n + UidFdTagger uidFdTagger ) { \n - mNetworkManager = Objects . requireNonNull ( networkManager ) ; \n services \ java \ com \ android \ server \ SystemServer . java \n - ipSecService = IpSecService . create ( context , networkManagement ) ; \n + ipSecService = IpSecService . create ( context ) ; \n tests \ net \ java \ com \ android \ server \ IpSecServiceParameterizedTest . java \n - import android . os . INetworkManagementService ; \n - INetworkManagementService mNetworkManager ; \n - mNetworkManager = mock ( INetworkManagementService . class ) ; \n - mIpSecService = new IpSecService ( mMockContext , mNetworkManager , mMockIpSecSrvConfig ) ; \n + mIpSecService = new IpSecService ( mMockContext , mMockIpSecSrvConfig ) ; \n tests \ net \ java \ com \ android \ server \ IpSecServiceRefcountedResourceTest . java \n - import android . os . INetworkManagementService ; \n - mIpSecService = new IpSecService ( \n - mMockContext , mock ( INetworkManagementService . class ) , mMockIpSecSrvConfig ) ; \n + mIpSecService = new IpSecService ( mMockContext , mMockIpSecSrvConfig ) ; \n tests \ net \ java \ com \ android \ server \ IpSecServiceTest . java \n - import android . os . INetworkManagementService ; \n - INetworkManagementService mMockNetworkManager ; \n - mMockNetworkManager = mock ( INetworkManagementService . class ) ; \n - mIpSecService = new IpSecService ( mMockContext , mMockNetworkManager , mMockIpSecSrvConfig ) ; \n + mIpSecService = new IpSecService ( mMockContext , mMockIpSecSrvConfig ) ; \n - IpSecService ipSecSrv = IpSecService . create ( mMockContext , mMockNetworkManager ) ; \n + IpSecService ipSecSrv = IpSecService . create ( mMockContext ) ; \n - mMockContext , mMockNetworkManager , mMockIpSecSrvConfig , mockTagger ) ; \n + mMockContext , mMockIpSecSrvConfig , mockTagger ) ; \n","Remove unused INetworkManagementService from IpSecService \n IpSecService is no longer using any methods of \n INetworkManagementService , so remove it from IpSecService \n and related files . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I852e3a534e0ffd26b4b22420754f3ec8a6f153ad",646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + \n + pw . println ( ) ; \n + pw . println ( "" Legacy network activity : "" ) ; \n + pw . increaseIndent ( ) ; \n + mNetworkActivityTracker . dump ( pw ) ; \n + pw . decreaseIndent ( ) ; \n + \n + public void dump ( IndentingPrintWriter pw ) { \n + synchronized ( mActiveIdleTimers ) { \n + pw . print ( "" mNetworkActive = "" ) ; pw . println ( mNetworkActive ) ; \n + pw . println ( "" Idle timers : "" ) ; \n + for ( HashMap . Entry < String , IdleTimerParams > ent : mActiveIdleTimers . entrySet ( ) ) { \n + pw . print ( "" "" ) ; pw . print ( ent . getKey ( ) ) ; pw . println ( "" : "" ) ; \n + final IdleTimerParams params = ent . getValue ( ) ; \n + pw . print ( "" timeout = "" ) ; pw . print ( params . timeout ) ; \n + pw . print ( "" type = "" ) ; pw . println ( params . transportType ) ; \n + } \n + } \n + } \n",[ IT4 . 7 ] Add network activity info into dumpsys for debugging \n Add network activity info into part of ConnectivityService dump \n for debugging . \n Sample dump : \n Legacy network activity : \n mNetworkActive = true \n Idle timers : \n wlan0 : \n timeout = 15 type = 1 \n Bug : 170598012 \n Test : adb shell dumpsys connectivity \n Change - Id : Ie03e82767564543d8d143873d7ddc0ea07102cb2,646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n + \n + @ Override \n + public void onInterfaceLinkStateChanged ( String iface , boolean up ) { \n + for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n + nai . clatd . interfaceLinkStateChanged ( iface , up ) ; \n + } \n + } \n + \n + @ Override \n + public void onInterfaceRemoved ( String iface ) { \n + for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n + nai . clatd . interfaceRemoved ( iface ) ; \n + } \n + } \n services \ core \ java \ com \ android \ server \ connectivity \ Nat464Xlat . java \n - import com . android . server . net . BaseNetworkObserver ; \n - public class Nat464Xlat extends BaseNetworkObserver { \n + public class Nat464Xlat { \n - try { \n - mNMService . registerObserver ( this ) ; \n - } catch ( RemoteException e ) { \n - Log . e ( TAG , "" Can ' t register iface observer for clat on "" + mNetwork . toShortString ( ) ) ; \n - return ; \n - } \n - \n - try { \n - mNMService . unregisterObserver ( this ) ; \n - } catch ( RemoteException | IllegalStateException e ) { \n - Log . e ( TAG , "" Error unregistering clatd observer on "" + mBaseIface + "" : "" + e ) ; \n - } \n - @ Override \n - @ Override \n tests \ net \ java \ com \ android \ server \ connectivity \ Nat464XlatTest . java \n - verify ( mNms ) . registerObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . unregisterObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . registerObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . unregisterObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . registerObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . unregisterObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . registerObserver ( eq ( nat ) ) ; \n - verify ( mNms ) . unregisterObserver ( eq ( nat ) ) ; \n","Remove BaseNetworkObserver from Nat464Xlat \n Let ConnectivityService talk to Nat464Xlat through NetworkAgnetInfo \n directly : \n - Nat464Xlat will be created once there is a new network bringing up , \n but Netd doesn ' t expose the method for unregistering unsolicited event . \n - ConnectivityService has already registered netd unsolicited event \n listener , so Nat464Xlat doesn ' t need to register unsolicited event \n listenser by itself , it can get the unsolicited event from \n ConnectivityService directly . \n Bug : 174837473 \n Test : atest FrameworksNetTests \n Change - Id : I751526e8ffa7d25591696ecd8d93b1585c4c20c7",646
"core \ java \ android \ net \ NetworkRequest . java \n - MatchAllNetworkSpecifier . checkNotMatchAllNetworkSpecifier ( networkSpecifier ) ; \n + if ( networkSpecifier instanceof MatchAllNetworkSpecifier ) { \n + throw new IllegalArgumentException ( "" A MatchAllNetworkSpecifier is not permitted "" ) ; \n + } \n services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - MatchAllNetworkSpecifier . checkNotMatchAllNetworkSpecifier ( ns ) ; \n + if ( ns instanceof MatchAllNetworkSpecifier ) { \n + throw new IllegalArgumentException ( "" A MatchAllNetworkSpecifier is not permitted "" ) ; \n + } \n","Check if NetworkSpecifier is an instance of MatchAllNetworkSpecifier \n To prevent mainline module related file to access a hidden API , \n check whether the NetworkSpecifier is an instance of \n MatchAllNetworkSpecifier by itself . \n Bug : 172183305 \n Test : atest FrameworksNetTests \n Change - Id : I4d49cb70ff3c8a7e1ffa32e38207c74a6375e51a",646
core \ java \ android \ net \ ProxyInfo . java \n - String [ ] parsedExclList = in . readStringArray ( ) ; \n + String [ ] parsedExclList = in . createStringArray ( ) ; \n,"Use createStringArray instead of readStringArray \n To prevent ProxyInfo calling hidden API , use public one - \n Parcel # createStringArray ( ) instead . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I1a5376872d743e1863982bb95d579aeba7159d33",646
"core \ java \ android \ net \ MatchAllNetworkSpecifier . java \n - / * * \n - * Utility method which verifies that the ns argument is not a MatchAllNetworkSpecifier and \n - * throws an IllegalArgumentException if it is . \n - * @ hide \n - * / \n - public static void checkNotMatchAllNetworkSpecifier ( NetworkSpecifier ns ) { \n - if ( ns instanceof MatchAllNetworkSpecifier ) { \n - throw new IllegalArgumentException ( "" A MatchAllNetworkSpecifier is not permitted "" ) ; \n - } \n - } \n - \n","Remove unused method from MatchAllNetworkSpecifier \n checkNotMatchAllNetworkSpecifier is a hidden method inside \n MatchAllNetworkSpecifier , and the callers have implemented \n the logic by themselves to prevent calling hidden method . \n Remove it because there is no one using it . \n Bug : 172183305 \n Test : atest FrameworksNetTests \n Change - Id : I22a3a99f2b4ec6f4b57ef8867b72d48db2f0c1f6",646
"packages \ Connectivity \ framework \ src \ android \ net \ NetworkCapabilities . java \n + private < T extends Parcelable > void writeParcelableArraySet ( Parcel in , \n + @ Nullable ArraySet < T > val , int flags ) { \n + final int size = ( val ! = null ) ? val . size ( ) : - 1 ; \n + in . writeInt ( size ) ; \n + for ( int i = 0 ; i < size ; i + + ) { \n + in . writeParcelable ( val . valueAt ( i ) , flags ) ; \n + } \n + } \n + \n - dest . writeArraySet ( mUids ) ; \n + writeParcelableArraySet ( dest , mUids , flags ) ; \n - netCap . mUids = ( ArraySet < UidRange > ) in . readArraySet ( \n - null / * ClassLoader , null for default * / ) ; \n + netCap . mUids = readParcelableArraySet ( in , null / * ClassLoader , null for default * / ) ; \n + \n + private @ Nullable < T extends Parcelable > ArraySet < T > readParcelableArraySet ( Parcel in , \n + @ Nullable ClassLoader loader ) { \n + final int size = in . readInt ( ) ; \n + if ( size < 0 ) { \n + return null ; \n + } \n + final ArraySet < T > result = new ArraySet < > ( size ) ; \n + for ( int i = 0 ; i < size ; i + + ) { \n + final T value = in . readParcelable ( loader ) ; \n + result . append ( value ) ; \n + } \n + return result ; \n + } \n","Reimplement [ read | write ] ArraySet of Parcel inside NetworkCapabilities \n Both of readArraySet and writeArraySet are hidden APIs inside \n Parcel , so reimplement those two methods inside NetworkCapabilities \n to prevent calling hidden APIs . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I70f75c1a0db92c6a5575c6a9917843d783dfaeea",646
core \ java \ android \ net \ UidRange . java \n - return start / PER _ USER _ RANGE ; \n + return UserHandle . getUserHandleForUid ( start ) . getIdentifier ( ) ; \n - return stop / PER _ USER _ RANGE ; \n + return UserHandle . getUserHandleForUid ( stop ) . getIdentifier ( ) ; \n,"Use UserHandle # getIdentifier to get the userid \n UidRange uses PER _ USER _ RANGE to calculate and get the userid , \n but PER _ USER _ RANGE is a hidden API , so use getIdentifier to get \n the userid instead . \n Bug : 170598012 \n Test : atest FrameworksNetTests : UidRangeTest \n Change - Id : I06ab0f2da8a33d2b718bbc3a609d3d6a5fe0a095",646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - import android . os . INetworkManagementService ; \n - private INetworkManagementService mNMS ; \n - public ConnectivityService ( Context context , INetworkManagementService netManager , \n - INetworkStatsService statsService ) { \n - this ( context , netManager , statsService , getDnsResolver ( context ) , new IpConnectivityLog ( ) , \n + public ConnectivityService ( Context context , INetworkStatsService statsService ) { \n + this ( context , statsService , getDnsResolver ( context ) , new IpConnectivityLog ( ) , \n - protected ConnectivityService ( Context context , INetworkManagementService netManager , \n - INetworkStatsService statsService , IDnsResolver dnsresolver , IpConnectivityLog logger , \n + protected ConnectivityService ( Context context , INetworkStatsService statsService , \n + IDnsResolver dnsresolver , IpConnectivityLog logger , \n - mNMS = Objects . requireNonNull ( netManager , "" missing INetworkManagementService "" ) ; \n - mTNS = new TestNetworkService ( mContext , mNMS ) ; \n + mTNS = new TestNetworkService ( mContext ) ; \n services \ core \ java \ com \ android \ server \ ConnectivityServiceInitializer . java \n - import android . os . INetworkManagementService ; \n - mConnectivity = new ConnectivityService ( context , getNetworkManagementService ( ) , \n - getNetworkStatsService ( ) ) ; \n + mConnectivity = new ConnectivityService ( context , getNetworkStatsService ( ) ) ; \n - private INetworkManagementService getNetworkManagementService ( ) { \n - return INetworkManagementService . Stub . asInterface ( \n - ServiceManager . getService ( Context . NETWORKMANAGEMENT _ SERVICE ) ) ; \n - } \n - \n services \ core \ java \ com \ android \ server \ TestNetworkService . java \n - import android . os . INetworkManagementService ; \n - @ NonNull private final INetworkManagementService mNMS ; \n - protected TestNetworkService ( \n - @ NonNull Context context , @ NonNull INetworkManagementService netManager ) { \n + protected TestNetworkService ( @ NonNull Context context ) { \n - mNMS = Objects . requireNonNull ( netManager , "" missing INetworkManagementService "" ) ; \n tests \ net \ integration \ src \ com \ android \ server \ net \ integrationtests \ ConnectivityServiceIntegrationTest . kt \n - context , netManager , statsService , dnsResolver , log , netd , deps ) \n + context , statsService , dnsResolver , log , netd , deps ) \n tests \ net \ java \ com \ android \ server \ ConnectivityServiceTest . java \n - mNetworkManagementService , \n - reset ( mNetworkManagementService ) ; \n - reset ( mNetworkManagementService ) ; \n - reset ( mNetworkManagementService ) ; \n - reset ( mNetworkManagementService ) ; \n",Remove INetworkManagementService from ConnectivityService \n Remove INetworkManagementService from ConnectivityService and \n related files . \n Bug : 174837473 \n Test : atest FrameworksNetTests FrameworksNetIntegrationTests \n Change - Id : Ie6cfd77bbd64a8fd7539b0ea7fd15bf970e40c3d,646
"services \ core \ java \ com \ android \ server \ ConnectivityService . java \n - public void onInterfaceClassActivityChanged ( boolean isActive , int timerLabel , \n + public void onInterfaceClassActivityChanged ( boolean isActive , int transportType , \n - mNetworkActivityTracker . setAndReportNetworkActive ( isActive , timerLabel , timestampNs ) ; \n + mNetworkActivityTracker . setAndReportNetworkActive ( isActive , transportType , timestampNs ) ; \n - for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n + for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n - for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n + for ( NetworkAgentInfo nai : mNetworkAgentInfos ) { \n",Fix comments left on aosp / 1547454 and aosp / 1556106 \n Bug : 174837473 \n Test : atest FrameworksNetTests \n Change - Id : I35ed84fcc53725fe29896ec37b77ef4fb4778fde,646
"services \ core \ java \ com \ android \ server \ connectivity \ Vpn . java \n + import com . android . net . module . util . NetdUtils ; \n - mNms . setInterfaceUp ( mTunnelIface . getInterfaceName ( ) ) ; \n + NetdUtils . setInterfaceUp ( mNetd , mTunnelIface . getInterfaceName ( ) ) ; \n tests \ net \ java \ com \ android \ server \ connectivity \ VpnTest . java \n + import static android . net . INetd . IF _ STATE _ DOWN ; \n + import static android . net . INetd . IF _ STATE _ UP ; \n + import android . net . InterfaceConfigurationParcel ; \n - private NetworkCallback triggerOnAvailableAndGetCallback ( ) { \n + private NetworkCallback triggerOnAvailableAndGetCallback ( ) throws Exception { \n + / / onAvailable ( ) will trigger onDefaultNetworkChanged ( ) , so NetdUtils # setInterfaceUp will be \n + / / invoked . Set the return value of INetd # interfaceGetCfg to prevent NullPointerException . \n + final InterfaceConfigurationParcel config = new InterfaceConfigurationParcel ( ) ; \n + config . flags = new String [ ] { IF _ STATE _ DOWN } ; \n + when ( mNetd . interfaceGetCfg ( anyString ( ) ) ) . thenReturn ( config ) ; \n + private void verifyInterfaceSetCfgWithFlags ( String flag ) throws Exception { \n + / / Add a timeout for waiting for interfaceSetCfg to be called . \n + verify ( mNetd , timeout ( TEST _ TIMEOUT _ MS ) ) . interfaceSetCfg ( argThat ( \n + config - > Arrays . asList ( config . flags ) . contains ( flag ) ) ) ; \n + } \n + \n + verifyInterfaceSetCfgWithFlags ( IF _ STATE _ UP ) ; \n + \n + verifyInterfaceSetCfgWithFlags ( IF _ STATE _ UP ) ; \n + \n",Use NetdUtils instead of NetworkManagementService in Vpn \n NetdUtils has the same method ( e . g . setInterfaceUp ) as \n NetworkManagementService so using the one inside NetdUtils instead \n and try to remove NetworkManagementService from Vpn in \n the following commit . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I867556478fbc8c8ca8baa4e4c438a47b3beebe39,646
"services \ core \ java \ com \ android \ server \ IpSecService . java \n + import com . android . net . module . util . NetdUtils ; \n - mNetworkManager . setInterfaceUp ( intfName ) ; \n + NetdUtils . setInterfaceUp ( netd , intfName ) ; \n tests \ net \ java \ com \ android \ server \ IpSecServiceParameterizedTest . java \n + import static android . content . pm . PackageManager . PERMISSION _ GRANTED ; \n + import static android . net . INetd . IF _ STATE _ DOWN ; \n + import static android . net . INetd . IF _ STATE _ UP ; \n + import static org . mockito . ArgumentMatchers . argThat ; \n + import android . net . InterfaceConfigurationParcel ; \n + \n + @ Override \n + public int checkCallingOrSelfPermission ( String permission ) { \n + if ( android . Manifest . permission . NETWORK _ STACK . equals ( permission ) ) { \n + return PERMISSION _ GRANTED ; \n + } \n + throw new UnsupportedOperationException ( ) ; \n + } \n - String localAddr , String remoteAddr , String pkgName ) { \n + String localAddr , String remoteAddr , String pkgName ) throws Exception { \n + final InterfaceConfigurationParcel config = new InterfaceConfigurationParcel ( ) ; \n + config . flags = new String [ ] { IF _ STATE _ DOWN } ; \n + when ( mMockNetd . interfaceGetCfg ( anyString ( ) ) ) . thenReturn ( config ) ; \n - verify ( mNetworkManager ) . setInterfaceUp ( createTunnelResp . interfaceName ) ; \n + verify ( mMockNetd ) . interfaceSetCfg ( argThat ( \n + config - > Arrays . asList ( config . flags ) . contains ( IF _ STATE _ UP ) ) ) ; \n",Use NetdUtils instead of NetworkManagementService in IpSecService \n NetdUtils has the same method ( e . g . setInterfaceUp ) as \n NetworkManagementService so using the one inside NetdUtils instead \n and try to remove NetworkManagementService from IpSecService in \n the following commit . \n Bug : 170598012 \n Test : atest FrameworksNetTests \n Change - Id : I0ed8b0c678b067a655b51b938b6b40eadd985321,646
"core \ api \ module - lib - current . txt \n + field public static final String TEST _ TAP _ PREFIX = "" testtap "" ; \n packages \ Connectivity \ framework \ src \ android \ net \ TestNetworkManager . java \n - * @ hide \n","Expose TEST _ TAP _ PREFIX as system API \n TestNetworkManager is a part of connectivity mainline module and \n it is already a system API , but its constant - TEST _ TAP _ PREFIX \n is hidden , so expose it for the callers inside framework . \n Bug : 172183305 \n Test : make update - api \n Change - Id : I7fc08be4a6ca6325d5b576b761afda17865cefaa",646
library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - return new Matrix ( mSuppMatrix ) ; \n + return new Matrix ( getDrawMatrix ( ) ) ; \n,"Merger of # 122 pull request , return draw matrix for better integration",649
. travis . yml \n + branches : \n + only : \n + - dev \n + - master \n - java \n,"Travis CI config , to ignore Maven branch",649
"new file \n sample \ res \ layout \ activity _ view _ pager . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" utf - 8 "" ? > \n + < uk . co . senab . photoview . sample . HackyViewPager xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + android : id = "" @ + id / view _ pager "" \n + android : layout _ width = "" match _ parent "" \n + android : layout _ height = "" match _ parent "" / > \n sample \ src \ uk \ co \ senab \ photoview \ sample \ HackyViewPager . java \n + import android . util . AttributeSet ; \n + public HackyViewPager ( Context context , AttributeSet attrs ) { \n + super ( context , attrs ) ; \n + } \n + \n sample \ src \ uk \ co \ senab \ photoview \ sample \ ViewPagerActivity . java \n - \n - ViewPager mViewPager = new HackyViewPager ( this ) ; \n + setContentView ( R . layout . activity _ view _ pager ) ; \n + ViewPager mViewPager = ( HackyViewPager ) findViewById ( R . id . view _ pager ) ; \n","Modified sample , to provide XML layout for ViewPagerActivity",649
"library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + public boolean setRotation ( float degrees ) { \n + mSuppMatrix . postRotate ( degrees ) ; \n + checkAndDisplayMatrix ( ) ; \n + return true ; \n + } \n + \n sample \ res \ menu \ main _ menu . xml \n + < item \n + android : id = "" @ + id / menu _ rotate _ right "" \n + android : title = "" @ string / menu _ rotate _ right "" / > \n + < item \n + android : id = "" @ + id / menu _ rotate _ left "" \n + android : title = "" @ string / menu _ rotate _ left "" / > \n sample \ res \ values \ strings . xml \n + < string name = "" menu _ rotate _ left "" > Rotate - < / string > \n + < string name = "" menu _ rotate _ right "" > Rotate + < / string > \n sample \ src \ uk \ co \ senab \ photoview \ sample \ SimpleSampleActivity . java \n - private Matrix currentDisplayMatrix = null ; \n + private Matrix mCurrentDisplayMatrix = null ; \n + \n + private float mRotateAngle = 0 ; \n - if ( currentDisplayMatrix = = null ) \n + if ( mCurrentDisplayMatrix = = null ) \n - mAttacher . setDisplayMatrix ( currentDisplayMatrix ) ; \n + mAttacher . setDisplayMatrix ( mCurrentDisplayMatrix ) ; \n - currentDisplayMatrix = mAttacher . getDisplayMatrix ( ) ; \n + mCurrentDisplayMatrix = mAttacher . getDisplayMatrix ( ) ; \n + return true ; \n + case R . id . menu _ rotate _ left : \n + mRotateAngle + = 10 ; \n + mAttacher . setRotation ( mRotateAngle ) ; \n + return true ; \n + case R . id . menu _ rotate _ right : \n + mRotateAngle - = 10 ; \n + mAttacher . setRotation ( mRotateAngle ) ; \n","Example to use rotation of image , ad . # 69",649
"library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - ( imageView . getLeft ( ) ) / 2 , \n - ( imageView . getTop ( ) ) / 2 , \n + ( imageView . getRight ( ) ) / 2 , \n + ( imageView . getBottom ( ) ) / 2 , \n","setScale zooms to center , not to beginning of view",649
"library \ src \ uk \ co \ senab \ photoview \ IPhotoView . java \n + / * * \n + * Enables rotation via PhotoView internal functions . \n + * Name is chosen so it won ' t collide with View . setRotation ( float ) in API since 11 \n + * \n + * @ param rotationDegree - Degree to rotate PhotoView by , should be in range 0 to 360 \n + * / \n + void setPhotoViewRotation ( float rotationDegree ) ; \n + \n library \ src \ uk \ co \ senab \ photoview \ PhotoView . java \n + @ Override \n + public void setPhotoViewRotation ( float rotationDegree ) { \n + mAttacher . setPhotoViewRotation ( rotationDegree ) ; \n + } \n + \n library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - private float lastRotation = 0 ; \n + private float mLastRotation = 0 ; \n - public boolean setRotation ( float degrees ) { \n - mSuppMatrix . postRotate ( lastRotation - degrees ) ; \n - lastRotation = degrees ; \n + @ Override \n + public void setPhotoViewRotation ( float degrees ) { \n + degrees % = 360 ; \n + mSuppMatrix . postRotate ( mLastRotation - degrees ) ; \n + mLastRotation = degrees ; \n - return true ; \n","Rotation finalized with interface , javadoc and implementation",649
"library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + import android . util . FloatMath ; \n - return getValue ( mSuppMatrix , Matrix . MSCALE _ X ) ; \n + return FloatMath . sqrt ( FloatMath . pow ( getValue ( mSuppMatrix , Matrix . MSCALE _ X ) , 2 ) + FloatMath . pow ( getValue ( mSuppMatrix , Matrix . MSKEW _ Y ) , 2 ) ) ; \n","This fixes # 69 , as rotating and other functions work correctly now",649
"library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - mCurrentFlingRunnable . fling ( imageView . getWidth ( ) , \n - imageView . getHeight ( ) , ( int ) velocityX , ( int ) velocityY ) ; \n + mCurrentFlingRunnable . fling ( getImageViewWidth ( imageView ) , \n + getImageViewHeight ( imageView ) , ( int ) velocityX , ( int ) velocityY ) ; \n - final int viewHeight = imageView . getHeight ( ) ; \n + final int viewHeight = getImageViewHeight ( imageView ) ; \n - final int viewWidth = imageView . getWidth ( ) ; \n + final int viewWidth = getImageViewWidth ( imageView ) ; \n - final float viewWidth = imageView . getWidth ( ) ; \n - final float viewHeight = imageView . getHeight ( ) ; \n + final float viewWidth = getImageViewWidth ( imageView ) ; \n + final float viewHeight = getImageViewHeight ( imageView ) ; \n + private int getImageViewWidth ( ImageView imageView ) { \n + if ( null = = imageView ) \n + return 0 ; \n + return imageView . getWidth ( ) - imageView . getPaddingLeft ( ) - imageView . getPaddingRight ( ) ; \n + } \n + \n + private int getImageViewHeight ( ImageView imageView ) { \n + if ( null = = imageView ) \n + return 0 ; \n + return imageView . getHeight ( ) - imageView . getPaddingTop ( ) - imageView . getPaddingBottom ( ) ; \n + } \n + \n","Padding is now considered in PhotoViewAttacher , Fixes # 29",649
library \ src \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + / * * \n + * Removes set basic auth credentials \n + * * / \n + public void clearBasicAuth ( ) { \n + this . httpClient . getCredentialsProvider ( ) . clear ( ) ; \n + } \n + \n,"Fixes # 61 , allow removing of Basic Auth credentials",649
library \ src \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n + if ( null = = responseBody ) \n + return null ; \n,"Related to # 67 , avoiding NPE in JsonHttpResponseHandler",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - * Creates a new AsyncHttpClient . \n + * Creates a new AsyncHttpClient with default constructor arguments values \n - this ( false ) ; \n + this ( false , 80 , 443 ) ; \n + } \n + \n + / * * \n + * Creates a new AsyncHttpClient . \n + * \n + * @ param httpPort non - standard HTTP - only port \n + * / \n + public AsyncHttpClient ( int httpPort ) { \n + this ( false , httpPort , 443 ) ; \n + } \n + \n + / * * \n + * Creates a new AsyncHttpClient . \n + * \n + * @ param httpPort non - standard HTTP - only port \n + * @ param httpsPort non - standard HTTPS - only port \n + * / \n + public AsyncHttpClient ( int httpPort , int httpsPort ) { \n + this ( false , httpPort , httpsPort ) ; \n + * @ param httpPort non - standard HTTP - only port \n + * @ param httpsPort non - standard HTTPS - only port \n - public AsyncHttpClient ( boolean fixNoHttpResponseException ) { \n - if ( fixNoHttpResponseException ) \n + public AsyncHttpClient ( boolean fixNoHttpResponseException , int httpPort , int httpsPort ) { \n + if ( fixNoHttpResponseException ) \n - schemeRegistry . register ( new Scheme ( "" http "" , PlainSocketFactory . getSocketFactory ( ) , 80 ) ) ; \n - schemeRegistry . register ( new Scheme ( "" https "" , sslSocketFactory , 443 ) ) ; \n + schemeRegistry . register ( new Scheme ( "" http "" , PlainSocketFactory . getSocketFactory ( ) , httpPort ) ) ; \n + schemeRegistry . register ( new Scheme ( "" https "" , sslSocketFactory , httpsPort ) ) ; \n","Fixing # 79 , Allowing non - standard HTTP and HTTPS ports",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n + public String getCharset ( ) { \n + return this . responseCharset ; \n + } \n + \n - * @ param error the underlying cause of the failure \n - * @ param content the response body , if any \n + * @ param error the underlying cause of the failure \n + * @ param content the response body , if any \n - * @ param headers return headers , if any \n - * @ param error the underlying cause of the failure \n - * @ param content the response body , if any \n + * @ param headers return headers , if any \n + * @ param error the underlying cause of the failure \n + * @ param content the response body , if any \n - protected void sendFailureMessage ( Throwable e , byte [ ] responseBody ) { \n + protected void sendFailureMessage ( Throwable e , byte [ ] responseBody ) { \n - responseBody = EntityUtils . toString ( entity , responseCharset ) ; \n + responseBody = EntityUtils . toString ( entity , getCharset ( ) ) ; \n",Handy method to specify charset in anonymous inner instances,649
"library \ src \ uk \ co \ senab \ photoview \ IPhotoView . java \n + import android . graphics . Bitmap ; \n + / * * \n + * Extracts currently visible area to Bitmap object , if there is no image loaded yet or the \n + * ImageView is already destroyed , returns { @ code null } \n + * \n + * @ return currently visible area as bitmap or null \n + * / \n + public Bitmap getVisibleRectangleBitmap ( ) ; \n + \n library \ src \ uk \ co \ senab \ photoview \ PhotoView . java \n + import android . graphics . Bitmap ; \n + @ Override \n + public Bitmap getVisibleRectangleBitmap ( ) { \n + return mAttacher . getVisibleRectangleBitmap ( ) ; \n + } \n + \n library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + import android . graphics . Bitmap ; \n + imageView . setDrawingCacheEnabled ( true ) ; \n + public Bitmap getVisibleRectangleBitmap ( ) { \n + ImageView imageView = getImageView ( ) ; \n + return imageView = = null ? null : imageView . getDrawingCache ( ) ; \n + } \n + \n",Extracting currently visible area as Bitmap # 40,649
library \ src \ com \ loopj \ android \ http \ BinaryHttpResponseHandler . java \n - private static String [ ] mAllowedContentTypes = new String [ ] { \n + private String [ ] mAllowedContentTypes = new String [ ] { \n,"Fixed wrong static field , Closing # 229",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpRequest . java \n + import java . net . MalformedURLException ; \n - private void makeRequest ( ) throws IOException { \n + private void makeRequest ( ) throws IOException , InterruptedException { \n + / / Fixes # 115 \n + if ( request . getURI ( ) . getScheme ( ) = = null ) \n + throw new MalformedURLException ( "" No valid URI scheme was provided "" ) ; \n - / / TODO : should raise InterruptedException ? this block is reached whenever the request is cancelled before its response is received \n + throw new InterruptedException ( "" makeRequest was interrupted "" ) ; \n - if ( responseHandler ! = null ) { \n + if ( responseHandler ! = null ) { \n + } catch ( InterruptedException e ) { \n + cause = new IOException ( "" Request was interrupted while executing "" ) ; \n + retry = retryHandler . retryRequest ( cause , + + executionCount , context ) ; \n","Throwing malformed URL fixes # 115 , Throwing Interrupted exception fixes # 323",649
"library \ src \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n - onFailure ( e , "" "" ) ; \n + Log . v ( LOG _ TAG , "" response body is null , calling onFailure ( Throwable , JSONObject ) "" ) ; \n + onFailure ( e , ( JSONObject ) null ) ; \n - Log . d ( LOG _ TAG , "" JSON Parsing failed "" , ex ) ; \n + Log . v ( LOG _ TAG , "" JSON parsing failed , calling onFailure ( Throwable , JSONObject ) "" ) ; \n + onFailure ( ex , ( JSONObject ) null ) ; \n","Added log message , to notify about target method",649
"library \ src \ com \ loopj \ android \ http \ BaseJsonHttpResponseHandler . java \n - public void onSuccess ( int statusCode , Header [ ] headers , JSON _ TYPE response ) { \n + public void onSuccess ( int statusCode , Header [ ] headers , String rawResponse , JSON _ TYPE response ) { \n - public void onFailure ( int statusCode , Header [ ] headers , Throwable e , JSON _ TYPE errorResponse ) { \n + public void onFailure ( int statusCode , Header [ ] headers , Throwable e , String rawData , JSON _ TYPE errorResponse ) { \n - onSuccess ( statusCode , headers , jsonResponse ) ; \n + onSuccess ( statusCode , headers , responseBody , jsonResponse ) ; \n - onFailure ( statusCode , headers , t , ( JSON _ TYPE ) null ) ; \n + onFailure ( statusCode , headers , t , responseBody , null ) ; \n - onSuccess ( statusCode , headers , ( JSON _ TYPE ) null ) ; \n + onSuccess ( statusCode , headers , null , null ) ; \n - onFailure ( statusCode , headers , e , jsonResponse ) ; \n + onFailure ( statusCode , headers , e , responseBody , jsonResponse ) ; \n - onFailure ( statusCode , headers , e , ( JSON _ TYPE ) null ) ; \n + onFailure ( statusCode , headers , e , responseBody , null ) ; \n - onFailure ( statusCode , headers , e , ( JSON _ TYPE ) null ) ; \n + onFailure ( statusCode , headers , e , null , null ) ; \n","Added String response param , to ease the work with response",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n - return this . responseCharset ; \n + return this . responseCharset = = null ? DEFAULT _ CHARSET : this . responseCharset ; \n - String response = new String ( responseBody , getCharset ( ) ) ; \n + String response = responseBody = = null ? null : new String ( responseBody , getCharset ( ) ) ; \n","NPE fix in AsyncHttpResponseHandler , Fixes # 351",649
"library \ src \ com \ loopj \ android \ http \ RequestParams . java \n + protected boolean isRepeatable = false ; \n + public void setHttpEntityIsRepeatable ( boolean isRepeatable ) { \n + this . isRepeatable = isRepeatable ; \n + } \n + \n + entity . setIsRepeatable ( isRepeatable ) ; \n - public FileWrapper ( File file , String contentType ) { \n + public FileWrapper ( File file , String contentType ) { \n library \ src \ com \ loopj \ android \ http \ SimpleMultipartEntity . java \n + private boolean isRepeatable = false ; \n + public void setIsRepeatable ( boolean isRepeatable ) { \n + this . isRepeatable = isRepeatable ; \n + } \n + \n - return false ; \n + return isRepeatable ; \n","Allow RequestParams entity to be repeatable on - demand , # 362",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n - if ( response ! = null & & response . length > = 3 ) \n + if ( response ! = null & & response . length > = 3 ) { \n - else \n + } else { \n + } \n - if ( response ! = null & & response . length > = 4 ) \n + if ( response ! = null & & response . length > = 4 ) { \n - else \n + } else { \n + } \n - if ( response ! = null & & response . length > = 2 ) \n - onProgress ( ( Integer ) response [ 0 ] , ( Integer ) response [ 1 ] ) ; \n - else \n + if ( response ! = null & & response . length > = 2 ) { \n + try { \n + onProgress ( ( Integer ) response [ 0 ] , ( Integer ) response [ 1 ] ) ; \n + } catch ( Throwable t ) { \n + Log . e ( LOG _ TAG , "" custom onProgress contains an error "" , t ) ; \n + } \n + } else { \n + } \n","Safely wrapping around onProgress , so it doesn ' t interrupt communication , Closes # 356",649
README . md \n - Version : 1 . 4 . 3 \n + Version : 1 . 4 . 4 \n build . gradle \n - version = ' 1 . 4 . 4 - SNAPSHOT ' \n + version = ' 1 . 4 . 4 ' \n gradle . properties \n - VERSION _ NAME = 1 . 4 . 4 - SNAPSHOT \n + VERSION _ NAME = 1 . 4 . 4 \n,Prepare to release 1 . 4 . 4 to Maven Central,649
new file \n releases \ android - async - http - 1 . 4 . 4 . jar \n Binary files / dev / null and b / releases / android - async - http - 1 . 4 . 4 . jar differ \n,Added JAR for 1 . 4 . 4 release,649
"new file \n library \ AndroidManifest . xml \n + < ? xml version = "" 1 . 0 "" encoding = "" utf - 8 "" ? > \n + < manifest xmlns : android = "" http : / / schemas . android . com / apk / res / android "" \n + package = "" uk . co . senab . photoview "" \n + android : versionCode = "" 122 "" \n + android : versionName = "" 1 . 2 . 2 "" > \n + \n + < uses - sdk android : minSdkVersion = "" 4 "" / > \n + \n + < application / > \n + \n + < / manifest > \n new file \n library \ project . properties \n + # This file is automatically generated by Android Tools . \n + # Do not modify this file - - YOUR CHANGES WILL BE ERASED ! \n + # \n + # This file must be checked in Version Control Systems . \n + # \n + # To customize properties used by the Ant build system edit \n + # "" ant . properties "" , and override values to adapt the script to your \n + # project structure . \n + # \n + # To enable ProGuard to shrink and obfuscate your code , uncomment this ( available properties : sdk . dir , user . home ) : \n + # proguard . config = $ { sdk . dir } / tools / proguard / proguard - android . txt : proguard - project . txt \n + \n + # Project target . \n + target = android - 16 \n + android . library = true \n","Returned library build files , fixes # 76",649
". gitignore \n + \n + # Gradle \n + . gradle \n + gradle \n + build \n + \n new file \n build . gradle \n + buildscript { \n + repositories { \n + mavenCentral ( ) \n + } \n + \n + dependencies { \n + classpath ' com . android . tools . build : gradle : 0 . 5 . + ' \n + } \n + } \n + \n + allprojects { \n + group = ' uk . co . senab . photoview ' \n + version = ' 1 . 2 . 2 ' \n + \n + repositories { \n + mavenCentral ( ) \n + } \n + \n + tasks . withType ( Compile ) { \n + options . encoding = "" UTF - 8 "" \n + } \n + } \n + \n new file \n library \ build . gradle \n + apply plugin : ' android - library ' \n + \n + dependencies { \n + compile ' com . android . support : support - v4 : 18 . 0 . + ' \n + } \n + \n + android { \n + compileSdkVersion 18 \n + buildToolsVersion ' 18 . 0 . 1 ' \n + \n + sourceSets { \n + main { \n + manifest . srcFile ' AndroidManifest . xml ' \n + java . srcDirs = [ ' src ' ] \n + res . srcDirs = [ ' res ' ] \n + } \n + } \n + } \n new file \n sample \ build . gradle \n + apply plugin : ' android ' \n + \n + dependencies { \n + compile ' com . android . support : support - v4 : 18 . 0 . + ' \n + compile project ( ' : library ' ) \n + } \n + \n + android { \n + compileSdkVersion 18 \n + buildToolsVersion ' 18 . 0 . 1 ' \n + \n + sourceSets { \n + main { \n + manifest . srcFile ' AndroidManifest . xml ' \n + java . srcDirs = [ ' src ' ] \n + res . srcDirs = [ ' res ' ] \n + } \n + } \n + } \n new file \n settings . gradle \n + include ' library ' \n + include ' sample ' \n","Gradle , ignoring build temp files / directories and added build scripts",649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - threadPool = Executors . newFixedThreadPool ( DEFAULT _ MAX _ CONNECTIONS ) ; \n + threadPool = Executors . newCachedThreadPool ( ) ; \n,"Thread pool reverted , cached thread pool contains keepAlive timeout 60seconds and behaves better , Fixes # 382",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ RetryHandler . java \n - String requestType = currentReq . getMethod ( ) ; \n - retry = ! requestType . equals ( "" POST "" ) ; \n",Allowing to retry POST requests if underlying HttpEntity isRepeatable returns true,649
library \ src \ uk \ co \ senab \ photoview \ ScrollerProxy . java \n - } else { \n + } else if ( VERSION . SDK _ INT < VERSION _ CODES . ICE _ CREAM _ SANDWICH ) { \n + } else { \n + return new IcsScroller ( context ) ; \n + } \n + } \n + \n + @ TargetApi ( 14 ) \n + private static class IcsScroller extends GingerScroller { \n + \n + public IcsScroller ( Context context ) { \n + super ( context ) ; \n + \n + @ Override \n + public boolean computeScrollOffset ( ) { \n + return mScroller . computeScrollOffset ( ) ; \n + } \n + \n - private OverScroller mScroller ; \n + protected OverScroller mScroller ; \n + private boolean mFirstScroll = false ; \n + / / Workaround for first scroll returning 0 for the direction of the edge it hits . \n + / / Simply recompute values . \n + if ( mFirstScroll ) { \n + mScroller . computeScrollOffset ( ) ; \n + mFirstScroll = false ; \n + } \n,Fixes # 62 and # 63 ( Merge request overriden ),649
"sample \ res \ layout \ activity _ main . xml \n - xmlns : tools = "" http : / / schemas . android . com / tools "" \n - android : layout _ height = "" match _ parent "" > \n + android : layout _ height = "" match _ parent "" > \n - < ImageView \n + < uk . co . senab . photoview . PhotoView \n","Using PhotoView in Simple Sample , to test interface functions",649
library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - ImageView imageView = mImageView . get ( ) ; \n + ImageView imageView = getImageView ( ) ; \n,"Fixing wrong way of getting ImageView , fixing # 75",649
". travis . yml \n - find $ ANDROID _ HOME / build - tools \n - file $ ANDROID _ HOME / build - tools / 18 . 0 . 1 / aapt \n - - echo "" nexusUsername = dummy "" > > gradle . properties \n - - echo "" nexusPassword = dummy "" > > gradle . properties \n - echo "" nexusUsername = dummy "" > > library / gradle . properties \n - echo "" nexusPassword = dummy "" > > library / gradle . properties \n + \n maven _ push . gradle \n - if ( ! signing . hasProperty ( ' password ' ) ) { \n + if ( ext . hasProperty ( ' signing . keyId ' ) & & ! ext . hasProperty ( ' signing . password ' ) ) { \n - allprojects { \n - ext . set ( ' signing . password ' , System . console ( ) . readPassword ( "" \ n \ $ Type in GPG key password : "" ) ) \n - } \n + ext . set ( ' signing . password ' , System . console ( ) . readPassword ( "" \ n \ $ Type in GPG key password : "" ) ) \n - allprojects { ext . set ( ' signing . password ' , ' dummy ' ) } \n + ext . set ( ' signing . password ' , ' dummy ' ) \n - if ( ! project . ext . hasProperty ( ' nexusPassword ' ) ) { \n + if ( ! ext . hasProperty ( ' nexusPassword ' ) ) { \n - allprojects { \n - project . ext . set ( ' nexusPassword ' , new String ( System . console ( ) . readPassword ( "" \ n \ $ Type in password for Sonatype nexus account $ { nexusUsername } : "" ) ) ) \n - } \n + project . ext . set ( ' nexusPassword ' , new String ( System . console ( ) . readPassword ( "" \ n \ $ Type in password for Sonatype nexus account $ { nexusUsername } : "" ) ) ) \n - allprojects { project . ext . set ( ' nexusPassword ' , ' dummy ' ) } \n + project . ext . set ( ' nexusPassword ' , ' dummy ' ) \n","Not forcing sign , if there is no keyId",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import org . apache . http . HttpHost ; \n + import org . apache . http . conn . params . ConnRoutePNames ; \n + / * * \n + * Sets the Proxy by it ' s hostname and port \n + * \n + * @ param hostname the hostname ( IP or DNS name ) \n + * @ param port the port number . - 1 indicates the scheme default port . \n + * / \n + public void setProxy ( String hostname , int port ) { \n + final HttpHost proxy = new HttpHost ( hostname , port ) ; \n + final HttpParams httpParams = this . httpClient . getParams ( ) ; \n + httpParams . setParameter ( ConnRoutePNames . DEFAULT _ PROXY , proxy ) ; \n + } \n + \n","Added Proxy to interface , Fixes # 210",649
"library \ src \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + / * * \n + * Perform a HTTP DELETE request . \n + * \n + * @ param context the Android Context which initiated the request . \n + * @ param url the URL to send the request to . \n + * @ param headers set one - time headers for this request \n + * @ param params additional DELETE parameters or files to send along with request \n + * @ param responseHandler the response handler instance that should handle the response . \n + * / \n + public void delete ( Context context , String url , Header [ ] headers , RequestParams params , AsyncHttpResponseHandler responseHandler ) { \n + HttpDelete httpDelete = new HttpDelete ( getUrlWithQueryString ( url , params ) ) ; \n + if ( headers ! = null ) httpDelete . setHeaders ( headers ) ; \n + sendRequest ( httpClient , httpContext , httpDelete , null , responseHandler , context ) ; \n + } \n + \n","DELETE request with params , Fixed # 259",649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n - / / Set up a handler to post events back to the correct thread if possible \n - if ( Looper . myLooper ( ) ! = null ) { \n - handler = new ResponderHandler ( this ) ; \n - } \n + / / Init Looper by calling postRunnable without argument \n + postRunnable ( null ) ; \n - if ( runnable ! = null ) { \n + boolean missingLooper = null ! = Looper . myLooper ( ) ; \n + if ( missingLooper ) { \n + Looper . prepare ( ) ; \n + } \n + if ( null = = handler ) { \n + handler = new ResponderHandler ( this ) ; \n + } \n + if ( null ! = runnable ) { \n + if ( missingLooper ) { \n + Looper . loop ( ) ; \n + } \n - int buffersize = ( contentLength < 0 ) ? BUFFER _ SIZE : ( int ) contentLength ; \n + int buffersize = ( contentLength < 0 ) ? BUFFER _ SIZE : ( int ) contentLength ; \n,Possibility to use library on non - UI thread ( calling Looper . prepare ) # 397,649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n - if ( service ! = null ) { \n + if ( null ! = service ) { \n - boolean missingLooper = null ! = Looper . myLooper ( ) ; \n + boolean missingLooper = null = = Looper . myLooper ( ) ; \n,"Refactoring gone wrong , flipped condition # 397",649
build . gradle \n - classpath ' com . android . tools . build : gradle : 0 . 6 . + ' \n + classpath ' com . android . tools . build : gradle : 0 . 7 . + ' \n library \ build . gradle \n + \n + lintOptions { \n + abortOnError false \n + } \n maven _ push . gradle \n - \n + if ( isReleaseBuild ( ) ) { \n + } \n sample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 0 . 6 . + ' \n + classpath ' com . android . tools . build : gradle : 0 . 7 . + ' \n + \n + lintOptions { \n + abortOnError false \n + } \n + \n + packagingOptions { \n + exclude ' META - INF / DEPENDENCIES ' \n + exclude ' META - INF / LICENSE ' \n + exclude ' META - INF / NOTICE ' \n + } \n,"Fixed debug build , simplified sonatype for release only and updated gradle to 1 . 9 ( gradle build tools 7 . +",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ RequestParams . java \n + import android . util . Log ; \n + \n + protected final static String LOG _ TAG = "" RequestParams "" ; \n + protected String contentEncoding = HTTP . UTF _ 8 ; \n + \n + / * * \n + * Sets content encoding for return value of { @ link # getParamString ( ) } and { @ link \n + * # createFormEntity ( ) } < p > & nbsp ; < / p > Default encoding is "" UTF - 8 "" \n + * \n + * @ param encoding String constant from { @ link org . apache . http . protocol . HTTP } \n + * / \n + public void setContentEncoding ( final String encoding ) { \n + if ( encoding ! = null ) \n + this . contentEncoding = encoding ; \n + else \n + Log . d ( LOG _ TAG , "" setContentEncoding called with null attribute "" ) ; \n + } \n - return new UrlEncodedFormEntity ( getParamsList ( ) , HTTP . UTF _ 8 ) ; \n + return new UrlEncodedFormEntity ( getParamsList ( ) , contentEncoding ) ; \n - return null ; / / Actually cannot happen when using utf - 8 \n + Log . e ( LOG _ TAG , "" createFormEntity failed "" , e ) ; \n + return null ; / / Can happen , if the ' contentEncoding ' won ' t be HTTP . UTF _ 8 \n - return URLEncodedUtils . format ( getParamsList ( ) , HTTP . UTF _ 8 ) ; \n + return URLEncodedUtils . format ( getParamsList ( ) , contentEncoding ) ; \n","Provided setter for encoding in RequestParams , closes # 406",649
. travis . yml \n - export TERM = dumb \n - wget http : / / services . gradle . org / distributions / gradle - 1 . 9 - bin . zip \n - - unzip - qq gradle - 1 . 8 - bin . zip \n - - export GRADLE _ HOME = $ PWD / gradle - 1 . 8 \n + - unzip - qq gradle - 1 . 9 - bin . zip \n + - export GRADLE _ HOME = $ PWD / gradle - 1 . 9 \n - export PATH = $ GRADLE _ HOME / bin : $ PATH \n - gradle - v \n,"sorry for spamming , this should finally fix Travis",649
". travis . yml \n - export PATH = $ { PATH } : $ { ANDROID _ HOME } / tools : $ { ANDROID _ HOME } / platform - tools \n - echo "" sdk . dir = $ ANDROID _ HOME "" > local . properties \n + # list packages for debug purpose \n + - android list sdk - a - e - u \n - echo yes | android update sdk - t tools , platform - tools , extra - android - support , extra - android - m2repository , android - 19 , build - tools - 19 . 0 . 0 - - force - - no - ui \n - echo "" nexusUsername = dummy "" > > library / gradle . properties \n",Android SDK not accepting build - tools - 19 . 0 . 0 filter,649
"library \ src \ uk \ co \ senab \ photoview \ gestures \ FroyoGestureDetector . java \n - mListener . onScale ( detector . getScaleFactor ( ) , \n + float scaleFactor = detector . getScaleFactor ( ) ; \n + \n + if ( Float . isNaN ( scaleFactor ) | | Float . isInfinite ( scaleFactor ) ) \n + return false ; \n + \n + mListener . onScale ( scaleFactor , \n","NaN / infinite check on request , Closing # 126",649
"library \ src \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - public final boolean canZoom ( ) { \n + public boolean canZoom ( ) { \n - public final void cleanup ( ) { \n + public void cleanup ( ) { \n - public final RectF getDisplayRect ( ) { \n + public RectF getDisplayRect ( ) { \n - public final ImageView getImageView ( ) { \n + public ImageView getImageView ( ) { \n - public final float getScale ( ) { \n + public float getScale ( ) { \n - public final ScaleType getScaleType ( ) { \n + public ScaleType getScaleType ( ) { \n - public final void onDrag ( float dx , float dy ) { \n + public void onDrag ( float dx , float dy ) { \n - public final void onFling ( float startX , float startY , float velocityX , \n + public void onFling ( float startX , float startY , float velocityX , \n - public final void onGlobalLayout ( ) { \n + public void onGlobalLayout ( ) { \n - public final void onScale ( float scaleFactor , float focusX , float focusY ) { \n + @ Override \n + public void onScale ( float scaleFactor , float focusX , float focusY ) { \n - public final boolean onTouch ( View v , MotionEvent ev ) { \n + public boolean onTouch ( View v , MotionEvent ev ) { \n - public final void setOnLongClickListener ( OnLongClickListener listener ) { \n + public void setOnLongClickListener ( OnLongClickListener listener ) { \n - public final void setOnMatrixChangeListener ( OnMatrixChangedListener listener ) { \n + public void setOnMatrixChangeListener ( OnMatrixChangedListener listener ) { \n - public final void setOnPhotoTapListener ( OnPhotoTapListener listener ) { \n + public void setOnPhotoTapListener ( OnPhotoTapListener listener ) { \n - public final OnPhotoTapListener getOnPhotoTapListener ( ) { \n + public OnPhotoTapListener getOnPhotoTapListener ( ) { \n - public final void setOnViewTapListener ( OnViewTapListener listener ) { \n + public void setOnViewTapListener ( OnViewTapListener listener ) { \n - public final OnViewTapListener getOnViewTapListener ( ) { \n + public OnViewTapListener getOnViewTapListener ( ) { \n - public final void setScaleType ( ScaleType scaleType ) { \n + public void setScaleType ( ScaleType scaleType ) { \n - public final void setZoomable ( boolean zoomable ) { \n + public void setZoomable ( boolean zoomable ) { \n - public final void update ( ) { \n + public void update ( ) { \n","De - finalized implementation of PhotoViewAttacher , Closes # 112",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + / * * \n + * Will , before sending , remove all headers currently present in AsyncHttpClient instance , \n + * which applies on all requests this client makes \n + * \n + * @ param header the name of the header \n + * @ param value the contents of the header \n + * / \n + public void removeAllHeaders ( ) { \n + clientHeaderMap . clear ( ) ; \n + } \n + \n",Provided way to clear all headers Closing # 581,649
library \ build . gradle \n - apply plugin : ' android - library ' \n + apply plugin : ' com . android . library ' \n + disable ' OldTargetApi ' \n sample \ build . gradle \n - apply plugin : ' android ' \n + apply plugin : ' com . android . application ' \n + disable ' OldTargetApi ' \n,"Not forcing build with API 20 Preview ( or 20 wearable ) , unless the API is stable",649
". travis . yml \n - ' . + ' \n - # for gradle output style \n - - export TERM = dumb \n - echo "" nexusUsername = dummy "" > > library / gradle . properties \n - echo "" nexusPassword = dummy "" > > library / gradle . properties \n","Not required lines for Travis , DUMB terminal by default",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + if ( request . containsHeader ( header ) ) { \n + Header overwritten = request . getFirstHeader ( header ) ; \n + Log . d ( LOG _ TAG , \n + String . format ( "" Headers were overwritten ! ( % s | % s ) overwrites ( % s | % s ) "" , \n + header , clientHeaderMap . get ( header ) , \n + overwritten . getName ( ) , overwritten . getValue ( ) ) \n + ) ; \n + } \n","Added warning , when headers overwrite each other , Closes # 488",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ RequestParams . java \n + / * * \n + * Adds a int value to the request . \n + * \n + * @ param key the key name for the new param . \n + * @ param value the value int for the new param . \n + * / \n + public void put ( String key , int value ) { \n + if ( key ! = null ) { \n + urlParams . put ( key , String . valueOf ( value ) ) ; \n + } \n + } \n + \n + / * * \n + * Adds a long value to the request . \n + * \n + * @ param key the key name for the new param . \n + * @ param value the value long for the new param . \n + * / \n + public void put ( String key , long value ) { \n + if ( key ! = null ) { \n + urlParams . put ( key , String . valueOf ( value ) ) ; \n + } \n + } \n + \n","Possibility to add int and long request params , # 423",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n + } else if ( jsonResponse instanceof String ) { \n + onFailure ( statusCode , headers , ( String ) jsonResponse , new JSONException ( "" Response cannot be parsed as JSON data "" ) ) ; \n",Correct validation of returned String where JSON is expected,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import java . net . URI ; \n - return sendRequest ( httpClient , httpContext , addEntityToRequestBase ( new HttpPost ( url ) , entity ) , contentType , responseHandler , context ) ; \n + return sendRequest ( httpClient , httpContext , addEntityToRequestBase ( new HttpPost ( URI . create ( url ) . normalize ( ) ) , entity ) , contentType , responseHandler , context ) ; \n - HttpEntityEnclosingRequestBase request = new HttpPost ( url ) ; \n + HttpEntityEnclosingRequestBase request = new HttpPost ( URI . create ( url ) . normalize ( ) ) ; \n - HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPost ( url ) , entity ) ; \n + HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPost ( URI . create ( url ) . normalize ( ) ) , entity ) ; \n - return sendRequest ( httpClient , httpContext , addEntityToRequestBase ( new HttpPut ( url ) , entity ) , contentType , responseHandler , context ) ; \n + return sendRequest ( httpClient , httpContext , addEntityToRequestBase ( new HttpPut ( URI . create ( url ) . normalize ( ) ) , entity ) , contentType , responseHandler , context ) ; \n - HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPut ( url ) , entity ) ; \n + HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPut ( URI . create ( url ) . normalize ( ) ) , entity ) ; \n - final HttpDelete delete = new HttpDelete ( url ) ; \n + final HttpDelete delete = new HttpDelete ( URI . create ( url ) . normalize ( ) ) ; \n - final HttpDelete delete = new HttpDelete ( url ) ; \n + final HttpDelete delete = new HttpDelete ( URI . create ( url ) . normalize ( ) ) ; \n","Normalize URL before request , removing # fragment part of URL , Closing # 479",649
sample \ src \ main \ java \ uk \ co \ senab \ photoview \ sample \ RotationSampleActivity . java \n - private float currentRotation = 0 ; \n - currentRotation + = 10 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationBy ( 10 ) ; \n - currentRotation - = 10 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationBy ( - 10 ) ; \n - currentRotation = 0 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationTo ( 0 ) ; \n - currentRotation = 90 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationTo ( 90 ) ; \n - currentRotation = 180 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationTo ( 180 ) ; \n - currentRotation = 270 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationTo ( 270 ) ; \n - currentRotation + = 1 ; \n - photo . setPhotoViewRotation ( currentRotation ) ; \n + photo . setRotationBy ( 1 ) ; \n,"Fixed deprecation , using new methods setRotationBy ( float ) and setRotationTo ( float )",649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ IPhotoView . java \n - \n + \n - \n + \n - void setRotationBy ( float rotationDegree ) ; \n + void setRotationBy ( float rotationDegree ) ; \n + \n + / * * \n + * Will return instance of IPhotoView ( eg . PhotoViewAttacher ) , can be used to provide better \n + * integration \n + * \n + * @ return IPhotoView implementation instance if available , null if not \n + * / \n + IPhotoView getIPhotoViewImplementation ( ) ; \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoView . java \n + @ Override \n + public IPhotoView getIPhotoViewImplementation ( ) { \n + return mAttacher ; \n + } \n + \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + @ Override \n + public IPhotoView getIPhotoViewImplementation ( ) { \n + return this ; \n + } \n + \n","Added method IPhotoView getIPhotoViewImplementation ( ) , closing # 139",649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ IPhotoView . java \n + import android . view . GestureDetector ; \n + \n + / * * \n + * Sets custom double tap listener , to intercept default given functions . To reset behavior to \n + * default , you can just pass in "" null "" or public field of PhotoViewAttacher . defaultOnDoubleTapListener \n + * \n + * @ param newOnDoubleTapListener custom OnDoubleTapListener to be set on ImageView \n + * / \n + public void setOnDoubleTapListener ( GestureDetector . OnDoubleTapListener newOnDoubleTapListener ) ; \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoView . java \n + import android . view . GestureDetector ; \n - mAttacher . setPhotoViewRotation ( rotationDegree ) ; \n + mAttacher . setRotationTo ( rotationDegree ) ; \n + @ Override \n + public void setOnDoubleTapListener ( GestureDetector . OnDoubleTapListener newOnDoubleTapListener ) { \n + mAttacher . setOnDoubleTapListener ( newOnDoubleTapListener ) ; \n + } \n + \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - / * * \n - * Sets custom double tap listener , to intercept default given functions . To reset behavior to \n - * default , you can just pass in "" null "" or public field of PhotoViewAttacher . defaultOnDoubleTapListener \n - * \n - * @ param newOnDoubleTapListener custom OnDoubleTapListener to be set on ImageView \n - * / \n + @ Override \n",Added setOnDoubleTapListener interface method on IPhotoView with underlying implementation,649
library \ pom . xml \n + \n + < build > \n + < plugins > \n + < plugin > \n + < groupId > com . jayway . maven . plugins . android . generation2 < / groupId > \n + < artifactId > android - maven - plugin < / artifactId > \n + < / plugin > \n + < / plugins > \n + < / build > \n pom . xml \n - < version > 7 < / version > \n + < version > 9 < / version > \n - < android - maven . version > 3 . 8 . 0 < / android - maven . version > \n + < android - maven . version > 3 . 8 . 2 < / android - maven . version > \n + < sourceCompatibility > 1 . 6 < / sourceCompatibility > \n + < androidManifestFile > $ { project . basedir } / src / main / AndroidManifest . xml < / androidManifestFile > \n + < resourceDirectory > $ { project . basedir } / src / main / res < / resourceDirectory > \n - < sourceDirectory > src < / sourceDirectory > \n sample \ pom . xml \n + < dependency > \n + < groupId > com . nostra13 . universalimageloader < / groupId > \n + < artifactId > universal - image - loader < / artifactId > \n + < version > 1 . 9 . 1 < / version > \n + < / dependency > \n,"Fixed Maven configuration to work with latest SDK , project layout and sample dependencies",649
library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - if ( mAllowParentInterceptOnEdge ) { \n + if ( mAllowParentInterceptOnEdge & & ! mScaleDragDetector . isScaling ( ) ) { \n,"Closing # 103 , Fix problem of scrolling within ViewPager",649
. travis . yml \n - export TERM = dumb \n - - wget http : / / services . gradle . org / distributions / gradle - 1 . 10 - bin . zip \n - - unzip - qq gradle - 1 . 10 - bin . zip \n - - export GRADLE _ HOME = $ PWD / gradle - 1 . 10 \n + - wget http : / / services . gradle . org / distributions / gradle - 1 . 11 - bin . zip \n + - unzip - qq gradle - 1 . 11 - bin . zip \n + - export GRADLE _ HOME = $ PWD / gradle - 1 . 11 \n - export PATH = $ GRADLE _ HOME / bin : $ PATH \n - gradle - v \n,New Gradle Android plugin requires Gradle version 1 . 11,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - uriRequest . setHeader ( HEADER _ CONTENT _ TYPE , contentType ) ; \n + if ( uriRequest instanceof HttpEntityEnclosingRequestBase & & ( ( HttpEntityEnclosingRequestBase ) uriRequest ) . getEntity ( ) ! = null ) { \n + Log . w ( LOG _ TAG , "" Passed contentType will be ignored because HttpEntity sets content type "" ) ; \n + } else { \n + uriRequest . setHeader ( HEADER _ CONTENT _ TYPE , contentType ) ; \n + } \n","Not setting Content - Type if HttpEntity was set , as it breaks eg . multipart / form - data boundaries",649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - return - 1 ; \n + return wrappedEntity = = null ? 0 : wrappedEntity . getContentLength ( ) ; \n,Fixed reporting progress on InflatingEntity ( wrapped compressed HttpEntity ),649
"sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ FilesSample . java \n - params . put ( "" fileOne "" , createTempFile ( "" fileOne "" , 1020 ) , contentType ) ; \n + params . put ( "" fileOne "" , createTempFile ( "" fileOne "" , 1020 ) , contentType , "" fileOne "" ) ; \n - params . put ( "" fileThree "" , createTempFile ( "" fileThree "" , 1040 ) , contentType ) ; \n + params . put ( "" fileThree "" , createTempFile ( "" fileThree "" , 1040 ) , contentType , "" customFileThree "" ) ; \n - params . put ( "" fileFive "" , createTempFile ( "" fileFive "" , 1060 ) , contentType ) ; \n + params . put ( "" fileFive "" , createTempFile ( "" fileFive "" , 1060 ) , contentType , "" testingFileFive "" ) ; \n + params . setHttpEntityIsRepeatable ( true ) ; \n + params . setUseJsonStreamer ( false ) ; \n",Modified FilesSample to provide use - case for custom file names via RequestParams,649
library \ src \ main \ java \ com \ loopj \ android \ http \ RequestParams . java \n - public static class FileWrapper { \n + public static class FileWrapper implements Serializable { \n,"FileWrapper to be serializable , Closes # 705",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import android . os . Looper ; \n - * Returns the current executor service used . By default , \n - * Executors . newFixedThreadPool ( ) is used . \n + * Returns the current executor service used . By default , Executors . newFixedThreadPool ( ) is \n + * used . \n - protected ExecutorService getDefaultThreadPool ( ) { \n + protected ExecutorService getDefaultThreadPool ( ) { \n - public void cancelRequests ( Context context , boolean mayInterruptIfRunning ) { \n - List < RequestHandle > requestList = requestMap . get ( context ) ; \n - if ( requestList ! = null ) { \n - for ( RequestHandle requestHandle : requestList ) { \n - requestHandle . cancel ( mayInterruptIfRunning ) ; \n + public void cancelRequests ( final Context context , final boolean mayInterruptIfRunning ) { \n + if ( context = = null ) { \n + Log . e ( LOG _ TAG , "" Passed null Context to cancelRequests "" ) ; \n + return ; \n + } \n + Runnable r = new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + List < RequestHandle > requestList = requestMap . get ( context ) ; \n + if ( requestList ! = null ) { \n + for ( RequestHandle requestHandle : requestList ) { \n + requestHandle . cancel ( mayInterruptIfRunning ) ; \n + } \n + requestMap . remove ( context ) ; \n + } \n - requestMap . remove ( context ) ; \n + } ; \n + if ( Looper . myLooper ( ) = = Looper . getMainLooper ( ) ) { \n + new Thread ( r ) . start ( ) ; \n + } else { \n + r . run ( ) ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpRequest . java \n - if ( mayInterruptIfRunning & & request ! = null & & ! request . isAborted ( ) ) { \n - new Thread ( new Runnable ( ) { \n - @ Override \n - public void run ( ) { \n - request . abort ( ) ; \n - } \n - } ) ; \n - } \n + request . abort ( ) ; \n","Not starting many threads to cancel requests , just one # 533",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - public static final String VERSION = "" 1 . 4 . 5 "" ; \n - HttpProtocolParams . setUserAgent ( httpParams , String . format ( "" android - async - http / % s ( http : / / loopj . com / android - async - http ) "" , VERSION ) ) ; \n new file \n sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ GzipSample . java \n + package com . loopj . android . http . sample ; \n + \n + / * * \n + * Created by msebera on 21 / 04 / 14 . \n + * / \n + public class GzipSample { \n + } \n","Removed UserAgent identifier , for complete library transparency",649
deleted file \n gradle \ wrapper \ gradle - wrapper . jar \n Binary files a / gradle / wrapper / gradle - wrapper . jar and / dev / null differ \n deleted file \n gradle \ wrapper \ gradle - wrapper . properties \n - # Sat Apr 26 18 : 45 : 38 BST 2014 \n - distributionBase = GRADLE _ USER _ HOME \n - distributionPath = wrapper / dists \n - zipStoreBase = GRADLE _ USER _ HOME \n - zipStorePath = wrapper / dists \n - distributionUrl = http \ : / / services . gradle . org / distributions / gradle - 1 . 11 - bin . zip \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ IPhotoView . java \n + * @ param finalMatrix target matrix to set PhotoView to \n + * \n + * @ return current ImageView . ScaleType \n + * \n + * @ param allow whether to allow intercepting by parent element or not \n - * < p / > \n + * < p > & nbsp ; < / p > \n + * \n + * @ param minScale minimum allowed scale \n + * \n + * @ param minimumScale minimum allowed scale \n - * < p / > \n + * < p > & nbsp ; < / p > \n + * \n + * @ param midScale medium scale preset \n + * \n + * @ param mediumScale medium scale preset \n - * < p / > \n + * < p > & nbsp ; < / p > \n + * \n + * @ param maxScale maximum allowed scale preset \n + * \n + * @ param maximumScale maximum allowed scale preset \n rename from sample \ res \ menu \ viewpager _ menu . xml \n rename to sample \ src \ main \ res \ menu \ viewpager _ menu . xml \n,"Lint errors in IPhotoView fixed , viewpager _ menu moved to correct location",649
"sample \ src \ main \ AndroidManifest . xml \n - android : versionName = "" 2 . 0 "" > \n + android : versionName = "" 1 . 4 . 6 "" > \n",United version of Sample application with version of library itself,649
"CHANGELOG . md \n - Fixed URL encoding feature , that was breaking whole URL , not just path and query parts \n - FileAsyncHttpResponseHandler now checks that target file path is available or can be created \n - DataAsyncHttpResponseHandler was sending cancel notification instead of progress notification , fixed \n + - Added support for HTTP PATCH requests \n new file \n NOTICE . txt \n + Android Async Http Client library \n + Copyright ( c ) 2011 - 2014 James Smith < james @ loopj . com > \n + http : / / loopj . com \n + \n + This product includes software developed by \n + The Apache Software Foundation ( http : / / www . apache . org / ) . \n",Added legal NOTICE for including codebase from Apache HttpClient implementation,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import org . apache . http . conn . ClientConnectionManager ; \n - ThreadSafeClientConnManager cm = new ThreadSafeClientConnManager ( httpParams , schemeRegistry ) ; \n + ClientConnectionManager cm = createConnectionManager ( schemeRegistry , httpParams ) ; \n + Utils . asserts ( cm ! = null , "" Custom implementation of # createConnectionManager ( SchemeRegistry , BasicHttpParams ) returned null "" ) ; \n + / * * \n + * Provided so it is easier for developers to provide custom ThreadSafeClientConnManager implementation \n + * \n + * @ param schemeRegistry SchemeRegistry , usually provided by { @ link # getDefaultSchemeRegistry ( boolean , int , int ) } \n + * @ param httpParams BasicHttpParams \n + * @ return ClientConnectionManager instance \n + * / \n + protected ClientConnectionManager createConnectionManager ( SchemeRegistry schemeRegistry , BasicHttpParams httpParams ) { \n + return new ThreadSafeClientConnManager ( httpParams , schemeRegistry ) ; \n + } \n + \n - \n + \n - \n + \n - * @ param params additional PUT parameters or files to send with the request . \n - \n + \n - HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPatch ( URI . create ( url ) . normalize ( ) ) , entity ) ; \n - if ( headers ! = null ) request . setHeaders ( headers ) ; \n - return sendRequest ( httpClient , httpContext , request , contentType , responseHandler , context ) ; \n + HttpEntityEnclosingRequestBase request = addEntityToRequestBase ( new HttpPatch ( URI . create ( url ) . normalize ( ) ) , entity ) ; \n + if ( headers ! = null ) request . setHeaders ( headers ) ; \n + return sendRequest ( httpClient , httpContext , request , contentType , responseHandler , context ) ; \n - \n + \n","Fixed javadocs for createConnectionManager , and asserted error when custom implemenation would return null",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ SaxAsyncHttpResponseHandler . java \n - } catch ( SAXException e ) { \n - Log . e ( LOG _ TAG , "" getResponseData exception "" , e ) ; \n - } catch ( ParserConfigurationException e ) { \n + } catch ( SAXException | ParserConfigurationException e ) { \n library \ src \ main \ java \ com \ loopj \ android \ http \ Utils . java \n + / * * \n + * Provides general assert utils , which are stripped by Android SDK on \n + * compile / runtime , to work on release builds \n + * / \n + / * * \n + * Will throw AssertionError , if expression is not true \n + * \n + * @ param expression result of your asserted condition \n + * @ param failedMessage message to be included in error log \n + * @ throws java . lang . AssertionError \n + * / \n + / * * \n + * Will throw IllegalArgumentException if provided object is null on runtime \n + * \n + * @ param argument object that should be asserted as not null \n + * @ param name name of the object asserted \n + * @ throws java . lang . IllegalArgumentException \n + * / \n sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ RangeResponseSample . java \n + \n - import java . io . File ; \n - import java . io . IOException ; \n + \n + import java . io . File ; \n + import java . io . IOException ; \n + \n - file . delete ( ) ; \n + if ( ! file . delete ( ) ) { \n + Log . e ( LOG _ TAG , String . format ( "" Couldn ' t remove temporary file in path : % s "" , file . getAbsolutePath ( ) ) ) ; \n + } \n - RangeResponseSample . this , \n - "" Unable to determine remote file ' s size , or \ nremote server doesn ' t support ranges "" , \n - Toast . LENGTH _ LONG \n + RangeResponseSample . this , \n + "" Unable to determine remote file ' s size , or \ nremote server doesn ' t support ranges "" , \n + Toast . LENGTH _ LONG \n","Fixed various javadoc , lint and documentation issues",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n - Utils . asserts ( file . getParentFile ( ) . mkdirs ( ) , "" Cannot create parent directories for requested File location "" ) ; \n + if ( ! file . getParentFile ( ) . isDirectory ( ) ) { \n + Utils . asserts ( file . getParentFile ( ) . mkdirs ( ) , "" Cannot create parent directories for requested File location "" ) ; \n + } \n","Fixed mkdirs assertion , mkdirs can return false if directories already exist",649
". travis . yml \n - echo "" sdk . dir = $ ANDROID _ HOME "" > local . properties \n - android list sdk - a - e - u \n - - echo yes | android update sdk - t tools , platform - tools , extra - android - support , extra - android - m2repository , android - 19 , build - tools - 19 . 0 . 3 - - force - - no - ui \n + - echo yes | android update sdk - t tools , platform - tools , extra - android - support , extra - android - m2repository , android - 19 , build - tools - 19 . 1 - - force - - no - ui \n - echo "" nexusUsername = dummy "" > > library / gradle . properties \n - echo "" nexusPassword = dummy "" > > library / gradle . properties \n library \ build . gradle \n - buildToolsVersion ' 19 . 0 . 3 ' \n + buildToolsVersion ' 19 . 1 ' \n sample \ build . gradle \n - buildToolsVersion ' 19 . 0 . 3 ' \n + buildToolsVersion ' 19 . 1 ' \n",Updated build configuration for latest Android SDK distribution package,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ BinaryHttpResponseHandler . java \n - "" image / png "" \n + "" image / png "" , \n + "" image / gif "" , \n + "" application / octet - stream "" \n",Added additional default binary response handled content types # 573,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - * on underlying HttpClient , effects of this method will be canceled . \n - * < p > & nbsp ; < / p > \n - * Default setting is to disallow redirects . \n + * on underlying HttpClient , effects of this method will be canceled . < p > & nbsp ; < / p > Default \n + * setting is to disallow redirects . \n + if ( url = = null ) \n + return null ; \n + \n","Handling correctly null URLs in calls , related to # 572",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n - assert ( file ! = null ) ; \n + AssertUtils . asserts ( file ! = null , "" File passed into FileAsyncHttpResponseHandler constructor must not be null "" ) ; \n - assert ( context ! = null ) ; \n + AssertUtils . asserts ( context ! = null , "" Tried creating temporary file without having Context "" ) ; \n + / / not effective in release mode \n + assert context ! = null ; \n","Replaced assert calls with AssertUtils . asserts , which are handled properly in release mode",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n + protected final boolean append ; \n + this ( file , false ) ; \n + } \n + \n + / * * \n + * Obtains new FileAsyncHttpResponseHandler and stores response in passed file \n + * \n + * @ param file File to store response within , must not be null \n + * @ param append whether data should be appended to existing file \n + * / \n + public FileAsyncHttpResponseHandler ( File file , boolean append ) { \n + this . append = append ; \n + this . append = false ; \n - FileOutputStream buffer = new FileOutputStream ( getTargetFile ( ) ) ; \n + FileOutputStream buffer = new FileOutputStream ( getTargetFile ( ) , this . append ) ; \n",Added option to append downloaded data to File if it already exists,649
"sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ SampleParentActivity . java \n + import android . view . Menu ; \n + import android . view . MenuItem ; \n - protected static final String PROTOCOL = "" https : / / "" ; \n + private static final int MENU _ USE _ HTTPS = 0 ; \n + private static final int MENU _ CLEAR _ VIEW = 1 ; \n + \n + private boolean useHttps = true ; \n + \n + protected static final String PROTOCOL _ HTTP = "" http : / / "" ; \n + protected static final String PROTOCOL _ HTTPS = "" https : / / "" ; \n + \n + protected static String PROTOCOL = PROTOCOL _ HTTPS ; \n + @ Override \n + public boolean onPrepareOptionsMenu ( Menu menu ) { \n + MenuItem useHttpsMenuItem = menu . findItem ( MENU _ USE _ HTTPS ) ; \n + if ( useHttpsMenuItem ! = null ) { \n + useHttpsMenuItem . setChecked ( useHttps ) ; \n + } \n + return super . onPrepareOptionsMenu ( menu ) ; \n + } \n + \n + @ Override \n + public boolean onCreateOptionsMenu ( Menu menu ) { \n + menu . add ( Menu . NONE , MENU _ USE _ HTTPS , R . string . menu _ use _ https , Menu . NONE ) . setCheckable ( true ) ; \n + menu . add ( Menu . NONE , MENU _ CLEAR _ VIEW , R . string . menu _ clear _ view , Menu . NONE ) ; \n + return super . onCreateOptionsMenu ( menu ) ; \n + } \n + \n + @ Override \n + public boolean onOptionsItemSelected ( MenuItem item ) { \n + switch ( item . getItemId ( ) ) { \n + case MENU _ USE _ HTTPS : \n + useHttps = ! useHttps ; \n + PROTOCOL = useHttps ? PROTOCOL _ HTTPS : PROTOCOL _ HTTP ; \n + return true ; \n + case MENU _ CLEAR _ VIEW : \n + clearOutputs ( ) ; \n + return true ; \n + } \n + return super . onOptionsItemSelected ( item ) ; \n + } \n + \n sample \ src \ main \ res \ values \ strings . xml \n + < string name = "" menu _ use _ https "" > Use HTTPS < / string > \n + < string name = "" menu _ clear _ view "" > Clear Outputs < / string > \n + \n",Globally allowing to set HTTP / HTTPS mode in Samples and clearing sample outputs,649
"sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ SampleParentActivity . java \n + import android . annotation . TargetApi ; \n + import android . os . Build ; \n + setHomeAsUpEnabled ( ) ; \n + \n - menu . add ( Menu . NONE , MENU _ USE _ HTTPS , R . string . menu _ use _ https , Menu . NONE ) . setCheckable ( true ) ; \n - menu . add ( Menu . NONE , MENU _ CLEAR _ VIEW , R . string . menu _ clear _ view , Menu . NONE ) ; \n + menu . add ( Menu . NONE , MENU _ USE _ HTTPS , Menu . NONE , R . string . menu _ use _ https ) . setCheckable ( true ) ; \n + menu . add ( Menu . NONE , MENU _ CLEAR _ VIEW , Menu . NONE , R . string . menu _ clear _ view ) ; \n + case android . R . id . home : \n + finish ( ) ; \n + return true ; \n + \n + @ TargetApi ( Build . VERSION _ CODES . HONEYCOMB ) \n + private void setHomeAsUpEnabled ( ) { \n + if ( Integer . valueOf ( Build . VERSION . SDK ) > = 11 ) { \n + if ( getActionBar ( ) ! = null ) \n + getActionBar ( ) . setDisplayHomeAsUpEnabled ( true ) ; \n + } \n + } \n","Wrong order of params in creating menu items , Home button now jumps out of current sample",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - this . httpClient . getCredentialsProvider ( ) . setCredentials ( scope = = null ? AuthScope . ANY : scope , credentials ) ; \n + setCredentials ( scope , credentials ) ; \n + public void setCredentials ( AuthScope authScope , Credentials credentials ) { \n + if ( credentials = = null ) { \n + Log . d ( LOG _ TAG , "" Provided credentials are null , not setting "" ) ; \n + return ; \n + } \n + this . httpClient . getCredentialsProvider ( ) . setCredentials ( authScope = = null ? AuthScope . ANY : authScope , credentials ) ; \n + } \n + \n + * \n + * @ deprecated \n + @ Deprecated \n + clearCredentialsProvider ( ) ; \n + } \n + \n + / * * \n + * Removes previously set auth credentials \n + * / \n + public void clearCredentialsProvider ( ) { \n","Universal method to set credentials via AsyncHttpClient interface , deprecated clearBasicAuth because it ' s not just about basic auth from now on",649
"library \ src \ main \ AndroidManifest . xml \n - < application android : allowBackup = "" true "" / > \n + < application / > \n","Library shouldn ' t use allowbackup in AndroidManifest , Closing # 199",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import java . lang . reflect . Field ; \n + / * * \n + * This horrible hack is required on Android , due to implementation of BasicManagedEntity , which \n + * doesn ' t chain call consumeContent on underlying wrapped HttpEntity \n + * \n + * @ param entity HttpEntity , may be null \n + * / \n + public static void endEntityViaReflection ( HttpEntity entity ) { \n + if ( entity instanceof HttpEntityWrapper ) { \n + try { \n + Field f = null ; \n + Field [ ] fields = HttpEntityWrapper . class . getDeclaredFields ( ) ; \n + for ( Field ff : fields ) { \n + if ( ff . getName ( ) . equals ( "" wrappedEntity "" ) ) { \n + f = ff ; \n + break ; \n + } \n + } \n + if ( f ! = null ) { \n + f . setAccessible ( true ) ; \n + HttpEntity wrapped = ( HttpEntity ) f . get ( entity ) ; \n + if ( wrapped ! = null ) { \n + wrapped . consumeContent ( ) ; \n + } \n + } \n + } catch ( Throwable t ) { \n + Log . e ( LOG _ TAG , "" wrappedEntity consume "" , t ) ; \n + } \n + } \n + } \n + \n + \n + InputStream wrappedStream ; \n + PushbackInputStream pushbackStream ; \n + GZIPInputStream gzippedStream ; \n + \n - PushbackInputStream content = new PushbackInputStream ( wrappedEntity . getContent ( ) , 2 ) ; \n - if ( isInputStreamGZIPCompressed ( content ) ) { \n - return new GZIPInputStream ( content ) ; \n + wrappedStream = wrappedEntity . getContent ( ) ; \n + pushbackStream = new PushbackInputStream ( wrappedStream , 2 ) ; \n + if ( isInputStreamGZIPCompressed ( pushbackStream ) ) { \n + gzippedStream = new GZIPInputStream ( pushbackStream ) ; \n + return gzippedStream ; \n - return content ; \n + return pushbackStream ; \n + \n + @ Override \n + public void consumeContent ( ) throws IOException { \n + AsyncHttpClient . silentCloseInputStream ( wrappedStream ) ; \n + AsyncHttpClient . silentCloseInputStream ( pushbackStream ) ; \n + AsyncHttpClient . silentCloseInputStream ( gzippedStream ) ; \n + super . consumeContent ( ) ; \n + } \n library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n + AsyncHttpClient . endEntityViaReflection ( entity ) ; \n","Fixed GZIPInputStream Explicit termination method ' end ' not called error , Fixes # 613",649
"sample \ src \ main \ AndroidManifest . xml \n + < activity android : name = "" . PersistentCookiesSample "" / > \n sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ PersistentCookiesSample . java \n + client . setEnableRedirects ( true ) ; \n",Fixed PersistentCookiSample to allow redirects ( httpbin redirects circulary on / cookie ) and added into Manifest to be runnable,649
"README . md \n - Version : 1 . 4 . 5 - SNAPSHOT \n + Version : 1 . 4 . 6 - SNAPSHOT \n + Gradle : ` com . loopj . android : async - http - client : 1 . 4 . 6 - SNAPSHOT ` \n - Version : 1 . 4 . 4 \n + Version : 1 . 4 . 5 \n + Gradle : ` com . loopj . android : async - http - client : 1 . 4 . 5 ` \n - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - \n build . gradle \n - version = ' 1 . 4 . 5 - SNAPSHOT ' \n + version = ' 1 . 4 . 5 ' \n gradle . properties \n - VERSION _ NAME = 1 . 4 . 5 - SNAPSHOT \n + VERSION _ NAME = 1 . 4 . 5 \n library \ src \ main \ AndroidManifest . xml \n - android : versionName = "" 1 . 4 . 5 - SNAPSHOT "" \n + android : versionName = "" 1 . 4 . 5 "" \n",Updated to 1 . 4 . 5 to release into Maven Central,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import java . io . PushbackInputStream ; \n + / * * \n + * Checks the InputStream if it contains GZIP compressed data \n + * \n + * @ param inputStream InputStream to be checked \n + * @ return true or false if the stream contains GZIP compressed data \n + * / \n + public static boolean isInputStreamGZIPCompressed ( final PushbackInputStream inputStream ) throws IOException { \n + if ( inputStream = = null ) \n + return false ; \n + \n + byte [ ] signature = new byte [ 2 ] ; \n + int readStatus = inputStream . read ( signature ) ; \n + inputStream . unread ( signature ) ; \n + int streamHeader = ( ( int ) signature [ 0 ] & 0xff ) | ( ( signature [ 1 ] < < 8 ) & 0xff00 ) ; \n + return readStatus = = 2 & & GZIPInputStream . GZIP _ MAGIC = = streamHeader ; \n + } \n + \n - return new GZIPInputStream ( wrappedEntity . getContent ( ) ) ; \n + PushbackInputStream content = new PushbackInputStream ( wrappedEntity . getContent ( ) , 2 ) ; \n + if ( isInputStreamGZIPCompressed ( content ) ) { \n + return new GZIPInputStream ( content ) ; \n + } else { \n + return content ; \n + } \n",Decompressing returned InputStream only if it ontains GZIP / DEFLATE compressed data ( signature check ),649
library \ build . gradle \n - abortOnError false \n + xmlReport false \n + warningsAsErrors true \n + quiet false \n + showAll true \n - sourceCompatibility JavaVersion . VERSION _ 1 _ 7 \n - targetCompatibility JavaVersion . VERSION _ 1 _ 7 \n + sourceCompatibility JavaVersion . VERSION _ 1 _ 6 \n + targetCompatibility JavaVersion . VERSION _ 1 _ 6 \n sample \ build . gradle \n - abortOnError false \n + xmlReport false \n + warningsAsErrors true \n + quiet false \n + showAll true \n,"Strict Gradle build , lint errors must be properly handled , not ignored",649
"sample \ src \ main \ java \ com \ loopj \ android \ http \ sample \ FilesSample . java \n - params . put ( "" fileOne "" , createTempFile ( "" fileOne "" , 20 ) ) ; \n - params . put ( "" fileTwo "" , createTempFile ( "" fileTwo "" , 30 ) ) ; \n - params . put ( "" fileThree "" , createTempFile ( "" fileThree "" , 40 ) ) ; \n - params . put ( "" fileFour "" , createTempFile ( "" fileFour "" , 50 ) ) ; \n - params . put ( "" fileFive "" , createTempFile ( "" fileFive "" , 60 ) ) ; \n + final String contentType = "" application / octet - stream "" ; \n + params . put ( "" fileOne "" , createTempFile ( "" fileOne "" , 1020 ) , contentType ) ; \n + params . put ( "" fileTwo "" , createTempFile ( "" fileTwo "" , 1030 ) , contentType ) ; \n + params . put ( "" fileThree "" , createTempFile ( "" fileThree "" , 1040 ) , contentType ) ; \n + params . put ( "" fileFour "" , createTempFile ( "" fileFour "" , 1050 ) , contentType ) ; \n + params . put ( "" fileFive "" , createTempFile ( "" fileFive "" , 1060 ) , contentType ) ; \n","Modified Sample uploading multiple files , to contain proper content - type",649
"library \ build . gradle \n + android . libraryVariants . all { variant - > \n + def name = variant . buildType . name \n + def task = project . tasks . create "" jar $ { name . capitalize ( ) } "" , Jar \n + task . dependsOn variant . javaCompile \n + task . from variant . javaCompile . destinationDir \n + artifacts . add ( ' archives ' , task ) ; \n + } \n + \n",Releasing both JAR and AAR for library project,649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n - if ( responseHandler instanceof RangeFileAsyncHttpResponseHandler ) \n - ( ( RangeFileAsyncHttpResponseHandler ) responseHandler ) . updateRequestHeaders ( uriRequest ) ; \n - \n library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpRequest . java \n + if ( responseHandler instanceof RangeFileAsyncHttpResponseHandler ) { \n + ( ( RangeFileAsyncHttpResponseHandler ) responseHandler ) . updateRequestHeaders ( request ) ; \n + } \n + \n,"Manually merged # 678 , RangeFileAsyncHttpResponseHandler was unuseful in synchronized request mode",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n + Utils . asserts ( ! file . isDirectory ( ) , "" File passed into FileAsyncHttpResponseHandler constructor must not point to directory "" ) ; \n",Passing directory into FileAsyncHttpResponseHandler instead of file is not supported yet,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + import java . io . UnsupportedEncodingException ; \n + import java . net . URLEncoder ; \n - if ( shouldEncodeUrl ) \n - url = url . replace ( "" "" , "" % 20 "" ) ; \n + if ( shouldEncodeUrl ) { \n + try { \n + url = URLEncoder . encode ( url , "" UTF - 8 "" ) ; \n + } catch ( UnsupportedEncodingException e ) { \n + / / Should not really happen , added just for sake of validity \n + Log . e ( LOG _ TAG , "" getUrlWithQueryString encoding URL "" , e ) ; \n + } \n + } \n","Using standardised way of encoding URLs , Closing # 691",649
library \ src \ main \ java \ com \ loopj \ android \ http \ RequestHandle . java \n + import android . os . Looper ; \n + \n - public boolean cancel ( boolean mayInterruptIfRunning ) { \n - AsyncHttpRequest _ request = request . get ( ) ; \n - return _ request = = null | | _ request . cancel ( mayInterruptIfRunning ) ; \n + public boolean cancel ( final boolean mayInterruptIfRunning ) { \n + final AsyncHttpRequest _ request = request . get ( ) ; \n + if ( _ request ! = null ) { \n + if ( Looper . myLooper ( ) = = Looper . getMainLooper ( ) ) { \n + new Thread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + _ request . cancel ( mayInterruptIfRunning ) ; \n + } \n + } ) . start ( ) ; \n + } else { \n + _ request . cancel ( mayInterruptIfRunning ) ; \n + } \n + } \n + return false ; \n,"Fixed NetworkOnMainThreadException when cancelling requests by RequestHandle , Closes # 686",649
"CHANGELOG . md \n + # # 1 . 4 . 7 ( future version ) \n + \n + - Fixed crash when canceling through RequestHandle from UI Thread ( NetworkOnMainThreadException ) \n + \n build . gradle \n - version = ' 1 . 4 . 6 ' \n + version = ' 1 . 4 . 7 - SNAPSHOT ' \n gradle . properties \n - VERSION _ NAME = 1 . 4 . 6 \n - VERSION _ CODE = 146 \n + VERSION _ NAME = 1 . 4 . 7 - SNAPSHOT \n + VERSION _ CODE = 147 \n library \ src \ main \ AndroidManifest . xml \n - android : versionName = "" 1 . 4 . 6 "" \n - android : versionCode = "" 146 "" > \n + android : versionName = "" 1 . 4 . 7 "" \n + android : versionCode = "" 147 "" > \n sample \ src \ main \ AndroidManifest . xml \n - android : versionCode = "" 2 "" \n - android : versionName = "" 1 . 4 . 6 "" > \n + android : versionCode = "" 3 "" \n + android : versionName = "" 1 . 4 . 7 "" > \n",Prepare version 1 . 4 . 7 ( now SNAPSHOT ),649
"library \ src \ main \ java \ com \ loopj \ android \ http \ FileAsyncHttpResponseHandler . java \n - AssertUtils . asserts ( getTargetFile ( ) . getParentFile ( ) . mkdirs ( ) , "" Cannot create parent directories for requested File location "" ) ; \n + AssertUtils . asserts ( file . getParentFile ( ) . mkdirs ( ) , "" Cannot create parent directories for requested File location "" ) ; \n","Accessing getTargetFile ( ) before value is assigned , Closing # 743",649
"sample \ src \ main \ res \ values \ strings . xml \n + < string name = "" title _ async _ background _ thread "" > Async on background thread < / string > \n","Fixed missing String value in Samples , see fc745f8226b9d04effa10c5c68ee65b1b3f62a9c",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpResponseHandler . java \n + public static final String UTF8 _ BOM = "" \ uFEFF "" ; \n library \ src \ main \ java \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n + if ( jsonString . startsWith ( UTF8 _ BOM ) ) { \n + jsonString = jsonString . substring ( 1 ) ; \n + } \n library \ src \ main \ java \ com \ loopj \ android \ http \ TextHttpResponseHandler . java \n - return stringBytes = = null ? null : new String ( stringBytes , charset ) ; \n + String toReturn = ( stringBytes = = null ) ? null : new String ( stringBytes , charset ) ; \n + if ( toReturn ! = null & & toReturn . startsWith ( UTF8 _ BOM ) ) \n + return toReturn . substring ( 1 ) ; \n + return toReturn ; \n","Removing UTF8 BOM if the response is parsed and returned as String , Closes # 659",649
build . gradle \n - classpath ' com . android . tools . build : gradle : + ' \n + classpath ' com . android . tools . build : gradle : 0 . 12 . 2 ' \n library \ build . gradle \n - disable ' OldTargetApi ' \n + disable ' OldTargetApi ' \n sample \ build . gradle \n - classpath ' com . android . tools . build : gradle : 0 . + ' \n + classpath ' com . android . tools . build : gradle : 0 . 12 . 2 ' \n,"Tested and statically set specific version of Android Gradle Plugin , for stability",649
". travis . yml \n - - build - tools - 21 . 1 . 1 \n + - build - tools - 21 . 1 . 2 \n - extra - android - support \n - extra - android - m2repository \n - android - 21 \n build . gradle \n - classpath ' com . android . tools . build : gradle : 0 . 14 . 4 ' \n + classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' \n library \ build . gradle \n - compile "" com . android . support : support - v4 : 21 . 0 . 0 "" \n + compile "" com . android . support : support - v4 : 21 . 0 . 3 "" \n - buildToolsVersion ' 21 . 1 . 1 ' \n + buildToolsVersion ' 21 . 1 . 2 ' \n sample \ build . gradle \n - buildToolsVersion ' 21 . 1 . 1 ' \n + buildToolsVersion ' 21 . 1 . 2 ' \n","Updated Gradle build , Travis CI build tools version",649
library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoView . java \n - private final PhotoViewAttacher mAttacher ; \n + private PhotoViewAttacher mAttacher ; \n + init ( ) ; \n + } \n + \n + protected void init ( ) { \n - \n + \n + @ Override \n + protected void onAttachedToWindow ( ) { \n + init ( ) ; \n + super . onAttachedToWindow ( ) ; \n + } \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - mImageView = new WeakReference < ImageView > ( imageView ) ; \n + mImageView = new WeakReference < > ( imageView ) ; \n,"onAttachedToWindow re - init the library , Closes # 225 , Closes # 209",649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ IPhotoView . java \n - * \n + * * \n + * \n - public void setOnDoubleTapListener ( GestureDetector . OnDoubleTapListener newOnDoubleTapListener ) ; \n + void setOnDoubleTapListener ( GestureDetector . OnDoubleTapListener newOnDoubleTapListener ) ; \n + \n + / * * \n + * Will report back about scale changes \n + * \n + * @ param onScaleChangeListener OnScaleChangeListener instance \n + * / \n + void setOnScaleChangeListener ( PhotoViewAttacher . OnScaleChangeListener onScaleChangeListener ) ; \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoView . java \n + @ Override \n + public void setOnScaleChangeListener ( PhotoViewAttacher . OnScaleChangeListener onScaleChangeListener ) { \n + mAttacher . setOnScaleChangeListener ( onScaleChangeListener ) ; \n + } \n + \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + private OnScaleChangeListener mScaleChangeListener ; \n - if ( newOnDoubleTapListener ! = null ) \n + if ( newOnDoubleTapListener ! = null ) { \n - else \n + } else { \n + } \n + } \n + \n + @ Override \n + public void setOnScaleChangeListener ( OnScaleChangeListener onScaleChangeListener ) { \n + this . mScaleChangeListener = onScaleChangeListener ; \n - float velocityY ) { \n + float velocityY ) { \n + if ( null ! = mScaleChangeListener ) { \n + mScaleChangeListener . onScaleChange ( scaleFactor , focusX , focusY ) ; \n + } \n + \n + / * * \n + * Interface definition for callback to be invoked when attached ImageView scale changes \n + * \n + * @ author Marek Sebera \n + * / \n + public static interface OnScaleChangeListener { \n + / * * \n + * Callback for when the scale changes \n + * \n + * @ param previousScale original scale before change \n + * @ param focusX focal point X position \n + * @ param focusY focal point Y position \n + * / \n + void onScaleChange ( float previousScale , float focusX , float focusY ) ; \n + } \n + \n","Added onScaleChangeListener , set interface method and implementation , Closes # 173",649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ IPhotoView . java \n + / * * \n + * Allows to set all three scale levels at once , so you don ' t run into problem with setting \n + * medium / minimum scale before the maximum one \n + * \n + * @ param minimumScale minimum allowed scale \n + * @ param mediumScale medium allowed scale \n + * @ param maximumScale maximum allowed scale preset \n + * / \n + void setScaleLevels ( float minimumScale , float mediumScale , float maximumScale ) ; \n + \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoView . java \n + @ Override \n + public void setScaleLevels ( float minimumScale , float mediumScale , float maximumScale ) { \n + mAttacher . setScaleLevels ( minimumScale , mediumScale , maximumScale ) ; \n + } \n + \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + @ Override \n + public void setScaleLevels ( float minimumScale , float mediumScale , float maximumScale ) { \n + checkZoomLevels ( minimumScale , mediumScale , maximumScale ) ; \n + mMinScale = minimumScale ; \n + mMidScale = mediumScale ; \n + mMaxScale = maximumScale ; \n + } \n + \n","Added method to set all three scale levels at once , Closes # 170",649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n + this ( imageView , true ) ; \n + } \n + \n + public PhotoViewAttacher ( ImageView imageView , boolean zoomable ) { \n - setZoomable ( true ) ; \n + setZoomable ( zoomable ) ; \n","Added alternative constructor to disable zooming functionality , Closes # 169",649
"README . md \n + # # Pull Requests / Contribution \n + Development happens in * * dev * * branch of this repository , and Pull Requests should be filled against that branch . \n + Any Pull Request against * * master * * will be rejected \n + \n","Updated README to be clear about PR being filled against master branch , # 232 [ ci skip ]",649
"build . gradle \n - classpath ' com . android . tools . build : gradle : 1 . 0 . 0 ' \n + classpath ' com . android . tools . build : gradle : 1 . 1 . 0 ' \n library \ build . gradle \n - compile "" com . android . support : support - v4 : 21 . 0 . 3 "" \n + compile "" com . android . support : support - v4 : 22 . 0 . 0 "" \n - compileSdkVersion 21 \n - buildToolsVersion ' 21 . 1 . 2 ' \n + compileSdkVersion 22 \n + buildToolsVersion ' 22 . 0 . 1 ' \n - targetSdkVersion 21 \n + targetSdkVersion 22 \n sample \ build . gradle \n + compile ' com . intellij : annotations : 12 . 0 ' \n - compileSdkVersion 21 \n - buildToolsVersion ' 21 . 1 . 2 ' \n + compileSdkVersion 22 \n + buildToolsVersion ' 22 . 0 . 1 ' \n - targetSdkVersion 21 \n + targetSdkVersion 22 \n sample \ src \ main \ java \ uk \ co \ senab \ photoview \ sample \ HackyViewPager . java \n - if ( ! isLocked ) { \n - return super . onTouchEvent ( event ) ; \n - } \n - return false ; \n + return ! isLocked & & super . onTouchEvent ( event ) ; \n sample \ src \ main \ java \ uk \ co \ senab \ photoview \ sample \ ViewPagerActivity . java \n + import android . support . annotation . NonNull ; \n - protected void onSaveInstanceState ( Bundle outState ) { \n + protected void onSaveInstanceState ( @ NonNull Bundle outState ) { \n","Build upgraded to API 22 , support libraries , intellij annotations",649
. travis . yml \n - - build - tools - 21 . 1 . 2 \n + - build - tools - 22 . 0 . 1 \n - extra - android - support \n - extra - android - m2repository \n - - android - 21 \n + - android - 22 \n - ' . + ' \n,Travis updated android - 22 and build tools dependency,649
"library \ src \ main \ java \ uk \ co \ senab \ photoview \ PhotoViewAttacher . java \n - import android . util . FloatMath ; \n - Log . i ( LOG _ TAG , \n + LogManager . getLogger ( ) . i ( LOG _ TAG , \n - return FloatMath . sqrt ( ( float ) Math . pow ( getValue ( mSuppMatrix , Matrix . MSCALE _ X ) , 2 ) + ( float ) Math . pow ( getValue ( mSuppMatrix , Matrix . MSKEW _ Y ) , 2 ) ) ; \n + return ( float ) Math . sqrt ( ( float ) Math . pow ( getValue ( mSuppMatrix , Matrix . MSCALE _ X ) , 2 ) + ( float ) Math . pow ( getValue ( mSuppMatrix , Matrix . MSKEW _ Y ) , 2 ) ) ; \n - if ( null ! = parent ) \n + if ( null ! = parent ) { \n - else \n - Log . i ( LOG _ TAG , "" onTouch getParent ( ) returned null "" ) ; \n + } else { \n + LogManager . getLogger ( ) . i ( LOG _ TAG , "" onTouch getParent ( ) returned null "" ) ; \n + } \n - * @ param scaleFactor the scale factor ( < 1 for zoom out , > 1 for zoom in ) \n - * @ param focusX focal point X position \n - * @ param focusY focal point Y position \n + * @ param scaleFactor the scale factor ( < 1 for zoom out , > 1 for zoom in ) \n + * @ param focusX focal point X position \n + * @ param focusY focal point Y position \n library \ src \ main \ java \ uk \ co \ senab \ photoview \ gestures \ CupcakeGestureDetector . java \n - import android . util . FloatMath ; \n - import android . util . Log ; \n + import uk . co . senab . photoview . log . LogManager ; \n + \n - Log . i ( LOG _ TAG , "" Velocity tracker is null "" ) ; \n + LogManager . getLogger ( ) . i ( LOG _ TAG , "" Velocity tracker is null "" ) ; \n - mIsDragging = FloatMath . sqrt ( ( dx * dx ) + ( dy * dy ) ) > = mTouchSlop ; \n + mIsDragging = Math . sqrt ( ( dx * dx ) + ( dy * dy ) ) > = mTouchSlop ; \n","Fixed mixed usage of LogManager and Log classes , migrated from FloatMath ( deprecated since API22 ) , code formatting",649
"README . md \n + # # Gradle integration \n + \n + Minimum code for Gradle integration , place code in your ` build . gradle ` \n + \n + ` ` ` gradle \n + repositories { \n + mavenCentral ( ) \n + } \n + \n + dependencies { \n + compile ' com . github . chrisbanes . photoview : library : 1 . 2 . 4 ' \n + } \n + ` ` ` \n - ` ` ` java \n + ` ` ` java \n gradle . properties \n - VERSION _ NAME = 1 . 2 . 4 - SNAPSHOT \n + VERSION _ NAME = 1 . 2 . 4 \n sample \ src \ main \ AndroidManifest . xml \n - android : versionCode = "" 122 "" \n - android : versionName = "" 1 . 2 . 2 - SNAPSHOT "" > \n + android : versionCode = "" 124 "" \n + android : versionName = "" 1 . 2 . 4 "" > \n","Updated Readme , added Gradle dependency definition \n Raised version to 1 . 2 . 4 , releasing to Maven Central repository",649
gradle \ wrapper \ gradle - wrapper . jar \n Binary files a / gradle / wrapper / gradle - wrapper . jar and b / gradle / wrapper / gradle - wrapper . jar differ \n gradle \ wrapper \ gradle - wrapper . properties \n - # Fri Nov 21 13 : 00 : 30 CET 2014 \n + # Thu Apr 02 14 : 03 : 42 CEST 2015 \n - distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 2 - bin . zip \n + distributionUrl = https \ : / / services . gradle . org / distributions / gradle - 2 . 3 - bin . zip \n,Updated Gradle Wrapper to version 2 . 3,649
"maven _ push . gradle \n + task installArchives ( type : Upload ) { \n + description "" Installs the artifacts to the local Maven repository . "" \n + configuration = configurations [ ' archives ' ] \n + repositories { \n + mavenDeployer { \n + pom . groupId = GROUP \n + pom . artifactId = POM _ ARTIFACT _ ID \n + pom . version = VERSION _ NAME \n + \n + repository url : "" file : / / $ { System . properties [ ' user . home ' ] } / . m2 / repository "" \n + } \n + } \n + } \n + \n",Added installArchives gradle task to install to local maven repository,649
. travis . yml \n - - build - tools - 21 . 1 . 2 \n + - build - tools - 22 . 0 . 1 \n - extra - android - support \n - extra - android - m2repository \n - - android - 21 \n + - android - 22 \n - ' . + ' \n library \ build . gradle \n - compileSdkVersion 21 \n - buildToolsVersion ' 21 . 1 . 2 ' \n + compileSdkVersion 22 \n + buildToolsVersion ' 22 . 0 . 1 ' \n - targetSdkVersion 21 \n + targetSdkVersion 22 \n sample \ build . gradle \n - compileSdkVersion 21 \n - buildToolsVersion ' 21 . 1 . 2 ' \n + compileSdkVersion 22 \n + buildToolsVersion ' 22 . 0 . 1 ' \n - targetSdkVersion 21 \n + targetSdkVersion 22 \n,Build target updated to API 22 and Travis CI support updated,649
"library \ src \ main \ java \ com \ loopj \ android \ http \ JsonHttpResponseHandler . java \n - * @ param encoding String encoding to be used when parsing JSON \n + * @ param encoding String encoding to be used when parsing JSON \n - if ( ! useRFC5179CompatibilityMode & & jsonResponse = = null ) { \n + if ( ! useRFC5179CompatibilityMode & & jsonResponse = = null ) { \n - } else if ( jsonResponse instanceof JSONObject ) { \n + } else if ( jsonResponse instanceof JSONObject ) { \n - if ( useRFC5179CompatibilityMode ) { \n + if ( useRFC5179CompatibilityMode ) { \n - } else { \n + } else { \n - if ( ! useRFC5179CompatibilityMode & & jsonResponse = = null ) { \n + if ( ! useRFC5179CompatibilityMode & & jsonResponse = = null ) { \n - } else if ( jsonResponse instanceof JSONObject ) { \n + } else if ( jsonResponse instanceof JSONObject ) { \n - if ( jsonString . startsWith ( UTF8 _ BOM ) ) { \n - jsonString = jsonString . substring ( 1 ) ; \n - } \n - if ( useRFC5179CompatibilityMode ) { \n + if ( useRFC5179CompatibilityMode ) { \n - } else { \n + } else { \n - if ( ( jsonString . startsWith ( "" { "" ) & & jsonString . endsWith ( "" } "" ) ) \n - | | jsonString . startsWith ( "" [ "" ) & & jsonString . endsWith ( "" ] "" ) ) { \n + if ( ( jsonString . startsWith ( "" { "" ) & & jsonString . endsWith ( "" } "" ) ) \n + | | jsonString . startsWith ( "" [ "" ) & & jsonString . endsWith ( "" ] "" ) ) { \n - else if ( jsonString . startsWith ( "" \ "" "" ) & & jsonString . endsWith ( "" \ "" "" ) ) { \n - result = jsonString . substring ( 1 , jsonString . length ( ) - 1 ) ; \n + else if ( jsonString . startsWith ( "" \ "" "" ) & & jsonString . endsWith ( "" \ "" "" ) ) { \n + result = jsonString . substring ( 1 , jsonString . length ( ) - 1 ) ; \n","Code formatting , removed duplicate UTF8 _ BOM removal code",649
"maven _ push . gradle \n + task installArchives ( type : Upload ) { \n + description "" Installs the artifacts to the local Maven repository . "" \n + configuration = configurations [ ' archives ' ] \n + repositories { \n + mavenDeployer { \n + pom . groupId = GROUP \n + pom . artifactId = POM _ ARTIFACT _ ID \n + pom . version = VERSION _ NAME \n + \n + repository url : "" file : / / $ { System . properties [ ' user . home ' ] } / . m2 / repository "" \n + } \n + } \n + } \n + \n","Added Gradle task installArchives , to install into local Maven repository",649
library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpClient . java \n + List < RequestHandle > requestList ; \n - List < RequestHandle > requestList = requestMap . get ( context ) ; \n + requestList = requestMap . get ( context ) ; \n,"Fixed invalid synchronization impl , Closes # 730",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ AsyncHttpRequest . java \n - retry = ( executionCount > 0 ) & & retryHandler . retryRequest ( cause , + + executionCount , context ) ; \n + retry = ( executionCount > 0 ) & & retryHandler . retryRequest ( e , + + executionCount , context ) ; \n","UnknownHostException was not caught by whitelist in RetryHandler , Closing # 713",649
"library \ src \ main \ java \ com \ loopj \ android \ http \ RequestParams . java \n + protected boolean forceMultipartEntity = false ; \n + / * * \n + * If set to true will force Content - Type header to ` multipart / form - data ` \n + * even if there are not Files or Streams to be send \n + * \n + * Default value is false \n + * \n + * @ param force boolean , should declare content - type multipart / form - data even without files or streams present \n + * / \n + public void setForceMultipartEntityContentType ( boolean force ) { \n + this . forceMultipartEntity = force ; \n + } \n + \n - } else if ( streamParams . isEmpty ( ) & & fileParams . isEmpty ( ) ) { \n + } else if ( ! forceMultipartEntity & & streamParams . isEmpty ( ) & & fileParams . isEmpty ( ) ) { \n - progressHandler , \n - ! fileParams . isEmpty ( ) | | ! streamParams . isEmpty ( ) , \n - elapsedFieldInJsonStreamer ) ; \n + progressHandler , \n + ! fileParams . isEmpty ( ) | | ! streamParams . isEmpty ( ) , \n + elapsedFieldInJsonStreamer ) ; \n","Allowed to force content - type to be multipart / form - data , Closing # 800",649
README . md \n - attacher . update ( ) ; \n + mAttacher . update ( ) ; \n,"Fixed readme typo , thanks @ alashow , closing # 259",649
"src \ test \ shell \ bazel \ bazel _ bootstrap _ distfile _ test . sh \n + if "" $ is _ windows "" ; then \n + # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n + echo "" SHA256SUM of $ { DISTFILE } : "" \n + sha256sum $ { DISTFILE } \n + echo "" . / BUILD after unzipping $ { DISTFILE } "" \n + cat . / BUILD \n + echo "" List . / : "" \n + ls . / \n + fi \n + \n - # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n - cat . / BUILD \n + if "" $ is _ windows "" ; then \n + # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n + echo "" SHA256SUM of $ { EMBEDDED _ JDK } : "" \n + sha256sum $ { EMBEDDED _ JDK } \n + echo "" . / BUILD after unzipping $ { EMBEDDED _ JDK } "" \n + cat . / BUILD \n + echo "" List . / : "" \n + ls . / \n + fi \n",Print more info for debugging bazel _ bootstrap _ dist _ file \n Related : https : / / github . com / bazelbuild / bazel / issues / 12578 \n RELNOTES : None \n PiperOrigin - RevId : 345191170,659
"src \ test \ shell \ bazel \ bazel _ bootstrap _ distfile _ test . sh \n - if "" $ is _ windows "" ; then \n - # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n - echo "" SHA256SUM of $ { DISTFILE } : "" \n - sha256sum $ { DISTFILE } \n - echo "" . / BUILD after unzipping $ { DISTFILE } "" \n - cat . / BUILD \n - echo "" List . / : "" \n - ls . / \n - fi \n - \n - if "" $ is _ windows "" ; then \n - # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n - echo "" SHA256SUM of $ { EMBEDDED _ JDK } : "" \n - sha256sum $ { EMBEDDED _ JDK } \n - echo "" . / BUILD after unzipping $ { EMBEDDED _ JDK } "" \n - cat . / BUILD \n - echo "" List . / : "" \n - ls . / \n - fi \n - \n",Remove debugging code from bazel _ bootstrap _ distfile _ test . sh \n Related https : / / github . com / bazelbuild / bazel / issues / 12578 \n RELNOTES : None \n PiperOrigin - RevId : 346080243,659
src \ main \ native \ windows \ file . cc \n + # ifndef IO _ REPARSE _ TAG _ PROJFS \n + # define IO _ REPARSE _ TAG _ PROJFS 0x9000001C \n + # endif \n + \n,"Define IO _ REPARSE _ TAG _ PROJFS if it ' s not defined . \n With some old MSVC version , IO _ REPARSE _ TAG _ PROJFS may not be defined . \n https : / / docs . microsoft . com / en - us / openspecs / windows _ protocols / ms - fscc / c8e77b37 - 3909 - 4fe6 - a4ea - 2b9d423b1ee4 \n RELNOTES : None \n PiperOrigin - RevId : 332458440",659
"tools \ cpp \ windows _ cc _ configure . bzl \n - if result . return _ code ! = 0 : \n - auto _ configure _ fail ( "" Failed to get clang version by running \ "" % s - v \ "" "" % clang _ cl ) \n + first _ line = result . stderr . strip ( ) . splitlines ( ) [ 0 ] \n - # Stderr should look like "" clang version X . X . X . . . "" \n - return result . stderr . strip ( ) . split ( "" "" ) [ 2 ] \n + # The first line of stderr should look like "" clang version X . X . X "" \n + if result . return _ code ! = 0 or not first _ line . startswith ( "" clang version "" ) : \n + auto _ configure _ fail ( "" Failed to get clang version by running \ "" % s - v \ "" "" % clang _ cl ) \n + return first _ line . split ( "" "" ) [ 2 ] \n",Windows : Improve clang version check logic \n Fixes https : / / github . com / bazelbuild / bazel / issues / 12144 \n RELNOTES : None \n PiperOrigin - RevId : 333036907,659
"src \ main \ java \ com \ google \ devtools \ build \ lib \ analysis \ config \ CoreOptions . java \n - oldName = "" experimental _ enable _ runfiles "" , \n","Remove the old flag name of - - enable _ runfiles \n This old flag has lived long enough , removing it now to avoid confusion on documentation . \n Closes : https : / / github . com / bazelbuild / bazel / issues / 11421 \n RELNOTES : None \n PiperOrigin - RevId : 344379916",659
src \ test \ shell \ bazel \ bazel _ bootstrap _ distfile _ test . sh \n + # For debugging : https : / / github . com / bazelbuild / bazel / issues / 12578 \n + cat . / BUILD \n + \n,"Debug bazel _ bootstrap _ dist _ file test \n The test is only failing in postsubmit , not in presubmit or downstream pipeline , I cannot reproduce this locally or on a Windows VM . \n The error message complained that / / : default _ host _ platform doesn ' t exist , however , it should be defined in . / BUILD . Let ' s print out the content of . / BUILD to find out what ' s happening . \n Related : https : / / github . com / bazelbuild / bazel / issues / 12578 \n RELNOTES : None \n PiperOrigin - RevId : 344809001",659
site \ docs \ build - javascript . md \n - > Also the Buildifier tool is not available on Windows . Follow https : / / github . com / bazelbuild / buildtools / issues / 375 \n - \n,Fix doc about Buildifier Windows support \n Related https : / / github . com / bazelbuild / buildtools / issues / 375 \n RELNOTES : None \n PiperOrigin - RevId : 352787916,659
"src \ main \ java \ org \ junit \ experimental \ theories \ DataPoints . java \n - * Annotating an array - typed field or method with & # 064 ; DataPoints will cause \n - * the values in the array ( or returned array ) to be used as potential \n - * parameters for theories in that class , when run with the \n + * Annotating an array or iterable - typed field or method with & # 064 ; DataPoints \n + * will cause the values in the array or iterable given to be used as potential \n + * parameters for theories in that class when run with the \n + * < p > \n + * DataPoints methods whose array types aren ' t assignable from the target \n + * parameter type ( and so can ' t possibly return relevant values ) will not be \n + * called when generating values for that parameter . Iterable - typed datapoints \n + * methods must always be called though , as this information is not available \n + * here after generic type erasure , so expensive methods returning iterable \n + * datapoints are a bad idea . \n + * \n - @ Target ( { FIELD , METHOD } ) \n + @ Target ( { FIELD , METHOD } ) \n + \n",Updated DataPoints documentation for the new iterable datapoints,662
"src \ main \ java \ org \ junit \ experimental \ theories \ PotentialAssignment . java \n - return String . format ( "" % s : % s "" , name , value . toString ( ) ) ; \n + return String . format ( "" % s : % s "" , name , ( value ! = null ? value . toString ( ) : "" null "" ) ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ TheoryFailureMessagesTest . java \n + @ Test \n + public void failuresUseNameAndValueWithNullValues ( ) throws InitializationError { \n + Result result = runTheoryTest ( TestWithBadNullValue . class ) ; \n + \n + Assert . assertEquals ( 1 , result . getFailureCount ( ) ) ; \n + \n + String errorMessage = result . getFailures ( ) . get ( 0 ) . getException ( ) . getMessage ( ) ; \n + Assert . assertThat ( errorMessage , containsString ( "" badDatapoint "" ) ) ; \n + Assert . assertThat ( errorMessage , containsString ( "" null "" ) ) ; \n + } \n + \n + \n + public static class TestWithBadNullValue { \n + \n + @ DataPoint \n + public static String oneDatapoint = "" good value "" ; \n + \n + @ DataPoint \n + public static String badDatapoint = null ; \n + \n + @ Theory \n + public void theoryTest ( String param ) { \n + methodUnderTest ( param ) ; \n + } \n + \n + } \n","Add test and check for null , to stop null datapoints failing in message creation",662
"src \ test \ java \ org \ junit \ tests \ experimental \ theories \ TestedOnSupplierTest . java \n - assertThat ( assignments . get ( 0 ) . getDescription ( ) , is ( "" ints "" ) ) ; \n + assertThat ( assignments . get ( 0 ) . getDescription ( ) , is ( "" ints : 1 "" ) ) ; \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ runner \ UnsuccessfulWithDataPointFields . java \n - hasSingleFailureContaining ( "" everythingIsZero ( ONE , ONE ) "" ) ) ; \n + hasSingleFailureContaining ( "" everythingIsZero ( ONE : 1 , ONE : 1 ) "" ) ) ; \n",Fixed two missed unit tests that were explicitly checking the previous error messages,662
"src \ main \ java \ org \ junit \ experimental \ theories \ PotentialAssignment . java \n - return String . format ( "" % s : % s "" , name , ( value ! = null ? value . toString ( ) : "" null "" ) ) ; \n + return String . format ( "" % s : % s "" , name , value ) ; \n","Simplification of theory parameter names , since format automatically deals with toString ( ) and nulls .",662
"src \ main \ java \ org \ junit \ experimental \ theories \ internal \ AllMembersSupplier . java \n - try { \n - addArrayValues ( sig , dataPointsMethod . getName ( ) , list , dataPointsMethod . invokeExplosively ( null ) ) ; \n - } catch ( Throwable e ) { \n - / / ignore and move on \n + Class < ? > returnType = dataPointsMethod . getReturnType ( ) ; \n + \n + if ( returnType . isArray ( ) & & sig . canPotentiallyAcceptType ( returnType . getComponentType ( ) ) ) { \n + try { \n + addArrayValues ( sig , dataPointsMethod . getName ( ) , list , dataPointsMethod . invokeExplosively ( null ) ) ; \n + } catch ( Throwable e ) { \n + / / ignore and move on \n + } \n",Further theory optimisation to avoid calling datapoint methods for multi - valued datapoints,662
"src \ main \ java \ org \ junit \ experimental \ theories \ ParameterSignature . java \n - import java . util . HashSet ; \n - import java . util . Map . Entry ; \n - map . put ( boolean . class , Boolean . class ) ; \n - map . put ( byte . class , Byte . class ) ; \n - map . put ( short . class , Short . class ) ; \n - map . put ( char . class , Character . class ) ; \n - map . put ( int . class , Integer . class ) ; \n - map . put ( long . class , Long . class ) ; \n - map . put ( float . class , Float . class ) ; \n - map . put ( double . class , Double . class ) ; \n - \n - / / Make all type conversions symmetric \n - Iterable < Entry < Class < ? > , Class < ? > > > initialEntries = new HashSet < Entry < Class < ? > , Class < ? > > > ( map . entrySet ( ) ) ; \n - for ( Entry < Class < ? > , Class < ? > > entry : initialEntries ) { \n - map . put ( entry . getValue ( ) , entry . getKey ( ) ) ; \n - } \n + putSymmetrically ( map , boolean . class , Boolean . class ) ; \n + putSymmetrically ( map , byte . class , Byte . class ) ; \n + putSymmetrically ( map , short . class , Short . class ) ; \n + putSymmetrically ( map , char . class , Character . class ) ; \n + putSymmetrically ( map , int . class , Integer . class ) ; \n + putSymmetrically ( map , long . class , Long . class ) ; \n + putSymmetrically ( map , float . class , Float . class ) ; \n + putSymmetrically ( map , double . class , Double . class ) ; \n + private static < T > void putSymmetrically ( Map < T , T > map , T a , T b ) { \n + map . put ( a , b ) ; \n + map . put ( b , a ) ; \n + } \n + \n",Minor tweak to improve symmetric set up of convertable types in ParameterSignature,662
"src \ main \ java \ org \ junit \ experimental \ theories \ PotentialAssignment . java \n + \n + public CouldNotGenerateValueException ( ) { \n + } \n + \n + public CouldNotGenerateValueException ( Throwable t ) { \n + super ( t ) ; \n + } \n src \ main \ java \ org \ junit \ experimental \ theories \ internal \ AllMembersSupplier . java \n - } catch ( Throwable e ) { \n + } catch ( Throwable t ) { \n - Assume . assumeThat ( e , not ( instanceOf ( ignorable ) ) ) ; \n + Assume . assumeThat ( t , not ( instanceOf ( ignorable ) ) ) ; \n - throw new CouldNotGenerateValueException ( ) ; \n + throw new CouldNotGenerateValueException ( t ) ; \n",Failing single - datapoint methods keep their original stack trace,662
"src \ main \ java \ org \ junit \ experimental \ theories \ DataPoint . java \n - * DataPoints will only be considered as potential values for parameters for \n - * which their types are assignable . When multiple sets of DataPoints exist with \n - * overlapping types more control can be obtained by naming the DataPoints using \n - * the value of this annotation , e . g . with \n + * A DataPoint is only considered as a potential value for parameters for \n + * which its type is assignable . When multiple { @ code DataPoint } s exist \n + * with overlapping types more control can be obtained by naming each DataPoint \n + * using the value of this annotation , e . g . with \n - * & # 064 ; ParameterSuppliedBy } annotations ) will use all DataPoints that are \n + * & # 064 ; ParameterSuppliedBy } annotations ) will use all { @ code DataPoint } s that are \n - * DataPoints . \n + * { @ code DataPoint } s . \n","Tweaked DataPoint javadoc to depluralise references to datapoints where \n possible \n This should add some clarity , since do have both DataPoint and \n DataPoints annotations .",662
"src \ main \ java \ org \ junit \ experimental \ theories \ internal \ AllMembersSupplier . java \n - import static org . hamcrest . CoreMatchers . not ; \n - import static org . hamcrest . core . IsInstanceOf . instanceOf ; \n - \n - } catch ( Throwable t ) { \n - DataPoint annotation = fMethod . getAnnotation ( DataPoint . class ) ; \n - if ( annotation ! = null ) { \n - for ( Class < ? extends Throwable > ignorable : annotation . ignoredExceptions ( ) ) { \n - Assume . assumeThat ( t , not ( instanceOf ( ignorable ) ) ) ; \n - } \n - } \n + } catch ( Throwable throwable ) { \n + DataPoint annotation = fMethod . getAnnotation ( DataPoint . class ) ; \n + Assume . assumeTrue ( annotation = = null | | ! isAssignableToAnyOf ( annotation . ignoredExceptions ( ) , throwable ) ) ; \n - throw new CouldNotGenerateValueException ( t ) ; \n + throw new CouldNotGenerateValueException ( throwable ) ; \n - } \n + } \n - } catch ( Throwable t ) { \n + } catch ( Throwable throwable ) { \n - if ( annotation ! = null ) { \n - for ( Class < ? extends Throwable > ignored : annotation . ignoredExceptions ( ) ) { \n - if ( ignored . isAssignableFrom ( t . getClass ( ) ) ) { \n - return ; \n - } \n - } \n + if ( annotation ! = null & & isAssignableToAnyOf ( annotation . ignoredExceptions ( ) , throwable ) ) { \n + return ; \n + } else { \n + throw throwable ; \n - throw t ; \n + \n + private static boolean isAssignableToAnyOf ( Class < ? > [ ] typeArray , Object target ) { \n + for ( Class < ? > type : typeArray ) { \n + if ( type . isAssignableFrom ( target . getClass ( ) ) ) { \n + return true ; \n + } \n + } \n + return false ; \n + } \n",Refactored out ignorable exception type - matching to minimise duplicating \n of that logic,662
"src \ main \ java \ org \ junit \ experimental \ theories \ DataPoint . java \n + import static java . lang . annotation . ElementType . FIELD ; \n + import static java . lang . annotation . ElementType . METHOD ; \n + \n + import java . lang . annotation . Target ; \n + @ Target ( { FIELD , METHOD } ) \n src \ main \ java \ org \ junit \ experimental \ theories \ DataPoints . java \n + import static java . lang . annotation . ElementType . FIELD ; \n + import static java . lang . annotation . ElementType . METHOD ; \n + \n + import java . lang . annotation . Target ; \n + @ Target ( { FIELD , METHOD } ) \n src \ main \ java \ org \ junit \ experimental \ theories \ ParametersSuppliedBy . java \n + import static java . lang . annotation . ElementType . ANNOTATION _ TYPE ; \n + import static java . lang . annotation . ElementType . PARAMETER ; \n + \n + import java . lang . annotation . Target ; \n + @ Target ( { ANNOTATION _ TYPE , PARAMETER } ) \n src \ main \ java \ org \ junit \ experimental \ theories \ Theory . java \n + import static java . lang . annotation . ElementType . METHOD ; \n + \n + import java . lang . annotation . Target ; \n + @ Target ( METHOD ) \n src \ main \ java \ org \ junit \ experimental \ theories \ suppliers \ TestedOn . java \n + import static java . lang . annotation . ElementType . PARAMETER ; \n + \n + import java . lang . annotation . Target ; \n + @ Target ( PARAMETER ) \n",Added specific targetting for the various theory annotations,662
"src \ main \ java \ org \ junit \ experimental \ theories \ internal \ Assignments . java \n - return new Assignments ( assigned , fUnassigned . subList ( 1 , fUnassigned \n - . size ( ) ) , fClass ) ; \n + return new Assignments ( assigned , fUnassigned . subList ( 1 , \n + fUnassigned . size ( ) ) , fClass ) ; \n - throws ReflectiveOperationException { \n + throws Exception { \n - throws ReflectiveOperationException { \n + throws Exception { \n - \n + \n - private ParameterSupplier buildParameterSupplierFromClass ( Class < ? extends ParameterSupplier > cls ) \n - throws ReflectiveOperationException { \n + private ParameterSupplier buildParameterSupplierFromClass ( \n + Class < ? extends ParameterSupplier > cls ) throws Exception { \n src \ test \ java \ org \ junit \ tests \ experimental \ theories \ extendingwithstubs \ StubbedTheories . java \n - throws ReflectiveOperationException { \n + throws Exception { \n",Changed exception signature for assignments reflective methods to support older Java versions,662
dubbo - common \ src \ main \ java \ com \ alibaba \ dubbo \ common \ serialize \ support \ dubbo \ Builder . java \n - cs = c . getDeclaredConstructors ( ) ; \n + cs = t . getDeclaredConstructors ( ) ; \n,fix : # 558 com . alibaba . dubbo . common . serialize . support . dubbo . Builder # newObjectBuilder 存在死循环的风险 ( # 589 ),665
"dubbo - filter \ dubbo - filter - cache \ src \ main \ java \ com \ alibaba \ dubbo \ cache \ support \ lru \ LruCache . java \n + import com . alibaba . dubbo . common . utils . LRUCache ; \n - this . store = new LinkedHashMap < Object , Object > ( ) { \n - private static final long serialVersionUID = - 3834209229668463829L ; \n - \n - @ Override \n - protected boolean removeEldestEntry ( Entry < Object , Object > eldest ) { \n - return size ( ) > max ; \n - } \n - } ; \n + this . store = new LRUCache < Object , Object > ( max ) ; \n",fix : LruCache accessOrder 没设置为 true 的问题 ( # 600 ) \n fix : LruCache accessOrder 没设置为 true 的问题 ( # 600 ),665
"dubbo - filter \ dubbo - filter - cache \ src \ main \ java \ com \ alibaba \ dubbo \ cache \ support \ lru \ LruCache . java \n - import java . util . LinkedHashMap ; \n - import java . util . Map . Entry ; \n - this . store = new LRUCache < Object , Object > ( max ) ; \n + this . store = new LRUCache < Object , Object > ( max ) ; \n - synchronized ( store ) { \n - store . put ( key , value ) ; \n - } \n + store . put ( key , value ) ; \n - synchronized ( store ) { \n - return store . get ( key ) ; \n - } \n + return store . get ( key ) ; \n",fix : 移除 LruCache 多余的同步块 ( # 601 ) \n fix : 移除 LruCache 多余的同步块,665
"dubbo - plugin \ dubbo - qos \ src \ main \ java \ com \ alibaba \ qos \ server \ Server . java \n + import com . alibaba . dubbo . common . utils . ConfigUtils ; \n - import java . util . concurrent . atomic . AtomicInteger ; \n - private final int port = Integer . getInteger ( Constants . QOS _ PORT , Constants . DEFAULT _ PORT ) ; \n + private int port = Integer . parseInt ( ConfigUtils . getProperty ( Constants . QOS _ PORT , Constants . DEFAULT _ PORT + "" "" ) ) ; \n - if ( ! hasStarted . compareAndSet ( false , true ) ) { \n + if ( ! hasStarted . compareAndSet ( false , true ) ) { \n dubbo - plugin \ dubbo - qos \ src \ main \ java \ com \ alibaba \ qos \ server \ handler \ LocalHostPermitHandler . java \n - * \n + * \n + import com . alibaba . dubbo . common . utils . ConfigUtils ; \n - \n + \n - private static boolean acceptForeignIp = Boolean . valueOf ( System . getProperty ( Constants . ACCEPT _ FOREIGN _ IP , "" true "" ) ) ; \n - \n + private static boolean acceptForeignIp = Boolean . valueOf ( ConfigUtils . getProperty ( Constants . ACCEPT _ FOREIGN _ IP , "" true "" ) ) ; \n + \n - + Constants . BR _ STR ) . getBytes ( ) ) ; \n + + Constants . BR _ STR ) . getBytes ( ) ) ; \n",Merge pull re \n fix qos port can only configure by System property problem,665
dubbo - rpc \ dubbo - rpc - default \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ dubbo \ DubboProtocol . java \n - client . close ( ) ; \n + client . close ( getServerShutdownTimeout ( ) ) ; \n - client . close ( ) ; \n + client . close ( getServerShutdownTimeout ( ) ) ; \n,issue # 570 : 修复 client timeout 没设置的问题,665
dubbo - registry \ dubbo - registry - multicast \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ multicast \ MulticastRegistry . java \n - * \n + if ( urls = = null | | urls . isEmpty ( ) ) { \n + if ( urls = = null ) { \n + urls = new ConcurrentHashSet < URL > ( ) ; \n + } \n + URL empty = url . setProtocol ( Constants . EMPTY _ PROTOCOL ) ; \n + urls . add ( empty ) ; \n + } \n dubbo - registry \ dubbo - registry - redis \ src \ main \ java \ com \ alibaba \ dubbo \ registry \ redis \ RedisRegistryFactory . java \n - import com . alibaba . dubbo . registry . RegistryFactory ; \n + import com . alibaba . dubbo . registry . support . AbstractRegistryFactory ; \n - public class RedisRegistryFactory implements RegistryFactory { \n + public class RedisRegistryFactory extends AbstractRegistryFactory { \n - public Registry getRegistry ( URL url ) { \n + @ Override \n + protected Registry createRegistry ( URL url ) { \n,"Merge pull request # 1190 , fix redis and multicast registry offline fail \n Fixes # 1181",665
core \ src \ com \ google \ zxing \ pdf417 \ PDF417Reader . java \n - if ( matrixWidth = = 0 | | matrixHeight = = 0 ) { \n + if ( matrixWidth < = 0 | | matrixHeight < = 0 ) { \n,Strengthen check for bad dimension \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1845 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryManager . java \n + \n + \n - for ( int col = 0 ; col < COLUMNS . length ; col + + ) { \n - historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( col ) ) ) . append ( "" \ "" , "" ) ; \n - } \n + \n + historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( 0 ) ) ) . append ( "" \ "" , "" ) ; \n + historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( 1 ) ) ) . append ( "" \ "" , "" ) ; \n + historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( 2 ) ) ) . append ( "" \ "" , "" ) ; \n + historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( 3 ) ) ) . append ( "" \ "" , "" ) ; \n + \n - EXPORT _ DATE _ TIME _ FORMAT . format ( new Date ( timestamp ) ) ) ) . append ( "" \ "" \ r \ n "" ) ; \n + EXPORT _ DATE _ TIME _ FORMAT . format ( new Date ( timestamp ) ) ) ) . append ( "" \ "" , "" ) ; \n + \n + / / Above we ' re preserving the old ordering of columns which had formatted data in position 5 \n + \n + historyText . append ( ' "" ' ) . append ( massageHistoryField ( cursor . getString ( 4 ) ) ) . append ( "" \ "" \ r \ n "" ) ; \n + \n",Issue 923 oops preserve output order \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1874 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ book \ BrowseBookListener . java \n - / / HACK ( jbreiden ) I have no idea where the heck our pageId off by one \n - / / error is coming from . I should not have to put in this position - 1 \n - / / kludge . \n + if ( position < 1 ) { \n + / / Clicked header , ignore it \n + return ; \n + } \n - if ( activity . getISBN ( ) . startsWith ( "" http : / / google . com / books ? id = "" ) & & ( pageId . length ( ) > 0 ) ) { \n + if ( LocaleManager . isBookSearchUrl ( activity . getISBN ( ) ) & & pageId . length ( ) > 0 ) { \n android \ src \ com \ google \ zxing \ client \ android \ book \ SearchBookContentsActivity . java \n - if ( isbn . startsWith ( "" http : / / google . com / books ? id = "" ) ) { \n + if ( LocaleManager . isBookSearchUrl ( isbn ) ) { \n",Fixed book search browsing \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1901 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ ViewfinderView . java \n - resultBitmap = null ; \n + Bitmap resultBitmap = this . resultBitmap ; \n + this . resultBitmap = null ; \n + if ( resultBitmap ! = null ) { \n + resultBitmap . recycle ( ) ; \n + } \n,Fixed potential bug in not recycling bitmaps that I spied from BS + \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2004 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ ViewfinderView . java \n - Rect frame = CameraManager . get ( ) . getFramingRect ( ) ; \n + CameraManager cameraManager = CameraManager . get ( ) ; \n + if ( cameraManager = = null ) { \n + return ; \n + } \n + Rect frame = cameraManager . getFramingRect ( ) ; \n - Rect previewFrame = CameraManager . get ( ) . getFramingRectInPreview ( ) ; \n + Rect previewFrame = cameraManager . getFramingRectInPreview ( ) ; \n,Issue 1044 maybe avoid NPE in onDraw ( ) before CaptureActivity . onResume ( ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2007 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ CaptureActivityHandler . java \n - CameraManager . get ( ) . stopPreview ( ) ; \n + CameraManager cameraManager = CameraManager . get ( ) ; \n + if ( cameraManager ! = null ) { \n + cameraManager . stopPreview ( ) ; \n + } \n,More for Issue 1044 - - avoid another possible NPE though I don ' t think the underlyling issue has been found yet \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2010 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - Rect rect = new Rect ( getFramingRect ( ) ) ; \n + Rect framingRect = getFramingRect ( ) ; \n + if ( framingRect = = null ) { \n + return null ; \n + } \n + Rect rect = new Rect ( framingRect ) ; \n,Another bug fix to go with Issue 1044 - - this one only cropped up on my tablet though \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2014 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n - intent . putExtra ( "" beginTime "" , calculateMilliseconds ( start ) ) ; \n + long startMilliseconds = calculateMilliseconds ( start ) ; \n + intent . putExtra ( "" beginTime "" , startMilliseconds ) ; \n + } \n + long endMilliseconds ; \n + if ( end = = null ) { \n + endMilliseconds = allDay ? startMilliseconds + 86400 : startMilliseconds ; \n - if ( end = = null ) { \n - end = start ; \n - } \n - long endMilliseconds = calculateMilliseconds ( end ) ; \n - intent . putExtra ( "" endTime "" , endMilliseconds ) ; \n + endMilliseconds = calculateMilliseconds ( end ) ; \n + intent . putExtra ( "" endTime "" , endMilliseconds ) ; \n",Issue 933 handle multi - day all - day events \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2015 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . java \n - bytes [ i ] = unrandomize255State ( bits . readBits ( 8 ) , codewordPosition + + ) ; \n + bytes [ i ] = ( byte ) unrandomize255State ( bits . readBits ( 8 ) , codewordPosition + + ) ; \n - private static byte unrandomize255State ( int randomizedBase256Codeword , \n + private static int unrandomize255State ( int randomizedBase256Codeword , \n - return ( byte ) ( tempVariable > = 0 ? tempVariable : tempVariable + 256 ) ; \n + return tempVariable > = 0 ? tempVariable : tempVariable + 256 ; \n",Issue 894 fix unsigned byte issue in unrandomize 255 state that prevented some codes from working in base 256 mode \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2016 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - < ant dir = "" android "" target = "" compile "" / > \n - < ant dir = "" androidtest "" target = "" compile "" / > \n + < ant dir = "" android "" target = "" debug "" / > \n + < ant dir = "" androidtest "" target = "" debug "" / > \n",Fix top build . xml \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2017 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
actionscript \ core \ src \ com \ google \ zxing \ qrcode \ encoder \ MaskUtil . as \n - return Math . abs ( Math . round ( darkRatio * 100 - 50 ) ) / 5 * 10 ; \n + return int ( Math . abs ( int ( darkRatio * 100 - 50 ) ) / 5 ) * 10 ; \n - return ( ( ( y / 2 ) + ( x / 3 ) ) % 2 = = 0 ) ? 1 : 0 ; \n + return ( ( int ( y / 2 ) + int ( x / 3 ) ) % 2 = = 0 ) ? 1 : 0 ; \n,Commit Issue 1038 for Bas \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2067 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
new file \n actionscript \ core \ test \ data \ ean8 \ ean8 _ 48512343 . png \n Binary files / dev / null and b / actionscript / core / test / data / ean8 / ean8 _ 48512343 . png differ \n,Stuff that should have gone with Issue 866 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1843 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"actionscript \ core \ test \ com \ google \ zxing \ EncodeDecodeEAN8Test . as \n - public function encodedEAN8shouldBeDecodedSuccessfully ( ) : void { \n + public function testEncodedEAN8shouldBeDecodedSuccessfully ( ) : void { \n - [ Test ( description = "" Bug : Endoding and decoding 1 fails "" ) ] \n - public function shouldEncodeAndDecodeAnyValidEAN8number ( ) : void { \n - var testCode : Number = 12345678 ; \n - var decodedNumber : Number = encodeAndDecode ( testCode ) ; \n - assertEquals ( testCode , decodedNumber ) ; \n + [ Test ( description = "" Encodes EAN8 from 0 to 9999999 . "" ) ] \n + public function testEncodeAndDecodeAnyValidEAN8Number ( ) : void { \n + for ( var testCode : Number = 9999999 ; testCode > = 0 ; testCode - = 1111111 ) { \n + var checkSum : Number = calculateEANChecksumDigit ( testCode ) ; \n + var testCodeWithCheckSum : Number = testCode * 10 + checkSum ; \n + var decodedNumber : Number = encodeAndDecode ( testCodeWithCheckSum ) ; \n + assertEquals ( testCodeWithCheckSum , decodedNumber ) ; \n + } \n - / / generate an image \n + \n + public function calculateEANChecksumDigit ( number : Number ) : Number { \n + var checksum : Number = 0 ; \n + var weightedSumOfDigits : Number = 0 ; \n + var weight : Number = 3 ; \n + while ( number > 0 ) { \n + var lastDigit : int = number % 10 ; \n + weightedSumOfDigits = weightedSumOfDigits + lastDigit * weight ; \n + number = ( number - lastDigit ) / 10 ; \n + weight = weight = = 3 ? 1 : 3 ; \n + } \n + var additionToTen : Number = weightedSumOfDigits % 10 ; \n + if ( additionToTen > 0 ) { \n + checksum = 10 - additionToTen ; \n + } \n + return checksum ; \n + } \n",Issue 886 updating failing actionscript core test \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1844 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
cpp \ core \ src \ zxing \ oned \ Code128Reader . cpp \n - / / the code read in this case is the number encoded directly \n + tmpResultSStr . str ( std : : string ( ) ) ; \n + / / the code read in this case is the number encoded directly \n - if ( code < 10 ) \n - tmpResultSStr < < ' 0 ' ; \n - tmpResultSStr < < code ; \n + if ( code < 10 ) { \n + tmpResultSStr < < ' 0 ' ; \n + } \n + tmpResultSStr < < code ; \n + tmpResultString . append ( tmpResultSStr . str ( ) ) ; \n - if ( codeSet = = CODE _ CODE _ C ) \n - tmpResultString . append ( tmpResultSStr . str ( ) ) ; \n - \n,Issue 911 update Code 128 from Java to fix some issues \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1858 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"cpp \ core \ src \ zxing \ oned \ ITFReader . cpp \n - const int DEFAULT _ ALLOWED _ LENGTHS [ 4 ] = { 6 , 10 , 14 , 44 } ; \n + const int DEFAULT _ ALLOWED _ LENGTHS _ LEN = 10 ; \n + const int DEFAULT _ ALLOWED _ LENGTHS [ DEFAULT _ ALLOWED _ LENGTHS _ LEN ] = { 44 , 24 , 20 , 18 , 16 , 14 , 12 , 10 , 8 , 6 } ; \n - / / an assumption that the decoded string must be 6 , 10 or 14 digits . \n + / / an assumption that the decoded string must be a known length \n - if ( length = = 6 | | length = = 10 | | length = = 14 ) { \n - lengthOK = true ; \n + for ( int i = 0 ; i < DEFAULT _ ALLOWED _ LENGTHS _ LEN ; i + + ) { \n + if ( length = = DEFAULT _ ALLOWED _ LENGTHS [ i ] ) { \n + lengthOK = true ; \n + break ; \n + } \n","Issue 920 add ITF length 18 , make C + + consistent with Java here \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1862 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ oned \ ITFReader . java \n - private static final int [ ] DEFAULT _ ALLOWED _ LENGTHS = { 6 , 8 , 10 , 12 , 14 , 16 , 20 , 24 , 44 } ; \n + private static final int [ ] DEFAULT _ ALLOWED _ LENGTHS = { 44 , 24 , 20 , 18 , 16 , 14 , 12 , 10 , 8 , 6 } ; \n","Issue 920 add ITF length 18 , make C + + consistent with Java here \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1863 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"csharp \ common \ ByteMatrix . cs \n + using System . Drawing . Imaging ; \n + using System . Drawing ; \n + using System . Runtime . InteropServices ; \n + \n + / / / < summary > \n + / / / Converts this ByteMatrix to a black and white bitmap . \n + / / / < / summary > \n + / / / < returns > A black and white bitmap converted from this ByteMatrix . < / returns > \n + public Bitmap ToBitmap ( ) \n + { \n + const byte BLACK = 0 ; \n + const byte WHITE = 255 ; \n + sbyte [ ] [ ] array = this . Array ; \n + int width = this . Width ; \n + int height = this . Height ; \n + byte [ ] pixels = new byte [ width * height ] ; \n + \n + for ( int y = 0 ; y < height ; y + + ) \n + { \n + int offset = y * width ; \n + for ( int x = 0 ; x < width ; x + + ) \n + { \n + ixels [ offset + x ] = array [ y ] [ x ] = = 0 ? BLACK : WHITE ; \n + } \n + } \n + \n + / / Here create the Bitmap to the known height , width and format \n + Bitmap bmp = new Bitmap ( width , height , PixelFormat . Format8bppIndexed ) ; \n + \n + / / Create a BitmapData and Lock all pixels to be written \n + BitmapData bmpData = \n + bmp . LockBits ( new Rectangle ( 0 , 0 , bmp . Width , bmp . Height ) , \n + ImageLockMode . WriteOnly , bmp . PixelFormat ) ; \n + \n + / / Copy the data from the byte array into BitmapData . Scan0 \n + Marshal . Copy ( pixels , 0 , bmpData . Scan0 , pixels . Length ) ; \n + \n + / / Unlock the pixels \n + bmp . UnlockBits ( bmpData ) ; \n + \n + / / Return the bitmap \n + return bmp ; \n + } \n",Issue 921 add ToBitmap \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1864 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ common \ BitSource . java \n - * < p > This class is thread - safe but not reentrant . Unless the caller modifies the bytes array \n + * < p > This class is thread - safe but not reentrant - - unless the caller modifies the bytes array \n + / * * \n + * @ return index of next byte in input byte array which would be read by the next call to { @ link # readBits ( int ) } . \n + * / \n + public int getByteOffset ( ) { \n + return byteOffset ; \n + } \n + \n core \ src \ com \ google \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . java \n - throw FormatException . getFormatInstance ( ) ; \n + / / ignore \n - int codewordPosition = 2 ; \n + int codewordPosition = 1 + bits . getByteOffset ( ) ; / / position is 1 - indexed \n,Issue 882 few more small DM issues \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1865 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ Intents . java \n - * Call intent . getByteArrayExtra ( RESULT _ BYTES ) to get a { @ link byte [ ] } of raw bytes in the \n + * Call intent . getByteArrayExtra ( RESULT _ BYTES ) to get a { @ code byte [ ] } of raw bytes in the \n core \ src \ com \ google \ zxing \ common \ detector \ WhiteRectangleDetector . java \n - * @ return { @ link ResultPoint [ ] } describing the corners of the rectangular \n + * @ return { @ link ResultPoint } [ ] describing the corners of the rectangular \n,Two small javadoc warnings \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1866 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . java \n - } else if ( oneByte = = 232 | | oneByte = = 233 | | oneByte = = 234 ) { \n - / / FNC1 , Structured Append , Reader Programming \n + } else if ( oneByte = = 232 ) { \n + / / FNC1 \n + result . append ( ( char ) 29 ) ; / / translate as ASCII 29 \n + } else if ( oneByte = = 233 | | oneByte = = 234 ) { \n + / / Structured Append , Reader Programming \n - / / ignore \n + result . append ( ( char ) 29 ) ; / / translate as ASCII 29 \n - / / ignore \n + result . append ( ( char ) 29 ) ; / / translate as ASCII 29 \n","Translate Data Matrix FNC1 as ASCII 29 , as spec suggests that ' s usual in some cases \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1867 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"zxing . appspot . com \ generator \ src \ com \ google \ zxing \ web \ generator \ client \ GeoLocationGenerator . java \n - if ( ! link . matches ( "" http : / / maps . google . com / . * "" ) ) { \n + if ( ! link . startsWith ( "" http : / / maps . google . "" ) ) { \n","Per Lachezar , look for any Google Maps domain here \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1870 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ res \ values - es \ strings . xml \n - - > \n - < string name = "" app _ picker _ name "" > Aplicaciónes < / string > \n + < string name = "" app _ picker _ name "" > Aplicaciones < / string > \n",Issue 1096 typo fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2070 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ Code39Reader . java \n - if ( result . length ( ) = = 0 ) { \n + if ( result . length ( ) < 4 ) { \n,Reject short Code 39 - - too likely to be a false positive \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1884 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ Code128Reader . java \n - if ( resultString . length ( ) = = 0 ) { \n + if ( resultString . length ( ) < 2 ) { \n core \ src \ com \ google \ zxing \ oned \ Code93Reader . java \n - if ( result . length ( ) < 2 ) { \n + if ( result . length ( ) < 4 ) { \n,False positive avoidance \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1885 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ detector \ Detector . java \n - return new DetectorResult ( bits , new ResultPoint [ ] { vertices [ 4 ] , \n - vertices [ 5 ] , vertices [ 6 ] , vertices [ 7 ] } ) ; \n + return new DetectorResult ( bits , new ResultPoint [ ] { vertices [ 5 ] , \n + vertices [ 4 ] , vertices [ 6 ] , vertices [ 7 ] } ) ; \n","Change order of result points to be consistent with QR / DM : from bottom - left , clockwise \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1886 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android - integration \ src \ com \ google \ zxing \ integration \ android \ IntentIntegrator . java \n - activity . startActivity ( intent ) ; \n + try { \n + activity . startActivity ( intent ) ; \n + } catch ( ActivityNotFoundException anfe ) { \n + / / Hmm , market is not installed \n + Log . w ( TAG , "" Android Market is not installed ; cannot install Barcode Scanner "" ) ; \n + } \n",Issue 945 don ' t die if Market isn ' t there \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1887 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
AUTHORS \n - kamilkaczm \n + Kamil Kaczmarczyk \n android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ BookResultInfoRetriever . java \n - * @ author kamilkaczm \n + * @ author Kamil Kaczmarczyk \n,Added Kamil Kaczmarczyk ' s full name \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1893 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ FlashlightManager . java \n + Log . v ( TAG , "" This device does "" + ( iHardwareService = = null ? "" not "" : "" "" ) + "" support control of a flashlight "" ) ; \n - if ( iHardwareService = = null ) { \n - Log . v ( TAG , "" This device does supports control of a flashlight "" ) ; \n - } else { \n - Log . v ( TAG , "" This device does not support control of a flashlight "" ) ; \n - } \n",Log message typo fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1896 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ src \ com \ google \ zxing \ integration \ android \ IntentIntegrator . java \n - public static final int REQUEST _ CODE = 0x0ba7c0de ; / / get it ? \n + public static final int REQUEST _ CODE = 0x0000c0de ; / / Only use bottom 16 bits \n,Only use bottom 16 bits for compatibility with FragmentActivity \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1898 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ URIResultParser . java \n - if ( uri = = null | | uri . indexOf ( ' ' ) > = 0 | | uri . indexOf ( ' \ n ' ) > = 0 ) { \n + if ( uri = = null ) { \n + int period = - 1 ; \n + int colon = - 1 ; \n + int length = uri . length ( ) ; \n + for ( int i = length - 1 ; i > = 0 ; i - - ) { \n + char c = uri . charAt ( i ) ; \n + if ( c < = ' ' ) { / / covers space , newline , and more \n + return false ; \n + } else if ( c = = ' . ' ) { \n + period = i ; \n + } else if ( c = = ' : ' ) { \n + colon = i ; \n + } \n + } \n - int period = uri . indexOf ( ' . ' ) ; \n - if ( period > = uri . length ( ) - 2 ) { \n - return false ; \n - } \n - int colon = uri . indexOf ( ' : ' ) ; \n - if ( period < 0 & & colon < 0 ) { \n + if ( period > = uri . length ( ) - 2 | | ( period < 0 & & colon < 0 ) ) { \n core \ test \ src \ com \ google \ zxing \ client \ result \ URIParsedResultTestCase . java \n + @ Test \n + public void testGarbage2 ( ) { \n + String text = "" DEA \ u0003 \ u0019M \ u0006 \ u0000 \ b√• \ u0000¬áHO \ u0000X $ \ u0001 \ u0000 \ u001Fwfc \ u0007 ! √æ¬ì¬ò \ u0013 \ u0013¬æZ { √π√é√ù√ö¬óZ¬ß¬® + y _ zb√±k \ u00117¬∏ \ u000E¬Ü√ú \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000 \ u0000¬£ . ux "" ; \n + Result fakeResult = new Result ( text , null , null , BarcodeFormat . QR _ CODE ) ; \n + ParsedResult result = ResultParser . parseResult ( fakeResult ) ; \n + assertSame ( ParsedResultType . TEXT , result . getType ( ) ) ; \n + assertEquals ( text , result . getDisplayResult ( ) ) ; \n + } \n + \n",Issue 897 tighten URI definition \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1851 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedReader . java \n - while ( row . get ( firstElementStart ) & & firstElementStart < row . size ) { \n + while ( firstElementStart < row . size & & row . get ( firstElementStart ) ) { \n,Fix small bug I saw in bounds checking \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1880 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < url > http : / / oss . sonatype . org / content / repositories / staging / < / url > \n + < url > https : / / oss . sonatype . org / service / local / staging / deploy / maven2 < / url > \n - < url > http : / / oss . sonatype . org / content / repositories / snapshots / < / url > \n + < url > http : / / oss . sonatype . org / content / repositories / snapshots < / url > \n core \ pom . xml \n - < source > 1 . 3 < / source > \n - < target > 1 . 3 < / target > \n + < source > 6 < / source > \n + < target > 6 < / target > \n - < url > http : / / oss . sonatype . org / content / repositories / staging / < / url > \n + < url > https : / / oss . sonatype . org / service / local / staging / deploy / maven2 < / url > \n - < url > http : / / oss . sonatype . org / content / repositories / snapshots / < / url > \n + < url > http : / / oss . sonatype . org / content / repositories / snapshots < / url > \n javase \ pom . xml \n - < url > http : / / oss . sonatype . org / content / repositories / staging / < / url > \n + < url > https : / / oss . sonatype . org / service / local / staging / deploy / maven2 < / url > \n - < url > http : / / oss . sonatype . org / content / repositories / snapshots / < / url > \n + < url > http : / / oss . sonatype . org / content / repositories / snapshots < / url > \n,Few more pom fixes for new OSS config \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2072 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 0 . 4 < / version > \n + < version > 2 . 1 . 2 < / version > \n - < version > 2 . 3 < / version > \n + < version > 2 . 8 < / version > \n core \ pom . xml \n - < version > 2 . 0 . 4 < / version > \n + < version > 2 . 1 . 2 < / version > \n - < version > 2 . 3 < / version > \n + < version > 2 . 8 < / version > \n javase \ pom . xml \n - < version > 2 . 0 . 4 < / version > \n + < version > 2 . 1 . 2 < / version > \n - < version > 2 . 3 < / version > \n + < version > 2 . 8 < / version > \n,More pom changes - may need later plugin versions to proceed \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2073 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n - < version > 2 . 0 - SNAPSHOT < / version > \n + < version > 20 - beta < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / url > \n,[ maven - release - plugin ] prepare release core - 20 - beta \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2075 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n - < version > 20 - beta < / version > \n + < version > 2 . 0 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / core - 20 - beta < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2077 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fr \ strings . xml \n - < string name = "" msg _ sure "" > Etes - vous sûr ? < / string > \n + < string name = "" msg _ sure "" > Êtes - vous sûr ? < / string > \n",Issue 979 small user contributed French fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1906 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - < ant dir = "" javame "" target = "" build "" / > \n - < ant dir = "" javame "" target = "" clean "" / > \n",Don ' t build javame anymore in main build \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1909 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ encoder \ PDF417 . java \n - public PDF417 ( ) { \n + PDF417 ( ) { \n - public PDF417 ( boolean compact ) { \n + PDF417 ( boolean compact ) { \n core \ src \ com \ google \ zxing \ pdf417 \ encoder \ PDF417Writer . java \n - private PDF417 initializeEncoder ( BarcodeFormat format , boolean compact ) { \n + private static PDF417 initializeEncoder ( BarcodeFormat format , boolean compact ) { \n - private BitMatrix bitMatrixFromEncoder ( PDF417 encoder , String contents , int width , int height ) \n + private static BitMatrix bitMatrixFromEncoder ( PDF417 encoder , String contents , int width , int height ) \n",Few more PDF417 changes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1912 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"rename from android \ res \ values - ja - rJP \ strings . xml \n rename to android \ res \ values - ja \ strings . xml \n android \ src \ com \ google \ zxing \ client \ android \ LocaleManager . java \n + import java . util . Arrays ; \n - import java . util . HashSet ; \n - LANGUAGE = locale = = null ? DEFAULT _ LANGUAGE : locale . getLanguage ( ) ; \n + String language = locale = = null ? DEFAULT _ LANGUAGE : locale . getLanguage ( ) ; \n + / / Special case Chinese \n + if ( Locale . SIMPLIFIED _ CHINESE . getLanguage ( ) . equals ( language ) ) { \n + language + = "" - r "" + COUNTRY ; \n + } \n + LANGUAGE = language ; \n - private static final Collection < String > TRANSLATED _ HELP _ ASSET _ LANGUAGES ; \n - static { \n - TRANSLATED _ HELP _ ASSET _ LANGUAGES = new HashSet < String > ( ) ; \n - TRANSLATED _ HELP _ ASSET _ LANGUAGES . add ( "" en "" ) ; \n - } \n + private static final Collection < String > TRANSLATED _ HELP _ ASSET _ LANGUAGES = \n + Arrays . asList ( "" en "" ) ; \n javase \ src \ com \ google \ zxing \ StringsResourceTranslator . java \n - private static final long MIN _ API _ CALL _ INTERVAL _ MS = 5 * 1000L ; \n + private static final long MIN _ API _ CALL _ INTERVAL _ MS = 10 * 1000L ; \n - private static final Map < String , String > LANGUAGE _ CODE _ MASSAGINGS = new HashMap < String , String > ( 7 ) ; \n + private static final Map < String , String > LANGUAGE _ CODE _ MASSAGINGS = new HashMap < String , String > ( 3 ) ; \n - LANGUAGE _ CODE _ MASSAGINGS . put ( "" ja - rJP "" , "" ja "" ) ; \n + translation = translation . replaceAll ( "" \ \ \ \ u200b "" , "" "" ) ; \n","Japanese language strings better as "" values - ja "" , and other small translator tweaks \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1914 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ AndroidManifest . xml \n - < ! - - For Donut and above we must specify that we use the camera , but intentionally omit the \n - autofocus feature in order for the app to appear in Market for non - AF devices . While it ' s true \n - that 1D barcodes will not be scannable , QR Codes will work . Ideally we ' d show users a message \n - to this effect on first launch . - - > \n + < uses - feature android : name = "" android . hardware . camera . autofocus "" android : required = "" false "" / > \n + < uses - feature android : name = "" android . hardware . wifi "" android : required = "" false "" / > \n + < uses - feature android : name = "" android . hardware . touchscreen "" android : required = "" false "" / > \n","Explicitly don ' t require touchscreen , wifi , autofocus - - think Market was assuming touchscreen / wifi due to permissions \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1919 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ res \ values - zh - rTW \ strings . xml \n - < string name = "" preferences _ bulk _ mode _ summary "" > 條碼掃描和挽救了許多人不斷 < / string > \n + < string name = "" preferences _ bulk _ mode _ summary "" > 連續掃描並儲存多個條碼 < / string > \n",Issue 991 tiny Chinese translation fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1927 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - int width = screenResolution . x * 3 / 4 ; \n + int width = screenResolution . x * 3 / 5 ; \n - int height = screenResolution . y * 3 / 4 ; \n + int height = screenResolution . y * 3 / 5 ; \n,"Reticle is getting quite small with new larger boundaries for tablets - - go to 60 % , to help focus too \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1930 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ pdf417 \ decoder \ BitMatrixParser . java \n - / / if ( debug ) System . out . println ( "" "" + Long . toBinaryString ( symbol ) + \n - / / "" cw = "" + cw + "" ColumnNumber = "" + columnNumber + "" i = "" + i ) ; \n + if ( eraseCount > = erasures . length ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n - / / if ( debug ) System . out . println ( "" "" + Long . toBinaryString ( symbol ) + \n - / / "" cw = "" + cw + "" ColumnNumber = "" + columnNumber + "" i = "" + i ) ; \n",Issue 982 maybe avoid an AIOOBE \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1933 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - bg \ strings . xml \n - < string name = "" msg _ share _ explanation "" > Можете да споделяте информация като покажете баркод на екрана , и го сцанирате от друг телефон . < / string > \n + < string name = "" msg _ share _ explanation "" > Можете да споделяте информация като покажете баркод на екрана , и го сканирате от друг телефон . < / string > \n - < string name = "" permission _ share "" > Дял от баркод < / string > \n - < string name = "" permission _ share _ desc "" > Позволява ви да споделят и да добавите контакти и отметките чрез представяне или сканиране на баркод и да изнасят сканирани информация . < / string > \n - < string name = "" permission _ wifi "" > Конфигуриране на Wi - Fi с баркод < / string > \n - < string name = "" permission _ wifi _ desc "" > Позволява ви да конфигурирате мрежа Wi - Fi връзка чрез сканиране на баркода . < / string > \n + < string name = "" permission _ share "" > Споделяне с баркод < / string > \n + < string name = "" permission _ share _ desc "" > Позволява Ви да споделяте и да добавяте контакти и отметки чрез показване или сканиране на баркод . < / string > \n + < string name = "" permission _ wifi "" > Конфигуриране на Wi - Fi чрез баркод < / string > \n + < string name = "" permission _ wifi _ desc "" > Позволява Ви да конфигурирате Wi - Fi връзка чрез сканиране на баркод . < / string > \n",Issue 997 fixes for Bulgarian strings \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1936 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n + android : clearTaskOnLaunch = "" true "" \n + android : stateNotNeeded = "" true "" \n - android : label = "" @ string / preferences _ name "" > \n + android : label = "" @ string / preferences _ name "" \n + android : stateNotNeeded = "" true "" > \n - < activity android : name = "" . encode . EncodeActivity "" android : label = "" @ string / share _ name "" > \n + < activity android : name = "" . encode . EncodeActivity "" \n + android : label = "" @ string / share _ name "" \n + android : stateNotNeeded = "" true "" > \n + android : stateNotNeeded = "" true "" \n + android : stateNotNeeded = "" true "" \n - android : label = "" @ string / bookmark _ picker _ name "" > \n + android : label = "" @ string / bookmark _ picker _ name "" \n + android : stateNotNeeded = "" true "" > \n + android : stateNotNeeded = "" true "" \n",Manifest changes I think we want : no state needed with one exception ; always restart from scanning from Home \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1943 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - int width = screenResolution . x * 3 / 5 ; \n + int width = screenResolution . x * 3 / 4 ; \n - int height = screenResolution . y * 3 / 5 ; \n + int height = screenResolution . y * 3 / 4 ; \n,Go back to 75 % reticle size \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1944 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ qrcode \ QRCodeReader . java \n + \n + if ( bottom - top ! = right - left ) { \n + / / Special case , where bottom - right module wasn ' t black so we found something else in the last row \n + / / Assume it ' s a square , so use height as the width \n + right = left + ( bottom - top ) ; \n + } \n",Issue 1002 handle case where pure QR code ' s bottom right module isn ' t black \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1946 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ ViewfinderView . java \n - paint = new Paint ( ) ; \n + paint = new Paint ( Paint . ANTI _ ALIAS _ FLAG ) ; \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - private static final int MAX _ FRAME _ WIDTH = 480 ; \n - private static final int MAX _ FRAME _ HEIGHT = 360 ; \n + private static final int MAX _ FRAME _ WIDTH = 600 ; \n + private static final int MAX _ FRAME _ HEIGHT = 400 ; \n android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ ProductResultInfoRetriever . java \n + import android . text . Html ; \n - append ( productID , source , new String [ ] { matcher . group ( 1 ) , matcher . group ( 2 ) } , uri ) ; \n + append ( productID , \n + source , \n + new String [ ] { unescapeHTML ( matcher . group ( 1 ) ) , unescapeHTML ( matcher . group ( 2 ) ) } , \n + uri ) ; \n + private static String unescapeHTML ( String raw ) { \n + return Html . fromHtml ( raw ) . toString ( ) ; \n + } \n + \n core \ src \ com \ google \ zxing \ oned \ ITFReader . java \n - private static final int [ ] DEFAULT _ ALLOWED _ LENGTHS = { 44 , 24 , 20 , 18 , 16 , 14 , 12 , 10 , 8 , 6 } ; \n + private static final int [ ] DEFAULT _ ALLOWED _ LENGTHS = { 48 , 44 , 24 , 20 , 18 , 16 , 14 , 12 , 10 , 8 , 6 } ; \n","Misc improvements : bigger scanner on tablets , anti - aliased drawing , escape HTML in product results , ITF - 14 allows 48 digits \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1903 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - Message message = Message . obtain ( handler , R . id . launch _ product _ query ) ; \n - message . obj = returnUrlTemplate . replace ( RETURN _ CODE _ PLACEHOLDER , \n - resultHandler . getDisplayContents ( ) . toString ( ) ) ; \n - handler . sendMessageDelayed ( message , INTENT _ RESULT _ DURATION ) ; \n + if ( returnUrlTemplate ! = null ) { \n + Message message = Message . obtain ( handler , R . id . launch _ product _ query ) ; \n + message . obj = returnUrlTemplate . replace ( RETURN _ CODE _ PLACEHOLDER , \n + String . valueOf ( resultHandler . getDisplayContents ( ) ) ) ; \n + handler . sendMessageDelayed ( message , INTENT _ RESULT _ DURATION ) ; \n + } \n",Guess at avoiding an NPE reported by a user \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1970 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ HybridBinarizer . java \n - / / - * - mode : java ; tab - width : 2 ; indent - tabs - mode : nil ; c - basic - offset : 2 - * - \n core \ test \ src \ com \ google \ zxing \ oned \ rss \ RSS14BlackBox2TestCase . java \n - addTest ( 0 , 8 , 0 . 0f ) ; \n - addTest ( 0 , 8 , 180 . 0f ) ; \n + addTest ( 3 , 8 , 0 . 0f ) ; \n + addTest ( 2 , 8 , 180 . 0f ) ; \n",Update RSS14 test ; remove IDE formatting comment ( ? ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1975 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ qrcode \ encoder \ Encoder . java \n - int numInputBytes = dataBits . getSizeInBytes ( ) ; \n - initQRCode ( numInputBytes , ecLevel , mode , qrCode ) ; \n + int numInputBits = dataBits . getSize ( ) ; \n + initQRCode ( numInputBits , ecLevel , mode , qrCode ) ; \n - * Initialize "" qrCode "" according to "" numInputBytes "" , "" ecLevel "" , and "" mode "" . On success , \n + * Initialize "" qrCode "" according to "" numInputBits "" , "" ecLevel "" , and "" mode "" . On success , \n - private static void initQRCode ( int numInputBytes , ErrorCorrectionLevel ecLevel , Mode mode , \n + private static void initQRCode ( int numInputBits , ErrorCorrectionLevel ecLevel , Mode mode , \n - / / ( precisely 4 + 16 bits ) at most . Hence we do + 3 here . \n - if ( numDataBytes > = numInputBytes + 3 ) { \n + / / ( precisely 4 + 16 bits ) at most . \n + if ( numDataBytes > = getTotalInputBytes ( numInputBits , version , mode ) ) { \n + \n + private static int getTotalInputBytes ( int numInputBits , Version version , Mode mode ) { \n + int modeInfoBits = 4 ; \n + int charCountBits = mode . getCharacterCountBits ( version ) ; \n + int headerBits = modeInfoBits + charCountBits ; \n + int totalBits = numInputBits + headerBits ; \n + \n + return ( totalBits + 7 ) / 8 ; \n + } \n",Issue 898 be more precise about calculating data size and version \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1852 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ src \ com \ google \ zxing \ integration \ android \ IntentIntegrator . java \n + intentScan . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ TOP ) ; \n + intentScan . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ WHEN _ TASK _ RESET ) ; \n + intent . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ TOP ) ; \n + intent . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ WHEN _ TASK _ RESET ) ; \n,Set better intent flags in integration so user ' s activity stays on top \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2024 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiConfigManager . java \n + wifiManager . saveConfiguration ( ) ; \n,Issue 1057 save wifi config on successful connect \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2026 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + import java . io . UnsupportedEncodingException ; \n + import java . net . URLEncoder ; \n - message . obj = returnUrlTemplate . replace ( RETURN _ CODE _ PLACEHOLDER , \n - String . valueOf ( resultHandler . getDisplayContents ( ) ) ) ; \n + String codeReplacement = String . valueOf ( resultHandler . getDisplayContents ( ) ) ; \n + try { \n + codeReplacement = URLEncoder . encode ( codeReplacement , "" UTF - 8 "" ) ; \n + } catch ( UnsupportedEncodingException e ) { \n + / / can ' t happen ; UTF - 8 is always supported . Continue , I guess , without encoding \n + } \n + message . obj = returnUrlTemplate . replace ( RETURN _ CODE _ PLACEHOLDER , codeReplacement ) ; \n",Issue 1061 URL - escape { CODE } replacement \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2034 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - es \ strings . xml \n - < string name = "" msg _ default _ status "" > Coloque un código de barras en el interior del rectángulo de el visor para escanear . < / string > \n + < string name = "" msg _ default _ status "" > Coloque un código de barras en el interior del rectángulo del visor para escanear . < / string > \n - < string name = "" msg _ share _ subject _ line "" > Aquí está el contenido de el código de barras que ha escaneado < / string > \n + < string name = "" msg _ share _ subject _ line "" > Aquí está el contenido del código de barras que ha escaneado < / string > \n",Minor Spanish fixes from a user \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2035 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - super . onPause ( ) ; \n + if ( ! hasSurface ) { \n + SurfaceView surfaceView = ( SurfaceView ) findViewById ( R . id . preview _ view ) ; \n + SurfaceHolder surfaceHolder = surfaceView . getHolder ( ) ; \n + surfaceHolder . removeCallback ( this ) ; \n + } \n + super . onPause ( ) ; \n android \ src \ com \ google \ zxing \ client \ android \ DecodeHandler . java \n - BinaryBitmap bitmap = new BinaryBitmap ( new HybridBinarizer ( source ) ) ; \n - try { \n - rawResult = multiFormatReader . decodeWithState ( bitmap ) ; \n - } catch ( ReaderException re ) { \n - / / continue \n - } finally { \n - multiFormatReader . reset ( ) ; \n + if ( source ! = null ) { \n + BinaryBitmap bitmap = new BinaryBitmap ( new HybridBinarizer ( source ) ) ; \n + try { \n + rawResult = multiFormatReader . decodeWithState ( bitmap ) ; \n + } catch ( ReaderException re ) { \n + / / continue \n + } finally { \n + multiFormatReader . reset ( ) ; \n + } \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - throw new IllegalStateException ( ) ; \n + return null ; \n,Fix some camera - related crashes on 3 . 71 that we may need to also put out a back - ported fix for \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2036 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"javase \ src \ com \ google \ zxing \ client \ j2se \ BufferedImageLuminanceSource . java \n - for ( int i = top ; i < top + height ; i + + ) { \n - for ( int j = left ; j < left + width ; j + + ) { \n - if ( ( image . getRGB ( i , j ) & 0xFF000000 ) = = 0 ) { \n - image . setRGB ( i , j , 0xFFFFFFFF ) ; / / = white \n + for ( int y = top ; y < top + height ; y + + ) { \n + for ( int x = left ; x < left + width ; x + + ) { \n + if ( ( image . getRGB ( x , y ) & 0xFF000000 ) = = 0 ) { \n + image . setRGB ( x , y , 0xFFFFFFFF ) ; / / = white \n",Typo fix - mixed up x / y ! \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2037 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ project . properties \n + proguard . config = proguard . cfg \n androidtest \ AndroidManifest . xml \n - android : icon = "" @ drawable / icon "" \n - android : debuggable = "" true "" > \n + android : icon = "" @ drawable / icon "" > \n androidtest \ project . properties \n + proguard . config = proguard . cfg \n",Let Proguard work for release builds \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2039 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - ru \ strings . xml \n - < string name = "" button _ sms "" > Послать SMS < / string > \n + < string name = "" button _ sms "" > Отправить SMS < / string > \n - < string name = "" msg _ google _ shopper _ missing "" > Проложение "" Google Shopper "" не установлено < / string > \n + < string name = "" msg _ google _ shopper _ missing "" > Приложение "" Google Shopper "" не установлено < / string > \n - < string name = "" msg _ not _ our _ results "" > Вы покидаете это приложение . Результаты поиска , которые вы видите , не связанны с этим приложением . < / string > \n + < string name = "" msg _ not _ our _ results "" > Вы покидаете это приложение . Результаты поиска , которые вы видите , не связаны с этим приложением . < / string > \n - < string name = "" permission _ share "" > Доля по штрих - коду < / string > \n - < string name = "" permission _ share _ desc "" > Позволяет совместно использовать и добавлять контакты и закладки , отображая или сканирование штрих - кодов , а также экспортировать отсканированную информацию . < / string > \n + < string name = "" permission _ share "" > Поделиться штрих - кодом < / string > \n + < string name = "" permission _ share _ desc "" > Позволяет делиться контактами и закладками через QR - код , а также экспортировать отсканированную информацию . < / string > \n",Russian updates from Dmitry \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2041 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - bg \ strings . xml \n - < string name = "" preferences _ search _ country "" > Търсене страната < / string > \n + < string name = "" preferences _ search _ country "" > Държава при търсене < / string > \n",Bulgarian update from Lachezar \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2045 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n + private static final int MAX _ PREVIEW _ PIXELS = 800 * 480 ; / / large / HD screen \n - screenResolution = new Point ( display . getWidth ( ) , display . getHeight ( ) ) ; \n + int width = display . getWidth ( ) ; \n + int height = display . getHeight ( ) ; \n + / / We ' re landscape - only , and have apparently seen issues with display thinking it ' s portrait \n + / / when waking from sleep . If it ' s not landscape , assume it ' s mistaken and reverse them : \n + if ( width < height ) { \n + Log . i ( TAG , "" Display reports portrait orientation ; assuming this is incorrect "" ) ; \n + int temp = width ; \n + width = height ; \n + height = temp ; \n + } \n + screenResolution = new Point ( width , height ) ; \n - if ( supportedPreviewSize . height * supportedPreviewSize . width < MIN _ PREVIEW _ PIXELS ) { \n + int pixels = supportedPreviewSize . height * supportedPreviewSize . width ; \n + if ( pixels < MIN _ PREVIEW _ PIXELS | | pixels > MAX _ PREVIEW _ PIXELS ) { \n","Cap preview size used at about 800x480 ; for Issue 1069 , adjust Display info by correcting to landscape \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2046 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ MultiFormatReader . java \n - import java . util . List ; \n - private final List < Reader > readers = new ArrayList < Reader > ( ) ; \n + private Reader [ ] readers ; \n - if ( readers . isEmpty ( ) ) { \n + if ( readers = = null ) { \n - readers . clear ( ) ; \n + Collection < Reader > readers = new ArrayList < Reader > ( ) ; \n + this . readers = readers . toArray ( new Reader [ readers . size ( ) ] ) ; \n - for ( Reader reader : readers ) { \n - reader . reset ( ) ; \n + if ( readers ! = null ) { \n + for ( Reader reader : readers ) { \n + reader . reset ( ) ; \n + } \n - for ( Reader reader : readers ) { \n - try { \n - return reader . decode ( image , hints ) ; \n - } catch ( ReaderException re ) { \n - / / continue \n + if ( readers ! = null ) { \n + for ( Reader reader : readers ) { \n + try { \n + return reader . decode ( image , hints ) ; \n + } catch ( ReaderException re ) { \n + / / continue \n + } \n core \ src \ com \ google \ zxing \ oned \ MultiFormatOneDReader . java \n - import java . util . List ; \n - private final List < OneDReader > readers ; \n + private final OneDReader [ ] readers ; \n - readers = new ArrayList < OneDReader > ( ) ; \n + Collection < OneDReader > readers = new ArrayList < OneDReader > ( ) ; \n + this . readers = readers . toArray ( new OneDReader [ readers . size ( ) ] ) ; \n core \ src \ com \ google \ zxing \ oned \ MultiFormatUPCEANReader . java \n - import java . util . List ; \n - private final List < UPCEANReader > readers ; \n + private final UPCEANReader [ ] readers ; \n - readers = new ArrayList < UPCEANReader > ( ) ; \n + Collection < UPCEANReader > readers = new ArrayList < UPCEANReader > ( ) ; \n + this . readers = readers . toArray ( new UPCEANReader [ readers . size ( ) ] ) ; \n","Surprising , but these small changes to avoid allocation of a foreach loop iterator save 1 - 2 % runtime . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2047 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ pdf417 \ decoder \ DecodedBitStreamParser . java \n - private static int numericCompaction ( int [ ] codewords , int codeIndex , StringBuilder result ) { \n + private static int numericCompaction ( int [ ] codewords , int codeIndex , StringBuilder result ) throws FormatException { \n - BigInteger s = decodeBase900toBase10 ( numericCodewords , count ) ; \n + String s = decodeBase900toBase10 ( numericCodewords , count ) ; \n - private static BigInteger decodeBase900toBase10 ( int [ ] codewords , int count ) { \n + private static String decodeBase900toBase10 ( int [ ] codewords , int count ) throws FormatException { \n - return result ; \n + String resultString = result . toString ( ) ; \n + if ( resultString . charAt ( 0 ) ! = ' 1 ' ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n + return resultString . substring ( 1 ) ; \n",Issue 1074 fix incorrect decoding of some numeric segments \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2048 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ CharacterSetECI . java \n - UnicodeBigUnmarked ( 25 , "" UTF - 16BE "" ) , \n + UnicodeBigUnmarked ( 25 , "" UTF - 16BE "" , "" UTF - 16 "" ) , \n - ASCII ( 27 , "" US - ASCII "" ) , \n + ASCII ( new int [ ] { 27 , 170 } , "" US - ASCII "" ) , \n - EUC _ CN ( new int [ ] { 29 } , "" x - EUC _ CN "" ) , \n + EUC _ CN ( new int [ ] { 29 } , "" GB2312 "" , "" GB18030 "" ) , \n",More Issue 1084 - - more aliases for certain encodings \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2063 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ CharacterSetECI . java \n - UnicodeBigUnmarked ( 25 , "" UTF - 16BE "" , "" UTF - 16 "" ) , \n + UnicodeBigUnmarked ( 25 , "" UTF - 16BE "" , "" UnicodeBig "" ) , \n - EUC _ CN ( new int [ ] { 29 } , "" GB2312 "" , "" GB18030 "" ) , \n - EUC _ KR ( new int [ ] { 30 } , "" EUC - KR "" ) ; \n + GB18030 ( 29 , "" GB2312 "" , "" EUC _ CN "" , "" GBK "" ) , \n + EUC _ KR ( 30 , "" EUC - KR "" ) ; \n - } \n + } \n",Issue 1084 one more time \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2064 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
iphone \ ZXingWidget \ Classes \ ZXingWidgetController . m \n - [ device setTorchMode : AVCaptureTorchModeOn ] ; \n + [ device setTorchMode : AVCaptureTorchModeOff ] ; \n,Issue 903 logic error for setting torch \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1853 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ datamatrix \ DataMatrixReader . java \n - if ( matrixWidth = = 0 | | matrixHeight = = 0 ) { \n + if ( matrixWidth < = 0 | | matrixHeight < = 0 ) { \n core \ src \ com \ google \ zxing \ qrcode \ QRCodeReader . java \n - if ( matrixWidth = = 0 | | matrixHeight = = 0 ) { \n + if ( matrixWidth < = 0 | | matrixHeight < = 0 ) { \n,Avoid exception in weird image situations \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1854 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"csharp \ client \ result \ optional \ NDEFTextResultParser . cs \n - System . String encoding = isUTF16 ? "" UTF - 16 "" : "" UTF8 "" ; \n + System . String encoding = isUTF16 ? "" UTF - 16 "" : "" UTF - 8 "" ; \n - } \n + } \n csharp \ client \ result \ optional \ NDEFURIResultParser . cs \n - System . String restOfURI = bytesToString ( payload , 1 , payload . Length - 1 , "" UTF8 "" ) ; \n + System . String restOfURI = bytesToString ( payload , 1 , payload . Length - 1 , "" UTF - 8 "" ) ; \n - } \n + } \n csharp \ qrcode \ decoder \ DecodedBitStreamParser . cs \n - private const System . String UTF8 = "" UTF8 "" ; \n + private const System . String UTF8 = "" UTF - 8 "" ; \n - } \n + } \n",Use UTF - 8 not UTF8 in C # ( Issue 936 ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1881 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ Contents . java \n + public static final String URL _ KEY = "" URL _ KEY "" ; \n + \n + public static final String NOTE _ KEY = "" NOTE _ KEY "" ; \n + \n android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n + String url = trim ( bundle . getString ( Contents . URL _ KEY ) ) ; \n + if ( url ! = null ) { \n + / / escapeMECARD ( url ) - > wrong escape e . g . http \ : / / zxing . google . com \n + newContents . append ( "" URL : "" ) . append ( url ) . append ( ' ; ' ) ; \n + newDisplayContents . append ( ' \ n ' ) . append ( url ) ; \n + } \n + \n + String note = trim ( bundle . getString ( Contents . NOTE _ KEY ) ) ; \n + if ( note ! = null ) { \n + newContents . append ( "" NOTE : "" ) . append ( escapeMECARD ( note ) ) . append ( ' ; ' ) ; \n + newDisplayContents . append ( ' \ n ' ) . append ( note ) ; \n + } \n + \n","Issue 939 add NOTE , URL to encoder \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1882 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
rename from android \ res \ values - kr \ strings . xml \n rename to android \ res \ values - ko \ strings . xml \n,Korean \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1904 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"javase \ src \ com \ google \ zxing \ client \ j2se \ BufferedImageLuminanceSource . java \n + \n + / / The color of fully - transparent pixels is irrelevant . They are often , technically , fully - transparent \n + / / black ( 0 alpha , and then 0 RGB ) . They are often used , of course as the "" white "" area in a \n + / / barcode image . Force any such pixel to be white : \n + for ( int i = top ; i < top + height ; i + + ) { \n + for ( int j = left ; j < left + width ; j + + ) { \n + if ( ( image . getRGB ( i , j ) & 0xFF000000 ) = = 0 ) { \n + image . setRGB ( i , j , 0xFFFFFFFF ) ; / / = white \n + } \n + } \n + } \n + \n",Issue 1059 treat transparent areas as white \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2028 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n - < uses - permission android : name = "" android . permission . WRITE _ CONTACTS "" \n - android : permissionGroup = "" com . google . zxing . client . android . SHARE _ PERMISSIONS "" / > \n - < uses - permission android : name = "" android . permission . WAKE _ LOCK "" \n - android : permissionGroup = "" com . google . zxing . client . android . WIFI _ PERMISSIONS "" / > \n","Turns out we do not need write - contact permission to add a contact by Intent , and do not need wake - lock for wifi in Android 2 . x \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2080 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ ContactInfoGenerator . java \n - value = value . replaceAll ( "" ( [ : ; ] ) "" , "" \ \ \ \ $ 1 "" ) ; \n + value = value . replaceAll ( "" ( [ \ \ \ \ : ; ] ) "" , "" \ \ \ \ $ 1 "" ) ; \n zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ WifiGenerator . java \n - input = input . replace ( "" ; "" , "" \ \ ; "" ) ; \n - input = input . replace ( "" : "" , "" \ \ : "" ) ; \n - input = input . replace ( "" \ \ "" , "" \ \ \ \ "" ) ; \n - input = input . replace ( "" / "" , "" \ \ / "" ) ; \n - return input ; \n + return input . replaceAll ( "" ( [ \ \ \ \ : ; ] ) "" , "" \ \ \ \ $ 1 "" ) ; \n zxing . appspot . com \ war \ app . yaml \n - version : 4 \n + version : 5 \n",Issue 1102 fix escaping in wifi codes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2084 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ Code128Reader . java \n - String resultString = result . toString ( ) ; \n - \n - if ( resultString . length ( ) < 2 ) { \n - / / Almost surely a false positive \n - throw FormatException . getFormatInstance ( ) ; \n - } \n - \n - resultString , \n + result . toString ( ) , \n",Issue 1103 stop excluding 1 - char code 128 as it does not seem to be a big deal for false positives now \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2085 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ multi \ qrcode \ detector \ MultiDetector . java \n + import com . google . zxing . ResultPointCallback ; \n - MultiFinderPatternFinder finder = new MultiFinderPatternFinder ( image ) ; \n + ResultPointCallback resultPointCallback = \n + hints = = null ? null : ( ResultPointCallback ) hints . get ( DecodeHintType . NEED _ RESULT _ POINT _ CALLBACK ) ; \n + MultiFinderPatternFinder finder = new MultiFinderPatternFinder ( image , resultPointCallback ) ; \n",Add result point callback to multi QR code detector \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2090 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n + < ! - - Support zxing : / / scan / ? . . . like iPhone app - - > \n + < intent - filter > \n + < action android : name = "" android . intent . action . VIEW "" / > \n + < category android : name = "" android . intent . category . DEFAULT "" / > \n + < category android : name = "" android . intent . category . BROWSABLE "" / > \n + < data android : scheme = "" zxing "" android : host = "" scan "" android : path = "" / "" / > \n + < / intent - filter > \n android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - private static final String ZXING _ URL = "" http : / / zxing . appspot . com / scan "" ; \n + private static final String [ ] ZXING _ URLS = { "" http : / / zxing . appspot . com / scan "" , "" zxing : / / scan / "" } ; \n - } else if ( dataString ! = null & & dataString . startsWith ( ZXING _ URL ) ) { \n + } else if ( isZXingURL ( dataString ) ) { \n + \n + private static boolean isZXingURL ( String dataString ) { \n + if ( dataString = = null ) { \n + return false ; \n + } \n + for ( String url : ZXING _ URLS ) { \n + if ( dataString . startsWith ( url ) ) { \n + return true ; \n + } \n + } \n + return false ; \n + } \n",Matching Issue 414 / commit 2088 change to iPhone : support zxing : / / scan / . . . URLs too \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2091 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ Code128Reader . java \n + if ( resultLength = = 0 ) { \n + / / false positive \n + throw ChecksumException . getChecksumInstance ( ) ; \n + } \n + \n,Slightly reverse Code 128 change : don ' t allow length 0 code \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2093 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n + import java . util . Collection ; \n - try { \n - activity . getPackageManager ( ) . getPackageInfo ( GOOGLE _ SHOPPER _ PACKAGE , 0 ) ; \n - / / If we didn ' t throw , Shopper is installed , so launch it . \n - Intent intent = new Intent ( Intent . ACTION _ SEARCH ) ; \n - intent . setClassName ( GOOGLE _ SHOPPER _ PACKAGE , GOOGLE _ SHOPPER _ ACTIVITY ) ; \n - intent . putExtra ( SearchManager . QUERY , query ) ; \n + \n + / / Construct Intent to launch Shopper \n + Intent intent = new Intent ( Intent . ACTION _ SEARCH ) ; \n + intent . setClassName ( GOOGLE _ SHOPPER _ PACKAGE , GOOGLE _ SHOPPER _ ACTIVITY ) ; \n + intent . putExtra ( SearchManager . QUERY , query ) ; \n + \n + / / Is it available ? \n + PackageManager pm = activity . getPackageManager ( ) ; \n + Collection < ? > availableApps = pm . queryIntentActivities ( intent , PackageManager . MATCH _ DEFAULT _ ONLY ) ; \n + \n + if ( availableApps ! = null & & ! availableApps . isEmpty ( ) ) { \n + / / If something can handle it , start it \n - } catch ( PackageManager . NameNotFoundException e ) { \n + } else { \n",Check more directly for Shopper ; saw a strange ActivityNotFoundException here \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2099 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + PreferenceManager . setDefaultValues ( this , R . xml . preferences , false ) ; \n + \n android \ src \ com \ google \ zxing \ client \ android \ DecodeThread . java \n - if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ 1D , true ) ) { \n + if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ 1D , false ) ) { \n - if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ QR , true ) ) { \n + if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ QR , false ) ) { \n - if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ DATA _ MATRIX , true ) ) { \n + if ( prefs . getBoolean ( PreferencesActivity . KEY _ DECODE _ DATA _ MATRIX , false ) ) { \n",Actually use CheckboxPreference defaults in preferences . xml ! \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2101 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n + < uses - feature android : name = "" android . hardware . camera . flash "" android : required = "" false "" / > \n + < uses - feature android : name = "" android . hardware . screen . landscape "" / > \n",Add a few more uses - features that describe the app better \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2102 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"javase \ src \ com \ google \ zxing \ client \ j2se \ MatrixToImageConfig . java \n + import java . awt . image . BufferedImage ; \n + \n + int getBufferedImageColorModel ( ) { \n + / / Use faster BINARY if colors match default \n + return onColor = = BLACK & & offColor = = WHITE ? BufferedImage . TYPE _ BYTE _ BINARY : BufferedImage . TYPE _ INT _ RGB ; \n + } \n + \n javase \ src \ com \ google \ zxing \ client \ j2se \ MatrixToImageWriter . java \n - BufferedImage image = new BufferedImage ( width , height , BufferedImage . TYPE _ INT _ RGB ) ; \n + BufferedImage image = new BufferedImage ( width , height , config . getBufferedImageColorModel ( ) ) ; \n",Speedup for black / white image rendering \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2365 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ ITFWriter . java \n + if ( length % 2 ! = 0 ) { \n + throw new IllegalArgumentException ( "" The lenght of the input should be even "" ) ; \n + } \n",Issue 1124 only allow encoding of even - length ITF input \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2118 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ VCardContactEncoder . java \n - private static final Pattern RESERVED _ VCARD _ CHARS = Pattern . compile ( "" ( [ \ \ \ \ : ; ] ) "" ) ; \n + private static final Pattern RESERVED _ VCARD _ CHARS = Pattern . compile ( "" ( [ \ \ \ \ , ; ] ) "" ) ; \n zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ ContactInfoGenerator . java \n - value = value . replaceAll ( "" ( [ \ \ \ \ : ; ] ) "" , "" \ \ \ \ $ 1 "" ) ; \n + value = value . replaceAll ( "" ( [ \ \ \ \ , ; ] ) "" , "" \ \ \ \ $ 1 "" ) ; \n","Issue 1126 In vCard , escape comma not colon \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2120 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n - String [ ] encoded = encoder . encode ( Arrays . asList ( contact . getNames ( ) ) , \n + String [ ] encoded = encoder . encode ( toIterable ( contact . getNames ( ) ) , \n - Arrays . asList ( contact . getAddresses ( ) ) , \n - Arrays . asList ( contact . getPhoneNumbers ( ) ) , \n - Arrays . asList ( contact . getEmails ( ) ) , \n + toIterable ( contact . getAddresses ( ) ) , \n + toIterable ( contact . getPhoneNumbers ( ) ) , \n + toIterable ( contact . getEmails ( ) ) , \n + private static Iterable < String > toIterable ( String [ ] values ) { \n + return values = = null ? null : Arrays . asList ( values ) ; \n + } \n + \n",Avoid an NPE in Arrays . asList \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2121 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ test \ src \ com \ google \ zxing \ client \ result \ AddressBookParsedResultTestCase . java \n + @ Test \n + public void testVCardEscape ( ) { \n + doTest ( "" BEGIN : VCARD \ r \ nNOTE : foo \ \ nbar \ r \ nEND : VCARD "" , \n + null , null , null , null , null , null , null , null , null , "" foo \ nbar "" ) ; \n + doTest ( "" BEGIN : VCARD \ r \ nNOTE : foo \ \ ; bar \ r \ nEND : VCARD "" , \n + null , null , null , null , null , null , null , null , null , "" foo ; bar "" ) ; \n + doTest ( "" BEGIN : VCARD \ r \ nNOTE : foo \ \ \ \ bar \ r \ nEND : VCARD "" , \n + null , null , null , null , null , null , null , null , null , "" foo \ \ bar "" ) ; \n + doTest ( "" BEGIN : VCARD \ r \ nNOTE : foo \ \ , bar \ r \ nEND : VCARD "" , \n + null , null , null , null , null , null , null , null , null , "" foo , bar "" ) ; \n + } \n + \n zxing . appspot . com \ war \ WEB - INF \ appengine - web . xml \n - < version > 2 < / version > \n + < version > 6 < / version > \n zxing . appspot . com \ war \ app . yaml \n - version : 5 \n + version : 6 \n",Update generator version and add one more test \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2123 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + historyManager . addHistoryItem ( rawResult , resultHandler ) ; \n - historyManager . addHistoryItem ( rawResult , resultHandler ) ; \n",( undo one unintentional change ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2126 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ AddressBookResultHandler . java \n - addressResult . getTitle ( ) ) ; \n + addressResult . getTitle ( ) , \n + addressResult . getURL ( ) , \n + addressResult . getBirthday ( ) ) ; \n android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n - addContact ( null , null , phoneNumbers , phoneTypes , null , null , null , null , null , null , null , null ) ; \n + addContact ( null , null , phoneNumbers , phoneTypes , null , null , null , null , null , null , null , null , null , null ) ; \n - addContact ( null , null , null , null , emails , emailTypes , null , null , null , null , null , null ) ; \n + addContact ( null , null , null , null , emails , emailTypes , null , null , null , null , null , null , null , null ) ; \n - String title ) { \n + String title , \n + String url , \n + String birthday ) { \n - putExtra ( intent , ContactsContract . Intents . Insert . NOTES , note ) ; \n + / / No field for URL , birthday ; use notes \n + StringBuilder aggregatedNotes = new StringBuilder ( ) ; \n + for ( String aNote : new String [ ] { url , birthday , note } ) { \n + if ( aNote ! = null ) { \n + if ( aggregatedNotes . length ( ) > 0 ) { \n + aggregatedNotes . append ( ' \ n ' ) ; \n + } \n + aggregatedNotes . append ( aNote ) ; \n + } \n + } \n + if ( aggregatedNotes . length ( ) > 0 ) { \n + putExtra ( intent , ContactsContract . Intents . Insert . NOTES , aggregatedNotes . toString ( ) ) ; \n + } \n + \n","Put URL , birthday in notes as there ' s not a better place for them by Intent \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2131 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"CHANGES \n - Mostly rewritten iPhone port \n - New ZXingWidget library to include scanning in any iOS app \n - Made CommandLineRunner multithreaded and recursive \n + \n + 2 . 0 ( 3 Feb 2012 ) \n + \n + - core / has been rewritten to work with Java 6 \n + - core / has new functionality : \n + - PDF 417 encoding ( from Barcode4J ) \n + - Codabar encoding \n + - partial Maxicode decoding support \n + - android / and androidtest / have been rewritten to work with Android 2 . 1 + \n + - Uses new camera APIs \n + - Uses new contact APIs too \n + - ( See separate Barcode Scanner release notes for version 4 . 0 ) \n + - zxing . appspot . com / has been rewritten to work with GWT 2 . 4 \n + - cpp / , objc / and iphone / have received many ports of fixes and other functionality from Java , and changes to work with more recent iOS \n + - bug / , rim / , and javame / have been removed \n + - Many , many small bug fixes and optimizations , mostly to core / and android / \n",Draft CHANGES updates for 2 . 0 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2132 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ ViewfinderView . java \n - synchronized ( point ) { \n + synchronized ( points ) { \n,"Tiny fix - - synchronized on arg , not list \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2133 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ EncodeActivity . java \n + if ( bitmap = = null ) { \n + return ; \n + } \n + \n + if ( bitmap = = null ) { \n + Log . w ( TAG , "" Could not encode barcode "" ) ; \n + showErrorMessage ( R . string . msg _ encode _ contents _ failed ) ; \n + qrCodeEncoder = null ; \n + return ; \n + } \n + \n android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n + String contentsToEncode = contents ; \n + if ( contentsToEncode = = null ) { \n + return null ; \n + } \n - String encoding = guessAppropriateEncoding ( contents ) ; \n + String encoding = guessAppropriateEncoding ( contentsToEncode ) ; \n - BitMatrix result = writer . encode ( contents , format , dimension , dimension , hints ) ; \n + BitMatrix result = writer . encode ( contentsToEncode , format , dimension , dimension , hints ) ; \n",Maybe avoid a weird NPE \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2135 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"zxingorg \ web \ index . jspx \n - < jsp : text > < ! [ CDATA [ < ! DOCTYPE html PUBLIC "" - / / WAPFORUM / / DTD XHTML Mobile 1 . 1 / / EN "" "" http : / / www . openmobilealliance . org / tech / DTD / xhtml - mobile11 . dtd "" > ] ] > < / jsp : text > \n + < jsp : text > < ! [ CDATA [ < ! DOCTYPE html PUBLIC "" - / / W3C / / DTD XHTML 1 . 0 Strict / / EN "" "" http : / / www . w3 . org / TR / xhtml1 / DTD / xhtml1 - strict . dtd "" > ] ] > < / jsp : text > \n - < title > Download ZXing Reader < / title > \n + < title > Redirect < / title > \n + < meta http - equiv = "" Refresh "" content = "" 0 ; url = decode . jspx "" / > \n - < h1 > < img src = "" zxing - icon . png "" height = "" 32 "" width = "" 32 "" alt = "" "" / > Download ZXing Reader < / h1 > \n - < p > \n - < a href = "" market : / / search ? q = pname % 3Acom . google . zxing . client . android "" > Download < / a > the Android client . \n - < / p > \n - < p > \n - < a href = "" BarcodeReader . jad "" > Download < / a > the Barcode Reader for J2ME . \n - < / p > \n - < p > \n - ( < a href = "" basic / BarcodeReader . jad "" > Download < / a > the alternate "" basic "" version for J2ME . ) \n - < / p > \n - < p > Copyright 2008 and onwards ZXing authors < / p > \n - < jsp : include page = "" analytics . jspx "" / > \n",Issue 1189 remove old links and redirect to decoder \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2208 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < ! - - I wish the project properties plugin could be used here - - > \n - < android - home > / Users / srowen / Applications / android - sdk - mac _ x86 / < / android - home > \n + < android - home > $ { env . ANDROID _ HOME } < / android - home > \n,Issue 1156 use ANDROID _ HOME system property \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2209 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ qrcode \ QRCodeReader . java \n - int nudge = Math . round ( moduleSize / 2 . 0f ) ; \n + int nudge = ( int ) ( moduleSize / 2 . 0f ) ; \n,"Issue 1188 fix nudge , to avoid exception in extreme images \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2210 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
android - integration \ pom . xml \n - < android - home > $ { env . ANDROID _ HOME } < / android - home > \n - < version > 3 . 0 < / version > \n - < type > jar < / type > \n - < scope > system < / scope > \n - < systemPath > / $ { android - home } / platforms / android - 13 / android . jar < / systemPath > \n + < version > 4 . 0 . 1 . 2 < / version > \n - < artifactId > support < / artifactId > \n - < type > jar < / type > \n - < version > v4 < / version > \n - < scope > system < / scope > \n - < systemPath > / $ { android - home } / extras / android / compatibility / v4 / android - support - v4 . jar < / systemPath > \n + < artifactId > support - v4 < / artifactId > \n + < version > r6 < / version > \n,Issue 1187 Better still use the artifacts that are now available in Maven central \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2211 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ CodaBarReader . java \n - if ( counterLength > = counterLength ) { \n + if ( counterLength > = counters . length ) { \n,Issue 1194 small bug fix in array expanding comparisons \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2212 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ VCardResultParser . java \n + private static final Pattern SEMICOLONS = Pattern . compile ( "" ; + "" ) ; \n - list . set ( 0 , list . get ( 0 ) ) ; \n + String adr = list . get ( 0 ) ; \n + / / Semicolon separators - - just make them a newline \n + adr = SEMICOLONS . matcher ( adr ) . replaceAll ( "" \ n "" ) . trim ( ) ; \n + list . set ( 0 , adr ) ; \n",Issue 1184 treat semicolon field separator as newline \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2214 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"AUTHORS \n + Juha Kuitunen \n android \ res \ values - fi \ strings . xml \n - < string name = "" msg _ intent _ failed "" > Valitettavasti pyydettyä sovellusta ei voitu käynnistää . Viivakoodi sisältö voi olla virheellinen . < / string > \n + < string name = "" msg _ intent _ failed "" > Valitettavasti pyydettyä sovellusta ei voitu käynnistää . Viivakoodin sisältö voi olla virheellinen . < / string > \n - < string name = "" msg _ sbc _ searching _ book "" > Haetaan kirjaa \ u2026 < / string > \n + < string name = "" msg _ sbc _ searching _ book "" > Haetaan kirjaa \ u2026 < / string > \n - < string name = "" preferences _ device _ bug _ workarounds _ title "" > Laitteen Bug Kiertotapoja < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Käytä vain standardinmukaisia tarkennus < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ title "" > Ei jatkuva painopiste < / string > \n - < string name = "" preferences _ disable _ exposure _ title "" > Ei altistumisen < / string > \n + < string name = "" preferences _ device _ bug _ workarounds _ title "" > Laitteen vikojen kiertäminen < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Käytä vain vakiotarkennusta < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ title "" > Ei jatkuvaa tarkennusta < / string > \n + < string name = "" preferences _ disable _ exposure _ title "" > Ei valotusta < / string > \n - < string name = "" preferences _ try _ bsplus _ summary "" > Parannettu uusia ominaisuuksia ja käyttöliittymä < / string > \n + < string name = "" preferences _ try _ bsplus _ summary "" > Parannettu uusilla ominaisuuksilla ja käyttöliittymäll < / string > \n",Issue 1388 More Finnish translations \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2439 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fi \ strings . xml \n - < string name = "" preferences _ try _ bsplus _ summary "" > Parannettu uusilla ominaisuuksilla ja käyttöliittymäll < / string > \n + < string name = "" preferences _ try _ bsplus _ summary "" > Parannettu uusilla ominaisuuksilla ja käyttöliittymällä < / string > \n",Small addendum to last Finnish update \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2440 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ multi \ qrcode \ QRCodeMultiReader . java \n - DecoderResult decoderResult = getDecoder ( ) . decode ( detectorResult . getBits ( ) ) ; \n + DecoderResult decoderResult = getDecoder ( ) . decode ( detectorResult . getBits ( ) , hints ) ; \n",Issue 1163 pass hint through multi QR code decoder \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2183 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ CharacterSetECI . java \n + import com . google . zxing . FormatException ; \n + \n - public static CharacterSetECI getCharacterSetECIByValue ( int value ) { \n + public static CharacterSetECI getCharacterSetECIByValue ( int value ) throws FormatException { \n - throw new IllegalArgumentException ( "" Bad ECI value : "" + value ) ; \n + throw FormatException . getFormatInstance ( ) ; \n core \ src \ com \ google \ zxing \ qrcode \ decoder \ DecodedBitStreamParser . java \n + if ( bits . available ( ) < 11 ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n - private static int parseECIValue ( BitSource bits ) { \n + private static int parseECIValue ( BitSource bits ) throws FormatException { \n - throw new IllegalArgumentException ( "" Bad ECI bits starting with byte "" + firstByte ) ; \n + throw FormatException . getFormatInstance ( ) ; \n",Avoid some rare IllegalArgumentException and ArrayIndexOutOfBoundsException on bad input \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2184 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ common \ reedsolomon \ GenericGF . java \n - * @ param a \n - * @ param b \n - \n + \n - \n - if ( a < 0 | | b < 0 | | a > = size | | b > = size ) { \n - a + + ; \n - } \n - \n - int logSum = logTable [ a ] + logTable [ b ] ; \n - return expTable [ ( logSum % size ) + logSum / size ] ; \n + return expTable [ ( logTable [ a ] + logTable [ b ] ) % ( size - 1 ) ] ; \n - public int getSize ( ) { \n + public int getSize ( ) { \n,Simplify old multiply logic for GF \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2185 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"AUTHORS \n + Dion Hardy \n android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + if ( metadata . containsKey ( ResultMetadataType . UPC _ EAN _ EXTENSION ) ) { \n + intent . putExtra ( Intents . Scan . RESULT _ UPC _ EAN _ EXTENSION , \n + metadata . get ( ResultMetadataType . UPC _ EAN _ EXTENSION ) . toString ( ) ) ; \n + } \n android \ src \ com \ google \ zxing \ client \ android \ Intents . java \n + / * * \n + * Call intent . getStringExtra ( RESULT _ UPC _ EAN _ EXTENSION ) to return any scanned additional barcode \n + * / \n + public static final String RESULT _ UPC _ EAN _ EXTENSION = "" SCAN _ RESULT _ UPC _ EAN _ EXTENSION "" ; \n + \n core \ src \ com \ google \ zxing \ ResultMetadataType . java \n - POSSIBLE _ COUNTRY \n + POSSIBLE _ COUNTRY , \n + \n + / * * \n + * For some products , the extension text \n + * / \n + UPC _ EAN _ EXTENSION , \n core \ src \ com \ google \ zxing \ oned \ MultiFormatUPCEANReader . java \n - return new Result ( result . getText ( ) . substring ( 1 ) , null , result . getResultPoints ( ) , BarcodeFormat . UPC _ A ) ; \n + / / Transfer the metdata across \n + Result resultUPCA = new Result ( result . getText ( ) . substring ( 1 ) , \n + result . getRawBytes ( ) , \n + result . getResultPoints ( ) , \n + BarcodeFormat . UPC _ A ) ; \n + resultUPCA . putAllMetadata ( result . getResultMetadata ( ) ) ; \n + return resultUPCA ; \n core \ src \ com \ google \ zxing \ oned \ UPCEANReader . java \n + decodeResult . putMetadata ( ResultMetadataType . UPC _ EAN _ EXTENSION , extensionResult . getText ( ) ) ; \n",Send through EAN extension with metadata \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2186 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ PerspectiveTransform . java \n - float dy2 = y3 - y2 ; \n + float dx3 = x0 - x1 + x2 - x3 ; \n - if ( dy2 = = 0 . 0f & & dy3 = = 0 . 0f ) { \n + if ( dx3 = = 0 . 0f & & dy3 = = 0 . 0f ) { \n + / / Affine \n - y1 - y0 , y2 - y1 , y0 , \n - 0 . 0f , 0 . 0f , 1 . 0f ) ; \n + y1 - y0 , y2 - y1 , y0 , \n + 0 . 0f , 0 . 0f , 1 . 0f ) ; \n - float dx3 = x0 - x1 + x2 - x3 ; \n + float dy2 = y3 - y2 ; \n - y1 - y0 + a13 * y1 , y3 - y0 + a23 * y3 , y0 , \n - a13 , a23 , 1 . 0f ) ; \n + y1 - y0 + a13 * y1 , y3 - y0 + a23 * y3 , y0 , \n + a13 , a23 , 1 . 0f ) ; \n",Issue 1170 fix condition for affine - ness \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2191 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
cpp \ core \ src \ zxing \ common \ PerspectiveTransform . cpp \n - float dy2 = y3 - y2 ; \n + float dx3 = x0 - x1 + x2 - x3 ; \n - if ( dy2 = = 0 . 0f & & dy3 = = 0 . 0f ) { \n + if ( dx3 = = 0 . 0f & & dy3 = = 0 . 0f ) { \n - float dx3 = x0 - x1 + x2 - x3 ; \n + float dy2 = y3 - y2 ; \n,Issue 1170 also fix cpp version \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2192 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ CalendarResultHandler . java \n - int offset = calendar . get ( Calendar . ZONE _ OFFSET ) + calendar . get ( Calendar . DST _ OFFSET ) ; \n - milliseconds + = offset ; \n + / / Account for time zone difference \n + milliseconds + = calendar . get ( Calendar . ZONE _ OFFSET ) ; \n + / / Might need to correct for daylight savings time , but use target time since \n + / / now might be in DST but not then , or vice versa \n + calendar . setTime ( new Date ( milliseconds ) ) ; \n + milliseconds + = calendar . get ( Calendar . DST _ OFFSET ) ; \n",Issue 1195 fix accounting for DST when target time DST status differs from now \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2216 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ TelResultHandler . java \n + / / When dialer comes up , it allows underlying display activity to continue or something , \n + / / but app can ' t get camera in this state . Avoid issues by just quitting , only in the \n + / / case of a phone number \n + getActivity ( ) . finish ( ) ; \n",Running underneath the dialer doesn ' t work . Quit the app if leaving to dial a number . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2282 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ qrcode \ decoder \ DecodedBitStreamParser . java \n + if ( bits . available ( ) < 16 ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n,Issue 1324 Generate proper FormatException on QR code with bad structured append segment \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2367 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - ru \ strings . xml \n - < string name = "" history _ clear _ one _ history _ text "" > Очистить < / string > \n - < string name = "" history _ clear _ text "" > Очистить историю < / string > \n + < string name = "" history _ clear _ one _ history _ text "" > Удалить < / string > \n + < string name = "" history _ clear _ text "" > Удалить историю < / string > \n android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryActivity . java \n + reloadHistoryItems ( ) ; \n + } \n + \n + private void reloadHistoryItems ( ) { \n - finish ( ) ; \n + reloadHistoryItems ( ) ; \n",Don ' t close history after clearing one item \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2447 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivityHandler . java \n + import android . content . ActivityNotFoundException ; \n - activity . startActivity ( intent ) ; \n + try { \n + activity . startActivity ( intent ) ; \n + } catch ( ActivityNotFoundException anfe ) { \n + Log . w ( TAG , "" Can ' t find anything to handle VIEW of URI "" + url ) ; \n + } \n",Issue 1392 log and warn about bad return URLs \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2448 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - intent = new Intent ( Intent . ACTION _ VIEW ) ; \n - intent . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ WHEN _ TASK _ RESET ) ; \n,Issue 1215 clear a little redundant code \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2226 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"actionscript \ core \ src \ com \ google \ zxing \ aztec \ AztecReader . as \n - import com . google . zxing . common . ResultPointCallback ; \n + import com . google . zxing . ResultPointCallback ; \n deleted file \n actionscript \ core \ src \ com \ google \ zxing \ common \ ResultPointCallback . as \n - / * \n - * Copyright 2009 ZXing authors \n - * \n - * Licensed under the Apache License , Version 2 . 0 ( the "" License "" ) ; \n - * you may not use this file except in compliance with the License . \n - * You may obtain a copy of the License at \n - * \n - * http : / / www . apache . org / licenses / LICENSE - 2 . 0 \n - * \n - * Unless required by applicable law or agreed to in writing , software \n - * distributed under the License is distributed on an "" AS IS "" BASIS , \n - * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND , either express or implied . \n - * See the License for the specific language governing permissions and \n - * limitations under the License . \n - * / \n - \n - package com . google . zxing \n - { \n - \n - / * * \n - * Callback which is invoked when a possible result point ( significant \n - * point in the barcode image such as a corner ) is found . \n - * \n - * @ see DecodeHintType # NEED _ RESULT _ POINT _ CALLBACK \n - * / \n - public interface ResultPointCallback { \n - \n - function foundPossibleResultPoint ( point : ResultPoint ) : void ; \n - \n - } \n - } \n actionscript \ core \ src \ com \ google \ zxing \ oned \ rss \ RSS14Reader . as \n - import com . google . zxing . common . ResultPointCallback ; \n + import com . google . zxing . ResultPointCallback ; \n actionscript \ core \ src \ com \ google \ zxing \ qrcode \ detector \ AlignmentPatternFinder . as \n - import com . google . zxing . common . ResultPointCallback ; \n + import com . google . zxing . ResultPointCallback ; \n actionscript \ core \ src \ com \ google \ zxing \ qrcode \ detector \ Detector . as \n - import com . google . zxing . common . ResultPointCallback ; \n + import com . google . zxing . ResultPointCallback ; \n actionscript \ core \ src \ com \ google \ zxing \ qrcode \ detector \ FinderPatternFinder . as \n - import com . google . zxing . common . ResultPointCallback ; \n + import com . google . zxing . ResultPointCallback ; \n",Issue 1136 more cleanup of Actionscript compile issues \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2227 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + private static final String RAW _ PARAM = "" raw "" ; \n + private boolean returnRaw ; \n - @ Override \n - public void onClick ( DialogInterface dialogInterface , int i ) { \n - Intent intent = new Intent ( Intent . ACTION _ VIEW , Uri . parse ( getString ( R . string . zxing _ url ) ) ) ; \n - intent . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ WHEN _ TASK _ RESET ) ; \n - startActivity ( intent ) ; \n - } \n - } ; \n + @ Override \n + public void onClick ( DialogInterface dialogInterface , int i ) { \n + Intent intent = new Intent ( Intent . ACTION _ VIEW , Uri . parse ( getString ( R . string . zxing _ url ) ) ) ; \n + intent . addFlags ( Intent . FLAG _ ACTIVITY _ CLEAR _ WHEN _ TASK _ RESET ) ; \n + startActivity ( intent ) ; \n + } \n + } ; \n + returnRaw = inputUri . getQueryParameter ( RAW _ PARAM ) ! = null ; \n - String codeReplacement = String . valueOf ( resultHandler . getDisplayContents ( ) ) ; \n + CharSequence codeReplacement = returnRaw ? rawResult . getText ( ) : resultHandler . getDisplayContents ( ) ; \n - codeReplacement = URLEncoder . encode ( codeReplacement , "" UTF - 8 "" ) ; \n + codeReplacement = URLEncoder . encode ( codeReplacement . toString ( ) , "" UTF - 8 "" ) ; \n",Issue 1213 add ' raw ' param to send back raw barcode text not processed form \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2229 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ WifiGenerator . java \n - return parseTextField ( "" SSID "" , ssid ) ; \n + String parsed = parseTextField ( "" SSID "" , ssid ) ; \n + return quoteHex ( parsed ) ; / / Android needs hex - like SSIDs quoted or will be read as hex \n + \n + private static String quoteHex ( String value ) { \n + if ( value ! = null & & value . matches ( "" [ 0 - 9A - Fa - f ] + "" ) ) { \n + if ( value . charAt ( 0 ) = = ' "" ' & & value . charAt ( value . length ( ) - 1 ) = = ' "" ' ) { \n + return value ; \n + } \n + return ' \ "" ' + value + ' \ "" ' ; \n + } \n + return value ; \n + } \n + \n",Quote hex - like SSIDs as ( at least ) they must appear this way in Android or else it will be interpreted as a hex SSID . Assuming that nobody actually wants to generate such an SSID in 2012 . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2230 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - < pathelement location = "" javame / src "" / > \n - < pathelement location = "" $ { android - home } / platforms / android - 10 / android . jar "" / > \n + < pathelement location = "" $ { android - home } / platforms / android - 15 / android . jar "" / > \n",Touch up javadoc target \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2234 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ qrcode \ decoder \ DecodedBitStreamParser . java \n + if ( bits . available ( ) < 6 ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n,Issue 1225 fix another AIOOBE for bad QR code \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2235 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ test \ src \ com \ google \ zxing \ common \ reedsolomon \ ReedSolomonEncoderQRCodeTestCase . java \n - int size = 1 + random . nextInt ( 1000 ) ; \n + int size = 2 + random . nextInt ( 254 ) ; \n + corrupt ( toEncode , ecBytes / 2 , random ) ; \n","Fix RS encoder test , per hwkns \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2236 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"zxingorg \ src \ com \ google \ zxing \ web \ DecodeServlet . java \n + import org . apache . http . impl . conn . BasicClientConnectionManager ; \n + import org . apache . http . params . BasicHttpParams ; \n + import org . apache . http . params . CoreConnectionPNames ; \n + import org . apache . http . params . HttpParams ; \n - import java . util . concurrent . TimeUnit ; \n - private HttpClient client ; \n - client = new DefaultHttpClient ( ) ; \n + HttpParams params = new BasicHttpParams ( ) ; \n + DefaultHttpClient . setDefaultHttpParams ( params ) ; \n + params . setIntParameter ( CoreConnectionPNames . SO _ LINGER , 5 ) ; / / Avoids CLOSE _ WAIT socket issue ? \n + params . setIntParameter ( CoreConnectionPNames . SO _ TIMEOUT , 5000 ) ; \n + params . setIntParameter ( CoreConnectionPNames . CONNECTION _ TIMEOUT , 5000 ) ; \n + \n + ClientConnectionManager connectionManager = new BasicClientConnectionManager ( ) ; \n + HttpClient client = new DefaultHttpClient ( connectionManager , params ) ; \n - ClientConnectionManager connectionManager = client . getConnectionManager ( ) ; \n - connectionManager . closeExpiredConnections ( ) ; \n - connectionManager . closeIdleConnections ( 1 , TimeUnit . SECONDS ) ; \n + connectionManager . shutdown ( ) ; \n - client . getConnectionManager ( ) . shutdown ( ) ; \n zxingorg \ src \ com \ google \ zxing \ web \ DoSFilter . java \n + import java . util . Arrays ; \n + public static final String BAD _ IPS _ INIT _ PARAM = "" bad . ips "" ; \n + private final Set < String > badIPAddresses ; \n + badIPAddresses = new HashSet < String > ( ) ; \n + badIPAddresses . clear ( ) ; \n + String badIPsString = filterConfig . getInitParameter ( BAD _ IPS _ INIT _ PARAM ) ; \n + if ( badIPsString ! = null ) { \n + badIPAddresses . addAll ( Arrays . asList ( badIPsString . split ( "" , "" ) ) ) ; \n + } \n - if ( bannedIPAddresses . contains ( remoteIPAddressString ) ) { \n + if ( bannedIPAddresses . contains ( remoteIPAddressString ) | | badIPAddresses . contains ( remoteIPAddressString ) ) { \n + badIPAddresses . clear ( ) ; \n zxingorg \ web \ WEB - INF \ web . xml \n + < init - param > \n + < param - name > bad . ips < / param - name > \n + < param - value > 69 . 89 . 31 . 60 , 2 . 95 . 142 . 74 < / param - value > < ! - - Causes weird CLOSE _ WAIT thread hangs - - > \n + < / init - param > \n","More drastic changes to prevent CLOSE _ WAIT - defensive socket settings , ban a troublesome IP \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2238 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ datamatrix \ detector \ Detector . java \n - corr = distance ( bottomLeft , bottomRight ) / ( float ) dimension ; \n + corr = distance ( bottomLeft , topLeft ) / ( float ) dimension ; \n",Vladimir ' s fix for a small typo in rect detection \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2239 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"AUTHORS \n + Anders Borg \n core \ src \ com \ google \ zxing \ pdf417 \ decoder \ DecodedBitStreamParser . java \n - / / the pdf417 specs say we have to return to the last latched \n - / / sub - mode . But I checked different encoder implementations and \n - / / all of them return to alpha sub - mode after Shift - to - Byte \n - subMode = Mode . ALPHA ; \n - / / the pdf417 specs say we have to return to the last latched \n - / / sub - mode . But I checked different encoder implementations and \n - / / all of them return to alpha sub - mode after Shift - to - Byte \n - subMode = Mode . ALPHA ; \n deleted file \n core \ test \ data \ blackbox \ pdf417 \ 08 . gif \n Binary files a / core / test / data / blackbox / pdf417 / 08 . gif and / dev / null differ \n deleted file \n core \ test \ data \ blackbox \ pdf417 \ 08 . txt \n - nä jag menar det där som sitter fast i din dörrkarm \n core \ test \ src \ com \ google \ zxing \ datamatrix \ DataMatrixBlackBox2TestCase . java \n - addTest ( 12 , 12 , 0 , 1 , 270 . 0f ) ; \n + addTest ( 13 , 13 , 0 , 1 , 270 . 0f ) ; \n core \ test \ src \ com \ google \ zxing \ pdf417 \ PDF417BlackBox1TestCase . java \n - addTest ( 5 , 5 , 0 . 0f ) ; \n - addTest ( 5 , 5 , 180 . 0f ) ; \n + addTest ( 4 , 4 , 0 . 0f ) ; \n + addTest ( 4 , 4 , 180 . 0f ) ; \n",Remove deviation from PDF417 spec and faulty unit test ( thanks Anders ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2241 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ proguard . cfg \n - dontpreverify \n - - optimizations ! code / simplification / arithmetic , ! code / simplification / cast , ! field / * , ! class / merging / * \n + - optimizations ! class / merging / * \n - optimizationpasses 5 \n - allowaccessmodification \n androidtest \ proguard . cfg \n - dontpreverify \n - - optimizations ! code / simplification / arithmetic , ! code / simplification / cast , ! field / * , ! class / merging / * \n + - optimizations ! class / merging / * \n - optimizationpasses 5 \n - allowaccessmodification \n",Apparently some of the default disabled optimizations are only there for Donut \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2245 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ qrcode \ QRCodeReader . java \n - int moduleSize = moduleSize ( leftTopBlack , image ) ; \n + float moduleSize = moduleSize ( leftTopBlack , image ) ; \n - int matrixWidth = ( right - left + 1 ) / moduleSize ; \n - int matrixHeight = ( bottom - top + 1 ) / moduleSize ; \n + int matrixWidth = Math . round ( ( right - left + 1 ) / moduleSize ) ; \n + int matrixHeight = Math . round ( ( bottom - top + 1 ) / moduleSize ) ; \n - int nudge = moduleSize > > 1 ; \n + int nudge = Math . round ( moduleSize / 2 . 0f ) ; \n - int iOffset = top + y * moduleSize ; \n + int iOffset = top + ( int ) ( y * moduleSize ) ; \n - if ( image . get ( left + x * moduleSize , iOffset ) ) { \n + if ( image . get ( left + ( int ) ( x * moduleSize ) , iOffset ) ) { \n - private static int moduleSize ( int [ ] leftTopBlack , BitMatrix image ) throws NotFoundException { \n + private static float moduleSize ( int [ ] leftTopBlack , BitMatrix image ) throws NotFoundException { \n - while ( x < width & & y < height & & image . get ( x , y ) ) { \n + boolean inBlack = true ; \n + int transitions = 0 ; \n + while ( x < width & & y < height ) { \n + if ( inBlack ! = image . get ( x , y ) ) { \n + if ( + + transitions = = 5 ) { \n + break ; \n + } \n + inBlack = ! inBlack ; \n + } \n - \n - int moduleSize = x - leftTopBlack [ 0 ] ; \n - if ( moduleSize = = 0 ) { \n - throw NotFoundException . getNotFoundInstance ( ) ; \n - } \n - return moduleSize ; \n + return ( x - leftTopBlack [ 0 ] ) / 7 . 0f ; \n","QR code "" pure barcode "" now forgiving of uneven module sizes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2103 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
core \ pom . xml \n - < version > 2 . 0 - SNAPSHOT < / version > \n + < version > 2 . 0 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / url > \n,[ maven - release - plugin ] prepare release core - 2 . 0 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2140 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n - < version > 2 . 0 < / version > \n + < version > 2 . 1 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / core - 2 . 0 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2142 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
javase \ pom . xml \n - < version > 2 . 0 - SNAPSHOT < / version > \n + < version > 2 . 0 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / javase < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / javase < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / javase < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / url > \n - < version > 2 . 0 - SNAPSHOT < / version > \n + < version > 2 . 0 < / version > \n,[ maven - release - plugin ] prepare release javase - 2 . 0 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2143 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
javase \ pom . xml \n - < version > 2 . 0 < / version > \n + < version > 2 . 1 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / javase - 2 . 0 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / javase < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / javase < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / javase < / url > \n - < version > 2 . 0 < / version > \n + < version > 2 . 1 - SNAPSHOT < / version > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2145 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < android - home > FILL IN YOUR PATH HERE < / android - home > \n + < android - home > / Users / srowen / Applications / android - sdk - mac _ x86 / < / android - home > \n,Temporarily commit my pom . xml change so release plugin works \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2146 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 0 - SNAPSHOT < / version > \n + < version > 2 . 0 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / android - integration < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / android - integration < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / android - integration < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / url > \n,[ maven - release - plugin ] prepare release android - integration - 2 . 0 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2147 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 0 < / version > \n + < version > 2 . 1 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 0 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / android - integration < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / android - integration < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / android - integration < / url > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2149 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - - > \n - < project name = "" ZXing "" default = "" build "" > \n + < project name = "" ZXing "" default = "" release "" > \n - < target name = "" build "" > \n - < ant dir = "" core "" target = "" build "" / > \n - < ant dir = "" javase "" target = "" build "" / > \n - < ant dir = "" android "" target = "" debug "" / > \n - < ant dir = "" androidtest "" target = "" debug "" / > \n - < ant dir = "" android - integration "" target = "" build "" / > \n - < / target > \n - \n - < target name = "" clean "" > \n - < ant dir = "" core "" target = "" clean "" / > \n - < ant dir = "" javase "" target = "" clean "" / > \n - < ant dir = "" android "" target = "" clean "" / > \n - < ant dir = "" androidtest "" target = "" clean "" / > \n - < ant dir = "" android - integration "" target = "" clean "" / > \n - < delete dir = "" docs / javadoc "" / > \n - < / target > \n - \n - < target name = "" test "" > \n - < ant dir = "" core "" target = "" test "" / > \n - < / target > \n - \n - < target name = "" release "" depends = "" build , clean , javadoc "" > \n + < target name = "" release "" depends = "" javadoc "" > \n - < include name = "" COPYING "" / > \n + < include name = "" COPYING "" / > \n + < include name = "" NOTICE "" / > \n + < include name = "" docs / * * "" / > \n + < include name = "" csharp / * * "" / > \n - < include name = "" javame / * * "" / > \n - < include name = "" docs / * * "" / > \n + < include name = "" jruby / * * "" / > \n + < include name = "" objc / * * "" / > \n + < include name = "" symbian / * * "" / > \n",One more change to release build file \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2151 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
build . properties \n - version = 2 . 0 \n + version = 2 . 1 \n,2 . 1 coming next \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2153 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"new file \n core \ test \ data \ blackbox \ aztec - 1 \ tag . png \n Binary files / dev / null and b / core / test / data / blackbox / aztec - 1 / tag . png differ \n new file \n core \ test \ data \ blackbox \ aztec - 1 \ tag . txt \n + Ceci est un tag . \n new file \n core \ test \ data \ blackbox \ aztec - 1 \ texte . png \n Binary files / dev / null and b / core / test / data / blackbox / aztec - 1 / texte . png differ \n new file \n core \ test \ data \ blackbox \ aztec - 1 \ texte . txt \n + Ceci est un texte ! \n core \ test \ src \ com \ google \ zxing \ aztec \ AztecBlackBox1TestCase . java \n - addTest ( 9 , 9 , 0 . 0f ) ; \n - addTest ( 9 , 9 , 90 . 0f ) ; \n - addTest ( 9 , 9 , 180 . 0f ) ; \n - addTest ( 9 , 9 , 270 . 0f ) ; \n + addTest ( 11 , 11 , 0 . 0f ) ; \n + addTest ( 11 , 11 , 90 . 0f ) ; \n + addTest ( 11 , 11 , 180 . 0f ) ; \n + addTest ( 11 , 11 , 270 . 0f ) ; \n",Test from issue 1112 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2160 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ AutoFocusManager . java \n - camera . cancelAutoFocus ( ) ; \n + try { \n + camera . cancelAutoFocus ( ) ; \n + } catch ( RuntimeException re ) { \n + / / Have heard RuntimeException reported in Android 4 . 0 . x + ; continue ? \n + Log . w ( TAG , "" Unexpected exception while cancelling focusing "" , re ) ; \n + } \n",Swallow weird RuntimeException on cancelling auto focus \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2340 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android - integration \ src \ com \ google \ zxing \ integration \ android \ IntentIntegrator . java \n + * < h2 > Enabling experimental barcode formats < / h2 > \n + * \n + * < p > Some formats are not enabled by default even when scanning with { @ link # ALL _ CODE _ TYPES } , such as \n + * { @ link com . google . zxing . BarcodeFormat # PDF _ 417 } . Use { @ link # initiateScan ( java . util . Collection ) } with \n + * a collection containing the names of formats to scan for explicitly , like "" PDF _ 417 "" , to use such \n + * formats . < / p > \n + * \n",Issue 1249 add note about enabling experimental formats \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2255 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ PlanarYUVLuminanceSource . java \n - public PlanarYUVLuminanceSource ( byte [ ] yuvData , int dataWidth , int dataHeight , int left , int top , \n - int width , int height , boolean reverseHorizontal ) { \n + public PlanarYUVLuminanceSource ( byte [ ] yuvData , \n + int dataWidth , \n + int dataHeight , \n + int left , \n + int top , \n + int width , \n + int height , \n + boolean reverseHorizontal ) { \n + @ Override \n + public LuminanceSource crop ( int left , int top , int width , int height ) { \n + return new PlanarYUVLuminanceSource ( yuvData , \n + dataWidth , \n + dataHeight , \n + this . left + left , \n + this . top + top , \n + width , \n + height , \n + false ) ; \n + } \n + \n",Add crop ( ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2256 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ VCardResultParser . java \n - List < String > org = matchSingleVCardPrefixedField ( "" ORG "" , rawText , true , false ) ; \n + List < String > org = matchSingleVCardPrefixedField ( "" ORG "" , rawText , true , true ) ; \n",Support multiple components in ORG \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2257 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + if ( surfaceHolder = = null ) { \n + throw new IllegalStateException ( "" No SurfaceHolder provided "" ) ; \n + } \n",Add a double - check for null SurfaceHolder \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2258 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ book \ BrowseBookListener . java \n - String pageId = items . get ( position - 1 ) . getPageId ( ) ; \n + int itemOffset = position - 1 ; \n + if ( itemOffset > = items . size ( ) ) { \n + return ; \n + } \n + String pageId = items . get ( itemOffset ) . getPageId ( ) ; \n,Double - check to avoid exception clicking on stale item \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2261 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ encode \ EncodeActivity . java \n - \n - if ( intent ! = null ) { \n + if ( intent = = null ) { \n + finish ( ) ; \n + } else { \n - if ( action . equals ( Intents . Encode . ACTION ) | | action . equals ( Intent . ACTION _ SEND ) ) { \n + if ( Intents . Encode . ACTION . equals ( action ) | | Intent . ACTION _ SEND . equals ( action ) ) { \n - return ; \n + } else { \n + finish ( ) ; \n - finish ( ) ; \n,Avoid NPE on null action \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2262 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ share \ BookmarkPickerActivity . java \n + import android . util . Log ; \n + \n + private static final String TAG = BookmarkPickerActivity . class . getSimpleName ( ) ; \n + \n - startManagingCursor ( cursor ) ; \n - setListAdapter ( new BookmarkAdapter ( this , cursor ) ) ; \n + if ( cursor = = null ) { \n + Log . w ( TAG , "" No cursor returned for bookmark query "" ) ; \n + finish ( ) ; \n + } else { \n + startManagingCursor ( cursor ) ; \n + setListAdapter ( new BookmarkAdapter ( this , cursor ) ) ; \n + } \n",Avoid NPE in case of strange query failure for bookmarks ; log it and quit \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2263 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ encode \ EncodeActivity . java \n - int encodeNameResource = qrCodeEncoder . isUseVCard ( ) ? R . string . menu _ encode _ mecard : R . string . menu _ encode _ vcard ; \n + boolean useVcard = qrCodeEncoder ! = null & & qrCodeEncoder . isUseVCard ( ) ; \n + int encodeNameResource = useVcard ? R . string . menu _ encode _ mecard : R . string . menu _ encode _ vcard ; \n,Avoid NPE is options menu gets called before onResume ( ? ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2264 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ client \ result \ VCardResultParser . java \n - ( rawText . charAt ( i - 1 ) = = ' = ' | | / / this is a continuation \n - rawText . charAt ( i - 2 ) = = ' = ' ) ) { \n + ( ( i > = 1 & & rawText . charAt ( i - 1 ) = = ' = ' ) | | / / this is a continuation \n + ( i > = 2 & & rawText . charAt ( i - 2 ) = = ' = ' ) ) ) { \n - if ( rawText . charAt ( i - 1 ) = = ' \ r ' ) { \n + if ( i > = 1 & & rawText . charAt ( i - 1 ) = = ' \ r ' ) { \n,Maybe avoid a string index out of bounds exception here ? \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2265 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n - BitMatrix result = writer . encode ( contentsToEncode , format , dimension , dimension , hints ) ; \n + BitMatrix result ; \n + try { \n + result = writer . encode ( contentsToEncode , format , dimension , dimension , hints ) ; \n + } catch ( IllegalArgumentException iae ) { \n + / / Unsupported format \n + return null ; \n + } \n",Don ' t crash on unsupported barcode format like CODE _ 93 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2266 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n + import java . io . ByteArrayOutputStream ; \n - int length = stream . available ( ) ; \n - if ( length < = 0 ) { \n - throw new WriterException ( "" Content stream is empty "" ) ; \n + ByteArrayOutputStream baos = new ByteArrayOutputStream ( ) ; \n + byte [ ] buffer = new byte [ 2048 ] ; \n + int bytesRead ; \n + while ( ( bytesRead = stream . read ( buffer ) ) > 0 ) { \n + baos . write ( buffer , 0 , bytesRead ) ; \n - vcard = new byte [ length ] ; \n - int bytesRead = stream . read ( vcard , 0 , length ) ; \n - if ( bytesRead < length ) { \n - throw new WriterException ( "" Unable to fully read available bytes from content stream "" ) ; \n - } \n - vcardString = new String ( vcard , 0 , bytesRead , "" UTF - 8 "" ) ; \n + vcard = baos . toByteArray ( ) ; \n + vcardString = new String ( vcard , 0 , vcard . length , "" UTF - 8 "" ) ; \n","More reliable method for reading vCard , may avoid OOME in weird stream behavior case \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2267 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiConfigManager . java \n - NetworkType networkType = NetworkType . forIntentValue ( networkTypeString ) ; \n + NetworkType networkType ; \n + try { \n + networkType = NetworkType . forIntentValue ( networkTypeString ) ; \n + } catch ( IllegalArgumentException iae ) { \n + Log . w ( TAG , "" Bad network type ; see NetworkType values : "" + networkTypeString ) ; \n + return ; \n + } \n",Don ' t fail on bad network type input . Log it . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2268 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ BitSource . java \n - * @ throws IllegalArgumentException if numBits isn ' t in [ 1 , 32 ] \n + * @ throws IllegalArgumentException if numBits isn ' t in [ 1 , 32 ] or more than is available \n - if ( numBits < 1 | | numBits > 32 ) { \n - throw new IllegalArgumentException ( ) ; \n + if ( numBits < 1 | | numBits > 32 | | numBits > available ( ) ) { \n + throw new IllegalArgumentException ( String . valueOf ( numBits ) ) ; \n",Check for bad dimension every time to produce more meaningful error \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2269 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n + if ( cameraResolution = = null | | screenResolution = = null ) { \n + / / Called early , before init even finished \n + return null ; \n + } \n",Issue 1254 guess at what may be an NPE in here \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2270 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryActivity . java \n - menu . add ( Menu . NONE , position , position , R . string . history _ clear _ one _ history _ text ) ; \n + if ( position > = adapter . getCount ( ) | | adapter . getItem ( position ) . getResult ( ) ! = null ) { \n + menu . add ( Menu . NONE , position , position , R . string . history _ clear _ one _ history _ text ) ; \n + } / / else it ' s just that dummy "" Empty "" message \n",Issue 1256 Avoid crash clearing Empty message \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2271 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ proguard . cfg \n - dontskipnonpubliclibraryclasses \n - verbose \n + # Added : \n + - useuniqueclassmembernames \n + \n - dontpreverify \n - optimizations ! class / merging / * \n android \ src \ com \ google \ zxing \ client \ android \ share \ ShareActivity . java \n - bundle . putString ( Contents . PHONE _ KEYS [ foundPhone ] , massageContactData ( number ) ) ; \n + if ( number ! = null & & number . length ( ) > 0 ) { \n + bundle . putString ( Contents . PHONE _ KEYS [ foundPhone ] , massageContactData ( number ) ) ; \n + } \n - bundle . putString ( ContactsContract . Intents . Insert . POSTAL , massageContactData ( data ) ) ; \n + if ( data ! = null & & data . length ( ) > 0 ) { \n + bundle . putString ( ContactsContract . Intents . Insert . POSTAL , massageContactData ( data ) ) ; \n + } \n - bundle . putString ( Contents . EMAIL _ KEYS [ foundEmail ] , massageContactData ( email ) ) ; \n + if ( email ! = null & & email . length ( ) > 0 ) { \n + bundle . putString ( Contents . EMAIL _ KEYS [ foundEmail ] , massageContactData ( email ) ) ; \n + } \n",Avoid another possible NPE . Adjust obfuscation to produce less ambiguous mappings \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2272 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ PreviewCallback . java \n - if ( thePreviewHandler ! = null ) { \n + if ( cameraResolution ! = null & & thePreviewHandler ! = null ) { \n - Log . d ( TAG , "" Got preview callback , but no handler for it "" ) ; \n + Log . d ( TAG , "" Got preview callback , but no handler or resolution available "" ) ; \n",Look out for early preview frame before complete configuration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2273 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n + if ( screenResolution = = null ) { \n + / / Called early , before init even finished \n + return null ; \n + } \n",Another protection against early view calls before camera init ( issue 1254 ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2274 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - public void openDriver ( SurfaceHolder holder ) throws IOException { \n + public synchronized void openDriver ( SurfaceHolder holder ) throws IOException { \n - public void closeDriver ( ) { \n + public synchronized void closeDriver ( ) { \n - public void startPreview ( ) { \n + public synchronized void startPreview ( ) { \n - public void stopPreview ( ) { \n + public synchronized void stopPreview ( ) { \n - public void requestPreviewFrame ( Handler handler , int message ) { \n + public synchronized void requestPreviewFrame ( Handler handler , int message ) { \n - public void requestAutoFocus ( Handler handler , int message ) { \n + public synchronized void requestAutoFocus ( Handler handler , int message ) { \n - public Rect getFramingRect ( ) { \n + public synchronized Rect getFramingRect ( ) { \n - public Rect getFramingRectInPreview ( ) { \n + public synchronized Rect getFramingRectInPreview ( ) { \n - public void setManualFramingRect ( int width , int height ) { \n + public synchronized void setManualFramingRect ( int width , int height ) { \n","These state - sensitive methods ought to be synchronized , at least to ensure memory is written back immediately \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2276 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ qrcode \ encoder \ Encoder . java \n - / / Step 2 : Append "" bytes "" into "" dataBits "" in appropriate encoding . \n + \n + / / Step 1 . 5 : Append ECI message if applicable \n + if ( mode = = Mode . BYTE & & ! DEFAULT _ BYTE _ MODE _ ENCODING . equals ( encoding ) ) { \n + CharacterSetECI eci = CharacterSetECI . getCharacterSetECIByName ( encoding ) ; \n + if ( eci ! = null ) { \n + appendECI ( eci , dataBits ) ; \n + } \n + } \n + \n + / / Step 2 : Append "" bytes "" into "" dataBits "" in appropriate encoding . \n + \n - / / Step 4 . 5 : Append ECI message if applicable \n - if ( mode = = Mode . BYTE & & ! DEFAULT _ BYTE _ MODE _ ENCODING . equals ( encoding ) ) { \n - CharacterSetECI eci = CharacterSetECI . getCharacterSetECIByName ( encoding ) ; \n - if ( eci ! = null ) { \n - appendECI ( eci , headerAndDataBits ) ; \n - } \n - } \n - \n",Fix QR code encoder to correctly account for size of ECI segment \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2279 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n + import android . os . Build ; \n + \n + / / Force this on every time for Optimus , since we know it has this problem \n + if ( Build . MODEL . contains ( "" optimus "" ) | | Build . MODEL . contains ( "" Optimus "" ) | | \n + Build . DEVICE . contains ( "" optimus "" ) | | Build . DEVICE . contains ( "" Optimus "" ) ) { \n + if ( ! prefs . getBoolean ( PreferencesActivity . KEY _ FORCE _ PREVIEW _ TO _ SCREEN _ SIZE , false ) ) { \n + SharedPreferences . Editor editor = prefs . edit ( ) ; \n + editor . putBoolean ( PreferencesActivity . KEY _ FORCE _ PREVIEW _ TO _ SCREEN _ SIZE , true ) ; \n + editor . commit ( ) ; \n + } \n + } \n + \n",Force workaround on for Optimus \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2164 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ pdf417 \ decoder \ DecodedBitStreamParser . java \n + if ( result . length ( ) = = 0 ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n,Avoid a false positive on empty PDF 417 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2218 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ detector \ Detector . java \n + int ydimension = computeYDimension ( vertices [ 4 ] , vertices [ 6 ] , vertices [ 5 ] , vertices [ 7 ] , moduleWidth ) ; \n + ydimension = ydimension > dimension ? ydimension : dimension ; \n + \n - BitMatrix bits = sampleGrid ( matrix , vertices [ 4 ] , vertices [ 5 ] , vertices [ 6 ] , vertices [ 7 ] , dimension ) ; \n + BitMatrix bits = sampleGrid ( matrix , vertices [ 4 ] , vertices [ 5 ] , vertices [ 6 ] , vertices [ 7 ] , dimension , ydimension ) ; \n + / * * \n + * Computes the y dimension ( number of modules in a column ) of the PDF417 Code \n + * based on vertices of the codeword area and estimated module size . \n + * \n + * @ param topLeft of codeword area \n + * @ param topRight of codeword area \n + * @ param bottomLeft of codeword area \n + * @ param bottomRight of codeword are \n + * @ param moduleWidth estimated module size \n + * @ return the number of modules in a row . \n + * / \n + private static int computeYDimension ( ResultPoint topLeft , \n + ResultPoint topRight , \n + ResultPoint bottomLeft , \n + ResultPoint bottomRight , \n + float moduleWidth ) { \n + int leftColumnDimension = MathUtils . round ( ResultPoint . distance ( topLeft , bottomLeft ) / moduleWidth ) ; \n + int rightColumnDimension = MathUtils . round ( ResultPoint . distance ( topRight , bottomRight ) / moduleWidth ) ; \n + return ( leftColumnDimension + rightColumnDimension ) > > 1 ; \n + } \n + \n - int dimension ) throws NotFoundException { \n + int xdimension , \n + int ydimension ) throws NotFoundException { \n - dimension , dimension , \n + xdimension , ydimension , \n - dimension , / / p2ToX \n + xdimension , / / p2ToX \n - dimension , / / p3ToX \n - dimension , / / p3ToY \n + xdimension , / / p3ToX \n + ydimension , / / p3ToY \n - dimension , / / p4ToY \n + ydimension , / / p4ToY \n",Issue 1270 better handle tall codes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2295 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fr \ strings . xml \n - < string name = "" history _ empty _ detail "" > Pas de code à barres scanne ont encore été enregistrées < / string > \n + < string name = "" history _ empty _ detail "" > Aucun code - barres scanné a encore été enregistré < / string > \n",Issue 1275 French tweak \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2297 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
actionscript \ core \ src \ com \ google \ zxing \ common \ DefaultGridSampler . as \n - for ( var x : int = 0 ; x < max ; x + = 2 ) { \n + for ( x = 0 ; x < max ; x + = 2 ) { \n actionscript \ core \ src \ com \ google \ zxing \ multi \ qrcode \ detector \ MultiFinderPatternFinder . as \n + import com . google . zxing . ResultPointCallback ; \n - import com . google . zxing . common . ResultPointCallback ; \n,"Issue 1221 / Issue 1276 , fix compile error for AS \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2300 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryManager . java \n + import android . database . sqlite . SQLiteException ; \n + } catch ( SQLiteException sqle ) { \n + / / We ' re seeing an error here when called in CaptureActivity . onCreate ( ) in rare cases \n + / / and don ' t understand it . First theory is that it ' s transient so can be safely ignored . \n + / / TODO revisit this after live in a future version to see if it ' worked ' \n + Log . w ( TAG , sqle ) ; \n + / / continue \n","Work around strange SQLiteException on startup ; first see if it is transient , so swallowing it ' fixes ' it ? \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2168 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"zxingorg \ src \ com \ google \ zxing \ web \ DecodeServlet . java \n + } catch ( IndexOutOfBoundsException ioobe ) { \n + / / sun . net . www . http . ChunkedInputStream . read is throwing this , continue \n zxingorg \ src \ com \ google \ zxing \ web \ DoSFilter . java \n - private static final int MAX _ ACCESSES _ PER _ IP _ PER _ TIME = 10 ; \n - private static final long MAX _ ACCESS _ INTERVAL _ MSEC = 10L * 1000L ; \n - private static final long UNBAN _ INTERVAL _ MSEC = 60L * 60L * 1000L ; \n + private static final int MAX _ ACCESSES _ PER _ IP _ PER _ TIME = 100 ; \n + private static final long MAX _ ACCESS _ INTERVAL _ MSEC = 60L * 1000L ; \n + private static final long UNBAN _ INTERVAL _ MSEC = 15L * 60L * 1000L ; \n zxingorg \ web \ WEB - INF \ web . xml \n - < url - pattern > / * < / url - pattern > \n + < url - pattern > / decode < / url - pattern > \n",Fix problem blocking access to javadoc \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2249 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ ResultParser . java \n - private static void appendKeyValue ( CharSequence keyValue , \n - Map < String , String > result ) { \n + private static void appendKeyValue ( CharSequence keyValue , Map < String , String > result ) { \n + result . put ( key , value ) ; \n + } catch ( IllegalArgumentException iae ) { \n + / / continue ; invalid data such as an escape like % 0t \n - result . put ( key , value ) ; \n",Handle bad key - value pairs in URL by ignoring \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2283 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + if ( cameraManager . isOpen ( ) ) { \n + Log . w ( TAG , "" initCamera ( ) while already open - - late SurfaceView callback ? "" ) ; \n + return ; \n + } \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n + public synchronized boolean isOpen ( ) { \n + return camera ! = null ; \n + } \n + \n - * Convenience method for { @ link com . srowen . bs . android . CaptureActivity } \n + * Convenience method for { @ link com . google . zxing . client . android . CaptureActivity } \n",Defensive change against late callbacks ; not clear it ' s actually any issue \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2303 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
objc \ src \ ZXing \ CGImageLuminanceSource . mm \n - bytesPerRow ) ; \n + newBytesPerRow ) ; \n,Issue 1315 fix crash with crop rectangle \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2370 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - ru \ strings . xml \n - < string name = "" preferences _ auto _ focus _ title "" > Используйте автофокусом < / string > \n + < string name = "" preferences _ auto _ focus _ title "" > Использовать автофокус < / string > \n",Russian fix from Dmitry Parfenov \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2373 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ WifiGenerator . java \n + import com . google . gwt . user . client . ui . CheckBox ; \n + * @ author Sean Owen \n + private final CheckBox hidden = new CheckBox ( ) ; \n - \n + boolean hidden = getHiddenField ( ) ; \n - return getWifiString ( ssid , password , networkType ) ; \n + return getWifiString ( ssid , password , networkType , hidden ) ; \n - private static String getWifiString ( String ssid , String password , String type ) { \n + private static String getWifiString ( String ssid , String password , String type , boolean hidden ) { \n - maybeAppend ( output , "" T : "" , type ) ; \n + if ( type ! = null & & type . length ( ) > 0 & & ! "" nopass "" . equals ( type ) ) { \n + maybeAppend ( output , "" T : "" , type ) ; \n + } \n + if ( hidden ) { \n + maybeAppend ( output , "" H : "" , "" true "" ) ; \n + } \n - if ( value . length ( ) > 0 ) { \n + if ( value ! = null & & value . length ( ) > 0 ) { \n + \n + private boolean getHiddenField ( ) { \n + Boolean value = hidden . getValue ( ) ; \n + return value ! = null & & value ; \n + } \n - table = new Grid ( 8 , 2 ) ; \n + table = new Grid ( 4 , 2 ) ; \n + table . setText ( 3 , 0 , "" Hidden ? "" ) ; \n + table . setWidget ( 3 , 1 , hidden ) ; \n + if ( widget = = hidden ) { \n + getHiddenField ( ) ; \n + } \n",Forgot to add generation of new H : field for hidden SSIDs in generator \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2376 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ FinishListener . java \n - public final class FinishListener \n - implements DialogInterface . OnClickListener , DialogInterface . OnCancelListener , Runnable { \n + public final class FinishListener implements DialogInterface . OnClickListener , DialogInterface . OnCancelListener { \n - @ Override \n - public void run ( ) { \n + private void run ( ) { \n android \ src \ com \ google \ zxing \ client \ android \ camera \ AutoFocusManager . java \n + import android . os . AsyncTask ; \n - import java . util . Timer ; \n - import java . util . TimerTask ; \n - private final Timer timer ; \n - private TimerTask outstandingTask ; \n + private AutoFocusTask outstandingTask ; \n - timer = new Timer ( true ) ; \n - outstandingTask = new TimerTask ( ) { \n - @ Override \n - public void run ( ) { \n - if ( active ) { \n - start ( ) ; \n - } \n - } \n - } ; \n - timer . schedule ( outstandingTask , AUTO _ FOCUS _ INTERVAL _ MS ) ; \n + outstandingTask = new AutoFocusTask ( ) ; \n - outstandingTask . cancel ( ) ; \n + outstandingTask . cancel ( true ) ; \n + private final class AutoFocusTask extends AsyncTask < Void , Void , Void > { \n + @ Override \n + protected Void doInBackground ( Void . . . voids ) { \n + try { \n + Thread . sleep ( AUTO _ FOCUS _ INTERVAL _ MS ) ; \n + } catch ( InterruptedException e ) { \n + / / continue \n + } \n + synchronized ( AutoFocusManager . this ) { \n + if ( active ) { \n + start ( ) ; \n + } \n + } \n + return null ; \n + } \n + } \n + \n",Remove last usages of Runnable / Timer in favor of AsyncTask \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2378 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values \ arrays . xml \n - < array name = "" country _ codes "" > \n + < string - array name = "" country _ codes "" > \n - < / array > \n + < / string - array > \n android \ src \ com \ google \ zxing \ client \ android \ camera \ AutoFocusManager . java \n + outstandingTask . execute ( ) ; \n","Oops , forgot auto - focus trigger ( and one unrelated backport fix ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2379 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"zxing . appspot . com \ war \ scan . html \n + \n + < script type = "" text / javascript "" > \n + < ! - - \n + function getQueryParameter ( name ) { \n + var query ; \n + query = window . location . search . substring ( 1 ) ; \n + if ( query . length < = 0 ) \n + return null ; \n + name = name + "" = "" ; \n + var head ; \n + head = query . indexOf ( name ) ; \n + if ( head < 0 ) \n + return null ; \n + head + = name . length ; \n + var tail ; \n + tail = query . indexOf ( "" & "" , head ) ; \n + if ( tail < 0 ) \n + tail = query . length ; \n + return unescape ( query . substring ( head , tail ) ) ; \n + } \n + function process ( form ) { \n + if ( window . ret = = null ) \n + return false ; \n + var code ; \n + code = form [ ' { CODE } ' ] . value ; \n + if ( code = = null | | code . length = = 0 ) \n + return false ; \n + var url ; \n + url = window . ret . replace ( ' { CODE } ' , encodeURIComponent ( code ) ) ; \n + window . location = url ; \n + return false ; \n + } \n + window . ret = getQueryParameter ( "" ret "" ) ; \n + / / We COULD allow any protocol , but this is a we \n + if ( window . ret ! = null & & window . ret . indexOf ( "" http "" ) = = 0 ) { \n + document . write ( ' < tr > < td valign = "" top "" > < / td > < td valign = "" top "" > ' ) ; \n + document . write ( ' < form onsubmit = "" process ( this ) ; return false "" > ' ) ; \n + document . write ( ' < input type = "" text "" name = "" { CODE } "" size = "" 13 "" / > ' ) ; \n + document . write ( ' < input type = "" submit "" value = "" Enter Manually "" / > ' ) ; \n + document . write ( ' < / form > ' ) ; \n + document . write ( ' < / td > < / tr > ' ) ; \n + } \n + / / - - > \n + < / script > \n + \n",Issue 1286 add prototyping of scan from web page URL \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2309 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ encoder \ PDF417Writer . java \n - BitMatrix output = new BitMatrix ( input . length + 2 * whiteSpace , input [ 0 ] . length + 2 * whiteSpace ) ; \n + BitMatrix output = new BitMatrix ( input [ 0 ] . length + 2 * whiteSpace , input . length + 2 * whiteSpace ) ; \n - for ( int ii = 0 ; ii < input . length ; ii + + ) { \n - for ( int jj = 0 ; jj < input [ 0 ] . length ; jj + + ) { \n + for ( int y = 0 ; y < input . length ; y + + ) { \n + for ( int x = 0 ; x < input [ 0 ] . length ; x + + ) { \n - if ( input [ ii ] [ jj ] = = 1 ) { \n - output . set ( ii + whiteSpace , jj + whiteSpace ) ; \n + if ( input [ y ] [ x ] = = 1 ) { \n + output . set ( x + whiteSpace , y + whiteSpace ) ; \n",Issue 1288 PDF417 barcode flipped \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2310 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ encoder \ PDF417Writer . java \n - for ( int y = 0 ; y < input . length ; y + + ) { \n + for ( int y = 0 , yOutput = output . getHeight ( ) - whiteSpace ; y < input . length ; y + + , yOutput - - ) { \n - output . set ( x + whiteSpace , y + whiteSpace ) ; \n + output . set ( x + whiteSpace , yOutput ) ; \n",Issue 1288 another fix to flip PDF417 over \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2312 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n - private static final int MAX _ PREVIEW _ PIXELS = 800 * 600 ; / / more than large / HD screen \n + private static final int MAX _ PREVIEW _ PIXELS = 960 * 720 ; / / uses full screen resolution on all ' large ' screens \n,Allow selection of larger preview size ; keep max reticle size the same \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2319 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ test \ src \ com \ google \ zxing \ client \ result \ URIParsedResultTestCase . java \n - doTest ( "" HTTP : / / R . BEETAGG . COM / ? 12345 "" , "" http : / / R . BEETAGG . COM / ? 12345 "" , null ) ; \n + doTest ( "" HTTP : / / R . BEETAGG . COM / ? 12345 "" , "" HTTP : / / R . BEETAGG . COM / ? 12345 "" , null ) ; \n - "" btctx : - TC4TO3 $ ZYZTC5NC83 / SYOV + YGUGK : $ BSF0P8 / STNTKTKS . V84 + JSA $ LB + EHCG + 8A725 . 2AZ - NAVX3VBV5K4MH7UL2 . 2M : "" + \n + "" BTCTX : - TC4TO3 $ ZYZTC5NC83 / SYOV + YGUGK : $ BSF0P8 / STNTKTKS . V84 + JSA $ LB + EHCG + 8A725 . 2AZ - NAVX3VBV5K4MH7UL2 . 2M : "" + \n",Forgot one more test change \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2322 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ URIParsedResult . java \n - } else { \n - / / Lowercase protocol to avoid problems \n - uri = uri . substring ( 0 , protocolEnd ) + uri . substring ( protocolEnd ) ; \n",One final simplification \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2323 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ test \ src \ com \ google \ zxing \ BufferedImageLuminanceSource . java \n + int [ ] buffer = new int [ width ] ; \n - for ( int x = left ; x < left + width ; x + + ) { \n - if ( ( image . getRGB ( x , y ) & 0xFF000000 ) = = 0 ) { \n - image . setRGB ( x , y , 0xFFFFFFFF ) ; / / = white \n + image . getRGB ( left , y , width , 1 , buffer , 0 , sourceWidth ) ; \n + boolean rowChanged = false ; \n + for ( int x = 0 ; x < width ; x + + ) { \n + if ( ( buffer [ x ] & 0xFF000000 ) = = 0 ) { \n + buffer [ x ] = 0xFFFFFFFF ; / / = white \n + rowChanged = true ; \n + if ( rowChanged ) { \n + image . setRGB ( left , y , width , 1 , buffer , 0 , sourceWidth ) ; \n + } \n javase \ src \ com \ google \ zxing \ client \ j2se \ BufferedImageLuminanceSource . java \n + int [ ] buffer = new int [ width ] ; \n - for ( int x = left ; x < left + width ; x + + ) { \n - if ( ( image . getRGB ( x , y ) & 0xFF000000 ) = = 0 ) { \n - image . setRGB ( x , y , 0xFFFFFFFF ) ; / / = white \n + image . getRGB ( left , y , width , 1 , buffer , 0 , sourceWidth ) ; \n + boolean rowChanged = false ; \n + for ( int x = 0 ; x < width ; x + + ) { \n + if ( ( buffer [ x ] & 0xFF000000 ) = = 0 ) { \n + buffer [ x ] = 0xFFFFFFFF ; / / = white \n + rowChanged = true ; \n + if ( rowChanged ) { \n + image . setRGB ( left , y , width , 1 , buffer , 0 , sourceWidth ) ; \n + } \n",Issue 1296 Faster check for transparent pixels \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2324 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . properties \n + \n + # Needed for fancy Javadoc generation \n + # java7 . home = / Library / Java / JavaVirtualMachines / 1 . 7 . 0 . jdk / Contents / Home \n build . xml \n - < javadoc failonerror = "" true "" \n + < javadoc executable = "" $ { java7 . home } / bin / javadoc "" \n + failonerror = "" true "" \n + < pathelement location = "" android - integration / src "" / > \n",Add fancy Java 7 javadoc generation \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2325 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - clipboard . setText ( resultHandler . getDisplayContents ( ) ) ; \n + CharSequence text = resultHandler . getDisplayContents ( ) ; \n + if ( text ! = null ) { \n + clipboard . setText ( text ) ; \n + } \n android \ src \ com \ google \ zxing \ client \ android \ ViewfinderView . java \n + if ( cameraManager = = null ) { \n + return ; / / not ready yet , early draw before done configuring \n + } \n",Fix a few possible rare NPEs \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2335 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"javase \ src \ com \ google \ zxing \ client \ j2se \ MatrixToImageWriter . java \n - BufferedImage image = new BufferedImage ( width , height , BufferedImage . TYPE _ INT _ ARGB ) ; \n + BufferedImage image = new BufferedImage ( width , height , BufferedImage . TYPE _ INT _ RGB ) ; \n",Use RGB not ARGB so that ImageIO can write more image formats \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2105 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n - private static final int MAX _ PREVIEW _ PIXELS = 960 * 720 ; / / uses full screen resolution on all ' large ' screens \n + private static final int MAX _ PREVIEW _ PIXELS = 1280 * 720 ; \n,Allow 1280x720 preview but leave reticle same size \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2383 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n - "" continuous - picture "" , / / Camera . Paramters . FOCUS _ MODE _ CONTINUOUS _ PICTURE in 4 . 0 + \n + "" continuous - picture "" , / / Camera . Parameters . FOCUS _ MODE _ CONTINUOUS _ PICTURE in 4 . 0 + \n + "" continuous - video "" , / / Camera . Parameters . FOCUS _ MODE _ CONTINUOUS _ VIDEO in 4 . 0 + \n",Also allow continuous - video mode \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2384 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - if ( connection . getResponseCode ( ) ! = HttpURLConnection . HTTP _ OK ) { \n - throw new IOException ( "" Bad HTTP response : "" + connection . getResponseCode ( ) ) ; \n + int responseCode ; \n + try { \n + responseCode = connection . getResponseCode ( ) ; \n + } catch ( NullPointerException npe ) { \n + / / this is maybe this Android bug : http : / / code . google . com / p / android / issues / detail ? id = 15554 \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + throw new IOException ( npe ) ; \n + } \n + if ( responseCode ! = HttpURLConnection . HTTP _ OK ) { \n + throw new IOException ( "" Bad HTTP response : "" + responseCode ) ; \n",Work around Android NPE observed in the wild \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2451 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"AUTHORS \n + ShumovichY \n core \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedReader . java \n - recordPattern ( row , pattern . getStartEnd ( ) [ 1 ] + 1 , counters ) ; \n + recordPattern ( row , pattern . getStartEnd ( ) [ 1 ] , counters ) ; \n core \ test \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedBlackBox2TestCase . java \n - addTest ( 19 , 23 , 180 . 0f ) ; \n + addTest ( 21 , 23 , 180 . 0f ) ; \n",Issue 1427 fix small off by one in RSS expanded decoder \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2500 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ rss \ AbstractRSSReader . java \n - private static final int MAX _ INDIVIDUAL _ VARIANCE = ( int ) ( PATTERN _ MATCH _ RESULT _ SCALE _ FACTOR * 0 . 4f ) ; \n + private static final int MAX _ INDIVIDUAL _ VARIANCE = ( int ) ( PATTERN _ MATCH _ RESULT _ SCALE _ FACTOR * 0 . 45f ) ; \n core \ test \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedImage2binaryTestCase . java \n + import com . google . zxing . ReaderException ; \n - List < ExpandedPair > pairs = rssExpandedReader . decodeRow2pairs ( rowNumber , row ) ; \n + List < ExpandedPair > pairs ; \n + try { \n + pairs = rssExpandedReader . decodeRow2pairs ( rowNumber , row ) ; \n + } catch ( ReaderException re ) { \n + fail ( re . toString ( ) ) ; \n + return ; \n + } \n core \ test \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedImage2resultTestCase . java \n + import com . google . zxing . ReaderException ; \n - Result theResult = rssExpandedReader . decodeRow ( rowNumber , row , null ) ; \n + Result theResult ; \n + try { \n + theResult = rssExpandedReader . decodeRow ( rowNumber , row , null ) ; \n + } catch ( ReaderException re ) { \n + fail ( re . toString ( ) ) ; \n + return ; \n + } \n core \ test \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedImage2stringTestCase . java \n + import com . google . zxing . ReaderException ; \n - Result result = rssExpandedReader . decodeRow ( rowNumber , row , null ) ; \n + Result result ; \n + try { \n + result = rssExpandedReader . decodeRow ( rowNumber , row , null ) ; \n + } catch ( ReaderException re ) { \n + fail ( re . toString ( ) ) ; \n + return ; \n + } \n",Up RSS character variance tolerance a little and tighten up unit test \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2501 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n + < ! - - TODO replace above two with next line after Android 4 . 2 - - > \n + < ! - - < uses - feature android : name = "" android . hardware . camera . any "" / > - - > \n - < uses - feature android : name = "" android . hardware . touchscreen "" android : required = "" false "" / > \n + < ! - - This excludes Google TV , which is unfortunately included by virtue of not requiring a camera - - > \n + < uses - feature android : name = "" android . hardware . touchscreen "" / > \n + < ! - - TODO make this not required again after android . hardware . camera . any is available - - > \n",Exclude Google TV by requiring touchscreen for now \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2502 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ WifiResultParser . java \n - boolean hidden = Boolean . parseBoolean ( matchSinglePrefixedField ( "" B : "" , rawText , ' ; ' , false ) ) ; \n + boolean hidden = Boolean . parseBoolean ( matchSinglePrefixedField ( "" H : "" , rawText , ' ; ' , false ) ) ; \n",Issue 1455 use H : prefix for hidden \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2543 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . properties \n + # These properties are mostly needed for the top - level javadoc target . android - home is required by \n + # android - integration / , tomcat - home is needed by zxingorg / , GWT - home is needed by zxing . appspot . com / . \n + # If you aren ' t building those targets you need not set anything here . \n + \n",Add comments about variables \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2351 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ pdf417 \ decoder \ DecodedBitStreamParser . java \n + codeIndex - - ; \n,Issue 1312 fix byte mode compaction with early latch to another compaction \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2352 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n - android : targetSdkVersion = "" 7 "" / > \n + android : targetSdkVersion = "" 10 "" / > \n androidtest \ AndroidManifest . xml \n - android : targetSdkVersion = "" 7 "" / > \n + android : targetSdkVersion = "" 10 "" / > \n","As far as I know , should be OK to express that we target 2 . 3 . x but support 2 . 1 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2356 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
android \ src \ com \ google \ zxing \ client \ android \ encode \ EncodeActivity . java \n + if ( intent = = null ) { \n + return false ; \n + } \n - startActivity ( getIntent ( ) ) ; \n + startActivity ( intent ) ; \n,Fix possible strange NPE on EncodeActivity \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2359 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryActivity . java \n + import android . content . ActivityNotFoundException ; \n + import android . util . Log ; \n + private static final String TAG = HistoryActivity . class . getSimpleName ( ) ; \n + \n - startActivity ( intent ) ; \n + try { \n + startActivity ( intent ) ; \n + } catch ( ActivityNotFoundException anfe ) { \n + Log . w ( TAG , anfe . toString ( ) ) ; \n + } \n","Avoid ANFE when nothing can handle a SEND intent , like on an emulator \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2360 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ DecodeHandler . java \n + import android . graphics . Bitmap ; \n + import com . google . zxing . LuminanceSource ; \n + import com . google . zxing . PlanarYUVLuminanceSource ; \n - bundle . putParcelable ( DecodeThread . BARCODE _ BITMAP , source . renderCroppedGreyscaleBitmap ( ) ) ; \n + Bitmap grayscaleBitmap = toBitmap ( source , source . renderCroppedGreyscaleBitmap ( ) ) ; \n + bundle . putParcelable ( DecodeThread . BARCODE _ BITMAP , grayscaleBitmap ) ; \n + private static Bitmap toBitmap ( LuminanceSource source , int [ ] pixels ) { \n + int width = source . getWidth ( ) ; \n + int height = source . getHeight ( ) ; \n + Bitmap bitmap = Bitmap . createBitmap ( width , height , Bitmap . Config . ARGB _ 8888 ) ; \n + bitmap . setPixels ( pixels , 0 , width , 0 , 0 , width , height ) ; \n + return bitmap ; \n + } \n + \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - import com . google . zxing . client . android . PlanarYUVLuminanceSource ; \n + import com . google . zxing . PlanarYUVLuminanceSource ; \n rename from android \ src \ com \ google \ zxing \ client \ android \ PlanarYUVLuminanceSource . java \n rename to core \ src \ com \ google \ zxing \ PlanarYUVLuminanceSource . java \n - package com . google . zxing . client . android ; \n - \n - import com . google . zxing . LuminanceSource ; \n - \n - import android . graphics . Bitmap ; \n + package com . google . zxing ; \n - public Bitmap renderCroppedGreyscaleBitmap ( ) { \n + public int [ ] renderCroppedGreyscaleBitmap ( ) { \n - \n - Bitmap bitmap = Bitmap . createBitmap ( width , height , Bitmap . Config . ARGB _ 8888 ) ; \n - bitmap . setPixels ( pixels , 0 , width , 0 , 0 , width , height ) ; \n - return bitmap ; \n + return pixels ; \n",Refactor PlanarYUVLuminanceSource into core / \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2362 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ share \ BookmarkAdapter . java \n - cursor . moveToPosition ( index ) ; \n - String title = cursor . getString ( BookmarkPickerActivity . TITLE _ COLUMN ) ; \n - ( ( TextView ) layout . findViewById ( R . id . bookmark _ title ) ) . setText ( title ) ; \n - String url = cursor . getString ( BookmarkPickerActivity . URL _ COLUMN ) ; \n - ( ( TextView ) layout . findViewById ( R . id . bookmark _ url ) ) . setText ( url ) ; \n + if ( ! cursor . isClosed ( ) ) { \n + cursor . moveToPosition ( index ) ; \n + String title = cursor . getString ( BookmarkPickerActivity . TITLE _ COLUMN ) ; \n + ( ( TextView ) layout . findViewById ( R . id . bookmark _ title ) ) . setText ( title ) ; \n + String url = cursor . getString ( BookmarkPickerActivity . URL _ COLUMN ) ; \n + ( ( TextView ) layout . findViewById ( R . id . bookmark _ url ) ) . setText ( url ) ; \n + } / / Otherwise . . . just don ' t update as the object is shutting down \n android \ src \ com \ google \ zxing \ client \ android \ share \ BookmarkPickerActivity . java \n - if ( cursor . moveToPosition ( position ) ) { \n + if ( ! cursor . isClosed ( ) & & cursor . moveToPosition ( position ) ) { \n core \ src \ com \ google \ zxing \ client \ result \ VCardResultParser . java \n - while ( ( end = name . indexOf ( ' ; ' , start ) ) > 0 ) { \n + while ( componentIndex < components . length - 1 & & ( end = name . indexOf ( ' ; ' , start ) ) > 0 ) { \n",Fix small corner case errors from crash logs \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2363 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - clipboard . setText ( displayContents ) ; \n + if ( displayContents ! = null ) { \n + clipboard . setText ( displayContents ) ; \n + } \n,Maybe avoid one more NPE \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2364 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > r6 < / version > \n + < version > r7 < / version > \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n - < version > 2 . 8 < / version > \n + < version > 2 . 8 . 1 < / version > \n + < version > 2 . 4 < / version > \n + < version > 2 . 3 . 1 < / version > \n core \ pom . xml \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n - < version > 2 . 8 < / version > \n + < version > 2 . 8 . 1 < / version > \n + < version > 2 . 3 . 1 < / version > \n javase \ pom . xml \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n - < version > 2 . 8 < / version > \n + < version > 2 . 8 . 1 < / version > \n + < version > 2 . 3 . 1 < / version > \n,Update some Maven version stuff \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2306 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ assets \ html - de \ about2d . html \n - < p > Der < strong > Barcode Scanner < / strong > kann auch zweidimensionale Barcodes , wie den QR - Codes und den DataMatrix - Codes einlesen . Die Barcodes in diesem Beispiel enthalten einen Hyperlink auf die Projekt - Homepage von ZXing : < / p > \n + < p > Der < strong > Barcode Scanner < / strong > kann auch zweidimensionale Barcodes , wie den QR - Code und den DataMatrix - Code einlesen . Die Barcodes in diesem Beispiel enthalten einen Hyperlink auf die Projekt - Homepage von ZXing : < / p > \n android \ assets \ html - de \ index . html \n - < p > Die offizielle Android App des Open - Source - Projekts ZXing : < br / > \n + < p > Dies ist die offizielle Android App des Open - Source - Projekts ZXing : < br / > \n - < p > Er liest auch 2D - Barcodes wie den QR - Codes und DataMatrix . Diese Barcodes können z . B . Links zu Webseiten enthalten oder Kontaktinformationen wie Telefonnummern und E - Mail - Adressen und vieles mehr . < / p > \n + < p > Er liest auch 2D - Barcodes wie den QR - Code und DataMatrix . Diese Barcodes können z . B . Links zu Webseiten enthalten oder Kontaktinformationen wie Telefonnummern und E - Mail - Adressen und vieles mehr . < / p > \n",Issue 1398 / Issue 1399 more German updates for docs \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2452 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ QRCodeEncoder . java \n - if ( intent . hasExtra ( Intent . EXTRA _ TEXT ) ) { \n - encodeContentsFromShareIntentPlainText ( intent ) ; \n + if ( intent . hasExtra ( Intent . EXTRA _ STREAM ) ) { \n + encodeFromStreamExtra ( intent ) ; \n - / / Attempt default sharing . \n - encodeContentsFromShareIntentDefault ( intent ) ; \n + encodeFromTextExtras ( intent ) ; \n - private void encodeContentsFromShareIntentPlainText ( Intent intent ) throws WriterException { \n + private void encodeFromTextExtras ( Intent intent ) throws WriterException { \n - / / We only support non - empty and non - blank texts . \n + if ( theContents = = null ) { \n + theContents = ContactEncoder . trim ( intent . getStringExtra ( "" android . intent . extra . HTML _ TEXT "" ) ) ; \n + / / Intent . EXTRA _ HTML _ TEXT \n + if ( theContents = = null ) { \n + theContents = ContactEncoder . trim ( intent . getStringExtra ( Intent . EXTRA _ SUBJECT ) ) ; \n + if ( theContents = = null ) { \n + String [ ] emails = intent . getStringArrayExtra ( Intent . EXTRA _ EMAIL ) ; \n + if ( emails ! = null ) { \n + theContents = ContactEncoder . trim ( emails [ 0 ] ) ; \n + } else { \n + theContents = "" ? "" ; \n + } \n + } \n + } \n + } \n + \n - private void encodeContentsFromShareIntentDefault ( Intent intent ) throws WriterException { \n + private void encodeFromStreamExtra ( Intent intent ) throws WriterException { \n",Fix encoding of certain Intents that don ' t have EXTRA _ TEXT or EXTRA _ STREAM \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2388 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
cpp \ core \ src \ zxing \ common \ GreyscaleRotatedLuminanceSource . cpp \n - int offset = ( left _ * dataWidth _ ) + ( dataWidth _ - ( y + top _ ) ) ; \n + int offset = ( left _ * dataWidth _ ) + ( dataWidth _ - 1 - ( y + top _ ) ) ; \n,Issue 1333 fix off by one when not cropped \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2390 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ aztec \ decoder \ Decoder . java \n - end = true ; \n - end = true ; \n cpp \ core \ src \ zxing \ aztec \ decoder \ Decoder . cpp \n - end = true ; \n - end = true ; \n,Issue 1335 remove dead store \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2391 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ qrcode \ encoder \ Encoder . java \n - / / bits it takes to know version . To pick version size assume length takes maximum bits \n + / / bits it takes to know version . First we take a guess at version by assuming version will be \n + / / the minimum , 1 : \n + \n + int provisionalBitsNeeded = headerBits . getSize ( ) \n + + mode . getCharacterCountBits ( Version . getVersionForNumber ( 1 ) ) \n + + dataBits . getSize ( ) ; \n + Version provisionalVersion = chooseVersion ( provisionalBitsNeeded , ecLevel ) ; \n + \n + / / Use that guess to calculate the right version . I am still not sure this works in 100 % of cases . \n + \n - + mode . getCharacterCountBits ( Version . getVersionForNumber ( 40 ) ) \n + + mode . getCharacterCountBits ( provisionalVersion ) \n + dataBits . getSize ( ) ; \n",Issue 1343 fix border case version selection \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2393 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ layout \ capture . xml \n - android : layout _ height = "" fill _ parent "" \n - android : background = "" @ color / transparent "" / > \n + android : layout _ height = "" fill _ parent "" / > \n",Remove unused transparent viewfinder background which apparently can cause problems on some devices \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2395 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fi \ strings . xml \n - < string name = "" button _ add _ contact "" > Lisää kontakti < / string > \n + < string name = "" button _ add _ contact "" > Lisää yhteystieto < / string > \n - < string name = "" button _ done "" > Tehty < / string > \n + < string name = "" button _ done "" > Valmis < / string > \n - < string name = "" contents _ contact "" > Kontaktin tiedot < / string > \n + < string name = "" contents _ contact "" > Yhteystiedon tiedot < / string > \n - < string name = "" msg _ sbc _ snippet _ unavailable "" > Snippetiä ei saatavilla < / string > \n + < string name = "" msg _ sbc _ snippet _ unavailable "" > Kappaletta ei saatavilla < / string > \n",Issue 1348 Finnish updates \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2396 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"new file \n zxingorg \ restart . sh \n + # ! / bin / bash \n + export CATALINA _ OPTS = "" - server - da - dsa - Xmx80m - XX : + UseCompressedOops "" \n + while : \n + do \n + pkill - KILL java \n + # / usr / local / tomcat / bin / shutdown . sh \n + sleep 5 \n + / usr / local / tomcat / bin / startup . sh \n + sleep 7200 \n + done \n",Add restart script for safekeeping \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2347 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ pdf417 \ decoder \ BitMatrixParser . java \n - / / Usually at least 3 times the module size \n - if ( matchingConsecutiveScans > = moduleWidth * 2 ) { / / MGMG \n + / / It ' s supposed to be > = 3x module width , but , accept anything > = 2x \n + if ( ( matchingConsecutiveScans + 1 ) > = 2 . 0f * moduleWidth ) { \n",Issue 1308 allow PDF417 with row height 2 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2349 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n - < uses - feature android : name = "" android . hardware . camera "" / > \n + < ! - - Don ' t require camera , as this requires a rear camera . This allows it to work on the Nexus 7 - - > \n + < uses - feature android : name = "" android . hardware . camera "" android : required = "" false "" / > \n + < uses - feature android : name = "" android . hardware . camera . front "" android : required = "" false "" / > \n","To support front - camera devices like the Nexus 7 , don ' t require ( rear ) camera \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2398 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ common \ PlatformSupportManager . java \n - * in later versions of the platform . While { @ link Build . VERSION } can be used to determine the device ' s API level \n + * in later versions of the platform . While { @ code Build . VERSION } can be used to determine the device ' s API level \n build . xml \n - < pathelement location = "" $ { android - home } / platforms / android - 15 / android . jar "" / > \n + < pathelement location = "" $ { android - home } / platforms / android - 16 / android . jar "" / > \n",Two javadoc - related typo fixes before release \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2408 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryManager . java \n - String newDetails = oldDetails = = null ? itemDetails : oldDetails + "" : "" + itemDetails ; \n - ContentValues values = new ContentValues ( ) ; \n - values . put ( DBHelper . DETAILS _ COL , newDetails ) ; \n - \n - db . update ( DBHelper . TABLE _ NAME , values , DBHelper . ID _ COL + "" = ? "" , new String [ ] { oldID } ) ; \n + if ( oldID ! = null ) { \n + String newDetails = oldDetails = = null ? itemDetails : oldDetails + "" : "" + itemDetails ; \n + ContentValues values = new ContentValues ( ) ; \n + values . put ( DBHelper . DETAILS _ COL , newDetails ) ; \n + db . update ( DBHelper . TABLE _ NAME , values , DBHelper . ID _ COL + "" = ? "" , new String [ ] { oldID } ) ; \n + } \n",Fix minor NPE on item detail update \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2411 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - beepManager . playBeepSoundAndVibrate ( ) ; \n + / / Then not from history , so beep / vibrate and we have an image to draw on \n + beepManager . playBeepSoundAndVibrate ( ) ; \n",Don ' t beep / vibrate when choosing item from history \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2412 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ TitleRetriever . java \n - if ( title ! = null & & ! title . isEmpty ( ) ) { \n + if ( title ! = null & & title . length ( ) > 0 ) { \n,"Don ' t use String . isEmpty ( ) - - bizarrely , some versions of Android don ' t have this method \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2414 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n + / / Strangely , some Android browsers don ' t seem to register to handle HTTP : / / or HTTPS : / / . \n + / / Lower - case these as it should always be OK to lower - case these schemes . \n + if ( url . startsWith ( "" HTTP : / / "" ) ) { \n + url = "" http "" + url . substring ( 4 ) ; \n + } else if ( url . startsWith ( "" HTTPS : / / "" ) ) { \n + url = "" https "" + url . substring ( 5 ) ; \n + } \n android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ SupplementalInfoRetriever . java \n + / / Strangely , some Android browsers don ' t seem to register to handle HTTP : / / or HTTPS : / / . \n + / / Lower - case these as it should always be OK to lower - case these schemes . \n + if ( linkURL . startsWith ( "" HTTP : / / "" ) ) { \n + linkURL = "" http "" + linkURL . substring ( 4 ) ; \n + } else if ( linkURL . startsWith ( "" HTTPS : / / "" ) ) { \n + linkURL = "" https "" + linkURL . substring ( 5 ) ; \n + } \n",Work around Android browsers that don ' t register to handle HTTP : / / and HTTPS : / / schemes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2415 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - connection . connect ( ) ; \n + try { \n + connection . connect ( ) ; \n + } catch ( NullPointerException npe ) { \n + / / this is an Android bug : http : / / code . google . com / p / android / issues / detail ? id = 16895 \n + throw new IOException ( npe ) ; \n + } \n - connection . connect ( ) ; \n + try { \n + connection . connect ( ) ; \n + } catch ( NullPointerException npe ) { \n + / / this is an Android bug : http : / / code . google . com / p / android / issues / detail ? id = 16895 \n + throw new IOException ( npe ) ; \n + } \n,Work around Android NPE bug in HttpURLConnection . connect ( ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2416 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"cpp \ core \ src \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . cpp \n - int * cValues = new int [ 3 ] ; \n + int cValues [ 3 ] ; \n - int * cValues = new int [ 3 ] ; \n + int cValues [ 3 ] ; \n - int * cValues = new int [ 3 ] ; \n + int cValues [ 3 ] ; \n - void DecodedBitStreamParser : : parseTwoBytes ( int firstByte , int secondByte , int * & result ) { \n + void DecodedBitStreamParser : : parseTwoBytes ( int firstByte , int secondByte , int * result ) { \n cpp \ core \ src \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . h \n - void parseTwoBytes ( int firstByte , int secondByte , int * & result ) ; \n + void parseTwoBytes ( int firstByte , int secondByte , int * result ) ; \n",Issue 1326 DM memory leaks \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2417 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - sk \ strings . xml \n - < string name = "" button _ google _ shopper "" > Shopper < / string > \n + < string name = "" button _ google _ shopper "" > Nakupovanie < / string > \n - < string name = "" history _ empty "" > Prázdny < / string > \n - < string name = "" history _ empty _ detail "" > Žiadny čiarový kód vyšetrení boli zaznamenané < / string > \n + < string name = "" history _ empty "" > Prázdna < / string > \n + < string name = "" history _ empty _ detail "" > Žiadne čiarové kódy neboli zaznamenané < / string > \n - < string name = "" msg _ default _ status "" > Umiestnite čiarový kód vo vnútri obdĺžnika hľadáčiku na skenovanie . < / string > \n + < string name = "" msg _ default _ status "" > Umiestnite čiarový kód do vnútra obdĺžnika hľadáčiku pre skenovanie . < / string > \n - < string name = "" msg _ google _ shopper _ missing "" > Nie je nainštalovaný Google Shopper . < / string > \n - < string name = "" msg _ install _ google _ shopper "" > Google Shopper kombinuje v sebe skenovanie čiarových kódov s miestnymi cenami on - line , recenzie a oveľa viac bez otvorenia prehliadača . Chceli by ste ho vyskúšať ? < / string > \n + < string name = "" msg _ google _ shopper _ missing "" > Nie je nainštalované Google Nakupovanie . < / string > \n + < string name = "" msg _ install _ google _ shopper "" > Google Nakupovanie kombinuje v sebe skenovanie čiarových kódov s miestnymi cenami on - line , recenzie a oveľa viac bez otvorenia prehliadača . Chceli by ste ho vyskúšať ? < / string > \n - < string name = "" preferences _ try _ bsplus "" > Skúste Barcode Scanner + < / string > \n - < string name = "" preferences _ try _ bsplus _ summary "" > Obohatený o nové funkcie a rozhrania < / string > \n + < string name = "" preferences _ try _ bsplus "" > Vyskúšajte Barcode Scanner + < / string > \n + < string name = "" preferences _ try _ bsplus _ summary "" > Rozšírený o nové funkcie a prostredie < / string > \n",Issue 1373 Slovak updates from Laurent \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2418 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ res \ drawable - hdpi \ shopper _ icon . png \n Binary files a / android / res / drawable - hdpi / shopper _ icon . png and b / android / res / drawable - hdpi / shopper _ icon . png differ \n android \ res \ drawable \ shopper _ icon . png \n Binary files a / android / res / drawable / shopper _ icon . png and b / android / res / drawable / shopper _ icon . png differ \n,Update Shopper icon \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2419 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - HttpURLConnection connection = ( HttpURLConnection ) url . openConnection ( ) ; \n + URLConnection conn = url . openConnection ( ) ; \n + if ( ! ( conn instanceof HttpURLConnection ) ) { \n + throw new IOException ( ) ; \n + } \n + HttpURLConnection connection = ( HttpURLConnection ) conn ; \n - HttpURLConnection connection = ( HttpURLConnection ) url . openConnection ( ) ; \n + URLConnection conn = url . openConnection ( ) ; \n + if ( ! ( conn instanceof HttpURLConnection ) ) { \n + throw new IOException ( ) ; \n + } \n + HttpURLConnection connection = ( HttpURLConnection ) conn ; \n,Avoid exception when someone scans a file : / / / URL barcode . And don ' t process it . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2420 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - sk \ strings . xml \n - < string name = "" msg _ google _ books "" > Google Books < / string > \n + < string name = "" msg _ google _ books "" > Google Knihy < / string > \n - < string name = "" msg _ share _ explanation "" > Môžete zdieľať dáta prostredníctvom čiarového kódu zobrazením na displeji a skenovaním s iným telefónom . < / string > \n + < string name = "" msg _ share _ explanation "" > Môžete zdieľať dáta prostredníctvom čiarového kódu zobrazením na displeji a skenovaním s iným zariadením . < / string > \n - < string name = "" preferences _ device _ bug _ workarounds _ title "" > Možno zástupná riešenie chýb zariadení < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Používajte iba štandardné zaostrovanie < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ title "" > Sústavné zameranie < / string > \n + < string name = "" preferences _ device _ bug _ workarounds _ title "" > Možné chyby zariadenia < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Používať iba štandardné zaostrovanie < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ title "" > Nezaostrovať nepretržite < / string > \n - < string name = "" preferences _ result _ title "" > Výsledok nastavenia < / string > \n + < string name = "" preferences _ result _ title "" > Nastavenia výsledku < / string > \n - < string name = "" preferences _ search _ country "" > Vyhľadávanie pre krajinu < / string > \n + < string name = "" preferences _ search _ country "" > Vyhľadávať pre krajinu < / string > \n - < string name = "" preferences _ vibrate _ title "" > Vibrácia < / string > \n + < string name = "" preferences _ vibrate _ title "" > Vibrovať < / string > \n - < string name = "" sbc _ name "" > Google vyhľadávanie kníh < / string > \n + < string name = "" sbc _ name "" > Vyhľadať v Google Knihy < / string > \n - < string name = "" wifi _ changing _ network "" > Požadujúce pripojenie k sieti \ u2026 < / string > \n + < string name = "" wifi _ changing _ network "" > Požiadavka na pripojenie k sieti \ u2026 < / string > \n",Issue 1374 more Slovak updates \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2421 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ proguard - android - optimize . txt \n - - optimizations ! code / simplification / cast , ! field / * , ! class / merging / * \n + - optimizations ! code / simplification / cast , ! code / allocation / * , ! field / * , ! class / merging / * \n - optimizationpasses 5 \n - allowaccessmodification \n - dontpreverify \n",Disable code / allocation optimization in Proguard as it seems to cause a VerifyError on CM10 ( ? ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2422 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n + < pathelement location = "" $ { android - home } / extras / android / compatibility / v4 / android - support - v4 . jar "" / > \n",Add v4 support JAR to javadoc to let it complete without warning \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2424 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
deleted file \n zxingorg \ web \ WEB - INF \ lib \ commons - io - 2 . 1 . jar \n Binary files a / zxingorg / web / WEB - INF / lib / commons - io - 2 . 1 . jar and / dev / null differ \n new file \n zxingorg \ web \ WEB - INF \ lib \ commons - io - 2 . 4 . jar \n Binary files / dev / null and b / zxingorg / web / WEB - INF / lib / commons - io - 2 . 4 . jar differ \n,Update to Commons IO 2 . 4 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2426 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - < target name = "" release "" depends = "" javadoc "" > \n - < zip file = "" ZXing - $ { version } . zip "" > \n - < zipfileset dir = "" . "" prefix = "" zxing - $ { version } "" > \n - < exclude name = "" * * / . * "" / > < ! - - exclude hidden files - - > \n + < target name = "" release "" > \n + < zip file = "" ZXing - $ { version } . zip "" level = "" 9 "" > \n + < zipfileset dir = "" . "" prefix = "" zxing - $ { version } "" followsymlinks = "" false "" > \n + < exclude name = "" * * / . * "" / > \n + < exclude name = "" * * / local . properties "" / > \n + < exclude name = "" android / bin / * * "" / > \n + < exclude name = "" android / libs / * * "" / > \n + < exclude name = "" android - integration / build / * * "" / > \n + < exclude name = "" android - integration / target / * * "" / > \n + < exclude name = "" androidtest / bin / * * "" / > \n + < exclude name = "" androidtest / libs / * * "" / > \n + < exclude name = "" core / build / * * "" / > \n + < exclude name = "" core / target / * * "" / > \n + < exclude name = "" core / test / data / * * "" / > \n + < exclude name = "" javase / build / * * "" / > \n + < exclude name = "" javase / target / * * "" / > \n + < exclude name = "" zxingorg / web / WEB - INF / classes / * * "" / > \n + < / zipfileset > \n + < / zip > \n + < ! - - Separate out test data files now to make download more manageable - - > \n + < zip file = "" ZXing - $ { version } - testdata . zip "" level = "" 9 "" > \n + < zipfileset dir = "" . "" prefix = "" zxing - $ { version } "" followsymlinks = "" false "" > \n + < exclude name = "" * * / . * "" / > \n + < exclude name = "" * * / . svn "" / > \n + < include name = "" core / test / data / * * "" / > \n","Update release target to separate test data , and to exclude build artifacts \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2427 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ result \ CalendarResultHandler . java \n + import android . content . ActivityNotFoundException ; \n + import android . util . Log ; \n + private static final String TAG = CalendarResultHandler . class . getSimpleName ( ) ; \n + \n - launchIntent ( intent ) ; \n + \n + try { \n + / / Do this manually at first \n + rawLaunchIntent ( intent ) ; \n + } catch ( ActivityNotFoundException anfe ) { \n + Log . w ( TAG , "" No calendar app available that responds to "" + Intent . ACTION _ INSERT ) ; \n + / / For calendar apps that don ' t like "" INSERT "" : \n + intent . setAction ( Intent . ACTION _ EDIT ) ; \n + launchIntent ( intent ) ; / / Fail here for real if nothing can handle it \n + } \n android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n - void launchIntent ( Intent intent ) { \n + / * * \n + * Like { @ link # launchIntent ( Intent ) } but will tell you if it is not handle - able \n + * via { @ link ActivityNotFoundException } . \n + * \n + * @ throws ActivityNotFoundException \n + * / \n + void rawLaunchIntent ( Intent intent ) { \n - try { \n - activity . startActivity ( intent ) ; \n - } catch ( ActivityNotFoundException e ) { \n - AlertDialog . Builder builder = new AlertDialog . Builder ( activity ) ; \n - builder . setTitle ( R . string . app _ name ) ; \n - builder . setMessage ( R . string . msg _ intent _ failed ) ; \n - builder . setPositiveButton ( R . string . button _ ok , null ) ; \n - builder . show ( ) ; \n - } \n + activity . startActivity ( intent ) ; \n + } \n + } \n + \n + / * * \n + * Like { @ link # rawLaunchIntent ( Intent ) } but will show a user dialog if nothing is available to handle . \n + * / \n + void launchIntent ( Intent intent ) { \n + try { \n + rawLaunchIntent ( intent ) ; \n + } catch ( ActivityNotFoundException e ) { \n + AlertDialog . Builder builder = new AlertDialog . Builder ( activity ) ; \n + builder . setTitle ( R . string . app _ name ) ; \n + builder . setMessage ( R . string . msg _ intent _ failed ) ; \n + builder . setPositiveButton ( R . string . button _ ok , null ) ; \n + builder . show ( ) ; \n","Try to work around devices whose calendar app only responds to EDIT , not INSERT Intent \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2428 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ AndroidManifest . xml \n - - > \n - android : versionName = "" 4 . 3 "" \n - android : versionCode = "" 86 "" \n + android : versionName = "" 4 . 3 . 1 beta1 "" \n + android : versionCode = "" 87 "" \n android \ proguard - android - optimize . txt \n - keep class com . google . zxing . client . android . camera . open . * * \n - - keep class com . google . zxing . client . android . camera . exposure . * * \n + # - keep class com . google . zxing . client . android . camera . exposure . * * \n - keep class com . google . zxing . client . android . common . executor . * * \n android \ res \ xml \ preferences . xml \n + < ! - - \n + - - > \n android \ src \ com \ google \ zxing \ client \ android \ PreferencesActivity . java \n - public static final String KEY _ DISABLE _ EXPOSURE = "" preferences _ disable _ exposure "" ; \n + / / public static final String KEY _ DISABLE _ EXPOSURE = "" preferences _ disable _ exposure "" ; \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n - import com . google . zxing . client . android . camera . exposure . ExposureInterface ; \n - import com . google . zxing . client . android . camera . exposure . ExposureManager ; \n + / * \n + * / \n","On second though , exposure is just too subtly problematic . Comment it out . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2431 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ AndroidManifest . xml \n - - > \n - android : versionName = "" 4 . 3 . 1 beta1 "" \n + android : versionName = "" 4 . 3 . 1 "" \n - < uses - sdk android : minSdkVersion = "" 7 "" \n - android : targetSdkVersion = "" 10 "" / > \n + < uses - sdk android : minSdkVersion = "" 7 "" android : targetSdkVersion = "" 10 "" / > \n",Update for 4 . 3 . 1 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2433 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n + List < Camera . Size > rawSupportedSizes = parameters . getSupportedPreviewSizes ( ) ; \n + if ( rawSupportedSizes = = null ) { \n + Log . w ( TAG , "" Device returned no supported preview sizes ; using default "" ) ; \n + Camera . Size defaultSize = parameters . getPreviewSize ( ) ; \n + return new Point ( defaultSize . width , defaultSize . height ) ; \n + } \n + \n - List < Camera . Size > supportedPreviewSizes = new ArrayList < Camera . Size > ( parameters . getSupportedPreviewSizes ( ) ) ; \n + List < Camera . Size > supportedPreviewSizes = new ArrayList < Camera . Size > ( rawSupportedSizes ) ; \n",Issue 1377 work around devices that fail to return valid preview sizes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2434 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + } catch ( IllegalArgumentException iae ) { \n + / / Also seen this in the wild , not sure what to make of it . Probably a bad URL \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + throw new IOException ( iae ) ; \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + } catch ( IllegalArgumentException iae ) { \n + / / Also seen this in the wild , not sure what to make of it . Probably a bad URL \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + throw new IOException ( iae ) ; \n",Catch odd IAE from HTTP connection - - bad URI ? \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2437 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ HybridBinarizer . java \n + private static final int MIN _ DYNAMIC _ RANGE = 24 ; \n + / / still looking for good contrast \n + / / short - circuit min / max tests once dynamic range is met \n + if ( max - min > MIN _ DYNAMIC _ RANGE ) { \n + / / finish the rest of the rows quickly \n + for ( yy + + , offset + = width ; yy < BLOCK _ SIZE ; yy + + , offset + = width ) { \n + for ( int xx = 0 ; xx < BLOCK _ SIZE ; xx + + ) { \n + sum + = luminances [ offset + xx ] & 0xFF ; \n + } \n + } \n + } \n - int average = sum > > 6 ; \n - if ( max - min < = 24 ) { \n + int average = sum > > ( BLOCK _ SIZE _ POWER * 2 ) ; \n + if ( max - min < = MIN _ DYNAMIC _ RANGE ) { \n",Port back speedup to C + + from rev 2174 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2176 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - Toast . makeText ( this , R . string . msg _ bulk _ mode _ scanned , Toast . LENGTH _ SHORT ) . show ( ) ; \n + String message = getResources ( ) . getString ( R . string . msg _ bulk _ mode _ scanned ) \n + + "" ( "" + rawResult . getText ( ) + ' ) ' ; \n + Toast . makeText ( this , message , Toast . LENGTH _ SHORT ) . show ( ) ; \n",Show barcode in bulk message toast \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2177 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ Code93Reader . java \n + if ( i > = length - 1 ) { \n + throw FormatException . getFormatInstance ( ) ; \n + } \n zxingorg \ src \ com \ google \ zxing \ web \ DecodeServlet . java \n + import java . net . MalformedURLException ; \n + import java . net . URL ; \n - URI imageURI ; \n + URL imageURL ; \n - imageURI = new URI ( imageURIString ) ; \n + imageURL = new URI ( imageURIString ) . toURL ( ) ; \n + } catch ( MalformedURLException mue ) { \n + if ( log . isLoggable ( Level . FINE ) ) { \n + log . fine ( "" URI was not valid : "" + imageURIString ) ; \n + } \n + response . sendRedirect ( "" badurl . jspx "" ) ; \n + return ; \n + } \n + \n + HttpURLConnection connection ; \n + try { \n + connection = ( HttpURLConnection ) imageURL . openConnection ( ) ; \n + } catch ( IllegalArgumentException iae ) { \n + if ( log . isLoggable ( Level . FINE ) ) { \n + log . fine ( "" URI could not be opened : "" + imageURL ) ; \n + } \n + response . sendRedirect ( "" badurl . jspx "" ) ; \n + return ; \n - HttpURLConnection connection = ( HttpURLConnection ) imageURI . toURL ( ) . openConnection ( ) ; \n - log . info ( "" Decoding "" + imageURI ) ; \n + log . info ( "" Decoding "" + imageURL ) ; \n",Avoid a few more rare exceptions \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2284 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - if ( keyCode = = KeyEvent . KEYCODE _ BACK ) { \n - if ( source = = IntentSource . NATIVE _ APP _ INTENT ) { \n - setResult ( RESULT _ CANCELED ) ; \n - finish ( ) ; \n + switch ( keyCode ) { \n + case KeyEvent . KEYCODE _ BACK : \n + if ( source = = IntentSource . NATIVE _ APP _ INTENT ) { \n + setResult ( RESULT _ CANCELED ) ; \n + finish ( ) ; \n + return true ; \n + } \n + if ( ( source = = IntentSource . NONE | | source = = IntentSource . ZXING _ LINK ) & & lastResult ! = null ) { \n + restartPreviewAfterDelay ( 0L ) ; \n + return true ; \n + } \n + break ; \n + case KeyEvent . KEYCODE _ FOCUS : \n + case KeyEvent . KEYCODE _ CAMERA : \n + / / Handle these events so they don ' t launch the Camera app \n - } else if ( ( source = = IntentSource . NONE | | source = = IntentSource . ZXING _ LINK ) & & lastResult ! = null ) { \n - restartPreviewAfterDelay ( 0L ) ; \n + / / Use volume up / down to turn on light \n + case KeyEvent . KEYCODE _ VOLUME _ DOWN : \n + cameraManager . setTorch ( false ) ; \n + return true ; \n + case KeyEvent . KEYCODE _ VOLUME _ UP : \n + cameraManager . setTorch ( true ) ; \n - } \n - } else if ( keyCode = = KeyEvent . KEYCODE _ FOCUS | | keyCode = = KeyEvent . KEYCODE _ CAMERA ) { \n - / / Handle these events so they don ' t launch the Camera app \n - return true ; \n android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n + / * * \n + * Convenience method for { @ link com . srowen . bs . android . CaptureActivity } \n + * / \n + public synchronized void setTorch ( boolean newSetting ) { \n + if ( camera ! = null ) { \n + if ( autoFocusManager ! = null ) { \n + autoFocusManager . stop ( ) ; \n + } \n + configManager . setTorch ( camera , newSetting ) ; \n + if ( autoFocusManager ! = null ) { \n + autoFocusManager . start ( ) ; \n + } \n + } \n + } \n + \n",Now can turn light on / off with volume buttons \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2286 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraConfigurationManager . java \n + "" continuous - picture "" , / / Camera . Paramters . FOCUS _ MODE _ CONTINUOUS _ PICTURE in 4 . 0 + \n","Let camera use continuous - picture focus mode if available . API - wise it ' s 100 % legal , which means there ' s only a 50 % chance it will break a bunch of ICS devices \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2288 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"core \ src \ com \ google \ zxing \ pdf417 \ encoder \ PDF417Writer . java \n - hints . put ( EncodeHintType . PDF417 _ DIMENSIONS , new Dimensions ( maxCols , minCols , maxRows , minRows ) ) ; \n + hints . put ( EncodeHintType . PDF417 _ DIMENSIONS , new Dimensions ( minCols , maxCols , minRows , maxRows ) ) ; \n",Issue 1263 small fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2290 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fr \ strings . xml \n - < string name = "" history _ empty _ detail "" > Aucun code - barres scanné a encore été enregistré < / string > \n + < string name = "" history _ empty _ detail "" > Aucun code - barres scanné n \ ' a encore été enregistré < / string > \n - < string name = "" menu _ encode _ mecard "" > Utilisez MECARD < / string > \n - < string name = "" menu _ encode _ vcard "" > Utilisez vCard < / string > \n + < string name = "" menu _ encode _ mecard "" > Format MECARD < / string > \n + < string name = "" menu _ encode _ vcard "" > Format vCard < / string > \n - < string name = "" msg _ sure "" > Êtes - vous sûr ? < / string > \n + < string name = "" msg _ sure "" > Êtes - vous sûr ? < / string > \n - < string name = "" preferences _ custom _ product _ search _ summary "" formatted = "" false "" > Remplacements : % s = contenu , % f = le format , % t = type < / string > \n + < string name = "" preferences _ custom _ product _ search _ summary "" formatted = "" false "" > Remplacements : % s = contenu , % f = format , % t = type < / string > \n - < string name = "" preferences _ device _ bug _ workarounds _ title "" > Solutions de contournement de bugs périphériques < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Utilisez uniquement le mode mise au point la norme < / string > \n + < string name = "" preferences _ device _ bug _ workarounds _ title "" > Solutions de contournement de bogues périphériques < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ summary "" > Utiliser uniquement le mode de mise au point standard < / string > \n - < string name = "" preferences _ search _ country "" > Pays Recherche < / string > \n + < string name = "" preferences _ search _ country "" > Pays de recherche < / string > \n - < string name = "" wifi _ changing _ network "" > Demandant de connexion au réseau \ u2026 < / string > \n + < string name = "" wifi _ changing _ network "" > Demande de connexion au réseau \ u2026 < / string > \n",Issue 1330 French fixes from Morgan \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2386 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ common \ BitSource . java \n + / * * \n + * @ return index of next bit in current byte which would be read by the next call to { @ link # readBits ( int ) } . \n + * / \n + public int getBitOffset ( ) { \n + return bitOffset ; \n + } \n + \n core \ src \ com \ google \ zxing \ datamatrix \ decoder \ DecodedBitStreamParser . java \n - boolean unlatch = false ; \n - unlatch = true ; \n - / / If we encounter the unlatch code then continue reading because the Codeword triple \n - / / is padded with 0 ' s \n + / / Read rest of byte , which should be 0 , and stop \n + int bitsLeft = 8 - bits . getBitOffset ( ) ; \n + if ( bitsLeft ! = 8 ) { \n + bits . readBits ( bitsLeft ) ; \n + } \n + return ; \n - if ( ! unlatch ) { \n - if ( ( edifactValue & 0x20 ) = = 0 ) { / / no 1 in the leading ( 6th ) bit \n - edifactValue | = 0x40 ; / / Add a leading 01 to the 6 bit binary value \n - } \n - result . append ( ( char ) edifactValue ) ; \n + if ( ( edifactValue & 0x20 ) = = 0 ) { / / no 1 in the leading ( 6th ) bit \n + edifactValue | = 0x40 ; / / Add a leading 01 to the 6 bit binary value \n + result . append ( ( char ) edifactValue ) ; \n - } while ( ! unlatch & & bits . available ( ) > 0 ) ; \n + } while ( bits . available ( ) > 0 ) ; \n",Issue 1332 fix EDIFACT decoding \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2387 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - historyManager . addHistoryItem ( rawResult , resultHandler ) ; \n - if ( barcode ! = null ) { \n + boolean fromLiveScan = barcode ! = null ; \n + if ( fromLiveScan ) { \n + historyManager . addHistoryItem ( rawResult , resultHandler ) ; \n + \n - if ( prefs . getBoolean ( PreferencesActivity . KEY _ BULK _ MODE , false ) ) { \n + if ( fromLiveScan & & prefs . getBoolean ( PreferencesActivity . KEY _ BULK _ MODE , false ) ) { \n + "" ( "" + rawResult . getText ( ) + ' ) ' ; \n",Issue 1404 show result correctly from history in bulk mode \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2453 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ EAN13Writer . java \n + import com . google . zxing . FormatException ; \n + try { \n + if ( ! UPCEANReader . checkStandardUPCEANChecksum ( contents ) ) { \n + throw new IllegalArgumentException ( "" Contents do not pass checksum "" ) ; \n + } \n + } catch ( FormatException fe ) { \n + throw new IllegalArgumentException ( "" Illegal contents "" ) ; \n + } \n core \ src \ com \ google \ zxing \ oned \ UPCEANReader . java \n - private static boolean checkStandardUPCEANChecksum ( CharSequence s ) throws FormatException { \n + static boolean checkStandardUPCEANChecksum ( CharSequence s ) throws FormatException { \n",Issue 1376 Check EAN13 checksum when encoding \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2454 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ rss \ expanded \ decoders \ FieldParser . java \n - { "" 8110 "" , VARIABLE _ LENGTH , 30 } , \n + { "" 8110 "" , VARIABLE _ LENGTH , 70 } , \n + { "" 8200 "" , VARIABLE _ LENGTH , 70 } , \n",Issue 1432 errata from GS1 spec and support for additional var length product field 8200 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2509 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n + } catch ( NullPointerException npe ) { \n + / / another apparent Android / Harmony bug ; continue \n - switch ( connection . getResponseCode ( ) ) { \n + int responseCode ; \n + try { \n + responseCode = connection . getResponseCode ( ) ; \n + } catch ( NullPointerException npe ) { \n + / / this is maybe this Android bug : http : / / code . google . com / p / android / issues / detail ? id = 15554 \n + Log . w ( TAG , "" Bad URI ? "" + uri ) ; \n + throw new IOException ( npe ) ; \n + } \n + switch ( responseCode ) { \n android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiConfigManager . java \n - if ( password = = null | | password . length ( ) = = 0 ) { \n - throw new IllegalArgumentException ( ) ; \n - } \n - if ( networkType = = NetworkType . WEP ) { \n - changeNetworkWEP ( wifiManager , theWifiResult ) ; \n - } else if ( networkType = = NetworkType . WPA ) { \n - changeNetworkWPA ( wifiManager , theWifiResult ) ; \n + if ( password ! = null & & password . length ( ) ! = 0 ) { \n + if ( networkType = = NetworkType . WEP ) { \n + changeNetworkWEP ( wifiManager , theWifiResult ) ; \n + } else if ( networkType = = NetworkType . WPA ) { \n + changeNetworkWPA ( wifiManager , theWifiResult ) ; \n + } \n",Bandages for misc . exceptions seen in the wild \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2459 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - zh - rTW \ strings . xml \n - < string name = "" button _ get _ directions "" > 取得地址 < / string > \n + < string name = "" button _ get _ directions "" > 路線規劃 < / string > \n - < string name = "" history _ empty _ detail "" > 沒有條碼掃描已記錄 < / string > \n + < string name = "" history _ empty _ detail "" > 沒有條碼掃描記錄 < / string > \n - < string name = "" preferences _ disable _ continuous _ focus _ title "" > 沒有持續關注 < / string > \n + < string name = "" preferences _ disable _ continuous _ focus _ title "" > 無連續對焦 < / string > \n",Issue 1410 Chinese updates \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2462 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivityHandler . java \n + import android . content . pm . PackageManager ; \n + import android . content . pm . ResolveInfo ; \n + import android . provider . Browser ; \n - Intent intent = new Intent ( Intent . ACTION _ VIEW , Uri . parse ( url ) ) ; \n + \n + Intent intent = new Intent ( Intent . ACTION _ VIEW ) ; \n + intent . setData ( Uri . parse ( url ) ) ; \n + \n + ResolveInfo resolveInfo = \n + activity . getPackageManager ( ) . resolveActivity ( intent , PackageManager . MATCH _ DEFAULT _ ONLY ) ; \n + String browserPackageName = null ; \n + if ( resolveInfo . activityInfo ! = null ) { \n + browserPackageName = resolveInfo . activityInfo . packageName ; \n + Log . d ( TAG , "" Using browser in package "" + browserPackageName ) ; \n + } \n + \n + / / Needed for default Android browser only apparently \n + if ( "" com . android . browser "" . equals ( browserPackageName ) ) { \n + intent . setPackage ( browserPackageName ) ; \n + intent . addFlags ( Intent . FLAG _ ACTIVITY _ NEW _ TASK ) ; \n + intent . putExtra ( Browser . EXTRA _ APPLICATION _ ID , browserPackageName ) ; \n + } \n + \n",Issue 1409 try to reuse browser tab on Intent reply \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2464 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
AUTHORS \n + techinstantdx \n,Forgot AUTHORs for last change \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2465 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n - < version > 2 . 1 - SNAPSHOT < / version > \n + < version > 2 . 1 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / url > \n,[ maven - release - plugin ] prepare release core - 2 . 1 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2467 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n - < version > 2 . 1 < / version > \n + < version > 2 . 2 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / core - 2 . 1 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / core < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / core < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / core < / url > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2469 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
javase \ pom . xml \n - < version > 2 . 1 - SNAPSHOT < / version > \n + < version > 2 . 1 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / javase < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / javase < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / javase < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / url > \n - < version > 2 . 1 - SNAPSHOT < / version > \n + < version > 2 . 1 < / version > \n,[ maven - release - plugin ] prepare release javase - 2 . 1 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2470 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
javase \ pom . xml \n - < version > 2 . 1 < / version > \n + < version > 2 . 2 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / javase - 2 . 1 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / javase < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / javase < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / javase < / url > \n - < version > 2 . 1 < / version > \n + < version > 2 . 2 - SNAPSHOT < / version > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2472 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 1 - SNAPSHOT < / version > \n + < version > 2 . 1 < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / android - integration < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / android - integration < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / trunk / android - integration < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / url > \n,[ maven - release - plugin ] prepare release android - integration - 2 . 1 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2473 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 1 < / version > \n + < version > 2 . 2 - SNAPSHOT < / version > \n - < connection > scm : svn : http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / connection > \n - < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / developerConnection > \n - < url > http : / / zxing . googlecode . com / svn / tags / android - integration - 2 . 1 < / url > \n + < connection > scm : svn : http : / / zxing . googlecode . com / svn / trunk / android - integration < / connection > \n + < developerConnection > scm : svn : https : / / zxing . googlecode . com / svn / trunk / android - integration < / developerConnection > \n + < url > http : / / zxing . googlecode . com / svn / trunk / android - integration < / url > \n,[ maven - release - plugin ] prepare for next development iteration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2475 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"CHANGES \n - cpp / , objc / and iphone / have received many ports of fixes and other functionality from Java , and changes to work with more recent iOS \n - bug / , rim / , and javame / have been removed \n - Many , many small bug fixes and optimizations , mostly to core / and android / \n + \n + 2 . 1 ( 22 Oct 2012 ) \n + \n + - Many small fixes to handling of QR code data formats , like exotic URLs , and contact info \n + - Many small fixes to decoding and detection common barcode formats , like PDF417 , Aztec . Small improvements \n + too like partial error correction for PDF417 \n + - Many small updates to the Android app , Barcode Scanner , including rare bug fixes and translation updates . \n + The 2 . 1 release corresponds substantially to v4 . 3 . 1 . \n + - Many ports of Java updates to C + + port \n",Forgot to list what ' s new in CHANGES \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2476 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 4 . 0 . 1 . 2 < / version > \n + < version > 4 . 1 . 1 . 4 < / version > \n - < version > 2 . 4 < / version > \n + < version > 2 . 5 . 1 < / version > \n - < version > 2 . 1 . 2 < / version > \n + < version > 2 . 2 . 1 < / version > \n - < version > 2 . 8 . 1 < / version > \n + < version > 2 . 9 < / version > \n - < version > 2 . 3 . 1 < / version > \n + < version > 2 . 3 . 2 < / version > \n build . properties \n - version = 2 . 1 \n + version = 2 . 2 \n core \ pom . xml \n - < version > 2 . 4 < / version > \n + < version > 2 . 5 . 1 < / version > \n - < version > 2 . 1 . 2 < / version > \n + < version > 2 . 2 . 1 < / version > \n - < version > 2 . 8 . 1 < / version > \n + < version > 2 . 9 < / version > \n - < version > 2 . 3 . 1 < / version > \n + < version > 2 . 3 . 2 < / version > \n javase \ pom . xml \n - < version > 2 . 4 < / version > \n + < version > 2 . 5 . 1 < / version > \n - < version > 2 . 1 . 2 < / version > \n + < version > 2 . 2 . 1 < / version > \n - < version > 2 . 8 . 1 < / version > \n + < version > 2 . 9 < / version > \n - < version > 2 . 3 . 1 < / version > \n + < version > 2 . 3 . 2 < / version > \n,Update Maven config and advance to v2 . 2 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2477 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ build . xml \n - < pathelement location = "" lib / junit - 4 . 8 . 2 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n - < pathelement location = "" lib / junit - 4 . 8 . 2 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n - < pathelement location = "" lib / junit - 4 . 8 . 2 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n rename from core \ lib \ junit - 4 . 8 . 2 . jar \n rename to core \ lib \ junit - 4 . 10 . jar \n Binary files a / core / lib / junit - 4 . 8 . 2 . jar and b / core / lib / junit - 4 . 10 . jar differ \n",Update to Junit 4 . 10 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2478 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivityHandler . java \n - / / Needed for default Android browser only apparently \n - if ( "" com . android . browser "" . equals ( browserPackageName ) ) { \n + / / Needed for default Android browser / Chrome only apparently \n + if ( "" com . android . browser "" . equals ( browserPackageName ) | | "" com . android . chrome "" . equals ( browserPackageName ) ) { \n",Issue 1409 also include Chrome in code to reuse browser tab \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2479 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n - throw new IOException ( iae ) ; \n + throw new IOException ( iae . toString ( ) ) ; \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n - throw new IOException ( iae ) ; \n + throw new IOException ( iae . toString ( ) ) ; \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n,"Strangely , Exception constructors that take a chained Exception didn ' t exist before API level 9 ( though have always been in Java ) . Don ' t use them to avoid NoSuchMethodError on Froyo and earlier . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2481 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ camera \ CameraManager . java \n - camera . autoFocus ( autoFocusCallback ) ; \n + try { \n + camera . autoFocus ( autoFocusCallback ) ; \n + } catch ( RuntimeException re ) { \n + / / Have heard RuntimeException reported in Android 4 . 0 . x + ; continue ? \n + Log . w ( TAG , "" Unexpected exception while focusing "" , re ) ; \n + } \n",Catch strange RuntimeExceptino from inside autoFocus ( ) in Android 4 . 0 . x + \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2107 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - "" SCN . BY "" , "" su . pr "" , "" t . co "" , "" tinyurl . com "" , "" tr . im "" \n + "" R . BEETAGG . COM "" , "" r . beetagg . com "" , "" SCN . BY "" , "" su . pr "" , "" t . co "" , "" tinyurl . com "" , "" tr . im "" \n core \ src \ com \ google \ zxing \ client \ result \ URIResultParser . java \n - "" [ a - zA - Z0 - 9 \ \ - ] { 2 , } ( \ \ . [ a - zA - Z0 - 9 \ \ - ] { 2 , } ) * "" + / / host name elements \n + "" [ a - zA - Z0 - 9 \ \ - ] + ( \ \ . [ a - zA - Z0 - 9 \ \ - ] + ) * "" + / / host name elements \n - "" [ a - zA - Z0 - 9 \ \ - ] { 2 , } ( \ \ . [ a - zA - Z0 - 9 \ \ - ] { 2 , } ) + "" + / / host name elements \n + "" ( [ a - zA - Z0 - 9 \ \ - ] + \ \ . ) + [ a - zA - Z0 - 9 \ \ - ] { 2 , } "" + / / host name elements \n core \ test \ src \ com \ google \ zxing \ client \ result \ URIParsedResultTestCase . java \n + doTest ( "" HTTP : / / R . BEETAGG . COM / ? 12345 "" , "" http : / / R . BEETAGG . COM / ? 12345 "" , null ) ; \n",Fix slight problem in heuristic for detecting URIs : accept a . singleletterdomainelement . com \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2108 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ Code128Reader . java \n - throw ChecksumException . getChecksumInstance ( ) ; \n + throw NotFoundException . getNotFoundInstance ( ) ; \n core \ src \ com \ google \ zxing \ oned \ Code39Reader . java \n - if ( result . length ( ) < 4 ) { \n - / / Almost surely a false positive \n + if ( result . length ( ) = = 0 ) { \n + / / false positive \n core \ src \ com \ google \ zxing \ oned \ Code93Reader . java \n - if ( result . length ( ) < 4 ) { \n - / / Almost surely a false positive \n + if ( result . length ( ) < 2 ) { \n + / / false positive - - need at least 2 checksum digits \n,Issue 1122 allow short code 39 / 93 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2114 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ client \ result \ URIResultParser . java \n - "" [ a - zA - Z0 - 9 ] { 2 , } : / / "" + / / protocol \n + "" [ a - zA - Z0 - 9 ] { 2 , } : ( / ) * "" + / / protocol \n core \ test \ src \ com \ google \ zxing \ client \ result \ URIParsedResultTestCase . java \n + @ Test \n + public void testExotic ( ) { \n + doTest ( "" bitcoin : mySD89iqpmptrK3PhHFW9fa7BXiP7ANy3Y "" , "" bitcoin : mySD89iqpmptrK3PhHFW9fa7BXiP7ANy3Y "" , null ) ; \n + } \n + \n",Issue 1157 support protocols ending with : not : / / like bitcoin \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2178 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - ru \ strings . xml \n - < string name = "" history _ empty "" > Пустой < / string > \n - < string name = "" history _ empty _ detail "" > Нет штрих - код сканирования были записаны < / string > \n + < string name = "" history _ empty "" > Пусто < / string > \n + < string name = "" history _ empty _ detail "" > Нет сохраненных штрих - кодов < / string > \n",Small Russian translation fix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2223 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ CodaBarReader . java \n + import java . util . Arrays ; \n + Arrays . fill ( counters , 0 ) ; \n core \ src \ com \ google \ zxing \ oned \ Code39Reader . java \n + private final StringBuilder decodeRowResult ; \n + private final int [ ] counters ; \n - usingCheckDigit = false ; \n - extendedMode = false ; \n + this ( false ) ; \n - this . usingCheckDigit = usingCheckDigit ; \n - this . extendedMode = false ; \n + this ( usingCheckDigit , false ) ; \n + decodeRowResult = new StringBuilder ( 20 ) ; \n + counters = new int [ 9 ] ; \n - int [ ] counters = new int [ 9 ] ; \n + Arrays . fill ( counters , 0 ) ; \n + decodeRowResult . setLength ( 0 ) ; \n + \n - StringBuilder result = new StringBuilder ( 20 ) ; \n - result . append ( decodedChar ) ; \n + decodeRowResult . append ( decodedChar ) ; \n - result . setLength ( result . length ( ) - 1 ) ; / / remove asterisk \n + decodeRowResult . setLength ( decodeRowResult . length ( ) - 1 ) ; / / remove asterisk \n - int max = result . length ( ) - 1 ; \n + int max = decodeRowResult . length ( ) - 1 ; \n - total + = ALPHABET _ STRING . indexOf ( result . charAt ( i ) ) ; \n + total + = ALPHABET _ STRING . indexOf ( decodeRowResult . charAt ( i ) ) ; \n - if ( result . charAt ( max ) ! = ALPHABET [ total % 43 ] ) { \n + if ( decodeRowResult . charAt ( max ) ! = ALPHABET [ total % 43 ] ) { \n - result . setLength ( max ) ; \n + decodeRowResult . setLength ( max ) ; \n - if ( result . length ( ) = = 0 ) { \n + if ( decodeRowResult . length ( ) = = 0 ) { \n - resultString = decodeExtended ( result ) ; \n + resultString = decodeExtended ( decodeRowResult ) ; \n - resultString = result . toString ( ) ; \n + resultString = decodeRowResult . toString ( ) ; \n - / / Should not be needed , but appears to work around a Java 7 JIT bug ? This comes in corrupted \n - Arrays . fill ( counters , 0 ) ; \n - \n core \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedReader . java \n - / / start from the begining \n - removePartialRows ( pairs , rows ) ; \n",A few more small optimizations \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2516 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android - integration \ build . xml \n - < pathelement location = "" $ { android - home } / platforms / android - 13 / android . jar "" / > \n + < pathelement location = "" $ { android - home } / platforms / android - 17 / android . jar "" / > \n - < pathelement location = "" $ { android - home } / platforms / android - 10 / android . jar "" / > \n + < pathelement location = "" $ { android - home } / platforms / android - 17 / android . jar "" / > \n android \ project . properties \n - target = android - 15 \n + target = android - 17 \n androidtest \ project . properties \n - target = android - 15 \n + target = android - 17 \n",Use Android 4 . 2 SDK consitently ; don ' t target it for apps though \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2518 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ multi \ GenericMultipleBarcodeReader . java \n - if ( alreadyFound ) { \n - return ; \n + if ( ! alreadyFound ) { \n + results . add ( translateResultPoints ( result , xOffset , yOffset ) ) ; \n - results . add ( translateResultPoints ( result , xOffset , yOffset ) ) ; \n",Continue recursion even if finding a duplicate of a prior barcode \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2519 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryManager . java \n - private static final int MAX _ ITEMS = 500 ; \n + private static final int MAX _ ITEMS = 2000 ; \n - db . delete ( DBHelper . TABLE _ NAME , DBHelper . ID _ COL + ' = ' + cursor . getString ( 0 ) , null ) ; \n + String id = cursor . getString ( 0 ) ; \n + Log . i ( TAG , "" Deleting scan history ID "" + id ) ; \n + db . delete ( DBHelper . TABLE _ NAME , DBHelper . ID _ COL + ' = ' + id , null ) ; \n",Raise history limit to 2000 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2520 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ pom . xml \n + < dependencies > \n + < dependency > \n + < groupId > junit < / groupId > \n + < artifactId > junit < / artifactId > \n + < version > 4 . 10 < / version > \n + < scope > test < / scope > \n + < / dependency > \n + < / dependencies > \n + < testSourceDirectory > test / src < / testSourceDirectory > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - surefire - plugin < / artifactId > \n + < version > 2 . 12 . 4 < / version > \n + < configuration > \n + < ! - - < parallel > classes < / parallel > - - > \n + < systemPropertyVariables > \n + < explicitLuminanceConversion > true < / explicitLuminanceConversion > \n + < / systemPropertyVariables > \n + < / configuration > \n + < / plugin > \n - < / project > \n + < / project > \n + \n,Add test config to pom . xml \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2522 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ ProductResultInfoRetriever . java \n + / * * \n + * < p > Retrieves product information from Google Product search . < / p > \n + * \n + * < p > < strong > Please do not reuse this code . < / strong > Using results in this way requires permission \n + * from Google , and that is not granted to users via this project . < / p > \n + * \n + * @ author Sean Owen \n + * / \n",Warn about using Google product results \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2523 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ result \ WifiResultHandler . java \n + import android . app . Activity ; \n - Toast . makeText ( getActivity ( ) , R . string . wifi _ changing _ network , Toast . LENGTH _ LONG ) . show ( ) ; \n + final Activity activity = getActivity ( ) ; \n + activity . runOnUiThread ( new Runnable ( ) { \n + @ Override \n + public void run ( ) { \n + Toast . makeText ( activity . getApplicationContext ( ) , R . string . wifi _ changing _ network , Toast . LENGTH _ SHORT ) . show ( ) ; \n + } \n + } ) ; \n",Avoid Toast that won ' t go away by posting on UI thread \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2524 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + "" ( "" + rawResult . getText ( ) + ' ) ' ; \n - Toast . makeText ( this , message , Toast . LENGTH _ SHORT ) . show ( ) ; \n + Toast . makeText ( getApplicationContext ( ) , message , Toast . LENGTH _ SHORT ) . show ( ) ; \n",Also use application context with Toast consistently \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2525 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ common \ PlatformSupportManager . java \n - protected void addImplementationClass ( int minVersion , String className ) { \n + protected final void addImplementationClass ( int minVersion , String className ) { \n - public T build ( ) { \n + public final T build ( ) { \n android \ src \ com \ google \ zxing \ client \ android \ history \ HistoryManager . java \n - / / TODO revisit this after live in a future version to see if it ' worked ' \n android \ src \ com \ google \ zxing \ client \ android \ result \ ResultHandler . java \n - public ParsedResult getResult ( ) { \n + public final ParsedResult getResult ( ) { \n - boolean hasCustomProductSearch ( ) { \n + final boolean hasCustomProductSearch ( ) { \n - Activity getActivity ( ) { \n + final Activity getActivity ( ) { \n - void showGoogleShopperButton ( View . OnClickListener listener ) { \n + final void showGoogleShopperButton ( View . OnClickListener listener ) { \n - void rawLaunchIntent ( Intent intent ) { \n + final void rawLaunchIntent ( Intent intent ) { \n - void launchIntent ( Intent intent ) { \n + final void launchIntent ( Intent intent ) { \n - String fillInCustomSearchURL ( String text ) { \n + final String fillInCustomSearchURL ( String text ) { \n android \ src \ com \ google \ zxing \ client \ android \ result \ supplement \ SupplementalInfoRetriever . java \n - protected void onPostExecute ( Object arg ) { \n + protected final void onPostExecute ( Object arg ) { \n android \ src \ com \ google \ zxing \ client \ android \ share \ LoadPackagesAsyncTask . java \n - private static class ByFirstStringComparator implements Comparator < String [ ] > , Serializable { \n + private static final class ByFirstStringComparator implements Comparator < String [ ] > , Serializable { \n",Changes from code inspection \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2526 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ AmbientLightManager . java \n + this . cameraManager = cameraManager ; \n - this . cameraManager = cameraManager ; \n - if ( ambientLightLux < = TOO _ DARK _ LUX ) { \n - cameraManager . setTorch ( true ) ; \n - } else if ( ambientLightLux > = BRIGHT _ ENOUGH _ LUX ) { \n - cameraManager . setTorch ( false ) ; \n + if ( cameraManager ! = null ) { \n + if ( ambientLightLux < = TOO _ DARK _ LUX ) { \n + cameraManager . setTorch ( true ) ; \n + } else if ( ambientLightLux > = BRIGHT _ ENOUGH _ LUX ) { \n + cameraManager . setTorch ( false ) ; \n + } \n,Avoid possible NPE from early callback \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2528 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n - < version > 2 . 5 . 1 < / version > \n + < version > 3 . 0 < / version > \n core \ pom . xml \n - < version > 2 . 5 . 1 < / version > \n + < version > 3 . 0 < / version > \n javase \ pom . xml \n - < version > 2 . 5 . 1 < / version > \n + < version > 3 . 0 < / version > \n,MVN plugin version update \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2529 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n + < optional > true < / optional > \n,Should make android - v4 dependency optional since not every dependent project needs it \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2530 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n + } catch ( SecurityException se ) { \n + / / due to bad VPN settings ? \n + Log . w ( TAG , "" Restricted URI ? "" + uri ) ; \n + throw new IOException ( se ) ; \n",Catch rare SecurityException when accessing HTTP \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2532 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ build . xml \n - < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 11 . jar "" / > \n - < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 11 . jar "" / > \n - < pathelement location = "" lib / junit - 4 . 10 . jar "" / > \n + < pathelement location = "" lib / junit - 4 . 11 . jar "" / > \n deleted file \n core \ lib \ junit - 4 . 10 . jar \n Binary files a / core / lib / junit - 4 . 10 . jar and / dev / null differ \n new file \n core \ lib \ junit - 4 . 11 . jar \n Binary files / dev / null and b / core / lib / junit - 4 . 11 . jar differ \n core \ pom . xml \n - < version > 4 . 10 < / version > \n + < version > 4 . 11 < / version > \n",Update to JUnit 4 . 11 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2534 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ AmbientLightManager . java \n - private static final float TOO _ DARK _ LUX = 90 . 0f ; \n - private static final float BRIGHT _ ENOUGH _ LUX = 225 . 0f ; \n + private static final float TOO _ DARK _ LUX = 45 . 0f ; \n + private static final float BRIGHT _ ENOUGH _ LUX = 450 . 0f ; \n,Make light thresholds less sensitive to avoid rapid on / off on some devices \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2538 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - clipboard . setText ( displayContents ) ; \n + try { \n + clipboard . setText ( displayContents ) ; \n + } catch ( NullPointerException npe ) { \n + / / Some kind of bug inside the clipboard implementation , not due to null input \n + Log . w ( TAG , "" Clipboard bug "" , npe ) ; \n + } \n",Work around a weird NPE inside the clipboard library \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2539 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"build . xml \n - < pathelement location = "" $ { android - home } / platforms / android - 16 / android . jar "" / > \n + < pathelement location = "" $ { android - home } / platforms / android - 17 / android . jar "" / > \n",Use Android 4 . 2 libs for javadoc \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2541 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ test \ src \ com \ google \ zxing \ client \ result \ ParsedReaderResultTestCase . java \n - doTestResult ( "" BEGIN : VEVENT "" , "" BEGIN : VEVENT "" , ParsedResultType . TEXT ) ; \n",Cancel one old test case \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2180 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ share \ AppPickerActivity . java \n - import android . os . Bundle ; \n + import android . os . AsyncTask ; \n + private LoadPackagesAsyncTask backgroundTask ; \n - protected void onCreate ( Bundle icicle ) { \n - super . onCreate ( icicle ) ; \n - if ( labelsPackages . isEmpty ( ) ) { \n - new LoadPackagesAsyncTask ( this ) . execute ( labelsPackages ) ; \n + protected void onResume ( ) { \n + super . onResume ( ) ; \n + labelsPackages . clear ( ) ; \n + backgroundTask = new LoadPackagesAsyncTask ( this ) ; \n + backgroundTask . execute ( labelsPackages ) ; \n + } \n + \n + @ Override \n + protected void onPause ( ) { \n + if ( backgroundTask . getStatus ( ) ! = AsyncTask . Status . FINISHED ) { \n + backgroundTask . cancel ( true ) ; \n - / / Otherwise use last copy we loaded - - apps don ' t change much , and it takes \n - / / forever to load for some reason . \n + backgroundTask = null ; \n + super . onPause ( ) ; \n",Fix error in AppPickerActivity when it is quickly cancelled ( hat tip to Asus ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2252 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ camera \ AutoFocusManager . java \n + import java . util . ArrayList ; \n + import java . util . Collection ; \n + private static final Collection < String > FOCUS _ MODES _ CALLING _ AF ; \n + static { \n + FOCUS _ MODES _ CALLING _ AF = new ArrayList < String > ( 2 ) ; \n + FOCUS _ MODES _ CALLING _ AF . add ( Camera . Parameters . FOCUS _ MODE _ AUTO ) ; \n + FOCUS _ MODES _ CALLING _ AF . add ( Camera . Parameters . FOCUS _ MODE _ MACRO ) ; \n + } \n - Camera . Parameters . FOCUS _ MODE _ AUTO . equals ( currentFocusMode ) ; \n + FOCUS _ MODES _ CALLING _ AF . contains ( currentFocusMode ) ; \n,Issue 1261 autoFocus ( ) on macro mode too \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2291 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
build . properties \n - # Set to the location where ProGuard ' s proguard . jar file can be found . \n - # proguard - jar = / usr / local / android - sdk / tools / proguard / lib / proguard . jar \n - \n,Remove proguard - jar as it is no longer needed by any modules now that Android integrations Proguard . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2350 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ res \ values - fr \ strings . xml \n - < string name = "" preferences _ try _ bsplus _ summary "" > Amélioré avec de nouvelles fonctionnalités et de l & # 39 ; interface < / string > \n + < string name = "" preferences _ try _ bsplus _ summary "" > Amélioré avec de nouvelles fonctionnalités et de l \ ' interface < / string > \n",Fix apostrophe type \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2403 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ assets \ images \ contact - results - screen . jpg \n Binary files a / android / assets / images / contact - results - screen . jpg and b / android / assets / images / contact - results - screen . jpg differ \n android \ assets \ images \ search - book - contents . jpg \n Binary files a / android / assets / images / search - book - contents . jpg and b / android / assets / images / search - book - contents . jpg differ \n,Freshen screen shots in help screens \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2404 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n + long resultDurationMS ; \n + if ( getIntent ( ) = = null ) { \n + resultDurationMS = DEFAULT _ INTENT _ RESULT _ DURATION _ MS ; \n + } else { \n + resultDurationMS = getIntent ( ) . getLongExtra ( Intents . Scan . RESULT _ DISPLAY _ DURATION _ MS , \n + DEFAULT _ INTENT _ RESULT _ DURATION _ MS ) ; \n + } \n + \n - statusView . setText ( getString ( resultHandler . getDisplayTitle ( ) ) ) ; \n + if ( resultDurationMS > 0 ) { \n + statusView . setText ( getString ( resultHandler . getDisplayTitle ( ) ) ) ; \n + } \n - sendReplyMessage ( R . id . return _ scan _ result , intent ) ; \n + sendReplyMessage ( R . id . return _ scan _ result , intent , resultDurationMS ) ; \n - sendReplyMessage ( R . id . launch _ product _ query , replyURL ) ; \n + sendReplyMessage ( R . id . launch _ product _ query , replyURL , resultDurationMS ) ; \n - sendReplyMessage ( R . id . launch _ product _ query , replyURL ) ; \n + sendReplyMessage ( R . id . launch _ product _ query , replyURL , resultDurationMS ) ; \n - private void sendReplyMessage ( int id , Object arg ) { \n + private void sendReplyMessage ( int id , Object arg , long delayMS ) { \n - long resultDurationMS = getIntent ( ) . getLongExtra ( Intents . Scan . RESULT _ DISPLAY _ DURATION _ MS , \n - DEFAULT _ INTENT _ RESULT _ DURATION _ MS ) ; \n - if ( resultDurationMS > 0L ) { \n - handler . sendMessageDelayed ( message , resultDurationMS ) ; \n + if ( delayMS > 0L ) { \n + handler . sendMessageDelayed ( message , delayMS ) ; \n",Suppress status message on Intent scan if result duration is requested to be 0 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2406 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
AUTHORS \n + Ian W . Davis \n,Issue 538 credit Ian Davis for much of the RSS Expanded Stacked changes \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2511 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
core \ src \ com \ google \ zxing \ oned \ rss \ expanded \ RSSExpandedReader . java \n + / / Sanity check : element width for pattern and the character should match \n + float expectedElementWidth = ( pattern . getStartEnd ( ) [ 1 ] - pattern . getStartEnd ( ) [ 0 ] ) / 15 . 0f ; \n + if ( Math . abs ( elementWidth - expectedElementWidth ) / expectedElementWidth > 0 . 3f ) { \n + throw NotFoundException . getNotFoundInstance ( ) ; \n + } \n + \n + if ( value < 0 . 3f ) { \n + throw NotFoundException . getNotFoundInstance ( ) ; \n + } \n + if ( value > 8 . 7f ) { \n + throw NotFoundException . getNotFoundInstance ( ) ; \n + } \n,Issue 1434 more sanity checks for RSS expanded \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2512 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ DecodeFormatManager . java \n - BarcodeFormat . RSS _ 14 ) ; \n + BarcodeFormat . RSS _ 14 , \n + BarcodeFormat . RSS _ EXPANDED ) ; \n",Enable RSS expanded \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2513 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ oned \ CodaBarReader . java \n - / / First element is for bars , second is for spaces . \n - int [ ] maxes = { 0 , 0 } ; \n - int [ ] mins = { Integer . MAX _ VALUE , Integer . MAX _ VALUE } ; \n - int [ ] thresholds = { 0 , 0 } ; \n - for ( int i = 0 ; i < 2 ; i + + ) { \n - for ( int j = position + i ; j < end ; j + = 2 ) { \n - if ( counters [ j ] < mins [ i ] ) { \n - mins [ i ] = counters [ j ] ; \n - } \n - if ( counters [ j ] > maxes [ i ] ) { \n - maxes [ i ] = counters [ j ] ; \n - } \n + int [ ] theCounters = counters ; \n + \n + int maxBar = 0 ; \n + int minBar = Integer . MAX _ VALUE ; \n + for ( int j = position ; j < end ; j + = 2 ) { \n + int currentCounter = theCounters [ j ] ; \n + if ( currentCounter < minBar ) { \n + minBar = currentCounter ; \n + } \n + if ( currentCounter > maxBar ) { \n + maxBar = currentCounter ; \n + } \n + } \n + int thresholdBar = ( minBar + maxBar ) / 2 ; \n + \n + int maxSpace = 0 ; \n + int minSpace = Integer . MAX _ VALUE ; \n + for ( int j = position + 1 ; j < end ; j + = 2 ) { \n + int currentCounter = theCounters [ j ] ; \n + if ( currentCounter < minSpace ) { \n + minSpace = currentCounter ; \n + } \n + if ( currentCounter > maxSpace ) { \n + maxSpace = currentCounter ; \n - thresholds [ i ] = ( mins [ i ] + maxes [ i ] ) / 2 ; \n + int thresholdSpace = ( minSpace + maxSpace ) / 2 ; \n - int barOrSpace = i & 1 ; \n + int threshold = ( i & 1 ) = = 0 ? thresholdBar : thresholdSpace ; \n - if ( counters [ position + i ] > thresholds [ barOrSpace ] ) { \n + if ( theCounters [ position + i ] > threshold ) { \n",Codabar optimization \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2515 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android - integration \ src \ com \ google \ zxing \ integration \ android \ IntentIntegrator . java \n + import java . util . ArrayList ; \n - * do so . The apps that are allowed to response can be set with { @ link # setTargetApplications ( Collection ) } . \n + * do so . The apps that are allowed to response can be set with { @ link # setTargetApplications ( List ) } . \n - public static final Collection < String > TARGET _ BARCODE _ SCANNER _ ONLY = Collections . singleton ( BS _ PACKAGE ) ; \n - public static final Collection < String > TARGET _ ALL _ KNOWN = list ( \n + public static final List < String > TARGET _ BARCODE _ SCANNER _ ONLY = Collections . singletonList ( BS _ PACKAGE ) ; \n + public static final List < String > TARGET _ ALL _ KNOWN = list ( \n - private Collection < String > targetApplications ; \n + private List < String > targetApplications ; \n - \n + \n + / * * \n + * @ deprecated call { @ link # setTargetApplications ( List ) } \n + * / \n + @ Deprecated \n + List < String > list = new ArrayList < String > ( targetApplications . size ( ) ) ; \n + for ( String app : targetApplications ) { \n + list . add ( app ) ; \n + } \n + setTargetApplications ( list ) ; \n + } \n + \n + public void setTargetApplications ( List < String > targetApplications ) { \n + if ( targetApplications . isEmpty ( ) ) { \n + throw new IllegalArgumentException ( "" No target applications "" ) ; \n + } \n - this . targetApplications = Collections . singleton ( targetApplication ) ; \n + this . targetApplications = Collections . singletonList ( targetApplication ) ; \n - Uri uri = Uri . parse ( "" market : / / details ? id = "" + BS _ PACKAGE ) ; \n + String packageName = targetApplications . get ( 0 ) ; \n + Uri uri = Uri . parse ( "" market : / / details ? id = "" + packageName ) ; \n - Log . w ( TAG , "" Android Market is not installed ; cannot install Barcode Scanner "" ) ; \n + Log . w ( TAG , "" Google Play is not installed ; cannot install "" + packageName ) ; \n - private static Collection < String > list ( String . . . values ) { \n - return Collections . unmodifiableCollection ( Arrays . asList ( values ) ) ; \n + private static List < String > list ( String . . . values ) { \n + return Collections . unmodifiableList ( Arrays . asList ( values ) ) ; \n",Download from list of selected target apps only ; require ordered list of target apps ( List not Collection ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2544 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android - integration \ pom . xml \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - clean - plugin < / artifactId > \n + < version > 2 . 5 < / version > \n + < / plugin > \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n + < / plugin > \n + < plugin > \n + < artifactId > maven - deploy - plugin < / artifactId > \n + < version > 2 . 7 < / version > \n core \ pom . xml \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - clean - plugin < / artifactId > \n + < version > 2 . 5 < / version > \n + < / plugin > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - jar - plugin < / artifactId > \n + < version > 2 . 4 < / version > \n + < / plugin > \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n + < / plugin > \n + < plugin > \n + < artifactId > maven - deploy - plugin < / artifactId > \n + < version > 2 . 7 < / version > \n javase \ pom . xml \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - clean - plugin < / artifactId > \n + < version > 2 . 5 < / version > \n + < / plugin > \n + < plugin > \n + < groupId > org . apache . maven . plugins < / groupId > \n + < artifactId > maven - jar - plugin < / artifactId > \n + < version > 2 . 4 < / version > \n + < / plugin > \n - < version > 2 . 3 . 2 < / version > \n + < version > 2 . 4 < / version > \n + < / plugin > \n + < plugin > \n + < artifactId > maven - deploy - plugin < / artifactId > \n + < version > 2 . 7 < / version > \n,( Committed old pom updates along the way ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2545 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ encode \ VCardContactEncoder . java \n + newContents . append ( "" VERSION : 3 . 0 "" ) . append ( TERMINATOR ) ; \n zxing . appspot . com \ src \ com \ google \ zxing \ web \ generator \ client \ ContactInfoGenerator . java \n + output . append ( "" VERSION : 3 . 0 \ n "" ) ; \n zxing . appspot . com \ war \ WEB - INF \ lib \ gwt - incubator . jar \n Binary files a / zxing . appspot . com / war / WEB - INF / lib / gwt - incubator . jar and b / zxing . appspot . com / war / WEB - INF / lib / gwt - incubator . jar differ \n zxing . appspot . com \ war \ app . yaml \n - version : 7 \n + version : 8 \n",Add VERSION : 3 . 0 to vCard encoding \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2546 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n - throw new IOException ( iae ) ; \n + throw new IOException ( iae . toString ( ) ) ; \n - throw new IOException ( se ) ; \n + throw new IOException ( se . toString ( ) ) ; \n - throw new IOException ( ioobe ) ; \n + throw new IOException ( ioobe . toString ( ) ) ; \n - throw new IOException ( npe ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n,I keep forgetting that you can ' t use the normal IOException constructor in old Android \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2552 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n - android : label = "" @ string / app _ name "" > \n + android : logo = "" @ drawable / launcher _ icon "" \n + android : label = "" @ string / app _ name "" \n + android : hardwareAccelerated = "" true "" \n + android : allowBackup = "" true "" > \n android \ res \ values - es \ strings . xml \n - < string name = "" msg _ install _ google _ shopper "" > Google Shopper combina el escaneo de código de barras con los precios en linea y local , comentarios y más , sin tener que abrir el navegador . ¿Le gustaría probarlo ? < / string > \n + < string name = "" msg _ install _ google _ shopper "" > Google Shopper combina el escaneo de código de barras con los precios en línea y local , comentarios y más , sin tener que abrir el navegador . ¿Le gustaría probarlo ? < / string > \n",Changes from lint inspection \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2553 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
cpp \ core \ src \ zxing \ multi \ qrcode \ detector \ MultiFinderPatternFinder . cpp \n - FinderPatternFinder : : orderBestPatterns ( pattern ) ; \n + pattern = FinderPatternFinder : : orderBestPatterns ( pattern ) ; \n - FinderPatternFinder : : orderBestPatterns ( test ) ; \n + test = FinderPatternFinder : : orderBestPatterns ( test ) ; \n,Issue 1436 use return value from function to have an effect \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2555 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"cpp \ core \ src \ zxing \ multi \ qrcode \ detector \ MultiFinderPatternFinder . cpp \n - float vModSize12A = abs ( p1 - > getEstimatedModuleSize ( ) - p2 - > getEstimatedModuleSize ( ) ) ; \n + float vModSize12A = fabs ( p1 - > getEstimatedModuleSize ( ) - p2 - > getEstimatedModuleSize ( ) ) ; \n - float vModSize23A = abs ( p2 - > getEstimatedModuleSize ( ) - p3 - > getEstimatedModuleSize ( ) ) ; \n + float vModSize23A = fabs ( p2 - > getEstimatedModuleSize ( ) - p3 - > getEstimatedModuleSize ( ) ) ; \n - float vABBC = abs ( ( dA - dB ) / std : : min ( dA , dB ) ) ; \n + float vABBC = fabs ( ( dA - dB ) / std : : min ( dA , dB ) ) ; \n - float vPyC = abs ( ( dC - dCpy ) / std : : min ( dC , dCpy ) ) ; \n + float vPyC = fabs ( ( dC - dCpy ) / std : : min ( dC , dCpy ) ) ; \n",Issue 1437 use fabs ( ) \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2556 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"cpp \ core \ src \ zxing \ multi \ qrcode \ detector \ MultiFinderPatternFinder . cpp \n - # include < math . h > \n + # include < cmath > \n - float vModSize12A = fabs ( p1 - > getEstimatedModuleSize ( ) - p2 - > getEstimatedModuleSize ( ) ) ; \n + float vModSize12A = abs ( p1 - > getEstimatedModuleSize ( ) - p2 - > getEstimatedModuleSize ( ) ) ; \n - float vModSize23A = fabs ( p2 - > getEstimatedModuleSize ( ) - p3 - > getEstimatedModuleSize ( ) ) ; \n + float vModSize23A = abs ( p2 - > getEstimatedModuleSize ( ) - p3 - > getEstimatedModuleSize ( ) ) ; \n - float vABBC = fabs ( ( dA - dB ) / std : : min ( dA , dB ) ) ; \n + float vABBC = abs ( ( dA - dB ) / std : : min ( dA , dB ) ) ; \n - float vPyC = fabs ( ( dC - dCpy ) / std : : min ( dC , dCpy ) ) ; \n + float vPyC = abs ( ( dC - dCpy ) / std : : min ( dC , dCpy ) ) ; \n","Issue 1437 part 2 , use cmath but use abs ( ) again \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2557 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
AUTHORS \n + Bruce Allen \n,Add Bruce for C # report \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2560 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ result \ ProductResultHandler . java \n + import com . google . zxing . client . result . ExpandedProductParsedResult ; \n - ProductParsedResult productResult = ( ProductParsedResult ) getResult ( ) ; \n + ParsedResult rawResult = getResult ( ) ; \n + String productID ; \n + if ( rawResult instanceof ProductParsedResult ) { \n + productID = ( ( ProductParsedResult ) rawResult ) . getNormalizedProductID ( ) ; \n + } else if ( rawResult instanceof ExpandedProductParsedResult ) { \n + productID = ( ( ExpandedProductParsedResult ) rawResult ) . getRawText ( ) ; \n + } else { \n + throw new IllegalArgumentException ( rawResult . getClass ( ) . toString ( ) ) ; \n + } \n - openProductSearch ( productResult . getNormalizedProductID ( ) ) ; \n + openProductSearch ( productID ) ; \n - webSearch ( productResult . getNormalizedProductID ( ) ) ; \n + webSearch ( productID ) ; \n - openURL ( fillInCustomSearchURL ( productResult . getNormalizedProductID ( ) ) ) ; \n + openURL ( fillInCustomSearchURL ( productID ) ) ; \n,Fix bug on clicking through to search after an RSS expanded product scan \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2562 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n + } catch ( NumberFormatException nfe ) { \n + / / Again seen this in the wild for bad header fields in the server response ! \n + Log . w ( TAG , "" Bad server status ? "" + uri ) ; \n + throw new IOException ( nfe . toString ( ) ) ; \n",Catch another weird crash in Android on bad server response \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2563 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivity . java \n - clipboard . setText ( text ) ; \n + try { \n + clipboard . setText ( text ) ; \n + } catch ( NullPointerException npe ) { \n + / / Some kind of bug inside the clipboard implementation , not due to null input \n + Log . w ( TAG , "" Clipboard bug "" , npe ) ; \n + } \n",Try to avoid another clipboard - related NPE \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2564 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ src \ com \ google \ zxing \ client \ android \ CaptureActivityHandler . java \n - BitmapFactory . Options options = new BitmapFactory . Options ( ) ; \n - options . inMutable = true ; \n - barcode = BitmapFactory . decodeByteArray ( compressedBitmap , 0 , compressedBitmap . length , options ) ; \n + barcode = BitmapFactory . decodeByteArray ( compressedBitmap , 0 , compressedBitmap . length , null ) ; \n + / / Mutable copy : \n + barcode = barcode . copy ( Bitmap . Config . ARGB _ 8888 , true ) ; \n","Don ' t use inMutable , which is only in API 11 + \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2565 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ HttpHelper . java \n - URLConnection conn = url . openConnection ( ) ; \n - if ( ! ( conn instanceof HttpURLConnection ) ) { \n - throw new IOException ( ) ; \n - } \n - HttpURLConnection connection = ( HttpURLConnection ) conn ; \n + HttpURLConnection connection = safelyOpenConnection ( url ) ; \n - \n - URLConnection conn = url . openConnection ( ) ; \n - if ( ! ( conn instanceof HttpURLConnection ) ) { \n - throw new IOException ( ) ; \n - } \n - HttpURLConnection connection = ( HttpURLConnection ) conn ; \n + HttpURLConnection connection = safelyOpenConnection ( url ) ; \n + \n + private static HttpURLConnection safelyOpenConnection ( URL url ) throws IOException { \n + URLConnection conn ; \n + try { \n + conn = url . openConnection ( ) ; \n + } catch ( NullPointerException npe ) { \n + / / Another strange bug in Android ? \n + Log . w ( TAG , "" Bad URI ? "" + url ) ; \n + throw new IOException ( npe . toString ( ) ) ; \n + } \n + if ( ! ( conn instanceof HttpURLConnection ) ) { \n + throw new IOException ( ) ; \n + } \n + return ( HttpURLConnection ) conn ; \n + } \n",Catch weird openConnection ( ) NPE in Android \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2568 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"zxingorg \ src \ main \ java \ com \ google \ zxing \ web \ DecodeServlet . java \n + import java . net . URLConnection ; \n + String protocol = imageURL . getProtocol ( ) ; \n + if ( ! "" http "" . equalsIgnoreCase ( protocol ) & & ! "" https "" . equalsIgnoreCase ( protocol ) ) { \n + log . info ( "" URI was not valid : "" + imageURIString ) ; \n + response . sendRedirect ( "" badurl . jspx "" ) ; \n + return ; \n + } \n + \n",Reject non - HTTP URIs \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2990 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ com \ google \ zxing \ multi \ qrcode \ detector \ MultiFinderPatternFinder . java \n - if ( foundPatternCross ( stateCount ) ) { / / Yes \n - boolean confirmed = handlePossibleCenter ( stateCount , i , j ) ; \n - if ( ! confirmed ) { \n - do { / / Advance to next black pixel \n - j + + ; \n - } while ( j < maxJ & & ! image . get ( j , i ) ) ; \n - j - - ; / / back up to that last white pixel \n - } \n + if ( foundPatternCross ( stateCount ) & & handlePossibleCenter ( stateCount , i , j ) ) { / / Yes \n",Issue 1477 improve multi QR code finder logic \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2550 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"zxingorg \ pom . xml \n - < dependency > \n - < groupId > org . apache . commons < / groupId > \n - < artifactId > commons - lang3 < / artifactId > \n - < version > 3 . 1 < / version > \n - < / dependency > \n zxingorg \ src \ web \ w \ decoderesult . jspx \n - - > \n - java . util . List , \n - org . apache . commons . lang3 . StringEscapeUtils "" / > \n + com . google . common . xml . XmlEscapers "" / > \n - for ( Result result : ( List & lt ; Result & gt ; ) request . getAttribute ( "" results "" ) ) { \n + for ( Result result : ( Iterable & lt ; Result & gt ; ) request . getAttribute ( "" results "" ) ) { \n - text = StringEscapeUtils . escapeXml ( text ) ; \n + text = XmlEscapers . xmlContentEscaper ( ) . escape ( text ) ; \n - displayResult = StringEscapeUtils . escapeXml ( displayResult ) ; \n + displayResult = XmlEscapers . xmlContentEscaper ( ) . escape ( displayResult ) ; \n",Remove lang3 dependency as Guava can take over its one usage \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2991 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
AUTHORS \n - robert @ prog . olsztyn \n,mike06j contributed patch for Issue 1820 \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2993 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
androidtest \ src \ com \ google \ zxing \ client \ androidtest \ ZXingTestActivity . java \n - String [ ] params = SEMICOLON . split ( flattened ) ; \n - Arrays . sort ( params ) ; \n - for ( String param : params ) { \n - result . append ( param ) . append ( ' \ n ' ) ; \n + if ( flattened ! = null ) { \n + String [ ] params = SEMICOLON . split ( flattened ) ; \n + Arrays . sort ( params ) ; \n + for ( String param : params ) { \n + result . append ( param ) . append ( ' \ n ' ) ; \n + } \n,Avoid NPE for camera with no params \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2995 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ main \ java \ com \ google \ zxing \ multi \ qrcode \ QRCodeMultiReader . java \n - for ( byte [ ] segment : ( Iterable < byte [ ] > ) saResult . getResultMetadata ( ) . get ( ResultMetadataType . BYTE _ SEGMENTS ) ) { \n + @ SuppressWarnings ( "" unchecked "" ) \n + Iterable < byte [ ] > byteSegments = \n + ( Iterable < byte [ ] > ) saResult . getResultMetadata ( ) . get ( ResultMetadataType . BYTE _ SEGMENTS ) ; \n + for ( byte [ ] segment : byteSegments ) { \n - for ( byte [ ] segment : ( Iterable < byte [ ] > ) saResult . getResultMetadata ( ) . get ( ResultMetadataType . BYTE _ SEGMENTS ) ) { \n + @ SuppressWarnings ( "" unchecked "" ) \n + Iterable < byte [ ] > byteSegments = \n + ( Iterable < byte [ ] > ) saResult . getResultMetadata ( ) . get ( ResultMetadataType . BYTE _ SEGMENTS ) ; \n + for ( byte [ ] segment : byteSegments ) { \n",Suppress ignorable unchecked cast warning \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2997 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
pom . xml \n - < ! - - < parallel > classes < / parallel > - - > \n + < forkCount > 4 < / forkCount > \n + < reuseForks > false < / reuseForks > \n,Use 4x parallelism in unit tests \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 2999 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"core \ src \ main \ java \ com \ google \ zxing \ common \ detector \ WhiteRectangleDetector . java \n - private static final int INIT _ SIZE = 30 ; \n + private static final int INIT _ SIZE = 10 ; \n - / * * \n - * @ throws NotFoundException if image is too small \n - * / \n - this . image = image ; \n - height = image . getHeight ( ) ; \n - width = image . getWidth ( ) ; \n - leftInit = ( width - INIT _ SIZE ) > > 1 ; \n - rightInit = ( width + INIT _ SIZE ) > > 1 ; \n - upInit = ( height - INIT _ SIZE ) > > 1 ; \n - downInit = ( height + INIT _ SIZE ) > > 1 ; \n - if ( upInit < 0 | | leftInit < 0 | | downInit > = height | | rightInit > = width ) { \n - throw NotFoundException . getNotFoundInstance ( ) ; \n - } \n + this ( image , INIT _ SIZE , image . getWidth ( ) / 2 , image . getHeight ( ) / 2 ) ; \n - * @ throws NotFoundException if image is too small \n + * @ throws NotFoundException if image is too small to accommodate { @ code initSize } \n - int halfsize = initSize > > 1 ; \n + int halfsize = initSize / 2 ; \n",Handle smaller images in WhiteRectangleDetector \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3000 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ src \ com \ google \ zxing \ client \ android \ result \ WifiResultHandler . java \n - * Handles address book entries . \n + * Handles wifi access information . \n,Fix class description \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3002 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
android \ pom . xml \n + < dependencies > \n + < dependency > \n + < groupId > com . google . zxing < / groupId > \n + < artifactId > core < / artifactId > \n + < version > $ { project . version } < / version > \n + < / dependency > \n + < / dependencies > \n + \n androidtest \ pom . xml \n + < dependencies > \n + < dependency > \n + < groupId > com . google . zxing < / groupId > \n + < artifactId > core < / artifactId > \n + < version > $ { project . version } < / version > \n + < / dependency > \n + < dependency > \n + < groupId > com . google . zxing < / groupId > \n + < artifactId > android - integration < / artifactId > \n + < version > $ { project . version } < / version > \n + < / dependency > \n + < / dependencies > \n + \n,Android modules need to express their dependencies on core / android - integration \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3003 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
glass - mirror \ pom . xml \n - < version > v1 - rev28 - 1 . 17 . 0 - rc < / version > \n + < version > v1 - rev37 - 1 . 17 . 0 - rc < / version > \n - < version > v2 - rev51 - 1 . 17 . 0 - rc < / version > \n + < version > v2 - rev59 - 1 . 17 . 0 - rc < / version > \n - < version > 1 . 8 < / version > \n + < version > 1 . 9 < / version > \n - < version > 4 . 3 < / version > \n + < version > 4 . 3 . 1 < / version > \n - < version > 15 . 0 < / version > \n pom . xml \n + < dependency > \n + < groupId > com . google . guava < / groupId > \n + < artifactId > guava < / artifactId > \n + < version > 16 . 0 - rc1 < / version > \n + < / dependency > \n zxing . appspot . com \ pom . xml \n - < gwt . version > 2 . 6 . 0 - rc1 < / gwt . version > \n + < gwt . version > 2 . 6 . 0 - rc3 < / gwt . version > \n zxingorg \ pom . xml \n - < version > 15 . 0 < / version > \n,"Update versions of plugins , dependencies \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3005 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57",678
"android \ src \ com \ google \ zxing \ client \ android \ share \ LoadPackagesAsyncTask . java \n - final class LoadPackagesAsyncTask extends AsyncTask < Void , Void , List < AppInfo > > { \n + final class LoadPackagesAsyncTask extends AsyncTask < Object , Object , List < AppInfo > > { \n - protected List < AppInfo > doInBackground ( Void . . . objects ) { \n + protected List < AppInfo > doInBackground ( Object . . . objects ) { \n",Fix problem on some platforms with AsyncTask array arg type \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3007 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"android \ AndroidManifest . xml \n - android : screenOrientation = "" user "" / > \n + android : screenOrientation = "" user "" \n + android : stateNotNeeded = "" true "" / > \n android \ src \ com \ google \ zxing \ client \ android \ HelpActivity . java \n - @ Override \n - protected void onSaveInstanceState ( Bundle state ) { \n - String url = webView . getUrl ( ) ; \n - if ( url ! = null & & ! url . isEmpty ( ) ) { \n - webView . saveState ( state ) ; \n - } \n - } \n - \n",No need to save state in HelpActivity \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3009 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
"new file \n android \ assets \ html - zh - rHK \n + html - zh - rTW / \n new file \n android \ res \ values - zh - rHK \n + values - zh - rTW \n android \ src \ com \ google \ zxing \ client \ android \ LocaleManager . java \n - Arrays . asList ( "" de "" , "" en "" , "" es "" , "" fr "" , "" it "" , "" ja "" , "" ko "" , "" nl "" , "" pt "" , "" ru "" , "" zh - rCN "" , "" zh - rTW "" ) ; \n + Arrays . asList ( "" de "" , "" en "" , "" es "" , "" fr "" , "" it "" , "" ja "" , "" ko "" , "" nl "" , "" pt "" , "" ru "" , "" zh - rCN "" , "" zh - rTW "" , "" zh - rHK "" ) ; \n",Add zh - rHK as symlink to zh - rTW \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3013 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
new file \n android \ res \ values - iw \n + values - he / \n,Add values - iw as symlink to values - he \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 3015 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,678
handler \ src \ main \ java \ io \ netty \ handler \ timeout \ WriteTimeoutException . java \n - * A { @ link TimeoutException } raised by { @ link WriteTimeoutHandler } when no data \n - * was written within a certain period of time . \n + * A { @ link TimeoutException } raised by { @ link WriteTimeoutHandler } when a write operation \n + * cannot finish in a certain period of time . \n,Fix WriteTimeoutException java doc description ( # 9554 ) \n Motivation : \n The java doc doesn ' t match the real case : The exception only happen when a write operation \n cannot finish in a certain period of time instead of write idle happen . \n Modification : \n Correct java doc \n Result : \n java doc matched the real case,681
transport \ src \ main \ java \ io \ netty \ channel \ socket \ nio \ NioSocketChannel . java \n - setMaxBytesPerGatheringWrite ( getSendBufferSize ( ) < < 1 ) ; \n + setMaxBytesPerGatheringWrite ( newSendBufferSize ) ; \n,Remove duplicated calculation ( # 9565 ) \n Motivation : \n calculateMaxBytesPerGatheringWrite ( ) contains duplicated calculation : getSendBufferSize ( ) < < 1 \n Modifications : \n Remove the duplicated calculation \n Result : \n The method will be clear and better,681
"transport \ src \ main \ java \ io \ netty \ channel \ SimpleChannelInboundHandler . java \n - * \n - * < h3 > Forward compatibility notice < / h3 > \n - * < p > \n - * Please keep in mind that { @ link # channelRead0 ( ChannelHandlerContext , I ) } will be renamed to \n - * { @ code messageReceived ( ChannelHandlerContext , I ) } in 5 . 0 . \n - * < / p > \n - * < strong > Please keep in mind that this method will be renamed to \n - * { @ code messageReceived ( ChannelHandlerContext , I ) } in 5 . 0 . < / strong > \n - * \n",remove useless doc for 5 . 0 ( # 9546 ) \n Fix javadoc issues \n Motivation : \n Remove useless doc for 5 . 0 \n Modifications : \n Remove description for 5 . 0 \n Result : \n Useless doc will be removed .,681
"handler \ src \ main \ java \ io \ netty \ handler \ timeout \ IdleStateHandler . java \n + import io . netty . util . internal . ObjectUtil ; \n - if ( unit = = null ) { \n - throw new NullPointerException ( "" unit "" ) ; \n - } \n + ObjectUtil . checkNotNull ( unit , "" unit "" ) ; \n",Unify parameter validation ' s code style . ( # 9778 ) \n Motivation : \n Unify parameter validation ' s code style . \n Modifications : \n Change the parameter ' s validation statements to the method : ObjectUtil . checkNotNull . \n Result : \n The parameter ' s validation code will keep same style with other codes,681
handler \ src \ main \ java \ io \ netty \ handler \ traffic \ AbstractTrafficShapingHandler . java \n - * Default minimal time to wait \n + * Default minimal time to wait : 10ms \n,"Improve java doc for MINIMAL _ WAIT ( # 9779 ) \n Motivation : \n MINIMAL _ WAIT is the key constant . Thus , When we see the constant , we must read more code logic to see if it is ms or ns . So improving java doc will be better . \n Modifications : \n Improve java doc by add "" 10ms "" such as DEFAULT _ CHECK _ INTERVAL with "" 1s "" . \n Result : \n Easy to know it is ms and keep same java doc style with other constants such as DEFAULT _ CHECK _ INTERVAL .",681
"transport - native - epoll \ src \ main \ java \ io \ netty \ channel \ epoll \ EpollEventLoopGroup . java \n + / * * \n + * Create a new instance using the default number of threads and the given { @ link ThreadFactory } . \n + * / \n + @ SuppressWarnings ( "" deprecation "" ) \n + public EpollEventLoopGroup ( ThreadFactory threadFactory ) { \n + this ( 0 , threadFactory , 0 ) ; \n + } \n + \n transport - native - kqueue \ src \ main \ java \ io \ netty \ channel \ kqueue \ KQueueEventLoopGroup . java \n + / * * \n + * Create a new instance using the default number of threads and the given { @ link ThreadFactory } . \n + * / \n + @ SuppressWarnings ( "" deprecation "" ) \n + public KQueueEventLoopGroup ( ThreadFactory threadFactory ) { \n + this ( 0 , threadFactory , 0 ) ; \n + } \n + \n transport \ src \ main \ java \ io \ netty \ channel \ DefaultEventLoopGroup . java \n + / * * \n + * Create a new instance with the default number of threads and the given { @ link ThreadFactory } . \n + * \n + * @ param threadFactory the { @ link ThreadFactory } or { @ code null } to use the default \n + * / \n + public DefaultEventLoopGroup ( ThreadFactory threadFactory ) { \n + this ( 0 , threadFactory ) ; \n + } \n + \n transport \ src \ main \ java \ io \ netty \ channel \ local \ LocalEventLoopGroup . java \n + / * * \n + * Create a new instance with the default number of threads and the given { @ link ThreadFactory } . \n + * \n + * @ param threadFactory the { @ link ThreadFactory } or { @ code null } to use the default \n + * / \n + public LocalEventLoopGroup ( ThreadFactory threadFactory ) { \n + super ( 0 , threadFactory ) ; \n + } \n + \n transport \ src \ main \ java \ io \ netty \ channel \ nio \ NioEventLoopGroup . java \n + / * * \n + * Create a new instance using the default number of threads , the given { @ link ThreadFactory } and the \n + * { @ link SelectorProvider } which is returned by { @ link SelectorProvider # provider ( ) } . \n + * / \n + public NioEventLoopGroup ( ThreadFactory threadFactory ) { \n + this ( 0 , threadFactory , SelectorProvider . provider ( ) ) ; \n + } \n + \n","Add one new constructor with threadFactory only ( # 9773 ) \n Motivation : \n In most cases , we want to use MultithreadEventLoopGroup such as NioEventLoopGroup without setting thread numbers but thread name only . So we need to use followed code : \n NioEventLoopGroup boss = new NioEventLoopGroup ( 0 , new DefaultThreadFactory ( "" boss "" ) ) ; \n It looks a bit confuse or strange for the number 0 due to we only want to set thread name . So it will be better to add new constructor for this case . \n Modifications : \n add new constructor into all event loop groups , for example : public NioEventLoopGroup ( ThreadFactory threadFactory ) \n Result : \n User can only set thread factory without setting the thread number to 0 : \n NioEventLoopGroup boss = new NioEventLoopGroup ( new DefaultThreadFactory ( "" boss "" ) ) ;",681
"zxing . appspot . com \ generator \ src \ com \ google \ zxing \ web \ generator \ client \ ContactInfoGenerator . java \n - table = new Grid ( 7 , 2 ) ; \n + table = new Grid ( 8 , 2 ) ; \n",Minor bugfix \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1894 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
build . properties \n - # It builds against GWT 1 . 7 at the moment . \n + # It builds against GWT 2 . 0 . 1 at the moment . \n,Incorrect comment . This will only build with gwt 2 . 0 . 1 at the moment \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1895 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
"new file \n zxing . appspot . com \ README \n + To compile : \n + - - - - - - - - - - \n + Run ' ant ' in this directory . You might get a lot of warnings with \n + [ WARN ] but you should not get any errors . \n + \n + \n + To test : \n + - - - - - - - \n + View the file "" build / site / generator / index . html "" in any browser . You can do \n + this from the commandline with : \n + \n + firefox build / site / generator / index . html \n + \n + Now you can try out your changes . \n",Adding a helpful README . I keep forgetting the appspot workflow if I don ' t \n use it for a week . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1915 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
"android \ src \ com \ google \ zxing \ client \ android \ wifi \ Killer . java \n - * Close the parent after a delay . \n + * Start a browser after a delay to let the user read the informative \n + * message . \n - / / Three full seconds \n + / / Wait for this long , to enable the user to read the status . \n - / / This will kill the parent , a bad idea . \n - / / parent . finish ( ) ; \n - / / This will start the browser , a better idea \n + / / This will start the browser . \n",Minor whitespace and comment cleanup \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1916 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
"android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiReceiver . java \n + / / Wifi supplicant ( WPA client software ) changed state . \n + / / The network state changed . \n + / / We might be connected . \n + / / Yes , we connected to the network specified in the barcode . \n + / / Let ' s save the configuration , since we know it works . Then , \n + / / we stop this application by calling the killer . \n + / / We couldn ' t connect to the specified network . Let the parent \n + / / know that we were unsuccessful . \n - } \n + } \n",Adding minor comments \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1917 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
"android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiActivity . java \n - wifiReceiver = new WifiReceiver ( wifiManager , this , statusView , ssid ) ; \n + wifiReceiver = new WifiReceiver ( wifiManager , this , statusView ) ; \n android \ src \ com \ google \ zxing \ client \ android \ wifi \ WifiReceiver . java \n - / / FIXME : Why is ssid ignored here ? \n - WifiReceiver ( WifiManager wifiManager , WifiActivity wifiActivity , TextView statusView , \n - String ssid ) { \n + WifiReceiver ( WifiManager wifiManager , WifiActivity wifiActivity , TextView statusView ) { \n",Remove an unused variable from the WifiReceiver class . \n git - svn - id : https : / / zxing . googlecode . com / svn / trunk @ 1918 59b500cc - 1b3d - 0410 - 9834 - 0bbf25fbcc57,692
README . md \n - Examples can also be viewed on : http : / / code . google . com / p / spark - java / \n - \n,remove link with outdated examples in README \n Examples on googlecode use pre 2 . 0 . 0 syntax and the page on googlecode is outdated in general \n https : / / code . google . com / p / spark - java /,696
src \ test \ java \ spark \ BooksIntegrationTest . java \n + import org . junit . Ignore ; \n + testCreateBook ( ) ; \n + @ Ignore \n + @ Ignore \n,fix testListBooks Test by creating a Book first,696
src \ test \ java \ spark \ BooksIntegrationTest . java \n - import org . junit . AfterClass ; \n - import org . junit . BeforeClass ; \n + import org . junit . After ; \n + import org . junit . Before ; \n - @ AfterClass \n - public static void tearDown ( ) { \n + @ After \n + public void tearDown ( ) { \n - @ BeforeClass \n - public static void setup ( ) { \n + @ Before \n + public void setup ( ) { \n,use Before After instead of BeforeClass AfterClass \n To remove state between the Tests,696
"src \ test \ java \ spark \ examples \ books \ Books . java \n - import spark . Request ; \n - import spark . Response ; \n - import spark . Route ; \n - \n - private static Map < String , Book > books = new HashMap < String , Book > ( ) ; \n + public static Map < String , Book > books = new HashMap < String , Book > ( ) ; \n",change books map to public for testing purposes,696
"src \ test \ java \ spark \ BooksIntegrationTest . java \n + import static spark . Spark . after ; \n + import static spark . Spark . before ; \n - Spark . before ( new Filter ( ) { \n - @ Override \n - public void handle ( Request request , Response response ) { \n - response . header ( "" FOZ "" , "" BAZ "" ) ; \n - } \n + before ( ( request , response ) - > { \n + response . header ( "" FOZ "" , "" BAZ "" ) ; \n - Spark . after ( new Filter ( ) { \n - @ Override \n - public void handle ( Request request , Response response ) { \n - response . header ( "" FOO "" , "" BAR "" ) ; \n - } \n + after ( ( request , response ) - > { \n + response . header ( "" FOO "" , "" BAR "" ) ; \n + \n",use lambda syntax for the filters in setup,696
"src \ test \ java \ spark \ BooksIntegrationTest . java \n + import java . io . IOException ; \n - private static UrlResponse doMethod ( String requestMethod , String path , String body ) throws Exception { \n - URL url = new URL ( "" http : / / localhost : "" + PORT + path ) ; \n - HttpURLConnection connection = ( HttpURLConnection ) url . openConnection ( ) ; \n - connection . setRequestMethod ( requestMethod ) ; \n + private static UrlResponse doMethod ( String requestMethod , String path , String body ) { \n + UrlResponse response = new UrlResponse ( ) ; \n + \n + try { \n + URL url = new URL ( "" http : / / localhost : "" + PORT + path ) ; \n + HttpURLConnection connection = ( HttpURLConnection ) url . openConnection ( ) ; \n + connection . setRequestMethod ( requestMethod ) ; \n - connection . connect ( ) ; \n + connection . connect ( ) ; \n + \n + String res = IOUtils . toString ( connection . getInputStream ( ) ) ; \n + \n + response . body = res ; \n + response . status = connection . getResponseCode ( ) ; \n + response . headers = connection . getHeaderFields ( ) ; \n + } catch ( IOException e ) { \n + e . printStackTrace ( ) ; \n + } \n - String res = IOUtils . toString ( connection . getInputStream ( ) ) ; \n - UrlResponse response = new UrlResponse ( ) ; \n - response . body = res ; \n - response . status = connection . getResponseCode ( ) ; \n - response . headers = connection . getHeaderFields ( ) ; \n",deal with exceptions in doMethod \n To avoid necessity to put every test method into a try - catch block,696
"src \ test \ java \ spark \ BooksIntegrationTest . java \n - @ Test \n - public void wontFindBook ( ) { \n - try { \n - getResponse ( "" GET "" , "" / books / "" + bookId , null ) ; \n - } catch ( Exception e ) { \n - if ( e instanceof FileNotFoundException ) { \n - assertTrue ( true ) ; \n - } else { \n - e . printStackTrace ( ) ; \n - throw new RuntimeException ( e ) ; \n - } \n - } \n + @ Test ( expected = FileNotFoundException . class ) \n + public void wontFindBook ( ) throws IOException { \n + getResponse ( "" GET "" , "" / books / "" + bookId , null ) ; \n",use JUnit syntax to expect an exception in wontFindBook,696
src \ test \ java \ spark \ BooksIntegrationTest . java \n - import org . junit . Before ; \n + import org . junit . AfterClass ; \n + import org . junit . BeforeClass ; \n + @ AfterClass \n + public static void tearDown ( ) { \n + Spark . stop ( ) ; \n + } \n + \n - public void tearDown ( ) { \n + public void clearBooks ( ) { \n - Spark . stop ( ) ; \n - @ Before \n - public void setup ( ) { \n + @ BeforeClass \n + public static void setup ( ) { \n,"use BeforeClass , AfterClass to improve test executing speed",696
dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ RpcStatus . java \n + import java . util . concurrent . Semaphore ; \n + / * * \n + * 用来实现executes属性的并发限制（即控制能使用的线程数） \n + * 2017 - 08 - 21 yizhenqiang \n + * / \n + private volatile Semaphore executesLimit ; \n + private volatile int executesPermits ; \n + \n + / * * \n + * 获取限制线程数的信号量，信号量的许可数就是executes设置的值 \n + * 2017 - 08 - 21 yizhenqiang \n + * @ param maxThreadNum executes设置的值 \n + * @ return \n + * / \n + public Semaphore getSemaphore ( int maxThreadNum ) { \n + if ( maxThreadNum < = 0 ) { \n + return null ; \n + } \n + \n + if ( executesLimit = = null | | executesPermits ! = maxThreadNum ) { \n + synchronized ( this ) { \n + if ( executesLimit = = null | | executesPermits ! = maxThreadNum ) { \n + executesLimit = new Semaphore ( maxThreadNum ) ; \n + executesPermits = maxThreadNum ; \n + } \n + } \n + } \n + \n + return executesLimit ; \n + } \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ filter \ ExecuteLimitFilter . java \n + import java . util . concurrent . Semaphore ; \n + \n + Semaphore executesLimit = null ; \n + boolean acquireResult = false ; \n - if ( count . getActive ( ) > = max ) { \n + / / if ( count . getActive ( ) > = max ) { \n + / * * \n + * http : / / manzhizhen . iteye . com / blog / 2386408 \n + * 通过信号量来做并发控制（即限制能使用的线程数量） \n + * 2017 - 08 - 21 yizhenqiang \n + * / \n + executesLimit = count . getSemaphore ( max ) ; \n + if ( executesLimit ! = null & & ! ( acquireResult = executesLimit . tryAcquire ( ) ) ) { \n + if ( acquireResult ) { \n + executesLimit . release ( ) ; \n + } \n,fix ( ExecuteLimitFilter ) : 修复executes属性在高并发时无法真正限制某个接口或方法使用线程数的bug ( # 582 ) \n fix ( ExecuteLimitFilter ) : 修复executes属性在高并发时无法真正限制某个接口或方法使用线程数的bug ( # 582 ),698
dubbo - config \ dubbo - config - api \ src \ main \ java \ com \ alibaba \ dubbo \ config \ AbstractConfig . java \n - private static final int MAX _ LENGTH = 100 ; \n + private static final int MAX _ LENGTH = 200 ; \n,fix : 调大AbstractConfig中对配置值长度的限制（MAX _ LENGTH） ( # 602 ),698
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ com \ alibaba \ dubbo \ rpc \ protocol \ AbstractInvoker . java \n - invocation . addAttachmentsIfAbsent ( context ) ; \n + / * * \n + * invocation . addAttachmentsIfAbsent ( context ) { @ link RpcInvocation # addAttachmentsIfAbsent ( Map ) } should not be used here , \n + * because the { @ link RpcContext # setAttachment ( String , String ) } is passed in the Filter when the call is triggered \n + * by the built - in retry mechanism of the Dubbo . The attachment to update RpcContext will no longer work , which is \n + * a mistake in most cases ( for example , through Filter to RpcContext output traceId and spanId and other information ) . \n + * yizhenqiang 20180310 \n + * / \n + invocation . addAttachments ( context ) ; \n","Merge pull request # 1453 , restore the bug that attachment has not been updated in the RpcContext when the Dubbo built - in retry mechanism is triggered .",698
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ RpcContext . java \n + \n + private String remoteApplicationName ; \n + \n + copy . remoteApplicationName = this . remoteApplicationName ; \n + public String getRemoteApplicationName ( ) { \n + return remoteApplicationName ; \n + } \n + \n + public RpcContext setRemoteApplicationName ( String remoteApplicationName ) { \n + this . remoteApplicationName = remoteApplicationName ; \n + return this ; \n + } \n + \n dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ ContextFilter . java \n + import static org . apache . dubbo . common . Constants . REMOTE _ APPLICATION _ KEY ; \n + \n - . setLocalAddress ( invoker . getUrl ( ) . getHost ( ) , \n - invoker . getUrl ( ) . getPort ( ) ) ; \n + . setLocalAddress ( invoker . getUrl ( ) . getHost ( ) , invoker . getUrl ( ) . getPort ( ) ) \n + . setRemoteApplicationName ( invoker . getUrl ( ) . getParameter ( REMOTE _ APPLICATION _ KEY ) ) ; \n",Add remoteApplicationName in RpcContext ( # 3816 ),698
"dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ProtocolConfig . java \n + / * * \n + * Thread pool name \n + * / \n + private String threadname ; \n + \n + public String getThreadname ( ) { \n + return threadname ; \n + } \n + \n + public void setThreadname ( String threadname ) { \n + this . threadname = threadname ; \n + } \n + \n dubbo - common \ src \ main \ java \ org \ apache \ dubbo \ config \ ProviderConfig . java \n + / * * \n + * Thread pool name \n + * / \n + private String threadname ; \n + \n + public String getThreadname ( ) { \n + return threadname ; \n + } \n + \n + public void setThreadname ( String threadname ) { \n + this . threadname = threadname ; \n + } \n + \n dubbo - config \ dubbo - config - spring \ src \ main \ resources \ META - INF \ compat \ dubbo . xsd \n + < xsd : attribute name = "" threadname "" type = "" xsd : string "" > \n + < xsd : annotation > \n + < xsd : documentation > < ! [ CDATA [ The thread pool name . ] ] > < / xsd : documentation > \n + < / xsd : annotation > \n + < / xsd : attribute > \n + < xsd : attribute name = "" threadname "" type = "" xsd : string "" > \n + < xsd : annotation > \n + < xsd : documentation > < ! [ CDATA [ The thread pool name . ] ] > < / xsd : documentation > \n + < / xsd : annotation > \n + < / xsd : attribute > \n dubbo - config \ dubbo - config - spring \ src \ main \ resources \ META - INF \ dubbo . xsd \n + < xsd : attribute name = "" threadname "" type = "" xsd : string "" > \n + < xsd : annotation > \n + < xsd : documentation > < ! [ CDATA [ The thread pool name . ] ] > < / xsd : documentation > \n + < / xsd : annotation > \n + < / xsd : attribute > \n + < xsd : attribute name = "" threadname "" type = "" xsd : string "" > \n + < xsd : annotation > \n + < xsd : documentation > < ! [ CDATA [ The thread pool name . ] ] > < / xsd : documentation > \n + < / xsd : annotation > \n + < / xsd : attribute > \n",Make org . apache . dubbo . common . constants . CommonConstants . THREAD _ NAME _ KEY work ( # 5701 ),698
dubbo - all \ pom . xml \n + < dependency > \n + < groupId > org . apache . dubbo < / groupId > \n + < artifactId > dubbo - remoting - etcd3 < / artifactId > \n + < version > $ { project . version } < / version > \n + < scope > compile < / scope > \n + < optional > true < / optional > \n + < / dependency > \n + < dependency > \n + < groupId > org . apache . dubbo < / groupId > \n + < artifactId > dubbo - registry - eureka < / artifactId > \n + < version > $ { project . version } < / version > \n + < scope > compile < / scope > \n + < optional > true < / optional > \n + < / dependency > \n + < include > org . apache . dubbo : dubbo - remoting - etcd3 < / include > \n + < include > org . apache . dubbo : dubbo - rpc - native - thrift < / include > \n + < include > org . apache . dubbo : dubbo - registry - eureka < / include > \n - < include > org . apache . dubbo : dubbo - rpc - native - thrift < / include > \n dubbo - config \ dubbo - config - api \ src \ main \ java \ org \ apache \ dubbo \ config \ ServiceConfig . java \n + \n + / * * \n + * Here the token value configured by the provider is used to assign the value to ServiceConfig # token \n + * / \n + if ( ConfigUtils . isEmpty ( token ) & & provider ! = null ) { \n + token = provider . getToken ( ) ; \n + } \n + \n,Fixed a bug where the provider did not correctly inject the token ' s UUID into the registry when the token was set to true ; added the missing dubbo - remoting - etcd3 and dubbo - registry - eureka modules in dubbo - all / pom . xml ( # 5697 ),698
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ GenericFilter . java \n + if ( types = = null ) { \n + types = new String [ params . length ] ; \n + } \n + \n - throw new RpcException ( "" args . length ! = types . length "" ) ; \n + throw new RpcException ( "" GenericFilter # invoke args . length ! = types . length , please check your "" \n + + "" params "" ) ; \n","fix # 6728 , potential NPE in generic filter ( # 6785 )",698
dubbo - registry \ dubbo - registry - api \ src \ main \ java \ org \ apache \ dubbo \ registry \ support \ AbstractRegistry . java \n + \n + / / do not forget remove notified \n + notified . remove ( url ) ; \n,remove notified item when unsubscribe ( # 6790 ) \n fix # 6676,698
dubbo - filter \ dubbo - filter - cache \ src \ main \ java \ org \ apache \ dubbo \ cache \ filter \ CacheFilter . java \n - * < li > lur < / li > \n + * < li > lru < / li > \n,fix https : / / github . com / apache / dubbo / issues / 6741 lur to lru ( # 6784 ),698
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ RpcStatus . java \n - private static final ConcurrentMap < String , RpcStatus > SERVICE _ STATISTICS = new ConcurrentHashMap < String , RpcStatus > ( ) ; \n + private static final ConcurrentMap < String , RpcStatus > SERVICE _ STATISTICS = new ConcurrentHashMap < String , \n + RpcStatus > ( ) ; \n + \n + private static final ConcurrentMap < String , ConcurrentMap < String , RpcStatus > > METHOD _ STATISTICS = \n + new ConcurrentHashMap < String , ConcurrentMap < String , RpcStatus > > ( ) ; \n - private static final ConcurrentMap < String , ConcurrentMap < String , RpcStatus > > METHOD _ STATISTICS = new ConcurrentHashMap < String , ConcurrentMap < String , RpcStatus > > ( ) ; \n + \n - if ( i + 1 > max ) { \n + \n + if ( i = = Integer . MAX _ VALUE | | i + 1 > max ) { \n + \n + \n + \n + \n + \n + \n",Prevent RpcStatus # begincount int overflow in extreme cases ( # 6801 ),698
"dubbo - rpc \ dubbo - rpc - api \ src \ main \ java \ org \ apache \ dubbo \ rpc \ filter \ TokenFilter . java \n - throw new RpcException ( "" Invalid token ! Forbid invoke remote service "" + serviceType + "" method "" + inv . getMethodName ( ) + "" ( ) from consumer "" + RpcContext . getContext ( ) . getRemoteHost ( ) + "" to provider "" + RpcContext . getContext ( ) . getLocalHost ( ) ) ; \n + throw new RpcException ( "" Invalid token ! Forbid invoke remote service "" + serviceType + "" method "" + inv . getMethodName ( ) \n + + "" ( ) from consumer "" + RpcContext . getContext ( ) . getRemoteHost ( ) + "" to provider "" + RpcContext . getContext ( ) . getLocalHost ( ) \n + + "" , consumer incorrect token is "" + remoteToken ) ; \n","In order to facilitate the consumer to better locate the failure of provider token check , the token value called by consumer will be printed out in the exception information ( # 6800 )",698
"dubbo - rpc \ dubbo - rpc - dubbo \ src \ main \ java \ org \ apache \ dubbo \ rpc \ protocol \ dubbo \ DubboProtocol . java \n + @ Override \n - / / dubbo check \n + / / double check \n + * But "" locks . remove ( key ) ; "" can lead to "" synchronized ( locks . get ( key ) ) { "" NPE , considering that the key of locks is "" IP + port "" , \n + * it will not lead to the expansion of "" locks "" in theory , so I will annotate it here . \n - locks . remove ( key ) ; \n + / / locks . remove ( key ) ; \n",fix https : / / github . com / apache / dubbo / issues / 6444 NPE ( # 6793 ) \n * fix https : / / github . com / apache / dubbo / issues / 6444 NPE \n * agin ci \n * del DubboProtocol # getSharedClient locks . remove ( key ),698
spring - aop \ src \ main \ java \ org \ springframework \ aop \ framework \ AdvisedSupport . java \n - Advisor advisor = this . advisors . get ( index ) ; \n + Advisor advisor = this . advisors . remove ( index ) ; \n - for ( int j = 0 ; j < ia . getInterfaces ( ) . length ; j + + ) { \n - removeInterface ( ia . getInterfaces ( ) [ j ] ) ; \n + Class < ? > [ ] interfaces = ia . getInterfaces ( ) ; \n + for ( Class < ? > iface : interfaces ) { \n + removeInterface ( iface ) ; \n - this . advisors . remove ( index ) ; \n,Simplify AdvisedSupport . removeAdvisor ( ) \n Closes gh - 24205,701
"spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ support \ PropertiesBeanDefinitionReader . java \n + String prefixWithSep = prefix + SEPARATOR ; \n + int beginIndex = prefix . length ( ) + SEPARATOR . length ( ) ; \n + \n - if ( key . startsWith ( prefix + SEPARATOR ) ) { \n - String property = key . substring ( prefix . length ( ) + SEPARATOR . length ( ) ) ; \n + if ( key . startsWith ( prefixWithSep ) ) { \n + String property = key . substring ( beginIndex ) ; \n spring - core \ src \ main \ java \ org \ springframework \ core \ type \ classreading \ AnnotationMetadataReadingVisitor . java \n + String annotatedElement = "" class ' "" + getClassName ( ) + "" ' "" ; \n - "" class ' "" + getClassName ( ) + "" ' "" , this . classLoader , raw , classValuesAsString ) . entrySet ( ) ) { \n + annotatedElement , this . classLoader , raw , classValuesAsString ) . entrySet ( ) ) { \n",Hoist concatenation of two constant Strings out of loops \n Closes gh - 24388,701
"spring - beans \ src \ main \ java \ org \ springframework \ beans \ support \ ArgumentConvertingMethodInvoker . java \n - * Copyright 2002 - 2017 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n - Class < ? > [ ] paramTypes = candidate . getParameterTypes ( ) ; \n - if ( paramTypes . length = = argCount ) { \n + int parameterCount = candidate . getParameterCount ( ) ; \n + if ( parameterCount = = argCount ) { \n + Class < ? > [ ] paramTypes = candidate . getParameterTypes ( ) ; \n spring - core \ src \ main \ java \ org \ springframework \ core \ GenericTypeResolver . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + ResolvableType contextType = ResolvableType . forClass ( contextClass ) ; \n - ( TypeVariable < ? > ) typeArgument , ResolvableType . forClass ( contextClass ) ) ; \n + ( TypeVariable < ? > ) typeArgument , contextType ) ; \n spring - core \ src \ main \ java \ org \ springframework \ core \ type \ classreading \ MethodMetadataReadingVisitor . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + String annotatedElement = "" method ' "" + getMethodName ( ) + ' \ ' ' ; \n - "" method ' "" + getMethodName ( ) + "" ' "" , this . classLoader , annotationAttributes , classValuesAsString ) ; \n + annotatedElement , this . classLoader , annotationAttributes , classValuesAsString ) ; \n",Some trivial improvements to reduce allocation pressure \n Closes gh - 24447,701
"spring - context - indexer \ src \ main \ java \ org \ springframework \ context \ index \ processor \ SortedProperties . java \n - String contents = new String ( baos . toByteArray ( ) , StandardCharsets . ISO _ 8859 _ 1 ) ; \n + String contents = baos . toString ( StandardCharsets . ISO _ 8859 _ 1 . name ( ) ) ; \n spring - core \ src \ main \ java \ org \ springframework \ core \ SortedProperties . java \n - String contents = new String ( baos . toByteArray ( ) , StandardCharsets . ISO _ 8859 _ 1 ) ; \n + String contents = baos . toString ( StandardCharsets . ISO _ 8859 _ 1 . name ( ) ) ; \n spring - messaging \ src \ main \ java \ org \ springframework \ messaging \ converter \ ProtobufMessageConverter . java \n - payload = new String ( outputStream . toByteArray ( ) , charset ) ; \n + payload = outputStream . toString ( charset . name ( ) ) ; \n spring - websocket \ src \ main \ java \ org \ springframework \ web \ socket \ sockjs \ client \ RestTemplateXhrTransport . java \n - private void handleFrame ( ByteArrayOutputStream os ) { \n - byte [ ] bytes = os . toByteArray ( ) ; \n + private void handleFrame ( ByteArrayOutputStream os ) throws IOException { \n + String content = os . toString ( SockJsFrame . CHARSET . toString ( ) ) ; \n - String content = new String ( bytes , SockJsFrame . CHARSET ) ; \n - this . sockJsSession . handleFrame ( new String ( bytes , SockJsFrame . CHARSET ) ) ; \n + this . sockJsSession . handleFrame ( content ) ; \n",Simplify conversion of ByteArrayOutputStream to String \n Closes gh - 24785,701
"spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ support \ AbstractBeanFactory . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + String prefix = factoryPrefix ? FACTORY _ BEAN _ PREFIX : "" "" ; \n - String alias = ( factoryPrefix ? FACTORY _ BEAN _ PREFIX : "" "" ) + retrievedAlias ; \n + String alias = prefix + retrievedAlias ; \n spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ support \ BeanDefinitionReaderUtils . java \n - * Copyright 2002 - 2018 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + String prefix = beanName + GENERATED _ BEAN _ NAME _ SEPARATOR ; \n - id = beanName + GENERATED _ BEAN _ NAME _ SEPARATOR + counter ; \n + id = prefix + counter ; \n spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ support \ BeanDefinitionValueResolver . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + String prefix = innerBeanName + BeanFactoryUtils . GENERATED _ BEAN _ NAME _ SEPARATOR ; \n - actualInnerBeanName = innerBeanName + BeanFactoryUtils . GENERATED _ BEAN _ NAME _ SEPARATOR + counter ; \n + actualInnerBeanName = prefix + counter ; \n",Produce less String - related garbage when generating bean names \n Closes gh - 24476,701
spring - core \ src \ main \ java \ org \ springframework \ core \ type \ classreading \ SimpleMetadataReader . java \n - import java . io . BufferedInputStream ; \n - try ( InputStream is = new BufferedInputStream ( resource . getInputStream ( ) ) ) { \n + try ( InputStream is = resource . getInputStream ( ) ) { \n,Rid pointless wrapping with BufferedInputStream from class reading,701
"spring - beans \ src \ main \ java \ org \ springframework \ beans \ propertyeditors \ CharacterEditor . java \n - setValue ( Character . valueOf ( text . charAt ( 0 ) ) ) ; \n + setValue ( text . charAt ( 0 ) ) ; \n - setValue ( Character . valueOf ( ( char ) code ) ) ; \n + setValue ( ( char ) code ) ; \n spring - context \ src \ main \ java \ org \ springframework \ scheduling \ config \ TaskExecutorFactoryBean . java \n - Integer value = Integer . valueOf ( this . poolSize ) ; \n + int value = Integer . parseInt ( this . poolSize ) ; \n spring - web \ src \ main \ java \ org \ springframework \ http \ converter \ ResourceRegionHttpMessageConverter . java \n - Long resourceLength = region . getResource ( ) . contentLength ( ) ; \n + long resourceLength = region . getResource ( ) . contentLength ( ) ; \n - print ( out , "" Content - Type : "" + contentType . toString ( ) ) ; \n + print ( out , "" Content - Type : "" + contentType ) ; \n - Long resourceLength = region . getResource ( ) . contentLength ( ) ; \n + long resourceLength = region . getResource ( ) . contentLength ( ) ; \n spring - webmvc \ src \ main \ java \ org \ springframework \ web \ servlet \ config \ AnnotationDrivenBeanDefinitionParser . java \n - Boolean enableMatrixVariables = Boolean . valueOf ( element . getAttribute ( "" enable - matrix - variables "" ) ) ; \n + boolean enableMatrixVariables = Boolean . parseBoolean ( element . getAttribute ( "" enable - matrix - variables "" ) ) ; \n",Avoid unnecessary boxing / unboxing of primitives \n Closes gh - 25080,701
"spring - core \ src \ main \ java \ org \ springframework \ util \ StringUtils . java \n - StringBuilder sb = new StringBuilder ( inString . length ( ) ) ; \n + int lastCharIndex = 0 ; \n + char [ ] result = new char [ inString . length ( ) ] ; \n - sb . append ( c ) ; \n + result [ lastCharIndex + + ] = c ; \n - return sb . toString ( ) ; \n + return new String ( result , 0 , lastCharIndex ) ; \n - \n spring - core \ src \ test \ java \ org \ springframework \ util \ StringUtilsTests . java \n - assertThat ( StringUtils . quoteIfString ( 5 ) ) . isEqualTo ( Integer . valueOf ( 5 ) ) ; \n + assertThat ( StringUtils . quoteIfString ( 5 ) ) . isEqualTo ( 5 ) ; \n - assertThat ( sa [ 0 ] . equals ( "" a "" ) & & sa [ 1 ] . equals ( "" b "" ) & & sa [ 2 ] . equals ( "" "" ) & & sa [ 3 ] . equals ( "" c "" ) ) . as ( "" components are correct "" ) . isTrue ( ) ; \n + assertThat ( sa [ 0 ] . equals ( "" a "" ) & & sa [ 1 ] . equals ( "" b "" ) & & sa [ 2 ] . isEmpty ( ) & & sa [ 3 ] . equals ( "" c "" ) ) . as ( "" components are correct "" ) . isTrue ( ) ; \n - void delimitedListToStringArrayWithEmptyString ( ) { \n + void delimitedListToStringArrayWithEmptyDelimiter ( ) { \n - assertThat ( sa [ 0 ] . equals ( "" a "" ) & & sa [ 1 ] . equals ( "" "" ) & & sa [ 2 ] . equals ( "" b "" ) ) . as ( "" components are correct "" ) . isTrue ( ) ; \n + assertThat ( sa [ 0 ] . equals ( "" a "" ) & & sa [ 1 ] . isEmpty ( ) & & sa [ 2 ] . equals ( "" b "" ) ) . as ( "" components are correct "" ) . isTrue ( ) ; \n",Improve performance of StringUtils . deleteAny ( ),701
spring - aop \ src \ main \ java \ org \ springframework \ aop \ interceptor \ AbstractMonitoringInterceptor . java \n - return getPrefix ( ) + clazz . getName ( ) + ' . ' + method . getName ( ) + getSuffix ( ) ; \n + String clazzName = clazz . getName ( ) ; \n + return getPrefix ( ) + clazzName + ' . ' + method . getName ( ) + getSuffix ( ) ; \n,Extract Class . getName ( ) from String concatenation \n This commit extracts a Class . getName ( ) invocation from String \n concatenation in AbstractMonitoringInterceptor to avoid an issue \n related to profile pollution . \n Closes gh - 25324,701
"spring - aop \ src \ main \ java \ org \ springframework \ aop \ framework \ JdkDynamicAopProxy . java \n - * Copyright 2002 - 2019 the original author or authors . \n + * Copyright 2002 - 2020 the original author or authors . \n + * @ author Sergey Tsypanov \n + private final Class < ? > [ ] proxiedInterfaces ; \n + \n + this . proxiedInterfaces = AopProxyUtils . completeProxiedInterfaces ( this . advised , true ) ; \n + findDefinedEqualsAndHashCodeMethods ( this . proxiedInterfaces ) ; \n - Class < ? > [ ] proxiedInterfaces = AopProxyUtils . completeProxiedInterfaces ( this . advised , true ) ; \n - findDefinedEqualsAndHashCodeMethods ( proxiedInterfaces ) ; \n - return Proxy . newProxyInstance ( classLoader , proxiedInterfaces , this ) ; \n + return Proxy . newProxyInstance ( classLoader , this . proxiedInterfaces , this ) ; \n spring - core \ src \ main \ java \ org \ springframework \ util \ ReflectionUtils . java \n - if ( method = = null | | ! method . getName ( ) . equals ( "" equals "" ) ) { \n + if ( method = = null ) { \n + if ( ! method . getName ( ) . equals ( "" equals "" ) ) { \n + return false ; \n + } \n - return ( method ! = null & & method . getName ( ) . equals ( "" hashCode "" ) & & method . getParameterCount ( ) = = 0 ) ; \n + return method ! = null & & method . getParameterCount ( ) = = 0 & & method . getName ( ) . equals ( "" hashCode "" ) ; \n - return ( method ! = null & & method . getName ( ) . equals ( "" toString "" ) & & method . getParameterCount ( ) = = 0 ) ; \n + return ( method ! = null & & method . getParameterCount ( ) = = 0 & & method . getName ( ) . equals ( "" toString "" ) ) ; \n",Improve performance of JdkDynamicAopProxy . getProxy ( ),701
spring - aop \ src \ main \ java \ org \ springframework \ aop \ aspectj \ MethodInvocationProceedingJoinPoint . java \n - if ( this . parameterNames = = null ) { \n - this . parameterNames = parameterNameDiscoverer . getParameterNames ( getMethod ( ) ) ; \n + String [ ] parameterNames = this . parameterNames ; \n + if ( parameterNames = = null ) { \n + this . parameterNames = parameterNames = parameterNameDiscoverer . getParameterNames ( getMethod ( ) ) ; \n - return this . parameterNames ; \n + return parameterNames ; \n spring - beans \ src \ main \ java \ org \ springframework \ beans \ factory \ annotation \ AutowiredAnnotationBeanPostProcessor . java \n + Object cachedFieldValue = null ; \n - this . cachedFieldValue = desc ; \n + cachedFieldValue = desc ; \n - this . cachedFieldValue = new ShortcutDependencyDescriptor ( \n + cachedFieldValue = new ShortcutDependencyDescriptor ( \n - else { \n - this . cachedFieldValue = null ; \n - } \n + this . cachedFieldValue = cachedFieldValue ; \n spring - context \ src \ main \ java \ org \ springframework \ cache \ support \ AbstractCacheManager . java \n - Set < String > cacheNames = new LinkedHashSet < > ( this . cacheNames . size ( ) + 1 ) ; \n - cacheNames . addAll ( this . cacheNames ) ; \n + Set < String > cacheNames = new LinkedHashSet < > ( this . cacheNames ) ; \n,Avoid multiple volatile reads / writes in a row where only one is enough,701
"spring - aop \ src \ main \ java \ org \ springframework \ aop \ framework \ CglibAopProxy . java \n + final boolean infoEnabled = logger . isInfoEnabled ( ) ; \n + final boolean debugEnabled = logger . isDebugEnabled ( ) ; \n - if ( implementsInterface ( method , ifcs ) ) { \n + if ( infoEnabled & & implementsInterface ( method , ifcs ) ) { \n - logger . debug ( "" Final method [ "" + method + "" ] cannot get proxied via CGLIB : "" + \n - "" Calls to this method will NOT be routed to the target instance and "" + \n - "" might lead to NPEs against uninitialized fields in the proxy instance . "" ) ; \n + if ( debugEnabled ) { \n + logger . debug ( "" Final method [ "" + method + "" ] cannot get proxied via CGLIB : "" + \n + "" Calls to this method will NOT be routed to the target instance and "" + \n + "" might lead to NPEs against uninitialized fields in the proxy instance . "" ) ; \n + } \n - else if ( ! Modifier . isPublic ( mod ) & & ! Modifier . isProtected ( mod ) & & \n + else if ( debugEnabled & & ! Modifier . isPublic ( mod ) & & ! Modifier . isProtected ( mod ) & & \n - private Object target ; \n + private final Object target ; \n - public Object loadObject ( ) throws Exception { \n + public Object loadObject ( ) { \n - private boolean equalsAdviceClasses ( Advisor a , Advisor b ) { \n + private static boolean equalsAdviceClasses ( Advisor a , Advisor b ) { \n - private boolean equalsPointcuts ( Advisor a , Advisor b ) { \n + private static boolean equalsPointcuts ( Advisor a , Advisor b ) { \n",Reduce String garbage in CglibAopProxy . doValidateClass ( ) \n Closes gh - 24672,701
"spring - core \ src \ main \ java \ org \ springframework \ util \ ReflectionUtils . java \n + * @ throws IllegalArgumentException if method ' s argument is { @ code null } \n + Assert . notNull ( next , "" Next MethodFilter must not be null ! "" ) ; \n",Fail MethodFilter . and ( ) immediately when null is passed,701
"spring - web \ src \ main \ java \ org \ springframework \ http \ ContentDisposition . java \n + * @ author Sergey Tsypanov \n - sb . append ( ( c = = ' "" ' & & ! escaped ) ? "" \ \ \ "" "" : c ) ; \n + if ( ! escaped & & c = = ' "" ' ) { \n + sb . append ( "" \ \ \ "" "" ) ; \n + } else { \n + sb . append ( c ) ; \n + } \n",Avoid StringBuilder . append ( Object ) in ContentDisposition \n This commit avoids invoking StringBuilder . append ( Object ) in favor \n of explicit method calls to append ( String ) and append ( char ) in \n ContentDisposition . escapeQuotationsInFilename ( String ) . \n Closes gh - 25056,701
